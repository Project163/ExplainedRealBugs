<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7111] flink-scala-shell fails on mvn verify</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7111</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Running &lt;tt&gt;mvn verify&lt;/tt&gt; after &lt;tt&gt;mvn clean install -DskipTests&lt;/tt&gt; causes the build to fail in &lt;tt&gt;flink-scala-shell&lt;/tt&gt; with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[ERROR] Failed to execute goal org.apache.maven.plugins:maven-assembly-plugin:2.4:single (create-library-loading-jar) on project flink-scala-shell_2.11: Failed to create assembly: Error creating assembly archive test-jar: You must set at least one file. -&amp;gt; [Help 1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13085133">FLINK-7111</key>
            <summary>flink-scala-shell fails on mvn verify</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jul 2017 08:48:01 +0000</created>
                <updated>Tue, 11 Jul 2017 21:27:38 +0000</updated>
                            <resolved>Tue, 11 Jul 2017 09:12:53 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Scala Shell</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16076256" author="aljoscha" created="Thu, 6 Jul 2017 09:44:41 +0000"  >&lt;p&gt;Ok, the problem is this: both &lt;tt&gt;flink-tests&lt;/tt&gt; and &lt;tt&gt;flink-scala-shell&lt;/tt&gt; (with a recent change) have a pattern where test classes are compiled, then a jar is built from these using maven-assembly and then the compiled classes are deleted. Tests use these jars to test whether the user ClassLoader works. This means that after &lt;tt&gt;mvn clean install&lt;/tt&gt; the class files that go into the jars are not present.&lt;/p&gt;

&lt;p&gt;In &lt;tt&gt;flink-tests&lt;/tt&gt;, apparently, the &lt;tt&gt;maven-compiler-plugin&lt;/tt&gt; always detects that there are changes and recompiles the test classes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[INFO] --- maven-compiler-plugin:3.1:testCompile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-testCompile) @ flink-tests_2.11 ---
[INFO] Changes detected - recompiling the module!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this, means that the assembly plugin finds the classes and the jar can be built.&lt;/p&gt;

&lt;p&gt;In &lt;tt&gt;flink-scala-shell&lt;/tt&gt;, however, &lt;tt&gt;scala-maven-plugin&lt;/tt&gt; does not think that we need another compilation:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[INFO] --- scala-maven-plugin:3.2.2:testCompile (scala-test-compile) @ flink-scala-shell_2.11 ---
[INFO] Nothing to compile - all classes are up to date
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;therefore, the class files are not there when the assembly plugin tries to re-generate that jar files.&lt;/p&gt;

&lt;p&gt;By, the way, the jar files are still there after &lt;tt&gt;mvn clean install&lt;/tt&gt; so &lt;tt&gt;mvn verify&lt;/tt&gt; would not actually have to re-generate them.&lt;/p&gt;

&lt;p&gt;Not sure how to fix this yet.&lt;/p&gt;</comment>
                            <comment id="16076699" author="zentol" created="Thu, 6 Jul 2017 15:29:11 +0000"  >&lt;p&gt;In that case i would suggest to disable the test for now.&lt;/p&gt;</comment>
                            <comment id="16078997" author="githubbot" created="Sat, 8 Jul 2017 06:45:36 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7111&quot; title=&quot;flink-scala-shell fails on mvn verify&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7111&quot;&gt;&lt;del&gt;FLINK-7111&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;scala-shell&amp;#93;&lt;/span&gt; Disable external jar test&lt;/p&gt;

&lt;p&gt;    @aljoscha What do you think?&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 7111&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4288&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a301d5bad836964ab25973a5bf2a82b78e670b6b&lt;br/&gt;
Author: zentol &amp;lt;chesnay@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-08T06:44:05Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7111&quot; title=&quot;flink-scala-shell fails on mvn verify&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7111&quot;&gt;&lt;del&gt;FLINK-7111&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;scala-shell&amp;#93;&lt;/span&gt; Disable external jar test&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16081900" author="githubbot" created="Tue, 11 Jul 2017 08:54:47 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288#discussion_r126631682&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288#discussion_r126631682&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala-shell/src/test/scala/org/apache/flink/api/scala/ScalaShellITCase.scala &amp;#8212;&lt;br/&gt;
    @@ -164,7 +164,11 @@ class ScalaShellITCase extends TestLogger &lt;/p&gt;
{
         Assert.assertTrue(output.contains(&quot;WC(world,10)&quot;))
       }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/** Submit external library */&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Submit external library.&lt;br/&gt;
    +   * Disabled due of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7111&quot; title=&quot;flink-scala-shell fails on mvn verify&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7111&quot;&gt;&lt;del&gt;FLINK-7111&lt;/del&gt;&lt;/a&gt;.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Should this be &quot;due to&quot;&lt;/p&gt;</comment>
                            <comment id="16081901" author="githubbot" created="Tue, 11 Jul 2017 08:55:24 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This looks good! &#128077; &lt;/p&gt;

&lt;p&gt;    Could you please add a (possibly blocking) issue for re-enabling this test?&lt;/p&gt;</comment>
                            <comment id="16081930" author="githubbot" created="Tue, 11 Jul 2017 09:09:41 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    sure. I&apos;ll fix the typo while merging, thanks for the review.&lt;/p&gt;</comment>
                            <comment id="16081935" author="zentol" created="Tue, 11 Jul 2017 09:12:53 +0000"  >&lt;p&gt;1.4: d0e52954b035cd4e8cd25962500b3ebb57561f39&lt;/p&gt;</comment>
                            <comment id="16081937" author="githubbot" created="Tue, 11 Jul 2017 09:13:18 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4288&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16082633" author="stephanewen" created="Tue, 11 Jul 2017 17:47:52 +0000"  >&lt;p&gt;What is the strategy of getting the test coverage back?&lt;br/&gt;
Not sure that simply dropping these tests is the way to go...&lt;/p&gt;</comment>
                            <comment id="16082639" author="stephanewen" created="Tue, 11 Jul 2017 17:50:04 +0000"  >&lt;p&gt;Hmm, in the tradeoff between supporting `mvn verify` without additional compile, versus loosing this test coverage, I am not sure that this is a good idea to just disable the tests.&lt;/p&gt;

&lt;p&gt;What is the reason that `mvn verify` without compile became so important that the decision was to drop tests for that?&lt;/p&gt;</comment>
                            <comment id="16082729" author="zentol" created="Tue, 11 Jul 2017 18:36:30 +0000"  >&lt;p&gt;It is the very single issue that blocks the build profile reorganization which makes use of &lt;tt&gt;mvn verify&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;If this weren&apos;t the case I would&apos;ve spent more time trying to find a solution, but getting the builds times finally under control is more important in my opinion..&lt;/p&gt;</comment>
                            <comment id="16082940" author="stephanewen" created="Tue, 11 Jul 2017 20:41:59 +0000"  >&lt;p&gt;Why can&apos;t the build profiles use &lt;tt&gt;mvn clean verify&lt;/tt&gt; in the modules that they build? Or is there a single &quot;build all skip tests&quot; process, followed by individual &quot;cd project, mvn verify&quot; steps?&lt;/p&gt;</comment>
                            <comment id="16082972" author="zentol" created="Tue, 11 Jul 2017 20:58:10 +0000"  >&lt;p&gt;Exactly, it&apos;s a 2 step process, the first step compiles all required modules, the second one executes tests for specific modules. For example, for the libraries we compile both the libraries and the core modules (runtime etc.), but only run tests in the sub-modules of flink-libraries.&lt;/p&gt;

&lt;p&gt;This buys us a LOT of time since 4/5 profiles don&apos;t have to run the flink-runtime tests which easily take 15 minutes.&lt;/p&gt;</comment>
                            <comment id="16082975" author="zentol" created="Tue, 11 Jul 2017 20:58:56 +0000"  >&lt;p&gt;It&apos;s done in 2 calls though using mavens &lt;tt&gt;-pl&lt;/tt&gt; option; we don&apos;t cd into each module separately but pass a list of modules to test.&lt;/p&gt;</comment>
                            <comment id="16083020" author="zentol" created="Tue, 11 Jul 2017 21:27:38 +0000"  >&lt;p&gt;As for how we can implement this test properly, I would suggest to test this similarly as the proposed end-to-end kafka tests, i.e. against an actual local flink cluster, outside of maven.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h6in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>