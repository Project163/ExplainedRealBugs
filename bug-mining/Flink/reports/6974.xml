<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-31166] array_contains does NOT work when haystack elements are not nullable and needle is nullable</title>
                <link>https://issues.apache.org/jira/browse/FLINK-31166</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;tt&gt;ARRAY_CONTAINS&lt;/tt&gt;&#160;works ok for the case when both haystack elements and needle are not nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1], 0);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it works ok when both haystack elements and needle are nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1, &lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt;], &lt;span class=&quot;code-keyword&quot;&gt;CAST&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INT&lt;/span&gt;));&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it works ok when haystack elements are nullable and needle is not nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1, &lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt;], 1);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and it does NOT work when haystack elements are not nullable and needle is nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1], &lt;span class=&quot;code-keyword&quot;&gt;CAST&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INT&lt;/span&gt;));&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13055702/13055702_image-2023-02-22-09-56-59-257.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13055679/13055679_image-2023-02-21-18-41-19-385.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13525538">FLINK-31166</key>
            <summary>array_contains does NOT work when haystack elements are not nullable and needle is nullable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jackylau">Jacky Lau</assignee>
                                    <reporter username="jackylau">Jacky Lau</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 21 Feb 2023 10:41:35 +0000</created>
                <updated>Thu, 9 Mar 2023 23:43:22 +0000</updated>
                            <resolved>Thu, 9 Mar 2023 23:43:22 +0000</resolved>
                                    <version>1.18.0</version>
                                    <fixVersion>1.18.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17691571" author="martijnvisser" created="Tue, 21 Feb 2023 12:20:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jackylau&quot; class=&quot;user-hover&quot; rel=&quot;jackylau&quot;&gt;jackylau&lt;/a&gt; Can you please add a reproducible example for this?&lt;/p&gt;</comment>
                            <comment id="17691863" author="jackylau" created="Wed, 22 Feb 2023 01:56:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=martijnvisser&quot; class=&quot;user-hover&quot; rel=&quot;martijnvisser&quot;&gt;martijnvisser&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;select array_contains(array&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;, cast(null as int));&lt;/p&gt;</comment>
                            <comment id="17692003" author="martijnvisser" created="Wed, 22 Feb 2023 07:58:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jackylau&quot; class=&quot;user-hover&quot; rel=&quot;jackylau&quot;&gt;jackylau&lt;/a&gt; So this is specifically about the behaviour when the needle (given ARRAY_CONTAINS(haystack, needle) is the function) is null? &lt;/p&gt;</comment>
                            <comment id="17698305" author="sergey nuyanzin" created="Thu, 9 Mar 2023 10:22:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jackylau&quot; class=&quot;user-hover&quot; rel=&quot;jackylau&quot;&gt;jackylau&lt;/a&gt; can you please update jira description with some example e.g. from the PR.&lt;br/&gt;
Having screenshots in description does not help much since it is impossible to copy&amp;amp;paste and run on Flink.&lt;/p&gt;

&lt;p&gt;if i understand correctly from the PR:&lt;br/&gt;
&lt;tt&gt;ARRAY_CONTAINS&lt;/tt&gt; works ok for the case when both haystack elements and needle are not nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1], 0);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it works ok when both haystack elements and needle are nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1, &lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt;], &lt;span class=&quot;code-keyword&quot;&gt;CAST&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INT&lt;/span&gt;));&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it works ok when haystack elements are nullable and needle is not nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1, &lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt;], 1);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and it does NOT work when haystack elements are not nullable and needle is nullable e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; array_contains(&lt;span class=&quot;code-keyword&quot;&gt;ARRAY&lt;/span&gt;[0, 1], &lt;span class=&quot;code-keyword&quot;&gt;CAST&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INT&lt;/span&gt;));&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m asking since for me &lt;br/&gt;
in fact it was impossible to get to this from jira description reading and I still want to double check if I understand it correctly&lt;/p&gt;</comment>
                            <comment id="17698314" author="jackylau" created="Thu, 9 Mar 2023 11:04:36 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sergey+Nuyanzin&quot; class=&quot;user-hover&quot; rel=&quot;Sergey Nuyanzin&quot;&gt;Sergey Nuyanzin&lt;/a&gt; thanks for your description. yeap, you are right. and i will describe the Jira will later&#160;&lt;/p&gt;</comment>
                            <comment id="17698315" author="jackylau" created="Thu, 9 Mar 2023 11:06:19 +0000"  >&lt;p&gt;have fixed this pr info &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sergey+Nuyanzin&quot; class=&quot;user-hover&quot; rel=&quot;Sergey Nuyanzin&quot;&gt;Sergey Nuyanzin&lt;/a&gt; , thanks for your detail review very much and i have learned a lot&#160;&lt;/p&gt;</comment>
                            <comment id="17698651" author="sergey nuyanzin" created="Thu, 9 Mar 2023 23:43:14 +0000"  >&lt;p&gt;Merged as &lt;a href=&quot;https://github.com/apache/flink/commit/10dce7cf0a04b80d7416a5760e1a6dbc430d9f88&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;10dce7cf0a04b80d7416a5760e1a6dbc430d9f88&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13055681" name="image-2023-02-21-18-37-45-202.png" size="62442" author="jackylau" created="Tue, 21 Feb 2023 10:37:46 +0000"/>
                            <attachment id="13055679" name="image-2023-02-21-18-41-19-385.png" size="333259" author="jackylau" created="Tue, 21 Feb 2023 10:41:21 +0000"/>
                            <attachment id="13055702" name="image-2023-02-22-09-56-59-257.png" size="45520" author="jackylau" created="Wed, 22 Feb 2023 01:56:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1g2oo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>