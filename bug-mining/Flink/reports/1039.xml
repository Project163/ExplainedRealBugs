<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4097] Cassandra Sink throws NPE on closing if server is not available</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4097</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;11:41:41,515 ERROR org.apache.flink.streaming.connectors.cassandra.CassandraSinkBase  - Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; closing session.
java.lang.NullPointerException
	at org.apache.flink.streaming.connectors.cassandra.CassandraSinkBase.close(CassandraSinkBase.java:84)
	at org.apache.flink.api.common.functions.util.FunctionUtils.closeFunction(FunctionUtils.java:45)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.dispose(AbstractUdfStreamOperator.java:107)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.disposeAllOperators(StreamTask.java:370)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:304)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:588)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;11:41:43,896 ERROR org.apache.flink.runtime.taskmanager.Task                     - Task execution failed. 
com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.TransportException: [/127.0.0.1] Cannot connect))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:231)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:77)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1414)
	at com.datastax.driver.core.Cluster.init(Cluster.java:162)
	at com.datastax.driver.core.Cluster.connectAsync(Cluster.java:333)
	at com.datastax.driver.core.Cluster.connectAsync(Cluster.java:308)
	at com.datastax.driver.core.Cluster.connect(Cluster.java:250)
	at org.apache.flink.streaming.connectors.cassandra.CassandraSinkBase.open(CassandraSinkBase.java:67)
	at org.apache.flink.streaming.connectors.cassandra.CassandraPojoSink.open(CassandraPojoSink.java:48)
	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:38)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:91)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.openAllOperators(StreamTask.java:340)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:225)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:588)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12981285">FLINK-4097</key>
            <summary>Cassandra Sink throws NPE on closing if server is not available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alkagin">Andrea Sella</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jun 2016 09:50:18 +0000</created>
                <updated>Mon, 4 Jul 2016 11:16:20 +0000</updated>
                            <resolved>Wed, 22 Jun 2016 10:34:43 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Connectors / Common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15342001" author="alkagin" created="Tue, 21 Jun 2016 15:38:53 +0000"  >&lt;p&gt;I think it is correct to log the NullPointerException. The line throws the exception is `session.close()`, where session is null due to NoHostAvailableException, is wrapped inside a try-catch statement to notify this behaviour.&lt;/p&gt;</comment>
                            <comment id="15342007" author="rmetzger" created="Tue, 21 Jun 2016 15:42:58 +0000"  >&lt;p&gt;Oh yes. You are right. Maybe it would make sense to add a null check to avoid the exception, as it might confuse our users. What do you think?&lt;br/&gt;
Other connectors do the same (it can happen in many cases that operators are closed without a proper initialization, for example when the open() fails, or when other tasks fail during deployment and everything is cancelled in the beginning).&lt;/p&gt;</comment>
                            <comment id="15342042" author="alkagin" created="Tue, 21 Jun 2016 15:56:04 +0000"  >&lt;p&gt;I am not a huge fan of null-checking in these cases, but it makes sense to &quot;standardize&quot; the close() as the other connectors. I&apos;ll assign the issue to me and I will add the null-check to session and cluster for CassandraSinkBase. Should I add the null-check to CassandraTupleWriteAheadSink as well?&lt;/p&gt;</comment>
                            <comment id="15342052" author="rmetzger" created="Tue, 21 Jun 2016 15:58:42 +0000"  >&lt;p&gt;Why are you not a fan of it?&lt;/p&gt;</comment>
                            <comment id="15342073" author="alkagin" created="Tue, 21 Jun 2016 16:09:42 +0000"  >&lt;p&gt;In the close() of Sink&apos;s lifecycle session should be initialized. So, I think it is a bit hackish to add a null-check to avoid an unexpected behaviour, I rather prefer a try-catch.&lt;/p&gt;</comment>
                            <comment id="15344030" author="githubbot" created="Wed, 22 Jun 2016 09:52:52 +0000"  >&lt;p&gt;GitHub user alkagin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4097&quot; title=&quot;Cassandra Sink throws NPE on closing if server is not available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4097&quot;&gt;&lt;del&gt;FLINK-4097&lt;/del&gt;&lt;/a&gt; Cassandra Sink throws NPE on closing if server is not available&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;Jira Issue&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4097&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-4097&lt;/a&gt;)&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/alkagin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/alkagin/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4097&quot; title=&quot;Cassandra Sink throws NPE on closing if server is not available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4097&quot;&gt;&lt;del&gt;FLINK-4097&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2144&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 058d5980ac4bf5b729fccbd35a618c9b4c70bb64&lt;br/&gt;
Author: Andrea Sella &amp;lt;andrea.sella@radicalbit.io&amp;gt;&lt;br/&gt;
Date:   2016-06-21T16:12:31Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4097&quot; title=&quot;Cassandra Sink throws NPE on closing if server is not available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4097&quot;&gt;&lt;del&gt;FLINK-4097&lt;/del&gt;&lt;/a&gt; Fix NullPointerException on CassandraSinkBase and CassandraTupleWriteAheadSink&apos;s close()&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15344058" author="githubbot" created="Wed, 22 Jun 2016 10:06:52 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144#discussion_r68026831&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144#discussion_r68026831&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-cassandra/src/main/java/org/apache/flink/streaming/connectors/cassandra/CassandraSinkBase.java &amp;#8212;&lt;br/&gt;
    @@ -81,12 +81,16 @@ public void invoke(IN value) throws Exception {&lt;br/&gt;
     	@Override&lt;br/&gt;
     	public void close() {&lt;br/&gt;
     		try {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;session.close();&lt;br/&gt;
    +			if(session != null) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    missing space after if, the same applie to the other 3 null checks as well&lt;/p&gt;</comment>
                            <comment id="15344062" author="githubbot" created="Wed, 22 Jun 2016 10:07:20 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    found a minor formatting issue, otherwise +1&lt;/p&gt;</comment>
                            <comment id="15344088" author="githubbot" created="Wed, 22 Jun 2016 10:30:41 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging&lt;/p&gt;</comment>
                            <comment id="15344091" author="githubbot" created="Wed, 22 Jun 2016 10:34:34 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2144&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15344092" author="zentol" created="Wed, 22 Jun 2016 10:34:43 +0000"  >&lt;p&gt;Fixed in a973d84b251ddf87bc47d9806d37d353febcab41&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 21 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zstz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>