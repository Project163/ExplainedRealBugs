<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:51:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17691] FlinkKafkaProducer transactional.id too long when using Semantic.EXACTLY_ONCE</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17691</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When sink to Kafka using the &lt;font color=&quot;#FF0000&quot;&gt;Semantic.EXACTLY_ONCE &lt;/font&gt;mode.&lt;/p&gt;

&lt;p&gt;The flink Kafka Connector Producer will auto set the &lt;font color=&quot;#FF0000&quot;&gt;transactional.id&lt;/font&gt;, and the user - defined value are ignored.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When the job operator name too long, will send failed&lt;/p&gt;

&lt;p&gt;transactional.id is&#160;exceeds the kafka&#160; &lt;font color=&quot;#FF0000&quot;&gt;coordinator_key&lt;/font&gt; limit&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002935/13002935_image-2020-05-14-21-09-01-906.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The flink Kafka Connector policy for automatic generation of transaction.id is as follows&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;1. use the &lt;font color=&quot;#FF0000&quot;&gt;taskName + &quot;-&quot; + operatorUniqueID&lt;/font&gt; as transactional.id prefix (may be too long)&lt;/p&gt;

&lt;p&gt;&#160; getRuntimeContext().getTaskName() + &quot;-&quot; + ((StreamingRuntimeContext)&#160; &#160; getRuntimeContext()).getOperatorUniqueID()&lt;/p&gt;

&lt;p&gt;2. Range of available transactional ids&#160;&lt;/p&gt;

&lt;p&gt;[nextFreeTransactionalId, nextFreeTransactionalId + parallelism * kafkaProducersPoolSize)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002938/13002938_image-2020-05-14-20-43-57-414.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002937/13002937_image-2020-05-14-20-45-24-030.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002936/13002936_image-2020-05-14-20-45-59-878.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The Kafka transaction.id check policy as follows:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#FF0000&quot;&gt;string bytes.length can&apos;t larger than Short.MAX_VALUE (32767)&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002934/13002934_image-2020-05-14-21-16-43-810.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13002933/13002933_image-2020-05-14-21-17-09-784.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;To reproduce this bug, the following conditions must be met:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;send msg to kafka with exactly once mode&lt;/li&gt;
	&lt;li&gt;the task&#160;TaskName&apos; length +&#160;TaskName&apos;s length is lager than the&#160;32767 (A very long line of SQL or window statements can appear)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;b&gt;I suggest a solution:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160;1.&#160; Allows users to customize transactional.id &apos;s prefix&lt;/p&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160;2.&#160;Do md5 on the prefix before returning the real transactional.id&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13304936">FLINK-17691</key>
            <summary>FlinkKafkaProducer transactional.id too long when using Semantic.EXACTLY_ONCE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jmathews3773">John Mathews</assignee>
                                    <reporter username="freezhan">freezhan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 14 May 2020 13:24:27 +0000</created>
                <updated>Sat, 22 May 2021 03:04:38 +0000</updated>
                            <resolved>Tue, 24 Nov 2020 08:58:51 +0000</resolved>
                                    <version>1.10.0</version>
                    <version>1.11.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17107420" author="freezhan" created="Thu, 14 May 2020 15:53:20 +0000"  >&lt;p&gt;Do md5 on the transactional.id prefix&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/pull/12157&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/12157&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17235662" author="jmathews3773" created="Thu, 19 Nov 2020 18:57:34 +0000"  >&lt;p&gt;hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; I am happy to submit a PR to fix this bug, can I simply submit one that truncates the taskName? I think we can truncate either in the TransactionIdGenerator or in the TaskInfo constructor itself, depending on if we want the limit to apply everywhere or not.&lt;/p&gt;</comment>
                            <comment id="17235745" author="jmathews3773" created="Thu, 19 Nov 2020 21:11:06 +0000"  >&lt;p&gt;Submitted a fix, &lt;a href=&quot;https://github.com/apache/flink/pull/14144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/14144&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17237970" author="aljoscha" created="Tue, 24 Nov 2020 08:58:51 +0000"  >&lt;p&gt;master: 8e402832caae9ea40d665cecb7b09204e1530e03&lt;/p&gt;</comment>
                            <comment id="17253451" author="nvolynets" created="Tue, 22 Dec 2020 12:26:13 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=freezhan&quot; class=&quot;user-hover&quot; rel=&quot;freezhan&quot;&gt;freezhan&lt;/a&gt;&#160;&amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmathews3773&quot; class=&quot;user-hover&quot; rel=&quot;jmathews3773&quot;&gt;jmathews3773&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Looks still exists&#160;or/and I am missing something. Below are details.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Basically have bumped with two issues:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;first one directly related with this one&lt;/li&gt;
	&lt;li&gt;second - indirectly related&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Issue #1&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Regarding&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;gt;&amp;gt;&#160;Do md5 on the transactional.id prefix&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Details&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;Flink version:&lt;/p&gt;

&lt;p&gt;// build.gradle&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ext {
  ...
  flinkVersion = &lt;span class=&quot;code-quote&quot;&gt;&apos;1.12.0&apos;&lt;/span&gt;
  scalaBinaryVersion = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.11&apos;&lt;/span&gt;
  ...
}

dependencies {
  ...
  implementation &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink:flink-streaming-java_${scalaBinaryVersion}:${flinkVersion}&quot;&lt;/span&gt;
  ...
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// App&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
  ...
  env.enableCheckpointing(10000);
  env.setStateBackend(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RocksDBStateBackend(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///.../config/checkpoints/rocksdb&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
&lt;/span&gt;  env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);
  ...
  FlinkKafkaConsumer&amp;lt;Record&amp;gt; consumer = createConsumer(conf);
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = createProducer(conf);


  env
        .addSource(consumer)
        .uid(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka-consumer&quot;&lt;/span&gt;)
        .addSink(producer)
        .uid(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka-producer&quot;&lt;/span&gt;)
  ;

  env.execute();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; FlinkKafkaProducer&amp;lt;Record&amp;gt; createProducer(Configuration conf) {
  ...
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FlinkKafkaProducer&amp;lt;&amp;gt;(topicDefault, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RecordKafkaSerSchema(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), props, FlinkKafkaProducer.Semantic.EXACTLY_ONCE);
  ...
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; producer;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// Logs (of App executed/submitted locally from IDE)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// code placeholder
&lt;/span&gt;2020-12-22 13:52:08 [ForkJoinPool.commonPool-worker-9] INFO  ProducerConfig:347 - ProducerConfig values: 
  ...
  transactional.id = Source: Custom Source -&amp;gt; Sink: Unnamed-e2b2f358d45860e6d949c8f7417842d6-24
  ...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Summary&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;As we can see transaction-id PREFIX is not md5 as stated above (or I am missing something). It looks that issue should be reopened as it is expected to be fixed in 1.12.0.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Issue #2&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Regarding&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160;1. use the&#160;&lt;font color=&quot;#ff0000&quot;&gt;taskName + &quot;-&quot; + operatorUniqueID&lt;/font&gt;&#160;as transactional.id prefix (may be too long)&lt;/p&gt;

&lt;p&gt;In reality `uid` specified after `source` &amp;amp; `sink` are ignored. But specifying of them are highly recommended in Flink official documentation:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html#assigning-operator-ids&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html#assigning-operator-ids&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Moreover as a workaround there is a possibility to specify `source` name &amp;amp; it is NOT ignored.&lt;/p&gt;

&lt;p&gt;But there is NO possibility provided by Flink Java API to specify `sink` name.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Details&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;// build.gradle&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ext {
  ...
  flinkVersion = &lt;span class=&quot;code-quote&quot;&gt;&apos;1.12.0&apos;&lt;/span&gt;
  scalaBinaryVersion = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.11&apos;&lt;/span&gt;
  ...
}

dependencies {
  ...
  implementation &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink:flink-streaming-java_${scalaBinaryVersion}:${flinkVersion}&quot;&lt;/span&gt;
  ...
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// App - `uid` are ignored&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
  ...
  env.enableCheckpointing(10000);
  env.setStateBackend(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RocksDBStateBackend(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///.../config/checkpoints/rocksdb&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
&lt;/span&gt;  env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);
  ...
  FlinkKafkaConsumer&amp;lt;Record&amp;gt; consumer = createConsumer(conf);
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = createProducer(conf);


  env
        .addSource(consumer)
        .uid(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka-consumer&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// is ignored
&lt;/span&gt;        .addSink(producer)
        .uid(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka-producer&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// is ignored
&lt;/span&gt;  ;

  env.execute();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; FlinkKafkaProducer&amp;lt;Record&amp;gt; createProducer(Configuration conf) {
  ...
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FlinkKafkaProducer&amp;lt;&amp;gt;(topicDefault, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RecordKafkaSerSchema(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), props, FlinkKafkaProducer.Semantic.EXACTLY_ONCE);
  ...
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; producer;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// Logs (of App executed/submitted locally from IDE)&#160;-&#160;`uid` are ignored&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-12-22 13:52:08 [Source: Custom Source -&amp;gt; Sink: Unnamed (1/1)#0] INFO  ProducerConfig:347 - ProducerConfig values: &#160;	
  ...
  transactional.id = Source: Custom Source -&amp;gt; Sink: Unnamed-e2b2f358d45860e6d949c8f7417842d6-20
  ...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// App - specify `source`/`sink` names&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
  ...
  env.enableCheckpointing(10000);
  env.setStateBackend(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RocksDBStateBackend(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///.../config/checkpoints/rocksdb&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
&lt;/span&gt;  env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);
  ...
  FlinkKafkaConsumer&amp;lt;Record&amp;gt; consumer = createConsumer(conf);
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = createProducer(conf);


  env
        .addSource(consumer, &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka-consumer&quot;&lt;/span&gt;)
        .addSink(producer) &lt;span class=&quot;code-comment&quot;&gt;// NO way to specify name
&lt;/span&gt;  ;

  env.execute();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; FlinkKafkaProducer&amp;lt;Record&amp;gt; createProducer(Configuration conf) {
  ...
  FlinkKafkaProducer&amp;lt;Record&amp;gt; producer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FlinkKafkaProducer&amp;lt;&amp;gt;(topicDefault, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RecordKafkaSerSchema(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), props, FlinkKafkaProducer.Semantic.EXACTLY_ONCE);
  ...
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; producer;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// Logs (of App executed/submitted locally from IDE)&#160;- specify `source`/`sink` names&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-12-22 13:52:08 [Source: kafka-consumer -&amp;gt; Sink: Unnamed (1/1)#0] INFO  ProducerConfig:347 - ProducerConfig values: &#160;	
  ...
  transactional.id = Source: kafka-consumer -&amp;gt; Sink: Unnamed-e2b2f358d45860e6d949c8f7417842d6-20
  ...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Summary&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;As we can see `operatorUniqueID` specified after `source` and/or `sink` are ignored.&lt;/p&gt;

&lt;p&gt;Moreover we can specify `source` name &amp;amp; it is taken into account but there is no possibility to do the same for `sink` via Flink Java API.&lt;/p&gt;

&lt;p&gt;Should I create new/separate Jira issue for this use case or it is expect behaviour ?&lt;/p&gt;

&lt;p&gt;Btw: this issue looks as CRITICAL as from official Flink documentation it blocks as follows:&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160;&#160;It is&#160;&lt;b&gt;highly recommended&lt;/b&gt;&#160;that you adjust your programs as described in this section in order to be able to upgrade your programs in the future.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html#assigning-operator-ids&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html#assigning-operator-ids&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17253463" author="nvolynets" created="Tue, 22 Dec 2020 12:48:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=freezhan&quot; class=&quot;user-hover&quot; rel=&quot;freezhan&quot;&gt;freezhan&lt;/a&gt;&#160;&amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmathews3773&quot; class=&quot;user-hover&quot; rel=&quot;jmathews3773&quot;&gt;jmathews3773&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Issue #3&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;About&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt; When sink to Kafka using the&#160;&lt;font color=&quot;#ff0000&quot;&gt;Semantic.EXACTLY_ONCE&#160;&lt;/font&gt;mode.&lt;/p&gt;

&lt;p&gt;&amp;gt; The flink Kafka Connector Producer will auto set the&#160;&lt;font color=&quot;#ff0000&quot;&gt;transactional.id&lt;/font&gt;, and the user - defined value are ignored.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Details&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;There is nothing about such behaviour in official Flink documentation. Or I have missed it.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Summary&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;Should I&#160;create new/separate Jira issue to cover this gap ?&lt;/p&gt;</comment>
                            <comment id="17253484" author="nvolynets" created="Tue, 22 Dec 2020 13:10:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=freezhan&quot; class=&quot;user-hover&quot; rel=&quot;freezhan&quot;&gt;freezhan&lt;/a&gt;&#160;&amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmathews3773&quot; class=&quot;user-hover&quot; rel=&quot;jmathews3773&quot;&gt;jmathews3773&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Issue #4&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Why not give a possibility to specify `transaction-id` manually ? What is the main reason ?&lt;/p&gt;</comment>
                            <comment id="17255506" author="aljoscha" created="Mon, 28 Dec 2020 10:09:42 +0000"  >&lt;p&gt;Regarding Issues #1 and #2, these were proposed as potential fixes for this problem but in the end we went with the simplest solution, which is to just truncate the name. The Kafka transactional id and the operator UIDs that are mentioned in the documentation are not related, the latter is used only for mapping state to operators.&lt;/p&gt;

&lt;p&gt;Regarding your issues #3 and #4, I think you&apos;re right. We could make the transactional Id &lt;b&gt;prefix&lt;/b&gt; configurable, it&apos;s just that not enough users have asked for it so far. Or anyone really.&lt;/p&gt;</comment>
                            <comment id="17349586" author="freezhan" created="Sat, 22 May 2021 03:04:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nvolynets&quot; class=&quot;user-hover&quot; rel=&quot;nvolynets&quot;&gt;nvolynets&lt;/a&gt;&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22452&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-22452&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13341435">FLINK-20227</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13374885">FLINK-22452</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13002938" name="image-2020-05-14-20-43-57-414.png" size="326999" author="freezhan" created="Thu, 14 May 2020 12:44:00 +0000"/>
                            <attachment id="13002937" name="image-2020-05-14-20-45-24-030.png" size="296507" author="freezhan" created="Thu, 14 May 2020 12:45:26 +0000"/>
                            <attachment id="13002936" name="image-2020-05-14-20-45-59-878.png" size="133089" author="freezhan" created="Thu, 14 May 2020 12:46:01 +0000"/>
                            <attachment id="13002935" name="image-2020-05-14-21-09-01-906.png" size="218511" author="freezhan" created="Thu, 14 May 2020 13:09:04 +0000"/>
                            <attachment id="13002934" name="image-2020-05-14-21-16-43-810.png" size="122219" author="freezhan" created="Thu, 14 May 2020 13:16:49 +0000"/>
                            <attachment id="13002933" name="image-2020-05-14-21-17-09-784.png" size="109149" author="freezhan" created="Thu, 14 May 2020 13:17:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0eql4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>