<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6044] TypeSerializerSerializationProxy.read() doesn&apos;t verify the read buffer length</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6044</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The read() method of TypeSerializerSerializationProxy creates a buffers and tries to fill it by calling the read() method of the given DataInputView, but never checks the return value. The actual size read from the stream might be smaller than the buffer size, and the rest of the buffer is filled with zeroes, causing the deserialization to fail.&lt;br/&gt;
It happened to me using a RocksDB state backend backed by S3. The setup was done according to &lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.2/setup/aws.html#s3-simple-storage-service&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.apache.org/projects/flink/flink-docs-release-1.2/setup/aws.html#s3-simple-storage-service&lt;/a&gt; and everything worked correctly until I upgraded to Flink 1.2.0.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu server 12.04.5 64 bit&lt;br/&gt;
java version &quot;1.8.0_111&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.8.0_111-b14)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 25.111-b14, mixed mode)&lt;/p&gt;</environment>
        <key id="13055924">FLINK-6044</key>
            <summary>TypeSerializerSerializationProxy.read() doesn&apos;t verify the read buffer length</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srichter">Stefan Richter</assignee>
                                    <reporter username="avihai.berkovitz@microsoft.com">Avihai Berkovitz</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Mar 2017 12:48:39 +0000</created>
                <updated>Wed, 15 Mar 2017 19:11:46 +0000</updated>
                            <resolved>Wed, 15 Mar 2017 15:02:32 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15924201" author="srichter" created="Tue, 14 Mar 2017 13:39:32 +0000"  >&lt;p&gt;Thanks for reporting this. The &lt;tt&gt;read(...)&lt;/tt&gt; is intended to be a &lt;tt&gt;readFully(...)&lt;/tt&gt;. I will fix this.&lt;/p&gt;</comment>
                            <comment id="15924222" author="githubbot" created="Tue, 14 Mar 2017 13:49:52 +0000"  >&lt;p&gt;GitHub user StefanRRichter opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6044&quot; title=&quot;TypeSerializerSerializationProxy.read() doesn&amp;#39;t verify the read buffer length&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6044&quot;&gt;&lt;del&gt;FLINK-6044&lt;/del&gt;&lt;/a&gt; Replace calls to InputStream#read(...) with the indended&#8230;&lt;/p&gt;

&lt;p&gt;    This PR fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6044&quot; title=&quot;TypeSerializerSerializationProxy.read() doesn&amp;#39;t verify the read buffer length&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6044&quot;&gt;&lt;del&gt;FLINK-6044&lt;/del&gt;&lt;/a&gt;. On top of that, I searched through the code for calls to `InputStream#read(...)` that ignore their return value and replaced them with the intended `InputStream#readFully(...)` calls.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/StefanRRichter/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/StefanRRichter/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6044&quot; title=&quot;TypeSerializerSerializationProxy.read() doesn&amp;#39;t verify the read buffer length&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6044&quot;&gt;&lt;del&gt;FLINK-6044&lt;/del&gt;&lt;/a&gt;-readFully&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3533&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 342144a967c5d93ba87f1d2850b88dad7c796f81&lt;br/&gt;
Author: Stefan Richter &amp;lt;s.richter@data-artisans.com&amp;gt;&lt;br/&gt;
Date:   2017-03-14T13:45:00Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6044&quot; title=&quot;TypeSerializerSerializationProxy.read() doesn&amp;#39;t verify the read buffer length&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6044&quot;&gt;&lt;del&gt;FLINK-6044&lt;/del&gt;&lt;/a&gt; Replace calls to InputStream#read(...) with the indended InputStream#readFully(...)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15924223" author="githubbot" created="Tue, 14 Mar 2017 13:50:17 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    CC @uce @tillrohrmann &lt;/p&gt;</comment>
                            <comment id="15926301" author="githubbot" created="Wed, 15 Mar 2017 14:55:56 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your contribution @StefanRRichter. Changes look good to me. +1 for merging.&lt;/p&gt;</comment>
                            <comment id="15926303" author="githubbot" created="Wed, 15 Mar 2017 14:56:59 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @tillrohrmann. Merging this.&lt;/p&gt;</comment>
                            <comment id="15926317" author="srichter" created="Wed, 15 Mar 2017 15:02:32 +0000"  >&lt;p&gt;Fixed in cbaf4e5 (master)&lt;/p&gt;</comment>
                            <comment id="15926318" author="githubbot" created="Wed, 15 Mar 2017 15:02:45 +0000"  >&lt;p&gt;Github user StefanRRichter closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3533&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15926779" author="stephanewen" created="Wed, 15 Mar 2017 19:09:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srichter&quot; class=&quot;user-hover&quot; rel=&quot;srichter&quot;&gt;srichter&lt;/a&gt; I think we should try and safeguard Flink against running into the same bug again.&lt;/p&gt;</comment>
                            <comment id="15926785" author="stephanewen" created="Wed, 15 Mar 2017 19:11:46 +0000"  >&lt;p&gt;The &lt;tt&gt;read()&lt;/tt&gt; / &lt;tt&gt;readFully()&lt;/tt&gt; issue has occurred before, it will most likely occur again.&lt;/p&gt;

&lt;p&gt;A simple thing we can do is &quot;forbid&quot; that method in the same way as String/Byte conversions without a charset.&lt;br/&gt;
Take a look at the &lt;tt&gt;CheckForbiddenMethodsUsage&lt;/tt&gt; test in the manual tests. We can add such as test for the &lt;tt&gt;read()&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;We only need to remember executing the manual tests on every release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3c8on:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>