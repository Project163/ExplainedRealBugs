<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:47:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-16589] Flink Table SQL fails/crashes with big queries with lots of fields</title>
                <link>https://issues.apache.org/jira/browse/FLINK-16589</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;My use case is a streaming application with a few streaming tables.&lt;/p&gt;

&lt;p&gt;I was trying to build a SELECT query (and registering it as a temporary view) with about 200 fields/expressions out of another streaming table. The application is successfully submitted to Flink cluster. However the worker processes keep crashing, with the exception as quoted below.&#160;&lt;/p&gt;

&lt;p&gt;It clearly mentioned in the log that this is a bug, so I fire this ticket. By the way, if I lower the number of fields down to 100 then it works nicely.&lt;/p&gt;

&lt;p&gt;Please advice.&lt;/p&gt;

&lt;p&gt;Thanks a lot for all the efforts bring Flink up. It is really amazing!&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.RuntimeException: Could not instantiate generated class &lt;span class=&quot;code-quote&quot;&gt;&apos;GroupAggsHandler$9687&apos;&lt;/span&gt;&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:57)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.operators.aggregate.MiniBatchGroupAggFunction.open(MiniBatchGroupAggFunction.java:136)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.operators.bundle.AbstractMapBundleOperator.open(AbstractMapBundleOperator.java:84)&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.StreamTask.initializeStateAndOpen(StreamTask.java:1007)&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$beforeInvoke$0(StreamTask.java:454)&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.runThrowing(StreamTaskActionExecutor.java:94)&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.StreamTask.beforeInvoke(StreamTask.java:449)&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:461)&#160;&#160;&#160;&#160;at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:707)&#160;&#160;&#160;&#160;at org.apache.flink.runtime.taskmanager.Task.run(Task.java:532)&#160;&#160;&#160;&#160;at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)Caused by: org.apache.flink.util.FlinkRuntimeException: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:68)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:78)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:52)&#160;&#160;&#160;&#160;... 10 moreCaused by: org.apache.flink.shaded.guava18.com.google.common.util.concurrent.UncheckedExecutionException: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2203)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache.get(LocalCache.java:3937)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4739)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:66)&#160;&#160;&#160;&#160;... 12 moreCaused by: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.CompileUtils.doCompile(CompileUtils.java:81)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.CompileUtils.lambda$compile$1(CompileUtils.java:66)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4742)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)&#160;&#160;&#160;&#160;at org.apache.flink.shaded.guava18.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)&#160;&#160;&#160;&#160;... 15 moreCaused by: org.codehaus.janino.InternalCompilerException: Compiling &lt;span class=&quot;code-quote&quot;&gt;&quot;GroupAggsHandler$9687&quot;&lt;/span&gt;: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;retract(Lorg/apache/flink/table/dataformat/BaseRow;)V&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;GroupAggsHandler$9687&quot;&lt;/span&gt; grows beyond 64 KB&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:382)&#160;&#160;&#160;&#160;at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:237)&#160;&#160;&#160;&#160;at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:465)&#160;&#160;&#160;&#160;at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:216)&#160;&#160;&#160;&#160;at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:207)&#160;&#160;&#160;&#160;at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:80)&#160;&#160;&#160;&#160;at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:75)&#160;&#160;&#160;&#160;at org.apache.flink.table.runtime.generated.CompileUtils.doCompile(CompileUtils.java:78)&#160;&#160;&#160;&#160;... 21 moreCaused by: org.codehaus.janino.InternalCompilerException: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;retract(Lorg/apache/flink/table/dataformat/BaseRow;)V&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;GroupAggsHandler$9687&quot;&lt;/span&gt; grows beyond 64 KB&#160;&#160;&#160;&#160;at org.codehaus.janino.CodeContext.makeSpace(CodeContext.java:1009)&#160;&#160;&#160;&#160;at org.codehaus.janino.CodeContext.write(CodeContext.java:901)&#160;&#160;&#160;&#160;at org.codehaus.janino.CodeContext.writeShort(CodeContext.java:1026)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.writeConstantLongInfo(UnitCompiler.java:12274)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.pushConstant(UnitCompiler.java:10679)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:4936)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.access$8400(UnitCompiler.java:215)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$16.visitUnaryOperation(UnitCompiler.java:4414)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$16.visitUnaryOperation(UnitCompiler.java:4394)&#160;&#160;&#160;&#160;at org.codehaus.janino.Java$UnaryOperation.accept(Java.java:4719)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:4394)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.fakeCompile(UnitCompiler.java:3719)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:5569)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2580)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.access$2700(UnitCompiler.java:215)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$6.visitLocalVariableDeclarationStatement(UnitCompiler.java:1503)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$6.visitLocalVariableDeclarationStatement(UnitCompiler.java:1487)&#160;&#160;&#160;&#160;at org.codehaus.janino.Java$LocalVariableDeclarationStatement.accept(Java.java:3511)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:3388)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1357)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1330)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:822)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:432)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:215)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:411)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:406)&#160;&#160;&#160;&#160;at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1414)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:406)&#160;&#160;&#160;&#160;at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:378)&#160;&#160;&#160;&#160;... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13291536">FLINK-16589</key>
            <summary>Flink Table SQL fails/crashes with big queries with lots of fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="libenchao">Benchao Li</assignee>
                                    <reporter username="StarGhost">Viet Pham</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 13 Mar 2020 11:21:16 +0000</created>
                <updated>Wed, 16 Jun 2021 07:28:42 +0000</updated>
                            <resolved>Fri, 19 Jun 2020 08:20:07 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="17058673" author="ykt836" created="Fri, 13 Mar 2020 12:02:54 +0000"  >&lt;p&gt;The root cause is here:&lt;br/&gt;
Code of method &quot;retract(Lorg/apache/flink/table/dataformat/BaseRow;)V&quot; of class &quot;GroupAggsHandler$9687&quot; grows beyond 64 KB&#160;&lt;br/&gt;
We didn&apos;t do proper code split when generated code is too long.&#160;&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17058742" author="lzljs3620320" created="Fri, 13 Mar 2020 13:52:23 +0000"  >&lt;p&gt;If just too many fields in &quot;select *&quot; with &quot;group by&quot;, it can be resolved, just like `ProjectionCodeGenerator`, we can extract its &quot;loop&quot; code generation.&lt;/p&gt;</comment>
                            <comment id="17058745" author="libenchao" created="Fri, 13 Mar 2020 13:55:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ykt836&quot; class=&quot;user-hover&quot; rel=&quot;ykt836&quot;&gt;ykt836&lt;/a&gt;&#160;We did the code split only for CalcCodeGenerator in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15430&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-15430&lt;/a&gt;.&#160;&#160;&lt;/p&gt;

&lt;p&gt;If we need to split for &lt;tt&gt;GroupAggsHandler&lt;/tt&gt; too, I can help to do that.&lt;/p&gt;</comment>
                            <comment id="17058859" author="jark" created="Fri, 13 Mar 2020 15:42:52 +0000"  >&lt;p&gt;Yes. We didn&apos;t split code for GroupAggsHandler, but that can be done as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=libenchao&quot; class=&quot;user-hover&quot; rel=&quot;libenchao&quot;&gt;libenchao&lt;/a&gt; said, even though it is a complete solution... &lt;/p&gt;

&lt;p&gt;Assigned this issue to you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=libenchao&quot; class=&quot;user-hover&quot; rel=&quot;libenchao&quot;&gt;libenchao&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17059533" author="libenchao" created="Sun, 15 Mar 2020 02:15:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160;Thanks for the assignment.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=StarGhost&quot; class=&quot;user-hover&quot; rel=&quot;StarGhost&quot;&gt;StarGhost&lt;/a&gt;&#160;Could you show us the query which produces this exception? As you described above, you just did a SELECT, and then the exception is threw? Since the exception says the generated aggregation code is too long, there should be some aggregation in your query.&lt;/p&gt;</comment>
                            <comment id="17059534" author="starghost" created="Sun, 15 Mar 2020 02:29:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=libenchao&quot; class=&quot;user-hover&quot; rel=&quot;libenchao&quot;&gt;libenchao&lt;/a&gt;: please see below an excerpt. The actual query is actually twice as long (which generates the exception above). Yes there is an aggregation, but very simple one.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SELECT
        id AS id,
	LAST_VALUE(platform_domain) AS platform_domain,
	MAX(now) AS now,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_WTD6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 7, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 8, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H7,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 8, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 9, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H8,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 9, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 10, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H9,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 10, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 11, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H10,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 11, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 12, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H11,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 12, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 13, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H12,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 13, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 14, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H13,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 14, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 15, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H14,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 15, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 16, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H15,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 16, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 17, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H16,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 17, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 18, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H17,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 18, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 19, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H18,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 19, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 20, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H19,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 20, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 21, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H20,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 21, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 22, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H21,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 22, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 23, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H22,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 23, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 24, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_today_H23,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 7, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 8, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD7,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 8, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 9, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD8,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 9, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 10, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD9,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 10, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 11, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD10,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 11, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 12, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD11,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 12, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 13, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD12,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 13, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 14, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD13,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 14, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 15, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD14,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 15, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 16, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD15,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 16, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 17, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD16,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 17, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 18, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD17,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 18, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 19, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD18,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 19, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 20, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD19,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 20, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 21, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD20,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 21, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 22, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD21,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 22, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 23, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD22,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 23, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 24, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD23,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 24, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 25, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD24,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 25, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 26, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD25,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 26, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 27, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD26,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 27, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 28, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD27,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 28, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 29, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD28,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 29, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 30, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD29,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 30, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 31, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;delivered&apos;&lt;/span&gt;, revenue, 0)) AS nmv_trend_MTD30,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -MOD(CAST(DAYOFWEEK(now) AS INT) + 5, 7) + 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_WTD6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 7, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 8, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD7,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 8, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 9, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD8,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 9, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 10, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD9,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 10, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 11, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD10,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 11, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 12, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD11,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 12, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 13, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD12,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 13, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 14, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD13,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 14, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 15, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD14,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 15, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 16, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD15,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 16, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 17, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD16,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 17, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 18, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD17,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 18, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 19, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD18,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 19, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 20, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD19,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 20, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 21, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD20,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 21, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 22, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD21,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 22, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 23, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD22,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 23, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 24, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD23,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 24, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 25, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD24,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 25, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 26, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD25,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 26, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 27, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD26,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 27, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 28, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD27,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 28, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 29, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD28,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 29, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 30, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD29,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 30, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(DAY, -CAST(DAYOFMONTH(now) AS INT) + 1 + 31, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_MTD30,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 0, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 1, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H0,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 1, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 2, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H1,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 2, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 3, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H2,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 3, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 4, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H3,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 4, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 5, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H4,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 5, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 6, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H5,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 6, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 7, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H6,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 7, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 8, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H7,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 8, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 9, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H8,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 9, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 10, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H9,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 10, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 11, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H10,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 11, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 12, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H11,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 12, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 13, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H12,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 13, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 14, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H13,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 14, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 15, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H14,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 15, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 16, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H15,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 16, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 17, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H16,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 17, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 18, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H17,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 18, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 19, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H18,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 19, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 20, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H19,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 20, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 21, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H20,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 21, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 22, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H21,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 22, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 23, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H22,
	SUM(IF((time_slot BETWEEN TIMESTAMPADD(HOUR, 23, now) AND TIMESTAMPADD(SECOND, -1, TIMESTAMPADD(HOUR, 24, now))) AND pws_status = &lt;span class=&quot;code-quote&quot;&gt;&apos;shipped&apos;&lt;/span&gt;, revenue, 0)) AS shipped_revenue_trend_today_H23
FROM
	shop_items_stats
GROUP BY
	id
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17059536" author="libenchao" created="Sun, 15 Mar 2020 02:39:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=StarGhost&quot; class=&quot;user-hover&quot; rel=&quot;StarGhost&quot;&gt;StarGhost&lt;/a&gt;&#160;Thanks for the example. I&apos;ll fix this in a few days.&lt;/p&gt;</comment>
                            <comment id="17123490" author="danny0405" created="Tue, 2 Jun 2020 08:19:23 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17140331" author="libenchao" created="Fri, 19 Jun 2020 08:19:47 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;release-1.11:&#160;334b7b8b00885135b0682756f970b4e440f0f189&lt;/li&gt;
	&lt;li&gt;master:&#160;99fca58fe60199b93f962e5fbf0cb0314b9d3b99&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13384087">FLINK-23007</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ci0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>