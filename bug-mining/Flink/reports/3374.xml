<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:41:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-13869] Hive functions can not work in blink planner stream mode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-13869</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In flink, specifying the StreamTableEnvironment through the EnvironmentSetting using the blink planner, when using the UDAF in hive in the table API, the error is reported.&lt;/p&gt;

&lt;p&gt;The hive function should been make by correct constants and argTypes. Otherwise it will throw an exception. (See HiveAggSqlFunction)&lt;br/&gt;
In this isTableAggregate, it just want to check the aggregate function class type, so the better way is get the function instead of make a function.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.NullPointerException
	at java.util.Arrays.stream(Arrays.java:5004)
	at java.util.stream.Stream.of(Stream.java:1000)
	at org.apache.flink.table.types.utils.TypeConversions.fromLogicalToDataType(TypeConversions.java:67)
	at org.apache.flink.table.planner.functions.utils.HiveFunctionUtils.invokeSetArgs(HiveFunctionUtils.java:59)
	at org.apache.flink.table.planner.functions.utils.HiveAggSqlFunction.makeFunction(HiveAggSqlFunction.java:68)
	at org.apache.flink.table.planner.functions.utils.HiveAggSqlFunction.makeFunction(HiveAggSqlFunction.java:47)
	at org.apache.flink.table.planner.plan.utils.AggregateUtil$$anonfun$isTableAggregate$2.apply(AggregateUtil.scala:750)
	at org.apache.flink.table.planner.plan.utils.AggregateUtil$$anonfun$isTableAggregate$2.apply(AggregateUtil.scala:750)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.mutable.ResizableArray$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)
	at scala.collection.TraversableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;map(TraversableLike.scala:234)
	at scala.collection.AbstractTraversable.map(Traversable.scala:104)
	at org.apache.flink.table.planner.plan.utils.AggregateUtil$.isTableAggregate(AggregateUtil.scala:750)
	at org.apache.flink.table.planner.plan.utils.RelExplainUtil$.streamGroupAggregationToString(RelExplainUtil.scala:346)
	at org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecGroupAggregate.explainTerms(StreamExecGroupAggregate.scala:109)
	at org.apache.calcite.rel.AbstractRelNode.explain(AbstractRelNode.java:307)
	at org.apache.calcite.rel.AbstractRelNode.computeDigest(AbstractRelNode.java:388)
	at org.apache.calcite.rel.AbstractRelNode.recomputeDigest(AbstractRelNode.java:351)
	at org.apache.calcite.rel.AbstractRelNode.onRegister(AbstractRelNode.java:345)
	at org.apache.calcite.plan.volcano.VolcanoPlanner.registerImpl(VolcanoPlanner.java:1668)
	at org.apache.calcite.plan.volcano.VolcanoPlanner.register(VolcanoPlanner.java:846)
	at org.apache.calcite.plan.volcano.VolcanoPlanner.ensureRegistered(VolcanoPlanner.java:868)
	at org.apache.calcite.plan.volcano.VolcanoPlanner.ensureRegistered(VolcanoPlanner.java:1939)
	at org.apache.calcite.plan.volcano.VolcanoRuleCall.transformTo(VolcanoRuleCall.java:129)
	... 60 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13253199">FLINK-13869</key>
            <summary>Hive functions can not work in blink planner stream mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lzljs3620320">Jingsong Lee</assignee>
                                    <reporter username="Terry1897">Terry Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 27 Aug 2019 07:48:08 +0000</created>
                <updated>Wed, 30 Oct 2019 12:19:13 +0000</updated>
                            <resolved>Wed, 30 Oct 2019 12:12:20 +0000</resolved>
                                                    <fixVersion>1.10.0</fixVersion>
                                    <component>Connectors / Hive</component>
                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16916488" author="faaronzheng" created="Tue, 27 Aug 2019 08:00:00 +0000"  >&lt;p&gt;the demo is as follows, it causes above issue, but works fine in batch mode.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
      EnvironmentSettings bsSettings = EnvironmentSettings.newInstance().useBlinkPlanner().inStreamingMode().build();
      StreamTableEnvironment tableEnv = StreamTableEnvironment.create(env,bsSettings);
&lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//        ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//        BatchTableEnvironment tableEnv = BatchTableEnvironment.create(env);
&lt;/span&gt;        tableEnv.registerCatalog(&lt;span class=&quot;code-quote&quot;&gt;&quot;myHive1&quot;&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HiveCatalog(&lt;span class=&quot;code-quote&quot;&gt;&quot;myHive1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;p1_stream&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;,&quot;&lt;/span&gt;1.2.1&quot;));
        tableEnv.useCatalog(&lt;span class=&quot;code-quote&quot;&gt;&quot;myHive1&quot;&lt;/span&gt;);
        tableEnv.useDatabase(&lt;span class=&quot;code-quote&quot;&gt;&quot;p1_stream&quot;&lt;/span&gt;);
        Optional&amp;lt;Catalog&amp;gt; myHive1 = tableEnv.getCatalog(&lt;span class=&quot;code-quote&quot;&gt;&quot;myHive1&quot;&lt;/span&gt;);
        CatalogFunction catalogFunction= myHive1.get().getFunction(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ObjectPath(&lt;span class=&quot;code-quote&quot;&gt;&quot;p1_stream&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;abs&quot;&lt;/span&gt;));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(catalogFunction.getClassName());

        Table result = tableEnv.sqlQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT abs(a) FROM  abs_test&quot;&lt;/span&gt;);

      tableEnv.toAppendStream(result,Row.class).writeAsText(&lt;span class=&quot;code-quote&quot;&gt;&quot;hdfs:/user/result5.txt&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;//        tableEnv.toDataSet(result,Row.class).writeAsText(&lt;span class=&quot;code-quote&quot;&gt;&quot;hdfs:/user/result5.txt&quot;&lt;/span&gt;);
&lt;/span&gt;
        env.execute();

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16916495" author="lzljs3620320" created="Tue, 27 Aug 2019 08:04:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Terry1897&quot; class=&quot;user-hover&quot; rel=&quot;Terry1897&quot;&gt;Terry1897&lt;/a&gt;&#160;Thanks for reporting this issue, Can you share the testing code?&lt;/p&gt;</comment>
                            <comment id="16916974" author="phoenixjiangnan" created="Tue, 27 Aug 2019 18:22:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Terry1897&quot; class=&quot;user-hover&quot; rel=&quot;Terry1897&quot;&gt;Terry1897&lt;/a&gt; thanks for reporting the bug. I renamed it to &quot;Hive functions&quot; from &quot;Hive built-in functions&quot; as we havent&apos; supported Hive built-in functions yet.&lt;/p&gt;

&lt;p&gt;Also assigned to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;. Thanks Jingsong, let me know if you need anything from me&lt;/p&gt;</comment>
                            <comment id="16935538" author="jark" created="Mon, 23 Sep 2019 04:08:52 +0000"  >&lt;p&gt;Is there any progress on this issue ?&lt;/p&gt;</comment>
                            <comment id="16935547" author="lzljs3620320" created="Mon, 23 Sep 2019 04:33:51 +0000"  >&lt;p&gt;Still need fix, 1.9 should work, but master code has some problem. You can see detail in&#160;AggregateUtil.isTableAggregate.&lt;/p&gt;</comment>
                            <comment id="16962974" author="jark" created="Wed, 30 Oct 2019 12:12:20 +0000"  >&lt;p&gt;1.10.0: 1da3055338e5f23a3ec4a54152dbf6b4e35e3862&lt;/p&gt;</comment>
                            <comment id="16962976" author="jark" created="Wed, 30 Oct 2019 12:19:06 +0000"  >&lt;p&gt;I tried it in current 1.9  branch, and it doesn&apos;t have this problem. Removing the affects version 1.9. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12978651" name="image-2019-08-27-15-36-57-662.png" size="880672" author="Terry1897" created="Tue, 27 Aug 2019 07:37:01 +0000"/>
                            <attachment id="12978650" name="image-2019-08-27-15-37-11-230.png" size="880672" author="Terry1897" created="Tue, 27 Aug 2019 07:37:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z062jc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>