<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9634] Deactivate previous location based scheduling if local recovery is disabled</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9634</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;With Flink 1.5.0 we introduced local recovery. In order to make local recovery work we had to change the scheduling to be aware of the previous location of the &lt;tt&gt;Execution&lt;/tt&gt;. This scheduling strategy is also active if local recovery is deactivated. I suggest to also disable the scheduling strategy if local recovery is not enabled.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13167337">FLINK-9634</key>
            <summary>Deactivate previous location based scheduling if local recovery is disabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 21 Jun 2018 08:01:34 +0000</created>
                <updated>Thu, 12 Jul 2018 11:12:32 +0000</updated>
                            <resolved>Wed, 27 Jun 2018 13:12:16 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.1</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16523652" author="githubbot" created="Tue, 26 Jun 2018 12:22:56 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198121746&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198121746&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java &amp;#8212;&lt;br/&gt;
    @@ -280,12 +281,7 @@ public JobMaster(&lt;/p&gt;

&lt;p&gt;     		resourceManagerLeaderRetriever = highAvailabilityServices.getResourceManagerLeaderRetriever();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.slotPool = new SlotPool(&lt;/li&gt;
	&lt;li&gt;rpcService,&lt;/li&gt;
	&lt;li&gt;jobGraph.getJobID(),&lt;/li&gt;
	&lt;li&gt;SystemClock.getInstance(),&lt;/li&gt;
	&lt;li&gt;rpcTimeout,&lt;/li&gt;
	&lt;li&gt;jobMasterConfiguration.getSlotIdleTimeout());&lt;br/&gt;
    +		this.slotPool = checkNotNull(slotPoolFactory).createSlotPool(jobGraph.getJobID());
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    It seems like you could also construct the `SlotPool` outside just pass it directly into the constructor. The factory is only used to deliver the `SlotPool`-object and no reference is kept.&lt;/p&gt;</comment>
                            <comment id="16523653" author="githubbot" created="Tue, 26 Jun 2018 12:25:52 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198122538&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198122538&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java &amp;#8212;&lt;br/&gt;
    @@ -280,12 +281,7 @@ public JobMaster(&lt;/p&gt;

&lt;p&gt;     		resourceManagerLeaderRetriever = highAvailabilityServices.getResourceManagerLeaderRetriever();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.slotPool = new SlotPool(&lt;/li&gt;
	&lt;li&gt;rpcService,&lt;/li&gt;
	&lt;li&gt;jobGraph.getJobID(),&lt;/li&gt;
	&lt;li&gt;SystemClock.getInstance(),&lt;/li&gt;
	&lt;li&gt;rpcTimeout,&lt;/li&gt;
	&lt;li&gt;jobMasterConfiguration.getSlotIdleTimeout());&lt;br/&gt;
    +		this.slotPool = checkNotNull(slotPoolFactory).createSlotPool(jobGraph.getJobID());
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    After that, I also wonder if the factory still makes sense because we statically always use the same concrete implementation.&lt;/p&gt;</comment>
                            <comment id="16523677" author="githubbot" created="Tue, 26 Jun 2018 12:48:36 +0000"  >&lt;p&gt;Github user sihuazhou commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198129120&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198129120&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/DefaultSlotPoolFactory.java &amp;#8212;&lt;br/&gt;
    @@ -75,10 +82,21 @@ public static DefaultSlotPoolFactory fromConfiguration(&lt;br/&gt;
     		final Time rpcTimeout = AkkaUtils.getTimeoutAsTime(configuration);&lt;br/&gt;
     		final Time slotIdleTimeout = Time.milliseconds(configuration.getLong(JobManagerOptions.SLOT_IDLE_TIMEOUT));&lt;/p&gt;

&lt;p&gt;    +		final SchedulingStrategy schedulingStrategy = selectSchedulingStrategy(configuration);&lt;br/&gt;
    +&lt;br/&gt;
     		return new DefaultSlotPoolFactory(&lt;br/&gt;
     			rpcService,&lt;br/&gt;
    +			schedulingStrategy,&lt;br/&gt;
     			SystemClock.getInstance(),&lt;br/&gt;
     			rpcTimeout,&lt;br/&gt;
     			slotIdleTimeout);&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	private static SchedulingStrategy selectSchedulingStrategy(Configuration configuration) {&lt;br/&gt;
    +		if (configuration.getBoolean(CheckpointingOptions.LOCAL_RECOVERY)) &lt;/p&gt;
{
    +			return PreviousAllocationSchedulingStrategy.getInstance();
    +		}
&lt;p&gt; else {&lt;br/&gt;
    +			return LocationPreferenceSchedulingStrategy.getInstance();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Does it make sense to use the `LocationPreferenceSchedulingStrategy` for the init scheduling even when the &quot;local recovery&quot; is enable?&lt;/p&gt;</comment>
                            <comment id="16523680" author="githubbot" created="Tue, 26 Jun 2018 12:50:46 +0000"  >&lt;p&gt;Github user sihuazhou commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198129785&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198129785&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/resources/log4j-test.properties &amp;#8212;&lt;br/&gt;
    @@ -18,7 +18,7 @@&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Set root logger level to OFF to not flood build logs&lt;/li&gt;
	&lt;li&gt;set manually to INFO for debugging purposes&lt;br/&gt;
    -log4j.rootLogger=OFF, testlogger&lt;br/&gt;
    +log4j.rootLogger=INFO, testlogger
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This looks like should be reverted.&lt;/p&gt;</comment>
                            <comment id="16523717" author="githubbot" created="Tue, 26 Jun 2018 13:29:02 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198142470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198142470&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/LocationPreferenceSchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,119 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.ResourceID;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +import org.apache.flink.runtime.taskmanager.TaskManagerLocation;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.Iterator;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Default &lt;/p&gt;
{@link SchedulingStrategy}
&lt;p&gt; which tries to match a slot with its location preferences.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class LocationPreferenceSchedulingStrategy implements SchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final LocationPreferenceSchedulingStrategy INSTANCE = new LocationPreferenceSchedulingStrategy();&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Calculates the candidate&apos;s locality score.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	private static final BiFunction&amp;lt;Integer, Integer, Integer&amp;gt; LOCALITY_EVALUATION_FUNCTION = (localWeigh, hostLocalWeigh) -&amp;gt; localWeigh * 10 + hostLocalWeigh;&lt;br/&gt;
    +&lt;br/&gt;
    +	LocationPreferenceSchedulingStrategy() {}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can be `private`.&lt;/p&gt;</comment>
                            <comment id="16523719" author="githubbot" created="Tue, 26 Jun 2018 13:29:18 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198142541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198142541&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/PreviousAllocationSchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,85 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.AllocationID;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * &lt;/p&gt;
{@link SchedulingStrategy}
&lt;p&gt; which tries to match a slot with its previous &lt;/p&gt;
{@link AllocationID}
&lt;p&gt;.&lt;br/&gt;
    + * If the previous allocation cannot be found, then it returns &lt;/p&gt;
{@code null}
&lt;p&gt;. If the slot has not&lt;br/&gt;
    + * been scheduled before (no assigned allocation id), it will fall back to&lt;br/&gt;
    + * &lt;/p&gt;
{@link LocationPreferenceSchedulingStrategy}
&lt;p&gt;.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class PreviousAllocationSchedulingStrategy extends LocationPreferenceSchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final PreviousAllocationSchedulingStrategy INSTANCE = new PreviousAllocationSchedulingStrategy();&lt;br/&gt;
    +&lt;br/&gt;
    +	PreviousAllocationSchedulingStrategy() {}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can be `private`&lt;/p&gt;</comment>
                            <comment id="16523728" author="githubbot" created="Tue, 26 Jun 2018 13:39:42 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198146426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198146426&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/SchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,60 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Classes that implement this interface provide a method to match objects to somehow represent slot candidates&lt;br/&gt;
    + * against the &lt;/p&gt;
{@link SlotProfile}
&lt;p&gt; that produced the matcher object. A matching candidate is transformed into a&lt;br/&gt;
    + * desired result. If the matcher does not find a matching candidate, it returns null.&lt;br/&gt;
    + */&lt;br/&gt;
    +public interface SchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * This method takes the candidate slots, extracts slot contexts from them, filters them by the profile&lt;br/&gt;
    +	 * requirements and potentially by additional requirements, and produces a result from a match.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param slotProfile slotProfile for which to find a matching slot&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Indentation looks a bit inconsistent.&lt;/p&gt;</comment>
                            <comment id="16523731" author="githubbot" created="Tue, 26 Jun 2018 13:40:30 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198146744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198146744&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/resources/log4j-test.properties &amp;#8212;&lt;br/&gt;
    @@ -18,7 +18,7 @@&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Set root logger level to OFF to not flood build logs&lt;/li&gt;
	&lt;li&gt;set manually to INFO for debugging purposes&lt;br/&gt;
    -log4j.rootLogger=OFF, testlogger&lt;br/&gt;
    +log4j.rootLogger=INFO, testlogger
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Revert?&lt;/p&gt;</comment>
                            <comment id="16523736" author="githubbot" created="Tue, 26 Jun 2018 13:41:56 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think this is a good fix for the moment. Only had minor comments inline. LGTM &#128077; &lt;/p&gt;</comment>
                            <comment id="16524789" author="githubbot" created="Wed, 27 Jun 2018 09:12:17 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198420806&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198420806&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java &amp;#8212;&lt;br/&gt;
    @@ -280,12 +281,7 @@ public JobMaster(&lt;/p&gt;

&lt;p&gt;     		resourceManagerLeaderRetriever = highAvailabilityServices.getResourceManagerLeaderRetriever();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.slotPool = new SlotPool(&lt;/li&gt;
	&lt;li&gt;rpcService,&lt;/li&gt;
	&lt;li&gt;jobGraph.getJobID(),&lt;/li&gt;
	&lt;li&gt;SystemClock.getInstance(),&lt;/li&gt;
	&lt;li&gt;rpcTimeout,&lt;/li&gt;
	&lt;li&gt;jobMasterConfiguration.getSlotIdleTimeout());&lt;br/&gt;
    +		this.slotPool = checkNotNull(slotPoolFactory).createSlotPool(jobGraph.getJobID());
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The reason why I introduced the factory is that we want to create a `SlotPool` for the `JobID` of the given `JobGraph`. That way we enforce that the `SlotPool` is strictly instantiated with the right `JobID`. If we move the instantiation of the `SlotPool` out of the `JobMaster` we would have to rely on the outside code. Therefore, I would like to keep it like it is.&lt;/p&gt;</comment>
                            <comment id="16524790" author="githubbot" created="Wed, 27 Jun 2018 09:13:28 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198421151&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198421151&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/DefaultSlotPoolFactory.java &amp;#8212;&lt;br/&gt;
    @@ -75,10 +82,21 @@ public static DefaultSlotPoolFactory fromConfiguration(&lt;br/&gt;
     		final Time rpcTimeout = AkkaUtils.getTimeoutAsTime(configuration);&lt;br/&gt;
     		final Time slotIdleTimeout = Time.milliseconds(configuration.getLong(JobManagerOptions.SLOT_IDLE_TIMEOUT));&lt;/p&gt;

&lt;p&gt;    +		final SchedulingStrategy schedulingStrategy = selectSchedulingStrategy(configuration);&lt;br/&gt;
    +&lt;br/&gt;
     		return new DefaultSlotPoolFactory(&lt;br/&gt;
     			rpcService,&lt;br/&gt;
    +			schedulingStrategy,&lt;br/&gt;
     			SystemClock.getInstance(),&lt;br/&gt;
     			rpcTimeout,&lt;br/&gt;
     			slotIdleTimeout);&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	private static SchedulingStrategy selectSchedulingStrategy(Configuration configuration) {&lt;br/&gt;
    +		if (configuration.getBoolean(CheckpointingOptions.LOCAL_RECOVERY)) &lt;/p&gt;
{
    +			return PreviousAllocationSchedulingStrategy.getInstance();
    +		}
&lt;p&gt; else {&lt;br/&gt;
    +			return LocationPreferenceSchedulingStrategy.getInstance();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    It is used if the `Execution` don&apos;t have a previous location assigned. You can see this in the implementation of the `PreviousAllocationSchedulingStrategy` which extends `LocationPreferenceSchedulingStrategy`.&lt;/p&gt;</comment>
                            <comment id="16524791" author="githubbot" created="Wed, 27 Jun 2018 09:13:49 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198421252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198421252&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/resources/log4j-test.properties &amp;#8212;&lt;br/&gt;
    @@ -18,7 +18,7 @@&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Set root logger level to OFF to not flood build logs&lt;/li&gt;
	&lt;li&gt;set manually to INFO for debugging purposes&lt;br/&gt;
    -log4j.rootLogger=OFF, testlogger&lt;br/&gt;
    +log4j.rootLogger=INFO, testlogger
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Definitely.&lt;/p&gt;</comment>
                            <comment id="16524795" author="githubbot" created="Wed, 27 Jun 2018 09:15:00 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198421635&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198421635&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/LocationPreferenceSchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,119 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.ResourceID;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +import org.apache.flink.runtime.taskmanager.TaskManagerLocation;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.Iterator;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Default &lt;/p&gt;
{@link SchedulingStrategy}
&lt;p&gt; which tries to match a slot with its location preferences.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class LocationPreferenceSchedulingStrategy implements SchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final LocationPreferenceSchedulingStrategy INSTANCE = new LocationPreferenceSchedulingStrategy();&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Calculates the candidate&apos;s locality score.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	private static final BiFunction&amp;lt;Integer, Integer, Integer&amp;gt; LOCALITY_EVALUATION_FUNCTION = (localWeigh, hostLocalWeigh) -&amp;gt; localWeigh * 10 + hostLocalWeigh;&lt;br/&gt;
    +&lt;br/&gt;
    +	LocationPreferenceSchedulingStrategy() {}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I don&apos;t think so, since `PreviousAllocationSchedulingStrategy` extends this class.&lt;/p&gt;</comment>
                            <comment id="16524796" author="githubbot" created="Wed, 27 Jun 2018 09:15:10 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198421680&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198421680&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/PreviousAllocationSchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,85 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.AllocationID;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * &lt;/p&gt;
{@link SchedulingStrategy}
&lt;p&gt; which tries to match a slot with its previous &lt;/p&gt;
{@link AllocationID}
&lt;p&gt;.&lt;br/&gt;
    + * If the previous allocation cannot be found, then it returns &lt;/p&gt;
{@code null}
&lt;p&gt;. If the slot has not&lt;br/&gt;
    + * been scheduled before (no assigned allocation id), it will fall back to&lt;br/&gt;
    + * &lt;/p&gt;
{@link LocationPreferenceSchedulingStrategy}
&lt;p&gt;.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class PreviousAllocationSchedulingStrategy extends LocationPreferenceSchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final PreviousAllocationSchedulingStrategy INSTANCE = new PreviousAllocationSchedulingStrategy();&lt;br/&gt;
    +&lt;br/&gt;
    +	PreviousAllocationSchedulingStrategy() {}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes, will add it.&lt;/p&gt;</comment>
                            <comment id="16524797" author="githubbot" created="Wed, 27 Jun 2018 09:16:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198421923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198421923&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/SchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,60 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Classes that implement this interface provide a method to match objects to somehow represent slot candidates&lt;br/&gt;
    + * against the &lt;/p&gt;
{@link SlotProfile}
&lt;p&gt; that produced the matcher object. A matching candidate is transformed into a&lt;br/&gt;
    + * desired result. If the matcher does not find a matching candidate, it returns null.&lt;br/&gt;
    + */&lt;br/&gt;
    +public interface SchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * This method takes the candidate slots, extracts slot contexts from them, filters them by the profile&lt;br/&gt;
    +	 * requirements and potentially by additional requirements, and produces a result from a match.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param slotProfile slotProfile for which to find a matching slot&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Will correct it.&lt;/p&gt;</comment>
                            <comment id="16524799" author="githubbot" created="Wed, 27 Jun 2018 09:17:18 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @StefanRRichter and @sihuazhou. I&apos;ve addressed your comments. Merging this PR once Travis gives green light.&lt;/p&gt;</comment>
                            <comment id="16524908" author="githubbot" created="Wed, 27 Jun 2018 11:04:58 +0000"  >&lt;p&gt;Github user StefanRRichter commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208#discussion_r198453459&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208#discussion_r198453459&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/slotpool/LocationPreferenceSchedulingStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,119 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.jobmaster.slotpool;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.ResourceID;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.SlotProfile;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Locality;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmaster.SlotContext;&lt;br/&gt;
    +import org.apache.flink.runtime.taskmanager.TaskManagerLocation;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nonnull;&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.Iterator;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.function.BiFunction;&lt;br/&gt;
    +import java.util.function.Function;&lt;br/&gt;
    +import java.util.function.Predicate;&lt;br/&gt;
    +import java.util.stream.Stream;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Default &lt;/p&gt;
{@link SchedulingStrategy}
&lt;p&gt; which tries to match a slot with its location preferences.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class LocationPreferenceSchedulingStrategy implements SchedulingStrategy {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final LocationPreferenceSchedulingStrategy INSTANCE = new LocationPreferenceSchedulingStrategy();&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Calculates the candidate&apos;s locality score.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	private static final BiFunction&amp;lt;Integer, Integer, Integer&amp;gt; LOCALITY_EVALUATION_FUNCTION = (localWeigh, hostLocalWeigh) -&amp;gt; localWeigh * 10 + hostLocalWeigh;&lt;br/&gt;
    +&lt;br/&gt;
    +	LocationPreferenceSchedulingStrategy() {}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    &#128077; &lt;/p&gt;</comment>
                            <comment id="16525032" author="till.rohrmann" created="Wed, 27 Jun 2018 13:12:16 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
1.6.0: d5919d9c1d4054dbfa182e482e082940b4e2f24d&lt;br/&gt;
1.5.1: 4168d98522b32ffd946a460728a966cd13d62d08&lt;/p&gt;</comment>
                            <comment id="16525033" author="githubbot" created="Wed, 27 Jun 2018 13:12:46 +0000"  >&lt;p&gt;Github user tillrohrmann closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6208&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6208&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13167339">FLINK-9635</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3v2xj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>