<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:57:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22894] Window Top-N should allow n=1</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22894</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I tried to reimplement the Hourly Tips exercise from the DataStream training using Flink SQL. The objective of this exercise is to find the one taxi driver who earned the most in tips during each hour, and report that driver&apos;s driverId and the sum of their tips.&#160;&lt;/p&gt;

&lt;p&gt;This can be expressed as a window top-n query, where n=1, as in&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;FROM (&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; SELECT *, ROW_NUMBER() OVER&#160;&lt;/tt&gt;&lt;tt&gt;(PARTITION BY window_start, window_end ORDER BY sumOfTips DESC) as rownum&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; FROM (&#160;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; SELECT driverId, window_start, window_end, sum(tip) as sumOfTips&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; FROM TABLE(&#160;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; TUMBLE(TABLE fares, DESCRIPTOR(startTime), INTERVAL &apos;1&apos; HOUR))&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; GROUP BY driverId, window_start, window_end&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; )&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;) WHERE rownum = 1;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This fails because the &lt;tt&gt;WindowRankOperatorBuilder&lt;/tt&gt; insists on&#160;{{rankEnd &amp;gt; 1. }}So, in other words, while it is possible to report the top 2 drivers, or the driver in 2nd place, it&apos;s not possible to report only the top driver.&lt;/p&gt;

&lt;p&gt;This appears to be an off-by-one error in the range checking.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13382352">FLINK-22894</key>
            <summary>Window Top-N should allow n=1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jingzhang">Jing Zhang</assignee>
                                    <reporter username="alpinegizmo">David Anderson</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sun, 6 Jun 2021 18:35:21 +0000</created>
                <updated>Thu, 23 Sep 2021 17:25:03 +0000</updated>
                            <resolved>Wed, 9 Jun 2021 04:22:07 +0000</resolved>
                                    <version>1.13.1</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.2</fixVersion>
                                    <component>Table SQL / Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17358309" author="qingru zhang" created="Mon, 7 Jun 2021 02:39:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alpinegizmo&quot; class=&quot;user-hover&quot; rel=&quot;alpinegizmo&quot;&gt;alpinegizmo&lt;/a&gt;&#160;Thanks for reporting the bug. I would like to fix it soon.&lt;/p&gt;</comment>
                            <comment id="17358315" author="lzljs3620320" created="Mon, 7 Jun 2021 02:50:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alpinegizmo&quot; class=&quot;user-hover&quot; rel=&quot;alpinegizmo&quot;&gt;alpinegizmo&lt;/a&gt;&#160;Thanks! &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qingru+zhang&quot; class=&quot;user-hover&quot; rel=&quot;qingru zhang&quot;&gt;qingru zhang&lt;/a&gt;&#160;Assigned to u~&lt;/p&gt;</comment>
                            <comment id="17359750" author="lzljs3620320" created="Wed, 9 Jun 2021 04:22:07 +0000"  >&lt;p&gt;Fixed via:&lt;/p&gt;

&lt;p&gt;master:&#160;fcc4b89b7568cd955b139c8ebc5aa8f46e136a53&lt;/p&gt;

&lt;p&gt;release-1.13:&#160;160cfa41e406bda18e0cb257c5628039d0900e75&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0rp7c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>