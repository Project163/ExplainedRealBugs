<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:51:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19775] SystemProcessingTimeServiceTest.testImmediateShutdown is instable</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19775</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=8131&amp;amp;view=logs&amp;amp;j=d89de3df-4600-5585-dadc-9bbc9a5e661c&amp;amp;t=66b5c59a-0094-561d-0e44-b149dfdd586d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=8131&amp;amp;view=logs&amp;amp;j=d89de3df-4600-5585-dadc-9bbc9a5e661c&amp;amp;t=66b5c59a-0094-561d-0e44-b149dfdd586d&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-10-22T21:12:54.9462382Z [ERROR] testImmediateShutdown(org.apache.flink.streaming.runtime.tasks.SystemProcessingTimeServiceTest)  Time elapsed: 0.009 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
2020-10-22T21:12:54.9463024Z java.lang.InterruptedException
2020-10-22T21:12:54.9463331Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
2020-10-22T21:12:54.9463766Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502)
2020-10-22T21:12:54.9464140Z 	at org.apache.flink.core.testutils.OneShotLatch.await(OneShotLatch.java:63)
2020-10-22T21:12:54.9466014Z 	at org.apache.flink.streaming.runtime.tasks.SystemProcessingTimeServiceTest.testImmediateShutdown(SystemProcessingTimeServiceTest.java:154)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13336827">FLINK-19775</key>
            <summary>SystemProcessingTimeServiceTest.testImmediateShutdown is instable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="dian.fu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 23 Oct 2020 02:01:40 +0000</created>
                <updated>Wed, 25 Nov 2020 09:32:50 +0000</updated>
                            <resolved>Wed, 25 Nov 2020 09:32:50 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.3</fixVersion>
                    <fixVersion>1.12.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17231340" author="873925389@qq.com" created="Fri, 13 Nov 2020 10:00:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dian.fu&quot; class=&quot;user-hover&quot; rel=&quot;dian.fu&quot;&gt;dian.fu&lt;/a&gt; ,&#160;i&apos;m interested in this issus , could you assignee to me to repair.&lt;/p&gt;</comment>
                            <comment id="17231465" author="dian.fu" created="Fri, 13 Nov 2020 13:50:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=873925389%40qq.com&quot; class=&quot;user-hover&quot; rel=&quot;873925389@qq.com&quot;&gt;873925389@qq.com&lt;/a&gt;&#160;Thanks a lot, have assigned it to you~&lt;/p&gt;</comment>
                            <comment id="17232536" author="873925389@qq.com" created="Mon, 16 Nov 2020 05:26:18 +0000"  >&lt;p&gt;Hi,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dian.fu&quot; class=&quot;user-hover&quot; rel=&quot;dian.fu&quot;&gt;dian.fu&lt;/a&gt;, Looking forward to your follow-up to this pr &#65288;&lt;a href=&quot;https://github.com/apache/flink/pull/14076&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/14076&lt;/a&gt;&#65289;&lt;/p&gt;</comment>
                            <comment id="17235438" author="873925389@qq.com" created="Thu, 19 Nov 2020 12:57:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dian.fu&quot; class=&quot;user-hover&quot; rel=&quot;dian.fu&quot;&gt;dian.fu&lt;/a&gt;&#65292;Is there a way to reproduce it locally?&lt;/p&gt;</comment>
                            <comment id="17235442" author="dian.fu" created="Thu, 19 Nov 2020 13:02:08 +0000"  >&lt;p&gt;I have no idea how to reproduce it locally. You could try to run it repeatedly to see if it could be reproduced.&lt;/p&gt;</comment>
                            <comment id="17236026" author="873925389@qq.com" created="Fri, 20 Nov 2020 09:40:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/tillrohrmann&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;@tillrohrmann,&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dian.fu&quot; class=&quot;user-hover&quot; rel=&quot;dian.fu&quot;&gt;dian.fu&lt;/a&gt;&#160; ,Maybe I found the reason for the instability. It depends on when the thread A calling the await() method acquires the lock of the lock object in the jvm lock pool. According to the lock.wait() code in the await() method, we will know that it will cause the current thread A to enter the blocking state. At this point, trigger() will perform its work in the thread B to which it belongs. Suppose that when thread B executes to lock.notifyAll(), thread A will be awakened, but the lock of the lock object is not allocated in time and is still blocked. As long as the interrupt flag of thread A is true, InterruptedException will be thrown. So I thought of two solutions. The first point: Thread B changes the interrupt flag of thread A to false before executing lock.notifyAll(). This method can ensure that the A thread will not throw InterruptedException after being awakened, but how to restore the thread interruption flag for different threads still needs to be considered. The second point: Use catch code to catch the exception in the A thread, it will automatically restore the thread interruption flag, and make the compilation pass. But the second method cannot solve the problem of exception throwing.&lt;/p&gt;</comment>
                            <comment id="17236200" author="till.rohrmann" created="Fri, 20 Nov 2020 14:47:37 +0000"  >&lt;p&gt;I think this is not what is happening here. I think the test case &lt;tt&gt;testShutdownServiceUninterruptible&lt;/tt&gt; which runs before the failing test did not properly clear the &lt;tt&gt;isInterrupted&lt;/tt&gt; flag. I will create a PR to fix it.&lt;/p&gt;</comment>
                            <comment id="17237057" author="873925389@qq.com" created="Mon, 23 Nov 2020 01:56:04 +0000"  >&lt;p&gt;Okay, that sounds good&lt;/p&gt;</comment>
                            <comment id="17238630" author="till.rohrmann" created="Wed, 25 Nov 2020 09:32:50 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.12.0: c8521674e42f2a9a55b9ee0d2ffc2ef0911f4b60&lt;br/&gt;
1.11.3: 306bc8dc3863cc95bc7276d1aa3b32ace78bc4ca&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jxug:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>