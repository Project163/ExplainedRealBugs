<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:28:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6869] Scala serializers do not have the serialVersionUID specified</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6869</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently, all Scala serializers, e.g. &lt;tt&gt;OptionSerializer&lt;/tt&gt;, &lt;tt&gt;CaseClassSerializer&lt;/tt&gt;, &lt;tt&gt;TrySerializer&lt;/tt&gt; etc. do not have the serialVersionUID specified.&lt;/p&gt;

&lt;p&gt;In 1.3, the Scala serializer (all serializers in general) implementations had to be changed since implementation of the compatibility methods &lt;tt&gt;snapshotConfiguration&lt;/tt&gt;, &lt;tt&gt;ensureCompatibility&lt;/tt&gt; had to be implemented, resulting in a new serialVersionUID.&lt;br/&gt;
This means that when restoring from a snapshot pre-1.3 that contains Scala types as state, the previous serializer in the snapshot cannot be deserialized (due to UID mismatch).&lt;/p&gt;

&lt;p&gt;To fix this, we should specify the serialVersionUIDs of the Scala serializers to be what they originally were pre-1.3. This would then allow users with Scala types as state to restore from older versions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13078235">FLINK-6869</key>
            <summary>Scala serializers do not have the serialVersionUID specified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tzulitai">Tzu-Li (Gordon) Tai</assignee>
                                    <reporter username="tzulitai">Tzu-Li (Gordon) Tai</reporter>
                        <labels>
                            <label>flink-rel-1.3.1-blockers</label>
                    </labels>
                <created>Thu, 8 Jun 2017 07:17:47 +0000</created>
                <updated>Tue, 13 Jun 2017 05:54:22 +0000</updated>
                            <resolved>Tue, 13 Jun 2017 05:52:06 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.1</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>API / Scala</component>
                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16042715" author="githubbot" created="Thu, 8 Jun 2017 13:45:34 +0000"  >&lt;p&gt;GitHub user tzulitai opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6869&quot; title=&quot;Scala serializers do not have the serialVersionUID specified&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6869&quot;&gt;&lt;del&gt;FLINK-6869&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;scala&amp;#93;&lt;/span&gt; Specify serialVersionUID for all Scala serializers&lt;/p&gt;

&lt;p&gt;    This PR fixes 2 issues:&lt;/p&gt;

&lt;p&gt;    1. Configuration snapshots of Scala serializers were not readable:&lt;br/&gt;
    Prior to this PR, the configuration snapshot classes of Scala serializers did not have the proper default empty constructor that is used for deserializing the configuration snapshot.&lt;/p&gt;

&lt;p&gt;    Since some Scala serializers&apos; config snapshots extend the Java `CompositeTypeSerializerConfigSnapshot`, their config snapshot classes are also changed to be implemented in Java since in Scala we can only call a single base class constructor from subclasses.&lt;/p&gt;

&lt;p&gt;    2. Scala serializers did not specify the serialVersionUID:&lt;br/&gt;
    Previously, Scala serializers did not specify the `serialVersionUID`, and therefore prohibited restore from previous Flink version snapshots because the serializers&apos; implementations changed in 1.3.&lt;/p&gt;

&lt;p&gt;    The `serialVersionUID`s added in this PR are identical to what they were (as generated by Java) in Flink 1.2, so that we can at least restore state that were written with the Scala serializers as of 1.2.&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tzulitai/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tzulitai/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6869&quot; title=&quot;Scala serializers do not have the serialVersionUID specified&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6869&quot;&gt;&lt;del&gt;FLINK-6869&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4090&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 416bd3b122e79bdd8b5876e8d645b346110b67f0&lt;br/&gt;
Author: Tzu-Li (Gordon) Tai &amp;lt;tzulitai@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-06-08T06:52:04Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;scala&amp;#93;&lt;/span&gt; Fix instantiation of Scala serializers&apos; config snapshot classes&lt;/p&gt;

&lt;p&gt;    Prior to this commit, the configuration snapshot classes of Scala&lt;br/&gt;
    serializers did not have the proper default empty constructor that is&lt;br/&gt;
    used for deserializing the configuration snapshot.&lt;/p&gt;

&lt;p&gt;    Since some Scala serializers&apos; config snapshots extend the Java&lt;br/&gt;
    CompositeTypeSerializerConfigSnapshot, their config snapshot classes are&lt;br/&gt;
    also changed to be implemented in Java since in Scala we can only call a&lt;br/&gt;
    single base class constructor from subclasses.&lt;/p&gt;

&lt;p&gt;commit 16574c6623dd64846c888e6a608deb9ae3f081bd&lt;br/&gt;
Author: Tzu-Li (Gordon) Tai &amp;lt;tzulitai@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-06-08T13:29:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6869&quot; title=&quot;Scala serializers do not have the serialVersionUID specified&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6869&quot;&gt;&lt;del&gt;FLINK-6869&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;scala&amp;#93;&lt;/span&gt; Specify serialVersionUID for all Scala serializers&lt;/p&gt;

&lt;p&gt;    Previously, Scala serializers did not specify the serialVersionUID, and&lt;br/&gt;
    therefore prohibited restore from previous Flink version snapshots&lt;br/&gt;
    because the serializers&apos; implementations changed.&lt;/p&gt;

&lt;p&gt;    The serialVersionUIDs added in this commit are identical to what they&lt;br/&gt;
    were (as generated by Java) in Flink 1.2, so that we can at least&lt;br/&gt;
    restore state that were written with the Scala serializers as of 1.2.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16042717" author="githubbot" created="Thu, 8 Jun 2017 13:46:59 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    R: @StefanRRichter @aljoscha tagging you because I talked to you about the issue offline &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Could you have a quick look?&lt;/p&gt;</comment>
                            <comment id="16042720" author="githubbot" created="Thu, 8 Jun 2017 13:51:35 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    One caveat that this PR does not yet fully fix:&lt;br/&gt;
    the deserialization of the anonymous class serializers (`CaseClassSerializer` and `TraversableSerializer`), even with the `serialVersionUID` specified, can still fail because there is no guarantee of the generated classname of anonymous classes (it depends on the order of when the anonymous classes were instantiated, and format seems to also change across compilers).&lt;/p&gt;

&lt;p&gt;    At this moment, I&apos;ve hit a bit of a wall trying to resolve this. The problem was always there pre-1.3, as if users simply change the order of their Scala type serializer generation (simply changing call order of `createTypeInformation` for their Scala types), the classnames would change and they wouldn&apos;t be able to restore state.&lt;/p&gt;</comment>
                            <comment id="16042744" author="githubbot" created="Thu, 8 Jun 2017 14:12:27 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Overall, I think this is ok as a best effort until we have some eager registration that helps with the remaining problems in the heap backend.&lt;/p&gt;</comment>
                            <comment id="16046533" author="githubbot" created="Mon, 12 Jun 2017 12:59:19 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090#discussion_r121384869&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090#discussion_r121384869&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/typeutils/TypeSerializerSerializationUtil.java &amp;#8212;&lt;br/&gt;
    @@ -362,8 +407,14 @@ public void read(DataInputView in) throws IOException {&lt;br/&gt;
     			int serializerBytes = in.readInt();&lt;br/&gt;
     			byte[] buffer = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;serializerBytes&amp;#93;&lt;/span&gt;;&lt;br/&gt;
     			in.readFully(buffer);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;typeSerializer = InstantiationUtil.deserializeObject(buffer, userClassLoader);&lt;br/&gt;
    +&lt;br/&gt;
    +			ClassLoader old = Thread.currentThread().getContextClassLoader();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Maybe rename to `previousClassLoader`&lt;/p&gt;</comment>
                            <comment id="16047434" author="githubbot" created="Tue, 13 Jun 2017 05:18:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4090&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16047454" author="tzulitai" created="Tue, 13 Jun 2017 05:52:06 +0000"  >&lt;p&gt;Fixed for 1.3.1 via 7aafaf6aa549c30257cf6176fb220ce5150ee9fe.&lt;br/&gt;
Fixed for master via b216a4a0acf4e4d0463c3ed961d6a0258223491a.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3g0vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>