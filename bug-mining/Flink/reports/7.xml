<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:16:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-930] Netty Initialization is sometimes very slow</title>
                <link>https://issues.apache.org/jira/browse/FLINK-930</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I often see the initialization of Netty taking 3 seconds and then failing with the message &lt;/p&gt;

&lt;p&gt;&quot;WARN  io.netty.util.internal.ThreadLocalRandom                      - Failed to generate a seed from SecureRandom within 3 seconds. Not enough entrophy?&quot;&lt;/p&gt;

&lt;p&gt;This adds to every single run a 3 seconds delay, which is often more than the test time and causes our builds to run out of time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12720904">FLINK-930</key>
            <summary>Netty Initialization is sometimes very slow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uce">Ufuk Celebi</assignee>
                                    <reporter username="sewen">Stephan Ewen</reporter>
                        <labels>
                            <label>performance</label>
                    </labels>
                <created>Thu, 12 Jun 2014 16:21:12 +0000</created>
                <updated>Wed, 18 Jun 2014 22:47:35 +0000</updated>
                            <resolved>Wed, 18 Jun 2014 22:47:35 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14031994" author="githubbot" created="Sun, 15 Jun 2014 18:35:05 +0000"  >&lt;p&gt;GitHub user uce opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-930&quot; title=&quot;Netty Initialization is sometimes very slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-930&quot;&gt;&lt;del&gt;FLINK-930&lt;/del&gt;&lt;/a&gt; Netty Initialization is sometimes very slow&lt;/p&gt;

&lt;p&gt;    This is &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-930&quot; title=&quot;Netty Initialization is sometimes very slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-930&quot;&gt;&lt;del&gt;FLINK-930&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-930&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-930&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;    The issue with the Netty warning was reported in netty/netty#2412 and has been fixed in `4.0.19.Final`. I couldn&apos;t reproduce the reported problem (with and without the changes in this PR).&lt;/p&gt;

&lt;p&gt;    This PR contains the following changes:&lt;br/&gt;
    1. Update Netty version from `4.0.19.Final` to `4.0.20.Final` and&lt;br/&gt;
    2. Introduce `ExecutionMode` for TaskManagers, where in `LOCAL` mode the `NetworkConnectionManager` is not started (e.g. no ServerSocket binding etc.)&lt;/p&gt;

&lt;p&gt;    The 2. change speeds up the startup and shutdown time of the TaskManagers noticeably and solves/circumvents the reported problem with each test taking ~ 3 seconds for startup/shutdown.&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/uce/incubator-flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/uce/incubator-flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-930&quot; title=&quot;Netty Initialization is sometimes very slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-930&quot;&gt;&lt;del&gt;FLINK-930&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #19&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a0d3530aa137290bf2d690339bf028f272c12129&lt;br/&gt;
Author: uce &amp;lt;u.celebi@fu-berlin.de&amp;gt;&lt;br/&gt;
Date:   2014-06-13T08:41:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-930&quot; title=&quot;Netty Initialization is sometimes very slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-930&quot;&gt;&lt;del&gt;FLINK-930&lt;/del&gt;&lt;/a&gt; Netty Initialization is sometimes very slow&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14033183" author="githubbot" created="Mon, 16 Jun 2014 23:34:21 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#issuecomment-46251209&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#issuecomment-46251209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Can someone please review and merge? Travis is running consistently out of time atm and this PR should &quot;fix it&quot;. We can then further monitor the Netty ThreadLocalRandom warning.&lt;/p&gt;</comment>
                            <comment id="14033499" author="githubbot" created="Tue, 17 Jun 2014 06:55:24 +0000"  >&lt;p&gt;Github user rmetzger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#discussion_r13845277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#discussion_r13845277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: stratosphere-runtime/src/main/java/eu/stratosphere/runtime/io/network/ChannelManager.java &amp;#8212;&lt;br/&gt;
    @@ -99,8 +95,13 @@ public ChannelManager(ChannelLookupProtocol channelLookupService, InstanceConnec&lt;br/&gt;
     		this.discardBufferPool = new DiscardBufferPool();&lt;br/&gt;
     	}&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void shutdown() {&lt;/li&gt;
	&lt;li&gt;this.nettyConnectionManager.shutdown();&lt;br/&gt;
    +	public void shutdown()  {&lt;br/&gt;
    +		try 
{
    +			this.networkConnectionManager.shutdown();
    +		}
&lt;p&gt; catch (IOException e) {&lt;br/&gt;
    +			LOG.warn(&quot;NetworkConnectionManager did not shutdown properly.&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think we should log the exception as well here (I guess the error is unlikely and needs review by the user)&lt;/p&gt;</comment>
                            <comment id="14033500" author="githubbot" created="Tue, 17 Jun 2014 06:56:49 +0000"  >&lt;p&gt;Github user rmetzger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#discussion_r13845310&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#discussion_r13845310&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: stratosphere-runtime/src/main/java/eu/stratosphere/runtime/io/network/netty/NettyConnectionManager.java &amp;#8212;&lt;br/&gt;
    @@ -108,9 +130,9 @@ public void initChannel(SocketChannel channel) throws Exception {&lt;br/&gt;
     				.option(ChannelOption.SO_KEEPALIVE, true);&lt;/p&gt;

&lt;p&gt;     		try &lt;/p&gt;
{
    -			this.in.bind().sync();
    +			in.bind().sync();
     		}
&lt;p&gt; catch (InterruptedException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw new RuntimeException(&quot;Could not bind server socket for incoming connections.&quot;);&lt;br/&gt;
    +			throw new IOException(&quot;Interrupted while trying to bind server socket.&quot;);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I would also forward the exception here&lt;/p&gt;</comment>
                            <comment id="14033588" author="githubbot" created="Tue, 17 Jun 2014 09:16:01 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#issuecomment-46284531&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#issuecomment-46284531&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I agree with both your points and have addressed them. The thrown exceptions are rethrown as IOExceptions up to the TaskManager&apos;s shutdown method, where it is logged. I decided against changing the signature of the TaskManager&apos;s shutdown method to rethrow the Exception as I think this should go hand in hand with changes to the other component shutdowns as well.&lt;/p&gt;</comment>
                            <comment id="14033704" author="githubbot" created="Tue, 17 Jun 2014 11:56:03 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#issuecomment-46297333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#issuecomment-46297333&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Nice to see it green again: &lt;a href=&quot;https://travis-ci.org/uce/incubator-flink/builds/27754618&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/uce/incubator-flink/builds/27754618&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14033723" author="githubbot" created="Tue, 17 Jun 2014 12:25:15 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19#issuecomment-46299700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19#issuecomment-46299700&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good to me. Will merge.&lt;/p&gt;</comment>
                            <comment id="14034481" author="githubbot" created="Tue, 17 Jun 2014 22:19:30 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/19&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14036588" author="uce" created="Wed, 18 Jun 2014 22:47:35 +0000"  >&lt;p&gt;Merged in &lt;a href=&quot;https://github.com/apache/incubator-flink/commit/a70de7e3faef8afea0134c8fed1240d742cccb3d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;a70de7e3faef8afea0134c8fed1240d742cccb3d&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399103</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wphj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399220</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>