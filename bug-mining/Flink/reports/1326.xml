<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:25:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4872] Type erasure problem exclusively on cluster execution</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4872</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The following codes runs fine on local and collection execution environment but fails when executed on a cluster.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Problem.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.api.common.functions.MapFunction;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.api.java.DataSet;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.api.java.ExecutionEnvironment;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.api.java.tuple.Tuple1;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.Array;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Problem {

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Pojo {
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo&amp;lt;T&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Tuple1&amp;lt;T&amp;gt; {
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar&amp;lt;T&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Tuple1&amp;lt;T[]&amp;gt; {
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;UDF&amp;lt;T&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; MapFunction&amp;lt;Foo&amp;lt;T&amp;gt;, Bar&amp;lt;T&amp;gt;&amp;gt; {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; clazz;

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; UDF(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; clazz) {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.clazz = clazz;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Bar&amp;lt;T&amp;gt; map(Foo&amp;lt;T&amp;gt; value) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
      Bar&amp;lt;T&amp;gt; bar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bar&amp;lt;&amp;gt;();
      &lt;span class=&quot;code-comment&quot;&gt;//noinspection unchecked
&lt;/span&gt;      bar.f0 = (T[]) Array.newInstance(clazz, 10);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bar;
    }
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-comment&quot;&gt;// runs in local, collection and cluster execution
&lt;/span&gt;    withLong();
    &lt;span class=&quot;code-comment&quot;&gt;// runs in local and collection execution, fails on cluster execution
&lt;/span&gt;    withPojo();
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void withLong() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

    Foo&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo&amp;lt;&amp;gt;();
    foo.f0 = 42L;
    DataSet&amp;lt;Foo&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt;&amp;gt; barDataSource = env.fromElements(foo);
    DataSet&amp;lt;Bar&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt;&amp;gt; map = barDataSource.map(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UDF&amp;lt;&amp;gt;(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.class));

    map.print();
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void withPojo() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

    Foo&amp;lt;Pojo&amp;gt; foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo&amp;lt;&amp;gt;();
    foo.f0 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pojo();
    DataSet&amp;lt;Foo&amp;lt;Pojo&amp;gt;&amp;gt; barDataSource = env.fromElements(foo);
    DataSet&amp;lt;Bar&amp;lt;Pojo&amp;gt;&amp;gt; map = barDataSource.map(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UDF&amp;lt;&amp;gt;(Pojo.class));

    map.print();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;ProblemTest.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.test.util.MultipleProgramsTestBase;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.runner.RunWith;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.runners.Parameterized;

@RunWith(Parameterized.class)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ProblemTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MultipleProgramsTestBase {

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ProblemTest(TestExecutionMode mode) {
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(mode);
  }

  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testWithLong() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Problem.withLong();
  }

  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testWithPOJO() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Problem.withPojo();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;The &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type of function &lt;span class=&quot;code-quote&quot;&gt;&apos;withPojo(Problem.java:58)&apos;&lt;/span&gt; could not be determined automatically, due to type erasure. You can give type information hints by using the returns(...) method on the result of the transformation call, or by letting your function implement the &lt;span class=&quot;code-quote&quot;&gt;&apos;ResultTypeQueryable&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt;.
    org.apache.flink.api.java.DataSet.getType(DataSet.java:178)
    org.apache.flink.api.java.DataSet.collect(DataSet.java:407)
    org.apache.flink.api.java.DataSet.print(DataSet.java:1605)
    Problem.withPojo(Problem.java:60)
    Problem.main(Problem.java:38) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13013975">FLINK-4872</key>
            <summary>Type erasure problem exclusively on cluster execution</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="mju">Martin Junghanns</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Oct 2016 17:36:31 +0000</created>
                <updated>Thu, 28 Feb 2019 13:21:36 +0000</updated>
                            <resolved>Tue, 29 Nov 2016 09:13:41 +0000</resolved>
                                    <version>1.1.2</version>
                                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15667216" author="twalthr" created="Tue, 15 Nov 2016 14:01:27 +0000"  >&lt;p&gt;I will look into this issue.&lt;/p&gt;</comment>
                            <comment id="15667250" author="twalthr" created="Tue, 15 Nov 2016 14:14:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mju&quot; class=&quot;user-hover&quot; rel=&quot;mju&quot;&gt;mju&lt;/a&gt; can you also give an example for the class &lt;tt&gt;UDF&lt;/tt&gt;? Does it implement &lt;tt&gt;ResultTypeQueryable&lt;/tt&gt;? If not, this exception might be correct. Either the function must give information about the parameter of &lt;tt&gt;Bar&amp;lt;T&amp;gt;&lt;/tt&gt;, you supply it via &lt;tt&gt;.map(...).returns(Pojo.class)&lt;/tt&gt;, or the functions output is defined by the functions input.&lt;/p&gt;</comment>
                            <comment id="15670241" author="mju" created="Wed, 16 Nov 2016 11:44:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt; Thanks for looking into it. The actual UDF where it crashes can be found &lt;a href=&quot;https://github.com/dbs-leipzig/gradoop/blob/master/gradoop-flink/src/main/java/org/gradoop/flink/model/impl/operators/matching/single/preserving/explorative/functions/BuildEmbeddingWithTiePoint.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. If I remember correctly, I already tried the two ways of defining the output type.&lt;/p&gt;

&lt;p&gt;The (at least for me) confusing part of this is, that it runs on local and collection execution environments, but not on the cluster.&lt;/p&gt;</comment>
                            <comment id="15670710" author="twalthr" created="Wed, 16 Nov 2016 15:27:33 +0000"  >&lt;p&gt;I still can&apos;t reproduce your problem. What I noticed is that a POJO needs at least one field and should be serializable in your example code. Your code snippet works on my machine in local and cluster mode. Could you give more information about your cluster? JVM Version, OS etc.?&lt;/p&gt;</comment>
                            <comment id="15671192" author="mju" created="Wed, 16 Nov 2016 18:17:24 +0000"  >&lt;p&gt;I just reproduced it using the following steps:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;comment the &lt;tt&gt;withLong();&lt;/tt&gt; call in psvm&lt;/li&gt;
	&lt;li&gt;package Problem.java to problem.jar (I use mvn)&lt;/li&gt;
	&lt;li&gt;flink-1.1.2/bin/start-local.sh (runs 1 job manager and 1 task manager with 4 slots)&lt;/li&gt;
	&lt;li&gt;flink-1.1.2/bin/flink run -c Problem problem.jar&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;output on console:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;The &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type of function &lt;span class=&quot;code-quote&quot;&gt;&apos;withPojo(Problem.java:60)&apos;&lt;/span&gt; could not be determined automatically, due to type erasure. You can give type information hints by using the returns(...) method on the result of the transformation call, or by letting your function implement the &lt;span class=&quot;code-quote&quot;&gt;&apos;ResultTypeQueryable&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt;.
	org.apache.flink.api.java.DataSet.getType(DataSet.java:178)
	org.apache.flink.api.java.DataSet.collect(DataSet.java:407)
	org.apache.flink.api.java.DataSet.print(DataSet.java:1605)
	Problem.withPojo(Problem.java:62)
	Problem.main(Problem.java:40)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I also uploaded problem.jar to the web UI and ran it from there:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.flink.client.program.ProgramInvocationException: The main method caused an error.
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:524)
	at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:403)
	at org.apache.flink.client.program.OptimizerPlanEnvironment.getOptimizedPlan(OptimizerPlanEnvironment.java:80)
	at org.apache.flink.client.program.ClusterClient.getOptimizedPlan(ClusterClient.java:274)
	at org.apache.flink.runtime.webmonitor.handlers.JarActionHandler.getJobGraphAndClassLoader(JarActionHandler.java:95)
	at org.apache.flink.runtime.webmonitor.handlers.JarRunHandler.handleRequest(JarRunHandler.java:50)
	at org.apache.flink.runtime.webmonitor.RuntimeMonitorHandler.respondAsLeader(RuntimeMonitorHandler.java:88)
	at org.apache.flink.runtime.webmonitor.RuntimeMonitorHandlerBase.channelRead0(RuntimeMonitorHandlerBase.java:84)
	at org.apache.flink.runtime.webmonitor.RuntimeMonitorHandlerBase.channelRead0(RuntimeMonitorHandlerBase.java:44)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.handler.codec.http.router.Handler.routed(Handler.java:62)
	at io.netty.handler.codec.http.router.DualAbstractHandler.channelRead0(DualAbstractHandler.java:57)
	at io.netty.handler.codec.http.router.DualAbstractHandler.channelRead0(DualAbstractHandler.java:20)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at org.apache.flink.runtime.webmonitor.HttpRequestHandler.channelRead0(HttpRequestHandler.java:159)
	at org.apache.flink.runtime.webmonitor.HttpRequestHandler.channelRead0(HttpRequestHandler.java:65)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:242)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:147)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:847)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:131)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:137)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: org.apache.flink.api.common.functions.InvalidTypesException: The &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type of function &lt;span class=&quot;code-quote&quot;&gt;&apos;withPojo(Problem.java:60)&apos;&lt;/span&gt; could not be determined automatically, due to type erasure. You can give type information hints by using the returns(...) method on the result of the transformation call, or by letting your function implement the &lt;span class=&quot;code-quote&quot;&gt;&apos;ResultTypeQueryable&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt;.
	at org.apache.flink.api.java.DataSet.getType(DataSet.java:178)
	at org.apache.flink.api.java.DataSet.collect(DataSet.java:407)
	at org.apache.flink.api.java.DataSet.print(DataSet.java:1605)
	at Problem.withPojo(Problem.java:62)
	at Problem.main(Problem.java:40)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:509)
	... 35 more
Caused by: org.apache.flink.api.common.functions.InvalidTypesException: Could not convert GenericArrayType to &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.
	at org.apache.flink.api.java.typeutils.TypeExtractor.createTypeInfoWithTypeHierarchy(TypeExtractor.java:725)
	at org.apache.flink.api.java.typeutils.TypeExtractor.createSubTypesInfo(TypeExtractor.java:898)
	at org.apache.flink.api.java.typeutils.TypeExtractor.createTypeInfoWithTypeHierarchy(TypeExtractor.java:610)
	at org.apache.flink.api.java.typeutils.TypeExtractor.privateCreateTypeInfo(TypeExtractor.java:565)
	at org.apache.flink.api.java.typeutils.TypeExtractor.getUnaryOperatorReturnType(TypeExtractor.java:366)
	at org.apache.flink.api.java.typeutils.TypeExtractor.getUnaryOperatorReturnType(TypeExtractor.java:305)
	at org.apache.flink.api.java.typeutils.TypeExtractor.getMapReturnTypes(TypeExtractor.java:120)
	at org.apache.flink.api.java.DataSet.map(DataSet.java:215)
	at Problem.withPojo(Problem.java:60)
	... 41 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The part with &lt;tt&gt;Could not convert GenericArrayType to Class.&lt;/tt&gt; may be of some help?&lt;/p&gt;

&lt;p&gt;My local system runs&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;4.4.0-47-generic #68-Ubuntu SMP Wed Oct 26 19:39:52 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&lt;/li&gt;
	&lt;li&gt;java version &quot;1.8.0_111&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The cluster runs&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;openSuse with 3.16.7-29-desktop #1 SMP PREEMPT Fri Oct 23 00:46:04 UTC 2015 (6be6a97) x86_64 x86_64 x86_64 GNU/Linux&lt;/li&gt;
	&lt;li&gt;java version &quot;1.8.0_102&quot;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15673716" author="githubbot" created="Thu, 17 Nov 2016 13:23:57 +0000"  >&lt;p&gt;GitHub user twalthr opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4872&quot; title=&quot;Type erasure problem exclusively on cluster execution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4872&quot;&gt;&lt;del&gt;FLINK-4872&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;types&amp;#93;&lt;/span&gt; Type erasure problem exclusively on cluster execution&lt;/p&gt;

&lt;p&gt;    Thanks for contributing to Apache Flink. Before you open your pull request, please take the following check list into consideration.&lt;br/&gt;
    If your changes take all of the items into account, feel free to open your pull request. For more information and/or questions please refer to the &lt;span class=&quot;error&quot;&gt;&amp;#91;How To Contribute guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/how-to-contribute.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/how-to-contribute.html&lt;/a&gt;).&lt;br/&gt;
    In addition to going through the list, please provide a meaningful description of your changes.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; General&lt;/li&gt;
	&lt;li&gt;The pull request references the related JIRA issue (&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;FLINK-XXX&amp;#93;&lt;/span&gt; Jira title text&quot;)&lt;/li&gt;
	&lt;li&gt;The pull request addresses only one issue&lt;/li&gt;
	&lt;li&gt;Each commit in the PR has a meaningful commit message (including the JIRA id)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Documentation&lt;/li&gt;
	&lt;li&gt;Documentation has been added for new functionality&lt;/li&gt;
	&lt;li&gt;Old documentation affected by the pull request has been updated&lt;/li&gt;
	&lt;li&gt;JavaDoc for public methods has been added&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Tests &amp;amp; Build&lt;/li&gt;
	&lt;li&gt;Functionality added by the pull request is covered by tests&lt;/li&gt;
	&lt;li&gt;`mvn clean verify` has been executed successfully locally or a Travis build has passed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This PR solves a classloader issue in the TypeExtractor that only happens when using object arrays on a cluster. A test for this change would be difficult but in general this feature is already tested in the existing tests.&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/twalthr/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twalthr/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4872&quot; title=&quot;Type erasure problem exclusively on cluster execution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4872&quot;&gt;&lt;del&gt;FLINK-4872&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2823&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f8b17aaa1b79e8ffe9428e3d57b44cbae002bfdd&lt;br/&gt;
Author: twalthr &amp;lt;twalthr@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-11-17T13:17:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4872&quot; title=&quot;Type erasure problem exclusively on cluster execution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4872&quot;&gt;&lt;del&gt;FLINK-4872&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;types&amp;#93;&lt;/span&gt; Type erasure problem exclusively on cluster execution&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15673725" author="twalthr" created="Thu, 17 Nov 2016 13:26:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mju&quot; class=&quot;user-hover&quot; rel=&quot;mju&quot;&gt;mju&lt;/a&gt; thank you very much for reporting this issue and providing detailed information. I could identify and hopefully fix the issue. I opened a PR for it. Could you check if it solves your problem?&lt;/p&gt;</comment>
                            <comment id="15682781" author="mju" created="Mon, 21 Nov 2016 07:31:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt; Thank you! I will test it this week and report back here.&lt;/p&gt;</comment>
                            <comment id="15689921" author="githubbot" created="Wed, 23 Nov 2016 12:04:22 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think we can do a more solid approach to that. Would be good to not to rely on the context class loader.&lt;/p&gt;

&lt;p&gt;      1. You could use the classloader of the component type directly, i.e.,&lt;br/&gt;
      `classArray = (Class&amp;lt;OUT&amp;gt;) Class.forName(&quot;[&quot; + className, true, componentClass.getClassLoader());`&lt;/p&gt;

&lt;p&gt;      2. You can directly obtain the array class via this trick:&lt;br/&gt;
      `classArray = (Class&amp;lt;OUT&amp;gt;) (java.lang.reflect.Array.newInstance(componentClass, 0).getClass());`&lt;/p&gt;

</comment>
                            <comment id="15696012" author="githubbot" created="Fri, 25 Nov 2016 14:42:50 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the hint @StephanEwen. I improved the PR.&lt;/p&gt;</comment>
                            <comment id="15702090" author="githubbot" created="Mon, 28 Nov 2016 14:32:36 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good, +1 to merge&lt;/p&gt;</comment>
                            <comment id="15702317" author="githubbot" created="Mon, 28 Nov 2016 15:57:55 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging...&lt;/p&gt;</comment>
                            <comment id="15702591" author="githubbot" created="Mon, 28 Nov 2016 17:34:39 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2823&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15704756" author="twalthr" created="Tue, 29 Nov 2016 09:13:41 +0000"  >&lt;p&gt;Fixed in 3a27f55cfa03a96cb7aff5d25a6402a283be7b45.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35673:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>