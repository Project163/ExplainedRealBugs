<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9373] Fix potential data losing for RocksDBBackend</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9373</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently, when using RocksIterator we only use the &lt;em&gt;iterator.isValid()&lt;/em&gt; to check whether we have reached the end of the iterator. But that is not enough, if we refer to RocksDB&apos;s wiki &lt;a href=&quot;https://github.com/facebook/rocksdb/wiki/Iterator#error-handling&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/facebook/rocksdb/wiki/Iterator#error-handling&lt;/a&gt; we should find that even if &lt;em&gt;iterator.isValid()=true&lt;/em&gt;, there may also exist some internal error. A safer way to use the &lt;em&gt;RocksIterator&lt;/em&gt; is to always call the &lt;em&gt;iterator.status()&lt;/em&gt; to check the internal error of &lt;em&gt;RocksDB&lt;/em&gt;. There is a case from user email seems to lost data because of this &lt;a href=&quot;http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Missing-MapState-when-Timer-fires-after-restored-state-td20134.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Missing-MapState-when-Timer-fires-after-restored-state-td20134.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13159620">FLINK-9373</key>
            <summary>Fix potential data losing for RocksDBBackend</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sihuazhou">Sihua Zhou</assignee>
                                    <reporter username="sihuazhou">Sihua Zhou</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 May 2018 06:48:39 +0000</created>
                <updated>Wed, 6 Oct 2021 07:50:45 +0000</updated>
                            <resolved>Thu, 17 May 2018 13:19:51 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16476989" author="githubbot" created="Wed, 16 May 2018 07:51:10 +0000"  >&lt;p&gt;GitHub user sihuazhou opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9373&quot; title=&quot;Fix potential data losing for RocksDBBackend&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9373&quot;&gt;&lt;del&gt;FLINK-9373&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;state&amp;#93;&lt;/span&gt; Always call RocksIterator.status() to check the internal error of RocksDB&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Currently, when using RocksIterator we only use the `iterator.isValid()` to check whether we have reached the end of the iterator. But that is not enough, if we refer to RocksDB&apos;s wiki &lt;a href=&quot;https://github.com/facebook/rocksdb/wiki/Iterator#error-handling&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/facebook/rocksdb/wiki/Iterator#error-handling&lt;/a&gt; we should find that even if `iterator.isValid()=true`, there may also exist some internal errors. A safer way to use the `RocksIterator` is to always call the `iterator.status()` to check the internal error of RocksDB. There is one case from user email seems to lost data because of this &lt;a href=&quot;http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Missing-MapState-when-Timer-fires-after-restored-state-td20134.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Missing-MapState-when-Timer-fires-after-restored-state-td20134.html&lt;/a&gt; (I&apos;m not so sure yet)&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;Always call RocksIterator.status() to check the internal error of RocksDB&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is a trivial rework / code cleanup without any test coverage.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/sihuazhou/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/sihuazhou/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9373&quot; title=&quot;Fix potential data losing for RocksDBBackend&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9373&quot;&gt;&lt;del&gt;FLINK-9373&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6020&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b1d531949d521bb7d72cd389dfe72a4a5cf1bfc9&lt;br/&gt;
Author: sihuazhou &amp;lt;summerleafs@...&amp;gt;&lt;br/&gt;
Date:   2018-05-16T07:47:05Z&lt;/p&gt;

&lt;p&gt;    Always call RocksIterator.status() to check the internal error of RocksDB&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16477035" author="githubbot" created="Wed, 16 May 2018 08:28:25 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    cc @StefanRRichter &lt;/p&gt;</comment>
                            <comment id="16477309" author="githubbot" created="Wed, 16 May 2018 12:09:33 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The reasons that the travis given red light is unrelated...&lt;/p&gt;</comment>
                            <comment id="16477383" author="githubbot" created="Wed, 16 May 2018 12:57:53 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    A quick general question: could you observe any performance impact from calling the `status()` method in the loops. It looks like a native method and I am not sure that it is inexpensive. Maybe the better idea is to only check `isValid()` in the loops and check `status()` only once after the loop to ensure that everything was well and complete. Maybe that is also the reason why this is split into two methods in the first place. What do you think?&lt;/p&gt;</comment>
                            <comment id="16477387" author="githubbot" created="Wed, 16 May 2018 13:00:36 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StefanRRichter No, I didn&apos;t have any performance tests yet. I think you are right! Your proposal is the way I&apos;m going to choose. Addressing this...&lt;/p&gt;</comment>
                            <comment id="16477389" author="githubbot" created="Wed, 16 May 2018 13:01:25 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    You could also in `isRocksIteratorValid` run the check only if the return value is `false` if you like the helper method to avoid people forgetting about this check.&lt;/p&gt;</comment>
                            <comment id="16477393" author="githubbot" created="Wed, 16 May 2018 13:03:42 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StefanRRichter NO, I think that couldn&apos;t fix this issue, the problem here is that even `iterator.isValid()` return `true`, there may also some internal error in RocksDB. What do you think?&lt;/p&gt;</comment>
                            <comment id="16477397" author="githubbot" created="Wed, 16 May 2018 13:05:00 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yes, but eventually it will also return `false`, which is essentially the same as waiting until the loop terminates. Anyways, I think after the loop is the nicer way.&lt;/p&gt;</comment>
                            <comment id="16477399" author="githubbot" created="Wed, 16 May 2018 13:06:11 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Also from the RocksDB docs: `In another word, if Iterator::Valid() is true, status() is guaranteed to be OK()`&lt;/p&gt;</comment>
                            <comment id="16477406" author="githubbot" created="Wed, 16 May 2018 13:08:17 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think that is the incorrect one, If I&apos;m not confused by the wiki&apos;s content...&lt;/p&gt;</comment>
                            <comment id="16477409" author="githubbot" created="Wed, 16 May 2018 13:10:18 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oh you are right, this is confusing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; So does this also mean the status flag is cleared when we simple continue iterating and only check in the end?&lt;/p&gt;</comment>
                            <comment id="16477412" author="githubbot" created="Wed, 16 May 2018 13:11:47 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    That is a good question, and I&apos;m not sure...but I think that seems to be...&lt;/p&gt;</comment>
                            <comment id="16477413" author="githubbot" created="Wed, 16 May 2018 13:12:19 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think I am a bit torn here now...&lt;/p&gt;</comment>
                            <comment id="16477414" author="githubbot" created="Wed, 16 May 2018 13:14:21 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m going to check the native implementation and see whether the `status()` is a super cheap option...&lt;/p&gt;</comment>
                            <comment id="16477438" author="githubbot" created="Wed, 16 May 2018 13:42:46 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StefanRRichter I had a look at the implementation of the iterators in RocksDB, I found status just return the flag first `_status` as the result without any complex computation, But for some `composite Iterator` like the `MergeIteraor` and `TwoLevelIterator` it need to check all the `InternalIterator` they hold to decide the final status, and I also found the iterator could be reset to `OK` in some cases...Hmm...do you think this is super cheap or not?&lt;/p&gt;</comment>
                            <comment id="16477459" author="githubbot" created="Wed, 16 May 2018 13:52:58 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It sounds cheap if they just `&amp;amp;` all the flags from the sub iterators. In the end, we can see if there is a performance drop but better be correct first before fast.&lt;/p&gt;</comment>
                            <comment id="16477465" author="githubbot" created="Wed, 16 May 2018 13:57:02 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Agree, should be correct first before fast! Could you please have a look at this? I think it&apos;s already for a look now~&lt;/p&gt;</comment>
                            <comment id="16477549" author="githubbot" created="Wed, 16 May 2018 15:12:19 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    After double checking with the RocksDB docs, I am afraid that we need to introduce more checks because for example the point out that also after methods like `seek` the iterator an become corrupted. And if the status flag is potentially cleared, that means we need to check in all the places...crazy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16477554" author="githubbot" created="Wed, 16 May 2018 15:14:39 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oh My God...Is that means we need to wrap the `RocksIterator` to delegate all it API?&lt;/p&gt;</comment>
                            <comment id="16477556" author="githubbot" created="Wed, 16 May 2018 15:15:51 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It depends, maybe this is already covered currently because we might always do an iteration attempt that checks right after the seek. But in general, this is not very nice and fragile if true.&lt;/p&gt;</comment>
                            <comment id="16477560" author="githubbot" created="Wed, 16 May 2018 15:21:48 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Maybe we should ask them on their issue tracker what the best practise is? I cannot remember seeing such checks in their code examples. Have a hard time to believe that this can be true, because it is not really documented on the Java API and also why wouldn&apos;t they always call `status` internally?&lt;/p&gt;</comment>
                            <comment id="16477573" author="githubbot" created="Wed, 16 May 2018 15:24:23 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Agreed!&lt;/p&gt;</comment>
                            <comment id="16477592" author="githubbot" created="Wed, 16 May 2018 15:42:17 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    FYI, I found this issue related to problem: &lt;a href=&quot;https://github.com/facebook/rocksdb/issues/3558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/facebook/rocksdb/issues/3558&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16478558" author="githubbot" created="Thu, 17 May 2018 05:50:38 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Have&apos;t received any response from RocksDB yet, but I found this example with using `RocksIterator#stats()`: &lt;a href=&quot;https://github.com/facebook/rocksdb/blob/3453870677ee2648f38d70fe8aa7fa16a93a96d2/java/samples/src/main/java/RocksDBSample.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/facebook/rocksdb/blob/3453870677ee2648f38d70fe8aa7fa16a93a96d2/java/samples/src/main/java/RocksDBSample.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16478699" author="githubbot" created="Thu, 17 May 2018 07:56:11 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Let&apos;s wait a bit more for their response. It seems like this example is older than their corrected docs.&lt;/p&gt;</comment>
                            <comment id="16478842" author="srichter" created="Thu, 17 May 2018 10:10:24 +0000"  >&lt;p&gt;Maybe we can also take the PR basically &quot;as is&quot; for now so that we check the status for each iteration and add more checks in the next minor release if this turns out to be not enough. Does that make sense?&lt;/p&gt;</comment>
                            <comment id="16478848" author="sihuazhou" created="Thu, 17 May 2018 10:18:11 +0000"  >&lt;p&gt;I think that makes sense.&lt;/p&gt;</comment>
                            <comment id="16478857" author="srichter" created="Thu, 17 May 2018 10:23:24 +0000"  >&lt;p&gt;Well, but we are also at risk to have only a partial fix. Ok, I suggest that we introduce a wrapper and check status there for all the methods mentioned in the documentation:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Seek()&lt;/tt&gt;,&#160;&lt;tt&gt;Next()&lt;/tt&gt;,&#160;&lt;tt&gt;SeekToFirst()&lt;/tt&gt;,&#160;&lt;tt&gt;SeekToLast()&lt;/tt&gt;,&#160;&lt;tt&gt;SeekForPrev()&lt;/tt&gt;, and&#160;&lt;tt&gt;Prev()&lt;/tt&gt;. To be on the safe side, and see if there is any performance change. If it turns out that that is too much, we can still drop it again.&#160;{{}}&lt;/p&gt;</comment>
                            <comment id="16478861" author="srichter" created="Thu, 17 May 2018 10:26:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sihuazhou&quot; class=&quot;user-hover&quot; rel=&quot;sihuazhou&quot;&gt;sihuazhou&lt;/a&gt; Will you be able to do this quickly or can I take over because this is currently&#160;THE release blocker?&lt;/p&gt;</comment>
                            <comment id="16478865" author="sihuazhou" created="Thu, 17 May 2018 10:27:46 +0000"  >&lt;p&gt;I will updated the PR quickly.&lt;/p&gt;</comment>
                            <comment id="16478866" author="srichter" created="Thu, 17 May 2018 10:28:34 +0000"  >&lt;p&gt;Great, thanks a lot!&lt;/p&gt;</comment>
                            <comment id="16478945" author="githubbot" created="Thu, 17 May 2018 11:54:56 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    cc @StefanRRichter &lt;/p&gt;</comment>
                            <comment id="16478954" author="githubbot" created="Thu, 17 May 2018 12:03:06 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @sihuazhou ! LGTM &#128077; Will merge this.&lt;/p&gt;</comment>
                            <comment id="16479035" author="githubbot" created="Thu, 17 May 2018 13:17:41 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6020&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16479039" author="srichter" created="Thu, 17 May 2018 13:19:51 +0000"  >&lt;p&gt;Merged in:&lt;/p&gt;

&lt;p&gt;master:&#160;105b30686f&lt;/p&gt;

&lt;p&gt;release-1.5: c75c152984&lt;/p&gt;</comment>
                            <comment id="16479462" author="sihuazhou" created="Thu, 17 May 2018 17:57:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=srichter&quot; class=&quot;user-hover&quot; rel=&quot;srichter&quot;&gt;srichter&lt;/a&gt; FYI &lt;a href=&quot;https://github.com/facebook/rocksdb/issues/3558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3558&lt;/a&gt;, got reply from RocksDB. I think we chosen the right way that should go &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, cause the status could be reset.&lt;/p&gt;</comment>
                            <comment id="17168554" author="ming li" created="Fri, 31 Jul 2020 09:17:00 +0000"  >&lt;p&gt;Hi,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sihuazhou&quot; class=&quot;user-hover&quot; rel=&quot;sihuazhou&quot;&gt;sihuazhou&lt;/a&gt;. Recently I was reading the related code of flink-statebackend-rocksdb, and found that in the seekToLast method of org.apache.flink.contrib.streaming.state.RocksIteratorWrapper, iterator.seekToFirst is called. I am puzzled why iterator.seekToLast is not called.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;@Override 
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void seekToLast() { 
   iterator.seekToFirst(); 
   status(); 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17171524" author="ming li" created="Wed, 5 Aug 2020 14:02:59 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13405142">FLINK-24460</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3tri7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>