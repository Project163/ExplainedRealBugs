<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3774] Flink configuration is not correctly forwarded to PlanExecutor in ScalaShellRemoteEnvironment</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3774</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently, the &lt;tt&gt;ScalaShellRemoteEnvironment&lt;/tt&gt; does not correctly forwards the Flink configuration to the &lt;tt&gt;PlanExecutor&lt;/tt&gt;. Therefore, it is not possible to use the Scala shell in combination with an HA cluster which needs the configuration parameters set in the configuration.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12959574">FLINK-3774</key>
            <summary>Flink configuration is not correctly forwarded to PlanExecutor in ScalaShellRemoteEnvironment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2016 08:31:37 +0000</created>
                <updated>Mon, 25 Apr 2016 13:31:34 +0000</updated>
                            <resolved>Mon, 25 Apr 2016 13:31:33 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Scala Shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15245871" author="githubbot" created="Mon, 18 Apr 2016 15:44:43 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3774&quot; title=&quot;Flink configuration is not correctly forwarded to PlanExecutor in ScalaShellRemoteEnvironment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3774&quot;&gt;&lt;del&gt;FLINK-3774&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;shell&amp;#93;&lt;/span&gt; Forwards Flink configuration to PlanExecutor&lt;/p&gt;

&lt;p&gt;    Thanks for contributing to Apache Flink. Before you open your pull request, please take the following check list into consideration.&lt;br/&gt;
    If your changes take all of the items into account, feel free to open your pull request. For more information and/or questions please refer to the &lt;span class=&quot;error&quot;&gt;&amp;#91;How To Contribute guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/how-to-contribute.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/how-to-contribute.html&lt;/a&gt;).&lt;br/&gt;
    In addition to going through the list, please provide a meaningful description of your changes.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;X&amp;#93;&lt;/span&gt; General&lt;/li&gt;
	&lt;li&gt;The pull request references the related JIRA issue&lt;/li&gt;
	&lt;li&gt;The pull request addresses only one issue&lt;/li&gt;
	&lt;li&gt;Each commit in the PR has a meaningful commit message&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;X&amp;#93;&lt;/span&gt; Documentation&lt;/li&gt;
	&lt;li&gt;Documentation has been added for new functionality&lt;/li&gt;
	&lt;li&gt;Old documentation affected by the pull request has been updated&lt;/li&gt;
	&lt;li&gt;JavaDoc for public methods has been added&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;X&amp;#93;&lt;/span&gt; Tests &amp;amp; Build&lt;/li&gt;
	&lt;li&gt;Functionality added by the pull request is covered by tests&lt;/li&gt;
	&lt;li&gt;`mvn clean verify` has been executed successfully locally or a Travis build has passed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The ScalaShellRemoteEnvironment did not properly forward the given Flink configuration&lt;br/&gt;
    to the PlanExecutor. Consequently, it was not possible to configure the Client to connect&lt;br/&gt;
    to an HA cluster. This PR corrects the forwarding.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; fixScalaShell&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1904&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 427fe789dcd20ba94dc9cebcef85b629ada6ce9c&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-04-18T15:41:47Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3774&quot; title=&quot;Flink configuration is not correctly forwarded to PlanExecutor in ScalaShellRemoteEnvironment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3774&quot;&gt;&lt;del&gt;FLINK-3774&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;shell&amp;#93;&lt;/span&gt; Forwards Flink configuration to PlanExecutor&lt;/p&gt;

&lt;p&gt;    The ScalaShellRemoteEnvironment did not properly forward the given Flink configuration&lt;br/&gt;
    to the PlanExecutor. Consequently, it was not possible to configure the Client to connect&lt;br/&gt;
    to an HA cluster. This PR corrects the forwarding.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15247621" author="githubbot" created="Tue, 19 Apr 2016 12:00:52 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904#discussion_r60217702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904#discussion_r60217702&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/RemoteEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -133,26 +137,31 @@ public RemoteEnvironment(String host, int port, Configuration clientConfig,&lt;br/&gt;
     		this.port = port;&lt;br/&gt;
     		this.clientConfiguration = clientConfig == null ? new Configuration() : clientConfig;&lt;br/&gt;
     		if (jarFiles != null) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.jarFiles = new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;jarFiles.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +			this.jarFiles = new ArrayList&amp;lt;URL&amp;gt;(jarFiles.length);&lt;br/&gt;
     			for (int i = 0; i &amp;lt; jarFiles.length; i++) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {     				try {
    -					this.jarFiles[i] = new File(jarFiles[i]).getAbsoluteFile().toURI().toURL();
    +					this.jarFiles.add(new File(jarFiles[i]).getAbsoluteFile().toURI().toURL());
     				} catch (MalformedURLException e) {
     					throw new IllegalArgumentException(&quot;JAR file path invalid&quot;, e);
     				}     			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     		}&lt;br/&gt;
     		else &lt;/p&gt;
{
    -			this.jarFiles = null;
    +			this.jarFiles = Collections.emptyList();
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		if (globalClasspaths == null) &lt;/p&gt;
{
    +			this.globalClasspaths = Collections.emptyList();
    +		}
&lt;p&gt; else &lt;/p&gt;
{
    +			this.globalClasspaths = Arrays.asList(globalClasspaths);
     		}&lt;/li&gt;
	&lt;li&gt;this.globalClasspaths = globalClasspaths;&lt;br/&gt;
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	// ------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;     	@Override&lt;br/&gt;
     	public JobExecutionResult execute(String jobName) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ensureExecutorCreated();&lt;br/&gt;
    +		PlanExecutor executor = getExecutor();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    would it make sense to move the assignment to ```this.executor``` from ```getExecutor()``` to this line? as it stands the ScalaShellRemoteEnvironment executor is never closed.&lt;/p&gt;</comment>
                            <comment id="15247757" author="githubbot" created="Tue, 19 Apr 2016 13:38:28 +0000"  >&lt;p&gt;Github user smarthi commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904#discussion_r60231836&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904#discussion_r60231836&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/RemoteEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -133,26 +137,31 @@ public RemoteEnvironment(String host, int port, Configuration clientConfig,&lt;br/&gt;
     		this.port = port;&lt;br/&gt;
     		this.clientConfiguration = clientConfig == null ? new Configuration() : clientConfig;&lt;br/&gt;
     		if (jarFiles != null) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.jarFiles = new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;jarFiles.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +			this.jarFiles = new ArrayList&amp;lt;URL&amp;gt;(jarFiles.length);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Nitpick - No need of &amp;lt;URL&amp;gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="15247793" author="githubbot" created="Tue, 19 Apr 2016 14:01:09 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904#discussion_r60235985&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904#discussion_r60235985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/RemoteEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -133,26 +137,31 @@ public RemoteEnvironment(String host, int port, Configuration clientConfig,&lt;br/&gt;
     		this.port = port;&lt;br/&gt;
     		this.clientConfiguration = clientConfig == null ? new Configuration() : clientConfig;&lt;br/&gt;
     		if (jarFiles != null) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.jarFiles = new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;jarFiles.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +			this.jarFiles = new ArrayList&amp;lt;URL&amp;gt;(jarFiles.length);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Will fix it.&lt;/p&gt;</comment>
                            <comment id="15247805" author="githubbot" created="Tue, 19 Apr 2016 14:13:21 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1904#discussion_r60238192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1904#discussion_r60238192&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/RemoteEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -133,26 +137,31 @@ public RemoteEnvironment(String host, int port, Configuration clientConfig,&lt;br/&gt;
     		this.port = port;&lt;br/&gt;
     		this.clientConfiguration = clientConfig == null ? new Configuration() : clientConfig;&lt;br/&gt;
     		if (jarFiles != null) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.jarFiles = new URL&lt;span class=&quot;error&quot;&gt;&amp;#91;jarFiles.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +			this.jarFiles = new ArrayList&amp;lt;URL&amp;gt;(jarFiles.length);&lt;br/&gt;
     			for (int i = 0; i &amp;lt; jarFiles.length; i++) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {     				try {
    -					this.jarFiles[i] = new File(jarFiles[i]).getAbsoluteFile().toURI().toURL();
    +					this.jarFiles.add(new File(jarFiles[i]).getAbsoluteFile().toURI().toURL());
     				} catch (MalformedURLException e) {
     					throw new IllegalArgumentException(&quot;JAR file path invalid&quot;, e);
     				}     			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     		}&lt;br/&gt;
     		else &lt;/p&gt;
{
    -			this.jarFiles = null;
    +			this.jarFiles = Collections.emptyList();
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		if (globalClasspaths == null) &lt;/p&gt;
{
    +			this.globalClasspaths = Collections.emptyList();
    +		}
&lt;p&gt; else &lt;/p&gt;
{
    +			this.globalClasspaths = Arrays.asList(globalClasspaths);
     		}&lt;/li&gt;
	&lt;li&gt;this.globalClasspaths = globalClasspaths;&lt;br/&gt;
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	// ------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;     	@Override&lt;br/&gt;
     	public JobExecutionResult execute(String jobName) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ensureExecutorCreated();&lt;br/&gt;
    +		PlanExecutor executor = getExecutor();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    You&apos;re right, it&apos;s bad that the `PlanExecutor` is not stopped after it has been used. I will fix this by checking in `ScalaShellRemoteEnvironment` whether `this.executor` is set. If true, then it will call `this.executor.stop()`. That way, there will always be at most one `PlanExecutor` active and the last one is stopped by the `dispose` call.&lt;/p&gt;</comment>
                            <comment id="15256337" author="till.rohrmann" created="Mon, 25 Apr 2016 13:31:33 +0000"  >&lt;p&gt;Fixed via 0ee7c79a32f3aa39f740bdecbf53487f39f6591f&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2w8y7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>