<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:44:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-16265] TPC-H end-to-end test (Blink Planner): Encodings that differ from the schema are not supported yet for CsvTableSources.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-16265</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/apache/flink/jobs/654409371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/flink/jobs/654409371&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Dispatcher REST endpoint is up.
Running query #1...
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.flink.table.client.SqlClientException: Unexpected exception. This is a bug. Please consider filing an issue.
	at org.apache.flink.table.client.SqlClient.main(SqlClient.java:190)
Caused by: org.apache.flink.table.client.gateway.SqlExecutionException: Could not create execution context.
	at org.apache.flink.table.client.gateway.local.ExecutionContext$Builder.build(ExecutionContext.java:779)
	at org.apache.flink.table.client.gateway.local.LocalExecutor.openSession(LocalExecutor.java:228)
	at org.apache.flink.table.client.SqlClient.start(SqlClient.java:98)
	at org.apache.flink.table.client.SqlClient.main(SqlClient.java:178)
Caused by: org.apache.flink.table.api.TableException: Encodings that differ from the schema are not supported yet &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; CsvTableSources.
	at org.apache.flink.table.sources.CsvTableSourceFactoryBase.createTableSource(CsvTableSourceFactoryBase.java:127)
	at org.apache.flink.table.sources.CsvAppendTableSourceFactory.createStreamTableSource(CsvAppendTableSourceFactory.java:46)
	at org.apache.flink.table.factories.StreamTableSourceFactory.createTableSource(StreamTableSourceFactory.java:55)
	at org.apache.flink.table.factories.TableSourceFactory.createTableSource(TableSourceFactory.java:63)
	at org.apache.flink.table.factories.TableSourceFactory.createTableSource(TableSourceFactory.java:74)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.createTableSource(ExecutionContext.java:384)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.lambda$initializeCatalogs$6(ExecutionContext.java:585)
	at java.util.LinkedHashMap.forEach(LinkedHashMap.java:684)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.initializeCatalogs(ExecutionContext.java:583)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.initializeTableEnvironment(ExecutionContext.java:520)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.&amp;lt;init&amp;gt;(ExecutionContext.java:165)
	at org.apache.flink.table.client.gateway.local.ExecutionContext.&amp;lt;init&amp;gt;(ExecutionContext.java:122)
	at org.apache.flink.table.client.gateway.local.ExecutionContext$Builder.build(ExecutionContext.java:768)
	... 3 more
[FAIL] Test script contains errors.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13287370">FLINK-16265</key>
            <summary>TPC-H end-to-end test (Blink Planner): Encodings that differ from the schema are not supported yet for CsvTableSources.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lzljs3620320">Jingsong Lee</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 24 Feb 2020 23:25:03 +0000</created>
                <updated>Fri, 28 Feb 2020 09:59:44 +0000</updated>
                            <resolved>Fri, 28 Feb 2020 09:59:44 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17044092" author="jark" created="Tue, 25 Feb 2020 03:16:57 +0000"  >&lt;p&gt;I think this is also introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15912&quot; title=&quot;ï¿½Add Context to improve TableSourceFactory and TableSinkFactory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15912&quot;&gt;&lt;del&gt;FLINK-15912&lt;/del&gt;&lt;/a&gt;. I reproduced the problem using the following yaml:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
tables:
  - name: lineitem
    type: source-table
    update-mode: append
    connector:
      type: filesystem
      path: &lt;span class=&quot;code-quote&quot;&gt;&quot;$TABLE_DIR/lineitem.csv&quot;&lt;/span&gt;
    format:
      type: csv
      fields:
        - name: l_linestatus
          type: VARCHAR
        - name: l_shipdate
          type: DATE
        - name: l_commitdate
          type: TIMESTAMP
      field-delimiter: &lt;span class=&quot;code-quote&quot;&gt;&quot;|&quot;&lt;/span&gt;
      line-delimiter: &lt;span class=&quot;code-quote&quot;&gt;&quot;\n&quot;&lt;/span&gt;
      comment-prefix: &lt;span class=&quot;code-quote&quot;&gt;&quot;--&quot;&lt;/span&gt;
    schema:
      - name: l_linestatus
        type: VARCHAR
      - name: l_shipdate
        type: DATE
      - name: l_commitdate
        type: TIMESTAMP
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The root cause is we will convert the properties into CatalogTableImpl and then convert into properties again. The schema type properties will use new type systems then which is not equal to the legacy types. &lt;/p&gt;
</comment>
                            <comment id="17044104" author="lzljs3620320" created="Tue, 25 Feb 2020 04:04:22 +0000"  >&lt;p&gt;This is something related to&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15038&quot; title=&quot;Get field DataType of TableSchema should return DataType with default conversion class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15038&quot;&gt;FLINK-15038&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;TableSchema&lt;/tt&gt; should not contains various conversion classes.&lt;/p&gt;</comment>
                            <comment id="17044105" author="lzljs3620320" created="Tue, 25 Feb 2020 04:05:42 +0000"  >&lt;p&gt;I think the fix we can do could be comparing &lt;tt&gt;LogicalType&lt;/tt&gt;&#160;in &lt;tt&gt;TableSchema.equals/hashCode&lt;/tt&gt;&#160;instead of DataType with conversion classes.&lt;/p&gt;</comment>
                            <comment id="17044396" author="twalthr" created="Tue, 25 Feb 2020 12:31:07 +0000"  >&lt;p&gt;I think &lt;tt&gt;TableSchema&lt;/tt&gt; should be just a POJO and forward what it contains. Thus, a equals/hashCode should verify the DataType entirely. Of course it doesn&apos;t make much sense that &lt;tt&gt;TableSchema&lt;/tt&gt; contains conversion classes, but in the future this class will not be exposed to users anymore. It will only be used in &lt;tt&gt;CatalogTable&lt;/tt&gt;. Usually, I suspect that the problem lies somewhere else either &quot;during the comparison of schemas&quot; or &quot;extraction what is actually needed from the schema&quot;.&lt;/p&gt;</comment>
                            <comment id="17044405" author="lzljs3620320" created="Tue, 25 Feb 2020 12:46:30 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160;for your involving. You have the same thoughts:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16270&quot; title=&quot;Use LogicalType to equals/hashcode in TableSchema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16270&quot;&gt;&lt;del&gt;FLINK-16270&lt;/del&gt;&lt;/a&gt;&#160;is invalid. I like the sentence: &quot;this class will not be exposed to users anymore&quot;.&lt;/p&gt;

&lt;p&gt;What do you think about present situation, It appears outside the planner and work with table(source/sink), which means that it may have inconsistent conversion classes, so the advice we should give is to avoid calling equals/hashcode? If it is in this way, I should modify &lt;tt&gt;CsvTableSourceFactoryBase.createTableSource&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17045082" author="lzljs3620320" created="Wed, 26 Feb 2020 02:00:16 +0000"  >&lt;p&gt;Master:&#160;7a283be4093f7258dd33ba13200e32b22fb582ca&lt;/p&gt;

&lt;p&gt;Wait for next E2E test.&lt;/p&gt;</comment>
                            <comment id="17045263" author="rmetzger" created="Wed, 26 Feb 2020 08:55:40 +0000"  >&lt;p&gt;Thanks for the quick fix. We have to wait for another night to see if the issue is fixed.&lt;/p&gt;</comment>
                            <comment id="17045970" author="rmetzger" created="Wed, 26 Feb 2020 23:00:43 +0000"  >&lt;p&gt;I believe the error has not been fixed: &lt;a href=&quot;https://travis-ci.org/apache/flink/jobs/655356423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/flink/jobs/655356423&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17046033" author="lzljs3620320" created="Thu, 27 Feb 2020 01:38:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&#160;Thanks for reporting, sorry for missing sink, it is another fail, but similar reason.&lt;/p&gt;

&lt;p&gt;I&apos;ll create a pull request to fix it asap.&lt;/p&gt;</comment>
                            <comment id="17046034" author="jark" created="Thu, 27 Feb 2020 01:39:24 +0000"  >&lt;p&gt;I think we missed to fix it in &lt;tt&gt;CsvTableSinkFactoryBase&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17046187" author="lzljs3620320" created="Thu, 27 Feb 2020 05:54:40 +0000"  >&lt;p&gt;Fix csv sink in master:&#160;293fd5a9b4fd27c99dd6e7c9856d7a7af2ddfade&lt;/p&gt;</comment>
                            <comment id="17047405" author="rmetzger" created="Fri, 28 Feb 2020 09:59:44 +0000"  >&lt;p&gt;Thank you all!&lt;/p&gt;

&lt;p&gt;I&apos;ve closed this ticket as the nightly test is green again!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13287415">FLINK-16270</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0bueg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>