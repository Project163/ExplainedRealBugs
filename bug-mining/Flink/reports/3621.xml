<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:43:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8255] Key expressions on named row types do not work</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8255</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The following program fails with a &lt;tt&gt;ClassCastException&lt;/tt&gt;. It seems that key expressions and rows are not tested well. We should add more tests for them.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

TypeInformation[] types = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TypeInformation[] {Types.INT, Types.INT};

&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] fieldNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;};
RowTypeInfo rowTypeInfo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RowTypeInfo(types, fieldNames);

env.fromCollection(Collections.singleton(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Row(2)), rowTypeInfo)
.keyBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;).sum(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;).print();

env.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;Streaming WordCount&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13124715">FLINK-8255</key>
            <summary>Key expressions on named row types do not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Sergey Nuyanzin">Sergey Nuyanzin</assignee>
                                    <reporter username="twalthr">Timo Walther</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 13 Dec 2017 15:52:56 +0000</created>
                <updated>Wed, 8 Jan 2020 14:46:56 +0000</updated>
                            <resolved>Wed, 8 Jan 2020 14:46:56 +0000</resolved>
                                    <version>1.4.0</version>
                    <version>1.5.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>API / DataSet</component>
                    <component>API / DataStream</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>8</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="16457643" author="sergey nuyanzin" created="Sat, 28 Apr 2018 15:02:55 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&lt;br/&gt;
Could I pick this issue up if you do not mind?&lt;/p&gt;</comment>
                            <comment id="16458179" author="sergey nuyanzin" created="Sun, 29 Apr 2018 20:40:39 +0000"  >&lt;p&gt;A little bit research shows that it is something related to class Hierarchy: RowTypeInfo, TupleTypeInfoBase, TupleTypeInfo. Both RowTypeInfo and TupleTypeInfo are ancent of TupleTypeInfoBase. At the same time in e.g. org.apache.flink.streaming.util.typeutils.FieldAccessorFactory there are some checks with casting &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	...
 &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (typeInfo.isTupleType()) {
			TupleTypeInfoBase tupleTypeInfo = (TupleTypeInfoBase) typeInfo;
...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As RowTypeInfo and TupleTypeInfo are in parallel hierarchy branches =&amp;gt; casting will fail for RowTypeInfo. At the same time it looks like there is nothing special related to TupleTypeInfo =&amp;gt; casting to TupleTypeInfoBase is enough. &lt;br/&gt;
Based on finding usages of FieldAccessorFactory&apos;s methods with specified casting there could be added 2 more test-case which are also fails with the similar ClassCastException&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
		&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

		TypeInformation[] types = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TypeInformation[]{Types.INT, Types.INT};

		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] fieldNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;};
		RowTypeInfo rowTypeInfo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RowTypeInfo(types, fieldNames);

		UnsortedGrouping groupDs = env.fromCollection(Collections.singleton(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Row(2)), rowTypeInfo).groupBy(0);

		groupDs.maxBy(1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and one more almost the same however with .minBy in the last line&lt;/p&gt;

&lt;p&gt;one of the possible fixes: usage casting to TupleTypeInfoBase rther than to TupleTypeInfo (I&apos;m not sure that changing hierarchy could be an option).&lt;br/&gt;
such fix for the mentioned 3 cases is available here &lt;a href=&quot;https://github.com/apache/flink/compare/master...snuyanzin:FLINK-8255_Key_expressions_on_named_row_types_do_not_work&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/compare/master...snuyanzin:FLINK-8255_Key_expressions_on_named_row_types_do_not_work&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;at the same time it looks like there still could be issues, e.g.&lt;br/&gt;
org.apache.flink.api.java.DataSet#minBy&lt;br/&gt;
org.apache.flink.api.java.DataSet#maxBy&lt;br/&gt;
org.apache.flink.streaming.util.typeutils.FieldAccessor.RecursiveTupleFieldAccessor#RecursiveTupleFieldAccessor &lt;br/&gt;
also have such casting however at the moment I do not have any idea about test where it could fail&lt;/p&gt;</comment>
                            <comment id="16460831" author="fhueske" created="Wed, 2 May 2018 10:23:54 +0000"  >&lt;p&gt;Thanks for digging into this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sergey+Nuyanzin&quot; class=&quot;user-hover&quot; rel=&quot;Sergey Nuyanzin&quot;&gt;Sergey Nuyanzin&lt;/a&gt;!&lt;br/&gt;
I&apos;ve assigned the issue to you and also given contributor permissions to you (you can now assign other issues to yourself).&lt;/p&gt;

&lt;p&gt;Fabian&lt;/p&gt;</comment>
                            <comment id="16465860" author="sergey nuyanzin" created="Mon, 7 May 2018 12:41:48 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt;. Thank you very much&lt;br/&gt;
I was able to cope with others tests&lt;br/&gt;
There is a PR with passed Travis build &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt; and filled Contribution Checklist&lt;br/&gt;
could you or anyone else have a look at it please?&lt;/p&gt;</comment>
                            <comment id="16466381" author="githubbot" created="Mon, 7 May 2018 19:52:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961#discussion_r186477977&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961#discussion_r186477977&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/functions/SelectByMinFunction.java &amp;#8212;&lt;br/&gt;
    @@ -41,7 +41,7 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;is regarded in the reduce function. First index has highest priority and last index has&lt;/li&gt;
	&lt;li&gt;least priority.&lt;br/&gt;
     	 */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public SelectByMinFunction(TupleTypeInfo&amp;lt;T&amp;gt; type, int... fields) {&lt;br/&gt;
    +	public SelectByMinFunction(TupleTypeInfoBase&amp;lt;T&amp;gt; type, int... fields) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The `ReduceFunction` is still typed to `T extends Tuple` such that this will still fail at runtime. The same is true for all other built-in aggregation method like `sum()` and `min()` on `DataSet` and `UnsortedGrouping`. &lt;/p&gt;

&lt;p&gt;    This cannot be resolved without major changes. I don&apos;t think we should add these features, but rather throw meaningful error messages instead of `ClassCastException`. &lt;/p&gt;

&lt;p&gt;    Can you try to override the the `isTupleType()` method in `RowTypeInfo` and return `false`? &lt;br/&gt;
    This would prevent `Row` from being used in contexts that are only supported for `Tuple`.&lt;/p&gt;</comment>
                            <comment id="16466382" author="githubbot" created="Mon, 7 May 2018 19:52:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961#discussion_r186527277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961#discussion_r186527277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/util/typeutils/FieldAccessor.java &amp;#8212;&lt;br/&gt;
    @@ -197,7 +196,7 @@ public T set(T record, F fieldValue) {&lt;br/&gt;
     			checkNotNull(typeInfo, &quot;typeInfo must not be null.&quot;);&lt;br/&gt;
     			checkNotNull(innerAccessor, &quot;innerAccessor must not be null.&quot;);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;int arity = ((TupleTypeInfo) typeInfo).getArity();&lt;br/&gt;
    +			int arity = typeInfo.getArity();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Same as for `SimpleTupleFieldAccessor`.&lt;/p&gt;</comment>
                            <comment id="16466383" author="githubbot" created="Mon, 7 May 2018 19:52:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961#discussion_r186527205&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961#discussion_r186527205&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/util/typeutils/FieldAccessor.java &amp;#8212;&lt;br/&gt;
    @@ -157,15 +156,15 @@ public T set(T record, F fieldValue) {&lt;/p&gt;

&lt;p&gt;     		SimpleTupleFieldAccessor(int pos, TypeInformation&amp;lt;T&amp;gt; typeInfo) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    accessing fields in a `Row` will fail because `Row` does not extend `Tuple`. For a proper fix, we would need a `RowFieldAccessor` and use that one when we deal with a `DataStream&amp;lt;Row&amp;gt;`. We would then need to add the `RowFieldAccessor` to the `FieldAccessorFactory`.&lt;/p&gt;</comment>
                            <comment id="16466384" author="githubbot" created="Mon, 7 May 2018 19:52:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961#discussion_r186484649&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961#discussion_r186484649&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/test/java/org/apache/flink/api/java/operator/MaxByOperatorTest.java &amp;#8212;&lt;br/&gt;
    @@ -230,4 +235,43 @@ public String toString() {&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Validates that no ClassCastException happens&lt;br/&gt;
    +	 * should not fail e.g. like in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMaxMinByRowTypeInfoKeyFieldsDataset() {&lt;br/&gt;
    +&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment&lt;br/&gt;
    +			.getExecutionEnvironment();&lt;br/&gt;
    +		TypeInformation[] types = new TypeInformation[] &lt;/p&gt;
{Types.INT, Types.INT};&lt;br/&gt;
    +&lt;br/&gt;
    +		String[] fieldNames = new String[]{&quot;id&quot;, &quot;value&quot;};&lt;br/&gt;
    +		RowTypeInfo rowTypeInfo = new RowTypeInfo(types, fieldNames);&lt;br/&gt;
    +		DataSet tupleDs = env&lt;br/&gt;
    +			.fromCollection(Collections.singleton(new Row(2)), rowTypeInfo);&lt;br/&gt;
    +&lt;br/&gt;
    +		tupleDs.maxBy(0);&lt;br/&gt;
    +		tupleDs.minBy(0);&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +    /**&lt;br/&gt;
    +     * Validates that no ClassCastException happens&lt;br/&gt;
    +	 * should not fail e.g. like in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMaxMinByRowTypeInfoKeyFieldsForUnsortedGrouping() {&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		TypeInformation[] types = new TypeInformation[]{Types.INT, Types.INT}
&lt;p&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +		String[] fieldNames = new String[]&lt;/p&gt;
{&quot;id&quot;, &quot;value&quot;}
&lt;p&gt;;&lt;br/&gt;
    +		RowTypeInfo rowTypeInfo = new RowTypeInfo(types, fieldNames);&lt;br/&gt;
    +&lt;br/&gt;
    +		UnsortedGrouping groupDs = env.fromCollection(Collections.singleton(new Row(2)), rowTypeInfo).groupBy(0);&lt;br/&gt;
    +&lt;br/&gt;
    +		groupDs.maxBy(1);&lt;br/&gt;
    +		groupDs.minBy(1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    The tests pass because the program is not executed. &lt;br/&gt;
    You would have to call `env.collect()` to run the program and compare the returned result against the expected result. As I pointed out before, this will fail, because the operator will cast the `Row` objects to `Tuple`.&lt;/p&gt;</comment>
                            <comment id="16466385" author="githubbot" created="Mon, 7 May 2018 19:52:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961#discussion_r186528901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961#discussion_r186528901&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/test/java/org/apache/flink/streaming/util/typeutils/FieldAccessorTest.java &amp;#8212;&lt;br/&gt;
    @@ -368,4 +369,23 @@ public void testIllegalBasicType2() &lt;/p&gt;
{
     
     		FieldAccessor&amp;lt;Long, Long&amp;gt; f = FieldAccessorFactory.getAccessor(tpeInfo, &quot;foo&quot;, null);
     	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Validates that no ClassCastException happens&lt;br/&gt;
    +	 * should not fail e.g. like in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testRowTypeInfo() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This test just validates that a `FieldAccessor` is created. At runtime it would fail with a `ClassCastException`.&lt;/p&gt;</comment>
                            <comment id="16475411" author="githubbot" created="Tue, 15 May 2018 07:33:18 +0000"  >&lt;p&gt;Github user snuyanzin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hello @fhueske &lt;br/&gt;
    Thank you for your review&lt;/p&gt;

&lt;p&gt;    As you proposed I tried to use org.apache.flink.api.java.typeutils.RowTypeInfo#isTupleType&lt;br/&gt;
    ```java&lt;br/&gt;
    public boolean isTupleType() &lt;/p&gt;
{
    		return false;
    	}
&lt;p&gt;    ```&lt;br/&gt;
    however after that these tests started to fail&lt;br/&gt;
    org.apache.flink.table.api.batch.ExplainTest#testJoinWithoutExtended&lt;br/&gt;
    org.apache.flink.table.api.batch.ExplainTest#testJoinWithExtended&lt;/p&gt;

&lt;p&gt;    like &lt;br/&gt;
    ```&lt;br/&gt;
    testJoinWithoutExtended(org.apache.flink.table.api.batch.ExplainTest)  Time elapsed: 0.037 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!&lt;/p&gt;

&lt;p&gt;    org.apache.flink.api.common.InvalidProgramException: Specifying keys via field positions is only valid for tuple data types. Type: Row(a: Integer, b: String)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.api.common.operators.Keys$ExpressionKeys.&amp;lt;init&amp;gt;(Keys.java:232)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.api.common.operators.Keys$ExpressionKeys.&amp;lt;init&amp;gt;(Keys.java:223)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.api.java.operators.JoinOperator$JoinOperatorSets.where(JoinOperator.java:901)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.plan.nodes.dataset.DataSetJoin.addInnerJoin(DataSetJoin.scala:243)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.plan.nodes.dataset.DataSetJoin.translateToPlan(DataSetJoin.scala:170)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.plan.nodes.dataset.DataSetCalc.translateToPlan(DataSetCalc.scala:91)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.api.BatchTableEnvironment.translate(BatchTableEnvironment.scala:422)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.api.BatchTableEnvironment.explain(BatchTableEnvironment.scala:249)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.api.BatchTableEnvironment.explain(BatchTableEnvironment.scala:275)&lt;/p&gt;

&lt;p&gt;    	at org.apache.flink.table.api.batch.ExplainTest.testJoinWithoutExtended(ExplainTest.scala:72)&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    that is why I decided to use instanceof TupleTypeInfo check as anyway next line there is a cast to this type&lt;/p&gt;

&lt;p&gt;    could you please have a look at it and tell if it is acceptable or not?&lt;/p&gt;</comment>
                            <comment id="16477104" author="githubbot" created="Wed, 16 May 2018 08:59:44 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the update @snuyanzin. I&apos;ll try to have a look at the changes in the next days.&lt;br/&gt;
    Best, Fabian&lt;/p&gt;</comment>
                            <comment id="16478679" author="githubbot" created="Thu, 17 May 2018 07:42:59 +0000"  >&lt;p&gt;Github user snuyanzin closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16479069" author="githubbot" created="Thu, 17 May 2018 13:44:04 +0000"  >&lt;p&gt;Github user snuyanzin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    sorry, was closed by mistake&lt;br/&gt;
    reopened&lt;/p&gt;</comment>
                            <comment id="16479070" author="githubbot" created="Thu, 17 May 2018 13:44:04 +0000"  >&lt;p&gt;GitHub user snuyanzin reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet API, DataStream API&amp;#93;&lt;/span&gt; key expressions on named row types do not work&lt;/p&gt;

&lt;p&gt;    &lt;b&gt;Thank you very much for contributing to Apache Flink - we are happy that you want to help us improve Flink. To help the community review your contribution in the best possible way, please go through the checklist below, which will get the contribution into a shape in which it can be best reviewed.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;    &lt;b&gt;Please understand that we do not do this to make contributions to Flink a hassle. In order to uphold a high standard of quality for code contributions, while at the same time managing a large number of contributions, we need contributors to prepare the contributions well, and give reviewers enough contextual information for the review. Please also understand that contributions that do not follow this guide will take longer to review and thus typically be picked up with lower priority by the community.&lt;/b&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Contribution Checklist&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make sure that the pull request corresponds to a &lt;span class=&quot;error&quot;&gt;&amp;#91;JIRA issue&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/projects/FLINK/issues&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/FLINK/issues&lt;/a&gt;). Exceptions are made for typos in JavaDoc or documentation files, which need no JIRA issue.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Name the pull request in the form &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;FLINK-XXXX&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;component&amp;#93;&lt;/span&gt; Title of the pull request&quot;, where &lt;b&gt;FLINK-XXXX&lt;/b&gt; should be replaced by the actual issue number. Skip &lt;b&gt;component&lt;/b&gt; if you are unsure about which is the best component.&lt;br/&gt;
      Typo fixes that have no associated JIRA issue should be named following this pattern: `&lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;docs&amp;#93;&lt;/span&gt; Fix typo in event time introduction` or `&lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;javadocs&amp;#93;&lt;/span&gt; Expand JavaDoc for PuncuatedWatermarkGenerator`.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fill out the template below to describe the changes contributed by the pull request. That will give reviewers the context they need to do the review.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make sure that the change passes the automated tests, i.e., `mvn clean verify` passes. You can set up Travis CI to do that following &lt;span class=&quot;error&quot;&gt;&amp;#91;this guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/contribute-code.html#best-practices&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/contribute-code.html#best-practices&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Each pull request should address only one issue, not mix up code from multiple issues.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Each commit in the pull request has a meaningful commit message (including the JIRA id)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Once all items of the checklist are addressed, remove the above text and this checklist, leaving only the filled out template below.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;    *&lt;b&gt;(The sections below can be removed for hotfixes of typos)&lt;/b&gt;*&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;br/&gt;
    Fix issues related to ClassCastExceptions from Flink-8255 + add more tests&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Usage of casting to TupleTypeInfoBase rather than to TupleTypeInfo as RowTypeInfo is a child of TupleTypeInfoBase but in a different branch in compare with TupleTypeInfo&lt;/li&gt;
	&lt;li&gt;Add more tests which will fail with ClassCastException without changes from the previous item&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    &lt;b&gt;(Please pick either of the following options)&lt;/b&gt;&lt;br/&gt;
    This change added tests and can be verified as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added tests that validates that ClassCastException related to Flink-8255 are not happen&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes)&lt;/li&gt;
	&lt;li&gt;The serializers: (don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/snuyanzin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/snuyanzin/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5961&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 50eb4ead75ddc22e0eee2bf5a2b9d12c37dcaeb4&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-04-29T18:37:05Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit 96d569025e21172059bb5b34cf93f3a60b5f0a0e&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-04-29T18:47:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit 889f226b2268e5e23ed3de672a60a05702c111aa&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-04-29T20:30:04Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit 93dd630dd5a833a0e343a5ff53d0c5e5f37934cd&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-07T05:13:14Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit dc20cca498c2758d1cc0fa87bc51461a564e41f7&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-07T05:40:10Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit b1f33282c30cbc6ee7b9d6e3b595fc03955346b0&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-07T05:45:04Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit 295d0fc719010783da591781e9c4ab60e3e216e4&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-07T08:15:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt; Key expressions on named row types do not work&lt;br/&gt;
    Test case from description + 2 more&lt;br/&gt;
    Resolution of class cast by using of TupleTypeInfoBase rather than TupleTypeInfo&lt;/p&gt;

&lt;p&gt;commit adbd53d06cb335e62a0022835f352b62a809b128&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T11:18:27Z&lt;/p&gt;

&lt;p&gt;    Merge remote-tracking branch &apos;upstream/master&apos; into HEAD&lt;/p&gt;

&lt;p&gt;commit 8a87fb895d516c2f651c98cdc020d895d6203f25&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T11:24:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    corrections based on comment &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255?focusedCommentId=16466381&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16466381&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-8255?focusedCommentId=16466381&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16466381&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;commit fb519774fbeac7774fe9a4ef9c44d16b98443242&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T13:26:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    Tests corrected&lt;/p&gt;

&lt;p&gt;commit 9af3290fa93802feeef8503d8b5ff39b161f2072&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T13:37:45Z&lt;/p&gt;

&lt;p&gt;    Merge branch &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&apos; of &lt;a href=&quot;https://github.com/snuyanzin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/snuyanzin/flink&lt;/a&gt; into &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;/p&gt;

&lt;p&gt;commit 470d91086c8f49397011dba713a5bcde77d4e60e&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T13:46:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    fix imports to make them unchanged as initially&lt;/p&gt;

&lt;p&gt;commit 82af1a42426bd8600718ac71b5fbc26fc48ead23&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:24:16Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&lt;br/&gt;
    DOW implementation&lt;/p&gt;

&lt;p&gt;commit 3387361444d099352c6ec15055a06033206b0e02&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:26:08Z&lt;/p&gt;

&lt;p&gt;    Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit 82af1a42426bd8600718ac71b5fbc26fc48ead23.&lt;/p&gt;

&lt;p&gt;commit ebab3b5d88b50f1bdd18da4707688e98588cf729&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:30:28Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&lt;br/&gt;
    DOW implementation&lt;/p&gt;

&lt;p&gt;commit 9aeea218822c552886b8497a67ef33a8906c94dc&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:31:20Z&lt;/p&gt;

&lt;p&gt;    Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit ebab3b5d88b50f1bdd18da4707688e98588cf729.&lt;/p&gt;

&lt;p&gt;commit 125fd792e4245759a703b168d5febf5adcfff6c3&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:35:09Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&lt;br/&gt;
    DOW implementation&lt;/p&gt;

&lt;p&gt;commit d891cc5f04bb84861c55e238c9ffff9599efa980&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:48:19Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    added expected exception type&lt;/p&gt;

&lt;p&gt;commit 497aa2071947e7b2f513504b37c98ca0067d4460&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:50:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    omit issue not related changes&lt;/p&gt;

&lt;p&gt;commit 903db8cb13eb3774eb6daf3d6ed46a93a27062d6&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T13:31:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    use instanceof as&lt;br/&gt;
    org.apache.flink.api.java.typeutils.RowTypeInfo#isTupleType leads to&lt;br/&gt;
    org.apache.flink.table.api.batch.ExplainTest#testJoinWithoutExtended failure&lt;/p&gt;

&lt;p&gt;commit 9f54cf7bb3fbc60c0be4209a3f33950ba8b9794c&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T13:33:36Z&lt;/p&gt;

&lt;p&gt;    Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit 497aa2071947e7b2f513504b37c98ca0067d4460.&lt;/p&gt;

&lt;p&gt;commit d616dd47b22d10e6f5edb1fe363e1010b760544e&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T13:35:54Z&lt;/p&gt;

&lt;p&gt;    Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit d891cc5f04bb84861c55e238c9ffff9599efa980.&lt;/p&gt;

&lt;p&gt;commit ff8fde21fed6f793af2046570b3c839edb00a426&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T13:42:39Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    omit issue not relate changes&lt;/p&gt;

&lt;p&gt;commit a7994adc9804dca205773591e42d8f56225e5dfb&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T13:46:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    added expected exception to tests&lt;/p&gt;

&lt;p&gt;commit 07fad75781474163d546641be0d3902c758de2c8&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-14T14:11:46Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    added instanceof checks for DataSet&lt;/p&gt;

&lt;p&gt;commit 983cf4fff2cacbbf00922b142b4a5a09b6a74224&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T11:24:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    corrections based on comment &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255?focusedCommentId=16466381&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16466381&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-8255?focusedCommentId=16466381&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16466381&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;commit 1065d21e762c5bfc1867bc729812f8d013dd5838&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T13:26:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    Tests corrected&lt;/p&gt;

&lt;p&gt;commit c1d754c58a9aad208952fad0d4a10a5b6bcfed66&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T13:46:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8255&quot; title=&quot;Key expressions on named row types do not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8255&quot;&gt;&lt;del&gt;FLINK-8255&lt;/del&gt;&lt;/a&gt;_Key_expressions_on_named_row_types_do_not_work&lt;br/&gt;
    fix imports to make them unchanged as initially&lt;/p&gt;

&lt;p&gt;commit aa4cf128bfd387b18dc618947e55ba27303e8e44&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:24:16Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&lt;br/&gt;
    DOW implementation&lt;/p&gt;

&lt;p&gt;commit 98a695166c53d794fdc98d0521e247d0c70154b5&lt;br/&gt;
Author: snuyanzin &amp;lt;snuyanzin@...&amp;gt;&lt;br/&gt;
Date:   2018-05-10T14:26:08Z&lt;/p&gt;

&lt;p&gt;    Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8518&quot; title=&quot;Support DOW, EPOCH, DECADE for EXTRACT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8518&quot;&gt;&lt;del&gt;FLINK-8518&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Table API and SQL&amp;#93;&lt;/span&gt; Support DOW, EPOCH, DECADE for EXTRACT&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit 82af1a42426bd8600718ac71b5fbc26fc48ead23.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16520422" author="githubbot" created="Fri, 22 Jun 2018 14:33:04 +0000"  >&lt;p&gt;Github user snuyanzin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5961&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    commits squashed into one &lt;/p&gt;</comment>
                            <comment id="17010729" author="aljoscha" created="Wed, 8 Jan 2020 14:46:56 +0000"  >&lt;p&gt;Fixed on master in fd91220008d29411d8fcc1ffa95eeddc3e6d756a&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nv4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>