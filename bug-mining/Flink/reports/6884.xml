<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-27246] Code of method &quot;processElement(Lorg/apache/flink/streaming/runtime/streamrecord/StreamRecord;)V&quot; of class &quot;HashAggregateWithKeys$9211&quot; grows beyond 64 KB</title>
                <link>https://issues.apache.org/jira/browse/FLINK-27246</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I think this bug should get fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-23007&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-23007&lt;/a&gt;&lt;br/&gt;
Unfortunately I spotted it on Flink 1.14.3&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

java.lang.RuntimeException: Could not instantiate generated class &lt;span class=&quot;code-quote&quot;&gt;&apos;HashAggregateWithKeys$9211&apos;&lt;/span&gt;
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:85) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.operators.CodeGenOperatorFactory.createStreamOperator(CodeGenOperatorFactory.java:40) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.streaming.api.operators.StreamOperatorFactoryUtil.createOperator(StreamOperatorFactoryUtil.java:81) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.streaming.runtime.tasks.OperatorChain.&amp;lt;init&amp;gt;(OperatorChain.java:198) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.&amp;lt;init&amp;gt;(RegularOperatorChain.java:63) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:666) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:654) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:958) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:927) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:766) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:575) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkRuntimeException: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.
	at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:76) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:102) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:83) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	... 11 more
Caused by: org.apache.flink.shaded.guava30.com.google.common.util.concurrent.UncheckedExecutionException: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2051) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache.get(LocalCache.java:3962) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4859) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:102) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:83) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	... 11 more
Caused by: org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.
	at org.apache.flink.table.runtime.generated.CompileUtils.doCompile(CompileUtils.java:89) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.lambda$compile$1(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4864) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache.get(LocalCache.java:3962) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4859) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:102) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:83) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	... 11 more
Caused by: org.codehaus.janino.InternalCompilerException: Compiling &lt;span class=&quot;code-quote&quot;&gt;&quot;HashAggregateWithKeys$9211&quot;&lt;/span&gt;: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;processElement(Lorg/apache/flink/streaming/runtime/streamrecord/StreamRecord;)V&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;HashAggregateWithKeys$9211&quot;&lt;/span&gt; grows beyond 64 KB
	at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:382) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:237) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:465) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:216) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:207) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:80) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:75) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.doCompile(CompileUtils.java:86) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.lambda$compile$1(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4864) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache.get(LocalCache.java:3962) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4859) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:102) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:83) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	... 11 more
Caused by: org.codehaus.janino.InternalCompilerException: Code of method &lt;span class=&quot;code-quote&quot;&gt;&quot;processElement(Lorg/apache/flink/streaming/runtime/streamrecord/StreamRecord;)V&quot;&lt;/span&gt; of class &lt;span class=&quot;code-quote&quot;&gt;&quot;HashAggregateWithKeys$9211&quot;&lt;/span&gt; grows beyond 64 KB
	at org.codehaus.janino.CodeContext.makeSpace(CodeContext.java:1048) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.CodeContext.write(CodeContext.java:940) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.writeShort(UnitCompiler.java:12282) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.load(UnitCompiler.java:11941) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.load(UnitCompiler.java:11926) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:4465) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$8000(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitLocalVariableAccess(UnitCompiler.java:4408) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitLocalVariableAccess(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$LocalVariableAccess.accept(Java.java:4274) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Lvalue.accept(Java.java:4148) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:4461) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$7500(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitAmbiguousName(UnitCompiler.java:4403) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitAmbiguousName(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$AmbiguousName.accept(Java.java:4224) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Lvalue.accept(Java.java:4148) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:5662) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileBoolean2(UnitCompiler.java:4120) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$6600(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$14.visitBinaryOperation(UnitCompiler.java:3957) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$14.visitBinaryOperation(UnitCompiler.java:3935) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$BinaryOperation.accept(Java.java:4864) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileBoolean(UnitCompiler.java:3935) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:4448) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:5004) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$8500(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitBinaryOperation(UnitCompiler.java:4417) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitBinaryOperation(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$BinaryOperation.accept(Java.java:4864) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:5057) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$8100(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitParenthesizedExpression(UnitCompiler.java:4409) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16$1.visitParenthesizedExpression(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$ParenthesizedExpression.accept(Java.java:4924) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4400) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$16.visitLvalue(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Lvalue.accept(Java.java:4148) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:4396) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:5662) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:3792) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$6100(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$13.visitAssignment(UnitCompiler.java:3754) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$13.visitAssignment(UnitCompiler.java:3734) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Assignment.accept(Java.java:4477) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:3734) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2360) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1800(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitExpressionStatement(UnitCompiler.java:1494) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitExpressionStatement(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$ExpressionStatement.accept(Java.java:2874) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1553) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1493) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Block.accept(Java.java:2779) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2476) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1495) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2950) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1553) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1493) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Block.accept(Java.java:2779) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2468) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1495) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2950) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1553) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1493) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Block.accept(Java.java:2779) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2468) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1495) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2950) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1553) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1493) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitBlock(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$Block.accept(Java.java:2779) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2468) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$1900(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1495) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$6.visitIfStatement(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2950) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1487) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:1567) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:3388) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1357) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:1330) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:822) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:432) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:215) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:411) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:406) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1414) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:406) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:378) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:237) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:465) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:216) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:207) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:80) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:75) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.doCompile(CompileUtils.java:86) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.lambda$compile$1(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4864) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache.get(LocalCache.java:3962) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.shaded.guava30.com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4859) ~[flink-dist_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.CompileUtils.compile(CompileUtils.java:74) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.compile(GeneratedClass.java:102) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	at org.apache.flink.table.runtime.generated.GeneratedClass.newInstance(GeneratedClass.java:83) ~[flink-table_2.12-1.14.3-stream1.jar:1.14.3-stream1]
	... 11 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13439590">FLINK-27246</key>
            <summary>Code of method &quot;processElement(Lorg/apache/flink/streaming/runtime/streamrecord/StreamRecord;)V&quot; of class &quot;HashAggregateWithKeys$9211&quot; grows beyond 64 KB</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="KristoffSC">Krzysztof Chmielewski</assignee>
                                    <reporter username="maver1ck">Maciej Bry&#324;ski</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 14 Apr 2022 07:32:22 +0000</created>
                <updated>Thu, 9 Feb 2023 09:32:03 +0000</updated>
                            <resolved>Thu, 9 Feb 2023 09:32:03 +0000</resolved>
                                    <version>1.14.3</version>
                    <version>1.15.3</version>
                    <version>1.16.1</version>
                                    <fixVersion>1.17.0</fixVersion>
                    <fixVersion>1.16.2</fixVersion>
                                    <component>Table SQL / Runtime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="17522211" author="twalthr" created="Thu, 14 Apr 2022 10:02:53 +0000"  >&lt;p&gt;Can you provide a reproducible example? Maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt; knows how to fix it then. The pure exception might not provide enough information.&lt;/p&gt;</comment>
                            <comment id="17552578" author="jingge" created="Fri, 10 Jun 2022 06:24:35 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maver1ck&quot; class=&quot;user-hover&quot; rel=&quot;maver1ck&quot;&gt;maver1ck&lt;/a&gt; could you share the SQL that we could reproduce the issue?&lt;/p&gt;</comment>
                            <comment id="17552626" author="maver1ck" created="Fri, 10 Jun 2022 08:37:11 +0000"  >&lt;p&gt;I&apos;m trying to build it using datagen and removing UDFs. &lt;br/&gt;
Will be ready next week.&lt;/p&gt;</comment>
                            <comment id="17561031" author="maver1ck" created="Thu, 30 Jun 2022 12:57:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingge&quot; class=&quot;user-hover&quot; rel=&quot;jingge&quot;&gt;jingge&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&lt;br/&gt;
Please find following example from our production (with change to datagen)&lt;br/&gt;
Tested on 1.14.4 sql-client&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SET &lt;span class=&quot;code-quote&quot;&gt;&apos;execution.runtime-mode&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;batch&apos;&lt;/span&gt;;


CREATE TABLE `SA_NSN5G_PM.GSITE_PDCP2_R` (
  `DAY_WH_ID` DECIMAL(10, 0),
  `GSITE_WH_ID` DECIMAL(10, 0),
  `START_TIME` TIMESTAMP(6),
  `INSERTION_TIME` TIMESTAMP(6),
  `MRBTS_ID` DECIMAL(10, 0),
  `NRBTS_ID` DECIMAL(10, 0),
  `DURATION` DECIMAL(10, 0),
  `MEAS_PERIOD_NR_PDCP_REPORT2` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_01` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_02` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_03` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_04` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_05` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_06` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_07` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_08` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_09` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_10` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_11` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_12` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_13` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_14` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_15` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_16` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_17` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_18` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_19` DECIMAL(10, 0),
  `DL_VOL_DISC_REL_QOS_GRP_20` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_01` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_02` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_03` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_04` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_05` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_06` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_07` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_08` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_09` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_10` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_11` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_12` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_13` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_14` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_15` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_16` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_17` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_18` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_19` DECIMAL(10, 0),
  `DL_SDU_DISC_REL_QOS_GRP_20` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_01` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_02` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_03` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_04` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_05` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_06` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_07` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_08` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_09` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_10` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_11` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_12` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_13` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_14` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_15` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_16` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_17` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_18` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_19` DECIMAL(10, 0),
  `DL_VOL_DISC_OTHER_QOS_GRP_20` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_01` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_02` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_03` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_04` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_05` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_06` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_07` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_08` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_09` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_10` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_11` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_12` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_13` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_14` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_15` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_16` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_17` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_18` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_19` DECIMAL(10, 0),
  `DL_SDU_DISC_OTHER_QOS_GRP_20` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_01` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_02` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_03` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_04` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_05` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_06` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_07` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_08` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_09` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_10` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_11` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_12` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_13` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_14` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_15` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_16` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_17` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_18` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_19` DECIMAL(10, 0),
  `DL_VOL_DISC_BUFTH_QOS_GRP_20` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_01` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_02` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_03` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_04` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_05` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_06` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_07` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_08` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_09` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_10` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_11` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_12` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_13` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_14` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_15` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_16` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_17` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_18` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_19` DECIMAL(10, 0),
  `DL_SDU_DISC_BUFTH_QOS_GRP_20` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_01` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_02` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_03` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_04` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_05` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_06` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_07` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_08` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_09` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_10` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_11` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_12` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_13` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_14` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_15` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_16` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_17` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_18` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_19` DECIMAL(10, 0),
  `UL_VOL_DISC_OTHER_QOS_GRP_20` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_01` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_02` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_03` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_04` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_05` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_06` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_07` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_08` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_09` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_10` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_11` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_12` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_13` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_14` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_15` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_16` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_17` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_18` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_19` DECIMAL(10, 0),
  `UL_SDU_DISC_OTHER_QOS_GRP_20` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_01` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_02` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_03` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_04` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_05` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_06` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_07` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_08` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_09` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_10` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_11` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_12` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_13` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_14` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_15` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_16` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_17` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_18` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_19` DECIMAL(10, 0),
  `DL_SDU_DISC_QUEDLY_QOS_GRP_20` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_01` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_02` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_03` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_04` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_05` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_06` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_07` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_08` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_09` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_10` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_11` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_12` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_13` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_14` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_15` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_16` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_17` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_18` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_19` DECIMAL(10, 0),
  `DL_VOL_DISC_QUEDLY_QOS_GRP_20` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_01` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_02` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_03` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_04` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_05` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_06` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_07` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_08` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_09` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_10` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_11` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_12` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_13` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_14` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_15` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_16` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_17` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_18` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_19` DECIMAL(10, 0),
  `DL_DELAY_DISC_QOS_GRP_20` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_01` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_02` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_03` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_04` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_05` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_06` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_07` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_08` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_09` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_10` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_11` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_12` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_13` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_14` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_15` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_16` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_17` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_18` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_19` DECIMAL(10, 0),
  `NUM_RETRANS_QOS_GRP_20` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_01` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_02` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_03` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_04` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_05` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_06` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_07` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_08` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_09` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_10` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_11` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_12` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_13` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_14` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_15` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_16` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_17` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_18` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_19` DECIMAL(10, 0),
  `VOL_RETRANS_QOS_GRP_20` DECIMAL(10, 0),
  `MAX_NUM_OF_DRB` DECIMAL(10, 0),
  `DL_NUM_ROHC_COMP_HEADER` DECIMAL(10, 0),
  `DL_VOL_ROHC_COMP_HEADER` DECIMAL(10, 0),
  `UL_NUM_ROHC_DECOMP_HEADER` DECIMAL(10, 0),
  `UL_VOL_ROHC_DECOMP_HEADER` DECIMAL(10, 0),
  `KAFKA_PARTID` DECIMAL(10, 0),
  `KAFKA_OFFSET` INT
)
COMMENT &apos;&apos;
WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;datagen&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;number-of-rows&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;100&apos;&lt;/span&gt;
);

SELECT
    MINUTE(T1.START_TIME) as `DAY_WH_ID`,
    HOUR(T1.START_TIME) as `START_TIME`,
    GSITE_WH_ID as `GSITE_WH_ID`,
    T1.MRBTS_ID as `MRBTS_ID`,
    T1.NRBTS_ID as `NRBTS_ID`,
    SUM(T1.DURATION) as `DURATION`, SUM(MEAS_PERIOD_NR_PDCP_REPORT2) as `MEAS_PERIOD_NR_PDCP_REPORT2`, SUM(DL_VOL_DISC_REL_QOS_GRP_01) as `DL_VOL_DISC_REL_QOS_GRP_01`, SUM(DL_VOL_DISC_REL_QOS_GRP_02) as `DL_VOL_DISC_REL_QOS_GRP_02`, SUM(DL_VOL_DISC_REL_QOS_GRP_03) as `DL_VOL_DISC_REL_QOS_GRP_03`, SUM(DL_VOL_DISC_REL_QOS_GRP_04) as `DL_VOL_DISC_REL_QOS_GRP_04`, SUM(DL_VOL_DISC_REL_QOS_GRP_05) as `DL_VOL_DISC_REL_QOS_GRP_05`, SUM(DL_VOL_DISC_REL_QOS_GRP_06) as `DL_VOL_DISC_REL_QOS_GRP_06`, SUM(DL_VOL_DISC_REL_QOS_GRP_07) as `DL_VOL_DISC_REL_QOS_GRP_07`, SUM(DL_VOL_DISC_REL_QOS_GRP_08) as `DL_VOL_DISC_REL_QOS_GRP_08`, SUM(DL_VOL_DISC_REL_QOS_GRP_09) as `DL_VOL_DISC_REL_QOS_GRP_09`, SUM(DL_VOL_DISC_REL_QOS_GRP_10) as `DL_VOL_DISC_REL_QOS_GRP_10`, SUM(DL_VOL_DISC_REL_QOS_GRP_11) as `DL_VOL_DISC_REL_QOS_GRP_11`, SUM(DL_VOL_DISC_REL_QOS_GRP_12) as `DL_VOL_DISC_REL_QOS_GRP_12`, SUM(DL_VOL_DISC_REL_QOS_GRP_13) as `DL_VOL_DISC_REL_QOS_GRP_13`, SUM(DL_VOL_DISC_REL_QOS_GRP_14) as `DL_VOL_DISC_REL_QOS_GRP_14`, SUM(DL_VOL_DISC_REL_QOS_GRP_15) as `DL_VOL_DISC_REL_QOS_GRP_15`, SUM(DL_VOL_DISC_REL_QOS_GRP_16) as `DL_VOL_DISC_REL_QOS_GRP_16`, SUM(DL_VOL_DISC_REL_QOS_GRP_17) as `DL_VOL_DISC_REL_QOS_GRP_17`, SUM(DL_VOL_DISC_REL_QOS_GRP_18) as `DL_VOL_DISC_REL_QOS_GRP_18`, SUM(DL_VOL_DISC_REL_QOS_GRP_19) as `DL_VOL_DISC_REL_QOS_GRP_19`, SUM(DL_VOL_DISC_REL_QOS_GRP_20) as `DL_VOL_DISC_REL_QOS_GRP_20`, SUM(DL_SDU_DISC_REL_QOS_GRP_01) as `DL_SDU_DISC_REL_QOS_GRP_01`, SUM(DL_SDU_DISC_REL_QOS_GRP_02) as `DL_SDU_DISC_REL_QOS_GRP_02`, SUM(DL_SDU_DISC_REL_QOS_GRP_03) as `DL_SDU_DISC_REL_QOS_GRP_03`, SUM(DL_SDU_DISC_REL_QOS_GRP_04) as `DL_SDU_DISC_REL_QOS_GRP_04`, SUM(DL_SDU_DISC_REL_QOS_GRP_05) as `DL_SDU_DISC_REL_QOS_GRP_05`, SUM(DL_SDU_DISC_REL_QOS_GRP_06) as `DL_SDU_DISC_REL_QOS_GRP_06`, SUM(DL_SDU_DISC_REL_QOS_GRP_07) as `DL_SDU_DISC_REL_QOS_GRP_07`, SUM(DL_SDU_DISC_REL_QOS_GRP_08) as `DL_SDU_DISC_REL_QOS_GRP_08`, SUM(DL_SDU_DISC_REL_QOS_GRP_09) as `DL_SDU_DISC_REL_QOS_GRP_09`, SUM(DL_SDU_DISC_REL_QOS_GRP_10) as `DL_SDU_DISC_REL_QOS_GRP_10`, SUM(DL_SDU_DISC_REL_QOS_GRP_11) as `DL_SDU_DISC_REL_QOS_GRP_11`, SUM(DL_SDU_DISC_REL_QOS_GRP_12) as `DL_SDU_DISC_REL_QOS_GRP_12`, SUM(DL_SDU_DISC_REL_QOS_GRP_13) as `DL_SDU_DISC_REL_QOS_GRP_13`, SUM(DL_SDU_DISC_REL_QOS_GRP_14) as `DL_SDU_DISC_REL_QOS_GRP_14`, SUM(DL_SDU_DISC_REL_QOS_GRP_15) as `DL_SDU_DISC_REL_QOS_GRP_15`, SUM(DL_SDU_DISC_REL_QOS_GRP_16) as `DL_SDU_DISC_REL_QOS_GRP_16`, SUM(DL_SDU_DISC_REL_QOS_GRP_17) as `DL_SDU_DISC_REL_QOS_GRP_17`, SUM(DL_SDU_DISC_REL_QOS_GRP_18) as `DL_SDU_DISC_REL_QOS_GRP_18`, SUM(DL_SDU_DISC_REL_QOS_GRP_19) as `DL_SDU_DISC_REL_QOS_GRP_19`, SUM(DL_SDU_DISC_REL_QOS_GRP_20) as `DL_SDU_DISC_REL_QOS_GRP_20`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_01) as `DL_VOL_DISC_OTHER_QOS_GRP_01`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_02) as `DL_VOL_DISC_OTHER_QOS_GRP_02`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_03) as `DL_VOL_DISC_OTHER_QOS_GRP_03`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_04) as `DL_VOL_DISC_OTHER_QOS_GRP_04`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_05) as `DL_VOL_DISC_OTHER_QOS_GRP_05`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_06) as `DL_VOL_DISC_OTHER_QOS_GRP_06`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_07) as `DL_VOL_DISC_OTHER_QOS_GRP_07`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_08) as `DL_VOL_DISC_OTHER_QOS_GRP_08`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_09) as `DL_VOL_DISC_OTHER_QOS_GRP_09`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_10) as `DL_VOL_DISC_OTHER_QOS_GRP_10`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_11) as `DL_VOL_DISC_OTHER_QOS_GRP_11`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_12) as `DL_VOL_DISC_OTHER_QOS_GRP_12`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_13) as `DL_VOL_DISC_OTHER_QOS_GRP_13`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_14) as `DL_VOL_DISC_OTHER_QOS_GRP_14`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_15) as `DL_VOL_DISC_OTHER_QOS_GRP_15`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_16) as `DL_VOL_DISC_OTHER_QOS_GRP_16`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_17) as `DL_VOL_DISC_OTHER_QOS_GRP_17`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_18) as `DL_VOL_DISC_OTHER_QOS_GRP_18`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_19) as `DL_VOL_DISC_OTHER_QOS_GRP_19`, SUM(DL_VOL_DISC_OTHER_QOS_GRP_20) as `DL_VOL_DISC_OTHER_QOS_GRP_20`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_01) as `DL_SDU_DISC_OTHER_QOS_GRP_01`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_02) as `DL_SDU_DISC_OTHER_QOS_GRP_02`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_03) as `DL_SDU_DISC_OTHER_QOS_GRP_03`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_04) as `DL_SDU_DISC_OTHER_QOS_GRP_04`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_05) as `DL_SDU_DISC_OTHER_QOS_GRP_05`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_06) as `DL_SDU_DISC_OTHER_QOS_GRP_06`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_07) as `DL_SDU_DISC_OTHER_QOS_GRP_07`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_08) as `DL_SDU_DISC_OTHER_QOS_GRP_08`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_09) as `DL_SDU_DISC_OTHER_QOS_GRP_09`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_10) as `DL_SDU_DISC_OTHER_QOS_GRP_10`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_11) as `DL_SDU_DISC_OTHER_QOS_GRP_11`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_12) as `DL_SDU_DISC_OTHER_QOS_GRP_12`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_13) as `DL_SDU_DISC_OTHER_QOS_GRP_13`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_14) as `DL_SDU_DISC_OTHER_QOS_GRP_14`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_15) as `DL_SDU_DISC_OTHER_QOS_GRP_15`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_16) as `DL_SDU_DISC_OTHER_QOS_GRP_16`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_17) as `DL_SDU_DISC_OTHER_QOS_GRP_17`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_18) as `DL_SDU_DISC_OTHER_QOS_GRP_18`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_19) as `DL_SDU_DISC_OTHER_QOS_GRP_19`, SUM(DL_SDU_DISC_OTHER_QOS_GRP_20) as `DL_SDU_DISC_OTHER_QOS_GRP_20`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_01) as `DL_VOL_DISC_BUFTH_QOS_GRP_01`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_02) as `DL_VOL_DISC_BUFTH_QOS_GRP_02`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_03) as `DL_VOL_DISC_BUFTH_QOS_GRP_03`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_04) as `DL_VOL_DISC_BUFTH_QOS_GRP_04`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_05) as `DL_VOL_DISC_BUFTH_QOS_GRP_05`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_06) as `DL_VOL_DISC_BUFTH_QOS_GRP_06`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_07) as `DL_VOL_DISC_BUFTH_QOS_GRP_07`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_08) as `DL_VOL_DISC_BUFTH_QOS_GRP_08`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_09) as `DL_VOL_DISC_BUFTH_QOS_GRP_09`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_10) as `DL_VOL_DISC_BUFTH_QOS_GRP_10`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_11) as `DL_VOL_DISC_BUFTH_QOS_GRP_11`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_12) as `DL_VOL_DISC_BUFTH_QOS_GRP_12`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_13) as `DL_VOL_DISC_BUFTH_QOS_GRP_13`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_14) as `DL_VOL_DISC_BUFTH_QOS_GRP_14`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_15) as `DL_VOL_DISC_BUFTH_QOS_GRP_15`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_16) as `DL_VOL_DISC_BUFTH_QOS_GRP_16`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_17) as `DL_VOL_DISC_BUFTH_QOS_GRP_17`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_18) as `DL_VOL_DISC_BUFTH_QOS_GRP_18`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_19) as `DL_VOL_DISC_BUFTH_QOS_GRP_19`, SUM(DL_VOL_DISC_BUFTH_QOS_GRP_20) as `DL_VOL_DISC_BUFTH_QOS_GRP_20`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_01) as `DL_SDU_DISC_BUFTH_QOS_GRP_01`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_02) as `DL_SDU_DISC_BUFTH_QOS_GRP_02`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_03) as `DL_SDU_DISC_BUFTH_QOS_GRP_03`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_04) as `DL_SDU_DISC_BUFTH_QOS_GRP_04`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_05) as `DL_SDU_DISC_BUFTH_QOS_GRP_05`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_06) as `DL_SDU_DISC_BUFTH_QOS_GRP_06`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_07) as `DL_SDU_DISC_BUFTH_QOS_GRP_07`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_08) as `DL_SDU_DISC_BUFTH_QOS_GRP_08`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_09) as `DL_SDU_DISC_BUFTH_QOS_GRP_09`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_10) as `DL_SDU_DISC_BUFTH_QOS_GRP_10`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_11) as `DL_SDU_DISC_BUFTH_QOS_GRP_11`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_12) as `DL_SDU_DISC_BUFTH_QOS_GRP_12`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_13) as `DL_SDU_DISC_BUFTH_QOS_GRP_13`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_14) as `DL_SDU_DISC_BUFTH_QOS_GRP_14`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_15) as `DL_SDU_DISC_BUFTH_QOS_GRP_15`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_16) as `DL_SDU_DISC_BUFTH_QOS_GRP_16`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_17) as `DL_SDU_DISC_BUFTH_QOS_GRP_17`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_18) as `DL_SDU_DISC_BUFTH_QOS_GRP_18`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_19) as `DL_SDU_DISC_BUFTH_QOS_GRP_19`, SUM(DL_SDU_DISC_BUFTH_QOS_GRP_20) as `DL_SDU_DISC_BUFTH_QOS_GRP_20`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_01) as `UL_VOL_DISC_OTHER_QOS_GRP_01`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_02) as `UL_VOL_DISC_OTHER_QOS_GRP_02`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_03) as `UL_VOL_DISC_OTHER_QOS_GRP_03`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_04) as `UL_VOL_DISC_OTHER_QOS_GRP_04`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_05) as `UL_VOL_DISC_OTHER_QOS_GRP_05`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_06) as `UL_VOL_DISC_OTHER_QOS_GRP_06`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_07) as `UL_VOL_DISC_OTHER_QOS_GRP_07`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_08) as `UL_VOL_DISC_OTHER_QOS_GRP_08`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_09) as `UL_VOL_DISC_OTHER_QOS_GRP_09`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_10) as `UL_VOL_DISC_OTHER_QOS_GRP_10`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_11) as `UL_VOL_DISC_OTHER_QOS_GRP_11`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_12) as `UL_VOL_DISC_OTHER_QOS_GRP_12`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_13) as `UL_VOL_DISC_OTHER_QOS_GRP_13`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_14) as `UL_VOL_DISC_OTHER_QOS_GRP_14`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_15) as `UL_VOL_DISC_OTHER_QOS_GRP_15`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_16) as `UL_VOL_DISC_OTHER_QOS_GRP_16`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_17) as `UL_VOL_DISC_OTHER_QOS_GRP_17`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_18) as `UL_VOL_DISC_OTHER_QOS_GRP_18`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_19) as `UL_VOL_DISC_OTHER_QOS_GRP_19`, SUM(UL_VOL_DISC_OTHER_QOS_GRP_20) as `UL_VOL_DISC_OTHER_QOS_GRP_20`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_01) as `UL_SDU_DISC_OTHER_QOS_GRP_01`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_02) as `UL_SDU_DISC_OTHER_QOS_GRP_02`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_03) as `UL_SDU_DISC_OTHER_QOS_GRP_03`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_04) as `UL_SDU_DISC_OTHER_QOS_GRP_04`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_05) as `UL_SDU_DISC_OTHER_QOS_GRP_05`,
    SUM(UL_SDU_DISC_OTHER_QOS_GRP_06) as `UL_SDU_DISC_OTHER_QOS_GRP_06`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_07) as `UL_SDU_DISC_OTHER_QOS_GRP_07`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_08) as `UL_SDU_DISC_OTHER_QOS_GRP_08`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_09) as `UL_SDU_DISC_OTHER_QOS_GRP_09`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_10) as `UL_SDU_DISC_OTHER_QOS_GRP_10`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_11) as `UL_SDU_DISC_OTHER_QOS_GRP_11`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_12) as `UL_SDU_DISC_OTHER_QOS_GRP_12`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_13) as `UL_SDU_DISC_OTHER_QOS_GRP_13`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_14) as `UL_SDU_DISC_OTHER_QOS_GRP_14`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_15) as `UL_SDU_DISC_OTHER_QOS_GRP_15`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_16) as `UL_SDU_DISC_OTHER_QOS_GRP_16`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_17) as `UL_SDU_DISC_OTHER_QOS_GRP_17`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_18) as `UL_SDU_DISC_OTHER_QOS_GRP_18`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_19) as `UL_SDU_DISC_OTHER_QOS_GRP_19`, SUM(UL_SDU_DISC_OTHER_QOS_GRP_20) as `UL_SDU_DISC_OTHER_QOS_GRP_20`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_01) as `DL_SDU_DISC_QUEDLY_QOS_GRP_01`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_02) as `DL_SDU_DISC_QUEDLY_QOS_GRP_02`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_03) as `DL_SDU_DISC_QUEDLY_QOS_GRP_03`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_04) as `DL_SDU_DISC_QUEDLY_QOS_GRP_04`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_05) as `DL_SDU_DISC_QUEDLY_QOS_GRP_05`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_06) as `DL_SDU_DISC_QUEDLY_QOS_GRP_06`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_07) as `DL_SDU_DISC_QUEDLY_QOS_GRP_07`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_08) as `DL_SDU_DISC_QUEDLY_QOS_GRP_08`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_09) as `DL_SDU_DISC_QUEDLY_QOS_GRP_09`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_10) as `DL_SDU_DISC_QUEDLY_QOS_GRP_10`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_11) as `DL_SDU_DISC_QUEDLY_QOS_GRP_11`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_12) as `DL_SDU_DISC_QUEDLY_QOS_GRP_12`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_13) as `DL_SDU_DISC_QUEDLY_QOS_GRP_13`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_14) as `DL_SDU_DISC_QUEDLY_QOS_GRP_14`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_15) as `DL_SDU_DISC_QUEDLY_QOS_GRP_15`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_16) as `DL_SDU_DISC_QUEDLY_QOS_GRP_16`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_17) as `DL_SDU_DISC_QUEDLY_QOS_GRP_17`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_18) as `DL_SDU_DISC_QUEDLY_QOS_GRP_18`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_19) as `DL_SDU_DISC_QUEDLY_QOS_GRP_19`, SUM(DL_SDU_DISC_QUEDLY_QOS_GRP_20) as `DL_SDU_DISC_QUEDLY_QOS_GRP_20`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_01) as `DL_VOL_DISC_QUEDLY_QOS_GRP_01`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_02) as `DL_VOL_DISC_QUEDLY_QOS_GRP_02`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_03) as `DL_VOL_DISC_QUEDLY_QOS_GRP_03`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_04) as `DL_VOL_DISC_QUEDLY_QOS_GRP_04`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_05) as `DL_VOL_DISC_QUEDLY_QOS_GRP_05`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_06) as `DL_VOL_DISC_QUEDLY_QOS_GRP_06`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_07) as `DL_VOL_DISC_QUEDLY_QOS_GRP_07`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_08) as `DL_VOL_DISC_QUEDLY_QOS_GRP_08`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_09) as `DL_VOL_DISC_QUEDLY_QOS_GRP_09`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_10) as `DL_VOL_DISC_QUEDLY_QOS_GRP_10`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_11) as `DL_VOL_DISC_QUEDLY_QOS_GRP_11`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_12) as `DL_VOL_DISC_QUEDLY_QOS_GRP_12`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_13) as `DL_VOL_DISC_QUEDLY_QOS_GRP_13`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_14) as `DL_VOL_DISC_QUEDLY_QOS_GRP_14`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_15) as `DL_VOL_DISC_QUEDLY_QOS_GRP_15`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_16) as `DL_VOL_DISC_QUEDLY_QOS_GRP_16`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_17) as `DL_VOL_DISC_QUEDLY_QOS_GRP_17`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_18) as `DL_VOL_DISC_QUEDLY_QOS_GRP_18`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_19) as `DL_VOL_DISC_QUEDLY_QOS_GRP_19`, SUM(DL_VOL_DISC_QUEDLY_QOS_GRP_20) as `DL_VOL_DISC_QUEDLY_QOS_GRP_20`, SUM(DL_DELAY_DISC_QOS_GRP_01) as `DL_DELAY_DISC_QOS_GRP_01`, SUM(DL_DELAY_DISC_QOS_GRP_02) as `DL_DELAY_DISC_QOS_GRP_02`, SUM(DL_DELAY_DISC_QOS_GRP_03) as `DL_DELAY_DISC_QOS_GRP_03`, SUM(DL_DELAY_DISC_QOS_GRP_04) as `DL_DELAY_DISC_QOS_GRP_04`, SUM(DL_DELAY_DISC_QOS_GRP_05) as `DL_DELAY_DISC_QOS_GRP_05`, SUM(DL_DELAY_DISC_QOS_GRP_06) as `DL_DELAY_DISC_QOS_GRP_06`, SUM(DL_DELAY_DISC_QOS_GRP_07) as `DL_DELAY_DISC_QOS_GRP_07`, SUM(DL_DELAY_DISC_QOS_GRP_08) as `DL_DELAY_DISC_QOS_GRP_08`, SUM(DL_DELAY_DISC_QOS_GRP_09) as `DL_DELAY_DISC_QOS_GRP_09`, SUM(DL_DELAY_DISC_QOS_GRP_10) as `DL_DELAY_DISC_QOS_GRP_10`, SUM(DL_DELAY_DISC_QOS_GRP_11) as `DL_DELAY_DISC_QOS_GRP_11`, SUM(DL_DELAY_DISC_QOS_GRP_12) as `DL_DELAY_DISC_QOS_GRP_12`, SUM(DL_DELAY_DISC_QOS_GRP_13) as `DL_DELAY_DISC_QOS_GRP_13`, SUM(DL_DELAY_DISC_QOS_GRP_14) as `DL_DELAY_DISC_QOS_GRP_14`, SUM(DL_DELAY_DISC_QOS_GRP_15) as `DL_DELAY_DISC_QOS_GRP_15`, SUM(DL_DELAY_DISC_QOS_GRP_16) as `DL_DELAY_DISC_QOS_GRP_16`, SUM(DL_DELAY_DISC_QOS_GRP_17) as `DL_DELAY_DISC_QOS_GRP_17`, SUM(DL_DELAY_DISC_QOS_GRP_18) as `DL_DELAY_DISC_QOS_GRP_18`, SUM(DL_DELAY_DISC_QOS_GRP_19) as `DL_DELAY_DISC_QOS_GRP_19`, SUM(DL_DELAY_DISC_QOS_GRP_20) as `DL_DELAY_DISC_QOS_GRP_20`, SUM(NUM_RETRANS_QOS_GRP_01) as `NUM_RETRANS_QOS_GRP_01`, SUM(NUM_RETRANS_QOS_GRP_02) as `NUM_RETRANS_QOS_GRP_02`, SUM(NUM_RETRANS_QOS_GRP_03) as `NUM_RETRANS_QOS_GRP_03`, SUM(NUM_RETRANS_QOS_GRP_04) as `NUM_RETRANS_QOS_GRP_04`, SUM(NUM_RETRANS_QOS_GRP_05) as `NUM_RETRANS_QOS_GRP_05`, SUM(NUM_RETRANS_QOS_GRP_06) as `NUM_RETRANS_QOS_GRP_06`, SUM(NUM_RETRANS_QOS_GRP_07) as `NUM_RETRANS_QOS_GRP_07`, SUM(NUM_RETRANS_QOS_GRP_08) as `NUM_RETRANS_QOS_GRP_08`, SUM(NUM_RETRANS_QOS_GRP_09) as `NUM_RETRANS_QOS_GRP_09`, SUM(NUM_RETRANS_QOS_GRP_10) as `NUM_RETRANS_QOS_GRP_10`, SUM(NUM_RETRANS_QOS_GRP_11) as `NUM_RETRANS_QOS_GRP_11`, SUM(NUM_RETRANS_QOS_GRP_12) as `NUM_RETRANS_QOS_GRP_12`, SUM(NUM_RETRANS_QOS_GRP_13) as `NUM_RETRANS_QOS_GRP_13`, SUM(NUM_RETRANS_QOS_GRP_14) as `NUM_RETRANS_QOS_GRP_14`, SUM(NUM_RETRANS_QOS_GRP_15) as `NUM_RETRANS_QOS_GRP_15`, SUM(NUM_RETRANS_QOS_GRP_16) as `NUM_RETRANS_QOS_GRP_16`, SUM(NUM_RETRANS_QOS_GRP_17) as `NUM_RETRANS_QOS_GRP_17`, SUM(NUM_RETRANS_QOS_GRP_18) as `NUM_RETRANS_QOS_GRP_18`, SUM(NUM_RETRANS_QOS_GRP_19) as `NUM_RETRANS_QOS_GRP_19`, SUM(NUM_RETRANS_QOS_GRP_20) as `NUM_RETRANS_QOS_GRP_20`, SUM(VOL_RETRANS_QOS_GRP_01) as `VOL_RETRANS_QOS_GRP_01`, SUM(VOL_RETRANS_QOS_GRP_02) as `VOL_RETRANS_QOS_GRP_02`, SUM(VOL_RETRANS_QOS_GRP_03) as `VOL_RETRANS_QOS_GRP_03`, SUM(VOL_RETRANS_QOS_GRP_04) as `VOL_RETRANS_QOS_GRP_04`, SUM(VOL_RETRANS_QOS_GRP_05) as `VOL_RETRANS_QOS_GRP_05`, SUM(VOL_RETRANS_QOS_GRP_06) as `VOL_RETRANS_QOS_GRP_06`, SUM(VOL_RETRANS_QOS_GRP_07) as `VOL_RETRANS_QOS_GRP_07`, SUM(VOL_RETRANS_QOS_GRP_08) as `VOL_RETRANS_QOS_GRP_08`, SUM(VOL_RETRANS_QOS_GRP_09) as `VOL_RETRANS_QOS_GRP_09`, SUM(VOL_RETRANS_QOS_GRP_10) as `VOL_RETRANS_QOS_GRP_10`, SUM(VOL_RETRANS_QOS_GRP_11) as `VOL_RETRANS_QOS_GRP_11`, SUM(VOL_RETRANS_QOS_GRP_12) as `VOL_RETRANS_QOS_GRP_12`, SUM(VOL_RETRANS_QOS_GRP_13) as `VOL_RETRANS_QOS_GRP_13`, SUM(VOL_RETRANS_QOS_GRP_14) as `VOL_RETRANS_QOS_GRP_14`, SUM(VOL_RETRANS_QOS_GRP_15) as `VOL_RETRANS_QOS_GRP_15`, SUM(VOL_RETRANS_QOS_GRP_16) as `VOL_RETRANS_QOS_GRP_16`, SUM(VOL_RETRANS_QOS_GRP_17) as `VOL_RETRANS_QOS_GRP_17`, SUM(VOL_RETRANS_QOS_GRP_18) as `VOL_RETRANS_QOS_GRP_18`, SUM(VOL_RETRANS_QOS_GRP_19) as `VOL_RETRANS_QOS_GRP_19`, SUM(VOL_RETRANS_QOS_GRP_20) as `VOL_RETRANS_QOS_GRP_20`, MAX(MAX_NUM_OF_DRB) as `MAX_NUM_OF_DRB`, SUM(DL_NUM_ROHC_COMP_HEADER) as `DL_NUM_ROHC_COMP_HEADER`, SUM(DL_VOL_ROHC_COMP_HEADER) as `DL_VOL_ROHC_COMP_HEADER`, SUM(UL_NUM_ROHC_DECOMP_HEADER) as `UL_NUM_ROHC_DECOMP_HEADER`, SUM(UL_VOL_ROHC_DECOMP_HEADER) as `UL_VOL_ROHC_DECOMP_HEADER`, sum(`DURATION`) * 60 as __duration
    FROM `SA_NSN5G_PM.GSITE_PDCP2_R` T1
    GROUP BY MINUTE(T1.START_TIME), HOUR(T1.START_TIME), GSITE_WH_ID, T1.MRBTS_ID, T1.NRBTS_ID;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17625871" author="kristoffsc" created="Fri, 28 Oct 2022 19:40:59 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I would like to try to fix this problem but I would appreciate any guidance. FYI I&apos;ve verified that it still occurs on latest master branch.&lt;/p&gt;

&lt;p&gt;From what I&apos;ve debugged the problem is caused by one rewrited method created from in:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/JavaCodeSplitter.java#:~:text=new%20FunctionSplitter(text%2C%20maxMethodLength).rewrite()&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JavaCodeSplitter -&amp;gt; new FunctionSplitter(text, maxMethodLength).rewrite()&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The FunctionSplitter::visitMethodDeclaration method iterates through JavaParser.BlockStatementContext elements from ctx.methodBody().block().blockStatement() - &amp;gt; &lt;a href=&quot;https://github.com/apache/flink/blob/87c33711fa3a4844598772ceafd66dd4a776eea9/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java#L100:~:text=for%20(JavaParser.BlockStatementContext%20blockStatementContext&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For every element we get ContextString from it and add to the splitFuncBodies list. Later we iterated through this list to Merged them into &lt;a href=&quot;https://github.com/apache/flink/blob/87c33711fa3a4844598772ceafd66dd4a776eea9/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java#L100:~:text=getMergedCodeBlocks(List%3CString%3E%20codeBlock)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Code Blocks&lt;/a&gt; respectively to  maxMethodLength.&lt;/p&gt;

&lt;p&gt;However the problem is that for our case the single JavaParser.BlockStatementContext element from ctx.methodBody().block().blockStatement() by it self is larger than maxMethodLength. Its entire body is converted to the method by FunctionSplitter::getMergedCodeBlocks and this causes the exception.&lt;/p&gt;

&lt;p&gt;The code block is a big while loop that contains a bunch of calls to rewrite$XXXX methods like so:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        rewrite$9722[10418] = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        rewrite$9729[10431] = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        rewrite$9722[10419] = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        rewrite$9729[10432] = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        rewrite$9722[10420] = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        rewrite$9729[10433] = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which in my opinion could be easily extracted to separate methods which will solve the problem.&lt;/p&gt;

&lt;p&gt;I would like to ask:&lt;br/&gt;
1. if my understanding and proposed high level solution for splitting the problematic code block into smaller chunks is correct?&lt;br/&gt;
2. should this be done by FunctionSplitter or this should be implemented in Scala code for code generation?&lt;/p&gt;

&lt;p&gt;I&apos;m quite familiar with Antlr4 so I do understand what is happening there. &lt;/p&gt;

</comment>
                            <comment id="17626347" author="tsreaper" created="Mon, 31 Oct 2022 02:13:07 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KristoffSC&quot; class=&quot;user-hover&quot; rel=&quot;KristoffSC&quot;&gt;KristoffSC&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Thanks for your interest in solving this issue. I&apos;m the author of &lt;tt&gt;JavaCodeSplitter&lt;/tt&gt; and I&apos;d like to offer my thoughts.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;1. if my understanding and proposed high level solution for splitting the problematic code block into smaller chunks is correct?&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Your understanding is quite correct. However it might not be that easy to solve this issue due to some corner cases. For example we may have &lt;tt&gt;continue&lt;/tt&gt;&apos;s and &lt;tt&gt;break&lt;/tt&gt;&apos;s in a &lt;tt&gt;while&lt;/tt&gt; loop, and we also need to deal with the loop variable in a &lt;tt&gt;for&lt;/tt&gt; loop.&lt;/p&gt;

&lt;p&gt;Due to these cases I choose not to recursively split most of the looping code blocks when implementing the first version of &lt;tt&gt;JavaCodeSplitter&lt;/tt&gt;. However for &lt;tt&gt;if&lt;/tt&gt; code blocks I implement a special &lt;tt&gt;IfStatementRewriter&lt;/tt&gt; to split them because they are quite common in generated code and they don&apos;t suffer from those corner cases.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if the generated code in this particular ticket contains &lt;tt&gt;continue&lt;/tt&gt;&apos;s or &lt;tt&gt;break&lt;/tt&gt;&apos;s. If not we may choose to split code blocks without these keywords.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;2. should this be done by FunctionSplitter or this should be implemented in Scala code for code generation?&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;It depends. If this issue is only caused by a single operator I&apos;d like to change the code generation Scala code in that operator. However if other operators may also cause this issue it would be better to fix the &lt;tt&gt;FunctionSplitter&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;To me this issue seems like a common one. I&apos;d prefer fixing the&#160;&lt;tt&gt;FunctionSplitter&lt;/tt&gt; if possible.&lt;/p&gt;</comment>
                            <comment id="17627602" author="kristoffsc" created="Wed, 2 Nov 2022 10:33:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;&lt;br/&gt;
Thanks for replaying.&lt;/p&gt;

&lt;p&gt;The extracted while loop method contains many, many referneces to rewrite$index&lt;span class=&quot;error&quot;&gt;&amp;#91;xxxx&amp;#93;&lt;/span&gt; methods and a lot of self contained if else blocks. &lt;br/&gt;
There is no break, return, continue or break statements. I&apos;ve attached the method body to this ticket.  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13051709/13051709_endInput_falseFilter9123_split9704.txt&quot; title=&quot;endInput_falseFilter9123_split9704.txt attached to FLINK-27246&quot;&gt;endInput_falseFilter9123_split9704.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;So it looks like that body of this method was already reprocessed and rewrite by Spliter.&lt;br/&gt;
Having this I was thinking that maybe if we would &quot;rewrite&quot; it again, to further split it into smaller groups, we could fix the problem.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="17628136" author="tsreaper" created="Thu, 3 Nov 2022 06:31:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KristoffSC&quot; class=&quot;user-hover&quot; rel=&quot;KristoffSC&quot;&gt;KristoffSC&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You talked about &quot;maybe if we would &apos;rewrite&apos; it again, to further split it into smaller groups, we could fix the problem&quot;. What does it mean? Do you mean using &lt;tt&gt;JavaCodeSplitter&lt;/tt&gt; again to further split the code?&lt;/p&gt;

&lt;p&gt;From my understanding there is no use to apply &lt;tt&gt;JavaCodeSplitter&lt;/tt&gt; multiple times because each rewriter has tried its best to split the code. The main reason of this issue is that we&apos;ve generated a very long while loop and &lt;tt&gt;JavaCodeSplitter&lt;/tt&gt; currently does not deal with loops. What we should do is to change the implementation of &lt;tt&gt;FunctionSplitter&lt;/tt&gt; so that it can recursively split each code block, given that there is no break, continue, return or loop variables.&lt;/p&gt;</comment>
                            <comment id="17628218" author="kristoffsc" created="Thu, 3 Nov 2022 09:20:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;&lt;br/&gt;
I see why my comment was causing confusion, apologize for that. &lt;/p&gt;

&lt;p&gt;For a moment I though that FunctionSplitter is rewriting this while block but now I see clearly it does not. &lt;br/&gt;
At the same time I saw that some &quot;rewrite&quot; process is applyed to this block but also now I see it was MemberFieldRewriter logic. &lt;/p&gt;

&lt;p&gt;Long story short, I did not want to run JavaCodeSplitter again but just enhance current logic to handle this &quot;while&quot; case.&lt;/p&gt;</comment>
                            <comment id="17630134" author="tsreaper" created="Tue, 8 Nov 2022 02:30:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KristoffSC&quot; class=&quot;user-hover&quot; rel=&quot;KristoffSC&quot;&gt;KristoffSC&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the clarification. The general approach looks good to me.&lt;/p&gt;

&lt;p&gt;Could you please sketch out your intended solution a bit more? Like which class are you going to modify and how are you going to modify it?&lt;/p&gt;</comment>
                            <comment id="17638614" author="kristoffsc" created="Fri, 25 Nov 2022 10:07:27 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;&lt;br/&gt;
Im sory for a long delay. I was actyally trying to develop a PoC fix for this problem. I think I managed to at least proof a concept. You can find my raft PR here -&amp;gt; &lt;a href=&quot;https://github.com/apache/flink/pull/21393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/21393&lt;/a&gt;  The code from this PR made the SQL from this ticket to compile and execute which is at least something &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;The idea is to enhance FunctionSplitter that for every codeBlock (getMergedCodeBlocks method) that is bigger than &quot;maxMethodLength&quot; try to further split it by calling two new splitters that I&apos;ve created:&lt;br/&gt;
1. BlockStatementSplitter&lt;br/&gt;
2. BlockStatementGrouper&lt;/p&gt;

&lt;p&gt;The BlockStatementSplitter splits body of WHILE, IF/ELSE statements to new methods. The original statement is rewritten that will call those new methods. &lt;/p&gt;

&lt;p&gt;Next ,the &lt;b&gt;BlockStatementGrouper&lt;/b&gt; is groping calls created by &lt;b&gt;BlockStatementSplitter&lt;/b&gt;  to blocks with lengths &amp;lt;  &quot;maxMethodLength&quot; and extracting those to another new method. Finally &lt;b&gt;BlockStatementGrouper&lt;/b&gt; rewrites original code block to call methods created by &lt;b&gt;BlockStatementGrouper&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;For example, an input statement:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (
            (kvPair$9687 = (org.apache.flink.api.java.tuple.Tuple2&amp;lt;org.apache.flink.table.data.binary.BinaryRowData, org.apache.flink.table.data.binary.BinaryRowData&amp;gt;) iterator.next()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            key$6207 = (org.apache.flink.table.data.binary.BinaryRowData) kvPair$9687.f0;
            val$9688 = (org.apache.flink.table.data.binary.BinaryRowData) kvPair$9687.f1;
            local$5912.replace(key$6207, val$9688);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6208 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              lastKey$6208 = key$6207.copy();
              agg0_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        agg0_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        agg1_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        agg1_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        agg3_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        agg3_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6209 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) { 
        agg2_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        agg3_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        agg2_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
}};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will be converted by BlockStatementSplitter to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (
            (kvPair$9687 = (org.apache.flink.api.java.tuple.Tuple2&amp;lt;org.apache.flink.table.data.binary.BinaryRowData, org.apache.flink.table.data.binary.BinaryRowData&amp;gt;) iterator.next()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            top_whileBody0_0();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6208 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              top_whileBody0_0_ifBody0();
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6209 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) { 
        top_whileBody0_0_ifBody1_ifBody0();
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        top_whileBody0_0_ifBody1_ifBody1();
}};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Further this will be converted by BlockStatementGrouper with maxMethodLength parameter set to 4000 to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (
            (kvPair$9687 = (org.apache.flink.api.java.tuple.Tuple2&amp;lt;org.apache.flink.table.data.binary.BinaryRowData, org.apache.flink.table.data.binary.BinaryRowData&amp;gt;) iterator.next()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {

            top_rewriteGroup_0();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Body for the new methods would be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void top_whileBody0_0_ifBody1_ifBody0 {
agg2_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
agg3_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void top_whileBody0_0_ifBody1_ifBody1 {
agg2_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void top_whileBody0_0 {
key$6207 = (org.apache.flink.table.data.binary.BinaryRowData) kvPair$9687.f0;
val$9688 = (org.apache.flink.table.data.binary.BinaryRowData) kvPair$9687.f1;
local$5912.replace(key$6207, val$9688);
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void top_whileBody0_0_ifBody0 {
lastKey$6208 = key$6207.copy();
agg0_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
agg0_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
agg1_sumIsNull = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
agg1_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
agg3_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
agg3_sum = ((org.apache.flink.table.data.DecimalData) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
}

void top_rewriteGroup_0() {
top_whileBody0_0();
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6208 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              top_whileBody0_0_ifBody0();
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastKey$6209 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {         
        top_whileBody0_0_ifBody1_ifBody0();
  } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {       
     top_whileBody0_0_ifBody1_ifBody1();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;What do you think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;?&lt;/p&gt;
</comment>
                            <comment id="17642072" author="kristoffsc" created="Thu, 1 Dec 2022 17:42:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt; I would love for your feedbeck on my PoC fix above.&lt;/p&gt;

&lt;p&gt;thanks.&lt;/p&gt;</comment>
                            <comment id="17651905" author="tsreaper" created="Mon, 26 Dec 2022 02:42:48 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KristoffSC&quot; class=&quot;user-hover&quot; rel=&quot;KristoffSC&quot;&gt;KristoffSC&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Sorry for the long delay as I&apos;m mainly working on the table store module.&lt;/p&gt;

&lt;p&gt;The idea looks good to me and you can continue working on your fix.&lt;/p&gt;

&lt;p&gt;Your fix seems to rewrite both the &lt;tt&gt;WHILE&lt;/tt&gt; statements and the &lt;tt&gt;IF&lt;/tt&gt; statements. For &lt;tt&gt;IF&lt;/tt&gt; statements we already have &lt;tt&gt;IfStatementRewriter&lt;/tt&gt;. Can we remove the special &lt;tt&gt;IfStatementRewriter&lt;/tt&gt; after your fix is implemented? Or are they working on different things? If so, what&apos;s the difference?&lt;/p&gt;</comment>
                            <comment id="17652279" author="kristoffsc" created="Tue, 27 Dec 2022 16:38:43 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;&lt;br/&gt;
Thanks for the feedback.&lt;/p&gt;

&lt;p&gt;Regarding IfStatementRewriter its a little bit tricky for me.&lt;br/&gt;
I think my new thing might handle more cases than IfStatementRewriter did. Plus fStatementRewriter and existing rewrites seems to expect a method declaration + body, where my BlocksStatementGrouper and Splitter are processing individual block statements. They are called from FunctionSplitter::FunctionSplitVisitor where while processing block statements from method&apos;s body.&lt;/p&gt;

&lt;p&gt;Now It seems that after my change,  FunctionSplitter is also rewriting the code, similar to IfStatementRewriter and maybe this is not the best thing to do from the clean code/architecture perspective.&lt;/p&gt;

&lt;p&gt;The problem with IfStatementRewriter  is that it will not rewrite the If/Else branch if the branch contains &quot;while&quot; statement in it or when entire if/else statement is inside while statement, which was the original problem.&lt;/p&gt;

&lt;p&gt;So now I&apos;m wonder should we have this extracted from FunctionSplitter into new BlocksStatementRewriter that whill handle while/If/else statements in combination or can this be inside Function Splitter as it is now.&lt;/p&gt;
</comment>
                            <comment id="17653156" author="kristoffsc" created="Fri, 30 Dec 2022 16:13:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;&lt;br/&gt;
I have modified my PR.&lt;/p&gt;

&lt;p&gt;I reverted all chanegs from FunctionSplitter and I introduced totally new BlockStatementRewriter that is using new classses from original PR, BlockStatementSplitter and BlockStatementGrouper.&lt;/p&gt;

&lt;p&gt;The new BlockStatementRewriter  can handle If/Else/While statemets. For IF/ESLE statemets if produces similiar but not exact result as IfStatementRewriter did.&lt;/p&gt;

&lt;p&gt;However to make the original problem gone I had to use both rewriters, so JavaCodeSplitter now has this in splitImpl&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Optional.ofNullable(
                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DeclarationRewriter(returnValueRewrittenCode, maxMethodLength)
                                .rewrite())
                .map(text -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IfStatementRewriter(text, maxMethodLength).rewrite())
                .map(text -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BlockStatementRewriter(text, maxMethodLength).rewrite())
                .map(text -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FunctionSplitter(text, maxMethodLength).rewrite())
                .map(text -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MemberFieldRewriter(text, maxClassMemberCount).rewrite())
                .orElse(code);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The good news is that all tests on CI/CD are passing. &lt;br/&gt;
Still I have to investigate more. My goal would be to drop IfStatementRewriter and use only BlockStatementRewriter   unless I will find some reason not to. I will keep you posted on this.&lt;/p&gt;</comment>
                            <comment id="17655573" author="kristoffsc" created="Fri, 6 Jan 2023 20:17:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=TsReaper&quot; class=&quot;user-hover&quot; rel=&quot;TsReaper&quot;&gt;TsReaper&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingge&quot; class=&quot;user-hover&quot; rel=&quot;jingge&quot;&gt;jingge&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have finally finished working on my PR for this issue.&lt;br/&gt;
The PR is here: &lt;a href=&quot;https://github.com/apache/flink/pull/21393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/21393&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In short I&apos;ve created new Rewritter that can rewrite IF/ESLE and WHILE blocks including combination and nested statements. I also removed IfStatementRewriter since its logic is covered by my new BlockStatementRewriter.&lt;/p&gt;

&lt;p&gt;I ran the new Code Splitter against SQL query attached to this ticket and it works perfectly.&lt;/p&gt;

&lt;p&gt;I would appreciate if you could take a look and do the review. I added detailed description of my change/solution to the PR.&lt;br/&gt;
Please let me know what do you think.&lt;/p&gt;

&lt;p&gt;Cheers.&lt;/p&gt;
</comment>
                            <comment id="17684496" author="kristoffsc" created="Mon, 6 Feb 2023 08:12:39 +0000"  >&lt;p&gt;master commit: af9a1128f728c691b896bc9c591e9be1327601c4 (included in 1.17 branch)&lt;/p&gt;

&lt;p&gt;1.16 backport PR &lt;a href=&quot;https://github.com/apache/flink/pull/21860&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/21860&lt;/a&gt; (contains bugfix &lt;a href=&quot;https://github.com/apache/flink/pull/21871&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/21871&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17686312" author="tsreaper" created="Thu, 9 Feb 2023 09:32:03 +0000"  >&lt;p&gt;master: af9a1128f728c691b896bc9c591e9be1327601c4&lt;br/&gt;
release-1.16: f8bf7cc0c26773eecc928401f0c9ca5c714cd7bf&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13384087">FLINK-23007</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13051709" name="endInput_falseFilter9123_split9704.txt" size="1267258" author="KristoffSC" created="Wed, 2 Nov 2022 10:33:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11gjk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>