<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19688] Flink batch job fails because of InterruptedExceptions from network stack</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19688</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I have a benchmarking test job, that throws RuntimeExceptions at any operator at a configured, random interval. When using low intervals, such as mean failure rate = 60 s, the job will get into a state where it frequently fails with InterruptedExceptions.&lt;/p&gt;

&lt;p&gt;The same job does not have this problem on Flink 1.11.2 (at least not after running the job for 15 hours, on 1.12-SN, it happens within a few minutes)&lt;br/&gt;
This is the job: &lt;a href=&quot;https://github.com/rmetzger/flip1-bench/blob/master/flip1-bench-jobs/src/main/java/com/ververica/TPCHQuery3.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rmetzger/flip1-bench/blob/master/flip1-bench-jobs/src/main/java/com/ververica/TPCHQuery3.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is the exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-10-16 16:02:15,653 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (8/8)#1 (06d656f696bf4ed98831938a7ac2359d_c1c4a56fea0536703d37867c057f0cc8_7_1) switched from RUNNING to FAILED.
java.lang.Exception: The data preparation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task &lt;span class=&quot;code-quote&quot;&gt;&apos;CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38))&apos;&lt;/span&gt; , caused an error: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at org.apache.flink.runtime.operators.BatchTask.run(BatchTask.java:481) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.BatchTask.invoke(BatchTask.java:370) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:722) [flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:547) [flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) [?:1.8.0_222]
Caused by: org.apache.flink.util.WrappingRuntimeException: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at org.apache.flink.runtime.operators.sort.ExternalSorter.getIterator(ExternalSorter.java:253) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.BatchTask.getInput(BatchTask.java:1122) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.GroupReduceDriver.prepare(GroupReduceDriver.java:99) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.BatchTask.run(BatchTask.java:475) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	... 4 more
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357) ~[?:1.8.0_222]
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895) ~[?:1.8.0_222]
	at org.apache.flink.runtime.operators.sort.ExternalSorter.getIterator(ExternalSorter.java:250) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.BatchTask.getInput(BatchTask.java:1122) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.GroupReduceDriver.prepare(GroupReduceDriver.java:99) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.BatchTask.run(BatchTask.java:475) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	... 4 more
Caused by: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at org.apache.flink.runtime.operators.sort.ExternalSorter.lambda$getIterator$1(ExternalSorter.java:247) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:870) ~[?:1.8.0_222]
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:852) ~[?:1.8.0_222]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474) ~[?:1.8.0_222]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1977) ~[?:1.8.0_222]
	at org.apache.flink.runtime.operators.sort.ExternalSorterBuilder.lambda$doBuild$1(ExternalSorterBuilder.java:363) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.internalHandleException(ThreadBase.java:123) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:82) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: java.io.IOException: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:83) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: org.apache.flink.runtime.io.network.partition.consumer.PartitionConnectionException: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.
	at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.requestSubpartition(RemoteInputChannel.java:160) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.internalRequestPartitions(SingleInputGate.java:305) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:277) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.requestPartitions(InputGateWithMetrics.java:93) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:91) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:47) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ReadingThread.go(ReadingThread.java:68) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:79) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: java.io.IOException: java.util.concurrent.ExecutionException: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Connecting to remote task manager &lt;span class=&quot;code-quote&quot;&gt;&apos;/192.168.2.172:52366&apos;&lt;/span&gt; has failed. This might indicate that the remote task manager has been lost.
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.createPartitionRequestClient(PartitionRequestClientFactory.java:85) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.NettyConnectionManager.createPartitionRequestClient(NettyConnectionManager.java:67) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.requestSubpartition(RemoteInputChannel.java:157) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.internalRequestPartitions(SingleInputGate.java:305) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:277) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.requestPartitions(InputGateWithMetrics.java:93) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:91) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:47) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ReadingThread.go(ReadingThread.java:68) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:79) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: java.util.concurrent.ExecutionException: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Connecting to remote task manager &lt;span class=&quot;code-quote&quot;&gt;&apos;/192.168.2.172:52366&apos;&lt;/span&gt; has failed. This might indicate that the remote task manager has been lost.
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357) ~[?:1.8.0_222]
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895) ~[?:1.8.0_222]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.createPartitionRequestClient(PartitionRequestClientFactory.java:83) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.NettyConnectionManager.createPartitionRequestClient(NettyConnectionManager.java:67) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.requestSubpartition(RemoteInputChannel.java:157) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.internalRequestPartitions(SingleInputGate.java:305) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:277) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.requestPartitions(InputGateWithMetrics.java:93) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:91) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:47) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ReadingThread.go(ReadingThread.java:68) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:79) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Connecting to remote task manager &lt;span class=&quot;code-quote&quot;&gt;&apos;/192.168.2.172:52366&apos;&lt;/span&gt; has failed. This might indicate that the remote task manager has been lost.
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.connect(PartitionRequestClientFactory.java:122) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.connectWithRetries(PartitionRequestClientFactory.java:101) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.lambda$createPartitionRequestClient$1(PartitionRequestClientFactory.java:78) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.concurrent.FutureUtils.completeFromCallable(FutureUtils.java:88) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.createPartitionRequestClient(PartitionRequestClientFactory.java:78) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.NettyConnectionManager.createPartitionRequestClient(NettyConnectionManager.java:67) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.requestSubpartition(RemoteInputChannel.java:157) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.internalRequestPartitions(SingleInputGate.java:305) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:277) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.requestPartitions(InputGateWithMetrics.java:93) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:91) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:47) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ReadingThread.go(ReadingThread.java:68) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:79) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
Caused by: java.lang.InterruptedException
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method) ~[?:1.8.0_222]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502) ~[?:1.8.0_222]
	at org.apache.flink.shaded.netty4.io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:252) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:131) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPromise.await(DefaultChannelPromise.java:30) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.connect(PartitionRequestClientFactory.java:114) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.connectWithRetries(PartitionRequestClientFactory.java:101) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.lambda$createPartitionRequestClient$1(PartitionRequestClientFactory.java:78) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.concurrent.FutureUtils.completeFromCallable(FutureUtils.java:88) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientFactory.createPartitionRequestClient(PartitionRequestClientFactory.java:78) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.netty.NettyConnectionManager.createPartitionRequestClient(NettyConnectionManager.java:67) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.requestSubpartition(RemoteInputChannel.java:157) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.internalRequestPartitions(SingleInputGate.java:305) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:277) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.requestPartitions(InputGateWithMetrics.java:93) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:91) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:47) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ReadingThread.go(ReadingThread.java:68) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
	at org.apache.flink.runtime.operators.sort.ThreadBase.run(ThreadBase.java:79) ~[flink-dist_2.11-1.12-SNAPSHOT.jar:1.12-SNAPSHOT]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will attach all logs to this ticket.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13335859">FLINK-19688</key>
            <summary>Flink batch job fails because of InterruptedExceptions from network stack</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                    </labels>
                <created>Sat, 17 Oct 2020 09:27:53 +0000</created>
                <updated>Tue, 22 Jun 2021 13:55:33 +0000</updated>
                            <resolved>Thu, 22 Oct 2020 08:20:53 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Network</component>
                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17216558" author="till.rohrmann" created="Mon, 19 Oct 2020 09:19:49 +0000"  >&lt;p&gt;Could this be an instance of masking the actual root cause of the &lt;tt&gt;Task&lt;/tt&gt; failure (in our case the user code exception)? cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17216742" author="rmetzger" created="Mon, 19 Oct 2020 14:04:26 +0000"  >&lt;p&gt;I&apos;m trying to investigate what&apos;s going on.&lt;br/&gt;
Here are some of my notes, without any exciting results (yet)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
We have a test setup with 4 TaskManagers.

JM: 2020-10-16 16:01:31,015: TaskManager 2 is the first where an artificial failure is induced through a RuntimeException.

JM: The JobManager then cancels the execution on all TMs:
JM: 2020-10-16 16:01:31,049 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RUNNING to RESTARTING.

(side note)
TM3: 2020-10-16 16:01:31,190: TaskManager 3 is logging a InterruptedException (as a WARN from ExternalSorter) on &lt;span class=&quot;code-quote&quot;&gt;&quot;CHAIN Join (Join at main(TPCHQuery3.java:183)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (7/8)#0&quot;&lt;/span&gt;
(This WARN will be reduced to a DEBUG in https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/apache/flink/pull/13668).
&lt;/span&gt;
JM: cancellation complete, we are RUNNING again:
JM: 2020-10-16 16:01:31,448 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RESTARTING to RUNNING.

TM3: Now TM3 fails a task, with the root cause being an InterruptedException, &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; connecting to TaskManager 0 in PartitionRequestClientFactory.connect().
TM3: 2020-10-16 16:02:15,653 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (8/8)#1 (06d656f696bf4ed98831938a7ac2359d_c1c4a56fea0536703d37867c057f0cc8_7_1) switched from RUNNING to FAILED.
java.lang.Exception: The data preparation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task &lt;span class=&quot;code-quote&quot;&gt;&apos;CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38))&apos;&lt;/span&gt; , caused an error: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_1 not reachable.

JM: receives the report from TM3:
JM: 2020-10-16 16:02:15,860 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (8/8) (06d656f696bf4ed98831938a7ac2359d_c1c4a56fea0536703d37867c057f0cc8_7_1) switched from RUNNING to FAILED on

JM: 2020-10-16 16:02:15,888 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RUNNING to RESTARTING.

What is TM0 doing when TM3 reports the InterruptedException?
Nothing special:
TM0: 2020-10-16 16:02:15,633 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (2/8)#1 (06d656f696bf4ed98831938a7ac2359d_c1c4a56fea0536703d37867c057f0cc8_1_1) switched from DEPLOYING to RUNNING.
TM0: 2020-10-16 16:02:15,894 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task CHAIN DataSource (at getLineitemDataSet(TPCHQuery3.java:347) (org.apache.flink.api.java.io.TupleCsvInputFormat)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (2/8)#1 (06d656f696bf4ed98831938a7ac2359d_7d1f567aae11518e19b6b807800d3af7_1_1).

What is happening afterwards?

2020-10-16 16:02:16,150 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RESTARTING to RUNNING.
2020-10-16 16:02:23,241 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN DataSource (at getOrdersDataSet(TPCHQuery3.java:363) (org.apache.flink.api.java.io.TupleCsvInputFormat)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) -&amp;gt; Filter (Filter at main(TPCHQuery3.java:145)) (4/8) (06d656f696bf4ed98831938a7ac2359d_dbb16db93f572f3995dadfb433c8c1ff_3_2) switched from RUNNING to FAILED on org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot@2e3effa.
java.lang.RuntimeException: Kill requested
2020-10-16 16:02:23,243 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RUNNING to RESTARTING.
2020-10-16 16:02:23,562 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RESTARTING to RUNNING.
2020-10-16 16:03:06,051 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN DataSource (at getLineitemDataSet(TPCHQuery3.java:347) (org.apache.flink.api.java.io.TupleCsvInputFormat)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (7/8) (06d656f696bf4ed98831938a7ac2359d_12527f4a17e3fa06633ddc6f343514ed_6_3) switched from RUNNING to FAILED on org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot@1de3a10.
java.lang.RuntimeException: Kill requested
2020-10-16 16:03:06,266 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RESTARTING to RUNNING.
2020-10-16 16:03:48,543 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (7/8) (06d656f696bf4ed98831938a7ac2359d_c1c4a56fea0536703d37867c057f0cc8_6_4) switched from RUNNING to FAILED on org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot@56d6a66.
java.lang.Exception: The data preparation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task &lt;span class=&quot;code-quote&quot;&gt;&apos;CHAIN GroupReduce (GroupReduce at main(TPCHQuery3.java:199)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38))&apos;&lt;/span&gt; , caused an error: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger Reading &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&apos;&lt;/span&gt; terminated due to an exception: Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partition 060d457c4163472f65a4b741993c83f8#0@06d656f696bf4ed98831938a7ac2359d_0bcc9fbf9ac242d5aac540917d980e44_0_4 not reachable.
2020-10-16 16:03:48,548 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RUNNING to RESTARTING.
2020-10-16 16:03:48,704 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RESTARTING to RUNNING.
2020-10-16 16:04:31,385 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN DataSource (at getLineitemDataSet(TPCHQuery3.java:347) (org.apache.flink.api.java.io.TupleCsvInputFormat)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (2/8) (06d656f696bf4ed98831938a7ac2359d_12527f4a17e3fa06633ddc6f343514ed_1_5) switched from RUNNING to FAILED on org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot@124567d2.
java.lang.RuntimeException: Kill requested
2020-10-16 16:04:31,387 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job TPCH Query 3 Example (06d656f696bf4ed98831938a7ac2359d) switched from state RUNNING to RESTARTING.
... and so on ...

It seems that we are not in a restart loop. Rather sometimes the execution gets interrupted.

Could it be an interrupt from the operating system?
Unlikely, we are logging signals:
2020-10-16 16:00:04,092 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Registered UNIX signal handlers &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; [TERM, HUP, INT]
there is only one signal logged
2020-10-16 16:10:31,680 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - RECEIVED SIGNAL 15: SIGTERM. Shutting down as requested.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will now try to find out who&apos;s interrupting the thread.&lt;/p&gt;</comment>
                            <comment id="17218855" author="roman_khachatryan" created="Thu, 22 Oct 2020 08:18:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/pull/13723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/13723&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17218858" author="arvid" created="Thu, 22 Oct 2020 08:20:48 +0000"  >&lt;p&gt;Merged into master as 840e8af879e69c1bf9ad121b670a2703eb88b858.&lt;br/&gt;
Closing issue as resolved.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13336925">FLINK-19791</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13346237">FLINK-20615</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13013707" name="logs.tgz" size="462758" author="rmetzger" created="Sat, 17 Oct 2020 09:29:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 3 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jrw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>