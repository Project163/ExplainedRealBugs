<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:10:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-27169] PartiallyFinishedSourcesITCase.test hangs on azure</title>
                <link>https://issues.apache.org/jira/browse/FLINK-27169</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Apr 10 08:32:18 &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; #1 prio=5 os_prio=0 tid=0x00007f553400b800 nid=0x8345 waiting on condition [0x00007f553be60000]
Apr 10 08:32:18    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (sleeping)
Apr 10 08:32:18 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
Apr 10 08:32:18 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:145)
Apr 10 08:32:18 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:138)
Apr 10 08:32:18 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitForSubtasksToFinish(CommonTestUtils.java:291)
Apr 10 08:32:18 	at org.apache.flink.runtime.operators.lifecycle.TestJobExecutor.waitForSubtasksToFinish(TestJobExecutor.java:226)
Apr 10 08:32:18 	at org.apache.flink.runtime.operators.lifecycle.PartiallyFinishedSourcesITCase.test(PartiallyFinishedSourcesITCase.java:138)
Apr 10 08:32:18 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
Apr 10 08:32:18 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
Apr 10 08:32:18 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
Apr 10 08:32:18 	at java.lang.reflect.Method.invoke(Method.java:498)
Apr 10 08:32:18 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
Apr 10 08:32:18 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
Apr 10 08:32:18 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
Apr 10 08:32:18 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
Apr 10 08:32:18 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
Apr 10 08:32:18 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
Apr 10 08:32:18 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
Apr 10 08:32:18 	at org.apache.flink.util.TestNameProvider$1.evaluate(TestNameProvider.java:45)
Apr 10 08:32:18 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
Apr 10 08:32:18 	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
Apr 10 08:32:18 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
Apr 10 08:32:18 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
Apr 10 08:32:18 	at org.junit.runners.Suite.runChild(Suite.java:128)
Apr 10 08:32:18 	at org.junit.runners.Suite.runChild(Suite.java:27)
Apr 10 08:32:18 	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=34484&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=6757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=34484&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=6757&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13438883">FLINK-27169</key>
            <summary>PartiallyFinishedSourcesITCase.test hangs on azure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="gaoyunhaii">Yun Gao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 11 Apr 2022 08:15:45 +0000</created>
                <updated>Wed, 8 Mar 2023 17:55:22 +0000</updated>
                            <resolved>Fri, 3 Mar 2023 20:12:24 +0000</resolved>
                                    <version>1.16.0</version>
                    <version>1.15.3</version>
                                    <fixVersion>1.16.0</fixVersion>
                    <fixVersion>1.15.4</fixVersion>
                                    <component>Runtime / Checkpointing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17520396" author="gaoyunhaii" created="Mon, 11 Apr 2022 08:16:00 +0000"  >&lt;p&gt;I&apos;ll have a look&lt;/p&gt;</comment>
                            <comment id="17539975" author="zentol" created="Fri, 20 May 2022 07:57:22 +0000"  >&lt;p&gt;What seems to happen is that the job keeps checkpointing and eventually runs out of disk space.&lt;br/&gt;
This only seems to happen when the changelog statebackend is used.&lt;/p&gt;

&lt;p&gt;I don&apos;t know why the test doesn&apos;t exit earlier, so there may be 2 separate issues here.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt; Could you have a look?&lt;/p&gt;</comment>
                            <comment id="17542043" author="roman_khachatryan" created="Wed, 25 May 2022 13:10:01 +0000"  >&lt;p&gt;Thanks for looking into the issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;.&lt;br/&gt;
This is what I believe leads to test hanging up:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Checkpoint 1 completes&lt;/li&gt;
	&lt;li&gt;Several subsequent checkpoints fail due to a timeout while writing changelog segments (all 3 configured attempts exhausted)&lt;/li&gt;
	&lt;li&gt;Job graph gets restarted due to failure&lt;/li&gt;
	&lt;li&gt;FINISH_SOURCES command gets lost as a result&lt;/li&gt;
	&lt;li&gt;TestJobExecutor hangs in waitForSubtasksToFinish as a result&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I suppose the root cause is an intermittent failure of the local disk. I&apos;m going to increase the timeout and the number of attempts in test. Increasing environment.tolerable_declined_checkpoint_number won&apos;t help because a failed upload fails all subsequent checkpoint (until the segment materialized).&lt;/p&gt;


&lt;p&gt;To prevent the test from hanging up, I&apos;m going to add a timeout (restarts can not be disabled because they are required by the test scenario; and can not be detected easily)&lt;br/&gt;
To ease debugging I&apos;m going to raise the log level TestJobExecutor to INFO.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;ll open a PR with the above changes.&lt;/p&gt;</comment>
                            <comment id="17542461" author="roman_khachatryan" created="Thu, 26 May 2022 12:16:50 +0000"  >&lt;p&gt;Merged into master as 0b139a12c2c24e07cedb43bbad6ee1ff634bcfcb..f0ec84a36c5751ab5375702b1c147fd417b729da.&lt;/p&gt;</comment>
                            <comment id="17693543" author="roman_khachatryan" created="Sat, 25 Feb 2023 22:33:03 +0000"  >&lt;p&gt;Reopening to backport the fix to 1.15 (&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-31133&quot; title=&quot;PartiallyFinishedSourcesITCase hangs if a checkpoint fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-31133&quot;&gt;&lt;del&gt;FLINK-31133&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17696302" author="roman_khachatryan" created="Fri, 3 Mar 2023 20:12:24 +0000"  >&lt;p&gt;Backported to 1.15 as ddec8d8e144c9cc9adb0a04f41c9667cdd68aabb.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13434112">FLINK-26685</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 36 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11c74:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>