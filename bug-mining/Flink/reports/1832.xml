<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7126] Support Distinct for Stream SQL and Table API</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7126</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description></description>
                <environment></environment>
        <key id="13085442">FLINK-7126</key>
            <summary>Support Distinct for Stream SQL and Table API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jark">Jark Wu</assignee>
                                    <reporter username="jark">Jark Wu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Jul 2017 08:10:15 +0000</created>
                <updated>Thu, 13 Jul 2017 06:35:28 +0000</updated>
                            <resolved>Thu, 13 Jul 2017 06:35:28 +0000</resolved>
                                    <version>1.4.0</version>
                                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16077779" author="githubbot" created="Fri, 7 Jul 2017 08:17:13 +0000"  >&lt;p&gt;GitHub user wuchong opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7126&quot; title=&quot;Support Distinct for Stream SQL and Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7126&quot;&gt;&lt;del&gt;FLINK-7126&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Support Distinct for Stream SQL and Table API&lt;/p&gt;

&lt;p&gt;    Distinct is a syntax sugar which is translated to a GROUP BY by Calcite. As we have supported GROUP BY on stream tables, distinct is also supported.&lt;/p&gt;


&lt;p&gt;    Thanks for contributing to Apache Flink. Before you open your pull request, please take the following check list into consideration.&lt;br/&gt;
    If your changes take all of the items into account, feel free to open your pull request. For more information and/or questions please refer to the &lt;span class=&quot;error&quot;&gt;&amp;#91;How To Contribute guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/how-to-contribute.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/how-to-contribute.html&lt;/a&gt;).&lt;br/&gt;
    In addition to going through the list, please provide a meaningful description of your changes.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] General&lt;/li&gt;
	&lt;li&gt;The pull request references the related JIRA issue (&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;FLINK-XXX&amp;#93;&lt;/span&gt; Jira title text&quot;)&lt;/li&gt;
	&lt;li&gt;The pull request addresses only one issue&lt;/li&gt;
	&lt;li&gt;Each commit in the PR has a meaningful commit message (including the JIRA id)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Documentation&lt;/li&gt;
	&lt;li&gt;Documentation has been added for new functionality&lt;/li&gt;
	&lt;li&gt;Old documentation affected by the pull request has been updated&lt;/li&gt;
	&lt;li&gt;JavaDoc for public methods has been added&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Tests &amp;amp; Build&lt;/li&gt;
	&lt;li&gt;Functionality added by the pull request is covered by tests&lt;/li&gt;
	&lt;li&gt;`mvn clean verify` has been executed successfully locally or a Travis build has passed&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/wuchong/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/wuchong/flink&lt;/a&gt; distinct&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4279&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit dbd9ad9e244fd653dc6e512807f0505e4e3367df&lt;br/&gt;
Author: Jark Wu &amp;lt;jark@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-07T08:10:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7126&quot; title=&quot;Support Distinct for Stream SQL and Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7126&quot;&gt;&lt;del&gt;FLINK-7126&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Support Distinct for Stream SQL and Table API&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16078057" author="githubbot" created="Fri, 7 Jul 2017 13:18:57 +0000"  >&lt;p&gt;Github user sunjincheng121 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126135016&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126135016&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/sql.md &amp;#8212;&lt;br/&gt;
    @@ -284,7 +284,7 @@ FROM Orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Update tableAPI.md&lt;/p&gt;</comment>
                            <comment id="16079965" author="githubbot" created="Mon, 10 Jul 2017 07:15:53 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @sunjincheng121 , I have updated tableAPI document.&lt;/p&gt;</comment>
                            <comment id="16081139" author="githubbot" created="Mon, 10 Jul 2017 21:01:39 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126534907&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126534907&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/table/api/scala/stream/sql/AggregationsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -39,4 +40,42 @@ class AggregationsTest extends TableTestBase &lt;/p&gt;
{
     
         streamUtil.tEnv.sql(sqlQuery)
       }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinct(): Unit = &lt;/p&gt;
{
    +    val sql = &quot;SELECT DISTINCT a, b, c FROM MyTable&quot;
    +
    +    val expected =
    +      unaryNode(
    +        &quot;DataStreamGroupAggregate&quot;,
    +        streamTableNode(0),
    +        term(&quot;groupBy&quot;, &quot;a, b, c&quot;),
    +        term(&quot;select&quot;, &quot;a, b, c&quot;)
    +      )
    +    streamUtil.verifySql(sql, expected)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinctAfterAggregate(): Unit = {&lt;br/&gt;
    +    val sql = &quot;SELECT DISTINCT a FROM MyTable GROUP BY a, b, c&quot;&lt;br/&gt;
    +&lt;br/&gt;
    +    val expected =&lt;br/&gt;
    +      unaryNode(&lt;br/&gt;
    +        &quot;DataStreamGroupAggregate&quot;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shouldn&apos;t this query be optimized to only have a single `DataStreamGroupAggregate`? @wuchong can you check this and open a JIRA if this is the case? Thank you&lt;/p&gt;</comment>
                            <comment id="16081140" author="githubbot" created="Mon, 10 Jul 2017 21:01:39 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126535807&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126535807&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/table/api/scala/stream/table/GroupAggregationsITCase.scala &amp;#8212;&lt;br/&gt;
    @@ -38,6 +38,43 @@ class GroupAggregationsITCase extends StreamingWithStateTestBase {&lt;br/&gt;
       private val queryConfig = new StreamQueryConfig()&lt;br/&gt;
       queryConfig.withIdleStateRetentionTime(Time.hours(1), Time.hours(2))&lt;/p&gt;

&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinct(): Unit = &lt;/p&gt;
{
    +    val env = StreamExecutionEnvironment.getExecutionEnvironment
    +    env.setStateBackend(getStateBackend)
    +    val tEnv = TableEnvironment.getTableEnvironment(env)
    +    StreamITCase.clear
    +
    +    val t = StreamTestData.get3TupleDataStream(env).toTable(tEnv, &apos;a, &apos;b, &apos;c)
    +      .select(&apos;b).distinct()
    +
    +    val results = t.toRetractStream[Row](queryConfig)
    +    results.addSink(new StreamITCase.RetractingSink).setParallelism(1)
    +    env.execute()
    +
    +    val expected = mutable.MutableList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;)
    +    assertEquals(expected.sorted, StreamITCase.retractedResults.sorted)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinctAfterAggregate(): Unit = {&lt;br/&gt;
    +    val env = StreamExecutionEnvironment.getExecutionEnvironment&lt;br/&gt;
    +    env.setStateBackend(getStateBackend)&lt;br/&gt;
    +    val tEnv = TableEnvironment.getTableEnvironment(env)&lt;br/&gt;
    +    StreamITCase.clear&lt;br/&gt;
    +&lt;br/&gt;
    +    val t = StreamTestData.get5TupleDataStream(env).toTable(tEnv, &apos;a, &apos;b, &apos;c, &apos;d, &apos;e)&lt;br/&gt;
    +      .groupBy(&apos;a, &apos;e).select(&apos;e).distinct()&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think it would be better if the first aggregation would produce updates, such as a `.groupBy(&apos;e).select(&apos;e, &apos;a.count()).distinct()`. The count aggregation will produce different count values which have to be retracted and accumulated.&lt;/p&gt;</comment>
                            <comment id="16081141" author="githubbot" created="Mon, 10 Jul 2017 21:01:39 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126532548&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126532548&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/sql.md &amp;#8212;&lt;br/&gt;
    @@ -284,7 +284,7 @@ FROM Orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Please add the `Result Updating` label:&lt;br/&gt;
    ```&lt;br/&gt;
    &amp;lt;span class=&quot;label label-info&quot;&amp;gt;Result Updating&amp;lt;/span&amp;gt;&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    If the input table of a Distinct operation produces updates, Distinct might also produce updates, i.e., deletes.&lt;/p&gt;</comment>
                            <comment id="16081142" author="githubbot" created="Mon, 10 Jul 2017 21:01:39 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126534385&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126534385&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/tableApi.md &amp;#8212;&lt;br/&gt;
    @@ -373,7 +373,7 @@ Table result = orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This also needs the `Result Updating` label.&lt;/p&gt;</comment>
                            <comment id="16081615" author="githubbot" created="Tue, 11 Jul 2017 03:53:50 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126589666&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126589666&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/table/api/scala/stream/sql/AggregationsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -39,4 +40,42 @@ class AggregationsTest extends TableTestBase &lt;/p&gt;
{
     
         streamUtil.tEnv.sql(sqlQuery)
       }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinct(): Unit = &lt;/p&gt;
{
    +    val sql = &quot;SELECT DISTINCT a, b, c FROM MyTable&quot;
    +
    +    val expected =
    +      unaryNode(
    +        &quot;DataStreamGroupAggregate&quot;,
    +        streamTableNode(0),
    +        term(&quot;groupBy&quot;, &quot;a, b, c&quot;),
    +        term(&quot;select&quot;, &quot;a, b, c&quot;)
    +      )
    +    streamUtil.verifySql(sql, expected)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testDistinctAfterAggregate(): Unit = {&lt;br/&gt;
    +    val sql = &quot;SELECT DISTINCT a FROM MyTable GROUP BY a, b, c&quot;&lt;br/&gt;
    +&lt;br/&gt;
    +    val expected =&lt;br/&gt;
    +      unaryNode(&lt;br/&gt;
    +        &quot;DataStreamGroupAggregate&quot;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Thanks, I think we don&apos;t have the optimization right now. So I filed a JIRA, see &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7144&quot; title=&quot;Optimize multiple LogicalAggregate into one&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7144&quot;&gt;&lt;del&gt;FLINK-7144&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16081616" author="githubbot" created="Tue, 11 Jul 2017 03:54:46 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126589762&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126589762&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/tableApi.md &amp;#8212;&lt;br/&gt;
    @@ -373,7 +373,7 @@ Table result = orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think, Distinct always produces updates no matter the input table produces updates. Because the distinct is translated into GroupBy.&lt;/p&gt;</comment>
                            <comment id="16081828" author="githubbot" created="Tue, 11 Jul 2017 07:47:56 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126617388&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126617388&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/tableApi.md &amp;#8212;&lt;br/&gt;
    @@ -373,7 +373,7 @@ Table result = orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If the input is append/insert only, distinct will only produce insert changes as well. &lt;br/&gt;
    However, I don&apos;t think we make this distinction in the decoration phase. AFAIK, it will always be marked to produce updates right now.&lt;/p&gt;

&lt;p&gt;    IMO, it would be good if DISTINCT on append-only input would not be treated as producing updates. We don&apos;t have to fix it in this PR, but I think it would be good to make such a change. What do you think @wuchong?&lt;/p&gt;</comment>
                            <comment id="16081848" author="githubbot" created="Tue, 11 Jul 2017 08:20:08 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @fhueske , I have addressed your comments.&lt;/p&gt;</comment>
                            <comment id="16082181" author="githubbot" created="Tue, 11 Jul 2017 13:20:50 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279#discussion_r126685098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279#discussion_r126685098&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: docs/dev/table/sql.md &amp;#8212;&lt;br/&gt;
    @@ -284,12 +284,14 @@ FROM Orders&lt;br/&gt;
         &amp;lt;tr&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;&lt;br/&gt;
             &amp;lt;strong&amp;gt;Distinct&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Batch&amp;lt;/span&amp;gt; &amp;lt;span class=&quot;label label-primary&quot;&amp;gt;Streaming&amp;lt;/span&amp;gt; &amp;lt;br&amp;gt;&lt;br/&gt;
    +        &amp;lt;span class=&quot;label label-info&quot;&amp;gt;Result Updating&amp;lt;/span&amp;gt;&lt;br/&gt;
           &amp;lt;/td&amp;gt;&lt;br/&gt;
           &amp;lt;td&amp;gt;
     {% highlight sql %}
&lt;p&gt;     SELECT DISTINCT users FROM Orders&lt;/p&gt;
     {% endhighlight %}
&lt;p&gt;    +       &amp;lt;p&amp;gt;&amp;lt;b&amp;gt;Note:&amp;lt;/b&amp;gt; DISTINCT on a streaming table produces an updating result. And for streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct fields. Please provide a query configuration with valid retention interval to prevent excessive state size. See &amp;lt;a href=&quot;streaming.html&quot;&amp;gt;Streaming Concepts&amp;lt;/a&amp;gt; for details.&amp;lt;/p&amp;gt;&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think we do not need this first sentence (should be covert by the &quot;Result Updating&quot; tag). &lt;br/&gt;
    -&amp;gt; `And for streaming queries the required ...` -&amp;gt; `For streaming queries the required ...`&lt;/p&gt;</comment>
                            <comment id="16083463" author="githubbot" created="Wed, 12 Jul 2017 05:21:15 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Updated&lt;/p&gt;</comment>
                            <comment id="16083475" author="githubbot" created="Wed, 12 Jul 2017 05:41:37 +0000"  >&lt;p&gt;Github user sunjincheng121 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @wuchong  Thanks for the update.&lt;br/&gt;
    +1 to merge.&lt;/p&gt;</comment>
                            <comment id="16083600" author="githubbot" created="Wed, 12 Jul 2017 07:47:10 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 to merge&lt;/p&gt;</comment>
                            <comment id="16083888" author="githubbot" created="Wed, 12 Jul 2017 12:17:23 +0000"  >&lt;p&gt;Github user sunjincheng121 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;ll merge this PR.&lt;/p&gt;</comment>
                            <comment id="16083982" author="githubbot" created="Wed, 12 Jul 2017 13:35:16 +0000"  >&lt;p&gt;Github user sunjincheng121 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging ...&lt;/p&gt;</comment>
                            <comment id="16085212" author="githubbot" created="Thu, 13 Jul 2017 05:47:37 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4279&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16085261" author="sunjincheng121" created="Thu, 13 Jul 2017 06:35:28 +0000"  >&lt;p&gt;Fixed in c8ca31aba083304117ed527c5c80cb9ede2b81bd &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h8en:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>