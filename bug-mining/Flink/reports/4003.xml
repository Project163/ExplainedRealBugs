<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:45:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17514] TaskCancelerWatchdog does not kill TaskManager</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17514</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The watchdog reports a fatal error using &lt;tt&gt;taskManager.notifyFatalError(msg, null)&lt;/tt&gt;. This should normally lead to the TaskManager being terminated. The code introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16225&quot; title=&quot;Metaspace Out Of Memory should be handled as Fatal Error in TaskManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16225&quot;&gt;&lt;del&gt;FLINK-16225&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
 tries to look at the passed exception and will eventually fail with a &lt;tt&gt;NullPointerException&lt;/tt&gt;, which prevents the TaskManager from being terminated.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-05-05 09:43:01,588 ERROR org.apache.flink.runtime.taskmanager.Task                     - Task did not exit gracefully within 180 + seconds.
2020-05-05 09:43:01,588 ERROR org.apache.flink.runtime.taskexecutor.TaskExecutor            - Task did not exit gracefully within 180 + seconds.
2020-05-05 09:43:01,588 ERROR org.apache.flink.runtime.taskmanager.Task                     - Error in Task Cancellation Watch Dog
java.lang.NullPointerException
	at org.apache.flink.util.ExceptionUtils.isOutOfMemoryErrorWithMessageStartingWith(ExceptionUtils.java:186)
	at org.apache.flink.util.ExceptionUtils.isMetaspaceOutOfMemoryError(ExceptionUtils.java:170)
	at org.apache.flink.util.ExceptionUtils.enrichTaskManagerOutOfMemoryError(ExceptionUtils.java:144)
	at org.apache.flink.runtime.taskexecutor.TaskManagerRunner.onFatalError(TaskManagerRunner.java:249)
	at org.apache.flink.runtime.taskexecutor.TaskExecutor$TaskManagerActionsImpl.notifyFatalError(TaskExecutor.java:1751)
	at org.apache.flink.runtime.taskmanager.Task$TaskCancelerWatchDog.run(Task.java:1514)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13302812">FLINK-17514</key>
            <summary>TaskCancelerWatchdog does not kill TaskManager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="aljoscha">Aljoscha Krettek</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 5 May 2020 07:48:45 +0000</created>
                <updated>Wed, 6 May 2020 16:07:35 +0000</updated>
                            <resolved>Wed, 6 May 2020 07:24:09 +0000</resolved>
                                    <version>1.10.1</version>
                    <version>1.11.0</version>
                                    <fixVersion>1.10.1</fixVersion>
                    <fixVersion>1.11.0</fixVersion>
                                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17099632" author="rmetzger" created="Tue, 5 May 2020 08:04:17 +0000"  >&lt;p&gt;Are you sure &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16255&quot; title=&quot;Docs don&amp;#39;t build&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16255&quot;&gt;&lt;del&gt;FLINK-16255&lt;/del&gt;&lt;/a&gt; caused this?&lt;/p&gt;</comment>
                            <comment id="17099637" author="aljoscha" created="Tue, 5 May 2020 08:11:06 +0000"  >&lt;p&gt;Typo, dammit...&#160;&#128517;&lt;/p&gt;</comment>
                            <comment id="17099642" author="aljoscha" created="Tue, 5 May 2020 08:13:28 +0000"  >&lt;p&gt;Btw, &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16225&quot; title=&quot;Metaspace Out Of Memory should be handled as Fatal Error in TaskManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16225&quot;&gt;&lt;del&gt;FLINK-16225&lt;/del&gt;&lt;/a&gt; is not marked as closed and the fix version is 1.10.2, but the code is on release-1.10 and in the RC for 1.10.1&lt;/p&gt;</comment>
                            <comment id="17099682" author="carp84" created="Tue, 5 May 2020 08:55:50 +0000"  >&lt;p&gt;If I understand it correctly, the changes merged into release-1.10 from &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16225&quot; title=&quot;Metaspace Out Of Memory should be handled as Fatal Error in TaskManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16225&quot;&gt;&lt;del&gt;FLINK-16225&lt;/del&gt;&lt;/a&gt; were for error messages improvement rather than real fix of the issue, so the fix version was changed to 1.10.2 for a real fix.&lt;/p&gt;

&lt;p&gt;OTOH, since the merged changes caused the NPE regression, let&apos;s fix this before releasing 1.10.1&lt;/p&gt;</comment>
                            <comment id="17099689" author="till.rohrmann" created="Tue, 5 May 2020 09:04:29 +0000"  >&lt;p&gt;I think the problem is two-fold. The change introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16225&quot; title=&quot;Metaspace Out Of Memory should be handled as Fatal Error in TaskManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16225&quot;&gt;&lt;del&gt;FLINK-16225&lt;/del&gt;&lt;/a&gt; assumes that the value is non-null. I think we should harden this since fatal failure handling code should not fail. The other part is that the &lt;tt&gt;TaskCancelerWatchDog&lt;/tt&gt; calls &lt;tt&gt;TaskManagerActions.notifyFatalError&lt;/tt&gt; with a null argument. The interface does not allow this.&lt;/p&gt;</comment>
                            <comment id="17099693" author="till.rohrmann" created="Tue, 5 May 2020 09:08:57 +0000"  >&lt;p&gt;Quick question: Was the &lt;tt&gt;TaskExecutor&lt;/tt&gt; still killed? If I&apos;m not mistaken then we should have set an uncaught exception handler which terminates the process because of the NPE.&lt;/p&gt;</comment>
                            <comment id="17099694" author="till.rohrmann" created="Tue, 5 May 2020 09:11:18 +0000"  >&lt;p&gt;I think the problem is that the NPE is not a fatal error and hence it won&apos;t be rethrown. This is also something we should change.&lt;/p&gt;</comment>
                            <comment id="17100537" author="till.rohrmann" created="Wed, 6 May 2020 07:24:09 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.11.0: &lt;br/&gt;
0ea539d837c43541110f327a10ec207a259a32ed&lt;br/&gt;
221bbf792e60de7cc6197612cd3fa3621893961a&lt;br/&gt;
fdd128af3be23ad5b21055f3fee69602bf7712b5&lt;/p&gt;

&lt;p&gt;1.10.1:&lt;br/&gt;
bd76b42228bde4f25969d65712f7799771fb91e9&lt;br/&gt;
f3f1bd3020c473d65fe8963262b8962d20e84d6d&lt;br/&gt;
48ae089e15e9a324897869e9cf2577587aceffbf&lt;/p&gt;</comment>
                            <comment id="17100932" author="aljoscha" created="Wed, 6 May 2020 16:07:35 +0000"  >&lt;p&gt;Maybe a bit late, but no, the &lt;tt&gt;TaskExecutor&lt;/tt&gt; was not killed, it kept running forever after wards. (at least until I killed it finally ... &#128521;)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13286849">FLINK-16225</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0edsw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>