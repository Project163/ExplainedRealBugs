<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:35:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9884] Slot request may not be removed when it has already be assigned in slot manager</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9884</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When task executor report a slotA with allocationId1, it may happen that slot manager record slotA is assigned to allocationId2, and the slot request with allocationId1 is not assigned. Then slot manager will update itself with slotA assigned to allocationId1, by it does not clear the slot request with allocationId1.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;There is one free slot in slot manager.&lt;/li&gt;
	&lt;li&gt;Now come two slot request with allocationId1 and allocationId2.&lt;/li&gt;
	&lt;li&gt;The slot is assigned to allocationId1, but the requestSlot call timeout.&lt;/li&gt;
	&lt;li&gt;SlotManager assign the slot to allocationId2 and insert&#160;a slot request with allocationId1.&lt;/li&gt;
	&lt;li&gt;The second requestSlot call to task executor return SlotOccupiedException.&lt;/li&gt;
	&lt;li&gt;SlotManager update the slot to allocationID1, but the slot request is left.&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13172856">FLINK-9884</key>
            <summary>Slot request may not be removed when it has already be assigned in slot manager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tiemsn">shuai.xu</assignee>
                                    <reporter username="tiemsn">shuai.xu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 18 Jul 2018 07:53:24 +0000</created>
                <updated>Thu, 28 Feb 2019 14:12:34 +0000</updated>
                            <resolved>Tue, 18 Sep 2018 14:34:57 +0000</resolved>
                                    <version>1.5.3</version>
                    <version>1.6.0</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.5.5</fixVersion>
                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>1.7.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16547518" author="githubbot" created="Wed, 18 Jul 2018 08:05:27 +0000"  >&lt;p&gt;GitHub user shuai-xu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9884&quot; title=&quot;Slot request may not be removed when it has already be assigned in slot manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9884&quot;&gt;&lt;del&gt;FLINK-9884&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; fix slot request may not be removed when it has already be assigned in slot manager&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    &lt;b&gt;(The pull request fix the bug that slot request may not be removed from pendingSlotRequests in slot manager when it has been assigned.)&lt;/b&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change added tests and can be verified as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*Added test in SlotManagerTest.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/shuai-xu/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/shuai-xu/flink&lt;/a&gt; jira-9884&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6360.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6360&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 58e24424401d28647e376a9ee32d7b70d9ca2724&lt;br/&gt;
Author: shuai-xu &amp;lt;shuaixu@...&amp;gt;&lt;br/&gt;
Date:   2018-07-18T07:54:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9884&quot; title=&quot;Slot request may not be removed when it has already be assigned in slot manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9884&quot;&gt;&lt;del&gt;FLINK-9884&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; fix slot request may not be removed when it has already be assigned in slot manager&lt;/p&gt;

&lt;p&gt;commit 4d53107a2817e0e3def8ed31926a7b4a97251c1c&lt;br/&gt;
Author: shuai-xu &amp;lt;shuaixu@...&amp;gt;&lt;br/&gt;
Date:   2018-07-18T07:56:50Z&lt;/p&gt;

&lt;p&gt;    adjust the import order&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16548559" author="githubbot" created="Wed, 18 Jul 2018 23:15:12 +0000"  >&lt;p&gt;Github user tison1 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @shuai-xu &lt;br/&gt;
    It makes sense.&lt;br/&gt;
    The message that TM has successfully allocated slot might lost in transport.&lt;br/&gt;
    When slot manager receives a slot status report which says one slot has allocation id irrelevant to this offer, then the slot is allocated to another slot request.&lt;br/&gt;
    It looks this PR prevents runtime from some potential resource leak, doesn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="16549054" author="githubbot" created="Thu, 19 Jul 2018 09:33:59 +0000"  >&lt;p&gt;Github user tison1 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;gt; When task executor report a slotA with allocationId1, it may happen that slot manager record slotA is assigned to allocationId2, and the slot request with allocationId1 is not assigned. Then slot manager will update itself with slotA assigned to allocationId1, by it does not clear the slot request with allocationId1.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; For example:&lt;br/&gt;
    &amp;gt;  &amp;#35; There is one free slot in slot manager.&lt;br/&gt;
    &amp;gt;  &amp;#35; Now come two slot request with allocationId1 and allocationId2.&lt;br/&gt;
    &amp;gt;  &amp;#35; The slot is assigned to allocationId1, but the requestSlot call timeout.&lt;br/&gt;
    &amp;gt;  &amp;#35; SlotManager assign the slot to allocationId2 and insert a slot request with allocationId1.&lt;br/&gt;
    &amp;gt;  &amp;#35; The second requestSlot call to task executor return SlotOccupiedException.&lt;br/&gt;
    &amp;gt;  &amp;#35; SlotManager update the slot to allocationID1, but the slot request is left.&lt;/p&gt;

&lt;p&gt;    pick from the assigned JIRA for further discuss&lt;/p&gt;</comment>
                            <comment id="16599495" author="githubbot" created="Sat, 1 Sep 2018 02:16:55 +0000"  >&lt;p&gt;TisonKun commented on issue #6360: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9884&quot; title=&quot;Slot request may not be removed when it has already be assigned in slot manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9884&quot;&gt;&lt;del&gt;FLINK-9884&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; fix slot request may not be removed when it has already be assigned in slot manager&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6360#issuecomment-417825840&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360#issuecomment-417825840&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @tillrohrmann &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16599496" author="githubbot" created="Sat, 1 Sep 2018 02:17:06 +0000"  >&lt;p&gt;TisonKun edited a comment on issue #6360: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9884&quot; title=&quot;Slot request may not be removed when it has already be assigned in slot manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9884&quot;&gt;&lt;del&gt;FLINK-9884&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; fix slot request may not be removed when it has already be assigned in slot manager&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6360#issuecomment-417825840&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360#issuecomment-417825840&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @tillrohrmann @GJL &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16619199" author="githubbot" created="Tue, 18 Sep 2018 14:34:38 +0000"  >&lt;p&gt;asfgit closed pull request #6360: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9884&quot; title=&quot;Slot request may not be removed when it has already be assigned in slot manager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9884&quot;&gt;&lt;del&gt;FLINK-9884&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; fix slot request may not be removed when it has already be assigned in slot manager&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6360&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManager.java b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManager.java&lt;br/&gt;
index d74979ae683..f207a36394a 100644&lt;br/&gt;
&amp;#8212; a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManager.java&lt;br/&gt;
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManager.java&lt;br/&gt;
@@ -592,6 +592,9 @@ private void updateSlotState(&lt;br/&gt;
 						// set the allocation id such that the slot won&apos;t be considered for the pending slot request&lt;br/&gt;
 						slot.updateAllocation(allocationId, jobId);&lt;/p&gt;

&lt;p&gt;+						// remove the pending request if any as it has been assigned&lt;br/&gt;
+						pendingSlotRequests.remove(allocationId);&lt;br/&gt;
+&lt;br/&gt;
 						// this will try to find a new slot for the request&lt;br/&gt;
 						rejectPendingSlotRequest(&lt;br/&gt;
 							pendingSlotRequest,&lt;br/&gt;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerTest.java&lt;br/&gt;
index fb82aa5026a..c954c878139 100644&lt;br/&gt;
&amp;#8212; a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerTest.java&lt;br/&gt;
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerTest.java&lt;br/&gt;
@@ -43,10 +43,12 @@&lt;br/&gt;
 import org.apache.flink.runtime.taskexecutor.TestingTaskExecutorGateway;&lt;br/&gt;
 import org.apache.flink.runtime.taskexecutor.TestingTaskExecutorGatewayBuilder;&lt;br/&gt;
 import org.apache.flink.runtime.taskexecutor.exceptions.SlotAllocationException;&lt;br/&gt;
+import org.apache.flink.runtime.taskexecutor.exceptions.SlotOccupiedException;&lt;br/&gt;
 import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
 import org.apache.flink.util.FlinkException;&lt;br/&gt;
 import org.apache.flink.util.TestLogger;&lt;/p&gt;

&lt;p&gt;+import akka.pattern.AskTimeoutException;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.mockito.ArgumentCaptor;&lt;/p&gt;

&lt;p&gt;@@ -1216,6 +1218,71 @@ public void testSlotRequestFailure() throws Exception {&lt;br/&gt;
 		}&lt;br/&gt;
 	}&lt;/p&gt;

&lt;p&gt;+	/**&lt;br/&gt;
+	 * Tests that pending request is removed if task executor reports a slot with its allocation id.&lt;br/&gt;
+	 */&lt;br/&gt;
+	@Test&lt;br/&gt;
+	public void testSlotRequestRemovedIfTMReportAllocation() throws Exception {&lt;br/&gt;
+		try (final SlotManager slotManager = createSlotManager(ResourceManagerId.generate(),&lt;br/&gt;
+				new TestingResourceActionsBuilder().createTestingResourceActions())) {&lt;br/&gt;
+&lt;br/&gt;
+			final JobID jobID = new JobID();&lt;br/&gt;
+			final SlotRequest slotRequest1 = new SlotRequest(jobID, new AllocationID(), ResourceProfile.UNKNOWN, &quot;foobar&quot;);&lt;br/&gt;
+			slotManager.registerSlotRequest(slotRequest1);&lt;br/&gt;
+&lt;br/&gt;
+			final BlockingQueue&amp;lt;Tuple5&amp;lt;SlotID, JobID, AllocationID, String, ResourceManagerId&amp;gt;&amp;gt; requestSlotQueue = new ArrayBlockingQueue&amp;lt;&amp;gt;(1);&lt;br/&gt;
+			final BlockingQueue&amp;lt;CompletableFuture&amp;lt;Acknowledge&amp;gt;&amp;gt; responseQueue = new ArrayBlockingQueue&amp;lt;&amp;gt;(1);&lt;br/&gt;
+&lt;br/&gt;
+			final TestingTaskExecutorGateway testingTaskExecutorGateway = new TestingTaskExecutorGatewayBuilder()&lt;br/&gt;
+					.setRequestSlotFunction(slotIDJobIDAllocationIDStringResourceManagerIdTuple5 -&amp;gt; {&lt;br/&gt;
+						requestSlotQueue.offer(slotIDJobIDAllocationIDStringResourceManagerIdTuple5);&lt;br/&gt;
+						try &lt;/p&gt;
{
+							return responseQueue.take();
+						}
&lt;p&gt; catch (InterruptedException ignored) &lt;/p&gt;
{
+							return FutureUtils.completedExceptionally(new FlinkException(&quot;Response queue was interrupted.&quot;));
+						}
&lt;p&gt;+					})&lt;br/&gt;
+					.createTestingTaskExecutorGateway();&lt;br/&gt;
+&lt;br/&gt;
+			final ResourceID taskExecutorResourceId = ResourceID.generate();&lt;br/&gt;
+			final TaskExecutorConnection taskExecutionConnection = new TaskExecutorConnection(taskExecutorResourceId, testingTaskExecutorGateway);&lt;br/&gt;
+			final SlotReport slotReport = new SlotReport(new SlotStatus(new SlotID(taskExecutorResourceId, 0), ResourceProfile.UNKNOWN));&lt;br/&gt;
+&lt;br/&gt;
+			final CompletableFuture&amp;lt;Acknowledge&amp;gt; firstManualSlotRequestResponse = new CompletableFuture&amp;lt;&amp;gt;();&lt;br/&gt;
+			responseQueue.offer(firstManualSlotRequestResponse);&lt;br/&gt;
+&lt;br/&gt;
+			slotManager.registerTaskManager(taskExecutionConnection, slotReport);&lt;br/&gt;
+&lt;br/&gt;
+			final Tuple5&amp;lt;SlotID, JobID, AllocationID, String, ResourceManagerId&amp;gt; firstRequest = requestSlotQueue.take();&lt;br/&gt;
+&lt;br/&gt;
+			final CompletableFuture&amp;lt;Acknowledge&amp;gt; secondManualSlotRequestResponse = new CompletableFuture&amp;lt;&amp;gt;();&lt;br/&gt;
+			responseQueue.offer(secondManualSlotRequestResponse);&lt;br/&gt;
+&lt;br/&gt;
+			final SlotRequest slotRequest2 = new SlotRequest(jobID, new AllocationID(), ResourceProfile.UNKNOWN, &quot;foobar&quot;);&lt;br/&gt;
+			slotManager.registerSlotRequest(slotRequest2);&lt;br/&gt;
+&lt;br/&gt;
+			// fail first request&lt;br/&gt;
+			firstManualSlotRequestResponse.completeExceptionally(new AskTimeoutException(&quot;Test exception to fail first allocation&quot;));&lt;br/&gt;
+&lt;br/&gt;
+			final Tuple5&amp;lt;SlotID, JobID, AllocationID, String, ResourceManagerId&amp;gt; secondRequest = requestSlotQueue.take();&lt;br/&gt;
+&lt;br/&gt;
+			// fail second request&lt;br/&gt;
+			secondManualSlotRequestResponse.completeExceptionally(new SlotOccupiedException(&quot;Test exception&quot;, slotRequest1.getAllocationId(), jobID));&lt;br/&gt;
+&lt;br/&gt;
+			assertThat(firstRequest.f2, equalTo(slotRequest1.getAllocationId()));&lt;br/&gt;
+			assertThat(secondRequest.f2, equalTo(slotRequest2.getAllocationId()));&lt;br/&gt;
+			assertThat(secondRequest.f0, equalTo(firstRequest.f0));&lt;br/&gt;
+&lt;br/&gt;
+			secondManualSlotRequestResponse.complete(Acknowledge.get());&lt;br/&gt;
+&lt;br/&gt;
+			final TaskManagerSlot slot = slotManager.getSlot(secondRequest.f0);&lt;br/&gt;
+			assertThat(slot.getState(), equalTo(TaskManagerSlot.State.ALLOCATED));&lt;br/&gt;
+			assertThat(slot.getAllocationId(), equalTo(firstRequest.f2));&lt;br/&gt;
+&lt;br/&gt;
+			assertEquals(1, slotManager.getNumberPendingSlotRequests());&lt;br/&gt;
+		}&lt;br/&gt;
+	}&lt;br/&gt;
+&lt;br/&gt;
 	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Tests notify the job manager of the allocations when the task manager is failed/killed.&lt;br/&gt;
 	 */&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16619200" author="till.rohrmann" created="Tue, 18 Sep 2018 14:34:57 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
1.7.0: 48e724fed60d10a11e3cc39e9c6e964002a926b3&lt;br/&gt;
1.6.2: 1e82a2807cd797f295ce1bc07b5fdb909fb4147e&lt;br/&gt;
1.5.5: 5f14dac2ee274b892b8a93541fd5a8ba054951d2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3w0fj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>