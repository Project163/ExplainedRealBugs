<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5666] Blob files are not cleaned up from ZK storage directory</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5666</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When running a job with HA in an standalone cluster, the blob files are not cleaned up from the ZooKeeper storage directory.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;:zkStorageDir/blob/cache/blob_:rand&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=NicoK&quot; class=&quot;user-hover&quot; rel=&quot;NicoK&quot;&gt;NicoK&lt;/a&gt; Have you seen such a behaviour while refactoring the blob server?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13038187">FLINK-5666</key>
            <summary>Blob files are not cleaned up from ZK storage directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="uce">Ufuk Celebi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2017 16:53:01 +0000</created>
                <updated>Fri, 27 Jan 2017 12:20:51 +0000</updated>
                            <resolved>Fri, 27 Jan 2017 09:46:32 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15840187" author="nicok" created="Thu, 26 Jan 2017 18:34:27 +0000"  >&lt;p&gt;hmm - do you see a warning like &quot;Failed to delete blob at...&quot;? This is what the FileSystemBlobStore should log in case an exception is thrown during the delete() call. However, it completely ignores the result from the fileSystem.delete() call!&lt;/p&gt;

&lt;p&gt;Both BlobRecoveryITCase and BlobLibraryCacheRecoveryITCase do test that the delete is actually deleting the files (although this verification is a bit displaced in each of them) but only work on the local filesystem (with HA mode set). I guess if the reference counting of the BlobLibraryCacheManager is not different in HA mode, than something may indeed be wrong in the BlobServer&apos;s use of the hdfs backend only&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="15840235" author="nicok" created="Thu, 26 Jan 2017 19:06:45 +0000"  >&lt;p&gt;Alternatively, the BlobLibraryCacheManager&apos;s cleanup task may simply not have run yet since the DEFAULT_LIBRARY_CACHE_MANAGER_CLEANUP_INTERVAL is 3600 seconds!&lt;/p&gt;</comment>
                            <comment id="15840283" author="githubbot" created="Thu, 26 Jan 2017 19:33:10 +0000"  >&lt;p&gt;GitHub user NicoK opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3222&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5666&quot; title=&quot;Blob files are not cleaned up from ZK storage directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5666&quot;&gt;&lt;del&gt;FLINK-5666&lt;/del&gt;&lt;/a&gt; add unit tests verifying that BlobServer#delete() deletes from HDFS&lt;/p&gt;

&lt;p&gt;    this does not fix &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5666&quot; title=&quot;Blob files are not cleaned up from ZK storage directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5666&quot;&gt;&lt;del&gt;FLINK-5666&lt;/del&gt;&lt;/a&gt; but adds some more unit tests verifying intended behaviour&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/NicoK/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/NicoK/flink&lt;/a&gt; flink-5666&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3222.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3222.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3222&lt;/p&gt;

&lt;hr /&gt;

&lt;hr /&gt;</comment>
                            <comment id="15842425" author="uce" created="Fri, 27 Jan 2017 09:11:59 +0000"  >&lt;p&gt;You are right, the library cache manager would have cleaned that up later. On regular shut down, it actually did clean it up, too.&lt;/p&gt;</comment>
                            <comment id="15842454" author="githubbot" created="Fri, 27 Jan 2017 09:42:49 +0000"  >&lt;p&gt;Github user uce commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3222&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Good additions, merging.&lt;/p&gt;</comment>
                            <comment id="15842456" author="uce" created="Fri, 27 Jan 2017 09:46:32 +0000"  >&lt;p&gt;Added tests in 24db045 (master), b1ab75f (release-1.2).&lt;/p&gt;</comment>
                            <comment id="15842667" author="githubbot" created="Fri, 27 Jan 2017 12:20:51 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3222&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3997r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>