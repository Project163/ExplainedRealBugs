<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:21:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2826] transformed is modified in BroadcastVariableMaterialization#decrementReferenceInternal without proper locking</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2826</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Here is related code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (references.isEmpty()) {
                                disposed = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                                data = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
                                transformed = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Elsewhere, transformed is modified with lock on BroadcastVariableMaterialization.this&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902847">FLINK-2826</key>
            <summary>transformed is modified in BroadcastVariableMaterialization#decrementReferenceInternal without proper locking</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Oct 2015 23:21:22 +0000</created>
                <updated>Wed, 11 Nov 2015 15:37:51 +0000</updated>
                            <resolved>Wed, 11 Nov 2015 15:37:43 +0000</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14967502" author="stephanewen" created="Wed, 21 Oct 2015 17:28:18 +0000"  >&lt;p&gt;True, this can lead to NullPointers in corner cases. How about:&lt;/p&gt;

&lt;p&gt;(1) Change the &lt;tt&gt;synchronized(this)&lt;/tt&gt; to &lt;tt&gt;synchronized(references)&lt;/tt&gt; ? This should cover it, if I see it correctly.&lt;br/&gt;
(2) Also the condition that waits for materialization should exit if the materialization fails and gets disposed, meaning the following should change: &lt;tt&gt;while (!this.materialized)&lt;/tt&gt; --&amp;gt; &lt;tt&gt;while (!this.materialized &amp;amp;&amp;amp; !disposed)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14978749" author="yuzhihong@gmail.com" created="Wed, 28 Oct 2015 16:57:44 +0000"  >&lt;p&gt;Can you clarify on point #1 please. We already have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; decrementReferenceInternal(BatchTask&amp;lt;?, ?&amp;gt; referenceHolder, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; errorIfNoReference) {
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (references) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14995676" author="stephanewen" created="Sun, 8 Nov 2015 15:32:13 +0000"  >&lt;p&gt;I was thinking that if the blocks that synchronize on &lt;tt&gt;this&lt;/tt&gt; would rather synchronize on &lt;tt&gt;references&lt;/tt&gt; as well, it would already solve the issue. What do you think?&lt;/p&gt;</comment>
                            <comment id="14995682" author="githubbot" created="Sun, 8 Nov 2015 15:43:29 +0000"  >&lt;p&gt;GitHub user tedyu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1339&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2826&quot; title=&quot;transformed is modified in BroadcastVariableMaterialization#decrementReferenceInternal without proper locking&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2826&quot;&gt;&lt;del&gt;FLINK-2826&lt;/del&gt;&lt;/a&gt; transformed is modified in BroadcastVariableMaterializatio&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;n#decrementReferenceInternal without proper locking&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tedyu/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tedyu/flink&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1339.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1339.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1339&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 76fa1f85a5b4dd7ca7b47290b45da7bd7835fbda&lt;br/&gt;
Author: tedyu &amp;lt;yuzhihong@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-11-08T15:43:03Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2826&quot; title=&quot;transformed is modified in BroadcastVariableMaterialization#decrementReferenceInternal without proper locking&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2826&quot;&gt;&lt;del&gt;FLINK-2826&lt;/del&gt;&lt;/a&gt; transformed is modified in BroadcastVariableMaterialization#decrementReferenceInternal without proper locking&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15000380" author="githubbot" created="Wed, 11 Nov 2015 13:45:55 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1339#issuecomment-155788263&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1339#issuecomment-155788263&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good. I hope we are not overlooking something (one never knows with these parallel synchronization cases), but it seems correct.&lt;/p&gt;

&lt;p&gt;    All tests passed, so will merge this...&lt;/p&gt;

&lt;p&gt;    Thanks you for the fix!&lt;/p&gt;</comment>
                            <comment id="15000528" author="githubbot" created="Wed, 11 Nov 2015 15:37:16 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1339&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15000529" author="stephanewen" created="Wed, 11 Nov 2015 15:37:43 +0000"  >&lt;p&gt;Fixed via 6019f085f0d3dadc20a11f900784ce2796a89ce0&lt;/p&gt;

&lt;p&gt;Thank you for the contribution!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mnxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>