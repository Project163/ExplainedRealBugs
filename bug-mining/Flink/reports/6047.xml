<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:07:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22113] UniqueKey constraint is lost with multiple sources join in SQL</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22113</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hi team,&lt;br/&gt;
 &#160;&lt;br/&gt;
 We have a use case to join multiple data sources to generate&#160;a continuous&#160;updated view. We defined primary key constraint on all the input sources and all the keys are the subsets in the join condition. All joins are left join.&lt;br/&gt;
 &#160;&lt;br/&gt;
 In our case, the first two inputs can produce&#160;&lt;b&gt;JoinKeyContainsUniqueKey&lt;/b&gt;&#160;input sepc, which is good and performant. While when it comes to the third input source, it&apos;s joined with the intermediate output table of the first two input tables, and the intermediate table does not carry key constraint information(although the thrid&#160;source input table does), so it results in a&#160;&lt;b&gt;NoUniqueKey&lt;/b&gt;&#160;input sepc. Given&#160;NoUniqueKey inputs has dramatic performance implications per the&lt;a href=&quot;http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Force-Join-Unique-Key-td39521.html#a39651&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&#160;Force Join Unique Key&lt;/a&gt;&#160;email thread, we want to know if there is any mitigation solution for this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;Take the example from &lt;a href=&quot;https://github.com/ververica/flink-sql-cookbook/blob/master/joins/05/05_star_schema.md&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ververica/flink-sql-cookbook/blob/master/joins/05/05_star_schema.md&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE TEMPORARY TABLE passengers (
  passenger_key STRING,
  first_name STRING,
  last_name STRING,
  update_time TIMESTAMP(3),
  PRIMARY KEY (passenger_key) NOT ENFORCED
) WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;upsert-kafka&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;passengers&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;key.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;raw&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;value.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;
);


CREATE TEMPORARY TABLE stations (
  station_key STRING,
  update_time TIMESTAMP(3),
  city STRING,
  PRIMARY KEY (station_key) NOT ENFORCED
) WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;upsert-kafka&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;stations&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;key.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;raw&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;value.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;
);

CREATE TEMPORARY TABLE booking_channels (
  booking_channel_key STRING,
  update_time TIMESTAMP(3),
  channel STRING,
  PRIMARY KEY (booking_channel_key) NOT ENFORCED
) WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;upsert-kafka&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;booking_channels&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;key.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;raw&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;value.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;
);

CREATE TEMPORARY TABLE train_activities (
  scheduled_departure_time TIMESTAMP(3),
  actual_departure_date TIMESTAMP(3),
  passenger_key STRING,
  origin_station_key STRING,
  destination_station_key STRING,
  booking_channel_key STRING,
  PRIMARY KEY (booking_channel_key, origin_station_key, destination_station_key) NOT ENFORCED
) WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;upsert-kafka&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;train_activities&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;key.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&apos;value.format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;
);

SELECT 
  t.actual_departure_date, 
  p.first_name,
  p.last_name,
  b.channel, 
  os.city AS origin_station,
  ds.city AS destination_station
FROM train_activities_1 t
LEFT JOIN booking_channels b 
ON t.booking_channel_key = b.booking_channel_key
LEFT JOIN passengers p
ON t.passenger_key = p.passenger_key
LEFT JOIN stations os
ON t.origin_station_key = os.station_key
LEFT JOIN stations ds
ON t.destination_station_key = ds.station_key

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;The query will generate exeuction plan of:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Flink SQL&amp;gt; explain
&amp;gt;  SELECT
&amp;gt;    t.actual_departure_date,
&amp;gt;    p.first_name,
&amp;gt;    p.last_name,
&amp;gt;    b.channel,
&amp;gt;    os.city AS origin_station,
&amp;gt;    ds.city AS destination_station
&amp;gt;  FROM train_activities_1 t
&amp;gt;  LEFT JOIN booking_channels b
&amp;gt;  ON t.booking_channel_key = b.booking_channel_key
&amp;gt;  LEFT JOIN passengers p
&amp;gt;  ON t.passenger_key = p.passenger_key
&amp;gt;  LEFT JOIN stations os
&amp;gt;  ON t.origin_station_key = os.station_key
&amp;gt;  LEFT JOIN stations ds
&amp;gt;  ON t.destination_station_key = ds.station_key;
== Abstract Syntax Tree ==
LogicalProject(actual_departure_date=[$1], first_name=[$10], last_name=[$11], channel=[$8], origin_station=[$15], destination_station=[$18])
+- LogicalJoin(condition=[=($4, $16)], joinType=[left])
   :- LogicalJoin(condition=[=($3, $13)], joinType=[left])
   :  :- LogicalJoin(condition=[=($2, $9)], joinType=[left])
   :  :  :- LogicalJoin(condition=[=($5, $6)], joinType=[left])
   :  :  :  :- LogicalTableScan(table=[[default_catalog, default_database, train_activities_1]])
   :  :  :  +- LogicalWatermarkAssigner(rowtime=[update_time], watermark=[-($1, 10000:INTERVAL SECOND)])
   :  :  :     +- LogicalTableScan(table=[[default_catalog, default_database, booking_channels]])
   :  :  +- LogicalTableScan(table=[[default_catalog, default_database, passengers]])
   :  +- LogicalTableScan(table=[[default_catalog, default_database, stations]])
   +- LogicalTableScan(table=[[default_catalog, default_database, stations]])



== Optimized Physical Plan ==
Calc(select=[actual_departure_date, first_name, last_name, channel, city AS origin_station, city0 AS destination_station])
+- Join(joinType=[LeftOuterJoin], where=[=(destination_station_key, station_key)], select=[actual_departure_date, destination_station_key, channel, first_name, last_name, city, station_key, city0], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :- Exchange(distribution=[hash[destination_station_key]])
   :  +- Calc(select=[actual_departure_date, destination_station_key, channel, first_name, last_name, city])
   :     +- Join(joinType=[LeftOuterJoin], where=[=(origin_station_key, station_key)], select=[actual_departure_date, origin_station_key, destination_station_key, channel, first_name, last_name, station_key, city], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :- Exchange(distribution=[hash[origin_station_key]])
   :        :  +- Calc(select=[actual_departure_date, origin_station_key, destination_station_key, channel, first_name, last_name])
   :        :     +- Join(joinType=[LeftOuterJoin], where=[=(passenger_key, passenger_key0)], select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, channel, passenger_key0, first_name, last_name], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :        :- Exchange(distribution=[hash[passenger_key]])
   :        :        :  +- Calc(select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, channel])
   :        :        :     +- Join(joinType=[LeftOuterJoin], where=[=(booking_channel_key, booking_channel_key0)], select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key, booking_channel_key0, channel], leftInputSpec=[HasUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :        :        :- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :        :  +- Calc(select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key])
   :        :        :        :     +- ChangelogNormalize(key=[booking_channel_key, origin_station_key, destination_station_key])
   :        :        :        :        +- Exchange(distribution=[hash[booking_channel_key, origin_station_key, destination_station_key]])
   :        :        :        :           +- TableSourceScan(table=[[default_catalog, default_database, train_activities_1]], fields=[scheduled_departure_time, actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key])
   :        :        :        +- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :           +- Calc(select=[booking_channel_key, channel])
   :        :        :              +- ChangelogNormalize(key=[booking_channel_key])
   :        :        :                 +- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :                    +- TableSourceScan(table=[[default_catalog, default_database, booking_channels, watermark=[-($1, 10000:INTERVAL SECOND)]]], fields=[booking_channel_key, update_time, channel])
   :        :        +- Exchange(distribution=[hash[passenger_key]])
   :        :           +- Calc(select=[passenger_key, first_name, last_name])
   :        :              +- ChangelogNormalize(key=[passenger_key])
   :        :                 +- Exchange(distribution=[hash[passenger_key]])
   :        :                    +- TableSourceScan(table=[[default_catalog, default_database, passengers]], fields=[passenger_key, first_name, last_name, update_time])
   :        +- Exchange(distribution=[hash[station_key]])
   :           +- Calc(select=[station_key, city])
   :              +- ChangelogNormalize(key=[station_key])
   :                 +- Exchange(distribution=[hash[station_key]])
   :                    +- TableSourceScan(table=[[default_catalog, default_database, stations]], fields=[station_key, update_time, city])
   +- Exchange(distribution=[hash[station_key]])
      +- Calc(select=[station_key, city])
         +- ChangelogNormalize(key=[station_key])
            +- Exchange(distribution=[hash[station_key]])
               +- TableSourceScan(table=[[default_catalog, default_database, stations]], fields=[station_key, update_time, city])== Optimized Execution Plan ==
Calc(select=[actual_departure_date, first_name, last_name, channel, city AS origin_station, city0 AS destination_station])
+- Join(joinType=[LeftOuterJoin], where=[(destination_station_key = station_key)], select=[actual_departure_date, destination_station_key, channel, first_name, last_name, city, station_key, city0], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :- Exchange(distribution=[hash[destination_station_key]])
   :  +- Calc(select=[actual_departure_date, destination_station_key, channel, first_name, last_name, city])
   :     +- Join(joinType=[LeftOuterJoin], where=[(origin_station_key = station_key)], select=[actual_departure_date, origin_station_key, destination_station_key, channel, first_name, last_name, station_key, city], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :- Exchange(distribution=[hash[origin_station_key]])
   :        :  +- Calc(select=[actual_departure_date, origin_station_key, destination_station_key, channel, first_name, last_name])
   :        :     +- Join(joinType=[LeftOuterJoin], where=[(passenger_key = passenger_key0)], select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, channel, passenger_key0, first_name, last_name], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :        :- Exchange(distribution=[hash[passenger_key]])
   :        :        :  +- Calc(select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, channel])
   :        :        :     +- Join(joinType=[LeftOuterJoin], where=[(booking_channel_key = booking_channel_key0)], select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key, booking_channel_key0, channel], leftInputSpec=[HasUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :        :        :- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :        :  +- Calc(select=[actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key])
   :        :        :        :     +- ChangelogNormalize(key=[booking_channel_key, origin_station_key, destination_station_key])
   :        :        :        :        +- Exchange(distribution=[hash[booking_channel_key, origin_station_key, destination_station_key]])
   :        :        :        :           +- TableSourceScan(table=[[default_catalog, default_database, train_activities_1]], fields=[scheduled_departure_time, actual_departure_date, passenger_key, origin_station_key, destination_station_key, booking_channel_key])
   :        :        :        +- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :           +- Calc(select=[booking_channel_key, channel])
   :        :        :              +- ChangelogNormalize(key=[booking_channel_key])
   :        :        :                 +- Exchange(distribution=[hash[booking_channel_key]])
   :        :        :                    +- TableSourceScan(table=[[default_catalog, default_database, booking_channels, watermark=[-($1, 10000:INTERVAL SECOND)]]], fields=[booking_channel_key, update_time, channel])
   :        :        +- Exchange(distribution=[hash[passenger_key]])
   :        :           +- Calc(select=[passenger_key, first_name, last_name])
   :        :              +- ChangelogNormalize(key=[passenger_key])
   :        :                 +- Exchange(distribution=[hash[passenger_key]])
   :        :                    +- TableSourceScan(table=[[default_catalog, default_database, passengers]], fields=[passenger_key, first_name, last_name, update_time])
   :        +- Exchange(distribution=[hash[station_key]])(reuse_id=[1])
   :           +- Calc(select=[station_key, city])
   :              +- ChangelogNormalize(key=[station_key])
   :                 +- Exchange(distribution=[hash[station_key]])
   :                    +- TableSourceScan(table=[[default_catalog, default_database, stations]], fields=[station_key, update_time, city])
   +- Reused(reference_id=[1])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13369712">FLINK-22113</key>
            <summary>UniqueKey constraint is lost with multiple sources join in SQL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="matriv">Marios Trivyzas</assignee>
                                    <reporter username="okowr">Fu Kai</reporter>
                        <labels>
                            <label>auto-unassigned</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 6 Apr 2021 07:36:46 +0000</created>
                <updated>Wed, 15 Dec 2021 01:44:15 +0000</updated>
                            <resolved>Wed, 8 Dec 2021 02:46:24 +0000</resolved>
                                    <version>1.13.0</version>
                                    <fixVersion>1.14.3</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>16</watches>
                                                                                                                <comments>
                            <comment id="17315938" author="zhihao" created="Wed, 7 Apr 2021 03:30:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160;Will it affect the correctness, or just performance? More specifically, in the internal state MapState&amp;lt;row, count&amp;gt; of the above join example, will the count always = 1, or will it increase gradually?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;1) input doesn&apos;t have a unique key =&amp;gt; MapState&amp;lt;row, count&amp;gt;,&#160;&lt;br/&gt;
 where&#160;the map key is the input row and the map value is the number of&#160;equal rows.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17316283" author="jark" created="Wed, 7 Apr 2021 12:23:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhihao&quot; class=&quot;user-hover&quot; rel=&quot;zhihao&quot;&gt;zhihao&lt;/a&gt;, it only affects performance. The count will always 1, because when receiving updates from upstream, the updates will send in two records, -U and +U. So the count will be changed to 0 and then 1 after the update. &lt;/p&gt;

&lt;p&gt;Regarding the issue problem, I think the root cause may be there is some bug in &lt;tt&gt;FlinkRelMdUniqueKeys#getJoinUniqueKeys&lt;/tt&gt; which results in we can&apos;t infer correct unique key for the join. &lt;/p&gt;

&lt;p&gt;I think there is no good workaround for now, but you may can try to add a Deduplication &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; partition by the unqiue key after the join. Note the Deduplication node has additional cost, so in general the performance may still not good. &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-master/docs/dev/table/sql/queries/#deduplication&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.apache.org/projects/flink/flink-docs-master/docs/dev/table/sql/queries/#deduplication&lt;/a&gt;&lt;/p&gt;


&lt;p&gt; for this &lt;/p&gt;</comment>
                            <comment id="17316306" author="okowr" created="Wed, 7 Apr 2021 12:49:06 +0000"  >&lt;p&gt;Hi Jark,&#160;&lt;/p&gt;

&lt;p&gt;Thank you for the valuable information &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;. My follow up question is that, althougth the count is 1, it will still load the entire partition of the rocksdb and do seek operation to find the corresponding record for the join, and that&apos;s the reason why it affects the performance while not the correctness. Is it correct?&lt;/p&gt;</comment>
                            <comment id="17316891" author="jark" created="Thu, 8 Apr 2021 06:32:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=okowr&quot; class=&quot;user-hover&quot; rel=&quot;okowr&quot;&gt;okowr&lt;/a&gt;, Yes. &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;tt&gt;JoinKeyContainsUniqueKey&lt;/tt&gt; uses &lt;tt&gt;ValueState#value&lt;/tt&gt; to get joined records which is a RocksDB get operation.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;HasUniqueKey&lt;/tt&gt; uses &lt;tt&gt;MapState#get(uniqueKey)&lt;/tt&gt; to get joined records which is also a RocksDB get operation.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;NoUniqueKey&lt;/tt&gt; uses &lt;tt&gt;MapState#entries()&lt;/tt&gt; to get joined records which is a RocksDB seek operation and is very heavy.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17316929" author="okowr" created="Thu, 8 Apr 2021 07:45:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;, thank you for the rely, it seems it&apos;s a sever performance bug for multiple join use cases. Do we have any plan for the fix?&lt;/p&gt;</comment>
                            <comment id="17316936" author="jark" created="Thu, 8 Apr 2021 07:54:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=okowr&quot; class=&quot;user-hover&quot; rel=&quot;okowr&quot;&gt;okowr&lt;/a&gt;, I think we can fix this in the next version, but also welcome if anyone want to contribute a fix. &lt;/p&gt;</comment>
                            <comment id="17320742" author="xuguangheng" created="Wed, 14 Apr 2021 06:40:26 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; for the previous discussion.&lt;/p&gt;

&lt;p&gt;As you mentioned in the discussion that the select statement may contribute to this issue, and we did some experiments as follow:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TEMPORARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; passengers (
  passenger_key &lt;span class=&quot;code-keyword&quot;&gt;STRING&lt;/span&gt;,
  &lt;span class=&quot;code-keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;KEY&lt;/span&gt; (passenger_key) &lt;span class=&quot;code-keyword&quot;&gt;NOT&lt;/span&gt; ENFORCED
) &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;&apos;&lt;/span&gt;
)

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TEMPORARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; booking_channels (
  booking_channel_key &lt;span class=&quot;code-keyword&quot;&gt;STRING&lt;/span&gt;,
  &lt;span class=&quot;code-keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;KEY&lt;/span&gt; (booking_channel_key) &lt;span class=&quot;code-keyword&quot;&gt;NOT&lt;/span&gt; ENFORCED
) &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;&apos;&lt;/span&gt;
)

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TEMPORARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; train_activities (
  passenger_key &lt;span class=&quot;code-keyword&quot;&gt;STRING&lt;/span&gt;,
  booking_channel_key &lt;span class=&quot;code-keyword&quot;&gt;STRING&lt;/span&gt;,
  &lt;span class=&quot;code-keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;KEY&lt;/span&gt; (booking_channel_key) &lt;span class=&quot;code-keyword&quot;&gt;NOT&lt;/span&gt; ENFORCED
) &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;&apos;&lt;/span&gt;
)

&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; t.booking_channel_key &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; booking_channel_key, t.passenger_key &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; passenger_key, b.booking_channel_key &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; booking_channel_key_0
&lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; train_activities t
&lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; booking_channels b
&lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; t.booking_channel_key = b.booking_channel_key
&lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; passengers p
&lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; t.passenger_key = p.passenger_key

== Optimized Physical &lt;span class=&quot;code-keyword&quot;&gt;Plan&lt;/span&gt; ==
Calc(&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[booking_channel_key, passenger_key, booking_channel_key0 &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; booking_channel_key_0])
+- &lt;span class=&quot;code-keyword&quot;&gt;Join&lt;/span&gt;(joinType=[LeftOuterJoin], &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt;=[=(passenger_key, passenger_key0)], &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[passenger_key, booking_channel_key, booking_channel_key0, passenger_key0], leftInputSpec=[HasUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :- Exchange(distribution=[hash[passenger_key]])
   :  +- &lt;span class=&quot;code-keyword&quot;&gt;Join&lt;/span&gt;(joinType=[LeftOuterJoin], &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt;=[=(booking_channel_key, booking_channel_key0)], &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[passenger_key, booking_channel_key, booking_channel_key0], leftInputSpec=[JoinKeyContainsUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :     :- Exchange(distribution=[hash[booking_channel_key]])
   :     :  +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, train_activities]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[passenger_key, booking_channel_key])
   :     +- Exchange(distribution=[hash[booking_channel_key]])
   :        +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, booking_channels]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[booking_channel_key])
   +- Exchange(distribution=[hash[passenger_key]])
      +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, passengers]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[passenger_key])

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;VS&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; t.booking_channel_key &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; booking_channel_key, t.passenger_key &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; passenger_key
&lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; train_activities t
&lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; booking_channels b
&lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; t.booking_channel_key = b.booking_channel_key
&lt;span class=&quot;code-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;JOIN&lt;/span&gt; passengers p
&lt;span class=&quot;code-keyword&quot;&gt;on&lt;/span&gt; t.passenger_key = p.passenger_key


== Optimized Physical &lt;span class=&quot;code-keyword&quot;&gt;Plan&lt;/span&gt; ==
Calc(&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[booking_channel_key, passenger_key])
+- &lt;span class=&quot;code-keyword&quot;&gt;Join&lt;/span&gt;(joinType=[LeftOuterJoin], &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt;=[=(passenger_key, passenger_key0)], &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[passenger_key, booking_channel_key, passenger_key0], leftInputSpec=[NoUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :- Exchange(distribution=[hash[passenger_key]])
   :  +- Calc(&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[passenger_key, booking_channel_key])
   :     +- &lt;span class=&quot;code-keyword&quot;&gt;Join&lt;/span&gt;(joinType=[LeftOuterJoin], &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt;=[=(booking_channel_key, booking_channel_key0)], &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt;=[passenger_key, booking_channel_key, booking_channel_key0], leftInputSpec=[JoinKeyContainsUniqueKey], rightInputSpec=[JoinKeyContainsUniqueKey])
   :        :- Exchange(distribution=[hash[booking_channel_key]])
   :        :  +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, train_activities]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[passenger_key, booking_channel_key])
   :        +- Exchange(distribution=[hash[booking_channel_key]])
   :           +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, booking_channels]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[booking_channel_key])
   +- Exchange(distribution=[hash[passenger_key]])
      +- TableSourceScan(&lt;span class=&quot;code-keyword&quot;&gt;table&lt;/span&gt;=[[default_catalog, default_database, passengers]], &lt;span class=&quot;code-keyword&quot;&gt;fields&lt;/span&gt;=[passenger_key])

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;&lt;em&gt;The only difference is that we select booking_channel_key from both left and right table in the first case and only booking_channel_key from left table in the second case. The result is one has uniqueKey and the other doesn&apos;t.&lt;/em&gt;&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
 I think &lt;b&gt;&lt;em&gt;t.booking_channel_key, t.passenger_key&lt;/em&gt;&lt;/b&gt; can be the unique key of the first join output, but it seems we lost this unique information. After diving deep into the join logic, I found there is something wrong while it was parsing the uniqueKey of the first join output.&lt;/p&gt;


&lt;p&gt; Specifically, in the FlinkRelMdUniqueKeys, there is a function&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; def getJoinUniqueKeys(
      joinInfo: JoinInfo,
      joinRelType: JoinRelType,
      leftType: RelDataType,
      leftUniqueKeys: JSet[ImmutableBitSet],
      rightUniqueKeys: JSet[ImmutableBitSet],
      isLeftUnique: JBoolean,
      isRightUnique: JBoolean,
      mq: RelMetadataQuery): JSet[ImmutableBitSet]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While it was getting the uniqueKey of the first join output, &lt;em&gt;&lt;b&gt;isLeftUnique&lt;/b&gt;&lt;/em&gt; and &lt;em&gt;&lt;b&gt;isRightUnique&lt;/b&gt;&lt;/em&gt; is null, which seems to be a bug. Besides I saw there was a &lt;b&gt;&lt;em&gt;TODO&lt;/em&gt;&lt;/b&gt; in FlinkRelMdColumnUniqueness while calling &lt;b&gt;&lt;em&gt;areTableColumnsUnique&lt;/em&gt;&lt;/b&gt; for a TableScan. This bug seems to be resolved by implementing the &lt;b&gt;&lt;em&gt;areTableColumnsUnique&lt;/em&gt;&lt;/b&gt; method for TableScan.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; Do you think it is a reasonable solution for this issue?&lt;/p&gt;

&lt;p&gt;I can contribute my code changes if needed.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17320871" author="jark" created="Wed, 14 Apr 2021 10:04:06 +0000"  >&lt;p&gt;From this use case, it seems this is a bug because the &lt;tt&gt;booking_channel_key&lt;/tt&gt; column from right table should be able to represent unique key of left side. &lt;/p&gt;

&lt;p&gt;But I&apos;m not sure where is the bug. Maybe need further investigation. &lt;tt&gt;FlinkRelMdColumnUniqueness&lt;/tt&gt; has implemented &lt;tt&gt;areColumnsUnique&lt;/tt&gt; for &lt;tt&gt;TableScan&lt;/tt&gt; node. &lt;/p&gt;</comment>
                            <comment id="17321868" author="xuguangheng" created="Thu, 15 Apr 2021 03:00:05 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks for you reply.&#160;&lt;/p&gt;

&lt;p&gt;Yes,&#160;&lt;tt&gt;FlinkRelMdColumnUniqueness&lt;/tt&gt; has implemented&#160;&lt;tt&gt;areColumnsUnique&lt;/tt&gt; for TableScan node, but there is a &lt;tt&gt;TODO&lt;/tt&gt; inside the implementation. It seems the implementation is not complete.&lt;/p&gt;

&lt;p&gt;Can you assign the issue to me, I can try to fix it.&lt;/p&gt;</comment>
                            <comment id="17341696" author="xuguangheng" created="Mon, 10 May 2021 06:22:52 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;The PR was submitted half month ago,  can you please help to review it?&lt;/p&gt;</comment>
                            <comment id="17341743" author="jark" created="Mon, 10 May 2021 07:31:45 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17350657" author="flink-jira-bot" created="Mon, 24 May 2021 22:50:03 +0000"  >&lt;p&gt;I am the &lt;a href=&quot;https://github.com/apache/flink-jira-bot/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Flink Jira Bot&lt;/a&gt; and I help the community manage its development. I see this issue is assigned but has not received an update in 14, so it has been labeled &quot;stale-assigned&quot;.&lt;br/&gt;
If you are still working on the issue, please remove the label and add a comment updating the community on your progress.  If this issue is waiting on feedback, please consider this a reminder to the committer/reviewer. Flink is a very active project, and so we appreciate your patience.&lt;br/&gt;
If you are no longer working on the issue, please unassign yourself so someone else may work on it. If the &quot;warning_label&quot; label is not removed in 7 days, the issue will be automatically unassigned.&lt;/p&gt;</comment>
                            <comment id="17355002" author="xuguangheng" created="Tue, 1 Jun 2021 10:49:29 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;This issue has been labeled as stale-assigned.&lt;br/&gt;
Can anyone help to review the PR&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;?&lt;/p&gt;</comment>
                            <comment id="17363935" author="flink-jira-bot" created="Tue, 15 Jun 2021 22:39:38 +0000"  >&lt;p&gt;I am the &lt;a href=&quot;https://github.com/apache/flink-jira-bot/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Flink Jira Bot&lt;/a&gt; and I help the community manage its development. I see this issue is assigned but has not received an update in 14, so it has been labeled &quot;stale-assigned&quot;.&lt;br/&gt;
If you are still working on the issue, please remove the label and add a comment updating the community on your progress.  If this issue is waiting on feedback, please consider this a reminder to the committer/reviewer. Flink is a very active project, and so we appreciate your patience.&lt;br/&gt;
If you are no longer working on the issue, please unassign yourself so someone else may work on it. If the &quot;warning_label&quot; label is not removed in 7 days, the issue will be automatically unassigned.&lt;/p&gt;</comment>
                            <comment id="17368488" author="flink-jira-bot" created="Wed, 23 Jun 2021 22:38:13 +0000"  >&lt;p&gt;This issue was marked &quot;stale-assigned&quot; 7 days ago and has not received an update. I have automatically removed the current assignee from the issue so others in the community may pick it up. If you are still working on this ticket, please ask a committer to reassign you and provide an update about your current status.&lt;/p&gt;</comment>
                            <comment id="17403633" author="zhihao" created="Tue, 24 Aug 2021 08:19:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;fhueske@gmail.com&quot;&gt;fhueske@gmail.com&lt;/a&gt; &#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This RP is opened for 3 months and nobody reviews it. Please let us know what&apos;s missing and we can add on.&lt;/p&gt;

&lt;p&gt;BTW, we also don&apos;t know what&apos;s the right channel to get PMC reviewers to review our PR, any suggestions?&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;Zhihao&lt;/p&gt;</comment>
                            <comment id="17406764" author="twalthr" created="Mon, 30 Aug 2021 14:49:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhihao&quot; class=&quot;user-hover&quot; rel=&quot;zhihao&quot;&gt;zhihao&lt;/a&gt; I can help reviewing it shortly. We are resolving a couple of primary key issues right now. Did you see &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-23915&quot; title=&quot;Propagate unique keys for temporary tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-23915&quot;&gt;&lt;del&gt;FLINK-23915&lt;/del&gt;&lt;/a&gt;? Your example in the JIRA description uses TEMPORARY TABLE which could have caused issues as well. But this is an orthogonal issue, right?&lt;/p&gt;</comment>
                            <comment id="17407777" author="zhihao" created="Wed, 1 Sep 2021 02:53:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&#160;Thanks for your time to review it. Yes, it&apos;s a general issue unrelated to TEMPORARY keyword.&lt;/p&gt;</comment>
                            <comment id="17454936" author="godfreyhe" created="Wed, 8 Dec 2021 02:46:24 +0000"  >&lt;p&gt;Fixed in&lt;br/&gt;
1.15.0: ac957ae07a49ab88ad46a14c6ea0d4891d5437d7&lt;br/&gt;
1.14.1: 0ec99243b8a5b0e41fa70d97c93476e338adc738&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0pk08:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>