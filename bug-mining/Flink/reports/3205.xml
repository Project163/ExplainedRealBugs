<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:40:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-13663] SQL Client end-to-end test for modern Kafka failed on Travis</title>
                <link>https://issues.apache.org/jira/browse/FLINK-13663</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The &lt;tt&gt;SQL Client end-to-end test for modern Kafka&lt;/tt&gt; failed on Travis because it could not download &lt;tt&gt;&lt;a href=&quot;https://archive.apache.org/dist/kafka/0.11.0.2/kafka_2.11-0.11.0.2.tgz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://archive.apache.org/dist/kafka/0.11.0.2/kafka_2.11-0.11.0.2.tgz&lt;/a&gt;&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Maybe we could add a similar retry logic as with the Kinesis end-to-end test &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13599&quot; title=&quot;Kinesis end-to-end test failed on Travis&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13599&quot;&gt;&lt;del&gt;FLINK-13599&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://api.travis-ci.org/v3/job/569262834/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://api.travis-ci.org/v3/job/569262834/log.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://api.travis-ci.org/v3/job/569262828/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://api.travis-ci.org/v3/job/569262828/log.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13249834">FLINK-13663</key>
            <summary>SQL Client end-to-end test for modern Kafka failed on Travis</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="1u0">Alex</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 9 Aug 2019 07:11:46 +0000</created>
                <updated>Wed, 16 Sep 2020 02:42:55 +0000</updated>
                            <resolved>Wed, 14 Aug 2019 10:10:56 +0000</resolved>
                                    <version>1.9.0</version>
                    <version>1.10.0</version>
                                    <fixVersion>1.9.1</fixVersion>
                    <fixVersion>1.10.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                    <component>Table SQL / Client</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16905110" author="azagrebin" created="Mon, 12 Aug 2019 11:53:11 +0000"  >&lt;p&gt;From what I see in the test code (bash function setup_kafka_dist in kafka_common.sh), we already have a hotfix introduced by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=1u0&quot; class=&quot;user-hover&quot; rel=&quot;1u0&quot;&gt;1u0&lt;/a&gt; which hardens the test by increasing the timeout of the failing curl download. The hotfix&#160;adds curl options which activate&#160;an embedded retry algorithm of curl command (5 retries with 1 sec init back-off time then doubling, total retry time is up to 1 min).&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
KAFKA_URL=&lt;span class=&quot;code-quote&quot;&gt;&quot;https:&lt;span class=&quot;code-comment&quot;&gt;//archive.apache.org/dist/kafka/$KAFKA_VERSION/kafka_2.11-$KAFKA_VERSION.tgz&quot;&lt;/span&gt;
&lt;/span&gt;echo &lt;span class=&quot;code-quote&quot;&gt;&quot;Downloading Kafka from $KAFKA_URL&quot;&lt;/span&gt;
curl &lt;span class=&quot;code-quote&quot;&gt;&quot;$KAFKA_URL&quot;&lt;/span&gt; --retry 5 --retry-max-time 60 &amp;gt; $TEST_DATA_DIR/kafka.tgz&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
--retry-max-time &amp;lt;seconds&amp;gt;
 The retry timer is reset before the first transfer attempt. Retries will be done as usual (see --retry) as &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; as the timer hasn&apos;t reached &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; given limit. Notice that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;
 the timer hasn&lt;span class=&quot;code-quote&quot;&gt;&apos;t reached the limit, the request will be made and &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; performing, it may take longer than &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; given time period. To limit a single request&apos;&lt;/span&gt;s maximum time,
 use -m, --max-time. Set &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; option to zero to not timeout retries.

------------------------------------------------------------------------------------------------------------
--retry &amp;lt;num&amp;gt;
 If a &lt;span class=&quot;code-keyword&quot;&gt;transient&lt;/span&gt; error is returned when curl tries to perform a transfer, it will retry &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; number of times before giving up. Setting the number to 0 makes curl &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; no retries
 (which is the &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;). Transient error means either: a timeout, an FTP 4xx response code or an HTTP 5xx response code.
When curl is about to retry a transfer, it will first wait one second and then &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all forthcoming retries it will &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; the waiting time until it reaches 10 minutes which
 then will be the delay between the &lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt; of the retries. By using --retry-delay you disable &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; exponential backoff algorithm. See also --retry-max-time to limit the total
 time allowed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; retries.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We could either further increase the total curl timeout from 1 min to e.g. 5 or 10 or try the same approach with our custom retry logic proposed in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13599&quot; title=&quot;Kinesis end-to-end test failed on Travis&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13599&quot;&gt;&lt;del&gt;FLINK-13599&lt;/del&gt;&lt;/a&gt;&#160;but I would not expect that our retry will be much better than the embedded curl retry mechanism.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16905441" author="1u0" created="Mon, 12 Aug 2019 18:02:01 +0000"  >&lt;p&gt;FYI, the &lt;tt&gt;curl&lt;/tt&gt; retries were added as an attempt to address the issue described in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-12773&quot; title=&quot;Unstable kafka e2e test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-12773&quot;&gt;&lt;del&gt;FLINK-12773&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
We can try to increase number of retries/retry timeout, but it&apos;s possible that this won&apos;t help much.&lt;/p&gt;

&lt;p&gt;Instead (or in parallel), my proposal would be to try to cache and share the downloaded Kafka distribution among multiple e2e test runs.&lt;br/&gt;
There is a PR by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; (&lt;a href=&quot;https://github.com/apache/flink/pull/7605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7605&lt;/a&gt;) which conceptually does it. Personally, I find the PR as relatively big and it&apos;s possible to implement the caching logic as some script with low effort.&lt;/p&gt;</comment>
                            <comment id="16905758" author="ykt836" created="Tue, 13 Aug 2019 02:51:13 +0000"  >&lt;p&gt;+1 to find a way to cache downloaded distributions. Not only for multiple e2e runs, but also for local verifying. I found it&apos;s impossible to run e2e tests locally in China sine the download is very slow and unstable.&#160;&lt;/p&gt;</comment>
                            <comment id="16905793" author="jark" created="Tue, 13 Aug 2019 04:02:51 +0000"  >&lt;p&gt;+1 to cache distributions. Even to share the distribution across build jobs if possible. &lt;/p&gt;</comment>
                            <comment id="16906040" author="till.rohrmann" created="Tue, 13 Aug 2019 10:12:39 +0000"  >&lt;p&gt;Another issue: &lt;a href=&quot;https://api.travis-ci.org/v3/job/570757852/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://api.travis-ci.org/v3/job/570757852/log.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=1u0&quot; class=&quot;user-hover&quot; rel=&quot;1u0&quot;&gt;1u0&lt;/a&gt; could you try to increase the timeout/retries of the curl command and see whether the tests stabilize? If this does not work, then I would be in favour of a fix for the download problem (e.g. a simple cache) because I don&apos;t believe that we replace these tests any time soon with a different testing framework.&lt;/p&gt;</comment>
                            <comment id="16907127" author="till.rohrmann" created="Wed, 14 Aug 2019 10:10:56 +0000"  >&lt;p&gt;We increased the curl retries and the timeout. If this should not fix the problem permanently, then we need to look into caching of dependencies.&lt;/p&gt;

&lt;p&gt;1.10.0: a3157710fe8267f689ae9a6f4f2338b97ae2d8c0&lt;br/&gt;
1.9.1: f4af5a8171507b33d4ad19d698db8b21e1090205&lt;/p&gt;</comment>
                            <comment id="16907766" author="jark" created="Thu, 15 Aug 2019 02:24:36 +0000"  >&lt;p&gt;I think the idea proposed by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=1u0&quot; class=&quot;user-hover&quot; rel=&quot;1u0&quot;&gt;1u0&lt;/a&gt; to cache external distributions is very nice. It will help to reduce a lot of e2e testing time. And it would be very helpful for Chinese developers to verify e2e locally, because it&apos;s very unstable and almost impossible to download them in China.&lt;/p&gt;

&lt;p&gt;So I created a JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13730&quot; title=&quot;Cache and share the downloaded external distribution (e.g. Kafka) in E2E tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13730&quot;&gt;&lt;del&gt;FLINK-13730&lt;/del&gt;&lt;/a&gt; to track the work. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=1u0&quot; class=&quot;user-hover&quot; rel=&quot;1u0&quot;&gt;1u0&lt;/a&gt; would you like to continue the work? &lt;/p&gt;</comment>
                            <comment id="17196632" author="dian.fu" created="Wed, 16 Sep 2020 02:42:55 +0000"  >&lt;p&gt;Another instance on master: &lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=6520&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=6520&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13250166">FLINK-13686</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13248781">FLINK-13567</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13249073">FLINK-13599</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05hww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>