<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:46:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-16383] KafkaProducerExactlyOnceITCase.testExactlyOnceRegularSink fails with &quot;The producer has already been closed&quot;</title>
                <link>https://issues.apache.org/jira/browse/FLINK-16383</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Logs: &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=5779&amp;amp;view=logs&amp;amp;j=a54de925-e958-5e24-790a-3a6150eb72d8&amp;amp;t=24e561e9-4c8d-598d-a290-e6acce191345&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=5779&amp;amp;view=logs&amp;amp;j=a54de925-e958-5e24-790a-3a6150eb72d8&amp;amp;t=24e561e9-4c8d-598d-a290-e6acce191345&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-03-01T01:06:57.4738418Z 01:06:57,473 [Source: Custom Source -&amp;gt; Map -&amp;gt; Sink: Unnamed (1/1)] INFO  org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaInternalProducer [] - Flushing &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; partitions
2020-03-01T01:06:57.4739960Z 01:06:57,473 [FailingIdentityMapper Status Printer] INFO  org.apache.flink.streaming.connectors.kafka.testutils.FailingIdentityMapper [] - ============================&amp;gt; Failing mapper  0: count=680, totalCount=1000
2020-03-01T01:06:57.4909074Z org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
2020-03-01T01:06:57.4910001Z 	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:147)
2020-03-01T01:06:57.4911000Z 	at org.apache.flink.runtime.minicluster.MiniCluster.executeJobBlocking(MiniCluster.java:648)
2020-03-01T01:06:57.4912078Z 	at org.apache.flink.streaming.util.TestStreamEnvironment.execute(TestStreamEnvironment.java:77)
2020-03-01T01:06:57.4913039Z 	at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1619)
2020-03-01T01:06:57.4914421Z 	at org.apache.flink.test.util.TestUtils.tryExecute(TestUtils.java:35)
2020-03-01T01:06:57.4915423Z 	at org.apache.flink.streaming.connectors.kafka.KafkaProducerTestBase.testExactlyOnce(KafkaProducerTestBase.java:370)
2020-03-01T01:06:57.4916483Z 	at org.apache.flink.streaming.connectors.kafka.KafkaProducerTestBase.testExactlyOnceRegularSink(KafkaProducerTestBase.java:309)
2020-03-01T01:06:57.4917305Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
2020-03-01T01:06:57.4917982Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
2020-03-01T01:06:57.4918769Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-03-01T01:06:57.4919477Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-03-01T01:06:57.4920156Z 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
2020-03-01T01:06:57.4920995Z 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
2020-03-01T01:06:57.4921927Z 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
2020-03-01T01:06:57.4922728Z 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
2020-03-01T01:06:57.4923428Z 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
2020-03-01T01:06:57.4924048Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-03-01T01:06:57.4924779Z 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
2020-03-01T01:06:57.4925528Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
2020-03-01T01:06:57.4926318Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
2020-03-01T01:06:57.4927214Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2020-03-01T01:06:57.4927872Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2020-03-01T01:06:57.4928587Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2020-03-01T01:06:57.4929289Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2020-03-01T01:06:57.4929943Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2020-03-01T01:06:57.4930672Z 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
2020-03-01T01:06:57.4931512Z 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
2020-03-01T01:06:57.4932255Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-03-01T01:06:57.4932962Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-03-01T01:06:57.4933741Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-03-01T01:06:57.4934344Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2020-03-01T01:06:57.4935193Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
2020-03-01T01:06:57.4936245Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
2020-03-01T01:06:57.4937113Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
2020-03-01T01:06:57.4937925Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
2020-03-01T01:06:57.4938763Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
2020-03-01T01:06:57.4939656Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
2020-03-01T01:06:57.4940451Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
2020-03-01T01:06:57.4941302Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-03-01T01:06:57.4942240Z Caused by: org.apache.flink.runtime.JobException: Recovery is suppressed by FixedDelayRestartBackoffTimeStrategy(maxNumberRestartAttempts=1, backoffTimeMS=0)
2020-03-01T01:06:57.4943374Z 	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:110)
2020-03-01T01:06:57.4944802Z 	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:76)
2020-03-01T01:06:57.4945836Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:190)
2020-03-01T01:06:57.4946730Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:184)
2020-03-01T01:06:57.4947705Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:178)
2020-03-01T01:06:57.4948647Z 	at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:505)
2020-03-01T01:06:57.4949500Z 	at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:383)
2020-03-01T01:06:57.4950225Z 	at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)
2020-03-01T01:06:57.4950917Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-03-01T01:06:57.4951721Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-03-01T01:06:57.4952412Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:279)
2020-03-01T01:06:57.4953238Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:194)
2020-03-01T01:06:57.4954080Z 	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74)
2020-03-01T01:06:57.4955045Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)
2020-03-01T01:06:57.4955760Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2020-03-01T01:06:57.4956435Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2020-03-01T01:06:57.4957091Z 	at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2020-03-01T01:06:57.4957800Z 	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2020-03-01T01:06:57.4958491Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2020-03-01T01:06:57.4959183Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-03-01T01:06:57.4959872Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-03-01T01:06:57.4960521Z 	at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2020-03-01T01:06:57.4961227Z 	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2020-03-01T01:06:57.4961875Z 	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2020-03-01T01:06:57.4962453Z 	at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2020-03-01T01:06:57.4963028Z 	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2020-03-01T01:06:57.4963601Z 	at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2020-03-01T01:06:57.4964151Z 	at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2020-03-01T01:06:57.4965046Z 	at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2020-03-01T01:06:57.4965802Z 	at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2020-03-01T01:06:57.4966510Z 	at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2020-03-01T01:06:57.4967258Z 	at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2020-03-01T01:06:57.4967954Z Caused by: java.lang.RuntimeException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; confirming checkpoint
2020-03-01T01:06:57.4968749Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:899)
2020-03-01T01:06:57.4969694Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$notifyCheckpointCompleteAsync$7(StreamTask.java:873)
2020-03-01T01:06:57.4970599Z 	at org.apache.flink.util.function.FunctionUtils.lambda$asCallable$5(FunctionUtils.java:125)
2020-03-01T01:06:57.4971407Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2020-03-01T01:06:57.4972310Z 	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.run(StreamTaskActionExecutor.java:85)
2020-03-01T01:06:57.4973437Z 	at org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:78)
2020-03-01T01:06:57.4974275Z 	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxExecutorImpl.tryYield(MailboxExecutorImpl.java:79)
2020-03-01T01:06:57.4975421Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.quiesceTimeServiceAndCloseOperator(StreamOperatorWrapper.java:138)
2020-03-01T01:06:57.4976419Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:113)
2020-03-01T01:06:57.4977340Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
2020-03-01T01:06:57.4978239Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
2020-03-01T01:06:57.4979154Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:78)
2020-03-01T01:06:57.4980051Z 	at org.apache.flink.streaming.runtime.tasks.OperatorChain.closeOperators(OperatorChain.java:305)
2020-03-01T01:06:57.4980894Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.afterInvoke(StreamTask.java:503)
2020-03-01T01:06:57.4981770Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:482)
2020-03-01T01:06:57.4982490Z 	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:717)
2020-03-01T01:06:57.4983157Z 	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:541)
2020-03-01T01:06:57.4983716Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
2020-03-01T01:06:57.4984462Z Caused by: org.apache.flink.util.FlinkRuntimeException: Committing one of transactions failed, logging first encountered failure
2020-03-01T01:06:57.4985606Z 	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:302)
2020-03-01T01:06:57.4986723Z 	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.notifyCheckpointComplete(AbstractUdfStreamOperator.java:130)
2020-03-01T01:06:57.4987718Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$notifyCheckpointComplete$8(StreamTask.java:884)
2020-03-01T01:06:57.4988771Z 	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:99)
2020-03-01T01:06:57.4989793Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:879)
2020-03-01T01:06:57.4990396Z 	... 17 more
2020-03-01T01:06:57.4990886Z Caused by: java.lang.IllegalStateException: The producer has already been closed
2020-03-01T01:06:57.4991892Z 	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaInternalProducer.ensureNotClosed(FlinkKafkaInternalProducer.java:251)
2020-03-01T01:06:57.4993008Z 	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaInternalProducer.commitTransaction(FlinkKafkaInternalProducer.java:102)
2020-03-01T01:06:57.4994228Z 	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer.commit(FlinkKafkaProducer.java:905)
2020-03-01T01:06:57.4995310Z 	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer.commit(FlinkKafkaProducer.java:97)
2020-03-01T01:06:57.4996317Z 	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:289)
2020-03-01T01:06:57.4997044Z 	... 21 more
2020-03-01T01:06:57.4998645Z 01:06:57,493 [                main] ERROR org.apache.flink.streaming.connectors.kafka.KafkaProducerExactlyOnceITCase [] - 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13288867">FLINK-16383</key>
            <summary>KafkaProducerExactlyOnceITCase.testExactlyOnceRegularSink fails with &quot;The producer has already been closed&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arvid">Arvid Heise</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 2 Mar 2020 12:51:49 +0000</created>
                <updated>Tue, 22 Jun 2021 14:04:53 +0000</updated>
                            <resolved>Tue, 19 May 2020 13:12:22 +0000</resolved>
                                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Runtime / Task</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="17106055" author="rmetzger" created="Wed, 13 May 2020 07:33:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1107&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1107&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
============================&amp;gt; Failing mapper  0: count=670, totalCount=1000
2020-05-12T17:24:45.4532543Z org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
2020-05-12T17:24:45.4533923Z 	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:147)
2020-05-12T17:24:45.4534660Z 	at org.apache.flink.runtime.minicluster.MiniCluster.executeJobBlocking(MiniCluster.java:659)
2020-05-12T17:24:45.4535393Z 	at org.apache.flink.streaming.util.TestStreamEnvironment.execute(TestStreamEnvironment.java:81)
2020-05-12T17:24:45.4536371Z 	at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1645)
2020-05-12T17:24:45.4537095Z 	at org.apache.flink.test.util.TestUtils.tryExecute(TestUtils.java:35)
2020-05-12T17:24:45.4537837Z 	at org.apache.flink.streaming.connectors.kafka.KafkaProducerTestBase.testExactlyOnce(KafkaProducerTestBase.java:370)
2020-05-12T17:24:45.4538810Z 	at org.apache.flink.streaming.connectors.kafka.KafkaProducerTestBase.testExactlyOnceRegularSink(KafkaProducerTestBase.java:309)
2020-05-12T17:24:45.4539495Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
2020-05-12T17:24:45.4540093Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
2020-05-12T17:24:45.4540767Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-05-12T17:24:45.4541377Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-05-12T17:24:45.4541975Z 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
2020-05-12T17:24:45.4542656Z 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
2020-05-12T17:24:45.4543349Z 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
2020-05-12T17:24:45.4544046Z 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
2020-05-12T17:24:45.4544680Z 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
2020-05-12T17:24:45.4545226Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-05-12T17:24:45.4545755Z 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
2020-05-12T17:24:45.4546924Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
2020-05-12T17:24:45.4547584Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
2020-05-12T17:24:45.4650351Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2020-05-12T17:24:45.4651057Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2020-05-12T17:24:45.4651841Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2020-05-12T17:24:45.4652538Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2020-05-12T17:24:45.4653134Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2020-05-12T17:24:45.4653777Z 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
2020-05-12T17:24:45.4654422Z 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
2020-05-12T17:24:45.4655070Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-05-12T17:24:45.4655761Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-05-12T17:24:45.4656441Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-05-12T17:24:45.4656984Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2020-05-12T17:24:45.4657578Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
2020-05-12T17:24:45.4658283Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
2020-05-12T17:24:45.4659069Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
2020-05-12T17:24:45.4659771Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
2020-05-12T17:24:45.4660506Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
2020-05-12T17:24:45.4661243Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
2020-05-12T17:24:45.4661944Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
2020-05-12T17:24:45.4662673Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-05-12T17:24:45.4663504Z Caused by: org.apache.flink.runtime.JobException: Recovery is suppressed by FixedDelayRestartBackoffTimeStrategy(maxNumberRestartAttempts=1, backoffTimeMS=0)
2020-05-12T17:24:45.4664441Z 	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:112)
2020-05-12T17:24:45.4665366Z 	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:78)
2020-05-12T17:24:45.4666326Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:189)
2020-05-12T17:24:45.4774925Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:183)
2020-05-12T17:24:45.4775890Z 	at org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:177)
2020-05-12T17:24:45.4776894Z 	at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:497)
2020-05-12T17:24:45.4777646Z 	at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:384)
2020-05-12T17:24:45.4778235Z 	at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)
2020-05-12T17:24:45.4778929Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-05-12T17:24:45.4779539Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-05-12T17:24:45.4780136Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:284)
2020-05-12T17:24:45.4780858Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:199)
2020-05-12T17:24:45.4781576Z 	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74)
2020-05-12T17:24:45.4782654Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)
2020-05-12T17:24:45.4783271Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2020-05-12T17:24:45.4783852Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2020-05-12T17:24:45.4784437Z 	at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2020-05-12T17:24:45.4785012Z 	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2020-05-12T17:24:45.4785680Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2020-05-12T17:24:45.4786387Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-05-12T17:24:45.4786977Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-05-12T17:24:45.4787548Z 	at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2020-05-12T17:24:45.4788080Z 	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2020-05-12T17:24:45.4788650Z 	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2020-05-12T17:24:45.4789267Z 	at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2020-05-12T17:24:45.4789776Z 	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2020-05-12T17:24:45.4790279Z 	at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2020-05-12T17:24:45.4790740Z 	at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2020-05-12T17:24:45.4791274Z 	at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2020-05-12T17:24:45.4791885Z 	at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2020-05-12T17:24:45.4792529Z 	at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2020-05-12T17:24:45.4793256Z 	at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2020-05-12T17:24:45.4793872Z Caused by: java.lang.RuntimeException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; confirming checkpoint
2020-05-12T17:24:45.4794537Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:922)
2020-05-12T17:24:45.4795330Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$notifyCheckpointCompleteAsync$7(StreamTask.java:909)
2020-05-12T17:24:45.4796204Z 	at org.apache.flink.util.function.FunctionUtils.lambda$asCallable$5(FunctionUtils.java:125)
2020-05-12T17:24:45.4796838Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2020-05-12T17:24:45.4797612Z 	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.runThrowing(StreamTaskActionExecutor.java:92)
2020-05-12T17:24:45.4798444Z 	at org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:78)
2020-05-12T17:24:45.4799194Z 	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxExecutorImpl.tryYield(MailboxExecutorImpl.java:79)
2020-05-12T17:24:45.4800080Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.quiesceTimeServiceAndCloseOperator(StreamOperatorWrapper.java:138)
2020-05-12T17:24:45.4800947Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:113)
2020-05-12T17:24:45.4801708Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
2020-05-12T17:24:45.4805156Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
2020-05-12T17:24:45.4805950Z 	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:78)
2020-05-12T17:24:45.4808012Z 	at org.apache.flink.streaming.runtime.tasks.OperatorChain.closeOperators(OperatorChain.java:300)
2020-05-12T17:24:45.4808843Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.afterInvoke(StreamTask.java:553)
2020-05-12T17:24:45.4811037Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:532)
2020-05-12T17:24:45.4811688Z 	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:713)
2020-05-12T17:24:45.4812246Z 	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:539)
2020-05-12T17:24:45.4814313Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
2020-05-12T17:24:45.4814934Z Caused by: org.apache.flink.util.FlinkRuntimeException: Committing one of transactions failed, logging first encountered failure
2020-05-12T17:24:45.4817040Z 	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:302)
2020-05-12T17:24:45.4818015Z 	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.notifyCheckpointComplete(AbstractUdfStreamOperator.java:130)
2020-05-12T17:24:45.4821678Z 	at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.notifyCheckpointComplete(SubtaskCheckpointCoordinatorImpl.java:177)
2020-05-12T17:24:45.4824078Z 	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:915)
2020-05-12T17:24:45.4824715Z 	... 17 more
2020-05-12T17:24:45.4825180Z Caused by: java.lang.IllegalStateException: The producer has already been closed
2020-05-12T17:24:45.4826172Z 	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaInternalProducer.ensureNotClosed(FlinkKafkaInternalProducer.java:251)
2020-05-12T17:24:45.4827195Z 	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaInternalProducer.commitTransaction(FlinkKafkaInternalProducer.java:102)
2020-05-12T17:24:45.4828137Z 	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer.commit(FlinkKafkaProducer.java:910)
2020-05-12T17:24:45.4829014Z 	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer.commit(FlinkKafkaProducer.java:98)
2020-05-12T17:24:45.4829960Z 	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:289)
2020-05-12T17:24:45.4830622Z 	... 20 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17106235" author="rmetzger" created="Wed, 13 May 2020 12:03:04 +0000"  >&lt;p&gt;Another case: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1128&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1128&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106239" author="rmetzger" created="Wed, 13 May 2020 12:05:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1129&amp;amp;view=logs&amp;amp;j=16ccbdb7-2a3e-53da-36eb-fb718edc424a&amp;amp;t=cf61ce33-6fba-5fbe-2c0c-e41c4013e891&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1129&amp;amp;view=logs&amp;amp;j=16ccbdb7-2a3e-53da-36eb-fb718edc424a&amp;amp;t=cf61ce33-6fba-5fbe-2c0c-e41c4013e891&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106248" author="rmetzger" created="Wed, 13 May 2020 12:12:51 +0000"  >&lt;p&gt;Same error, but &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[ERROR] Failures: 
[ERROR]   Kafka011ProducerExactlyOnceITCase&amp;gt;KafkaProducerTestBase.testExactlyOnceRegularSink:309-&amp;gt;KafkaProducerTestBase.testExactlyOnce:370 Test failed: Job execution failed.
[INFO] 

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1133&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1133&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106251" author="rmetzger" created="Wed, 13 May 2020 12:15:08 +0000"  >&lt;p&gt;Upgrading blocker: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1165&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1165&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106527" author="rmetzger" created="Wed, 13 May 2020 17:56:44 +0000"  >&lt;p&gt;The increased error rate might indicate that this is caused by another change: &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7996&amp;amp;view=logs&amp;amp;j=5a8a90c3-b1a0-5409-0a40-5284e4660a64&amp;amp;t=7e1e4eb1-b500-57c1-6458-c7270cc1134e&amp;amp;l=18968&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7996&amp;amp;view=logs&amp;amp;j=5a8a90c3-b1a0-5409-0a40-5284e4660a64&amp;amp;t=7e1e4eb1-b500-57c1-6458-c7270cc1134e&amp;amp;l=18968&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106801" author="zjwang" created="Thu, 14 May 2020 02:24:14 +0000"  >&lt;p&gt;Another instance&#160;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1174&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1174&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17106806" author="jark" created="Thu, 14 May 2020 02:28:38 +0000"  >&lt;p&gt;Another similar instance, &lt;tt&gt;KafkaProducerExactlyOnceITCase.testMultipleSinkOperators&lt;/tt&gt; is failed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1192&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1192&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17107207" author="pnowojski" created="Thu, 14 May 2020 11:10:33 +0000"  >&lt;p&gt;I&apos;m starting to suspect that maybe something here &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-17307&quot; title=&quot;Add collector to DeserializationSchema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-17307&quot;&gt;&lt;del&gt;FLINK-17307&lt;/del&gt;&lt;/a&gt; broke the test stability. This issue started to pop up constantly the same day that &lt;a href=&quot;https://github.com/apache/flink/pull/12018&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; was merged and it&apos;s I think the only one that was touching Kafka.&lt;/p&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17107219" author="aljoscha" created="Thu, 14 May 2020 11:26:23 +0000"  >&lt;p&gt;I started looking into this and trying to reproduce locally, no dice so far.&lt;/p&gt;</comment>
                            <comment id="17107225" author="aljoscha" created="Thu, 14 May 2020 11:39:14 +0000"  >&lt;p&gt;I doubt it&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-17307&quot; title=&quot;Add collector to DeserializationSchema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-17307&quot;&gt;&lt;del&gt;FLINK-17307&lt;/del&gt;&lt;/a&gt; because &lt;tt&gt;KafkaProducerExactlyOnceITCase. testExactlyOnceRegularSink&lt;/tt&gt; does not involve a KafkaConsumer, and those changes only touch the consumer side.&lt;/p&gt;</comment>
                            <comment id="17107287" author="rmetzger" created="Thu, 14 May 2020 13:25:56 +0000"  >&lt;p&gt;Another case: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1222&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1222&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17107337" author="aljoscha" created="Thu, 14 May 2020 14:13:05 +0000"  >&lt;p&gt;I added a potential fix on master in 2f0c4d4ec3241679465c792c4bb5c2ef0e4a150e.&lt;/p&gt;

&lt;p&gt;Also added debugging logging in 9d44834199488612fa7c7c8f9b9c641d9785fb95, so if this occurs again, please re-open the issue and post the log.&lt;/p&gt;</comment>
                            <comment id="17107475" author="rmetzger" created="Thu, 14 May 2020 17:03:52 +0000"  >&lt;p&gt;Reopening ... &lt;tt&gt;The producer 1502537416 has already been closed&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1312&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1312&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17108016" author="rmetzger" created="Fri, 15 May 2020 07:30:14 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.flink.util.FlinkRuntimeException: Committing one of transactions failed, logging first encountered failure
	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:302)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.notifyCheckpointComplete(AbstractUdfStreamOperator.java:130)
	at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.notifyCheckpointComplete(SubtaskCheckpointCoordinatorImpl.java:177)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:923)
	... 17 more
Caused by: java.lang.IllegalStateException: The producer 1100101099 has already been closed
	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.ensureNotClosed(FlinkKafkaProducer.java:302)
	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.commitTransaction(FlinkKafkaProducer.java:149)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.commit(FlinkKafkaProducer011.java:740)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.commit(FlinkKafkaProducer011.java:96)
	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:289)
	... 20 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1352&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1352&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17108049" author="rmetzger" created="Fri, 15 May 2020 07:54:13 +0000"  >&lt;p&gt;More cases from my daily check of the CI builds from last night:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1352&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1352&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1345&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1345&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1343&amp;amp;view=logs&amp;amp;j=e9af9cde-9a65-5281-a58e-2c8511d36983&amp;amp;t=603cb7fd-6f38-5c99-efca-877e1439232f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1343&amp;amp;view=logs&amp;amp;j=e9af9cde-9a65-5281-a58e-2c8511d36983&amp;amp;t=603cb7fd-6f38-5c99-efca-877e1439232f&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1343&amp;amp;view=logs&amp;amp;j=ce8f3cc3-c1ea-5281-f5eb-df9ebd24947f&amp;amp;t=d4549d78-6fab-5c0c-bdb9-abaafb66ea8b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1343&amp;amp;view=logs&amp;amp;j=ce8f3cc3-c1ea-5281-f5eb-df9ebd24947f&amp;amp;t=d4549d78-6fab-5c0c-bdb9-abaafb66ea8b&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1312&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1312&amp;amp;view=logs&amp;amp;j=c5f0071e-1851-543e-9a45-9ac140befc32&amp;amp;t=684b1416-4c17-504e-d5ab-97ee44e08a20&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1304&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1304&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17108084" author="aljoscha" created="Fri, 15 May 2020 08:37:40 +0000"  >&lt;p&gt;This is an extract of the relevant log entries&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
03:04:24,078 [Source: Custom Source -&amp;gt; Map -&amp;gt; Sink: Unnamed (1/1)] DEBUG org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer [] - Closed internal KafkaProducer 1100101099. Stacktrace: java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.getStackTrace(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:1559)
org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.close(FlinkKafkaProducer.java:201)
org.apache.flink.util.IOUtils.closeQuietly(IOUtils.java:263)
org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.lambda$close$1(FlinkKafkaProducer011.java:692)
java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
java.util.Iterator.forEachRemaining(Iterator.java:116)
java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.close(FlinkKafkaProducer011.java:692)
org.apache.flink.api.common.functions.util.FunctionUtils.closeFunction(FunctionUtils.java:43)
org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.close(AbstractUdfStreamOperator.java:109)
org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.runThrowing(StreamTaskActionExecutor.java:92)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.closeOperator(StreamOperatorWrapper.java:186)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.lambda$deferCloseOperatorToMailbox$3(StreamOperatorWrapper.java:160)
org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.runThrowing(StreamTaskActionExecutor.java:92)
org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:78)
org.apache.flink.streaming.runtime.tasks.mailbox.MailboxExecutorImpl.tryYield(MailboxExecutorImpl.java:79)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.quiesceTimeServiceAndCloseOperator(StreamOperatorWrapper.java:138)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:113)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:78)
org.apache.flink.streaming.runtime.tasks.OperatorChain.closeOperators(OperatorChain.java:300)
org.apache.flink.streaming.runtime.tasks.StreamTask.afterInvoke(StreamTask.java:561)
org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:533)
org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:713)
org.apache.flink.runtime.taskmanager.Task.run(Task.java:539)


Caused by: java.lang.RuntimeException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; confirming checkpoint
	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:930)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$notifyCheckpointCompleteAsync$7(StreamTask.java:917)
	at org.apache.flink.util.function.FunctionUtils.lambda$asCallable$5(FunctionUtils.java:125)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.runThrowing(StreamTaskActionExecutor.java:92)
	at org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:78)
	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxExecutorImpl.tryYield(MailboxExecutorImpl.java:79)
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.quiesceTimeServiceAndCloseOperator(StreamOperatorWrapper.java:138)
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:113)
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:117)
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:78)
	at org.apache.flink.streaming.runtime.tasks.OperatorChain.closeOperators(OperatorChain.java:300)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.afterInvoke(StreamTask.java:561)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:533)
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:713)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:539)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
Caused by: org.apache.flink.util.FlinkRuntimeException: Committing one of transactions failed, logging first encountered failure
	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:302)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.notifyCheckpointComplete(AbstractUdfStreamOperator.java:130)
	at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.notifyCheckpointComplete(SubtaskCheckpointCoordinatorImpl.java:177)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.notifyCheckpointComplete(StreamTask.java:923)
	... 17 more
Caused by: java.lang.IllegalStateException: The producer 1100101099 has already been closed
	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.ensureNotClosed(FlinkKafkaProducer.java:302)
	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.commitTransaction(FlinkKafkaProducer.java:149)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.commit(FlinkKafkaProducer011.java:740)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.commit(FlinkKafkaProducer011.java:96)
	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.notifyCheckpointComplete(TwoPhaseCommitSinkFunction.java:289)
	... 20 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17108116" author="rmetzger" created="Fri, 15 May 2020 09:13:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1372&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1372&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17108135" author="becket_qin" created="Fri, 15 May 2020 09:44:52 +0000"  >&lt;p&gt;I think the problem is following:&lt;br/&gt;
The shutdown sequence in &lt;tt&gt;StreamOperatorWrapper&lt;/tt&gt;&#160;is that # The mailbox quiesceProcessingTImeService&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;after the future of step 1 is done, the mailbox sends a mail to close the operators.&lt;/li&gt;
	&lt;li&gt;after the future of step 2 is done, the mailbox sends a closeMail to complete the shutdown sequence.&lt;/li&gt;
	&lt;li&gt;after the closeMail is processed. The shutdown sequence is completed&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The problems is that between step 2 and step 3, a checkpoint complete notification was enqueued to the mailbox.&#160;So the mailbox has not shutdown yet, but the operator has been closed.&lt;/p&gt;</comment>
                            <comment id="17108344" author="jark" created="Fri, 15 May 2020 14:34:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/98463496-1af2-4620-8eab-a2ecc1a2e6fe/_apis/build/builds/1406/logs/75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/98463496-1af2-4620-8eab-a2ecc1a2e6fe/_apis/build/builds/1406/logs/75&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17108387" author="klion26" created="Fri, 15 May 2020 15:11:13 +0000"  >&lt;p&gt;seems another instance &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1230&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&amp;amp;l=18475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1230&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&amp;amp;l=18475&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-05-14T04:20:36.9953507Z 04:20:36,993 [Source: Custom Source -&amp;gt; Sink: Unnamed (3/3)] WARN org.apache.flink.streaming.connectors.kafka.internal.Kafka010Fetcher [] - Committing offsets to Kafka takes longer than the checkpoint interval. Skipping commit of previous offsets because newer complete checkpoint offsets are available. This does not compromise Flink&apos;s checkpoint integrity. 2020-05-14T04:20:37.2142509Z 04:20:37,174 [program runner thread] ERROR org.apache.flink.streaming.connectors.kafka.KafkaTestBase [] - Job Runner failed with exception 2020-05-14T04:20:37.2143266Z org.apache.flink.client.program.ProgramInvocationException: Job failed (JobID: cdf00a9c3a8b9c3afb72f57e7ef936c8) 2020-05-14T04:20:37.2144122Z at org.apache.flink.client.ClientUtils.submitJobAndWaitForResult(ClientUtils.java:115) ~[flink-clients_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT] 2020-05-14T04:20:37.2145249Z at org.apache.flink.streaming.connectors.kafka.KafkaConsumerTestBase.lambda$runCancelingOnEmptyInputTest$2(KafkaConsumerTestBase.java:1075) ~[flink-connector-kafka-base_2.11-1.11-SNAPSHOT-tests.jar:?] 2020-05-14T04:20:37.2145858Z at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) [?:1.8.0_242] 2020-05-14T04:20:37.2146393Z Caused by: org.apache.flink.runtime.client.JobCancellationException: Job was cancelled. 2020-05-14T04:20:37.2151756Z at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:149) ~[flink-runtime_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT] 2020-05-14T04:20:37.2153457Z at org.apache.flink.client.ClientUtils.submitJobAndWaitForResult(ClientUtils.java:113) ~[flink-clients_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT] 2020-05-14T04:20:37.2154166Z ... 2 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17109368" author="rmetzger" created="Sun, 17 May 2020 07:15:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1506&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=1506&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=34f486e1-e1e4-5dd2-9c06-bfdd9b9c74a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17110089" author="becket_qin" created="Mon, 18 May 2020 09:41:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=AHeise&quot; class=&quot;user-hover&quot; rel=&quot;AHeise&quot;&gt;AHeise&lt;/a&gt; It seems the bug fix in&#160;&lt;a href=&quot;https://github.com/apache/flink/pull/12186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/12186&lt;/a&gt;&#160;was incomplete. We need to make sure all the methods called on the wrapped &lt;tt&gt;StreamOperator&lt;/tt&gt;&#160;are going through the &lt;tt&gt;StreamOperatorWrapper&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;In this case, the test failure was because `notifyCheckpointComplete()` was invoked directly on the wrapper operator instead of the wrapper. See:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/blob/20c28ac77ecd6b8d11e38ed84c9a5c36317721f3/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java#L178&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/20c28ac77ecd6b8d11e38ed84c9a5c36317721f3/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java#L178&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17110983" author="wanglijie95" created="Tue, 19 May 2020 09:01:29 +0000"  >&lt;p&gt;I meet the same problem.&#160;&lt;a href=&quot;https://dev.azure.com/apache-flink/98463496-1af2-4620-8eab-a2ecc1a2e6fe/_apis/build/builds/970/logs/74&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/98463496-1af2-4620-8eab-a2ecc1a2e6fe/_apis/build/builds/970/logs/74&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17111160" author="pnowojski" created="Tue, 19 May 2020 13:12:22 +0000"  >&lt;p&gt;Fixed on master as cbd9ca0ca3 on release-1.11 as 14f0bcef06&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13300959">FLINK-17378</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13370079">FLINK-22142</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0c2jc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>