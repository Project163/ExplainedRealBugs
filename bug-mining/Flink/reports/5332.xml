<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:56:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22133] SplitEmumerator does not provide checkpoint id in snapshot</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22133</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In ExternallyInducedSource API, the checkpoint trigger exposes the checkpoint Id for the external client to identify the checkpoint. However, in the FLIP-27 source, the&#160;SplitEmumerator::snapshot() is a no-arg method. The connector cannot track the checkpoint ID from Flink&lt;/p&gt;</description>
                <environment></environment>
        <key id="13369996">FLINK-22133</key>
            <summary>SplitEmumerator does not provide checkpoint id in snapshot</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="Brian Zhou">Brian Zhou</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 7 Apr 2021 08:29:51 +0000</created>
                <updated>Sat, 28 Aug 2021 11:16:42 +0000</updated>
                            <resolved>Tue, 20 Apr 2021 16:18:21 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.13.0</fixVersion>
                                    <component>Connectors / Common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17324985" author="stephanewen" created="Mon, 19 Apr 2021 12:20:58 +0000"  >&lt;p&gt;Originally, we were thinking to keep checkpoint IDs out of the &lt;tt&gt;SplitEnumerator&lt;/tt&gt; completely, keeping it simple.&lt;/p&gt;

&lt;p&gt;We somehow partially went away from this with adding the &lt;tt&gt;CheckpointListener&lt;/tt&gt; interface, which gets checkpointIDs for completed checkpoints. In that, I guess it makes sense to add them also to the &lt;tt&gt;SplitEnumerator.snapshotState()&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jqin&quot; class=&quot;user-hover&quot; rel=&quot;jqin&quot;&gt;jqin&lt;/a&gt; what do you think?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maguowei&quot; class=&quot;user-hover&quot; rel=&quot;maguowei&quot;&gt;maguowei&lt;/a&gt; This is a very simple change, but API breaking, so the sooner we do it the better. Do you think we should put this as a fix into the 1.13 release?&lt;/p&gt;

&lt;p&gt;Alternatively, I can create a non-breaking version this way:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For 1.12.x and 1.13.x, we add a new default method &lt;tt&gt;snapshotState(long checkpointId)&lt;/tt&gt; which calls the method &lt;tt&gt;snapshotState()&lt;/tt&gt;. The default method is the one that the system calls. So everything keeps working as currently, but users can override the default method (although they still have to override the other method as well with an empty body, to make the code compile).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For 1.14, we remove the &lt;tt&gt;snapshotState()&lt;/tt&gt; method and make the &lt;tt&gt;snapshotState(long checkpointId)&lt;/tt&gt; a non-default method.&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="17325008" author="dawidwys" created="Mon, 19 Apr 2021 12:44:48 +0000"  >&lt;p&gt;Given the limited scope of the change and that there is still not much adoption in external connectors (imo) I&apos;d be fine with performing the final change in 1.13 already. &lt;/p&gt;

&lt;p&gt;I think the two options do not differ much in a relation to the feature freeze. They both include the same dangers that the checkpointId is not passed correctly. So the real question is just if we want to break the API in a single release or give users one extra release.  Again given the limited scope I&apos;d do it already in 1.13.&lt;/p&gt;</comment>
                            <comment id="17325009" author="dawidwys" created="Mon, 19 Apr 2021 12:45:09 +0000"  >&lt;p&gt;btw here is a link to the ML discussion thread: &lt;a href=&quot;https://lists.apache.org/thread.html/r0743a2e27c5fd3654a769d4c2b77a0f68b2a5f1ef2f89b2504c088d8%40%3Cdev.flink.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/r0743a2e27c5fd3654a769d4c2b77a0f68b2a5f1ef2f89b2504c088d8%40%3Cdev.flink.apache.org%3E&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17325936" author="stephanewen" created="Tue, 20 Apr 2021 16:16:06 +0000"  >&lt;p&gt;Fixed in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.13.0 via fdcf730ce106cfe0050593a3ddc068a8b7222e94&lt;/li&gt;
	&lt;li&gt;1.14.0 (master) via c4678d874b32cd996da49c39ea33b3420b77e17c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17325937" author="stephanewen" created="Tue, 20 Apr 2021 16:16:23 +0000"  >&lt;p&gt;Re-opening for release notes.&lt;/p&gt;</comment>
                            <comment id="17338487" author="thw" created="Mon, 3 May 2021 16:58:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jqin&quot; class=&quot;user-hover&quot; rel=&quot;jqin&quot;&gt;jqin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt;&#160;what do you think about back porting this change to 1.12? It would allow users/downstream projects to build on top of the FLIP-27 interfaces without facing breakage when going from 1.12 to 1.13.&lt;/p&gt;

&lt;p&gt;The source API is experimental in 1.12 and we already made incompatible changes to it in 1.12.x releases?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17340493" author="becket_qin" created="Fri, 7 May 2021 00:54:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thw&quot; class=&quot;user-hover&quot; rel=&quot;thw&quot;&gt;thw&lt;/a&gt; I think we only plan to backport some backwards incompatible changes to the Kafka source in 1.12.x, which is otherwise not usable. We did not introduce backwards incompatible changes to the general Source API in 1.12.x.&lt;/p&gt;

&lt;p&gt;I am wondering if this patch is generally useful enough to justify the backport.&#160; So far it seems the checkpoint ID is only used by Pravega at this point.&#160;I know some users have already developed a few sources on top of release 1.12. Backporting this change would break them immediately when they upgrade to 1.12.4. On the other hand, given that SplitEnumerator API is PublicEvolving, users would probably be OK with this minor API change when they upgrade from 1.12 to 1.13+.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="17340514" author="thw" created="Fri, 7 May 2021 02:06:48 +0000"  >&lt;p&gt;It&apos;s a compromise.&#160;The assumption was that there isn&apos;t enough adoption to warrant the backward compatible option:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22133?focusedCommentId=17325008&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17325008&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-22133?focusedCommentId=17325008&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17325008&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For those that are building on top of 1.12.x incurring the breakage with 1.12.4 is probably cheaper than when upgrading to 1.13. If, for example, the Iceberg project provides a source developed on top of Flink 1.12.x, then the same source won&apos;t work on 1.13.x.&lt;/p&gt;</comment>
                            <comment id="17340604" author="becket_qin" created="Fri, 7 May 2021 06:37:17 +0000"  >&lt;p&gt;Thanks for the explanation, Thomas. So here are the pros and cons of backporting if I understand correctly:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Pros: those who develop sources on top of 1.12.4 would not experience API change.&lt;/li&gt;
	&lt;li&gt;Cons: We break the version contract. Some other users who have already implemented the source may get a surprise when upgrade to 1.12.4. (These users will still need to pick the new API if they go to 1.13+. It is just that such API changes in 1.13+ do not break our API contract with the users.)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;May I first confirm if &quot;PublicEvolving&quot; APIs are allowed to change between minor versions? If it is allowed, then I think backporting totally makes sense. Otherwise, personally I feel keeping the contract seems more beneficial because we don&apos;t really know who is going to develop on top of 1.12.4 yet but there are users already implemented the Source in 1.12.3-. So breaking the contract potentially brings benefit to someone but will surely introduce surprise to the others.&lt;/p&gt;

&lt;p&gt;If we do want to backport the feature to unblock some users who really need the checkpoint ID, would it be better to do what Stephan suggrested for 1.12?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;... we add a new default method&#160;&lt;tt&gt;snapshotState(long checkpointId)&lt;/tt&gt;&#160;which calls the method&#160;&lt;tt&gt;snapshotState()&lt;/tt&gt;. The default method is the one that the system calls. So everything keeps working as currently, but users can override the default method (although they still have to override the other method as well with an empty body, to make the code compile).&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17342063" author="thw" created="Mon, 10 May 2021 18:20:03 +0000"  >&lt;p&gt;Hi Becket, I think the suggestion from Stephan would be the best approach. It doesn&apos;t break existing users and at the same time allows to build customizations in a 1.13 compatible manner.&lt;/p&gt;

&lt;p&gt;PublicEvolving should not be modified in binary incompatible way between patch releases and the japicmp check guards that. So if we were to make the same change as in 1.13, we would require an exclusion. But I think we better stick with the compatibility guarantee.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0plrc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>The unified source API for connectors has a minor breaking change: The {{SplitEnumerator.snapshotState()}} method was adjusted to accept the Checkpoint ID of the checkpoint for which the snapshot is created.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>