<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:39:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-12219] Yarn application can&apos;t stop when flink job failed in per-job yarn cluster mode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-12219</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Issuedetailinfo&quot;&gt;&lt;/a&gt;&lt;b&gt;Issue detail info&lt;/b&gt;&lt;/h3&gt;

&lt;p&gt;In our flink(1.6.3) product env, I often encounter a scene that yarn application can&apos;t stop when flink job failed in per-job yarn cluste mode, so I deeply analyzed the reason why it happened.&lt;/p&gt;

&lt;p&gt;When a flink job fail, system will write an archive file to a FileSystem through &lt;ins&gt;MiniDispatcher#archiveExecutionGraph&lt;/ins&gt; method, then notify YarnJobClusterEntrypoint to shutDown. But, if &lt;ins&gt;MiniDispatcher#archiveExecutionGraph&lt;/ins&gt; throw exceptions during execution, it affect the following calls.&lt;/p&gt;

&lt;p&gt;So I open &lt;a href=&quot;https://issues.apache.org/jira/projects/FLINK/issues/FLINK-12247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;FLINK-12247&lt;/a&gt; to solve NEP bug when system write archive to FileSystem. But We still need to consider other exceptions, so we should catch Exception / Throwable not just IOExcetion.&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Flinkyarnjobfailflow&quot;&gt;&lt;/a&gt;&lt;b&gt;Flink yarn job fail flow&lt;/b&gt;&lt;/h3&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12966722/12966722_image-2019-04-23-17-37-00-081.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Flinkyarnjobfailonyarn&quot;&gt;&lt;/a&gt;&lt;b&gt;Flink yarn job fail on yarn&lt;/b&gt;&lt;/h3&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12966189/12966189_image-2019-04-17-15-00-40-687.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Flinkyarnapplicationcan%27tstop&quot;&gt;&lt;/a&gt;&lt;b&gt;Flink yarn application can&apos;t stop&lt;/b&gt;&lt;/h3&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12966188/12966188_image-2019-04-17-15-02-49-513.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13228513">FLINK-12219</key>
            <summary>Yarn application can&apos;t stop when flink job failed in per-job yarn cluster mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lamber-ken">lamber-ken</assignee>
                                    <reporter username="lamber-ken">lamber-ken</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 17 Apr 2019 07:03:02 +0000</created>
                <updated>Tue, 7 May 2019 15:27:31 +0000</updated>
                            <resolved>Tue, 7 May 2019 15:27:31 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.8.0</version>
                                    <fixVersion>1.7.3</fixVersion>
                    <fixVersion>1.8.1</fixVersion>
                    <fixVersion>1.9.0</fixVersion>
                                    <component>Deployment / YARN</component>
                    <component>Runtime / REST</component>
                        <due>Wed, 17 Apr 2019 00:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16820180" author="till.rohrmann" created="Wed, 17 Apr 2019 15:14:44 +0000"  >&lt;p&gt;In order to better understand the problem I would need a bit more context &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lamber-ken&quot; class=&quot;user-hover&quot; rel=&quot;lamber-ken&quot;&gt;lamber-ken&lt;/a&gt;. How did you deploy the Flink job (job mode detached or attached)? How did the job fail? What exception is being thrown in &lt;tt&gt;FsJobArchivist&lt;/tt&gt; to prevent the cluster from shutting down?&lt;/p&gt;</comment>
                            <comment id="16823900" author="lamber-ken" created="Tue, 23 Apr 2019 09:48:21 +0000"  >&lt;p&gt;hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, I updated the issue. help to review or offer your comments or suggestions. thanks.&lt;/p&gt;</comment>
                            <comment id="16824168" author="till.rohrmann" created="Tue, 23 Apr 2019 14:11:37 +0000"  >&lt;p&gt;I guess we could add an &lt;tt&gt;ArchivedExecutionGraph&lt;/tt&gt; which contains the failure cause why we couldn&apos;t archive the job. What is the exception you are seeing in your deployment &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lamber-ken&quot; class=&quot;user-hover&quot; rel=&quot;lamber-ken&quot;&gt;lamber-ken&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16824171" author="till.rohrmann" created="Tue, 23 Apr 2019 14:12:48 +0000"  >&lt;p&gt;You are running the Flink per-job cluster in attached mode &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lamber-ken&quot; class=&quot;user-hover&quot; rel=&quot;lamber-ken&quot;&gt;lamber-ken&lt;/a&gt;, right?&lt;/p&gt;</comment>
                            <comment id="16824919" author="lamber-ken" created="Wed, 24 Apr 2019 08:49:20 +0000"  >&lt;p&gt;no, in detach mode.&lt;/p&gt;</comment>
                            <comment id="16830073" author="till.rohrmann" created="Tue, 30 Apr 2019 08:55:33 +0000"  >&lt;p&gt;Problem has been resolved with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-12247&quot; title=&quot;fix NPE when writing an archive file to a FileSystem&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-12247&quot;&gt;&lt;del&gt;FLINK-12247&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16834873" author="till.rohrmann" created="Tue, 7 May 2019 15:27:31 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
1.9.0: 417d6d2070e7ff82eb73a605f12f50ca13acce15&lt;br/&gt;
1.8.1: a956a49876bb1733bb9354372c25c05d0d96d7be&lt;br/&gt;
1.7.3: cfbac8f024e818e9b9f816d93a684c4f8b721c2a&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12966234" name="fix-bug.patch" size="948" author="lamber-ken" created="Wed, 17 Apr 2019 12:20:43 +0000"/>
                            <attachment id="12966189" name="image-2019-04-17-15-00-40-687.png" size="63423" author="lamber-ken" created="Wed, 17 Apr 2019 07:00:42 +0000"/>
                            <attachment id="12966188" name="image-2019-04-17-15-02-49-513.png" size="31235" author="lamber-ken" created="Wed, 17 Apr 2019 07:02:51 +0000"/>
                            <attachment id="12966722" name="image-2019-04-23-17-37-00-081.png" size="46663" author="lamber-ken" created="Tue, 23 Apr 2019 09:37:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z01v7c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>