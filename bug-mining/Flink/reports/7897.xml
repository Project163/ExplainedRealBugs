<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:22:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-38109] BlobServer isn&apos;t associated with the correct bind-host</title>
                <link>https://issues.apache.org/jira/browse/FLINK-38109</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In a flink cluster, if the JobManager bind-host is configured with an address, this creates a mismatch where clients expect to connect to BlobServer at same address, but it&apos;s actually bound to localhost. The BlobServer becomes unreachable to clients, causing &quot;Could not connect to BlobServer&quot; errors.&lt;/p&gt;

&lt;p&gt;This can be reproduced when uploading a JAR file to the cluster for UDF registration, and configuring the JobManager bind-host to an external address.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.shopify.flink.examples.functions.asynchttpfunction;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.configuration.Configuration;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.configuration.RestOptions;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.table.api.bridge.java.StreamTableEnvironment;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;RosaTestFunction {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Configuration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; connecting to the local session cluster
&lt;/span&gt;&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Configuration configuration = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Configuration();

&#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Configure REST client to connect to the local session cluster
&lt;/span&gt;  &#160; &#160; &#160; configuration.set(RestOptions.ADDRESS, &amp;lt;external_address&amp;gt;);
&#160; &#160; &#160; &#160; configuration.set(RestOptions.PORT, 7100);&#160; &lt;span class=&quot;code-comment&quot;&gt;// REST API port
&lt;/span&gt;
	configuration.setString(&lt;span class=&quot;code-quote&quot;&gt;&quot;jobmanager.bind-host&quot;&lt;/span&gt;, &amp;lt;external_address&amp;gt;);
        configuration.setString(&lt;span class=&quot;code-quote&quot;&gt;&quot;taskmanager.bind-host&quot;&lt;/span&gt;, &amp;lt;external_address&amp;gt;);
&#160; &#160; &#160; &#160; 
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment(configuration);
&#160; &#160; &#160; &#160; StreamTableEnvironment tableEnv = StreamTableEnvironment.create(env);

&#160; &#160; &#160; &#160; tableEnv.executeSql(&quot;&quot;&quot;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CREATE FUNCTION example_custom
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AS &lt;span class=&quot;code-quote&quot;&gt;&apos;com.shopify.flink.examples.shared.ExampleCustomFunction&apos;&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LANGUAGE JAVA
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; USING JAR &lt;span class=&quot;code-quote&quot;&gt;&apos;file:&lt;span class=&quot;code-comment&quot;&gt;///Users/rosa/src/github.com/Shopify/flink-examples/sql/pipelines/flinksql-example/jars/shared.jar&apos;&lt;/span&gt;;&quot;&quot;&quot;);
&lt;/span&gt;
&#160; &#160; &#160; &#160; tableEnv.executeSql(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT example_custom(1,2) as sum_result;&quot;&lt;/span&gt;).print();
&#160; &#160; }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Root cause:&lt;/p&gt;

&lt;p&gt;The BlobServer bind-host is set to use the Jobmanager bind-host, however isn&apos;t assigned the correct host in the PekkoRpcService.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#L218-L220&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BlobServer.java&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bindHost = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)config.getOptional(JobManagerOptions.BIND_HOST).orElseGet(NetUtils::getWildcardIPAddress); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;#L477-L486&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;PekkoRpcService.java&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Tuple2&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; extractAddressHostname(ActorRef actorRef) {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; actorAddress = PekkoUtils.getRpcURL(actorSystem, actorRef);
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hostname;
&#160; &#160; Option&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; host = actorRef.path().address().host();
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (host.isEmpty()) {
&#160; &#160; &#160; &#160; hostname = &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost&quot;&lt;/span&gt;;
&#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; hostname = host.get();
&#160; &#160; }&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Tuple2.of(actorAddress, hostname);
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Potential solution:&lt;/p&gt;

&lt;p&gt;Add a `blob.server.bind-host` configuration option similar to the existing bind-host solution introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15911&quot; title=&quot;Flink does not work over NAT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15911&quot;&gt;&lt;del&gt;FLINK-15911&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15911&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-15911&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13623678">FLINK-38109</key>
            <summary>BlobServer isn&apos;t associated with the correct bind-host</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rosakang">Rosa Seohwa Kang</assignee>
                                    <reporter username="rosakang">Rosa Seohwa Kang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 16 Jul 2025 22:26:31 +0000</created>
                <updated>Tue, 9 Sep 2025 15:46:04 +0000</updated>
                            <resolved>Tue, 9 Sep 2025 15:46:04 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="18019186" author="JIRAUSER306586" created="Tue, 9 Sep 2025 15:46:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/commit/deee02b665c01d56d43da4df2eadfbbef333ec3c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;deee02b&lt;/tt&gt;&lt;/a&gt; in master&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wt00:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>