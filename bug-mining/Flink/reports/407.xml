<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:19:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2121] FileInputFormat.addFilesInDir miscalculates total size</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2121</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In FileInputFormat.addFilesInDir, the length variable should start from 0, because the return value is always used by adding it to the length (instead of just assigning). So with the current version, the length before the call will be seen twice in the result.&lt;/p&gt;

&lt;p&gt;mvn verify caught this for me now. The reason why this hasn&apos;t been seen yet, is because testGetStatisticsMultipleNestedFiles catches this only if it gets the listings of the outer directory in a certain order. Concretely, if the inner directory is seen before the other file in the outer directory, then length is 0 at that point, so the bug doesn&apos;t show. But if the other file is seen first, then its size is added twice to the total result.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12834064">FLINK-2121</key>
            <summary>FileInputFormat.addFilesInDir miscalculates total size</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggevay">G&#225;bor G&#233;vay</assignee>
                                    <reporter username="ggevay">G&#225;bor G&#233;vay</reporter>
                        <labels>
                    </labels>
                <created>Sun, 31 May 2015 11:26:38 +0000</created>
                <updated>Thu, 28 Feb 2019 13:21:12 +0000</updated>
                            <resolved>Mon, 1 Jun 2015 16:03:05 +0000</resolved>
                                                    <fixVersion>0.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14566522" author="githubbot" created="Sun, 31 May 2015 11:33:16 +0000"  >&lt;p&gt;GitHub user ggevay opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/752&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/752&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2121&quot; title=&quot;FileInputFormat.addFilesInDir miscalculates total size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2121&quot;&gt;&lt;del&gt;FLINK-2121&lt;/del&gt;&lt;/a&gt; Fix the summation in FileInputFormat.addFilesInDir&lt;/p&gt;

&lt;p&gt;    Removed the length parameter, and made the length calculation start from 0 instead.&lt;br/&gt;
    I also added a second inner dir to the test, so now it catches this problem with any directory listing order.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ggevay/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ggevay/flink&lt;/a&gt; dirSizeFix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/752.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/752.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #752&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7fc86ce10ddc640126c7da8265403a815a30c2d2&lt;br/&gt;
Author: Gabor Gevay &amp;lt;ggab90@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-05-31T11:27:15Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2121&quot; title=&quot;FileInputFormat.addFilesInDir miscalculates total size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2121&quot;&gt;&lt;del&gt;FLINK-2121&lt;/del&gt;&lt;/a&gt; Fix the recursive summation in FileInputFormat.addFilesInDir&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14567223" author="githubbot" created="Mon, 1 Jun 2015 12:11:45 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/752#issuecomment-107419256&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/752#issuecomment-107419256&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM. Thanks for spotting this one.&lt;/p&gt;</comment>
                            <comment id="14567328" author="githubbot" created="Mon, 1 Jun 2015 14:01:09 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/752#issuecomment-107498384&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/752#issuecomment-107498384&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1, should go into the release candidate.&lt;/p&gt;

&lt;p&gt;    Will merge this now...&lt;/p&gt;</comment>
                            <comment id="14567474" author="githubbot" created="Mon, 1 Jun 2015 15:58:33 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/752&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/752&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14567483" author="stephanewen" created="Mon, 1 Jun 2015 16:03:05 +0000"  >&lt;p&gt;Fixed via 033409190235f93ed6d4e652214e7f35a34c3fe3&lt;/p&gt;

&lt;p&gt;Thank you for the patch!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ffen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>