<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7663] Allow AbstractRestHandler to handle bad requests</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7663</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The &lt;tt&gt;AbstractRestHandler&lt;/tt&gt; parses the request and tries to generate a &lt;tt&gt;HandlerRequest&lt;/tt&gt;. If this fails, then the server answers with an internal server error. Instead we should allow the &lt;tt&gt;AbstractRestHandler&lt;/tt&gt; to be able to return a BAD_REQUEST status code. In order to do that, I would like to introduce a &lt;tt&gt;HandlerRequestException&lt;/tt&gt; which can be thrown while creating the &lt;tt&gt;HandlerRequest&lt;/tt&gt;. If this exception is thrown, then we return an error message with &lt;tt&gt;BAD_REQUEST&lt;/tt&gt; &lt;tt&gt;HttpResponseStatus&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13103978">FLINK-7663</key>
            <summary>Allow AbstractRestHandler to handle bad requests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>flip-6</label>
                    </labels>
                <created>Thu, 21 Sep 2017 15:11:35 +0000</created>
                <updated>Wed, 27 Sep 2017 16:15:55 +0000</updated>
                            <resolved>Wed, 27 Sep 2017 16:14:27 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Runtime / REST</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16175050" author="githubbot" created="Thu, 21 Sep 2017 16:26:52 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7663&quot; title=&quot;Allow AbstractRestHandler to handle bad requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7663&quot;&gt;&lt;del&gt;FLINK-7663&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;flip6&amp;#93;&lt;/span&gt; Return BAD_REQUEST if HandlerRequest cannot be created&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This commit changes the behaviour such that a failure in creating a `HandlerRequest` will&lt;br/&gt;
    result in a BAD_REQUEST response by the AbstractRestHandler.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Introduce the `HandlerRequestException` indicating that the `HandlerRequest` could not be created&lt;/li&gt;
	&lt;li&gt;Introduce a checked `ConversionException` for `MessageParameter#convertFromString` to let conversions fail explicitly&lt;/li&gt;
	&lt;li&gt;Send `BAD_REQUEST` response in case that the `HandlerRequest` could not be created&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added `RestEndpointITCase#testBadHandlerRequest`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    R @zentol &lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; supportBadRestRequests&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4699&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 38c8a188ad72a1ce48129077b71df971ade44354&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-09-21T16:14:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7663&quot; title=&quot;Allow AbstractRestHandler to handle bad requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7663&quot;&gt;&lt;del&gt;FLINK-7663&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;flip6&amp;#93;&lt;/span&gt; Return BAD_REQUEST if HandlerRequest cannot be created&lt;/p&gt;

&lt;p&gt;    This commit changes the behaviour such that a failure in creating a HandlerRequest will&lt;br/&gt;
    result in a BAD_REQUEST response by the AbstractRestHandler.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16181122" author="githubbot" created="Tue, 26 Sep 2017 16:51:40 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141115054&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141115054&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/AbstractRestHandler.java &amp;#8212;&lt;br/&gt;
    @@ -117,11 +117,26 @@ protected void respondAsLeader(final ChannelHandlerContext ctx, Routed routed, T&lt;br/&gt;
     				}&lt;br/&gt;
     			}&lt;/p&gt;

&lt;p&gt;    +			final HandlerRequest&amp;lt;R, M&amp;gt; handlerRequest;&lt;br/&gt;
    +&lt;br/&gt;
    +			try &lt;/p&gt;
{
    +				handlerRequest = new HandlerRequest&amp;lt;&amp;gt;(request, messageHeaders.getUnresolvedMessageParameters(), routed.pathParams(), routed.queryParams());
    +			}
&lt;p&gt; catch (HandlerRequestException hre) {&lt;br/&gt;
    +				log.error(&quot;Could not create the handler request.&quot;, hre);&lt;br/&gt;
    +&lt;br/&gt;
    +				HandlerUtils.sendErrorResponse(&lt;br/&gt;
    +					ctx,&lt;br/&gt;
    +					httpRequest,&lt;br/&gt;
    +					new ErrorResponseBody(String.format(&quot;Could not create the handler request: %s&quot;, hre.getMessage())),&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    HandlerRequests is an external concept that we imo should not expose. I would just say &quot;Bad request, could not parse parameters.&quot;&lt;/p&gt;</comment>
                            <comment id="16181143" author="githubbot" created="Tue, 26 Sep 2017 17:04:28 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141119299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141119299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -237,8 +300,8 @@ public TestParameters getUnresolvedMessageParameters() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	private static class TestParameters extends MessageParameters {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private final JobIDPathParameter jobIDPathParameter = new JobIDPathParameter();&lt;/li&gt;
	&lt;li&gt;private final JobIDQueryParameter jobIDQueryParameter = new JobIDQueryParameter();&lt;br/&gt;
    +		protected final JobIDPathParameter jobIDPathParameter = new JobIDPathParameter();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    what is this change for?&lt;/p&gt;</comment>
                            <comment id="16181144" author="githubbot" created="Tue, 26 Sep 2017 17:04:28 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141118884&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141118884&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -86,46 +98,97 @@ public void testEndpoints() throws Exception {&lt;br/&gt;
     			mockGatewayRetriever,&lt;br/&gt;
     			RpcUtils.INF_TIMEOUT);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;RestServerEndpoint serverEndpoint = new TestRestServerEndpoint(serverConfig, testHandler);&lt;/li&gt;
	&lt;li&gt;RestClient clientEndpoint = new TestRestClient(clientConfig);&lt;br/&gt;
    +		serverEndpoint = new TestRestServerEndpoint(serverConfig, testHandler);&lt;br/&gt;
    +		clientEndpoint = new TestRestClient(clientConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;serverEndpoint.start();&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;TestParameters parameters = new TestParameters();&lt;/li&gt;
	&lt;li&gt;parameters.jobIDPathParameter.resolve(PATH_JOB_ID);&lt;/li&gt;
	&lt;li&gt;parameters.jobIDQueryParameter.resolve(Collections.singletonList(QUERY_JOB_ID));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// send first request and wait until the handler blocks&lt;/li&gt;
	&lt;li&gt;CompletableFuture&amp;lt;TestResponse&amp;gt; response1;&lt;/li&gt;
	&lt;li&gt;synchronized (TestHandler.LOCK) 
{
    -				response1 = clientEndpoint.sendRequest(
    -					serverConfig.getEndpointBindAddress(),
    -					serverConfig.getEndpointBindPort(),
    -					new TestHeaders(),
    -					parameters,
    -					new TestRequest(1));
    -				TestHandler.LOCK.wait();
    -			}
&lt;p&gt;    +		serverEndpoint.start();&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@After&lt;br/&gt;
    +	public void teardown() {&lt;br/&gt;
    +		if (clientEndpoint != null) &lt;/p&gt;
{
    +			clientEndpoint.shutdown(timeout);
    +			clientEndpoint = null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// send second request and verify response&lt;/li&gt;
	&lt;li&gt;CompletableFuture&amp;lt;TestResponse&amp;gt; response2 = clientEndpoint.sendRequest(&lt;/li&gt;
	&lt;li&gt;serverConfig.getEndpointBindAddress(),&lt;/li&gt;
	&lt;li&gt;serverConfig.getEndpointBindPort(),&lt;br/&gt;
    +		if (serverEndpoint != null) 
{
    +			serverEndpoint.shutdown(timeout);
    +			serverEndpoint = null;
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testEndpoints() throws Exception {&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    rename to &quot;testRequestInterleaving&quot;, since we modify the line anyway&lt;/p&gt;</comment>
                            <comment id="16181145" author="githubbot" created="Tue, 26 Sep 2017 17:04:28 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141119740&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141119740&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -162,8 +225,8 @@ public void testEndpoints() throws Exception {&lt;/p&gt;

&lt;p&gt;     		@Override&lt;br/&gt;
     		protected CompletableFuture&amp;lt;TestResponse&amp;gt; handleRequest(@Nonnull HandlerRequest&amp;lt;TestRequest, TestParameters&amp;gt; request, RestfulGateway gateway) throws RestHandlerException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Assert.assertEquals(request.getPathParameter(JobIDPathParameter.class), PATH_JOB_ID);&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(request.getQueryParameter(JobIDQueryParameter.class).get(0), QUERY_JOB_ID);&lt;br/&gt;
    +			assertEquals(request.getPathParameter(JobIDPathParameter.class), PATH_JOB_ID);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    How about we stick to the import pattern that already exists in a given file instead of switching back and forth?&lt;/p&gt;</comment>
                            <comment id="16182409" author="githubbot" created="Wed, 27 Sep 2017 11:35:38 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141316258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141316258&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/AbstractRestHandler.java &amp;#8212;&lt;br/&gt;
    @@ -117,11 +117,26 @@ protected void respondAsLeader(final ChannelHandlerContext ctx, Routed routed, T&lt;br/&gt;
     				}&lt;br/&gt;
     			}&lt;/p&gt;

&lt;p&gt;    +			final HandlerRequest&amp;lt;R, M&amp;gt; handlerRequest;&lt;br/&gt;
    +&lt;br/&gt;
    +			try &lt;/p&gt;
{
    +				handlerRequest = new HandlerRequest&amp;lt;&amp;gt;(request, messageHeaders.getUnresolvedMessageParameters(), routed.pathParams(), routed.queryParams());
    +			}
&lt;p&gt; catch (HandlerRequestException hre) {&lt;br/&gt;
    +				log.error(&quot;Could not create the handler request.&quot;, hre);&lt;br/&gt;
    +&lt;br/&gt;
    +				HandlerUtils.sendErrorResponse(&lt;br/&gt;
    +					ctx,&lt;br/&gt;
    +					httpRequest,&lt;br/&gt;
    +					new ErrorResponseBody(String.format(&quot;Could not create the handler request: %s&quot;, hre.getMessage())),&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Sure, can change this.&lt;/p&gt;</comment>
                            <comment id="16182411" author="githubbot" created="Wed, 27 Sep 2017 11:38:12 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141316774&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141316774&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -86,46 +98,97 @@ public void testEndpoints() throws Exception {&lt;br/&gt;
     			mockGatewayRetriever,&lt;br/&gt;
     			RpcUtils.INF_TIMEOUT);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;RestServerEndpoint serverEndpoint = new TestRestServerEndpoint(serverConfig, testHandler);&lt;/li&gt;
	&lt;li&gt;RestClient clientEndpoint = new TestRestClient(clientConfig);&lt;br/&gt;
    +		serverEndpoint = new TestRestServerEndpoint(serverConfig, testHandler);&lt;br/&gt;
    +		clientEndpoint = new TestRestClient(clientConfig);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;serverEndpoint.start();&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;TestParameters parameters = new TestParameters();&lt;/li&gt;
	&lt;li&gt;parameters.jobIDPathParameter.resolve(PATH_JOB_ID);&lt;/li&gt;
	&lt;li&gt;parameters.jobIDQueryParameter.resolve(Collections.singletonList(QUERY_JOB_ID));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// send first request and wait until the handler blocks&lt;/li&gt;
	&lt;li&gt;CompletableFuture&amp;lt;TestResponse&amp;gt; response1;&lt;/li&gt;
	&lt;li&gt;synchronized (TestHandler.LOCK) 
{
    -				response1 = clientEndpoint.sendRequest(
    -					serverConfig.getEndpointBindAddress(),
    -					serverConfig.getEndpointBindPort(),
    -					new TestHeaders(),
    -					parameters,
    -					new TestRequest(1));
    -				TestHandler.LOCK.wait();
    -			}
&lt;p&gt;    +		serverEndpoint.start();&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@After&lt;br/&gt;
    +	public void teardown() {&lt;br/&gt;
    +		if (clientEndpoint != null) &lt;/p&gt;
{
    +			clientEndpoint.shutdown(timeout);
    +			clientEndpoint = null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// send second request and verify response&lt;/li&gt;
	&lt;li&gt;CompletableFuture&amp;lt;TestResponse&amp;gt; response2 = clientEndpoint.sendRequest(&lt;/li&gt;
	&lt;li&gt;serverConfig.getEndpointBindAddress(),&lt;/li&gt;
	&lt;li&gt;serverConfig.getEndpointBindPort(),&lt;br/&gt;
    +		if (serverEndpoint != null) 
{
    +			serverEndpoint.shutdown(timeout);
    +			serverEndpoint = null;
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testEndpoints() throws Exception {&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Will do&lt;/p&gt;</comment>
                            <comment id="16182414" author="githubbot" created="Wed, 27 Sep 2017 11:42:48 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141317701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141317701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -237,8 +300,8 @@ public TestParameters getUnresolvedMessageParameters() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	private static class TestParameters extends MessageParameters {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private final JobIDPathParameter jobIDPathParameter = new JobIDPathParameter();&lt;/li&gt;
	&lt;li&gt;private final JobIDQueryParameter jobIDQueryParameter = new JobIDQueryParameter();&lt;br/&gt;
    +		protected final JobIDPathParameter jobIDPathParameter = new JobIDPathParameter();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    To make it accessible when you have a `FaultyTestParameter` instance. Can also cast it which gives access to `jobIDPathParameter`.&lt;/p&gt;</comment>
                            <comment id="16182418" author="githubbot" created="Wed, 27 Sep 2017 11:44:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699#discussion_r141317913&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699#discussion_r141317913&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/rest/RestEndpointITCase.java &amp;#8212;&lt;br/&gt;
    @@ -162,8 +225,8 @@ public void testEndpoints() throws Exception {&lt;/p&gt;

&lt;p&gt;     		@Override&lt;br/&gt;
     		protected CompletableFuture&amp;lt;TestResponse&amp;gt; handleRequest(@Nonnull HandlerRequest&amp;lt;TestRequest, TestParameters&amp;gt; request, RestfulGateway gateway) throws RestHandlerException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Assert.assertEquals(request.getPathParameter(JobIDPathParameter.class), PATH_JOB_ID);&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(request.getQueryParameter(JobIDQueryParameter.class).get(0), QUERY_JOB_ID);&lt;br/&gt;
    +			assertEquals(request.getPathParameter(JobIDPathParameter.class), PATH_JOB_ID);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Sure. &lt;/p&gt;</comment>
                            <comment id="16182419" author="githubbot" created="Wed, 27 Sep 2017 11:44:42 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Addressed the PR feedback so far and rebased onto the latest master.&lt;/p&gt;</comment>
                            <comment id="16182531" author="githubbot" created="Wed, 27 Sep 2017 13:12:44 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1.&lt;/p&gt;</comment>
                            <comment id="16182808" author="githubbot" created="Wed, 27 Sep 2017 16:11:18 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @zentol. Failing test is unrelated. Merging this PR.&lt;/p&gt;</comment>
                            <comment id="16182810" author="till.rohrmann" created="Wed, 27 Sep 2017 16:14:27 +0000"  >&lt;p&gt;Fixed via 9a97dcdff6c7d383c3bb9c9aa7b83bde7ea5fd64&lt;/p&gt;</comment>
                            <comment id="16182817" author="githubbot" created="Wed, 27 Sep 2017 16:15:55 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4699&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kd1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>