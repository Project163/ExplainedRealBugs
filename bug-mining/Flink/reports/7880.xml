<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:22:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-38138] Array OOB error when trying to get a binary from a non-zero offset from a vector</title>
                <link>https://issues.apache.org/jira/browse/FLINK-38138</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;We have noticed that an OOB error is being thrown when trying to invoke getBinary when the following conditions are met:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;There are multiple elements in a HeapArrayVector&lt;/li&gt;
	&lt;li&gt;When trying to get an element from a non-zero offset of the array&lt;/li&gt;
	&lt;li&gt;When trying to convert this array that we have obtained to a binary&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.IllegalArgumentException: 72 &amp;gt; 36	at java.util.Arrays.copyOfRange(Arrays.java:3519)	at org.apache.flink.table.data.columnar.ColumnarArrayData.getBinary(ColumnarArrayData.java:138)	at org.apache.hudi.table.format.cow.vector.ColumnarGroupRowData.getBinary(ColumnarGroupRowData.java:121)	at org.apache.flink.table.data.RowData.lambda$createFieldGetter$245ca7d1$3(RowData.java:228)	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.toBinaryRow(RowDataSerializer.java:207)	at org.apache.flink.table.data.writer.AbstractBinaryWriter.writeRow(AbstractBinaryWriter.java:147)	at org.apache.flink.table.data.writer.BinaryArrayWriter.writeRow(BinaryArrayWriter.java:30)	at org.apache.flink.table.data.writer.BinaryWriter.write(BinaryWriter.java:155)	at org.apache.flink.table.runtime.typeutils.MapDataSerializer.toBinaryMap(MapDataSerializer.java:179)	at org.apache.flink.table.runtime.typeutils.MapDataSerializer.copy(MapDataSerializer.java:113)	at org.apache.flink.table.runtime.typeutils.MapDataSerializer.copy(MapDataSerializer.java:44)	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copyRowData(RowDataSerializer.java:170)	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:131) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The error below is caused by the code below:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] getBinary(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; pos) {
    BytesColumnVector.Bytes byteArray = getByteArray(pos);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (byteArray.len == byteArray.data.length) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; byteArray.data;
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Arrays.copyOfRange(byteArray.data, byteArray.offset, byteArray.len);
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The function signature of &lt;tt&gt;Arrays.copyOfRange&lt;/tt&gt; is as such:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] copyOfRange(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] original, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; from, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; to) { &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;java.util.Arrays.copyOfRange(original, from, to)&lt;/tt&gt; method copies the specified range of the &lt;tt&gt;original&lt;/tt&gt; array into a new array.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;from&lt;/tt&gt;: The initial index of the range to be copied, inclusive.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;to&lt;/tt&gt;: The final index of the range to be copied, &lt;b&gt;exclusive&lt;/b&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Hence, the correct way of invoking &lt;tt&gt;Arrays.copyOfRange&lt;/tt&gt;&#160;should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Arrays.copyOfRange(
        byteArray.data, byteArray.offset, byteArray.offset + byteArray.len); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Will fire a fix for this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13624433">FLINK-38138</key>
            <summary>Array OOB error when trying to get a binary from a non-zero offset from a vector</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vhs">Voon Hou</assignee>
                                    <reporter username="vhs">Voon Hou</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 23 Jul 2025 19:01:17 +0000</created>
                <updated>Wed, 6 Aug 2025 04:42:16 +0000</updated>
                            <resolved>Sat, 2 Aug 2025 14:54:15 +0000</resolved>
                                    <version>1.17.0</version>
                    <version>1.18.0</version>
                    <version>1.20.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18011599" author="sergey nuyanzin" created="Sat, 2 Aug 2025 14:54:08 +0000"  >&lt;p&gt;Merged as &lt;a href=&quot;https://github.com/apache/flink/commit/63b2ad5ffe8c3d064a7086fb99fc3cfa47455ca4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;63b2ad5ffe8c3d064a7086fb99fc3cfa47455ca4&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18012008" author="JIRAUSER303356" created="Tue, 5 Aug 2025 03:15:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sergey+Nuyanzin&quot; class=&quot;user-hover&quot; rel=&quot;Sergey Nuyanzin&quot;&gt;Sergey Nuyanzin&lt;/a&gt; Will this fix be included in versions: &lt;b&gt;2.0.1&lt;/b&gt;, &lt;b&gt;1.20.3&lt;/b&gt;, &lt;b&gt;2.1.1&lt;/b&gt; too?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="18012066" author="sergey nuyanzin" created="Tue, 5 Aug 2025 08:10:42 +0000"  >&lt;p&gt;Contributions are welcome: submit backporting PRs like it was done for other issues&#160;&lt;br/&gt;
for instance &lt;a href=&quot;https://github.com/apache/flink/pulls?q=is%3Apr+is%3Aopen+BP&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pulls?q=is%3Apr+is%3Aopen+BP&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18012277" author="JIRAUSER303356" created="Wed, 6 Aug 2025 04:41:38 +0000"  >&lt;p&gt;Backport for 1.20: &lt;a href=&quot;https://github.com/apache/flink/pull/26871&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/26871&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Backport for 1.19: &lt;a href=&quot;https://github.com/apache/flink/pull/26872&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/26872&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Added backports for the above version for now, will need to check internally if we need to support other versions. May I know how many rolling versions of minor version Flink is supporting?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wx9k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>