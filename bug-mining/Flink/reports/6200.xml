<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:08:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-26101] Avoid shared state registry to discard multi-registered identical changelog state</title>
                <link>https://issues.apache.org/jira/browse/FLINK-26101</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Under change-log state backend, we will register same materialized keyed state handle multi times, and &lt;tt&gt;SharedStateRegistryImpl&lt;/tt&gt; will discard the duplicated state handle.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!Objects.equals(state, entry.stateHandle)) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.confirmed || isPlaceholder(state)) {
        scheduledStateDeletion = state;
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-comment&quot;&gt;// Old entry is not in a confirmed checkpoint yet, and the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; one differs.
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// This might result from (omitted KG range here &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; simplicity):
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 1. Flink recovers from a failure using a checkpoint 1
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 2. State Backend is initialized to UID xyz and a set of SST: { 01.sst }
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 3. JM triggers checkpoint 2
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 4. TM sends handle: &lt;span class=&quot;code-quote&quot;&gt;&quot;xyz-002.sst&quot;&lt;/span&gt;; JM registers it under &lt;span class=&quot;code-quote&quot;&gt;&quot;xyz-002.sst&quot;&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 5. TM crashes; everything is repeated from (2)
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 6. TM recovers from CP 1 again: backend UID &lt;span class=&quot;code-quote&quot;&gt;&quot;xyz&quot;&lt;/span&gt;, SST { 01.sst }
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 7. JM triggers checkpoint 3
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 8. TM sends NEW state &lt;span class=&quot;code-quote&quot;&gt;&quot;xyz-002.sst&quot;&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 9. JM discards it as duplicate
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// 10. checkpoint completes, but a wrong SST file is used
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// So we use a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; entry and discard the old one:
&lt;/span&gt;        scheduledStateDeletion = entry.stateHandle;
        entry.stateHandle = state;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thus, we need to implement the &lt;tt&gt;#equals&lt;/tt&gt; method for the registered state handles.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13428221">FLINK-26101</key>
            <summary>Avoid shared state registry to discard multi-registered identical changelog state</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yunta">Yun Tang</assignee>
                                    <reporter username="yunta">Yun Tang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 14 Feb 2022 02:42:21 +0000</created>
                <updated>Mon, 14 Feb 2022 23:26:00 +0000</updated>
                            <resolved>Mon, 14 Feb 2022 15:07:54 +0000</resolved>
                                                    <fixVersion>1.15.0</fixVersion>
                                    <component>Runtime / Checkpointing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17492046" author="yunta" created="Mon, 14 Feb 2022 15:07:54 +0000"  >&lt;p&gt;Merged in master: 8b25ae64794727e49de66d0b61e0955da7f21961&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13392694">FLINK-23559</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13419870">FLINK-25478</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13419870">FLINK-25478</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zj6w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>