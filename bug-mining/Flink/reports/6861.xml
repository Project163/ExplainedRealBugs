<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-30679] Can not load the data of hive dim table when project-push-down is introduced</title>
                <link>https://issues.apache.org/jira/browse/FLINK-30679</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&#32500;&#34920;project push down&#20248;&#21270;&#24341;&#20837;&#65306;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-29138&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-29138&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;hive&#32500;&#34920;&#30340;&#20004;&#20010;&#38382;&#39064;&#65306;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-29992&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-29992&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-30679&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-30679&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Can not load the data of hive dim table when project-push-down is introduced.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;hive-exec&#160; version: 2.3.4&lt;/p&gt;

&lt;p&gt;flink version: 1.14.6&lt;/p&gt;

&lt;p&gt;flink-hive-connector: the latest code for release-1.14 branch&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;vectorize read:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ArrayIndexOutOfBoundsException: 3
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveTableInputFormat.useOrcVectorizedRead(HiveTableInputFormat.java:276) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveTableInputFormat.open(HiveTableInputFormat.java:129) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveInputFormatPartitionReader.open(HiveInputFormatPartitionReader.java:86) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.table.filesystem.FileSystemLookupFunction.checkCacheReload(FileSystemLookupFunction.java:132) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6]
&#160; &#160; at org.apache.flink.table.filesystem.FileSystemLookupFunction.eval(FileSystemLookupFunction.java:105) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6]
&#160; &#160; at LookupFunction$26.flatMap(Unknown Source) ~[?:?] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;mapreduce read:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ArrayIndexOutOfBoundsException: 3
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveMapredSplitReader.lambda$&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;$0(HiveMapredSplitReader.java:139) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at java.util.stream.IntPipeline$4$1.accept(IntPipeline.java:250) ~[?:1.8.0_301]
&#160; &#160; at java.util.Spliterators$IntArraySpliterator.forEachRemaining(Spliterators.java:1032) ~[?:1.8.0_301]
&#160; &#160; at java.util.Spliterator$OfInt.forEachRemaining(Spliterator.java:693) ~[?:1.8.0_301]
&#160; &#160; at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_301]
&#160; &#160; at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_301]
&#160; &#160; at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:546) ~[?:1.8.0_301]
&#160; &#160; at java.util.stream.AbstractPipeline.evaluateToArrayNode(AbstractPipeline.java:260) ~[?:1.8.0_301]
&#160; &#160; at java.util.stream.ReferencePipeline.toArray(ReferencePipeline.java:438) ~[?:1.8.0_301]
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveMapredSplitReader.&amp;lt;init&amp;gt;(HiveMapredSplitReader.java:141) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveTableInputFormat.open(HiveTableInputFormat.java:157) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.connectors.hive.read.HiveInputFormatPartitionReader.open(HiveInputFormatPartitionReader.java:86) ~[flink-connector-hive-1.14.1-SNAPSHOT.jar:1.14-SNAPSHOT]
&#160; &#160; at org.apache.flink.table.filesystem.FileSystemLookupFunction.checkCacheReload(FileSystemLookupFunction.java:132) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6]
&#160; &#160; at org.apache.flink.table.filesystem.FileSystemLookupFunction.eval(FileSystemLookupFunction.java:105) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6]
&#160; &#160; at LookupFunction$26.flatMap(Unknown Source) ~[?:?]
&#160; &#160; at org.apache.flink.table.runtime.operators.join.lookup.LookupJoinRunner.processElement(LookupJoinRunner.java:81) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6]
&#160; &#160; at org.apache.flink.table.runtime.operators.join.lookup.LookupJoinRunner.processElement(LookupJoinRunner.java:34) ~[flink-table-runtime_2.11-1.14.6.jar:1.14.6] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The sql :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE TABLE kafkaTableSource (
    name string,
    age &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
    sex string,
    address string,
    ptime AS PROCTIME()
) WITH (
    &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;hehuiyuan1&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;scan.startup.mode&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;latest-offset&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.client.id&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;test-consumer-group&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.group.id&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;test-consumer-group&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;csv&apos;&lt;/span&gt;
);

CREATE TABLE printsink (
    name string,
    age &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
    sex string,
    address string,
    score bigint,
    dt string
) WITH (
    &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;print&apos;&lt;/span&gt;
);

CREATE CATALOG myhive
WITH (
        &lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;hive&apos;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-database&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;hhy&apos;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&apos;hive-version&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.0.0&apos;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&apos;hadoop-conf-dir&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;/Users/hehuiyuan/soft/hadoop/hadoop-2.7.3/etc/hadoop&apos;&lt;/span&gt;
);

USE CATALOG myhive;
USE hhy;

set table.sql-dialect=hive;
CREATE TABLE IF NOT EXISTS tmp_flink_test_text (
    name STRING,
    age INT,
    score BIGINT
) PARTITIONED BY (dt STRING) STORED AS TEXTFILE TBLPROPERTIES (
    &lt;span class=&quot;code-quote&quot;&gt;&apos;streaming-source.enable&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;streaming-source.partition.include&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;all&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;lookup.join.cache.ttl&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;5 min&apos;&lt;/span&gt;
);
set table.sql-dialect=&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;;

USE CATALOG default_catalog;
INSERT INTO default_catalog.default_database.printsink
SELECT s.name, s.age, s.sex, s.address, r.score, r.dt
FROM default_catalog.default_database.kafkaTableSource  as s
JOIN myhive.hhy.tmp_flink_test_text FOR SYSTEM_TIME AS OF s.ptime  AS r
ON r.name = s.name;
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13518324">FLINK-30679</key>
            <summary>Can not load the data of hive dim table when project-push-down is introduced</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hehuiyuan">hehuiyuan</assignee>
                                    <reporter username="hehuiyuan">hehuiyuan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 13 Jan 2023 11:58:35 +0000</created>
                <updated>Tue, 14 Feb 2023 10:43:31 +0000</updated>
                            <resolved>Mon, 30 Jan 2023 08:00:47 +0000</resolved>
                                    <version>1.14.6</version>
                                    <fixVersion>1.17.0</fixVersion>
                    <fixVersion>1.14.7</fixVersion>
                    <fixVersion>1.15.4</fixVersion>
                    <fixVersion>1.16.2</fixVersion>
                                    <component>Connectors / Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17677107" author="hehuiyuan" created="Mon, 16 Jan 2023 01:31:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=luoyuxia&quot; class=&quot;user-hover&quot; rel=&quot;luoyuxia&quot;&gt;luoyuxia&lt;/a&gt;&#160;,hi&lt;/p&gt;

&lt;p&gt;Take a look when you have time&lt;/p&gt;</comment>
                            <comment id="17677172" author="luoyuxia" created="Mon, 16 Jan 2023 06:25:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hehuiyuan&quot; class=&quot;user-hover&quot; rel=&quot;hehuiyuan&quot;&gt;hehuiyuan&lt;/a&gt; Thanks for contribution. I will have a look.&lt;/p&gt;</comment>
                            <comment id="17681930" author="jark" created="Mon, 30 Jan 2023 08:00:47 +0000"  >&lt;p&gt;Fixed in &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master: 7df2a12472f4bf990f86b905cdfcbf83d19e76b3&lt;/li&gt;
	&lt;li&gt;release-1.16: b5f50c354c47f27ca66c2d26c78c744d1b75c65a&lt;/li&gt;
	&lt;li&gt;release-1.15: b412bc315fc851c453266cd7f6f98ef3ca0ea747&lt;/li&gt;
	&lt;li&gt;release-1.14: 08dbb6d5eff46e72af412643f80ac353636821de&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1eucw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>