<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9053] Exception in RecordWriter during cleanup of StreamTask with the checkpoint trigger running in parallel</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9053</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/apache/flink/jobs/356612100&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/flink/jobs/356612100&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
testSavepointRescalingOutKeyedStateDerivedMaxParallelism[0](org.apache.flink.test.checkpointing.RescalingITCase)  Time elapsed: 2.021 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$6.apply$mcV$sp(JobManager.scala:891)
	at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$6.apply(JobManager.scala:834)
	at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$6.apply(JobManager.scala:834)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:39)
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:415)
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
Caused by: java.util.NoSuchElementException: No value present
	at java.util.Optional.get(Optional.java:135)
	at org.apache.flink.runtime.io.network.api.writer.RecordWriter.closeBufferBuilder(RecordWriter.java:218)
	at org.apache.flink.runtime.io.network.api.writer.RecordWriter.clearBuffers(RecordWriter.java:178)
	at org.apache.flink.streaming.runtime.io.StreamRecordWriter.close(StreamRecordWriter.java:99)
	at org.apache.flink.streaming.runtime.io.RecordWriterOutput.close(RecordWriterOutput.java:161)
	at org.apache.flink.streaming.runtime.tasks.OperatorChain.releaseOutputs(OperatorChain.java:239)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:402)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:703)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13147096">FLINK-9053</key>
            <summary>Exception in RecordWriter during cleanup of StreamTask with the checkpoint trigger running in parallel</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nkruber">Nico Kruber</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Mar 2018 09:22:25 +0000</created>
                <updated>Mon, 23 Apr 2018 04:57:17 +0000</updated>
                            <resolved>Mon, 23 Apr 2018 04:57:17 +0000</resolved>
                                    <version>1.5.0</version>
                    <version>1.6.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Runtime / Network</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16409803" author="githubbot" created="Thu, 22 Mar 2018 16:19:42 +0000"  >&lt;p&gt;GitHub user NicoK opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5748&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9053&quot; title=&quot;Exception in RecordWriter during cleanup of StreamTask with the checkpoint trigger running in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9053&quot;&gt;&lt;del&gt;FLINK-9053&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; only release outputs under the checkpoint lock&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Releasing an operator chain&apos;s outputs will call `RecordWriter#clearBuffers()` and this may not be run in parallel with `RecordWriter#broadcastEvent()` which the asynchronous checkpoint barrier trigger inside `Task` may run via `StreamTask#triggerCheckpoint()`. Now, during the cleanup of `StreamTask#invoke()`, `StreamTask`&apos;s asynchronous services are shut down but not those of the `Task` and also `operatorChain.releaseOutputs()` is not put under the checkpoint lock. Therefore, the following may run in parallel:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;`Task`&apos;s checkpoint trigger execution&lt;/li&gt;
	&lt;li&gt;`operatorChain.releaseOutputs()`&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We may guard `operatorChain.releaseOutputs()` with the the checkpoint lock and should be safe to do so since we already closed all of `StreamTask`&apos;s asynchronous executors and also disposed the operators. Hence nothing should be blocking the cleanup by holding the checkpoint lock.&lt;br/&gt;
    @StephanEwen can you please have a look to verify the safety of this?&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add the checkpoint lock in the cleanup of `StreamTask#invoke()` around  `operatorChain.releaseOutputs()`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This is a very rare race condition that was uncovered by the `RescalingITCase`.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The serializers: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: *&lt;b&gt;yes&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? *&lt;b&gt;not applicable&lt;/b&gt;*&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/NicoK/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/NicoK/flink&lt;/a&gt; flink-9053&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5748.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5748.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5748&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9f0295aa3c02e4870b248241cb9094d14863a686&lt;br/&gt;
Author: Stefan Richter &amp;lt;s.richter@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T17:03:14Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; Improved logging for task local recovery&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 56c7560)&lt;/p&gt;

&lt;p&gt;commit e9e13dec10f1a1ee57c46719d758885c4f33dcf3&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@...&amp;gt;&lt;br/&gt;
Date:   2018-02-27T15:53:03Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Suppress unused warning config options only used in shell scripts and doc generation.&lt;/p&gt;

&lt;p&gt;commit a269f8519305faff153e84d729873b6f9497bd36&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@...&amp;gt;&lt;br/&gt;
Date:   2018-02-27T16:04:29Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8798&quot; title=&quot;Make commons-logging a parent-first pattern&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8798&quot;&gt;&lt;del&gt;FLINK-8798&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Make force &apos;commons-logging&apos; to be parent-first loaded.&lt;/p&gt;

&lt;p&gt;commit 1d26062de130c05fdbe7701b55766b4a8d433418&lt;br/&gt;
Author: Xingcan Cui &amp;lt;xingcanc@...&amp;gt;&lt;br/&gt;
Date:   2018-02-12T10:11:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8538&quot; title=&quot;Add a Kafka table source factory with JSON format support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8538&quot;&gt;&lt;del&gt;FLINK-8538&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt;Add a Kafka table source factory with JSON format support&lt;/p&gt;

&lt;p&gt;commit db2c510fb4f171c9e9940759e5fbaf466ec74474&lt;br/&gt;
Author: Timo Walther &amp;lt;twalthr@...&amp;gt;&lt;br/&gt;
Date:   2018-02-19T12:35:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8538&quot; title=&quot;Add a Kafka table source factory with JSON format support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8538&quot;&gt;&lt;del&gt;FLINK-8538&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Improve unified table sources&lt;/p&gt;

&lt;p&gt;    This closes #5564.&lt;/p&gt;

&lt;p&gt;commit 23358ff87003fd6603c0ca19bc37f31944d2c494&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T15:41:24Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8791&quot; title=&quot;Fix documentation on how to link dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8791&quot;&gt;&lt;del&gt;FLINK-8791&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;docs&amp;#93;&lt;/span&gt; Fix documentation about configuring dependencies&lt;/p&gt;

&lt;p&gt;commit acf114793c708f0ab207008c25195f6f65796e5f&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-21T15:02:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8730&quot; title=&quot;Make SerializedThrowable deserialized from JSON re-throwable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8730&quot;&gt;&lt;del&gt;FLINK-8730&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt; JSON serialize entire SerializedThrowable&lt;/p&gt;

&lt;p&gt;    Do not only serialize the serialized exception but the entire&lt;br/&gt;
    SerializedThrowable object. This makes it possible to throw the&lt;br/&gt;
    SerializedThrowable itself without deserializing it.&lt;/p&gt;

&lt;p&gt;    This closes #5546.&lt;/p&gt;

&lt;p&gt;commit 2f6cb37c775106bb684ef9c608585e7a72056460&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-27T15:58:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8787&quot; title=&quot;Deploying FLIP-6 YARN session with HA fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8787&quot;&gt;&lt;del&gt;FLINK-8787&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;flip6&amp;#93;&lt;/span&gt; Do not copy flinkConfiguration in AbstractYarnClusterDescriptor&lt;/p&gt;

&lt;p&gt;    This closes #5591.&lt;/p&gt;

&lt;p&gt;commit 51d5bc6c5151c2aed3f932f84c35da43689501ec&lt;br/&gt;
Author: vinoyang &amp;lt;vinoyang@...&amp;gt;&lt;br/&gt;
Date:   2018-02-27T06:43:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8792&quot; title=&quot; bad semantic of method name MessageQueryParameter.convertStringToValue &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8792&quot;&gt;&lt;del&gt;FLINK-8792&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;rest&amp;#93;&lt;/span&gt; Change MessageQueryParameter.convertStringToValue to convertValueToString&lt;/p&gt;

&lt;p&gt;    This closes #5587.&lt;/p&gt;

&lt;p&gt;commit 08e615027acd426537dc580139a61bd4082b7c3f&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T09:11:44Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8792&quot; title=&quot; bad semantic of method name MessageQueryParameter.convertStringToValue &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8792&quot;&gt;&lt;del&gt;FLINK-8792&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;rest&amp;#93;&lt;/span&gt; Change MessageQueryParameter#convertValueFromString to convertStringToValue&lt;/p&gt;

&lt;p&gt;commit 302aaeb021bacf3f37cb9a3ee236304c94adbf30&lt;br/&gt;
Author: Timo Walther &amp;lt;twalthr@...&amp;gt;&lt;br/&gt;
Date:   2018-02-22T16:22:54Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8451&quot; title=&quot;CaseClassSerializer is not backwards compatible in 1.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8451&quot;&gt;&lt;del&gt;FLINK-8451&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;serializers&amp;#93;&lt;/span&gt; Make Scala tuple serializer deserialization more failure tolerant&lt;/p&gt;

&lt;p&gt;    This closes #5567.&lt;/p&gt;

&lt;p&gt;commit 59b607b0c411b7d01b97db302d0f124b28ef0d0e&lt;br/&gt;
Author: sihuazhou &amp;lt;summerleafs@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T02:54:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8777&quot; title=&quot;improve resource release when recovery from failover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8777&quot;&gt;&lt;del&gt;FLINK-8777&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;checkpointing&amp;#93;&lt;/span&gt; Cleanup local state more eagerly in recovery&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 296f9ff)&lt;/p&gt;

&lt;p&gt;commit cf854ccbc6fdbf112095c471705c8799aee64a45&lt;br/&gt;
Author: Aljoscha Krettek &amp;lt;aljoscha.krettek@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T14:35:13Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; Enable FILESYTEM_DEFAULT_OVERRIDE in FLIP-6 MiniClusterResource&lt;/p&gt;

&lt;p&gt;commit 623e94459795a191703b880fcfa4f162c92ae458&lt;br/&gt;
Author: Stefan Richter &amp;lt;s.richter@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T13:25:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8557&quot; title=&quot;OperatorSubtaskDescriptionText causes failures on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8557&quot;&gt;&lt;del&gt;FLINK-8557&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;checkpointing&amp;#93;&lt;/span&gt; Remove illegal characters from operator description text before using it to construct the instance directory in RocksDB&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 66474da)&lt;/p&gt;

&lt;p&gt;commit bb459cc68f8dc4bd042b61e365e583d4e96b3e0e&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T10:37:37Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Deduplicate code in SingleInputGateTest&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 67a547a)&lt;/p&gt;

&lt;p&gt;commit 6b7a4480ef8610df3ff21eb2811b9a0a3c58c912&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T11:11:14Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Remove duplicated check&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 42f71f6)&lt;/p&gt;

&lt;p&gt;commit 651462e6b22c51ce14bd9ea6db389ef6a1f38e55&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T10:20:21Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8760&quot; title=&quot;Correctly set `moreAvailable` flag in SingleInputGate and UnionInputGate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8760&quot;&gt;&lt;del&gt;FLINK-8760&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Correctly propagate moreAvailable flag through SingleInputGate&lt;/p&gt;

&lt;p&gt;    Previously if we SingleInputGate was re-eqnqueuing an input channel, isMoreAvailable&lt;br/&gt;
    might incorrectly return false. This might caused some dead locks.&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 6c9e267)&lt;/p&gt;

&lt;p&gt;commit 8e62f90739e2319491df983917dc7ab484de2550&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T10:27:54Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Do not hide original exception in SuccessAfterNetworkBuffersFailureITCase&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 2c2e189)&lt;/p&gt;

&lt;p&gt;commit 8eb6a30798c09d171e3eb8019b53e677252bd5ba&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T10:28:20Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8694&quot; title=&quot;Make notifyDataAvailable call reliable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8694&quot;&gt;&lt;del&gt;FLINK-8694&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Fix notifyDataAvailable race condition&lt;/p&gt;

&lt;p&gt;    Before there was a race condition that might resulted in igonoring some notifyDataAvailable calls.&lt;br/&gt;
    This fixes the problem by moving buffersAvailable handling to Supartitions and adds stress test&lt;br/&gt;
    for flushAlways (without this fix this test is dead locking).&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit ebd39f3)&lt;/p&gt;

&lt;p&gt;commit 61a34a691e7d5233f18ac72a1ab8fb09b53c4753&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T15:13:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8805&quot; title=&quot;Optimize EventSerializer.isEvent method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8805&quot;&gt;&lt;del&gt;FLINK-8805&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Optimize EvenSerializer.isEvent method&lt;/p&gt;

&lt;p&gt;    For example, previously if the method was used to check for EndOfPartitionEvent&lt;br/&gt;
    and the Buffer contained huge custom event, the even had to be deserialized before&lt;br/&gt;
    performing the actual check. Now we are quickly entering the correct if/else branch&lt;br/&gt;
    and doing full costly deserialization only if we have to.&lt;/p&gt;

&lt;p&gt;    Other calls to isEvent() then checking against EndOfPartitionEvent were not used.&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 767027f)&lt;/p&gt;

&lt;p&gt;commit d5338c4154e5de029b3b30e3ef0a0732bf7f68e7&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@...&amp;gt;&lt;br/&gt;
Date:   2018-02-27T09:39:00Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8750&quot; title=&quot;InputGate may contain data after an EndOfPartitionEvent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8750&quot;&gt;&lt;del&gt;FLINK-8750&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Improve detection of no remaining data after EndOfPartitionEvent&lt;/p&gt;

&lt;p&gt;    Because of race condition between:&lt;br/&gt;
      1. releasing inputChannelsWithData lock in this method and reaching this place&lt;br/&gt;
      2. empty data notification that re-enqueues a channel&lt;br/&gt;
    we can end up with moreAvailable flag set to true, while we expect no more data.&lt;/p&gt;

&lt;p&gt;    This commit detects such situation, makes a correct assertion and turn off moreAvailable flag.&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit b9b7416)&lt;/p&gt;

&lt;p&gt;commit 32384ed9b00cf0e1961d355dc4080f25a2156e58&lt;br/&gt;
Author: Zhijiang &amp;lt;wangzhijiang999@...&amp;gt;&lt;br/&gt;
Date:   2018-02-22T14:41:38Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8747&quot; title=&quot;The tag of waiting for floating buffers in RemoteInputChannel should be updated properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8747&quot;&gt;&lt;del&gt;FLINK-8747&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bugfix&amp;#93;&lt;/span&gt; The tag of waiting for floating buffers in RemoteInputChannel should be updated properly&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 6e9e0dd)&lt;/p&gt;

&lt;p&gt;commit f1453276095c55264f7b4097d16e2987a44b3f33&lt;br/&gt;
Author: Zhijiang &amp;lt;wangzhijiang999@...&amp;gt;&lt;br/&gt;
Date:   2018-02-23T01:55:57Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; Fix package private and comments&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 6165b3d)&lt;/p&gt;

&lt;p&gt;commit 18ff2ce15bdb1e7bd246e438e47527a24559c86d&lt;br/&gt;
Author: Nico Kruber &amp;lt;nico@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T16:50:10Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;network&amp;#93;&lt;/span&gt; minor improvements in UnionInputGate&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit 4203557)&lt;/p&gt;

&lt;p&gt;commit 9265666517830350a4a7037029e347f33df1bea2&lt;br/&gt;
Author: Nico Kruber &amp;lt;nico@...&amp;gt;&lt;br/&gt;
Date:   2018-02-26T16:52:37Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8737&quot; title=&quot;Creating a union of UnionGate instances will fail with UnsupportedOperationException when retrieving buffers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8737&quot;&gt;&lt;del&gt;FLINK-8737&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;network&amp;#93;&lt;/span&gt; disallow creating a union of UnionInputGate instances&lt;/p&gt;

&lt;p&gt;    Recently, the pollNextBufferOrEvent() was added but not implemented but this is&lt;br/&gt;
    used in getNextBufferOrEvent() and thus any UnionInputGate containing a UnionInputGate&lt;br/&gt;
    would have failed already. There should be no use case for wiring up inputs&lt;br/&gt;
    this way. Therefore, fail early when trying to construct this.&lt;/p&gt;

&lt;p&gt;    (cherry picked from commit e8de538)&lt;/p&gt;

&lt;p&gt;commit 26c8f6c2a3ff75ffb954c816a57908318a2d8099&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T11:15:30Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Fix SelfConnectionITCase&lt;/p&gt;

&lt;p&gt;    The test previously did not fail on failed execution, and thus evaluated incomplete results&lt;br/&gt;
    from a failed execution with th expected results.&lt;/p&gt;

&lt;p&gt;    This cleans up serialization warnings and uses lambdas where possible, to make the code&lt;br/&gt;
    more readable.&lt;/p&gt;

&lt;p&gt;commit f60e46dafa8950d5e40cd8a3286c172ecaea6b73&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T12:04:19Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; Add missing space to log message in ZooKeeperLeaderElectionService&lt;/p&gt;

&lt;p&gt;commit b7247929d0745b3b83306d0c93d97faf4ece4107&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T12:06:00Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Javadoc&amp;#93;&lt;/span&gt; Fix typo in YARN Utils: teh -&amp;gt; the&lt;/p&gt;

&lt;p&gt;commit adb3750226971f7c67a0d3069103b56e4fee1c27&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T12:07:04Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Javadoc&amp;#93;&lt;/span&gt; Fix typo in YarnTestBase: teh -&amp;gt; the&lt;/p&gt;

&lt;p&gt;commit 94bbd564ce5214b3366cc6d299fcb99ae62a2bd8&lt;br/&gt;
Author: gyao &amp;lt;gary@...&amp;gt;&lt;br/&gt;
Date:   2018-02-28T12:08:25Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Fix wrong assertEquals in YARNSessionCapacitySchedulerITCase&lt;/p&gt;

&lt;p&gt;    Test swapped actual and expected arguments.&lt;br/&gt;
    Remove catching Throwable in test; instead propagate all exceptions.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16447221" author="githubbot" created="Sun, 22 Apr 2018 12:41:39 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5748&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I was unsure initially, because we tried hard to avoid the checkpoint lock during shutdown/cancellation before (some timer / user thread might hold the lock)...&lt;/p&gt;

&lt;p&gt;    The changes to the network stack (use fewer other locks) seem to make this one here strictly necessary though. I could not yet think of another way to do this. We also have better cancellation safety nets in place now, which should help...&lt;/p&gt;</comment>
                            <comment id="16447222" author="githubbot" created="Sun, 22 Apr 2018 12:41:52 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5748&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    So, +1, merging this...&lt;/p&gt;</comment>
                            <comment id="16447360" author="githubbot" created="Sun, 22 Apr 2018 20:43:08 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5748&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16447572" author="stephanewen" created="Mon, 23 Apr 2018 04:57:17 +0000"  >&lt;p&gt;Fixed in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.5.0 via 814d9ea7674cdc4ff32f04807f1c4e8375064425&lt;/li&gt;
	&lt;li&gt;1.6.0 via 53809689cb0ce432a7a47f8a5ba1be8686e5349a&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rn13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>