<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-31414] exceptions in the alignment timer are ignored</title>
                <link>https://issues.apache.org/jira/browse/FLINK-31414</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Alignment timer task in alternating aligned checkpoint run as a future task in mailbox thread, causing the exceptions (&lt;a href=&quot;https://github.com/apache/flink/blob/65ab8e820a3714d2134dfb4c9772a10c998bd45a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/SingleCheckpointBarrierHandler.java#L327&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SingleCheckpointBarrierHandler#registerAlignmentTimer()&lt;/a&gt;) to be ignored. These exceptions should have failed the task, but now this will cause the same checkpoint to fire twice initInputsCheckpoints in my test.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 switched from RUNNING to FAILED with failure cause: java.lang.RuntimeException: unable to send request to worker
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.enqueue(ChannelStateWriterImpl.java:247)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.addInputData(ChannelStateWriterImpl.java:161)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.prepareSnapshot(StreamTaskNetworkInput.java:103)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.prepareSnapshot(StreamOneInputProcessor.java:83)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.StreamMultipleInputProcessor.prepareSnapshot(StreamMultipleInputProcessor.java:122)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.prepareInputSnapshot(StreamTask.java:518)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.prepareInflightDataSnapshot(SubtaskCheckpointCoordinatorImpl.java:655)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.initInputsCheckpoint(SubtaskCheckpointCoordinatorImpl.java:515)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler$ControllerImpl.initInputsCheckpoint(SingleCheckpointBarrierHandler.java:516)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.AlternatingCollectingBarriers.alignmentTimeout(AlternatingCollectingBarriers.java:46)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.AbstractAlternatingAlignedBarrierHandlerState.barrierReceived(AbstractAlternatingAlignedBarrierHandlerState.java:54)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.lambda$processBarrier$2(SingleCheckpointBarrierHandler.java:234)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.markCheckpointAlignedAndTransformState(SingleCheckpointBarrierHandler.java:262)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.processBarrier(SingleCheckpointBarrierHandler.java:231)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.CheckpointedInputGate.handleEvent(CheckpointedInputGate.java:181)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.CheckpointedInputGate.pollNext(CheckpointedInputGate.java:159)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.emitNext(AbstractStreamTaskNetworkInput.java:110)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.io.StreamMultipleInputProcessor.processInput(StreamMultipleInputProcessor.java:85)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:542)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:231)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:831)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:780)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:935)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:914)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:728)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.run(Task.java:550)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&#160; &#160; &#160; &#160; Suppressed: java.io.IOException: java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.close(ChannelStateWriteRequestExecutorImpl.java:175)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.close(ChannelStateWriterImpl.java:235)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.cancel(SubtaskCheckpointCoordinatorImpl.java:564)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.close(SubtaskCheckpointCoordinatorImpl.java:551)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.util.IOUtils.closeAll(IOUtils.java:255)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.core.fs.AutoCloseableRegistry.doClose(AutoCloseableRegistry.java:72)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.util.AbstractAutoCloseableRegistry.close(AbstractAutoCloseableRegistry.java:127)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.cleanUp(StreamTask.java:943)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.lambda$restoreAndInvoke$0(Task.java:917)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:935)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:917)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ... 3 more
&#160; &#160; &#160; &#160; Caused by: java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.util.Preconditions.checkState(Preconditions.java:193)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatchInternal(ChannelStateWriteRequestDispatcherImpl.java:75)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatch(ChannelStateWriteRequestDispatcherImpl.java:62)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.loop(ChannelStateWriteRequestExecutorImpl.java:96)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.run(ChannelStateWriteRequestExecutorImpl.java:75)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ... 1 more
Caused by: java.lang.IllegalStateException: not running
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.ensureRunning(ChannelStateWriteRequestExecutorImpl.java:152)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.submitInternal(ChannelStateWriteRequestExecutorImpl.java:144)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.submit(ChannelStateWriteRequestExecutorImpl.java:128)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.enqueue(ChannelStateWriterImpl.java:244)
&#160; &#160; &#160; &#160; ... 27 more
&#160; &#160; &#160; &#160; [CIRCULAR REFERENCE:java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;see : &lt;a href=&quot;https://github.com/apache/flink/blob/65ab8e820a3714d2134dfb4c9772a10c998bd45a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/BarrierAlignmentUtil.java#L50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BarrierAlignmentUtil#createRegisterTimerCallback()&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13528186">FLINK-31414</key>
            <summary>exceptions in the alignment timer are ignored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Feifan Wang">Feifan Wang</assignee>
                                    <reporter username="Feifan Wang">Feifan Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 13 Mar 2023 07:23:17 +0000</created>
                <updated>Wed, 15 Mar 2023 10:54:43 +0000</updated>
                            <resolved>Wed, 15 Mar 2023 10:18:17 +0000</resolved>
                                    <version>1.13.6</version>
                    <version>1.14.6</version>
                    <version>1.15.3</version>
                    <version>1.16.1</version>
                                    <fixVersion>1.16.2</fixVersion>
                    <fixVersion>1.18.0</fixVersion>
                    <fixVersion>1.17.1</fixVersion>
                                    <component>Runtime / Checkpointing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17699499" author="martijnvisser" created="Mon, 13 Mar 2023 07:47:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; WDYT?&lt;/p&gt;</comment>
                            <comment id="17699776" author="pnowojski" created="Mon, 13 Mar 2023 18:05:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Feifan+Wang&quot; class=&quot;user-hover&quot; rel=&quot;Feifan Wang&quot;&gt;Feifan Wang&lt;/a&gt;, can you elaborate a bit more what&apos;s the problem? I see a couple of discrepancies in your description and the stack trace that you posted:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the stack trace doesn&apos;t match to the master code, so I&apos;m not sure what Flink version you are using?&lt;/li&gt;
	&lt;li&gt;doesn&apos;t the error message &quot;switched from RUNNING to FAILED&quot; refer to actually subtask/task switching to FAILED state, contradicting your statement that the exception is being ignored?&lt;/li&gt;
	&lt;li&gt;in the PR, I don&apos;t see a test coverage - a working unit test/ITCase that used to be failing without your fix would be nice to have. Both for explaining what is the issue and for actually providing regression test coverage&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17699928" author="feifan wang" created="Tue, 14 Mar 2023 03:28:10 +0000"  >&lt;p&gt;Thanks for reply &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; , sorry for the lack of clarity in the previous description, let me answer your question first :&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;the stack trace doesn&apos;t match to the master code, so I&apos;m not sure what Flink version you are using?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;based on &lt;b&gt;release-1.16.1&lt;/b&gt; , cherry-picked some bug fix.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;doesn&apos;t the error message &quot;switched from RUNNING to FAILED&quot; refer to actually subtask/task switching to FAILED state, contradicting your statement that the exception is being ignored?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, it is a subtask switching to FAILED state. I mean the exception thrown in the alignment timer task is being ignored, causing the subtask thread to continue executing to trigger the exception I posted above.&lt;/p&gt;

&lt;p&gt;Here is the more complete log ( I change some log level from debug to info ) :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2023-03-10 12:09:42,416 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 (cb2e56879557c676c9897cda44fe3c9e_4f7e0f4c19a43f929bda6907ee1f3150_4516_1): Received barrier from channel InputChannelInfo{gateIdx=1, inputChannelIdx=586} @ 17.
2023-03-10 12:09:42,673 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 starting checkpoint 17 (CheckpointOptions{checkpointType=CheckpointType{name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Checkpoint&apos;&lt;/span&gt;, sharingFilesStrategy=FORWARD_BACKWARD}, targetLocation=(&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;), alignmentType=UNALIGNED, alignedCheckpointTimeout=9223372036854775807})
2023-03-10 12:09:42,673 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 put ChannelStateWriteResult : 17
2023-03-10 12:09:42,675 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 (cb2e56879557c676c9897cda44fe3c9e_4f7e0f4c19a43f929bda6907ee1f3150_4516_1): Triggering checkpoint 17 on the barrier announcement at 1678421367671.
2023-03-10 12:09:42,675 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.tasks.StreamTask &#160; &#160; &#160; &#160; &#160; - triggerCheckpointOnBarrier Starting checkpoint 17 CheckpointType{name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Checkpoint&apos;&lt;/span&gt;, sharingFilesStrategy=FORWARD_BACKWARD} on task MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1
2023-03-10 12:09:42,675 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.tasks.StreamTask &#160; &#160; &#160; &#160; &#160; - Starting checkpoint 17 CheckpointType{name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Checkpoint&apos;&lt;/span&gt;, sharingFilesStrategy=FORWARD_BACKWARD} on task MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1
2023-03-10 12:09:42,675 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 requested write result, checkpoint 17
2023-03-10 12:09:42,676 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.state.changelog.ChangelogKeyedStateBackend &#160; - snapshot of MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; checkpoint 17, change range: 39..46, materialization ID 4
2023-03-10 12:09:42,677 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.tasks.RegularOperatorChain &#160;- Could not complete snapshot 17 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1. Failure reason: Checkpoint was declined.
org.apache.flink.runtime.checkpoint.CheckpointException: Could not complete snapshot 17 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1. Failure reason: Checkpoint was declined.
&#160; &#160; at org.apache.flink.streaming.api.operators.StreamOperatorStateHandler.snapshotState(StreamOperatorStateHandler.java:269)
&#160; &#160; at org.apache.flink.streaming.api.operators.StreamOperatorStateHandler.snapshotState(StreamOperatorStateHandler.java:173)
&#160; &#160; at org.apache.flink.streaming.api.operators.AbstractStreamOperator.snapshotState(AbstractStreamOperator.java:345)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.checkpointStreamOperator(RegularOperatorChain.java:228)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.buildOperatorSnapshotFutures(RegularOperatorChain.java:213)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.snapshotState(RegularOperatorChain.java:192)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.takeSnapshotSync(SubtaskCheckpointCoordinatorImpl.java:730)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.checkpointState(SubtaskCheckpointCoordinatorImpl.java:363)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$performCheckpoint$13(StreamTask.java:1291)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.runThrowing(StreamTaskActionExecutor.java:50)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.performCheckpoint(StreamTask.java:1279)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.triggerCheckpointOnBarrier(StreamTask.java:1236)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.CheckpointBarrierHandler.notifyCheckpoint(CheckpointBarrierHandler.java:147)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.triggerCheckpoint(SingleCheckpointBarrierHandler.java:287)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.access$100(SingleCheckpointBarrierHandler.java:64)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler$ControllerImpl.triggerGlobalCheckpoint(SingleCheckpointBarrierHandler.java:489)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.AlternatingCollectingBarriers.alignmentTimeout(AlternatingCollectingBarriers.java:50)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.lambda$registerAlignmentTimer$3(SingleCheckpointBarrierHandler.java:321)
&#160; &#160; at java.util.concurrent.FutureTask.run(FutureTask.java:266)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.runThrowing(StreamTaskActionExecutor.java:50)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:90)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMail(MailboxProcessor.java:398)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.processMailsWhenDefaultActionUnavailable(MailboxProcessor.java:367)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.processMail(MailboxProcessor.java:352)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:229)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:831)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:780)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:935)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:914)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:728)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.run(Task.java:550)
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
Caused by: java.io.IOException: The upload &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 44 has already failed previously
&#160; &#160; at org.apache.flink.changelog.fs.FsStateChangelogWriter.ensureCanPersist(FsStateChangelogWriter.java:429)
&#160; &#160; at org.apache.flink.changelog.fs.FsStateChangelogWriter.persistInternal(FsStateChangelogWriter.java:213)
&#160; &#160; at org.apache.flink.changelog.fs.FsStateChangelogWriter.persist(FsStateChangelogWriter.java:208)
&#160; &#160; at org.apache.flink.state.changelog.ChangelogKeyedStateBackend.snapshot(ChangelogKeyedStateBackend.java:402)
&#160; &#160; at org.apache.flink.streaming.api.operators.StreamOperatorStateHandler.snapshotState(StreamOperatorStateHandler.java:246)
&#160; &#160; ... 31 more
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.protocol.FSLimitException$MaxDirectoryItemsExceededException): The directory item limit of /flink-yg-test01/feifan-changelog-test/dstl/460359d4d9311744142797ba23e69d16/dstl is exceeded: limit=1048576 items=1048576
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSDirectory.verifyMaxDirItems(FSDirectory.java:1056)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSDirectory.addLastINode(FSDirectory.java:1101)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSDirectory.addINode(FSDirectory.java:967)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSDirectory.addFile(FSDirectory.java:531)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInternal(FSNamesystem.java:2997)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInt(FSNamesystem.java:2856)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:2691)
&#160; &#160; at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.create(NameNodeRpcServer.java:815)
&#160; &#160; at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.create(ClientNamenodeProtocolServerSideTranslatorPB.java:450)
&#160; &#160; at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
&#160; &#160; at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:713)
&#160; &#160; at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:975)
&#160; &#160; at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1002)
&#160; &#160; at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:923)
&#160; &#160; at java.security.AccessController.doPrivileged(Native Method)
&#160; &#160; at javax.security.auth.Subject.doAs(Subject.java:422)
&#160; &#160; at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1726)
&#160; &#160; at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2786)&#160; &#160; at org.apache.hadoop.ipc.Client.call(Client.java:1578)
&#160; &#160; at org.apache.hadoop.ipc.Client.call(Client.java:1505)
&#160; &#160; at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
&#160; &#160; at com.sun.proxy.$Proxy22.create(Unknown Source)
&#160; &#160; at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.create(ClientNamenodeProtocolTranslatorPB.java:332)
&#160; &#160; at sun.reflect.GeneratedMethodAccessor181.invoke(Unknown Source)
&#160; &#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
&#160; &#160; at java.lang.reflect.Method.invoke(Method.java:498)
&#160; &#160; at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:252)
&#160; &#160; at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:104)
&#160; &#160; at com.sun.proxy.$Proxy23.create(Unknown Source)
&#160; &#160; at sun.reflect.GeneratedMethodAccessor181.invoke(Unknown Source)
&#160; &#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
&#160; &#160; at java.lang.reflect.Method.invoke(Method.java:498)
&#160; &#160; at org.apache.hadoop.hdfs.RpcResponseHandler.invoke(RpcResponseHandler.java:55)
&#160; &#160; at com.sun.proxy.$Proxy23.create(Unknown Source)
&#160; &#160; at org.apache.hadoop.hdfs.DFSOutputStream.newStreamForCreate(DFSOutputStream.java:1982)
&#160; &#160; at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1937)
&#160; &#160; at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1871)
&#160; &#160; at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:452)
&#160; &#160; at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:448)
&#160; &#160; at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
&#160; &#160; at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:448)
&#160; &#160; at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:391)
&#160; &#160; at org.apache.hadoop.fs.FilterFileSystem.create(FilterFileSystem.java:179)
&#160; &#160; at org.apache.hadoop.fs.viewfs.ChRootedFileSystem.create(ChRootedFileSystem.java:189)
&#160; &#160; at org.apache.hadoop.fs.viewfs.ViewFileSystem.create(ViewFileSystem.java:323)
&#160; &#160; at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1027)
&#160; &#160; at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1008)
&#160; &#160; at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:905)
&#160; &#160; at org.apache.flink.runtime.fs.hdfs.HadoopFileSystem.create(HadoopFileSystem.java:154)
&#160; &#160; at org.apache.flink.runtime.fs.hdfs.HadoopFileSystem.create(HadoopFileSystem.java:37)
&#160; &#160; at org.apache.flink.changelog.fs.DuplicatingStateChangeFsUploader.prepareStream(DuplicatingStateChangeFsUploader.java:96)
&#160; &#160; at org.apache.flink.changelog.fs.AbstractStateChangeFsUploader.uploadInternal(AbstractStateChangeFsUploader.java:76)
&#160; &#160; at org.apache.flink.changelog.fs.AbstractStateChangeFsUploader.upload(AbstractStateChangeFsUploader.java:69)
&#160; &#160; at org.apache.flink.changelog.fs.BatchingStateChangeUploadScheduler$1.tryExecute(BatchingStateChangeUploadScheduler.java:310)
&#160; &#160; at org.apache.flink.changelog.fs.BatchingStateChangeUploadScheduler$1.tryExecute(BatchingStateChangeUploadScheduler.java:307)
&#160; &#160; at org.apache.flink.changelog.fs.RetryingExecutor$RetriableActionAttempt.run(RetryingExecutor.java:225)
&#160; &#160; at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
&#160; &#160; at java.util.concurrent.FutureTask.run(FutureTask.java:266)
&#160; &#160; at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
&#160; &#160; at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
&#160; &#160; at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
&#160; &#160; at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
&#160; &#160; ... 1 more
2023-03-10 12:09:42,677 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 aborting, checkpoint 17, cleanup:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2023-03-10 12:09:42,723 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 (cb2e56879557c676c9897cda44fe3c9e_4f7e0f4c19a43f929bda6907ee1f3150_4516_1): Received barrier from channel InputChannelInfo{gateIdx=0, inputChannelIdx=324} @ 17.
2023-03-10 12:09:42,723 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 starting checkpoint 17 (CheckpointOptions{checkpointType=CheckpointType{name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Checkpoint&apos;&lt;/span&gt;, sharingFilesStrategy=FORWARD_BACKWARD}, targetLocation=(&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;), alignmentType=UNALIGNED, alignedCheckpointTimeout=9223372036854775807})
2023-03-10 12:09:42,724 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 put ChannelStateWriteResult : 17
2023-03-10 12:09:42,724 INFO &#160;[Channel state writer MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 discarding 645 drained requests
2023-03-10 12:09:42,724 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 discarding 1023 drained requests
2023-03-10 12:09:42,725 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.state.common.PeriodicMaterializationManager &#160;- Shutting down PeriodicMaterializationManager.
2023-03-10 12:09:42,725 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 aborting, checkpoint 17, cleanup:&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2023-03-10 12:09:42,726 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl &#160;- MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 discarding 1 drained requests
2023-03-10 12:09:43,099 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.contrib.streaming.state.RocksDBKeyedStateBackend &#160;- Closed RocksDB State Backend. Cleaning up RocksDB working directory /data1/hadoop/yarn/nm-local-dir/usercache/hadoop-rt/appcache/application_1671247042382_4677267/tm_container_e74_1671247042382_4677267_01_000039/tmp/job_460359d4d9311744142797ba23e69d16_op_KeyedCoProcessOperator_4f7e0f4c19a43f929bda6907ee1f3150__4517_4800__uuid_785a6359-d191-4691-9272-d0590d2d696b.
2023-03-10 12:09:43,125 WARN &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.taskmanager.Task &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; - MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 (cb2e56879557c676c9897cda44fe3c9e_4f7e0f4c19a43f929bda6907ee1f3150_4516_1) switched from RUNNING to FAILED with failure cause: java.lang.RuntimeException: unable to send request to worker
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.enqueue(ChannelStateWriterImpl.java:247)
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.addInputData(ChannelStateWriterImpl.java:161)
&#160; &#160; at org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.prepareSnapshot(StreamTaskNetworkInput.java:103)
&#160; &#160; at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.prepareSnapshot(StreamOneInputProcessor.java:83)
&#160; &#160; at org.apache.flink.streaming.runtime.io.StreamMultipleInputProcessor.prepareSnapshot(StreamMultipleInputProcessor.java:122)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.prepareInputSnapshot(StreamTask.java:518)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.prepareInflightDataSnapshot(SubtaskCheckpointCoordinatorImpl.java:655)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.initInputsCheckpoint(SubtaskCheckpointCoordinatorImpl.java:515)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler$ControllerImpl.initInputsCheckpoint(SingleCheckpointBarrierHandler.java:516)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.AlternatingCollectingBarriers.alignmentTimeout(AlternatingCollectingBarriers.java:46)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.AbstractAlternatingAlignedBarrierHandlerState.barrierReceived(AbstractAlternatingAlignedBarrierHandlerState.java:54)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.lambda$processBarrier$2(SingleCheckpointBarrierHandler.java:234)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.markCheckpointAlignedAndTransformState(SingleCheckpointBarrierHandler.java:262)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.SingleCheckpointBarrierHandler.processBarrier(SingleCheckpointBarrierHandler.java:231)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.CheckpointedInputGate.handleEvent(CheckpointedInputGate.java:181)
&#160; &#160; at org.apache.flink.streaming.runtime.io.checkpointing.CheckpointedInputGate.pollNext(CheckpointedInputGate.java:159)
&#160; &#160; at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.emitNext(AbstractStreamTaskNetworkInput.java:110)
&#160; &#160; at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65)
&#160; &#160; at org.apache.flink.streaming.runtime.io.StreamMultipleInputProcessor.processInput(StreamMultipleInputProcessor.java:85)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:542)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:231)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:831)
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:780)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:935)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:914)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:728)
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.run(Task.java:550)
&#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&#160; &#160; Suppressed: java.io.IOException: java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.close(ChannelStateWriteRequestExecutorImpl.java:175)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.close(ChannelStateWriterImpl.java:235)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.cancel(SubtaskCheckpointCoordinatorImpl.java:564)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinatorImpl.close(SubtaskCheckpointCoordinatorImpl.java:551)
&#160; &#160; &#160; &#160; at org.apache.flink.util.IOUtils.closeAll(IOUtils.java:255)
&#160; &#160; &#160; &#160; at org.apache.flink.core.fs.AutoCloseableRegistry.doClose(AutoCloseableRegistry.java:72)
&#160; &#160; &#160; &#160; at org.apache.flink.util.AbstractAutoCloseableRegistry.close(AbstractAutoCloseableRegistry.java:127)
&#160; &#160; &#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.cleanUp(StreamTask.java:943)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.lambda$restoreAndInvoke$0(Task.java:917)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:935)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:917)
&#160; &#160; &#160; &#160; ... 3 more
&#160; &#160; Caused by: java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17
&#160; &#160; &#160; &#160; at org.apache.flink.util.Preconditions.checkState(Preconditions.java:193)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatchInternal(ChannelStateWriteRequestDispatcherImpl.java:75)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatch(ChannelStateWriteRequestDispatcherImpl.java:62)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.loop(ChannelStateWriteRequestExecutorImpl.java:96)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.run(ChannelStateWriteRequestExecutorImpl.java:75)
&#160; &#160; &#160; &#160; ... 1 more
Caused by: java.lang.IllegalStateException: not running
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.ensureRunning(ChannelStateWriteRequestExecutorImpl.java:152)
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.submitInternal(ChannelStateWriteRequestExecutorImpl.java:144)
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.submit(ChannelStateWriteRequestExecutorImpl.java:128)
&#160; &#160; at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl.enqueue(ChannelStateWriterImpl.java:244)
&#160; &#160; ... 27 more
&#160; &#160; [CIRCULAR REFERENCE:java.lang.IllegalStateException: writer not found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; request start 17]
2023-03-10 12:09:43,125 INFO &#160;[MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1] org.apache.flink.runtime.taskmanager.Task &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; - Freeing task resources &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; MV_J_PV -&amp;amp;gt; mv-join-after-&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; -&amp;amp;gt; extract-event-identifier (4517/4800)#1 (cb2e56879557c676c9897cda44fe3c9e_4f7e0f4c19a43f929bda6907ee1f3150_4516_1). &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Later I will try to write a test to explain the problem.&lt;/p&gt;</comment>
                            <comment id="17700024" author="pnowojski" created="Tue, 14 Mar 2023 08:49:20 +0000"  >&lt;p&gt;Ah thanks for the explanation, I understand the problem now. I see that bug has been in the code base since at least &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-19682&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-19682&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="17700596" author="pnowojski" created="Wed, 15 Mar 2023 10:18:17 +0000"  >&lt;p&gt;merged commit cbfeef6 to master&lt;br/&gt;
0dfb5abf038 to release-1.17&lt;br/&gt;
f2f9104dc46 to release-1.16&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gj00:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>