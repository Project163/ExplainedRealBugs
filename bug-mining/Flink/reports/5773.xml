<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:00:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24003] Lookback mode doesn&apos;t work when mixing use of Python Table API and Python DataStream API</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24003</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;For the following program:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; logging
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; time

from pyflink.common.typeinfo &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; Types
from pyflink.datastream &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; StreamExecutionEnvironment, CoMapFunction
from pyflink.table &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; StreamTableEnvironment, DataTypes, Schema


def test_chaining():
    env = StreamExecutionEnvironment.get_execution_environment()
    t_env = StreamTableEnvironment.create(stream_execution_environment=env)
    t_env.get_config().get_configuration().set_boolean(&lt;span class=&quot;code-quote&quot;&gt;&quot;python.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;-chaining.enabled&quot;&lt;/span&gt;, False)

    # 1. create source Table
    t_env.execute_sql(&quot;&quot;&quot;
        CREATE TABLE datagen (
            id INT,
            data STRING
        ) WITH (
            &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;datagen&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;rows-per-second&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1000000&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.kind&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;sequence&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.start&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.end&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;1000&apos;&lt;/span&gt;
        )
    &quot;&quot;&quot;)

    # 2. create sink Table
    t_env.execute_sql(&quot;&quot;&quot;
        CREATE TABLE print (
            id BIGINT,
            data STRING,
            flag STRING
        ) WITH (
            &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;blackhole&apos;&lt;/span&gt;
        )
    &quot;&quot;&quot;)

    t_env.execute_sql(&quot;&quot;&quot;
        CREATE TABLE print_2 (
            id BIGINT,
            data STRING,
            flag STRING
        ) WITH (
            &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;blackhole&apos;&lt;/span&gt;
        )
    &quot;&quot;&quot;)

    # 3. query from source table and perform calculations
    # create a Table from a Table API query:
    source_table = t_env.from_path(&lt;span class=&quot;code-quote&quot;&gt;&quot;datagen&quot;&lt;/span&gt;)

    ds = t_env.to_append_stream(
        source_table,
        Types.ROW([Types.INT(), Types.STRING()]))

    ds1 = ds.map(lambda i: (i[0] * i[0], i[1]))
    ds2 = ds.map(lambda i: (i[0], i[1][2:]))

    &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyCoMapFunction(CoMapFunction):

        def map1(self, value):
            print(&lt;span class=&quot;code-quote&quot;&gt;&apos;hahah&apos;&lt;/span&gt;)
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value

        def map2(self, value):
            print(&lt;span class=&quot;code-quote&quot;&gt;&apos;hahah&apos;&lt;/span&gt;)
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value

    ds3 = ds1.connect(ds2).map(MyCoMapFunction(), output_type=Types.TUPLE([Types.LONG(), Types.STRING()]))

    ds4 = ds3.map(lambda i: (i[0], i[1], &lt;span class=&quot;code-quote&quot;&gt;&quot;left&quot;&lt;/span&gt;),
                  output_type=Types.TUPLE([Types.LONG(), Types.STRING(), Types.STRING()]))

    ds5 = ds3.map(lambda i: (i[0], i[1], &lt;span class=&quot;code-quote&quot;&gt;&quot;right&quot;&lt;/span&gt;))\
             .map(lambda i: i,
                  output_type=Types.TUPLE([Types.LONG(), Types.STRING(), Types.STRING()]))

    schema = Schema.new_builder() \
        .column(&lt;span class=&quot;code-quote&quot;&gt;&quot;f0&quot;&lt;/span&gt;, DataTypes.BIGINT()) \
        .column(&lt;span class=&quot;code-quote&quot;&gt;&quot;f1&quot;&lt;/span&gt;, DataTypes.STRING()) \
        .column(&lt;span class=&quot;code-quote&quot;&gt;&quot;f2&quot;&lt;/span&gt;, DataTypes.STRING()) \
        .build()

    result_table_3 = t_env.from_data_stream(ds4, schema)
    statement_set = t_env.create_statement_set()
    statement_set.add_insert(&lt;span class=&quot;code-quote&quot;&gt;&quot;print&quot;&lt;/span&gt;, result_table_3)

    result_table_4 = t_env.from_data_stream(ds5, schema)
    statement_set.add_insert(&lt;span class=&quot;code-quote&quot;&gt;&quot;print_2&quot;&lt;/span&gt;, result_table_4)

    statement_set.execute().wait()


&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;code-quote&quot;&gt;&quot;__main__&quot;&lt;/span&gt;:

    start_ts = time.time()
    test_chaining()
    end_ts = time.time()
    print(&lt;span class=&quot;code-quote&quot;&gt;&quot;--- %s seconds ---&quot;&lt;/span&gt; % (end_ts - start_ts))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lookback mode doesn&apos;t work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13397554">FLINK-24003</key>
            <summary>Lookback mode doesn&apos;t work when mixing use of Python Table API and Python DataStream API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hxbks2ks">Huang Xingbo</assignee>
                                    <reporter username="dianfu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 26 Aug 2021 12:33:27 +0000</created>
                <updated>Tue, 31 Aug 2021 15:13:34 +0000</updated>
                            <resolved>Tue, 31 Aug 2021 06:11:59 +0000</resolved>
                                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17407097" author="hxbks2ks" created="Tue, 31 Aug 2021 06:12:00 +0000"  >&lt;p&gt;Merged into master via cf08de4db65e0f224abf07673f8bffecda0013fb&lt;br/&gt;
Merged into release-1.14 via 851ed821bdfb68387327b9023e0652c90495cc30&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0uawo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>