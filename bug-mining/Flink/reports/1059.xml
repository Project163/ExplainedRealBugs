<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4141] TaskManager failures not always recover when killed during an ApplicationMaster failure in HA mode on Yarn</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4141</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;High availability on Yarn often fails to recover in the following test scenario:&lt;/p&gt;

&lt;p&gt;1. Kill application master process.&lt;br/&gt;
2. Then, while application master is recovering, randomly kill several task managers (with some delay).&lt;/p&gt;

&lt;p&gt;After the application master recovered, not all the killed task manager are brought back and no further attempts are made the restart them.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12986188">FLINK-4141</key>
            <summary>TaskManager failures not always recover when killed during an ApplicationMaster failure in HA mode on Yarn</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="srichter">Stefan Richter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2016 13:43:06 +0000</created>
                <updated>Fri, 1 Jul 2016 18:12:30 +0000</updated>
                            <resolved>Fri, 1 Jul 2016 18:12:10 +0000</resolved>
                                    <version>1.0.3</version>
                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15359090" author="githubbot" created="Fri, 1 Jul 2016 14:59:20 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2190&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4141&quot; title=&quot;TaskManager failures not always recover when killed during an ApplicationMaster failure in HA mode on Yarn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4141&quot;&gt;&lt;del&gt;FLINK-4141&lt;/del&gt;&lt;/a&gt; remove leaderUpdated() method from ResourceManager&lt;/p&gt;

&lt;p&gt;    This removes the leaderUpdated method from the framework. Further it&lt;br/&gt;
    lets the RM client thread communicate directly with the&lt;br/&gt;
    ResourceManager actor. This is fine since the two are always spawned&lt;br/&gt;
    together. Failures of the ResourceManager actor will lead to dropped&lt;br/&gt;
    messages of the RM client thread. Failures of the RM client thread will&lt;br/&gt;
    inform the JobManager.&lt;/p&gt;

&lt;p&gt;    The leaderUpdated() method was used to signal the ResourceManager&lt;br/&gt;
    framework that a new leader was elected. However, the method was not&lt;br/&gt;
    always called when the leader changed, only when a new leader was&lt;br/&gt;
    elected. This dropped all messages from the async Yarn RM client&lt;br/&gt;
    thread (YarnResourceManagerCallbackHandler) for the time that the old&lt;br/&gt;
    leader had failed and no new leader had been elected. The Yarn RM client&lt;br/&gt;
    thread used leader tagged messages to communicate with the main Flink&lt;br/&gt;
    ResourceManager actor.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4141&quot; title=&quot;TaskManager failures not always recover when killed during an ApplicationMaster failure in HA mode on Yarn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4141&quot;&gt;&lt;del&gt;FLINK-4141&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2190.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2190.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2190&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c758121b9e5e2d7de8318bd529aa5da88ed424c6&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-07-01T14:27:18Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4141&quot; title=&quot;TaskManager failures not always recover when killed during an ApplicationMaster failure in HA mode on Yarn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4141&quot;&gt;&lt;del&gt;FLINK-4141&lt;/del&gt;&lt;/a&gt; remove leaderUpdated() method from ResourceManager&lt;/p&gt;

&lt;p&gt;    This removes the leaderUpdated method from the framework. Further it&lt;br/&gt;
    lets the RM client thread communicate directly with the&lt;br/&gt;
    ResourceManager actor. This is fine since the two are always spawned&lt;br/&gt;
    together. Failures of the ResourceManager actor will lead to dropped&lt;br/&gt;
    messages of the RM client thread. Failures of the RM client thread will&lt;br/&gt;
    inform the JobManager.&lt;/p&gt;

&lt;p&gt;    The leaderUpdated() method was used to signal the ResourceManager&lt;br/&gt;
    framework that a new leader was elected. However, the method was not&lt;br/&gt;
    always called when the leader changed, only when a new leader was&lt;br/&gt;
    elected. This dropped all messages from the async Yarn RM client&lt;br/&gt;
    thread (YarnResourceManagerCallbackHandler) for the time that the old&lt;br/&gt;
    leader had failed and no new leader had been elected. The Yarn RM client&lt;br/&gt;
    thread used leader tagged messages to communicate with the main Flink&lt;br/&gt;
    ResourceManager actor.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15359395" author="mxm" created="Fri, 1 Jul 2016 18:12:10 +0000"  >&lt;p&gt;Resolved with f722b73772eb66cdb79a288300e38ff7026c7e1f&lt;/p&gt;</comment>
                            <comment id="15359398" author="githubbot" created="Fri, 1 Jul 2016 18:12:30 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2190&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30fif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>