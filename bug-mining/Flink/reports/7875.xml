<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:22:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-38035] Security Vulnerability in PyFlink Logging Mechanism (PythonEnvUtils.java)</title>
                <link>https://issues.apache.org/jira/browse/FLINK-38035</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Potential security vulnerability in the logging statement within &lt;tt&gt;PythonEnvUtils.java&lt;/tt&gt; that may expose environment variables &#8212; including Kubernetes-mounted secrets &#8212; during PyFlink job submission.&lt;/p&gt;

&lt;p&gt;The class &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-python/src/main/java/org/apache/flink/client/python/PythonEnvUtils.java#L372-L377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;org.apache.flink.client.python.PythonEnvUtils&lt;/tt&gt;&lt;/a&gt; logs all environment variables at job startup with the following line:&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
&lt;tt&gt;LOG.info(&quot;Starting Python process with environment variables: {}&quot;, environment);&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;&lt;br/&gt;
This line is problematic because it indiscriminately logs &lt;b&gt;all environment variables&lt;/b&gt;, which may contain &lt;b&gt;sensitive credentials&lt;/b&gt;.&lt;/p&gt;
&lt;h4&gt;&lt;a name=&quot;Context%3AKubernetesOperatorUsersAreEspeciallyatRisk&quot;&gt;&lt;/a&gt;&lt;b&gt;Context: Kubernetes Operator Users Are Especially at Risk&lt;/b&gt;&lt;/h4&gt;

&lt;p&gt;When Flink is deployed using the &lt;b&gt;Flink Kubernetes Operator&lt;/b&gt;, secrets are commonly passed into pods as &lt;b&gt;environment variables&lt;/b&gt; (via Kubernetes &lt;tt&gt;env&lt;/tt&gt; or &lt;tt&gt;envFrom&lt;/tt&gt; fields, e.g. from &lt;tt&gt;secretRef&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;This includes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Database credentials&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Cloud service keys (e.g., &lt;tt&gt;AWS_SECRET_ACCESS_KEY&lt;/tt&gt;)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Tokens and encryption keys&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Custom user-defined secrets&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Logging these secrets in plain text within the Flink JobManager or TaskManager logs violates Kubernetes security best practices, which explicitly discourage exposing sensitive environment variables in logs, and poses a serious risk in production environments.&lt;/p&gt;
&lt;h4&gt;&lt;a name=&quot;ProposedFix&quot;&gt;&lt;/a&gt;&lt;b&gt;Proposed Fix&lt;/b&gt;&lt;/h4&gt;
&lt;ul&gt;
	&lt;li&gt;Redact known sensitive keys (&lt;tt&gt;SECRET&lt;/tt&gt;, &lt;tt&gt;TOKEN&lt;/tt&gt;, &lt;tt&gt;KEY&lt;/tt&gt;, &lt;tt&gt;PASSWORD&lt;/tt&gt;, etc.) before logging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Example fix snippet:&lt;br/&gt;
Map&amp;lt;String, String&amp;gt; redactedEnv = redactSensitive(environment);&lt;br/&gt;
LOG.info(&quot;Starting Python process with environment variables: {}&quot;, redactedEnv);}}&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Consider an opt-in mechanism (e.g., &lt;tt&gt;log.python.env=true&lt;/tt&gt;) for full environment visibility in safe/test setups.&lt;/li&gt;
&lt;/ul&gt;


&lt;h4&gt;&lt;a name=&quot;StepstoReproduce&quot;&gt;&lt;/a&gt;&lt;b&gt;Steps to Reproduce&lt;/b&gt;&lt;/h4&gt;
&lt;ol&gt;
	&lt;li&gt;Set Kubernetes secrets as environment variables in a FlinkDeployment (e.g., via &lt;tt&gt;envFrom.secretRef&lt;/tt&gt;).&lt;/li&gt;
	&lt;li&gt;Launch a PyFlink job using the Flink Kubernetes Operator.&lt;/li&gt;
	&lt;li&gt;Examine the JobManager logs.&lt;/li&gt;
	&lt;li&gt;Observe secrets printed via &lt;tt&gt;PythonEnvUtils.java&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13622240">FLINK-38035</key>
            <summary>Security Vulnerability in PyFlink Logging Mechanism (PythonEnvUtils.java)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vsakuru">Niha</assignee>
                                    <reporter username="vsakuru">Niha</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 1 Jul 2025 13:02:09 +0000</created>
                <updated>Tue, 5 Aug 2025 02:34:03 +0000</updated>
                            <resolved>Wed, 23 Jul 2025 18:59:09 +0000</resolved>
                                    <version>1.19.1</version>
                    <version>1.20.1</version>
                                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>1.20.3</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17990696" author="dianfu" created="Thu, 3 Jul 2025 07:27:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vsakuru&quot; class=&quot;user-hover&quot; rel=&quot;vsakuru&quot;&gt;vsakuru&lt;/a&gt; Hi, thanks for reporting this issue. Would you like to provide a fix for it?&lt;/p&gt;</comment>
                            <comment id="18004442" author="JIRAUSER309682" created="Thu, 10 Jul 2025 14:29:06 +0000"  >&lt;p&gt;I would need a little guidance but yes, I would like to provide a fix for this issue. I have already proposed 2 potential solutions for this bug. I can implement the most preferred solution&#160;&lt;/p&gt;</comment>
                            <comment id="18004446" author="rmetzger" created="Thu, 10 Jul 2025 14:42:43 +0000"  >&lt;p&gt;Thanks. I assigned you to the ticket.&lt;/p&gt;

&lt;p&gt;I would go with this approach: &quot;Redact known sensitive keys (SECRET, TOKEN, KEY, PASSWORD, etc.) before logging.&quot;.&lt;/p&gt;

&lt;p&gt;Afaik there&apos;s already some code in flink for redacting connector properties in Flink SQL .. you can probably re-use some of the logic there.&lt;/p&gt;</comment>
                            <comment id="18009365" author="rmetzger" created="Wed, 23 Jul 2025 18:59:09 +0000"  >&lt;p&gt;Resolved in master for 2.2: &lt;a href=&quot;https://github.com/apache/flink/commit/31785e076c86d0a44e3f4a17f44a04908a2d3eb4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/31785e076c86d0a44e3f4a17f44a04908a2d3eb4&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18010397" author="JIRAUSER309682" created="Mon, 28 Jul 2025 13:19:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&#160;&lt;br/&gt;
Thank you very much for helping me with this.Would it be possible to have this fix backported to the 1.20.x branch as well? If so, could you guide me on the right process?&lt;br/&gt;
Happy to help with the backport if needed.&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="18012002" author="dianfu" created="Tue, 5 Aug 2025 02:33:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vsakuru&quot; class=&quot;user-hover&quot; rel=&quot;vsakuru&quot;&gt;vsakuru&lt;/a&gt; Since it&apos;s a security issue, it makes sense to backport to other active branches.&lt;/p&gt;

&lt;p&gt;Merged to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;release-1.20 via 5218f0950de207452545671c596572d74ed10199&lt;/li&gt;
	&lt;li&gt;release-2.0 via a06b43be4aef6df04be741d2be2a5cba2587a0f3&lt;/li&gt;
	&lt;li&gt;release-2.1 via ce0265320180e0d139f4d87b4a40c7cbf6a6e55f&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wk4w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>