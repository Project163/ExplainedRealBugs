<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:30:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6805] Flink Cassandra connector dependency on Netty disagrees with Flink</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6805</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The Flink Cassandra connector has a dependency on Netty libraries (via promotion of transitive dependencies by the Maven shade plugin) at version 4.0.33.Final, which disagrees with the version included in Flink of 4.0.27.Final which is included &amp;amp; managed by the parent POM via dependency on netty-all.&lt;/p&gt;

&lt;p&gt;Due to use of netty-all, the dependency management doesn&apos;t take effect on the individual libraries such as netty-handler, netty-codec, etc.&lt;/p&gt;

&lt;p&gt;I suggest that dependency management of Netty should be added for all Netty libraries individually (netty-handler, etc.) so that all Flink modules use the same version, and similarly I suggest that exclusions be added to the quickstart example POM for the individual Netty libraries so that fat JARs don&apos;t include conflicting versions of Netty.&lt;/p&gt;

&lt;p&gt;It seems like this problem started when &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6084&quot; title=&quot;Cassandra connector does not declare all dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6084&quot;&gt;&lt;del&gt;FLINK-6084&lt;/del&gt;&lt;/a&gt; was implemented: transitive dependencies of the flink-connector-cassandra were previously omitted, and now that they are included we must make sure that they agree with the Flink distribution.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13076627">FLINK-6805</key>
            <summary>Flink Cassandra connector dependency on Netty disagrees with Flink</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mcfongtw">Michael Fong</assignee>
                                    <reporter username="rehevkor5">Shannon Carey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jun 2017 19:19:27 +0000</created>
                <updated>Wed, 2 Oct 2019 17:50:56 +0000</updated>
                            <resolved>Sun, 15 Oct 2017 16:44:57 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.3.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Connectors / Cassandra</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16033571" author="rehevkor5" created="Thu, 1 Jun 2017 19:56:58 +0000"  >&lt;p&gt;A better solution may be to add exclusions for the Netty libraries in the flink-connector-cassandra POM, then the other changes wouldn&apos;t necessarily be required (although they might still be desirable).&lt;/p&gt;</comment>
                            <comment id="16119971" author="mcfongtw" created="Wed, 9 Aug 2017 14:22:29 +0000"  >&lt;p&gt;All other flink libraries depends on 4.0.27, except flink-connect-cassandra seems to have a newer Netty4 dependency of version 4.0.33 using default scope &apos;compile&apos;.&lt;/p&gt;

&lt;p&gt;Resolved dep tree:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; org.apache.flink:flink-connector-cassandra_2.11:jar:1.4-SNAPSHOT&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; +- &lt;font color=&quot;red&quot;&gt;com.datastax.cassandra:cassandra-driver-core:jar:3.0.&lt;/font&gt;0:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |  &amp;#45; io.netty:netty-handler:jar:4.0.33.Final:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     +- io.netty:netty-buffer:jar:4.0.33.Final:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     |  &amp;#45; io.netty:netty-common:jar:4.0.33.Final:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     +- io.netty:netty-transport:jar:4.0.33.Final:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     |  &amp;#45; (io.netty:netty-buffer:jar:4.0.33.Final:compile - omitted for duplicate)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     &amp;#45; io.netty:netty-codec:jar:4.0.33.Final:compile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |        &amp;#45; (io.netty:netty-transport:jar:4.0.33.Final:compile - omitted for duplicate)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; +- org.apache.flink:flink-runtime_2.11:test-jar:tests:1.4-SNAPSHOT:test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |  +- com.data-artisans:flakka-remote_2.11:jar:2.3-custom:test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |  |  &amp;#45; io.netty:netty:jar:3.8.0.Final:test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |  &amp;#45; org.apache.zookeeper:zookeeper:jar:3.4.10:test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; |     &amp;#45; (io.netty:netty:jar:3.10.5.Final:test - omitted for conflict with 3.8.0.Final)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; &amp;#45; org.apache.cassandra:cassandra-all:jar:2.2.5:test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt;    &amp;#45; io.netty:netty-all:jar:4.0.23.Final:test&lt;/p&gt;

&lt;p&gt;However, I am not sure which version would be picked up at runtime, since Flink seems to wrap all classes (libraries included) in a fat jar at runtime. In addition, there is the &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7013&quot; title=&quot;Add shaded netty dependency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7013&quot;&gt;&lt;del&gt;FLINK-7013&lt;/del&gt;&lt;/a&gt; that intends to organize all classes imported from netty. &lt;/p&gt;

&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;, could you please share some insight to this tickets? I would love to help improve on this if there is any need to update maven dependencies. &lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Michael Fong&lt;/p&gt;</comment>
                            <comment id="16120018" author="zentol" created="Wed, 9 Aug 2017 14:43:00 +0000"  >&lt;p&gt;Since the cassandra connector jar doesn&apos;t contain netty Flink&apos;s dependency was used instead, unless a user explicitly included the datastax netty dependency.&lt;/p&gt;

&lt;p&gt;This will no longer work since &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7013&quot; title=&quot;Add shaded netty dependency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7013&quot;&gt;&lt;del&gt;FLINK-7013&lt;/del&gt;&lt;/a&gt; as netty is now shaded away.&lt;/p&gt;

&lt;p&gt;There are 2 ways to fix this:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;relocate netty references in the datastax dependency to re-use the shaded netty dependency&lt;/li&gt;
	&lt;li&gt;include the datastax netty dependency in the cassandra jar&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;m leaning towards 2). We are doing the same for guava, and is less likely to blow up in the future when either Flink or datastax move to a different netty version.&lt;/p&gt;</comment>
                            <comment id="16120885" author="mcfongtw" created="Thu, 10 Aug 2017 00:39:44 +0000"  >&lt;p&gt;Thanks for your comment, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;, &lt;/p&gt;

&lt;p&gt;One question above all, since Flink shaded netty would rename the classes FQN to specified class path, and would thus stick with the netty implementation to 4.0.27 as required for Flink. Would there be any need to consolidate netty version across all other libraries; in this cases, flink-connector-cassandra depends on cassandra-driver-core uses netty 4.0.33&lt;/p&gt;

&lt;p&gt;For the example you mentioned for guava, do you refer to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6982&quot; title=&quot;Replace guava dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6982&quot;&gt;&lt;del&gt;FLINK-6982&lt;/del&gt;&lt;/a&gt;, which plans to shade guava as it was done for netty? Thanks.&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Michael Fong&lt;/p&gt;</comment>
                            <comment id="16125534" author="zentol" created="Mon, 14 Aug 2017 10:57:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6982&quot; title=&quot;Replace guava dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6982&quot;&gt;&lt;del&gt;FLINK-6982&lt;/del&gt;&lt;/a&gt; is about shading &lt;em&gt;direct&lt;/em&gt; guava dependencies of Flink; for example &lt;tt&gt;flink-optimizer&lt;/tt&gt; has a direct guava dependency, that (will) now use the a shaded version. All modules that have a direct dependency will use this one.&lt;/p&gt;

&lt;p&gt;The cassandra module is different since it only has an indirect guava/netty dependency through the datastax driver. This module shades a separate version of guava, that isn&apos;t connected in any way to the one used by the rest of Flink. The same should be done with the netty dependency.&lt;/p&gt;

&lt;p&gt;This should be very easy to implement, as you only have to modify the maven-shade-plugin configuration in the pom of the cassandra module, adding an inclusion&amp;amp;relocation for the netty dependencies.&lt;/p&gt;</comment>
                            <comment id="16127192" author="githubbot" created="Tue, 15 Aug 2017 13:06:28 +0000"  >&lt;p&gt;GitHub user mcfongtw opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6805&quot; title=&quot;Flink Cassandra connector dependency on Netty disagrees with Flink&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6805&quot;&gt;&lt;del&gt;FLINK-6805&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Cassandra-Connector&amp;#93;&lt;/span&gt; Shade indirect netty4 dep in pom.xml&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;To relocate various &lt;b&gt;indirect&lt;/b&gt; netty4 dep of ver 4.0.33.Final to classpath of Flink&apos;s flavor using Maven shade plugin.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Passed local `mvn clean verify` as well as TravisCI tests&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Shade &lt;b&gt;(indirect)&lt;/b&gt; netty4 dependencies to avoid class clash in the future.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / no)  *&lt;b&gt;slightly related&lt;/b&gt;*, shade a netty4 dep.&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / no) no&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / no / don&apos;t know) no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / no / don&apos;t know) no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / no / don&apos;t know) no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / no) no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented) N.A.&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mcfongtw/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mcfongtw/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6805&quot; title=&quot;Flink Cassandra connector dependency on Netty disagrees with Flink&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6805&quot;&gt;&lt;del&gt;FLINK-6805&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4545&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f852eccd24b44ceece6e74bc06c24a77a9acb151&lt;br/&gt;
Author: Michael Fong &amp;lt;mcfong.open@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-08-15T06:22:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6805&quot; title=&quot;Flink Cassandra connector dependency on Netty disagrees with Flink&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6805&quot;&gt;&lt;del&gt;FLINK-6805&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Cassandra-Connector&amp;#93;&lt;/span&gt; Shade indirect netty4 dep&lt;/p&gt;

&lt;p&gt;    To relocate various &lt;b&gt;indirect&lt;/b&gt; netty4 dep of ver 4.0.33.Final to&lt;br/&gt;
    classpath of Flink flavor using Maven shade plugin.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16127200" author="mcfongtw" created="Tue, 15 Aug 2017 13:13:34 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks for your reply. I have created a PR based on your comments above. Please check if this is the way it would proceed and as well as the intended netty4 version. Thanks.&lt;/p&gt;
</comment>
                            <comment id="16127371" author="githubbot" created="Tue, 15 Aug 2017 15:21:00 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545#discussion_r133215094&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545#discussion_r133215094&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-cassandra/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -39,6 +39,7 @@ under the License.&lt;br/&gt;
     	&amp;lt;properties&amp;gt;&lt;br/&gt;
     		&amp;lt;cassandra.version&amp;gt;2.2.5&amp;lt;/cassandra.version&amp;gt;&lt;br/&gt;
     		&amp;lt;driver.version&amp;gt;3.0.0&amp;lt;/driver.version&amp;gt;&lt;br/&gt;
    +		&amp;lt;netty4.version&amp;gt;4.0.27.Final&amp;lt;/netty4.version&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    is this used anywhere?&lt;/p&gt;</comment>
                            <comment id="16127372" author="githubbot" created="Tue, 15 Aug 2017 15:21:00 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545#discussion_r133218223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545#discussion_r133218223&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-cassandra/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -83,6 +85,10 @@ under the License.&lt;br/&gt;
     										&amp;lt;exclude&amp;gt;com.google.inject.**&amp;lt;/exclude&amp;gt;&lt;br/&gt;
     									&amp;lt;/excludes&amp;gt;&lt;br/&gt;
     								&amp;lt;/relocation&amp;gt;&lt;br/&gt;
    +								&amp;lt;relocation&amp;gt;&lt;br/&gt;
    +									&amp;lt;pattern&amp;gt;io.netty&amp;lt;/pattern&amp;gt;&lt;br/&gt;
    +									&amp;lt;shadedPattern&amp;gt;org.apache.flink.shaded.netty4.io.netty&amp;lt;/shadedPattern&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    you are relocating cassandra indirect netty dependency into the same namespace as Flink direct netty dependency, which will lead to dependency conflicts (because the sole way of distinguishing between class veresions, the package declaration, is identical).&lt;/p&gt;

&lt;p&gt;    The `shadedPattern` should be `org.apache.flink.cassandra.shaded.io.netty` instead.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;This is in line with the guava relocation (in the same file).&lt;/li&gt;
	&lt;li&gt;the cassandra prefix introduces another layer of uniqueness which makes dependency conflicts less likely.&lt;/li&gt;
	&lt;li&gt;I want to reserve the `org.apache.flink.shaded` namespace for dependencies from `flink-shaded`, to avoid accidental dependency clashes from being created (which would have happened had we merged the PR as is)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16128540" author="githubbot" created="Wed, 16 Aug 2017 09:25:27 +0000"  >&lt;p&gt;Github user mcfongtw commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545#discussion_r133399999&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545#discussion_r133399999&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-cassandra/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -39,6 +39,7 @@ under the License.&lt;br/&gt;
     	&amp;lt;properties&amp;gt;&lt;br/&gt;
     		&amp;lt;cassandra.version&amp;gt;2.2.5&amp;lt;/cassandra.version&amp;gt;&lt;br/&gt;
     		&amp;lt;driver.version&amp;gt;3.0.0&amp;lt;/driver.version&amp;gt;&lt;br/&gt;
    +		&amp;lt;netty4.version&amp;gt;4.0.27.Final&amp;lt;/netty4.version&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Good call! It&apos;s not used currently. I will remove it .&lt;/p&gt;</comment>
                            <comment id="16128565" author="githubbot" created="Wed, 16 Aug 2017 09:44:01 +0000"  >&lt;p&gt;Github user mcfongtw commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545#discussion_r133404126&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545#discussion_r133404126&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-cassandra/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -83,6 +85,10 @@ under the License.&lt;br/&gt;
     										&amp;lt;exclude&amp;gt;com.google.inject.**&amp;lt;/exclude&amp;gt;&lt;br/&gt;
     									&amp;lt;/excludes&amp;gt;&lt;br/&gt;
     								&amp;lt;/relocation&amp;gt;&lt;br/&gt;
    +								&amp;lt;relocation&amp;gt;&lt;br/&gt;
    +									&amp;lt;pattern&amp;gt;io.netty&amp;lt;/pattern&amp;gt;&lt;br/&gt;
    +									&amp;lt;shadedPattern&amp;gt;org.apache.flink.shaded.netty4.io.netty&amp;lt;/shadedPattern&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Thanks for your review and reply! I see your points now, and I still have a few questions to the shading approach though:&lt;br/&gt;
    1. There seems to be some policies for making shadedPattern for different scenarios. Would there be any external documents that possibly address these rules?&lt;br/&gt;
    2. It is obvious to shade a *direct dependency, since we need it to be free of class clashes. How would we decide which *indirect dependencies to be shaded?&lt;br/&gt;
    3. The benefit of shading is clear, but wouldn&apos;t it increase the jar file size if there are more dependencies that need to be managed later on - also the effort of managing the including/relocation rules.&lt;/p&gt;

&lt;p&gt;    I will update another version of PR later. Thanks!&lt;/p&gt;</comment>
                            <comment id="16128581" author="githubbot" created="Wed, 16 Aug 2017 09:57:46 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545#discussion_r133407236&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545#discussion_r133407236&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-cassandra/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -83,6 +85,10 @@ under the License.&lt;br/&gt;
     										&amp;lt;exclude&amp;gt;com.google.inject.**&amp;lt;/exclude&amp;gt;&lt;br/&gt;
     									&amp;lt;/excludes&amp;gt;&lt;br/&gt;
     								&amp;lt;/relocation&amp;gt;&lt;br/&gt;
    +								&amp;lt;relocation&amp;gt;&lt;br/&gt;
    +									&amp;lt;pattern&amp;gt;io.netty&amp;lt;/pattern&amp;gt;&lt;br/&gt;
    +									&amp;lt;shadedPattern&amp;gt;org.apache.flink.shaded.netty4.io.netty&amp;lt;/shadedPattern&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    1) We haven&apos;t written them down anywhere; but there are examples on how the pattern should look like in many modules. (Granted, there are some relocations that don&apos;t follow the points I made; standardizing them is a work-in-progress) I would generally refer to existing relocations instead of some document that is bound to be out-dated at some point.&lt;br/&gt;
    2) Currently we shade&amp;amp;relocate dependencies that already caused conflicts.&lt;br/&gt;
    3) Yes, but there is no better solution. While it is possible to re-use some dependencies from Flink this tends to be a maintaining nightmare, as an upgrade to a dependency can suddenly cause issues in another part. The netty shading is a perfect example of this: we replaced the netty dependency and now the connector is broken.&lt;/p&gt;</comment>
                            <comment id="16136648" author="githubbot" created="Tue, 22 Aug 2017 11:16:27 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    looks good to me, will merge this later.&lt;/p&gt;</comment>
                            <comment id="16205193" author="githubbot" created="Sun, 15 Oct 2017 16:44:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4545&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16205196" author="zentol" created="Sun, 15 Oct 2017 16:44:57 +0000"  >&lt;p&gt;1.4: 81d7c4e8b111c6bf52000f68b64c402783a6ae74&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3frr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>