<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9326] TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9326</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When attempting to set the number of task slots via the api such ash&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
configuration = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Configuration();
configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, 16);
configuration.setInteger(CoreOptions.DEFAULT_PARALLELISM, 1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I will always end up with the default slot setting based on the number of cores I have where my standalone instance is running, it doesn&apos;t matter what I set the the NUM_TASK_SLOTS to, it has no effect&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux 64bit&lt;/p&gt;

&lt;p&gt;Flink branch&#160;release-1.5&lt;/p&gt;</environment>
        <key id="13158267">FLINK-9326</key>
            <summary>TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanghua">vinoyang</assignee>
                                    <reporter username="Sam_D">Samuel Doyle</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 May 2018 18:40:31 +0000</created>
                <updated>Thu, 28 Feb 2019 13:21:21 +0000</updated>
                            <resolved>Tue, 29 May 2018 11:21:06 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.1</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16469326" author="samd" created="Wed, 9 May 2018 19:08:10 +0000"  >&lt;p&gt;I&apos;m guessing this is because it appears whatever number of slots that was set in the configuration is later overridden ?&lt;/p&gt;

&lt;p&gt;In the&#160;&lt;b&gt;LocalStreamEnvironment&lt;/b&gt; &lt;b&gt;execute&lt;/b&gt; method&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...

&lt;span class=&quot;code-comment&quot;&gt;// add (and override) the settings with what the user defined
&lt;/span&gt;configuration.addAll(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.configuration);

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!configuration.contains(RestOptions.PORT)) {
   configuration.setInteger(RestOptions.PORT, 0);
}

MiniClusterConfiguration cfg = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MiniClusterConfiguration.Builder()
   .setConfiguration(configuration)
   .setNumSlotsPerTaskManager(jobGraph.getMaximumParallelism()) &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;-- HERE overrides the slots
&lt;/span&gt;   .build();
...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16470243" author="till.rohrmann" created="Thu, 10 May 2018 11:28:51 +0000"  >&lt;p&gt;You&apos;re right &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sam_D&quot; class=&quot;user-hover&quot; rel=&quot;Sam_D&quot;&gt;Sam_D&lt;/a&gt;. That way the user experience out of the box is a bit better, because it won&apos;t fail. I agree, though, that this is not very intuitive and confusing.&lt;/p&gt;

&lt;p&gt;Maybe we could do it that we use the &lt;tt&gt;TaskManagerOptions#NUM_TASK_SLOTS&lt;/tt&gt; if explicitly set and otherwise we default to the &lt;tt&gt;jobGraph.getMaximumParallelism&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16480228" author="githubbot" created="Fri, 18 May 2018 06:39:32 +0000"  >&lt;p&gt;GitHub user yanghua opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9326&quot; title=&quot;TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9326&quot;&gt;&lt;del&gt;FLINK-9326&lt;/del&gt;&lt;/a&gt; TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    &lt;b&gt;This pull request fixed the num slot config value override error.&lt;/b&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;fixed the num slot config value override error.&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is already covered by existing tests*.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable / docs / JavaDocs / *&lt;b&gt;not documented&lt;/b&gt;*)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/yanghua/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/yanghua/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9326&quot; title=&quot;TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9326&quot;&gt;&lt;del&gt;FLINK-9326&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6041&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 16fb81beaa4983a04e9929267ced36a3121f8188&lt;br/&gt;
Author: yanghua &amp;lt;yanghua1127@...&amp;gt;&lt;br/&gt;
Date:   2018-05-18T06:36:19Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9326&quot; title=&quot;TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9326&quot;&gt;&lt;del&gt;FLINK-9326&lt;/del&gt;&lt;/a&gt; TaskManagerOptions.NUM_TASK_SLOTS does not work for local/embedded mode&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16480307" author="githubbot" created="Fri, 18 May 2018 07:48:17 +0000"  >&lt;p&gt;Github user yanghua commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    cc @tillrohrmann &lt;/p&gt;</comment>
                            <comment id="16483653" author="githubbot" created="Tue, 22 May 2018 08:37:40 +0000"  >&lt;p&gt;Github user yanghua commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    cc @zentol @tzulitai if you have time, please review this PR, thanks~&lt;/p&gt;</comment>
                            <comment id="16483716" author="githubbot" created="Tue, 22 May 2018 09:35:38 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041#discussion_r189836110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041#discussion_r189836110&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/LocalStreamEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -103,9 +103,16 @@ public JobExecutionResult execute(String jobName) throws Exception &lt;/p&gt;
{
     			configuration.setInteger(RestOptions.PORT, 0);
     		}

&lt;p&gt;    +		int numSlotsPerTaskManager;&lt;br/&gt;
    +		if (configuration.contains(TaskManagerOptions.NUM_TASK_SLOTS)) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    this block can be simplified to:&lt;br/&gt;
    ```&lt;br/&gt;
    numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="16483779" author="githubbot" created="Tue, 22 May 2018 10:49:38 +0000"  >&lt;p&gt;Github user yanghua commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041#discussion_r189856924&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041#discussion_r189856924&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/LocalStreamEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -103,9 +103,16 @@ public JobExecutionResult execute(String jobName) throws Exception &lt;/p&gt;
{
     			configuration.setInteger(RestOptions.PORT, 0);
     		}

&lt;p&gt;    +		int numSlotsPerTaskManager;&lt;br/&gt;
    +		if (configuration.contains(TaskManagerOptions.NUM_TASK_SLOTS)) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    @zentol does it need a new commit?&lt;/p&gt;</comment>
                            <comment id="16486997" author="githubbot" created="Wed, 23 May 2018 09:51:09 +0000"  >&lt;p&gt;Github user yanghua commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041#discussion_r190187802&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041#discussion_r190187802&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/LocalStreamEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -103,9 +103,16 @@ public JobExecutionResult execute(String jobName) throws Exception &lt;/p&gt;
{
     			configuration.setInteger(RestOptions.PORT, 0);
     		}

&lt;p&gt;    +		int numSlotsPerTaskManager;&lt;br/&gt;
    +		if (configuration.contains(TaskManagerOptions.NUM_TASK_SLOTS)) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    cc @zentol&lt;/p&gt;</comment>
                            <comment id="16493187" author="zentol" created="Tue, 29 May 2018 07:35:53 +0000"  >&lt;p&gt;1.5: cbf2c8f785b6a8b620d9aeeb702fdb81b7c8bbfa&lt;/p&gt;</comment>
                            <comment id="16493402" author="githubbot" created="Tue, 29 May 2018 11:21:04 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6041&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16493403" author="zentol" created="Tue, 29 May 2018 11:21:06 +0000"  >&lt;p&gt;master: 2a7c3366db0aa9bdc54a5be522b50f52027fb341&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3tj7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>