<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:58:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-23478] KubernetesSharedInformerITCase.testWatchWithBlockHandler fails on Azure</title>
                <link>https://issues.apache.org/jira/browse/FLINK-23478</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20864&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20864&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3190&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Jul 23 04:41:49 java.util.concurrent.ExecutionException: java.lang.AssertionError
Jul 23 04:41:49 	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
Jul 23 04:41:49 	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase.testWatchWithBlockHandler(KubernetesSharedInformerITCase.java:140)
Jul 23 04:41:49 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
Jul 23 04:41:49 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
Jul 23 04:41:49 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
Jul 23 04:41:49 	at java.lang.reflect.Method.invoke(Method.java:498)
Jul 23 04:41:49 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
Jul 23 04:41:49 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
Jul 23 04:41:49 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
Jul 23 04:41:49 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
Jul 23 04:41:49 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
Jul 23 04:41:49 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
Jul 23 04:41:49 	at org.apache.flink.util.TestNameProvider$1.evaluate(TestNameProvider.java:45)
Jul 23 04:41:49 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
Jul 23 04:41:49 	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
Jul 23 04:41:49 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
Jul 23 04:41:49 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
Jul 23 04:41:49 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
Jul 23 04:41:49 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
Jul 23 04:41:49 	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
Jul 23 04:41:49 	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
Jul 23 04:41:49 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
Jul 23 04:41:49 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
Jul 23 04:41:49 	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
Jul 23 04:41:49 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
Jul 23 04:41:49 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
Jul 23 04:41:49 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
Jul 23 04:41:49 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Jul 23 04:41:49 Caused by: java.lang.AssertionError
Jul 23 04:41:49 	at org.junit.Assert.fail(Assert.java:87)
Jul 23 04:41:49 	at org.junit.Assert.assertTrue(Assert.java:42)
Jul 23 04:41:49 	at org.junit.Assert.assertTrue(Assert.java:53)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase$TestingBlockCallbackHandler.lambda$onAddOrUpdated$0(KubernetesSharedInformerITCase.java:292)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase.check(KubernetesSharedInformerITCase.java:311)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase.access$800(KubernetesSharedInformerITCase.java:54)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase$TestingBlockCallbackHandler.onAddOrUpdated(KubernetesSharedInformerITCase.java:292)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformerITCase$TestingBlockCallbackHandler.onAdded(KubernetesSharedInformerITCase.java:277)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformer$EventHandler.lambda$&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;$1(KubernetesSharedInformer.java:227)
Jul 23 04:41:49 	at org.apache.flink.kubernetes.kubeclient.resources.KubernetesSharedInformer$WatchCallback.lambda$run$0(KubernetesSharedInformer.java:273)
Jul 23 04:41:49 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
Jul 23 04:41:49 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
Jul 23 04:41:49 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
Jul 23 04:41:49 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
Jul 23 04:41:49 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13391481">FLINK-23478</key>
            <summary>KubernetesSharedInformerITCase.testWatchWithBlockHandler fails on Azure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yittg">Yi Tang</assignee>
                                    <reporter username="dwysakowicz">Dawid Wysakowicz</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 23 Jul 2021 05:50:32 +0000</created>
                <updated>Sat, 28 Aug 2021 12:22:07 +0000</updated>
                            <resolved>Wed, 11 Aug 2021 07:35:37 +0000</resolved>
                                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                                    <component>Deployment / Kubernetes</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17385997" author="fly_in_gis" created="Fri, 23 Jul 2021 06:45:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yittg&quot; class=&quot;user-hover&quot; rel=&quot;yittg&quot;&gt;yittg&lt;/a&gt;&#160;Could you please have a look on this failed test?&lt;/p&gt;</comment>
                            <comment id="17386058" author="yittg" created="Fri, 23 Jul 2021 07:48:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt; yeah, i&apos;ll dig it&lt;/p&gt;</comment>
                            <comment id="17386113" author="yittg" created="Fri, 23 Jul 2021 09:32:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt; The cause is that a simpler lock can not guarantee the absolute order event it is a &quot;fair&quot; lock,  because the later event can be executed earlier to the cached thread pool executor, so the lock attempt occures earlier also.&lt;/p&gt;

&lt;p&gt;Maybe we still need to manually handle it in the &lt;tt&gt;WatchCallback&lt;/tt&gt;, like submit a runnable if events come and terminate if all queued events are processed in a short period.&lt;/p&gt;

&lt;p&gt;You can assign this issue to me, I&apos;ll try to resolve it ASAP. &lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvk&quot; class=&quot;user-hover&quot; rel=&quot;dmvk&quot;&gt;dmvk&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17386151" author="dawidwys" created="Fri, 23 Jul 2021 10:50:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20881&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3176&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20881&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3176&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17386232" author="yittg" created="Fri, 23 Jul 2021 13:26:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt; I&apos;ve added a patch to fix this issue, please help to review it.&lt;/p&gt;

&lt;p&gt;Sorry for the inconvenience.&lt;/p&gt;</comment>
                            <comment id="17386758" author="dawidwys" created="Sat, 24 Jul 2021 18:57:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20896&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20896&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3156&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387083" author="fly_in_gis" created="Mon, 26 Jul 2021 06:01:12 +0000"  >&lt;p&gt;Fixed in master via&lt;/p&gt;

&lt;p&gt;2ab506208318ae87b97ec1b8b4b04e14af10b00e&lt;/p&gt;

&lt;p&gt;ceb57439de0660d12f09c364473b7ece5203d26e&lt;/p&gt;</comment>
                            <comment id="17387100" author="dawidwys" created="Mon, 26 Jul 2021 06:50:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20904&amp;amp;view=logs&amp;amp;j=68a897ab-3047-5660-245a-cce8f83859f6&amp;amp;t=89ed5489-a970-5ff2-67f7-d7391de0165f&amp;amp;l=3185&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20904&amp;amp;view=logs&amp;amp;j=68a897ab-3047-5660-245a-cce8f83859f6&amp;amp;t=89ed5489-a970-5ff2-67f7-d7391de0165f&amp;amp;l=3185&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387107" author="dawidwys" created="Mon, 26 Jul 2021 07:01:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20925&amp;amp;view=logs&amp;amp;j=739e6eac-8312-5d31-d437-294c4d26fced&amp;amp;t=2a8cc459-df7a-5e6f-12bf-96efcc369aa9&amp;amp;l=3173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20925&amp;amp;view=logs&amp;amp;j=739e6eac-8312-5d31-d437-294c4d26fced&amp;amp;t=2a8cc459-df7a-5e6f-12bf-96efcc369aa9&amp;amp;l=3173&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387116" author="dawidwys" created="Mon, 26 Jul 2021 07:08:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20928&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3194&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20928&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3194&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387117" author="dawidwys" created="Mon, 26 Jul 2021 07:09:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20932&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3184&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20932&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3184&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387671" author="yittg" created="Tue, 27 Jul 2021 01:37:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt;&lt;br/&gt;
Looks like the &lt;tt&gt;KubernetesSharedInformerITCase&lt;/tt&gt; still has some other issues, would we create another ticket to track it?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20995&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=20995&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3144&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17387711" author="fly_in_gis" created="Tue, 27 Jul 2021 02:57:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yittg&quot; class=&quot;user-hover&quot; rel=&quot;yittg&quot;&gt;yittg&lt;/a&gt; I have attached the mvn logs. It seems that the events still could not be processes orderly.&lt;/p&gt;</comment>
                            <comment id="17387725" author="yittg" created="Tue, 27 Jul 2021 03:17:39 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt;. I&apos;ll try to find the root cause again. It&apos;s a sad test case, &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17387737" author="fly_in_gis" created="Tue, 27 Jul 2021 03:41:37 +0000"  >&lt;p&gt;However, I have run the test &lt;tt&gt;KubernetesSharedInformerITCase#testWatchWithBlockHandler&lt;/tt&gt; more than 1000 times and could not reproduce the failure.&lt;/p&gt;</comment>
                            <comment id="17387754" author="yittg" created="Tue, 27 Jul 2021 04:12:24 +0000"  >&lt;p&gt;Maybe we can make use of Azure to reproduce it by removing all other e2e tests and only running the &lt;tt&gt;KubernetesSharedInformerITCase&lt;/tt&gt; multiple times with some useful log?&lt;/p&gt;</comment>
                            <comment id="17387772" author="fly_in_gis" created="Tue, 27 Jul 2021 05:14:08 +0000"  >&lt;p&gt;I agree with you that we may need to use the Azure to reproduce this failure. I will reopen this ticket and downgrade the priority since it happens&#160;rarely.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Feel free to&#160;upgrade the priority if we have some more other instances.&lt;/p&gt;</comment>
                            <comment id="17387775" author="yittg" created="Tue, 27 Jul 2021 05:21:12 +0000"  >&lt;p&gt;I happened to reproduce the issue locally, it seems the indexer of &lt;tt&gt;SharedIndexInformer&lt;/tt&gt; is incredibly not serial. &lt;br/&gt;
 I need to further confirm this conclusion, hope i am wrong.&lt;/p&gt;

&lt;p&gt;It can happen in &lt;tt&gt;EventHandler#onModified&lt;/tt&gt; like following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;EventHandler {
...
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void onModified(T obj) {
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.printf(
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;M:%s:%s\n%s\n&quot;&lt;/span&gt;,
                    obj.getMetadata().getName(), obj.getMetadata().getResourceVersion(), obj);
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.callbacks.forEach(
                    (id, callback) -&amp;gt; callback.run(h -&amp;gt; h.onModified(wrapEvent(obj))));
        }
...
}

M:shared-informer-test-cluster-1627362096046:136167
ConfigMap(apiVersion=v1, binaryData=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, data={val=7},  ... name=shared-informer-test-cluster-1627362096046, namespace=&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, ownerReferences=[], resourceVersion=136167, selfLink=/api/v1/namespaces/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/configmaps/shared-informer-test-cluster-1627362096046, uid=7ad189fc-52c2-4c36-a9f8-0da8ea71ae29, additionalProperties={}), additionalProperties={})

M:shared-informer-test-cluster-1627362096046:136168
ConfigMap(apiVersion=v1, binaryData=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, data={val=8}, ... name=shared-informer-test-cluster-1627362096046, namespace=&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, ownerReferences=[], resourceVersion=136168, selfLink=/api/v1/namespaces/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/configmaps/shared-informer-test-cluster-1627362096046, uid=7ad189fc-52c2-4c36-a9f8-0da8ea71ae29, additionalProperties={}), additionalProperties={})

M:shared-informer-test-cluster-1627362096046:136167
ConfigMap(apiVersion=v1, binaryData=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, data={val=7}, ... name=shared-informer-test-cluster-1627362096046, namespace=&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, ownerReferences=[], resourceVersion=136167, selfLink=/api/v1/namespaces/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/configmaps/shared-informer-test-cluster-1627362096046, uid=7ad189fc-52c2-4c36-a9f8-0da8ea71ae29, additionalProperties={}), additionalProperties={})

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17387799" author="yittg" created="Tue, 27 Jul 2021 06:15:14 +0000"  >&lt;p&gt;It is likely caused by the following logical, the first &lt;tt&gt;reListAndSync&lt;/tt&gt; in schedule executor(can not be disabled by setting &lt;tt&gt;resyncPeriodMillis&lt;/tt&gt; to a large value) conflicts with the outer list and watch without any guards. I&apos;m confused about this implementation.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; io.fabric8.kubernetes.client.informers.cache;
...
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Reflector&amp;lt;T &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; HasMetadata, L &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; KubernetesResourceList&amp;lt;T&amp;gt;&amp;gt; {
...
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void listAndWatch() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Started ReflectorRunnable watch &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; {}&quot;&lt;/span&gt;, apiTypeClass);
      reListAndSync();
      resyncExecutor.scheduleWithFixedDelay(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;::reListAndSync, 0L, resyncPeriodMillis, TimeUnit.MILLISECONDS);
      startWatcher();
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception exception) {
      store.isPopulated(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RejectedExecutionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; starting ReflectorRunnable watch&quot;&lt;/span&gt;, exception);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe the &lt;tt&gt;SharedInformer#hasSynced&lt;/tt&gt; can help, i will dive it deeper.&lt;/p&gt;</comment>
                            <comment id="17387831" author="fly_in_gis" created="Tue, 27 Jul 2021 07:05:56 +0000"  >&lt;p&gt;A side input: I am working on&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22802&quot; title=&quot;Bump Fabric8 Kubernetes Client to &amp;gt;= 5.X&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22802&quot;&gt;&lt;del&gt;FLINK-22802&lt;/del&gt;&lt;/a&gt; to bump the fabric8 Kubernetes client to 5.5.0, which could resolve the resync bugs.&lt;/p&gt;</comment>
                            <comment id="17387842" author="yittg" created="Tue, 27 Jul 2021 07:28:13 +0000"  >&lt;p&gt;Glad to hear the news, i think it can be fixed after upgrading the client.&lt;/p&gt;</comment>
                            <comment id="17390439" author="dawidwys" created="Fri, 30 Jul 2021 09:20:55 +0000"  >&lt;p&gt;I also faced the jvm crash with the test: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=21196&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3123&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=21196&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=070ff179-953e-5bda-71fa-d6599415701c&amp;amp;l=3123&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17391089" author="fly_in_gis" created="Sun, 1 Aug 2021 02:52:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22802&quot; title=&quot;Bump Fabric8 Kubernetes Client to &amp;gt;= 5.X&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22802&quot;&gt;&lt;del&gt;FLINK-22802&lt;/del&gt;&lt;/a&gt; has been merged. Let&apos;s keep this ticket open and verify whether it is fixed&#160;truly.&lt;/p&gt;</comment>
                            <comment id="17394485" author="yittg" created="Fri, 6 Aug 2021 03:29:57 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;,  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xtsong&quot; class=&quot;user-hover&quot; rel=&quot;xtsong&quot;&gt;xtsong&lt;/a&gt;, thanks for your report about the test error. Did you find more failed case after merging &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22802&quot; title=&quot;Bump Fabric8 Kubernetes Client to &amp;gt;= 5.X&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22802&quot;&gt;&lt;del&gt;FLINK-22802&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wangyang0918&quot; class=&quot;user-hover&quot; rel=&quot;wangyang0918&quot;&gt;wangyang0918&lt;/a&gt; We can keep this ticket OPEN until next Monday (almost one week) or longer if no more failed case?&lt;/p&gt;</comment>
                            <comment id="17397130" author="fly_in_gis" created="Wed, 11 Aug 2021 07:35:12 +0000"  >&lt;p&gt;I will close this ticket since we do not find more related instances. Feel free to reopen it if necessary.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13392981">FLINK-23572</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13391498">FLINK-23481</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13381015">FLINK-22802</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13031083" name="mvn-1.log" size="386333" author="wangyang0918" created="Tue, 27 Jul 2021 02:56:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t9fs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>