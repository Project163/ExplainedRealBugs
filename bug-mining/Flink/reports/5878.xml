<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:06:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24300] MultipleInputOperator is running much more slowly in TPCDS</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24300</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When we are running TPCDS with release 1.14 we find that the job with &lt;tt&gt;MultipleInputOperator&lt;/tt&gt;&#160;is running much more slowly than before. With a binary search among the commits, we find that the issue may be introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-23408&quot; title=&quot;Wait for a checkpoint completed after finishing a task&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-23408&quot;&gt;&lt;del&gt;FLINK-23408&lt;/del&gt;&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;At the commit&#160;64570e4c56955713ca599fd1d7ae7be891a314c6, the job&#160;in TPCDS runs normally, as the image below illustrates:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13033595/13033595_64570e4c56955713ca599fd1d7ae7be891a314c6.png&quot; width=&quot;600&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;At the commit e3010c16947ed8da2ecb7d89a3aa08dacecc524a, the job q2.sql gets stuck for a pretty long time (longer than half an hour), as the image below illustrates:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13033594/13033594_e3010c16947ed8da2ecb7d89a3aa08dacecc524a.png&quot; width=&quot;600&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The detail of the job is illustrated below:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13033593/13033593_detail-of-the-job.png&quot; width=&quot;600&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The job uses a &lt;tt&gt;MultipleInputOperator&lt;/tt&gt; with one normal input and two chained FileSource. It has finished reading the normal input and start to read the chained source. Each chained source has one source data fetcher.&lt;/p&gt;

&lt;p&gt;We capture the jstack of the stuck tasks and attach the file below. From the &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13033592/13033592_jstack.txt&quot; title=&quot;jstack.txt attached to FLINK-24300&quot;&gt;jstack.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&#160;we can see the main thread is blocked on waiting for the lock, and the lock is held by a source data fetcher. The source data fetcher is still running but the stack keeps on &lt;tt&gt;CompletableFuture.cleanStack&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This issue happens in a batch job. However, from where it get blocked, it seems also affects the streaming jobs.&lt;/p&gt;

&lt;p&gt;For the reference, the code of TPCDS we are running is located at &lt;a href=&quot;https://github.com/ververica/flink-sql-benchmark/tree/dev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ververica/flink-sql-benchmark/tree/dev&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13401421">FLINK-24300</key>
            <summary>MultipleInputOperator is running much more slowly in TPCDS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dwysakowicz">Dawid Wysakowicz</assignee>
                                    <reporter username="Thesharing">Zhilong Hong</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 15 Sep 2021 15:22:58 +0000</created>
                <updated>Wed, 26 Jan 2022 14:00:52 +0000</updated>
                            <resolved>Fri, 17 Sep 2021 19:21:16 +0000</resolved>
                                    <version>1.14.0</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Runtime / Network</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17415595" author="gaoyunhaii" created="Wed, 15 Sep 2021 15:32:14 +0000"  >&lt;p&gt;From the attached &lt;em&gt;jstack-2.txt&lt;/em&gt;&#160;(see this one since jstack.txt is running with alibaba jdk, which has some slight difference in line numbers), the stack of a single task is like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;Source Data Fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; MultipleInput(readOrder=[0,1,1], members=[\nHashJoin(joinType=[InnerJoin], where=[(d_date_sk = ws_sold_date_sk)], select=[ws_sold_date_sk, ws_ext_sales_price, d_date_sk, d_week_seq, d_day_name], isBroadcast=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], build=[right])\n:- Union(all=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], union=[ws_sold_date_sk, ws_ext_sales_price])\n:  :- [#2] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, web_sales, project=[ws_sold_date_sk, ws_ext_sales_price]]], fields=[ws_sold_date_sk, ws_ext_sales_price])\n:  +- [#3] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, catalog_sales, project=[cs_sold_date_sk, cs_ext_sales_price]]], fields=[cs_sold_date_sk, cs_ext_sales_price])\n+- [#1] Exchange(distribution=[broadcast])\n]) [Source: HiveSource-tpcds_bin_orc_10000.web_sales, Source: HiveSource-tpcds_bin_orc_10000.catalog_sales] -&amp;gt; Calc(select=[d_week_seq, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Sunday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f1, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Monday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f2, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Tuesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f3, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Wednesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f4, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Thursday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f5, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Friday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f6, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Saturday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f7]) -&amp;gt; LocalHashAggregate(groupBy=[d_week_seq], select=[d_week_seq, Partial_SUM($f1) AS sum$0, Partial_SUM($f2) AS sum$1, Partial_SUM($f3) AS sum$2, Partial_SUM($f4) AS sum$3, Partial_SUM($f5) AS sum$4, Partial_SUM($f6) AS sum$5, Partial_SUM($f7) AS sum$6]) (548/1050)#0&quot;&lt;/span&gt; #217 prio=5 os_prio=0 tid=0x00007fcda518f000 nid=0x1632d runnable [0x00007fcc9e0ed000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: RUNNABLE
	at java.util.concurrent.CompletableFuture.cleanStack(CompletableFuture.java:497)
	at java.util.concurrent.CompletableFuture.postFire(CompletableFuture.java:567)
	at java.util.concurrent.CompletableFuture.postFire(CompletableFuture.java:1068)
	at java.util.concurrent.CompletableFuture$OrRelay.tryFire(CompletableFuture.java:1549)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.flink.connector.base.source.reader.synchronization.FutureCompletingBlockingQueue.moveToAvailable(FutureCompletingBlockingQueue.java:173)
	at org.apache.flink.connector.base.source.reader.synchronization.FutureCompletingBlockingQueue.enqueue(FutureCompletingBlockingQueue.java:347)
	at org.apache.flink.connector.base.source.reader.synchronization.FutureCompletingBlockingQueue.put(FutureCompletingBlockingQueue.java:211)
--
&lt;span class=&quot;code-quote&quot;&gt;&quot;Source Data Fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; MultipleInput(readOrder=[0,1,1], members=[\nHashJoin(joinType=[InnerJoin], where=[(d_date_sk = ws_sold_date_sk)], select=[ws_sold_date_sk, ws_ext_sales_price, d_date_sk, d_week_seq, d_day_name], isBroadcast=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], build=[right])\n:- Union(all=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], union=[ws_sold_date_sk, ws_ext_sales_price])\n:  :- [#2] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, web_sales, project=[ws_sold_date_sk, ws_ext_sales_price]]], fields=[ws_sold_date_sk, ws_ext_sales_price])\n:  +- [#3] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, catalog_sales, project=[cs_sold_date_sk, cs_ext_sales_price]]], fields=[cs_sold_date_sk, cs_ext_sales_price])\n+- [#1] Exchange(distribution=[broadcast])\n]) [Source: HiveSource-tpcds_bin_orc_10000.web_sales, Source: HiveSource-tpcds_bin_orc_10000.catalog_sales] -&amp;gt; Calc(select=[d_week_seq, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Sunday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f1, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Monday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f2, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Tuesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f3, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Wednesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f4, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Thursday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f5, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Friday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f6, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Saturday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f7]) -&amp;gt; LocalHashAggregate(groupBy=[d_week_seq], select=[d_week_seq, Partial_SUM($f1) AS sum$0, Partial_SUM($f2) AS sum$1, Partial_SUM($f3) AS sum$2, Partial_SUM($f4) AS sum$3, Partial_SUM($f5) AS sum$4, Partial_SUM($f6) AS sum$5, Partial_SUM($f7) AS sum$6]) (548/1050)#0&quot;&lt;/span&gt; #216 prio=5 os_prio=0 tid=0x00007fcda51be000 nid=0x16327 waiting on condition [0x00007fcc9e1ee000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x00000005067ffcf0&amp;gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)
	at java.util.concurrent.ArrayBlockingQueue.take(ArrayBlockingQueue.java:403)
	at org.apache.flink.connector.file.src.util.Pool.pollEntry(Pool.java:82)
	at org.apache.flink.orc.AbstractOrcFileInputFormat$OrcVectorizedReader.getCachedEntry(AbstractOrcFileInputFormat.java:292)
	at org.apache.flink.orc.AbstractOrcFileInputFormat$OrcVectorizedReader.readBatch(AbstractOrcFileInputFormat.java:256)
	at org.apache.flink.connector.file.src.impl.FileSourceSplitReader.fetch(FileSourceSplitReader.java:67)
--
&lt;span class=&quot;code-quote&quot;&gt;&quot;MultipleInput(readOrder=[0,1,1], members=[\nHashJoin(joinType=[InnerJoin], where=[(d_date_sk = ws_sold_date_sk)], select=[ws_sold_date_sk, ws_ext_sales_price, d_date_sk, d_week_seq, d_day_name], isBroadcast=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], build=[right])\n:- Union(all=[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;], union=[ws_sold_date_sk, ws_ext_sales_price])\n:  :- [#2] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, web_sales, project=[ws_sold_date_sk, ws_ext_sales_price]]], fields=[ws_sold_date_sk, ws_ext_sales_price])\n:  +- [#3] TableSourceScan(table=[[hive, tpcds_bin_orc_10000, catalog_sales, project=[cs_sold_date_sk, cs_ext_sales_price]]], fields=[cs_sold_date_sk, cs_ext_sales_price])\n+- [#1] Exchange(distribution=[broadcast])\n]) [Source: HiveSource-tpcds_bin_orc_10000.web_sales, Source: HiveSource-tpcds_bin_orc_10000.catalog_sales] -&amp;gt; Calc(select=[d_week_seq, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Sunday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f1, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Monday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f2, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Tuesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f3, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Wednesday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f4, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Thursday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f5, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Friday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f6, CASE((d_day_name = _UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&apos;Saturday&apos;&lt;/span&gt;:VARCHAR(2147483647) CHARACTER SET &quot;&lt;/span&gt;UTF-16LE&lt;span class=&quot;code-quote&quot;&gt;&quot;), ws_ext_sales_price, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:DOUBLE) AS $f7]) -&amp;gt; LocalHashAggregate(groupBy=[d_week_seq], select=[d_week_seq, Partial_SUM($f1) AS sum$0, Partial_SUM($f2) AS sum$1, Partial_SUM($f3) AS sum$2, Partial_SUM($f4) AS sum$3, Partial_SUM($f5) AS sum$4, Partial_SUM($f6) AS sum$5, Partial_SUM($f7) AS sum$6]) (548/1050)#0&quot;&lt;/span&gt; #200 prio=5 os_prio=0 tid=0x00007fcda63ee800 nid=0x1624d waiting on condition [0x00007fcc9edfa000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x00000004fd5fce68&amp;gt; (a java.util.concurrent.locks.ReentrantLock$NonfairSync)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199)
	at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209)
	at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285)
	at org.apache.flink.connector.base.source.reader.synchronization.FutureCompletingBlockingQueue.poll(FutureCompletingBlockingQueue.java:257)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17415878" author="xintongsong" created="Thu, 16 Sep 2021 05:32:06 +0000"  >&lt;p&gt;I&apos;m upgrading this to blocker for now. We can downgrade it if the conclusion turns out to be otherwise.&lt;/p&gt;</comment>
                            <comment id="17415943" author="gaoyunhaii" created="Thu, 16 Sep 2021 07:46:34 +0000"  >&lt;p&gt;With some offline discussion with  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;&#160;and some more verification, the cause of this issue should be:&lt;/p&gt;

&lt;p&gt;1.&#160;For multi-input operator with input selection, it might call &lt;em&gt;StreamMultipleInputProcess#fullCheckAndSetAvailable&lt;/em&gt; for each record when input selection is enabled, which future calls &lt;em&gt;SourceOperator#getAvailableFuture()&lt;/em&gt;.&lt;br/&gt;
2. In the current implementation each call to &lt;em&gt;SourceOperator#getAvailableFuture()&lt;/em&gt; would add a new stage to the source reader&apos;s available future via &lt;em&gt;CompletableFuture.anyOf(sourceReaderAvailable, forceStop)&lt;/em&gt;.&lt;br/&gt;
3. Therefore, if an input get available for a while, the available future might attach too many stages. In the above case it might chained with more than 200000 stages. When complete it, it need to complete all these stages. Since completing each stage involves some operation to the volatile fields, it would takes a long time to complete all of them. &lt;/p&gt;</comment>
                            <comment id="17416886" author="dawidwys" created="Fri, 17 Sep 2021 19:21:16 +0000"  >&lt;p&gt;Fixed in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master
	&lt;ul&gt;
		&lt;li&gt;7c8fefae4a782297e46f0b883fb2152791b79cf0&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;1.14
	&lt;ul&gt;
		&lt;li&gt;791c1b9c0816a0a990c2e705b0cafc474fef97ca&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13390015">FLINK-23408</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13423716">FLINK-25728</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13424920">FLINK-25827</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13033595" name="64570e4c56955713ca599fd1d7ae7be891a314c6.png" size="336474" author="Thesharing" created="Wed, 15 Sep 2021 14:59:44 +0000"/>
                            <attachment id="13033593" name="detail-of-the-job.png" size="638842" author="Thesharing" created="Wed, 15 Sep 2021 15:10:07 +0000"/>
                            <attachment id="13033594" name="e3010c16947ed8da2ecb7d89a3aa08dacecc524a.png" size="270972" author="Thesharing" created="Wed, 15 Sep 2021 15:02:06 +0000"/>
                            <attachment id="13033603" name="jstack-2.txt" size="98753" author="gaoyunhaii" created="Wed, 15 Sep 2021 16:25:55 +0000"/>
                            <attachment id="13033592" name="jstack.txt" size="98424" author="Thesharing" created="Wed, 15 Sep 2021 15:16:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0uyrc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>