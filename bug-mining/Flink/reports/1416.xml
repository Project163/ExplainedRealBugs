<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3617] NPE from CaseClassSerializer when dealing with null Option field</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3617</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;This error occurs when serializing a Scala case class with an field of Option[] type where the value is not Some or None, but null.&lt;/p&gt;

&lt;p&gt;If this is not supported we should have a good error message.&lt;/p&gt;

&lt;p&gt;java.lang.RuntimeException: ConsumerThread threw an exception: null&lt;br/&gt;
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumer09.run(FlinkKafkaConsumer09.java:336)&lt;br/&gt;
	at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:78)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.SourceStreamTask.run(SourceStreamTask.java:56)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:224)&lt;br/&gt;
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: java.lang.RuntimeException&lt;br/&gt;
	at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:81)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:39)&lt;br/&gt;
	at org.apache.flink.streaming.api.operators.StreamSource$NonTimestampContext.collect(StreamSource.java:158)&lt;br/&gt;
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumer09$ConsumerThread.run(FlinkKafkaConsumer09.java:473)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.flink.api.scala.typeutils.CaseClassSerializer.serialize(CaseClassSerializer.scala:100)&lt;br/&gt;
	at org.apache.flink.api.scala.typeutils.CaseClassSerializer.serialize(CaseClassSerializer.scala:30)&lt;br/&gt;
	at org.apache.flink.api.scala.typeutils.CaseClassSerializer.serialize(CaseClassSerializer.scala:100)&lt;br/&gt;
	at org.apache.flink.api.scala.typeutils.CaseClassSerializer.serialize(CaseClassSerializer.scala:30)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.streamrecord.StreamRecordSerializer.serialize(StreamRecordSerializer.java:107)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.streamrecord.StreamRecordSerializer.serialize(StreamRecordSerializer.java:42)&lt;br/&gt;
	at org.apache.flink.runtime.plugable.SerializationDelegate.write(SerializationDelegate.java:56)&lt;br/&gt;
	at org.apache.flink.runtime.io.network.api.serialization.SpanningRecordSerializer.addRecord(SpanningRecordSerializer.java:79)&lt;br/&gt;
	at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:84)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.io.StreamRecordWriter.emit(StreamRecordWriter.java:86)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:78)&lt;br/&gt;
	... 3 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12950703">FLINK-3617</key>
            <summary>NPE from CaseClassSerializer when dealing with null Option field</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chermenin">Alexander Chermenin</assignee>
                                    <reporter username="jgrier">Jamie Grier</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Mar 2016 00:12:01 +0000</created>
                <updated>Wed, 2 Oct 2019 17:44:19 +0000</updated>
                            <resolved>Thu, 28 Feb 2019 12:46:43 +0000</resolved>
                                    <version>1.0.0</version>
                                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15615505" author="githubbot" created="Fri, 28 Oct 2016 14:01:16 +0000"  >&lt;p&gt;GitHub user chermenin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; title=&quot;NPE from CaseClassSerializer when dealing with null Option field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3617&quot;&gt;&lt;del&gt;FLINK-3617&lt;/del&gt;&lt;/a&gt; Simple fix for OptionSerializer.&lt;/p&gt;

&lt;p&gt;    This fix prevent possible NullPointerException at serialization process, but after deserialization Option variable will be initialized with None value and not null (as was before serialization). This decision was made for compatibility between versions. What thoughts about it?&lt;/p&gt;

&lt;p&gt;    This PR solve &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; title=&quot;NPE from CaseClassSerializer when dealing with null Option field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3617&quot;&gt;&lt;del&gt;FLINK-3617&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-3617&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/chermenin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/chermenin/flink&lt;/a&gt; flink-3617&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2723&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b742af340dbba4c927471d7f09e8d0b486dc6637&lt;br/&gt;
Author: Aleksandr Chermenin &amp;lt;aleksandr_chermenin@epam.com&amp;gt;&lt;br/&gt;
Date:   2016-10-28T13:52:26Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; title=&quot;NPE from CaseClassSerializer when dealing with null Option field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3617&quot;&gt;&lt;del&gt;FLINK-3617&lt;/del&gt;&lt;/a&gt; Simple fix for OptionSerializer.&lt;/p&gt;

&lt;p&gt;    This fix prevent possible NullPointerException at serialization process,&lt;br/&gt;
    but after deserialization Option variable will be initialized with None&lt;br/&gt;
    value and not null (as was before serialization).&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15622565" author="githubbot" created="Mon, 31 Oct 2016 16:02:59 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85770866&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85770866&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/scala/org/apache/flink/api/scala/runtime/CaseClassComparatorTest.scala &amp;#8212;&lt;br/&gt;
    @@ -34,7 +34,7 @@ import org.mockito.Mockito&lt;/p&gt;

&lt;p&gt;     class CaseClassComparatorTest {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case class CaseTestClass(a: Int, b: Int, c: Int, d: String)&lt;br/&gt;
    +  case class CaseTestClass(a: Int, b: Int, c: Int, d: String, e: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Please do not change this class but create a new `OptionSerializerTest` which extends `SerializerTestBase`. See for instance `IntSerializerTest` for how the test base is used.&lt;/p&gt;</comment>
                            <comment id="15622566" author="githubbot" created="Mon, 31 Oct 2016 16:02:59 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85770344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85770344&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This would represent `null` the same way as `None`. However, `null` is not the same as `None` so this is incorrect. &lt;/p&gt;

&lt;p&gt;    `writeBoolean` serializes a whole byte: `0` for `false` and `1` for `true`. &lt;br/&gt;
    We should change `writeBoolean` to `writeByte` and keep the current mapping and add `2` for `null`.&lt;/p&gt;</comment>
                            <comment id="15622637" author="githubbot" created="Mon, 31 Oct 2016 16:24:10 +0000"  >&lt;p&gt;Github user chermenin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85775790&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85775790&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes, but in this case we lose compatibility with previous implementations of serialization. Is it possible?&lt;/p&gt;</comment>
                            <comment id="15622639" author="githubbot" created="Mon, 31 Oct 2016 16:25:15 +0000"  >&lt;p&gt;Github user chermenin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85776021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85776021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/scala/org/apache/flink/api/scala/runtime/CaseClassComparatorTest.scala &amp;#8212;&lt;br/&gt;
    @@ -34,7 +34,7 @@ import org.mockito.Mockito&lt;/p&gt;

&lt;p&gt;     class CaseClassComparatorTest {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case class CaseTestClass(a: Int, b: Int, c: Int, d: String)&lt;br/&gt;
    +  case class CaseTestClass(a: Int, b: Int, c: Int, d: String, e: Option&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Ok, I will do it.&lt;/p&gt;</comment>
                            <comment id="15622677" author="githubbot" created="Mon, 31 Oct 2016 16:42:30 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85779839&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85779839&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If `writeBoolean` is correctly implemented (i.e., according to the JavaDocs in `java.io.DataOutput#writeBoolean(boolean)`) we should be good. However, you are right, that we may not change the `0` -&amp;gt; `false` and `1` -&amp;gt; `true` mapping.&lt;/p&gt;</comment>
                            <comment id="15622715" author="githubbot" created="Mon, 31 Oct 2016 16:56:12 +0000"  >&lt;p&gt;Github user chermenin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85782914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85782914&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If use `2` for `null` value we will get `true` from `readBoolean` method too.&lt;/p&gt;</comment>
                            <comment id="15622756" author="githubbot" created="Mon, 31 Oct 2016 17:11:07 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85785788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85785788&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Sure, we have to change `deserialize()` as well. &lt;br/&gt;
    If we can check for `2` (i.e, `null`) before we check for `1` (`SOME`), it should work, no?&lt;/p&gt;</comment>
                            <comment id="15623082" author="githubbot" created="Mon, 31 Oct 2016 19:19:35 +0000"  >&lt;p&gt;Github user chermenin commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r85812829&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r85812829&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/typeutils/OptionSerializer.scala &amp;#8212;&lt;br/&gt;
    @@ -65,7 +65,7 @@ class OptionSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(val elemSerializer: TypeSerializer&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;)&lt;br/&gt;
         case Some(a) =&amp;gt;&lt;br/&gt;
           target.writeBoolean(true)&lt;br/&gt;
           elemSerializer.serialize(a, target)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt;&lt;br/&gt;
    +    case _ =&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I understand. Is there possible this case as serialization with new serializer and deserialization with old one? Exception will be in this case, isn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="15626376" author="githubbot" created="Tue, 1 Nov 2016 19:12:29 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    -1 to merging this, for the reason that this removes alters unrelated tests by removing lines.&lt;/p&gt;

&lt;p&gt;    I think that calling `toString()` was introduced as a way to test if the copies made by serializers seem to valid (the method accesses many fields), or if the cloning (involving possibly unsafe instantiations and field/memory accesses) broke something. It may not be a thorough test, but at least it tests parts.&lt;/p&gt;

&lt;p&gt;    Please, never, never change test cases!&lt;/p&gt;</comment>
                            <comment id="15626399" author="stephanewen" created="Tue, 1 Nov 2016 19:17:29 +0000"  >&lt;p&gt;I think the problem is in the &lt;tt&gt;CaseClassSerializer&lt;/tt&gt;, not in the &lt;tt&gt;Option&lt;/tt&gt; type.&lt;br/&gt;
Case classes simply do not support null types at this point. It just happens that the field is of type option.&lt;br/&gt;
We may want to change that at some point.&lt;/p&gt;

&lt;p&gt;The error message should be better, though, agreed.&lt;/p&gt;

&lt;p&gt;Using null for an Option value is by itself a bug &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; (after all, Option is explicitly designed to avoid null)&lt;/p&gt;</comment>
                            <comment id="15626449" author="githubbot" created="Tue, 1 Nov 2016 19:36:49 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen I think `deepEquals` method must be used for this and not `toString`.&lt;/p&gt;</comment>
                            <comment id="15626474" author="githubbot" created="Tue, 1 Nov 2016 19:47:56 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yes, deepEquals() is a nice way to do this (and could be added to the tests).&lt;/p&gt;

&lt;p&gt;    Still, no pull requests should ever change (especially weaken) any unrelated tests. We need to enforce that policy.&lt;/p&gt;</comment>
                            <comment id="15626495" author="githubbot" created="Tue, 1 Nov 2016 19:55:18 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I see. I will change this code in the near future.&lt;/p&gt;</comment>
                            <comment id="15628050" author="githubbot" created="Wed, 2 Nov 2016 07:27:31 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen I restored test to check `toString()` method. This check added into `deepEquals()` method and performed only if `toString()` is overridden. In other cases this check is useless, isn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="15635776" author="fhueske" created="Fri, 4 Nov 2016 09:26:01 +0000"  >&lt;p&gt;I agree, &lt;tt&gt;Option&lt;/tt&gt;&apos;s purpose is to avoid &lt;tt&gt;null&lt;/tt&gt; values and usually, the composite serializer (in this case CaseClassSerializer) should handle &lt;tt&gt;null&lt;/tt&gt; fields.&lt;br/&gt;
However, there are also atomic serializers that encode null themselves (like StringSerializer).&lt;/p&gt;

&lt;p&gt;So the question is: do we actually want to fix this issue by adapting the OptionSerializer (as proposed in PR #2723) or close it as Won&apos;t Fix (because we do not want to change CaseClassSerializer) or Not an Issue (because Option should not be null anyways)?&lt;/p&gt;

&lt;p&gt;IMO, we could fix it with the changed serialization format of the OptionSerializer (see PR #2723).&lt;/p&gt;

&lt;p&gt;Opinions &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jgrier&quot; class=&quot;user-hover&quot; rel=&quot;jgrier&quot;&gt;jgrier&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chermenin&quot; class=&quot;user-hover&quot; rel=&quot;chermenin&quot;&gt;chermenin&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15676696" author="stephanewen" created="Fri, 18 Nov 2016 13:20:04 +0000"  >&lt;p&gt;How pressing is that? Is it a serious problem to work around?&lt;br/&gt;
Having an upgrade story for serializers (I know some people are starting to design that) would let us do this more smoothly in the future.&lt;/p&gt;</comment>
                            <comment id="15676714" author="fhueske" created="Fri, 18 Nov 2016 13:31:13 +0000"  >&lt;p&gt;Don&apos;t know. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jgrier&quot; class=&quot;user-hover&quot; rel=&quot;jgrier&quot;&gt;jgrier&lt;/a&gt; who reported the issue might comment on this.&lt;br/&gt;
IMO, it&apos;s not urgent but a decision is required to resolve the PR that was contributed.&lt;/p&gt;

&lt;p&gt;A solution to upgrade serializers would be great!&lt;/p&gt;</comment>
                            <comment id="15687005" author="githubbot" created="Tue, 22 Nov 2016 15:17:03 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen @fhueske Can we discuss this PR?&lt;/p&gt;</comment>
                            <comment id="15751098" author="githubbot" created="Thu, 15 Dec 2016 11:13:56 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r92588478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r92588478&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/test/java/org/apache/flink/api/common/typeutils/SerializerTestBase.java &amp;#8212;&lt;br/&gt;
    @@ -409,9 +402,26 @@ else if (should instanceof Throwable) &lt;/p&gt;
{
     			assertEquals(((Throwable)should).getMessage(), ((Throwable)is).getMessage());
     		}
&lt;p&gt;     		else {&lt;br/&gt;
    +			// if toString() was overridden we must check it&lt;br/&gt;
    +			if (!should.toString().equals(should.getClass().getName() +&lt;br/&gt;
    +										  &quot;@&quot; + Integer.toHexString(should.hashCode()))) &lt;/p&gt;
{
    +				assertEquals(message, should.toString(), is.toString());
    +			}
&lt;p&gt;     			assertEquals(message,  should, is);&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	protected void checkClass(String message, Class&amp;lt;?&amp;gt; type, Class&amp;lt;?&amp;gt; instanceType) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I don&apos;t understand the logic of this method. Why not simply compare the classes?&lt;/p&gt;</comment>
                            <comment id="15751099" author="githubbot" created="Thu, 15 Dec 2016 11:13:56 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723#discussion_r92588685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723#discussion_r92588685&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/test/java/org/apache/flink/api/common/typeutils/SerializerTestBase.java &amp;#8212;&lt;br/&gt;
    @@ -409,9 +402,26 @@ else if (should instanceof Throwable) &lt;/p&gt;
{
     			assertEquals(((Throwable)should).getMessage(), ((Throwable)is).getMessage());
     		}
&lt;p&gt;     		else {&lt;br/&gt;
    +			// if toString() was overridden we must check it&lt;br/&gt;
    +			if (!should.toString().equals(should.getClass().getName() +&lt;br/&gt;
    +										  &quot;@&quot; + Integer.toHexString(should.hashCode()))) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This can be more robustly done by looking up the &apos;toString()&apos; method and seeing if the defining class was `Object`.&lt;/p&gt;</comment>
                            <comment id="15751411" author="githubbot" created="Thu, 15 Dec 2016 13:46:19 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think that if some type can have `null` as value then there must be possibility to serialize this value (it may be Option or any other type). And by the way `CaseClassSerializer` class have been fixed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15751440" author="githubbot" created="Thu, 15 Dec 2016 13:55:08 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Having `null` as the full transported type es explicitly not supported right now.&lt;br/&gt;
    The handling of null member fields belongs logically to the Tuple/Pojo/CaseClass serializer, not to the individual types that can be members.&lt;/p&gt;</comment>
                            <comment id="15751461" author="githubbot" created="Thu, 15 Dec 2016 14:06:41 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    No-no, i&apos;m forced to disagree with you... IMHO, `null` is a value of concrete type and it must be processed by individual serializer for this type.&lt;/p&gt;</comment>
                            <comment id="15753953" author="githubbot" created="Fri, 16 Dec 2016 09:42:23 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Null is not specific to any type - everything can be null.&lt;/p&gt;

&lt;p&gt;    The approach you suggest leads to a bad design. Many types just cannot simply encode null themselves without overhead and allowing this void optimizations for primitive types and tighter loops without null checks. Having a common null encoding in the containing type (tuples, etc) is the more efficient approach, one can encode a lot of null information in a tuple-wide bit vector for example.&lt;/p&gt;</comment>
                            <comment id="15753985" author="githubbot" created="Fri, 16 Dec 2016 09:58:24 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Okay, we can add a null encoding support for serializers of containing types, and it will be done at this weekends. But even in this case we must save a null encoding support for serializing the concrete type.&lt;/p&gt;</comment>
                            <comment id="15754009" author="githubbot" created="Fri, 16 Dec 2016 10:08:52 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    A quick info, before you jump into this: We cannot simply alter the serializers right now, because that breaks the savepoint compatibility. There are some first steps in the 1.2 release to help getting a serializer upgrade path started, but that is still WIP.&lt;/p&gt;

&lt;p&gt;    BTW: This whole discussion is a good example of why we encourage to discuss ideas first before jumping into implementation. Especially when they tough runtime behavior.&lt;/p&gt;</comment>
                            <comment id="15754055" author="githubbot" created="Fri, 16 Dec 2016 10:26:51 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Well, sure, I understand you. Let&apos;s discuss all aspects of a improvement of a serialization model (include `null`&apos;s processing, of course) in mailing list and will implement everything after that? And I will close this PR now &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15754107" author="githubbot" created="Fri, 16 Dec 2016 10:53:56 +0000"  >&lt;p&gt;Github user chermenin closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15754156" author="githubbot" created="Fri, 16 Dec 2016 11:19:48 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for understanding. I think starting a mailing list discussion, or even a FLIP on upgrading serializers is a good thing. The serializer upgrade path is becoming an important thing, also to bump the Kryo dependency to a newer version.&lt;/p&gt;</comment>
                            <comment id="15754229" author="githubbot" created="Fri, 16 Dec 2016 11:52:22 +0000"  >&lt;p&gt;GitHub user chermenin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; title=&quot;NPE from CaseClassSerializer when dealing with null Option field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3617&quot;&gt;&lt;del&gt;FLINK-3617&lt;/del&gt;&lt;/a&gt; Prevent NPE in CaseClassSerializer and informative error message.&lt;/p&gt;

&lt;p&gt;    To not to change current implementation of serialization now just NullFieldException has been added.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/chermenin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/chermenin/flink&lt;/a&gt; flink-3617&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3021&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9f4dee80bfb5b5df41f211f3da8231d59310fa29&lt;br/&gt;
Author: Aleksandr Chermenin &amp;lt;aleksandr_chermenin@epam.com&amp;gt;&lt;br/&gt;
Date:   2016-12-16T11:42:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3617&quot; title=&quot;NPE from CaseClassSerializer when dealing with null Option field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3617&quot;&gt;&lt;del&gt;FLINK-3617&lt;/del&gt;&lt;/a&gt; Added null value check.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15763801" author="githubbot" created="Tue, 20 Dec 2016 09:54:18 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks like a good solution.&lt;br/&gt;
    Since these serializers are very performance critical, I am curious what is more efficient:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The if-null-check you implemented here&lt;/li&gt;
	&lt;li&gt;a try/catch block that catches the nullpointer exception and throws the NullFieldException&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Are you interested in microbenchmarking that?&lt;/p&gt;</comment>
                            <comment id="15764083" author="githubbot" created="Tue, 20 Dec 2016 12:22:50 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yep, i&apos;ll do a benchmark to test approaches and compare them each other at this week. I will write the results here. Big thanks for your idea)&lt;/p&gt;</comment>
                            <comment id="15766496" author="githubbot" created="Wed, 21 Dec 2016 08:44:41 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;ve got results and here are:&lt;/p&gt;

&lt;p&gt;    Benchmark          | Mode  | Cnt  |    Score  |  Error  | Units&lt;br/&gt;
    ------------------&lt;del&gt;|&lt;/del&gt;-----&lt;del&gt;|&lt;/del&gt;----&lt;del&gt;|&lt;/del&gt;---------&lt;del&gt;|&lt;/del&gt;-------&lt;del&gt;|&lt;/del&gt;-------&lt;br/&gt;
    Just operation      | avgt  | 200  |   74.672  |  0.944  | ns/op&lt;br/&gt;
    if-else (&lt;em&gt;not&lt;/em&gt; null value)      | avgt  | 200  |  915.718  |  5.534  | ns/op&lt;br/&gt;
    try-catch (&lt;em&gt;not&lt;/em&gt; null value)    | avgt  | 200  |   74.183  |  0.405  | ns/op&lt;br/&gt;
    if-else (null value)         | avgt  | 200  |  901.775  |  5.368  | ns/op&lt;br/&gt;
    try-catch (null value)       | avgt  | 200  | 8649.317  | 40.462  | ns/op&lt;/p&gt;

&lt;p&gt;    In this way `if-else-check` always adds more than 800 nanoseconds per operation to run-time.&lt;br/&gt;
    While `try-catch-block` doesn&apos;t slow down normal performance. We really need this option, because null value isn&apos;t normal value for us now. I will change the code in the closest future.&lt;/p&gt;</comment>
                            <comment id="15814846" author="githubbot" created="Tue, 10 Jan 2017 12:29:24 +0000"  >&lt;p&gt;Github user chermenin commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen What do you think about merging this PR?&lt;/p&gt;</comment>
                            <comment id="15821566" author="githubbot" created="Fri, 13 Jan 2017 10:26:17 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good, thanks, will merge this...&lt;/p&gt;
</comment>
                            <comment id="15824554" author="stephanewen" created="Mon, 16 Jan 2017 20:24:29 +0000"  >&lt;p&gt;Improved the null check in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.2.0 via 27c11e1b79bd68cbd2e8275c7938478e2e9532e6&lt;/li&gt;
	&lt;li&gt;1.3.0 via fdce1f319c512fc845b64cbb7cbfb10f9d899021&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15834584" author="githubbot" created="Mon, 23 Jan 2017 14:07:08 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This has been merged a while back in fdce1f319c512fc845b64cbb7cbfb10f9d899021&lt;br/&gt;
    I forgot to add the keywork that the bot closes the pull request.&lt;/p&gt;

&lt;p&gt;    Can you manually close this pull request?&lt;/p&gt;</comment>
                            <comment id="15834833" author="githubbot" created="Mon, 23 Jan 2017 16:23:20 +0000"  >&lt;p&gt;Github user chermenin closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3021&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uqpb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>