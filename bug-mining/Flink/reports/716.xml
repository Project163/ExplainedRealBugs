<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:21:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3061] Kafka Consumer is not failing if broker is not available</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3061</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;It seems that the FlinkKafkaConsumer is just logging the errors when trying to get the initial list of partitions for the topic, but its not failing.&lt;/p&gt;

&lt;p&gt;The following code ALWAYS runs, even if there is no broker or zookeeper running.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; def main(args: Array[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;]) {
    val env = StreamExecutionEnvironment.getExecutionEnvironment
    val properties = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Properties()
    properties.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;bootstrap.servers&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:9092&quot;&lt;/span&gt;)
    properties.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;zookeeper.connect&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:2181&quot;&lt;/span&gt;)
    properties.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;group.id&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;)
    val stream = env
      .addSource(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FlinkKafkaConsumer082[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;](&lt;span class=&quot;code-quote&quot;&gt;&quot;topic&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleStringSchema(), properties))
      .print

    env.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;Flink Kafka Example&quot;&lt;/span&gt;)
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The runtime consumers are designed to idle when they have no partitions assigned, but there is no check that there are no partitions at all.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12915412">FLINK-3061</key>
            <summary>Kafka Consumer is not failing if broker is not available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Nov 2015 16:46:43 +0000</created>
                <updated>Mon, 30 Nov 2015 15:16:11 +0000</updated>
                            <resolved>Mon, 30 Nov 2015 15:16:10 +0000</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15022452" author="githubbot" created="Mon, 23 Nov 2015 16:57:49 +0000"  >&lt;p&gt;GitHub user rmetzger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3061&quot; title=&quot;Kafka Consumer is not failing if broker is not available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3061&quot;&gt;&lt;del&gt;FLINK-3061&lt;/del&gt;&lt;/a&gt; Properly fail Kafka Consumer if broker is not available&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rmetzger/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rmetzger/flink&lt;/a&gt; flink3061&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1395&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fa6fbb9471132e88f271b4ff5ac6496831ba5939&lt;br/&gt;
Author: Robert Metzger &amp;lt;rmetzger@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-11-23T16:57:26Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3061&quot; title=&quot;Kafka Consumer is not failing if broker is not available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3061&quot;&gt;&lt;del&gt;FLINK-3061&lt;/del&gt;&lt;/a&gt; Properly fail Kafka Consumer if broker is not available&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15024189" author="githubbot" created="Tue, 24 Nov 2015 10:14:18 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#issuecomment-159217845&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#issuecomment-159217845&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Could it happen that a broker is currently not available but will be in the future. With the behaviour before this PR could Flink then idle and start consuming once the broker becomes available?&lt;/p&gt;</comment>
                            <comment id="15024475" author="githubbot" created="Tue, 24 Nov 2015 13:12:02 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#discussion_r45732488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#discussion_r45732488&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/KafkaITCase.java &amp;#8212;&lt;br/&gt;
    @@ -40,6 +40,11 @@ public void testCheckpointing() throws Exception &lt;/p&gt;
{
     		runCheckpointingTest();
     	}

&lt;p&gt;    +	@Test(expected = RuntimeException.class)&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    You don&apos;t check the exception here. This means any `RuntimeException` can make the test pass. IMO not a good test.&lt;/p&gt;</comment>
                            <comment id="15024478" author="githubbot" created="Tue, 24 Nov 2015 13:12:28 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#issuecomment-159262498&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#issuecomment-159262498&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I had a comment concerning the test case. Besides that, LGTM.&lt;/p&gt;</comment>
                            <comment id="15027170" author="githubbot" created="Wed, 25 Nov 2015 17:13:37 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#issuecomment-159676808&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#issuecomment-159676808&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;gt; Could it happen that a broker is currently not available but will be in the future.&lt;/p&gt;

&lt;p&gt;    Yes. With this PR, the consumer fails only if NO broker is available. As long as we can get the partition id&apos;s of the topic, the consumer will start.&lt;/p&gt;

&lt;p&gt;    &amp;gt; With the behaviour before this PR could Flink then idle and start consuming once the broker becomes available?&lt;/p&gt;

&lt;p&gt;    No. The parallel consuming thread deployed to the cluster are initialized with a list of partition IDs from the topic. If we can not get the partition IDs when creating the consumer, we can never assign the partitions to the consumers.&lt;/p&gt;
</comment>
                            <comment id="15027446" author="githubbot" created="Wed, 25 Nov 2015 19:40:10 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#discussion_r45910842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#discussion_r45910842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-kafka/src/main/java/org/apache/flink/streaming/connectors/kafka/FlinkKafkaConsumer.java &amp;#8212;&lt;br/&gt;
    @@ -306,6 +306,11 @@ public FlinkKafkaConsumer(String topic, KeyedDeserializationSchema&amp;lt;T&amp;gt; deserializ&lt;br/&gt;
     		// Connect to a broker to get the partitions&lt;br/&gt;
     		List&amp;lt;PartitionInfo&amp;gt; partitionInfos = getPartitionsForTopic(topic, props);&lt;/p&gt;

&lt;p&gt;    +		if(partitionInfos.size() == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Code style, space &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15027450" author="githubbot" created="Wed, 25 Nov 2015 19:41:33 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#issuecomment-159710764&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#issuecomment-159710764&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think this looks good.&lt;/p&gt;

&lt;p&gt;    It only blocks job deployment if all brokers are down. As soon as there is one broker during deployment, the rest will keep recovering and retrying, if I understand it correctly.&lt;/p&gt;</comment>
                            <comment id="15031885" author="githubbot" created="Mon, 30 Nov 2015 14:54:56 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395#issuecomment-160652522&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395#issuecomment-160652522&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    will merge this ...&lt;/p&gt;</comment>
                            <comment id="15031930" author="githubbot" created="Mon, 30 Nov 2015 15:15:11 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1395&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15031933" author="rmetzger" created="Mon, 30 Nov 2015 15:16:11 +0000"  >&lt;p&gt;Resolved for master in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/flink/commit/209ae6c9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/flink/commit/209ae6c9&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2osun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>