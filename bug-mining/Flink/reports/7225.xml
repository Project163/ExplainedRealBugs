<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:18:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-32962] Failure to install python dependencies from requirements file</title>
                <link>https://issues.apache.org/jira/browse/FLINK-32962</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;We have encountered an issue when Flink fails to install python dependencies from requirements file if python environment contains setuptools dependency version 67.5.0 or above.&lt;br/&gt;
Flink job fails with following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
py4j.protocol.Py4JJavaError: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; calling o118.await.
: java.util.concurrent.ExecutionException: org.apache.flink.table.api.TableException: Failed to wait job finish
    at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:395)
    at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1999)
    at org.apache.flink.table.api.internal.TableResultImpl.awaitInternal(TableResultImpl.java:118)
    at org.apache.flink.table.api.internal.TableResultImpl.await(TableResultImpl.java:81)
    ...
Caused by: java.util.concurrent.ExecutionException: org.apache.flink.client.program.ProgramInvocationException: Job failed (JobID: 2ca4026944022ac4537c503464d4c47f)
    at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:395)
    at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1999)
    at org.apache.flink.table.api.internal.InsertResultProvider.hasNext(InsertResultProvider.java:83)
    ... 6 more
Caused by: org.apache.flink.client.program.ProgramInvocationException: Job failed (JobID: 2ca4026944022ac4537c503464d4c47f)
    at org.apache.flink.client.deployment.ClusterClientJobClientAdapter.lambda$&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;$6(ClusterClientJobClientAdapter.java:130)
    at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)
    at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
    at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
    ...

Caused by: java.io.IOException: java.io.IOException: Failed to execute the command: /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install --ignore-installed -r /&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/folders/rb/q_3h54_94b57gz_qkbp593vw0000gn/T/tm_localhost:63904-4178d3/blobStorage/job_2ca4026944022ac4537c503464d4c47f/blob_p-feb04bed919e628d98b1ef085111482f05bf43a1-1f5c3fda7cbdd6842e950e04d9d807c5 --install-option --prefix=/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/folders/rb/q_3h54_94b57gz_qkbp593vw0000gn/T/python-dist-c17912db-5aba-439f-9e39-69cb8c957bec/python-requirements
output:
Usage:
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] &amp;lt;requirement specifier&amp;gt; [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-index-options] ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] -r &amp;lt;requirements file&amp;gt; [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-index-options] ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] [-e] &amp;lt;vcs project url&amp;gt; ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] [-e] &amp;lt;local project path&amp;gt; ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] &amp;lt;archive url/path&amp;gt; ...

no such option: --install-option

    at org.apache.flink.python.util.PythonEnvironmentManagerUtils.pipInstallRequirements(PythonEnvironmentManagerUtils.java:144)
    at org.apache.flink.python.env.AbstractPythonEnvironmentManager.installRequirements(AbstractPythonEnvironmentManager.java:215)
    at org.apache.flink.python.env.AbstractPythonEnvironmentManager.lambda$open$0(AbstractPythonEnvironmentManager.java:126)
    at org.apache.flink.python.env.AbstractPythonEnvironmentManager$PythonEnvResources.createResource(AbstractPythonEnvironmentManager.java:435)
    at org.apache.flink.python.env.AbstractPythonEnvironmentManager$PythonEnvResources.getOrAllocateSharedResource(AbstractPythonEnvironmentManager.java:402)
    at org.apache.flink.python.env.AbstractPythonEnvironmentManager.open(AbstractPythonEnvironmentManager.java:114)
    at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:238)
    at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57)
    at org.apache.flink.table.runtime.operators.python.AbstractStatelessFunctionOperator.open(AbstractStatelessFunctionOperator.java:92)
    at org.apache.flink.table.runtime.operators.python.scalar.AbstractPythonScalarFunctionOperator.open(AbstractPythonScalarFunctionOperator.java:101)
    at org.apache.flink.table.runtime.operators.python.scalar.PythonScalarFunctionOperator.open(PythonScalarFunctionOperator.java:71)
    at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107)
    at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreGates(StreamTask.java:734)
    ...
Caused by: java.io.IOException: Failed to execute the command: /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install --ignore-installed -r /&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/folders/rb/q_3h54_94b57gz_qkbp593vw0000gn/T/tm_localhost:63904-4178d3/blobStorage/job_2ca4026944022ac4537c503464d4c47f/blob_p-feb04bed919e628d98b1ef085111482f05bf43a1-1f5c3fda7cbdd6842e950e04d9d807c5 --install-option --prefix=/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/folders/rb/q_3h54_94b57gz_qkbp593vw0000gn/T/python-dist-c17912db-5aba-439f-9e39-69cb8c957bec/python-requirements
output:
Usage:
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] &amp;lt;requirement specifier&amp;gt; [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-index-options] ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] -r &amp;lt;requirements file&amp;gt; [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-index-options] ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] [-e] &amp;lt;vcs project url&amp;gt; ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] [-e] &amp;lt;local project path&amp;gt; ...
  /Users/z3d1k/.pyenv/versions/3.9.17/bin/python -m pip install [options] &amp;lt;archive url/path&amp;gt; ...

no such option: --install-option

    at org.apache.flink.python.util.PythonEnvironmentManagerUtils.execute(PythonEnvironmentManagerUtils.java:220)
    at org.apache.flink.python.util.PythonEnvironmentManagerUtils.pipInstallRequirements(PythonEnvironmentManagerUtils.java:130)
    ... 20 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Before installing dependencies provided in the requirements.txt file, Flink checks version of pip, and based on result constructs cli command to execute &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. Version check is performed by running following command &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
python -c &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; sys;from pkg_resources &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; get_distribution, parse_version;pip_version = get_distribution(&lt;span class=&quot;code-quote&quot;&gt;&apos;pip&apos;&lt;/span&gt;).version;print(parse_version(pip_version) &amp;gt;= parse_version(sys.args[1]))&quot;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Starting from this version, python will print deprecation warning when package pkg_resources is used &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;string&amp;gt;:1: DeprecationWarning: pkg_resources is deprecated as an API. See https:&lt;span class=&quot;code-comment&quot;&gt;//setuptools.pypa.io/en/latest/pkg_resources.html
&lt;/span&gt;True &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This warning breaks output parsing, causing Flink to assume that python environment has pip with version 8.0.0 or below, adding &quot;--install-option&quot; argument. This argument had been deprecated and removed from recent pip versions.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Proposed solution:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Remove pip version check since pip of version `8.0.0` does not support recent python versions: &lt;br/&gt;
Documentation states that Flink supports python 3.7 and above for Flink 1.17 &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; and earliest version to support python 3.7 is pip 18.1 &lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;References:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://github.com/apache/flink/blob/c1fba732738aaaa0d576f80881eb464a954e12c5/flink-python/src/main/java/org/apache/flink/python/util/PythonEnvironmentManagerUtils.java#L61-L65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/c1fba732738aaaa0d576f80881eb464a954e12c5/flink-python/src/main/java/org/apache/flink/python/util/PythonEnvironmentManagerUtils.java#L61-L65&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://github.com/apache/flink/blob/c1fba732738aaaa0d576f80881eb464a954e12c5/flink-python/src/main/java/org/apache/flink/python/util/PythonEnvironmentManagerUtils.java#L109-L117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/c1fba732738aaaa0d576f80881eb464a954e12c5/flink-python/src/main/java/org/apache/flink/python/util/PythonEnvironmentManagerUtils.java#L109-L117&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://github.com/pypa/setuptools/pull/3843&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/pypa/setuptools/pull/3843&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://nightlies.apache.org/flink/flink-docs-release-1.17/docs/dev/python/installation/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://nightlies.apache.org/flink/flink-docs-release-1.17/docs/dev/python/installation/&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://pip.pypa.io/en/stable/news/#v18-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pip.pypa.io/en/stable/news/#v18-1&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13548692">FLINK-32962</key>
            <summary>Failure to install python dependencies from requirements file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="a.pilipenko">Aleksandr Pilipenko</assignee>
                                    <reporter username="a.pilipenko">Aleksandr Pilipenko</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 25 Aug 2023 20:27:36 +0000</created>
                <updated>Tue, 19 Sep 2023 10:28:19 +0000</updated>
                            <resolved>Tue, 19 Sep 2023 10:28:19 +0000</resolved>
                                    <version>1.15.4</version>
                    <version>1.16.2</version>
                    <version>1.18.0</version>
                    <version>1.17.1</version>
                                    <fixVersion>1.18.0</fixVersion>
                    <fixVersion>1.17.2</fixVersion>
                    <fixVersion>1.19.0</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17761797" author="a.pilipenko" created="Mon, 4 Sep 2023 11:52:28 +0000"  >&lt;p&gt;cc&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dianfu&quot; class=&quot;user-hover&quot; rel=&quot;dianfu&quot;&gt;dianfu&lt;/a&gt;,&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hxbks2ks&quot; class=&quot;user-hover&quot; rel=&quot;hxbks2ks&quot;&gt;hxbks2ks&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17762805" author="hong" created="Thu, 7 Sep 2023 16:28:56 +0000"  >&lt;p&gt;merged commit &lt;a href=&quot;https://github.com/apache/flink/commit/1193e178f6c478bf493231fc53c74f03158c0ca9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;1193e17&lt;/tt&gt;&lt;/a&gt; into apache:master&lt;/p&gt;</comment>
                            <comment id="17762807" author="hong" created="Thu, 7 Sep 2023 16:29:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=a.pilipenko&quot; class=&quot;user-hover&quot; rel=&quot;a.pilipenko&quot;&gt;a.pilipenko&lt;/a&gt;&#160; should we also backport this to Flink 1.17 and 1.18?&lt;/p&gt;</comment>
                            <comment id="17762927" author="dianfu" created="Fri, 8 Sep 2023 02:21:22 +0000"  >&lt;p&gt;+1 to backport to Flink 1.17 and 1.18, especially Flink 1.18.&lt;/p&gt;</comment>
                            <comment id="17763052" author="hong" created="Fri, 8 Sep 2023 11:08:37 +0000"  >&lt;p&gt;merged commit&#160;&lt;a href=&quot;https://github.com/apache/flink/commit/7f99a274f9912513479a6eeb8ed82d721a8aeb7f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;7f99a27&lt;/tt&gt;&lt;/a&gt;&#160;into&#160;apache:release-1.18&lt;/p&gt;</comment>
                            <comment id="17763326" author="a.pilipenko" created="Sat, 9 Sep 2023 10:32:59 +0000"  >&lt;p&gt;Fix for 1.18 has been merged, added&#160;&lt;a href=&quot;https://github.com/apache/flink/pull/23384&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; for 1.17 branch.&lt;/p&gt;</comment>
                            <comment id="17766736" author="hong" created="Tue, 19 Sep 2023 10:28:15 +0000"  >&lt;p&gt;merged commit&#160;&lt;a href=&quot;https://github.com/apache/flink/commit/f786dbea0be25cc62dc10311a8d64d9de2ee20dd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;f786dbe&lt;/tt&gt;&lt;/a&gt;&#160;into&#160;apache:release-1.17&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1k0oo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>