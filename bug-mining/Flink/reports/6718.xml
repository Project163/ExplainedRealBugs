<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:14:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-26726] Remove the unregistered  task from readersAwaitingSplit</title>
                <link>https://issues.apache.org/jira/browse/FLINK-26726</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Recently, we faced a problem caused by the unregistered task when using the hive table as a source to do streaming reading. &lt;br/&gt;
I think the problem is that we do not remove the unregistered  task from `readersAwaitingSplit` in `ContinuousHiveSplitEnumerator` and `ContinuousFileSplitEnumerator`.&lt;/p&gt;

&lt;p&gt;Assuming that we have two tasks 0 and 1, they all exist in `readersAwaitingSplit`,  if there does not exist any new file in the path for a long time. Then, a new split is generated, and it is assigned to task-1. Unfortunately, task-1 can not consume the split successfully, and the exception will be thrown and cause all tasks to restart. The failover will not affect the `readersAwaitingSplit`, but it will clear the `SourceCoordinatorContext#registeredReaders`.&lt;br/&gt;
After restarting, task-0 exists in `readersAwaitingSplit` but not in `registeredReaders`. if task-1 register first and send the request to get split, the SplitEnumerator will assign splits for both task-1 and task-0, but task-0 has not been registered.&lt;/p&gt;


&lt;p&gt;The stack exists in the attachment.&lt;/p&gt;



</description>
                <environment></environment>
        <key id="13434527">FLINK-26726</key>
            <summary>Remove the unregistered  task from readersAwaitingSplit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zoucao">zoucao</assignee>
                                    <reporter username="zoucao">zoucao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>stale-assigned</label>
                    </labels>
                <created>Fri, 18 Mar 2022 08:48:47 +0000</created>
                <updated>Fri, 14 Oct 2022 02:28:35 +0000</updated>
                            <resolved>Fri, 14 Oct 2022 02:28:29 +0000</resolved>
                                                    <fixVersion>1.16.0</fixVersion>
                    <fixVersion>1.17.0</fixVersion>
                    <fixVersion>1.15.3</fixVersion>
                    <fixVersion>1.14.7</fixVersion>
                                    <component>Connectors / Hive</component>
                    <component>Table SQL / Ecosystem</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17509555" author="zoucao" created="Mon, 21 Mar 2022 02:40:51 +0000"  >&lt;p&gt;Gentle ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;, could you help me to confirm it? The exception message exists in the attachment, and plz correct me in time if i missed something.&lt;/p&gt;</comment>
                            <comment id="17509608" author="lzljs3620320" created="Mon, 21 Mar 2022 05:45:42 +0000"  >&lt;p&gt;I think your analysis is correct. And the &lt;tt&gt;ContinuousFileSplitEnumerator is the correct one to deal with this behavior&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the reader that requested another split has failed in the meantime, remove
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// it from the list of waiting readers
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!context.registeredReaders().containsKey(nextAwaiting.getKey())) {
    awaitingReader.remove();
    &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17509611" author="lzljs3620320" created="Mon, 21 Mar 2022 05:47:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-20261&quot; title=&quot;Uncaught exception in ExecutorNotifier due to split assignment broken by failed task&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-20261&quot;&gt;&lt;del&gt;FLINK-20261&lt;/del&gt;&lt;/a&gt; is the Jira to fix this bug in ContinuousFileSplitEnumerator&lt;/p&gt;</comment>
                            <comment id="17509628" author="zoucao" created="Mon, 21 Mar 2022 06:22:12 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; , It is really fixed in  `ContinuousFileSplitEnumerator`,&#160;the repair maybe lost in `ContinuousHiveSplitEnumerator` ? &lt;/p&gt;</comment>
                            <comment id="17509837" author="lzljs3620320" created="Mon, 21 Mar 2022 13:15:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zoucao&quot; class=&quot;user-hover&quot; rel=&quot;zoucao&quot;&gt;zoucao&lt;/a&gt; Yes, indeed.&lt;/p&gt;</comment>
                            <comment id="17509840" author="lzljs3620320" created="Mon, 21 Mar 2022 13:16:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zoucao&quot; class=&quot;user-hover&quot; rel=&quot;zoucao&quot;&gt;zoucao&lt;/a&gt; I have assigned to you, If you don&apos;t have time to fix this, please let me know&lt;/p&gt;</comment>
                            <comment id="17509918" author="zoucao" created="Mon, 21 Mar 2022 14:35:15 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; , I will fix it as soon as possiable.&lt;/p&gt;</comment>
                            <comment id="17563106" author="flink-jira-bot" created="Wed, 6 Jul 2022 10:40:07 +0000"  >&lt;p&gt;I am the &lt;a href=&quot;https://github.com/apache/flink-jira-bot/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Flink Jira Bot&lt;/a&gt; and I help the community manage its development. I see this issue is assigned but has not received an update in 30 days, so it has been labeled &quot;stale-assigned&quot;.&lt;br/&gt;
If you are still working on the issue, please remove the label and add a comment updating the community on your progress.  If this issue is waiting on feedback, please consider this a reminder to the committer/reviewer. Flink is a very active project, and so we appreciate your patience.&lt;br/&gt;
If you are no longer working on the issue, please unassign yourself so someone else may work on it.&lt;/p&gt;</comment>
                            <comment id="17616389" author="jark" created="Wed, 12 Oct 2022 12:20:49 +0000"  >&lt;p&gt;Fixed in &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master: ab9e5844703848e79b2a62abae757bc6bd2268d9&lt;/li&gt;
	&lt;li&gt;release-1.16: 9935b0c56b646b301dbd4d11a0838aacfeb5430f&lt;/li&gt;
	&lt;li&gt;release-1.15: a826fe8d501ed8bdd9cbdc5febf7aac4cfa0b947&lt;/li&gt;
	&lt;li&gt;release-1.14: 81d2c1b340f3a4d063e97db2519d6911028d807d&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="13041308" name="stack.txt" size="5320" author="zoucao" created="Fri, 18 Mar 2022 08:48:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 4 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10lwo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>