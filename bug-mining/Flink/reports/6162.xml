<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:08:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-25486] Perjob can not recover from checkpoint when zookeeper leader changes</title>
                <link>https://issues.apache.org/jira/browse/FLINK-25486</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When the config high-availability.zookeeper.client.tolerate-suspended-connections is default false, the appMaster will failover once zk leader changes. In this case, the old appMaster will clean up all the zk info and the new appMaster will not recover from the latest checkpoint.&lt;/p&gt;

&lt;p&gt;The process is as following:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Start a perJob application.&lt;/li&gt;
	&lt;li&gt;kill zk&apos;s leade node which cause the perJob to suspend.&lt;/li&gt;
	&lt;li&gt;In MiniDispatcher&apos;s function jobReachedTerminalState, shutDownFuture is set to UNKNOWN .&lt;/li&gt;
	&lt;li&gt;The future is transferred to ClusterEntrypoint, the method is called with cleanupHaData true.&lt;/li&gt;
	&lt;li&gt;Clean up zk data and exit.&lt;/li&gt;
	&lt;li&gt;The new appMaster will not find any checkpoints to start and the state is lost.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Since the job can recover automatically when the zk leader changes, it is reasonable to keep zk info for the coming recovery.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13420014">FLINK-25486</key>
            <summary>Perjob can not recover from checkpoint when zookeeper leader changes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Jiangang">Liu</assignee>
                                    <reporter username="Jiangang">Liu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 30 Dec 2021 11:20:17 +0000</created>
                <updated>Sun, 30 Jan 2022 16:23:12 +0000</updated>
                            <resolved>Sat, 29 Jan 2022 15:45:53 +0000</resolved>
                                    <version>1.13.5</version>
                    <version>1.14.2</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.13.6</fixVersion>
                    <fixVersion>1.14.4</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17469196" author="jiangang" created="Wed, 5 Jan 2022 10:53:33 +0000"  >&lt;p&gt;Hello, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;. Can you verify the problem? If this is a problem, I would like to fix it. Thank you.&lt;/p&gt;</comment>
                            <comment id="17469226" author="till.rohrmann" created="Wed, 5 Jan 2022 11:34:34 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;, thanks for reporting this issue. I think this is indeed a bug and should be fixed. The problem seems as you described that the &lt;tt&gt;MiniDispatcher&lt;/tt&gt; completes the &lt;tt&gt;shutDownFuture&lt;/tt&gt; not only on globally terminal states.&lt;/p&gt;

&lt;p&gt;Do you want to work on it?&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvk&quot; class=&quot;user-hover&quot; rel=&quot;dmvk&quot;&gt;dmvk&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17469318" author="jiangang" created="Wed, 5 Jan 2022 13:40:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt; Thanks for the reply. It&apos;s also a problem in our production. I would like to fix it.&lt;/p&gt;</comment>
                            <comment id="17469327" author="davidmoravek" created="Wed, 5 Jan 2022 14:06:11 +0000"  >&lt;p&gt;+1, this indeed sounds like a bug&lt;/p&gt;</comment>
                            <comment id="17476068" author="jiangang" created="Fri, 14 Jan 2022 10:57:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvk&quot; class=&quot;user-hover&quot; rel=&quot;dmvk&quot;&gt;dmvk&lt;/a&gt; Could you please review the code? Thanks.&lt;/p&gt;</comment>
                            <comment id="17476072" author="davidmoravek" created="Fri, 14 Jan 2022 11:14:53 +0000"  >&lt;p&gt;Yes, I was off yesterday and I&apos;m swamped with reviews, this one is on the list. Please be patient &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17484182" author="till.rohrmann" created="Sat, 29 Jan 2022 15:45:53 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.15.0: 8ba13f37afb9164f3bb17de78c4b0d85b1633638&lt;br/&gt;
1.14.4: 0b519c24222f61306f9faba2389c0958daa9cc0a&lt;br/&gt;
1.13.6: fe5a1718368e62eb7ac47c00aabbd94173dae668&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0y4rc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>