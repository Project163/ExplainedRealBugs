<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2437] TypeExtractor.analyzePojo has some problems around the default constructor detection</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2437</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;If a class does have a default constructor, but the user forgot to make it public, then TypeExtractor.analyzePojo still thinks everything is OK, so it creates a PojoTypeInfo. Then PojoSerializer.createInstance blows up.&lt;/p&gt;

&lt;p&gt;Furthermore, a &quot;return null&quot; seems to be missing from the then case of the if after catching the NoSuchMethodException which would also cause a headache for PojoSerializer.&lt;/p&gt;

&lt;p&gt;An additional minor issue is that the word &quot;class&quot; is printed twice in several places, because class.toString also prepends it to the class name.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12850290">FLINK-2437</key>
            <summary>TypeExtractor.analyzePojo has some problems around the default constructor detection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggevay">G&#225;bor G&#233;vay</assignee>
                                    <reporter username="ggevay">G&#225;bor G&#233;vay</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jul 2015 15:38:05 +0000</created>
                <updated>Wed, 12 Aug 2015 10:32:09 +0000</updated>
                            <resolved>Wed, 12 Aug 2015 10:31:54 +0000</resolved>
                                    <version>0.9.0</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14647856" author="githubbot" created="Thu, 30 Jul 2015 15:52:38 +0000"  >&lt;p&gt;GitHub user ggevay opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2437&quot; title=&quot;TypeExtractor.analyzePojo has some problems around the default constructor detection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2437&quot;&gt;&lt;del&gt;FLINK-2437&lt;/del&gt;&lt;/a&gt; Fix default constructor detection in TypeExtractor.analyzePojo&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;handle the case of a non-public default constructor&lt;/li&gt;
	&lt;li&gt;added a missing &quot;return null&quot;&lt;/li&gt;
	&lt;li&gt;removed some duplicating of the word &quot;class&quot; when printing class&lt;br/&gt;
      names, because class.toString also prepends it to the class name&lt;/li&gt;
	&lt;li&gt;fixed a typo in the documentation describing POJOs&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ggevay/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ggevay/flink&lt;/a&gt; analyzePojoFix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #960&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7131c04ddc7ebce0b69bca1464c8312105ff9d92&lt;br/&gt;
Author: Gabor Gevay &amp;lt;ggab90@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-07-30T15:38:43Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2437&quot; title=&quot;TypeExtractor.analyzePojo has some problems around the default constructor detection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2437&quot;&gt;&lt;del&gt;FLINK-2437&lt;/del&gt;&lt;/a&gt; Fix default constructor detection in TypeExtractor.analyzePojo&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;handle the case of a non-public default constructor&lt;/li&gt;
	&lt;li&gt;added a missing &quot;return null&quot;&lt;/li&gt;
	&lt;li&gt;removed some duplicating of the word &quot;class&quot; when printing class&lt;br/&gt;
      names, because class.toString also prepends it to the class name&lt;/li&gt;
	&lt;li&gt;fixed a typo in the documentation describing POJOs&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="14647915" author="ggevay" created="Thu, 30 Jul 2015 16:43:37 +0000"  >&lt;p&gt;I just realized that it is not a problem that analyzePojo lets abstract classes through, so the &quot;return null&quot; is not missing, sorry.&lt;/p&gt;</comment>
                            <comment id="14647918" author="githubbot" created="Thu, 30 Jul 2015 16:45:01 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-126398181&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-126398181&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I removed the added &quot;return null&quot;, I just realized that it is not needed.&lt;/p&gt;</comment>
                            <comment id="14648106" author="githubbot" created="Thu, 30 Jul 2015 18:39:43 +0000"  >&lt;p&gt;Github user gyfora commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-126428191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-126428191&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Could you please add a test case that verifies the correct behaviour?&lt;/p&gt;</comment>
                            <comment id="14651093" author="githubbot" created="Sun, 2 Aug 2015 17:18:14 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-127046830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-127046830&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Why are you changing all messages in this pull request? They were not wrong before...&lt;/p&gt;</comment>
                            <comment id="14661581" author="githubbot" created="Fri, 7 Aug 2015 10:05:52 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-128662225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-128662225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Stephan is right. The changed messages just add noise to the pull request which makes it harder to review.&lt;/p&gt;</comment>
                            <comment id="14662340" author="githubbot" created="Fri, 7 Aug 2015 20:01:59 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-128819328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-128819328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    They print things like&lt;br/&gt;
    `Class class malom.GameState must have a default constructor to be used as a POJO.`&lt;br/&gt;
    If you think that the double &quot;class&quot; should be left the way it is, then I&apos;m sorry for changing them. I have now removed the changes from the PR.&lt;/p&gt;

&lt;p&gt;    I have also added a test.&lt;/p&gt;</comment>
                            <comment id="14680227" author="githubbot" created="Mon, 10 Aug 2015 14:58:49 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-129482084&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-129482084&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Removing the double &quot;class&quot; is actually not bad. Was hard to get this from the diff alone.&lt;/p&gt;

&lt;p&gt;    BTW: Simpler way may be to change the `aClass.toString()` call to `aClass.getCanonicalName()`.&lt;/p&gt;</comment>
                            <comment id="14682411" author="githubbot" created="Tue, 11 Aug 2015 20:15:03 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-130050479&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-130050479&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    OK, I re-added the changes to remove the double &quot;class&quot;. (Note, that the 3rd bullet in the opening comment refers to this doubling.)&lt;/p&gt;</comment>
                            <comment id="14693133" author="githubbot" created="Wed, 12 Aug 2015 08:40:46 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#discussion_r36837638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#discussion_r36837638&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java &amp;#8212;&lt;br/&gt;
    @@ -1328,24 +1329,29 @@ else if(typeHierarchy.size() &amp;lt;= 1) {&lt;br/&gt;
     		List&amp;lt;Method&amp;gt; methods = getAllDeclaredMethods(clazz);&lt;br/&gt;
     		for (Method method : methods) {&lt;br/&gt;
     			if (method.getName().equals(&quot;readObject&quot;) || method.getName().equals(&quot;writeObject&quot;)) &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot;+clazz+&quot; contains custom serialization methods we do not call.&quot;);
    +				LOG.info(clazz+&quot; contains custom serialization methods we do not call.&quot;);
     				return null;
     			}
&lt;p&gt;     		}&lt;/p&gt;

&lt;p&gt;     		// Try retrieving the default constructor, if it does not have one&lt;br/&gt;
     		// we cannot use this because the serializer uses it.&lt;br/&gt;
    +		Constructor defaultConstructor = null;&lt;br/&gt;
     		try &lt;/p&gt;
{
    -			clazz.getDeclaredConstructor();
    +			defaultConstructor = clazz.getDeclaredConstructor();
     		}
&lt;p&gt; catch (NoSuchMethodException e) {&lt;br/&gt;
     			if (clazz.isInterface() || Modifier.isAbstract(clazz.getModifiers())) &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot; + clazz + &quot; is abstract or an interface, having a concrete &quot; +
    +				LOG.info(clazz + &quot; is abstract or an interface, having a concrete &quot; +
     						&quot;type can increase performance.&quot;);
     			}
&lt;p&gt; else &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot; + clazz + &quot; must have a default constructor to be used as a POJO.&quot;);
    +				LOG.info(clazz + &quot; must have a default constructor to be used as a POJO.&quot;);
     				return null;
     			}
&lt;p&gt;     		}&lt;br/&gt;
    +		if(defaultConstructor != null &amp;amp;&amp;amp; (defaultConstructor.getModifiers() &amp;amp; Modifier.PUBLIC) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `if(defaultConstructor != null &amp;amp;&amp;amp; Modifier.isPublic(defaultConstructor.getModifiers())` seems to be more readable to me but your approach is fine too.&lt;/p&gt;</comment>
                            <comment id="14693141" author="githubbot" created="Wed, 12 Aug 2015 08:42:08 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-130219402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-130219402&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Your changes look good to merge.&lt;/p&gt;</comment>
                            <comment id="14693245" author="githubbot" created="Wed, 12 Aug 2015 10:00:13 +0000"  >&lt;p&gt;Github user ggevay commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#discussion_r36843332&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#discussion_r36843332&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java &amp;#8212;&lt;br/&gt;
    @@ -1328,24 +1329,29 @@ else if(typeHierarchy.size() &amp;lt;= 1) {&lt;br/&gt;
     		List&amp;lt;Method&amp;gt; methods = getAllDeclaredMethods(clazz);&lt;br/&gt;
     		for (Method method : methods) {&lt;br/&gt;
     			if (method.getName().equals(&quot;readObject&quot;) || method.getName().equals(&quot;writeObject&quot;)) &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot;+clazz+&quot; contains custom serialization methods we do not call.&quot;);
    +				LOG.info(clazz+&quot; contains custom serialization methods we do not call.&quot;);
     				return null;
     			}
&lt;p&gt;     		}&lt;/p&gt;

&lt;p&gt;     		// Try retrieving the default constructor, if it does not have one&lt;br/&gt;
     		// we cannot use this because the serializer uses it.&lt;br/&gt;
    +		Constructor defaultConstructor = null;&lt;br/&gt;
     		try &lt;/p&gt;
{
    -			clazz.getDeclaredConstructor();
    +			defaultConstructor = clazz.getDeclaredConstructor();
     		}
&lt;p&gt; catch (NoSuchMethodException e) {&lt;br/&gt;
     			if (clazz.isInterface() || Modifier.isAbstract(clazz.getModifiers())) &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot; + clazz + &quot; is abstract or an interface, having a concrete &quot; +
    +				LOG.info(clazz + &quot; is abstract or an interface, having a concrete &quot; +
     						&quot;type can increase performance.&quot;);
     			}
&lt;p&gt; else &lt;/p&gt;
{
    -				LOG.info(&quot;Class &quot; + clazz + &quot; must have a default constructor to be used as a POJO.&quot;);
    +				LOG.info(clazz + &quot; must have a default constructor to be used as a POJO.&quot;);
     				return null;
     			}
&lt;p&gt;     		}&lt;br/&gt;
    +		if(defaultConstructor != null &amp;amp;&amp;amp; (defaultConstructor.getModifiers() &amp;amp; Modifier.PUBLIC) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    You are right, I have changed  it.&lt;/p&gt;</comment>
                            <comment id="14693294" author="githubbot" created="Wed, 12 Aug 2015 10:29:55 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14693298" author="githubbot" created="Wed, 12 Aug 2015 10:32:09 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/960#issuecomment-130251642&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/960#issuecomment-130251642&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your contribution!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i4of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>