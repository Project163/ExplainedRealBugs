<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2412] Race leading to IndexOutOfBoundsException when querying for buffer while releasing SpillablePartition</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2412</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When running a code as simple as: &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

		DataSet&amp;lt;Edge&amp;lt;String, NullValue&amp;gt;&amp;gt; edges = getEdgesDataSet(env);
		Graph&amp;lt;String, NullValue, NullValue&amp;gt; graph = Graph.fromDataSet(edges, env);

		DataSet&amp;lt;Tuple2&amp;lt;String, Long&amp;gt;&amp;gt; degrees = graph.getDegrees();
degrees.writeAsCsv(outputPath, &quot;\n&quot;, &quot; &quot;);
			env.execute();

on the Freindster data set: https://snap.stanford.edu/data/com-Friendster.html; on 30 Wally nodes
 
I get the following exception:
java.lang.Exception: The data preparation for task &apos;CoGroup (CoGroup at inDegrees(Graph.java:701))&apos; , caused an error: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally028.cit.tu-berlin.de/130.149.249.38:53730&apos;.
	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)
	at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:362)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)
	at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.RuntimeException: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally028.cit.tu-berlin.de/130.149.249.38:53730&apos;.
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger.getIterator(UnilateralSortMerger.java:607)
	at org.apache.flink.runtime.operators.RegularPactTask.getInput(RegularPactTask.java:1145)
	at org.apache.flink.runtime.operators.CoGroupDriver.prepare(CoGroupDriver.java:98)
	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:466)
	... 3 more
Caused by: java.io.IOException: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally028.cit.tu-berlin.de/130.149.249.38:53730&apos;.
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:784)
Caused by: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Fatal error at remote task manager &apos;wally028.cit.tu-berlin.de/130.149.249.38:53730&apos;.
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.decodeMsg(PartitionRequestClientHandler.java:227)
	at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.channelRead(PartitionRequestClientHandler.java:162)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:242)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:847)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:131)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)
	at java.lang.Thread.run(Thread.java:722)
Caused by: java.io.IOException: Index: 133, Size: 0

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Code works fine for the twitter data set, for instance, which is bigger in size, but contains less vertices.  &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12849387">FLINK-2412</key>
            <summary>Race leading to IndexOutOfBoundsException when querying for buffer while releasing SpillablePartition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uce">Ufuk Celebi</assignee>
                                    <reporter username="andralungu">Andra Lungu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Jul 2015 17:57:09 +0000</created>
                <updated>Fri, 31 Jul 2015 09:03:53 +0000</updated>
                            <resolved>Fri, 31 Jul 2015 09:03:53 +0000</resolved>
                                    <version>0.9</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14644255" author="mxm" created="Tue, 28 Jul 2015 11:34:16 +0000"  >&lt;p&gt;Do you have the log file of the task manager where the error occurs? &lt;tt&gt;wally028.cit.tu-berlin.de/130.149.249.38:53730&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14644351" author="andralungu" created="Tue, 28 Jul 2015 13:10:32 +0000"  >&lt;p&gt;19:17:33,944 WARN  org.apache.hadoop.util.NativeCodeLoader                       - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - --------------------------------------------------------------------------------&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  Starting TaskManager (Version: 0.10-SNAPSHOT, Rev:590c6d0, Date:09.07.2015 @ 10:38:34 CEST)&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  Current user: andra.lungu&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  JVM: Java HotSpot(TM) 64-Bit Server VM - Oracle Corporation - 1.7/23.7-b01&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  Maximum heap size: 14720 MiBytes&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  JAVA_HOME: /usr/lib/jvm/oracle-jdk-bin-1.7&lt;br/&gt;
19:17:34,034 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  JVM Options:&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -Xms15360m&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -Xmx15360m&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -XX:MaxPermSize=256m&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -Dlog.file=/home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../log/flink-andra.lungu-taskmanager-0-wally012.log&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -Dlog4j.configuration=&lt;a href=&quot;file:/home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf/log4j.properties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf/log4j.properties&lt;/a&gt;&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     -Dlogback.configurationFile=&lt;a href=&quot;file:/home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf/logback.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf/logback.xml&lt;/a&gt;&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -  Program Arguments:&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     --configDir&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     /home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     --streamingMode&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              -     batch&lt;br/&gt;
19:17:34,035 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - --------------------------------------------------------------------------------&lt;br/&gt;
19:17:34,039 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Maximum number of open file descriptors is 50000&lt;br/&gt;
19:17:34,059 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Loading configuration from /home/andra.lungu/peel/systems/flink-0.10-SNAPSHOT/bin/../conf&lt;br/&gt;
19:17:34,106 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Security is not enabled. Starting non-authenticated TaskManager.&lt;br/&gt;
19:17:34,106 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Trying to select the network interface and address to use by connecting to the configured JobManager.&lt;br/&gt;
19:17:34,107 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager will try to connect for 120000 seconds before falling back to heuristics&lt;br/&gt;
19:17:34,468 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager will use hostname/address &apos;wally012.cit.tu-berlin.de&apos; (130.149.249.22) for communication.&lt;br/&gt;
19:17:34,468 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Starting TaskManager in streaming mode BATCH_ONLY&lt;br/&gt;
19:17:34,469 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Starting TaskManager actor system at wally012.cit.tu-berlin.de:0&lt;br/&gt;
19:17:34,769 INFO  akka.event.slf4j.Slf4jLogger                                  - Slf4jLogger started&lt;br/&gt;
19:17:34,801 INFO  Remoting                                                      - Starting remoting&lt;br/&gt;
19:17:34,918 INFO  Remoting                                                      - Remoting started; listening on addresses :&lt;span class=&quot;error&quot;&gt;&amp;#91;akka.tcp://flink@130.149.249.22:59193&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:17:34,922 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Starting TaskManager actor&lt;br/&gt;
19:17:34,927 INFO  org.apache.flink.runtime.io.network.netty.NettyConfig         - NettyConfig &lt;span class=&quot;error&quot;&gt;&amp;#91;server address: wally012.cit.tu-berlin.de/130.149.249.22, server port: 50815, memory segment size (bytes): 32768, transport type: NIO, number of server threads: 0 (use Netty&amp;#39;s default), number of client threads: 0 (use Netty&amp;#39;s default), server connect backlog: 0 (use Netty&amp;#39;s default), client connect timeout (sec): 120, send/receive buffer size (bytes): 0 (use Netty&amp;#39;s default)&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:17:34,929 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Messages between TaskManager and JobManager have a max timeout of 100000 milliseconds&lt;br/&gt;
19:17:34,930 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Temporary file directory &apos;/data/andra.lungu/flink_tmp&apos;: total 2685 GB, usable 2170 GB (80.82% usable)&lt;br/&gt;
19:17:35,329 INFO  org.apache.flink.runtime.io.network.buffer.NetworkBufferPool  - Allocated 1562 MB for network buffer pool (number of memory segments: 50000, bytes per segment: 32768).&lt;br/&gt;
19:17:35,838 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Using 0.4 of the currently free heap space for Flink managed memory (5256 MB).&lt;br/&gt;
19:17:37,053 INFO  org.apache.flink.runtime.io.disk.iomanager.IOManager          - I/O manager uses directory /data/andra.lungu/flink_tmp/flink-io-2440a2bc-630e-462b-914d-8c2de3904ed3 for spill files.&lt;br/&gt;
19:17:37,059 INFO  org.apache.flink.runtime.filecache.FileCache                  - User file cache uses directory /data/andra.lungu/flink_tmp/flink-dist-cache-ccb9c658-5888-4f68-947d-0bb2d5bbaf06&lt;br/&gt;
19:17:37,176 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Starting TaskManager actor at akka://flink/user/taskmanager#-1424706842.&lt;br/&gt;
19:17:37,176 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager data connection information: wally012.cit.tu-berlin.de (dataPort=50815)&lt;br/&gt;
19:17:37,176 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager has 8 task slot(s).&lt;br/&gt;
19:17:37,177 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Memory usage stats: &lt;span class=&quot;error&quot;&gt;&amp;#91;HEAP: 6936/14720/14720 MB, NON HEAP: 25/45/304 MB (used/committed/max)&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:17:37,179 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Trying to register at JobManager akka.tcp://flink@130.149.249.21:6123/user/jobmanager (attempt 1, timeout: 500 milliseconds)&lt;br/&gt;
19:17:37,275 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Successful registration at JobManager (akka.tcp://flink@130.149.249.21:6123/user/jobmanager), starting network stack and library cache.&lt;br/&gt;
19:17:37,381 INFO  org.apache.flink.runtime.io.network.netty.NettyClient         - Successful initialization (took 35 ms).&lt;br/&gt;
19:17:37,406 INFO  org.apache.flink.runtime.io.network.netty.NettyServer         - Successful initialization (took 25 ms). Listening on SocketAddress /130.149.249.22:50815.&lt;br/&gt;
19:17:37,407 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Determined BLOB server address to be /130.149.249.21:51598. Starting BLOB cache.&lt;br/&gt;
19:17:37,412 INFO  org.apache.flink.runtime.blob.BlobCache                       - Created BLOB cache storage directory /tmp/blobStore-c638b003-e58d-44ec-8ddc-5d7b2b13380e&lt;br/&gt;
19:18:41,199 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60)&lt;br/&gt;
19:18:41,359 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60)&lt;br/&gt;
19:18:41,841 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:41,841 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:41,926 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:42,372 INFO  org.apache.flink.runtime.blob.BlobCache                       - Downloading 4963176c3b88c01ef39ec57be1bf8e632a8548ab from /130.149.249.21:51598&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to RUNNING&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) switched to RUNNING&lt;br/&gt;
19:25:16,775 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to FINISHED&lt;br/&gt;
19:18:41,841 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:41,926 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:42,372 INFO  org.apache.flink.runtime.blob.BlobCache                       - Downloading 4963176c3b88c01ef39ec57be1bf8e632a8548ab from /130.149.249.21:51598&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to RUNNING&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) switched to RUNNING&lt;br/&gt;
19:25:16,775 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to FINISHED&lt;br/&gt;
19:18:41,841 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:41,926 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:18:42,372 INFO  org.apache.flink.runtime.blob.BlobCache                       - Downloading 4963176c3b88c01ef39ec57be1bf8e632a8548ab from /130.149.249.21:51598&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:22,169 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to RUNNING&lt;br/&gt;
19:19:47,991 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) switched to RUNNING&lt;br/&gt;
19:25:16,775 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60) switched to FINISHED&lt;br/&gt;
19:25:16,923 INFO  org.apache.flink.runtime.taskmanager.Task                     - Freeing task resources for CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (58/60)&lt;br/&gt;
19:25:16,986 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Unregistering task and sending final execution state FINISHED to JobManager for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (4b0325c8f21be79d7d3b059d49fb6ad9)&lt;br/&gt;
19:25:21,709 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60) switched to FINISHED&lt;br/&gt;
19:25:21,709 INFO  org.apache.flink.runtime.taskmanager.Task                     - Freeing task resources for CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (2/60)&lt;br/&gt;
19:25:21,761 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Unregistering task and sending final execution state FINISHED to JobManager for task CHAIN DataSource (at getEdgesDataSet(Degrees.java:64) (org.apache.flink.api.java.io.CsvInputFormat)) -&amp;gt; Map (Map at getEdgesDataSet(Degrees.java:64)) (bc512a37f814a788b13f1f8528127f47)&lt;br/&gt;
19:29:14,686 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (2/60)&lt;br/&gt;
19:29:14,687 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (2/60)&lt;br/&gt;
19:29:14,688 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (58/60)&lt;br/&gt;
19:29:14,727 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (58/60)&lt;br/&gt;
19:29:14,751 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (58/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:14,751 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (2/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:14,811 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CoGroup (CoGroup at outDegrees(Graph.java:671)) (5/60)&lt;br/&gt;
19:29:14,811 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CoGroup (CoGroup at outDegrees(Graph.java:671)) (5/60)&lt;br/&gt;
19:29:14,823 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CoGroup (CoGroup at outDegrees(Graph.java:671)) (5/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:14,880 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CoGroup (CoGroup at outDegrees(Graph.java:671)) (7/60)&lt;br/&gt;
19:29:14,881 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CoGroup (CoGroup at outDegrees(Graph.java:671)) (7/60)&lt;br/&gt;
19:29:14,913 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CoGroup (CoGroup at outDegrees(Graph.java:671)) (7/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:14,941 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CoGroup (CoGroup at inDegrees(Graph.java:701)) (7/60)&lt;br/&gt;
19:29:14,941 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CoGroup (CoGroup at inDegrees(Graph.java:701)) (7/60)&lt;br/&gt;
19:29:15,046 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CoGroup (CoGroup at inDegrees(Graph.java:701)) (7/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:15,066 INFO  org.apache.flink.runtime.taskmanager.Task                     - CoGroup (CoGroup at outDegrees(Graph.java:671)) (5/60) switched to RUNNING&lt;br/&gt;
19:29:15,066 INFO  org.apache.flink.runtime.taskmanager.Task                     - CoGroup (CoGroup at outDegrees(Graph.java:671)) (7/60) switched to RUNNING&lt;br/&gt;
19:29:15,067 INFO  org.apache.flink.runtime.taskmanager.Task                     - CoGroup (CoGroup at inDegrees(Graph.java:701)) (7/60) switched to RUNNING&lt;br/&gt;
19:29:15,067 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task CoGroup (CoGroup at inDegrees(Graph.java:701)) (8/60)&lt;br/&gt;
19:29:15,068 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task CoGroup (CoGroup at inDegrees(Graph.java:701)) (8/60)&lt;br/&gt;
19:29:15,070 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: CoGroup (CoGroup at inDegrees(Graph.java:701)) (8/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:15,074 INFO  org.apache.flink.runtime.taskmanager.Task                     - CoGroup (CoGroup at inDegrees(Graph.java:701)) (8/60) switched to RUNNING&lt;br/&gt;
19:29:15,526 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (58/60) switched to RUNNING&lt;br/&gt;
19:29:15,567 INFO  org.apache.flink.runtime.taskmanager.Task                     - CHAIN FlatMap (FlatMap at fromDataSet(Graph.java:171)) -&amp;gt; Combine(Distinct at fromDataSet(Graph.java:171)) (2/60) switched to RUNNING&lt;br/&gt;
19:29:28,270 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60)&lt;br/&gt;
19:29:28,352 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Received task Reduce (Distinct at fromDataSet(Graph.java:171)) (2/60)&lt;br/&gt;
19:29:28,399 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60)&lt;br/&gt;
19:29:28,399 INFO  org.apache.flink.runtime.taskmanager.Task                     - Loading JAR files for task Reduce (Distinct at fromDataSet(Graph.java:171)) (2/60)&lt;br/&gt;
19:29:28,494 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: Reduce (Distinct at fromDataSet(Graph.java:171)) (2/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:28,481 INFO  org.apache.flink.runtime.taskmanager.Task                     - Registering task at network: Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60) &lt;span class=&quot;error&quot;&gt;&amp;#91;DEPLOYING&amp;#93;&lt;/span&gt;&lt;br/&gt;
19:29:28,546 INFO  org.apache.flink.runtime.taskmanager.Task                     - Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60) switched to RUNNING&lt;br/&gt;
19:29:28,547 INFO  org.apache.flink.runtime.taskmanager.Task                     - Reduce (Distinct at fromDataSet(Graph.java:171)) (2/60) switched to RUNNING&lt;br/&gt;
19:31:25,216 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Discarding the results produced by task execution bc512a37f814a788b13f1f8528127f47&lt;br/&gt;
19:31:30,310 ERROR org.apache.flink.runtime.operators.RegularPactTask            - Error in task code:  Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60)&lt;br/&gt;
java.lang.Exception: The data preparation for task &apos;Reduce (Distinct at fromDataSet(Graph.java:171))&apos; , caused an error: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:362)&lt;br/&gt;
        at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
Caused by: java.lang.RuntimeException: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.sort.UnilateralSortMerger.getIterator(UnilateralSortMerger.java:607)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.getInput(RegularPactTask.java:1145)&lt;br/&gt;
        at org.apache.flink.runtime.operators.GroupReduceDriver.prepare(GroupReduceDriver.java:94)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:466)&lt;br/&gt;
        ... 3 more&lt;br/&gt;
Caused by: java.io.IOException: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:784)&lt;br/&gt;
Caused by: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.decodeMsg(PartitionRequestClientHandler.java:239)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.channelRead(PartitionRequestClientHandler.java:162)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:242)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:847)&lt;br/&gt;
        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:131)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)&lt;br/&gt;
        at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
Caused by: org.apache.flink.runtime.io.network.partition.ProducerFailedException: java.lang.IndexOutOfBoundsException: Index: 2856, Size: 0&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.writeAndFlushNextMessageIfPossible(PartitionRequestQueue.java:164)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.userEventTriggered(PartitionRequestQueue.java:96)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeUserEventTriggered(AbstractChannelHandlerContext.java:308)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireUserEventTriggered(AbstractChannelHandlerContext.java:294)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.userEventTriggered(ChannelInboundHandlerAdapter.java:108)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeUserEventTriggered(AbstractChannelHandlerContext.java:308)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireUserEventTriggered(AbstractChannelHandlerContext.java:294)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.userEventTriggered(ChannelInboundHandlerAdapter.java:108)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeUserEventTriggered(AbstractChannelHandlerContext.java:308)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireUserEventTriggered(AbstractChannelHandlerContext.java:294)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.userEventTriggered(ChannelInboundHandlerAdapter.java:108)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeUserEventTriggered(AbstractChannelHandlerContext.java:308)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.access$500(AbstractChannelHandlerContext.java:32)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext$6.run(AbstractChannelHandlerContext.java:299)&lt;br/&gt;
        at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:357)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:357)&lt;br/&gt;
        ... 2 more&lt;br/&gt;
Caused by: java.lang.IndexOutOfBoundsException: Index: 2856, Size: 0&lt;br/&gt;
        at java.util.ArrayList.rangeCheck(ArrayList.java:604)&lt;br/&gt;
        at java.util.ArrayList.get(ArrayList.java:382)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.partition.SpillableSubpartitionView.getNextBuffer(SpillableSubpartitionView.java:78)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.partition.consumer.LocalInputChannel.getNextLookAhead(LocalInputChannel.java:256)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.partition.consumer.LocalInputChannel.getNextBuffer(LocalInputChannel.java:166)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.getNextBufferOrEvent(SingleInputGate.java:407)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:76)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:34)&lt;br/&gt;
        at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:73)&lt;br/&gt;
        at org.apache.flink.runtime.operators.FlatMapDriver.run(FlatMapDriver.java:101)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:496)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:362)&lt;br/&gt;
        at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)&lt;br/&gt;
        ... 1 more&lt;br/&gt;
19:31:30,382 ERROR org.apache.flink.runtime.operators.RegularPactTask            - Error in task code:  CoGroup (CoGroup at outDegrees(Graph.java:671)) (5/60)&lt;br/&gt;
java.lang.Exception: The data preparation for task &apos;CoGroup (CoGroup at outDegrees(Graph.java:671))&apos; , caused an error: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:362)&lt;br/&gt;
        at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
Caused by: java.lang.RuntimeException: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.sort.UnilateralSortMerger.getIterator(UnilateralSortMerger.java:607)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.getInput(RegularPactTask.java:1145)&lt;br/&gt;
        at org.apache.flink.runtime.operators.CoGroupDriver.prepare(CoGroupDriver.java:98)&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:466)&lt;br/&gt;
        ... 3 more&lt;br/&gt;
Caused by: java.io.IOException: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Fatal error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:784)&lt;br/&gt;
Caused by: org.apache.flink.runtime.io.network.netty.exception.RemoteTransportException: Fatal error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.decodeMsg(PartitionRequestClientHandler.java:227)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestClientHandler.channelRead(PartitionRequestClientHandler.java:162)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:242)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:339)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:324)&lt;br/&gt;
        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:847)&lt;br/&gt;
        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:131)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:511)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)&lt;br/&gt;
        at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
Caused by: java.io.IOException: Index: 166, Size: 0&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.writeAndFlushNextMessageIfPossible(PartitionRequestQueue.java:197)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.channelWritabilityChanged(PartitionRequestQueue.java:135)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelWritabilityChanged(AbstractChannelHandlerContext.java:438)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelWritabilityChanged(AbstractChannelHandlerContext.java:420)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.channelWritabilityChanged(ChannelInboundHandlerAdapter.java:119)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelWritabilityChanged(AbstractChannelHandlerContext.java:438)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelWritabilityChanged(AbstractChannelHandlerContext.java:420)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.channelWritabilityChanged(ChannelInboundHandlerAdapter.java:119)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelWritabilityChanged(AbstractChannelHandlerContext.java:438)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelWritabilityChanged(AbstractChannelHandlerContext.java:420)&lt;br/&gt;
        at io.netty.channel.ChannelInboundHandlerAdapter.channelWritabilityChanged(ChannelInboundHandlerAdapter.java:119)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelWritabilityChanged(AbstractChannelHandlerContext.java:438)&lt;br/&gt;
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelWritabilityChanged(AbstractChannelHandlerContext.java:420)&lt;br/&gt;
        at io.netty.channel.DefaultChannelPipeline.fireChannelWritabilityChanged(DefaultChannelPipeline.java:862)&lt;br/&gt;
        at io.netty.channel.ChannelOutboundBuffer.fireChannelWritabilityChanged(ChannelOutboundBuffer.java:557)&lt;br/&gt;
        at io.netty.channel.ChannelOutboundBuffer.setWritable(ChannelOutboundBuffer.java:523)&lt;br/&gt;
        at io.netty.channel.ChannelOutboundBuffer.decrementPendingOutboundBytes(ChannelOutboundBuffer.java:196)&lt;br/&gt;
        at io.netty.channel.ChannelOutboundBuffer.remove(ChannelOutboundBuffer.java:260)&lt;br/&gt;
        at io.netty.channel.ChannelOutboundBuffer.removeBytes(ChannelOutboundBuffer.java:334)&lt;br/&gt;
        at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:317)&lt;br/&gt;
        at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:750)&lt;br/&gt;
        at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:309)&lt;br/&gt;
        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:519)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
Caused by: java.lang.IndexOutOfBoundsException: Index: 166, Size: 0&lt;br/&gt;
        at java.util.ArrayList.rangeCheck(ArrayList.java:604)&lt;br/&gt;
        at java.util.ArrayList.get(ArrayList.java:382)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.partition.SpillableSubpartitionView.getNextBuffer(SpillableSubpartitionView.java:78)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue$SequenceNumberingSubpartitionView.getNextBuffer(PartitionRequestQueue.java:295)&lt;br/&gt;
        at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.writeAndFlushNextMessageIfPossible(PartitionRequestQueue.java:152)&lt;br/&gt;
        ... 27 more&lt;br/&gt;
19:31:31,745 INFO  org.apache.flink.runtime.taskmanager.Task                     - Reduce (Distinct at fromDataSet(Graph.java:171)) (4/60) switched to FAILED with exception.&lt;br/&gt;
java.lang.Exception: The data preparation for task &apos;Reduce (Distinct at fromDataSet(Graph.java:171))&apos; , caused an error: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Error at remote task manager &apos;wally019.cit.tu-berlin.de/130.149.249.29:56160&apos;.&lt;br/&gt;
        at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)&lt;/p&gt;


&lt;p&gt;..... goes on like this; then cancels the remaining tasks...&lt;/p&gt;</comment>
                            <comment id="14644458" author="uce" created="Tue, 28 Jul 2015 14:40:31 +0000"  >&lt;p&gt;Thanks for reporting the issue. Looks like a bug while reading from a spilling partition. I&apos;m on it.&lt;/p&gt;</comment>
                            <comment id="14647546" author="uce" created="Thu, 30 Jul 2015 12:22:11 +0000"  >&lt;p&gt;I found a race when releasing a partition and requesting a buffer. That was also the only line in the code, where the IoB exception can happen.&lt;/p&gt;

&lt;p&gt;Can you try this branch and report back? &lt;a href=&quot;https://github.com/uce/flink/tree/iob-2412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/uce/flink/tree/iob-2412&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14648170" author="andralungu" created="Thu, 30 Jul 2015 19:30:13 +0000"  >&lt;p&gt;Hi Ufuk, &lt;/p&gt;

&lt;p&gt;The fix has been tested and retested... As you may recall I had two experiments failing with this exception:&lt;br/&gt;
1) The degrees experiment is running smoothly.&lt;br/&gt;
2). This one: &lt;a href=&quot;https://github.com/andralungu/gelly-partitioning/blob/master/src/main/java/example/JaccardSimilarityMeasure.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/andralungu/gelly-partitioning/blob/master/src/main/java/example/JaccardSimilarityMeasure.java&lt;/a&gt;&lt;br/&gt;
Still fails for: &lt;a href=&quot;https://drive.google.com/file/d/0BwnaKJcSLc43N0Y2SkRLOGRuSkE/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0BwnaKJcSLc43N0Y2SkRLOGRuSkE/view?usp=sharing&lt;/a&gt;&lt;br/&gt;
Here are, hopefully I copied the right ones&lt;span class=&quot;error&quot;&gt;&amp;#91;just the ones with *0* are the correct ones; ignore the ones with *1*&amp;#93;&lt;/span&gt;, the complete logs plus the stacktrace with the exception (output_ufuk_jac.log):&lt;br/&gt;
&lt;a href=&quot;https://drive.google.com/file/d/0BwnaKJcSLc43NU9BS0xtSnJOTkd3SnltMllDYXVfMzc1RjRV/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0BwnaKJcSLc43NU9BS0xtSnJOTkd3SnltMllDYXVfMzc1RjRV/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
Andra&lt;/p&gt;</comment>
                            <comment id="14648920" author="uce" created="Fri, 31 Jul 2015 08:29:03 +0000"  >&lt;p&gt;Hey Andra,&lt;/p&gt;

&lt;p&gt;these are two seperate issues. The failure I&apos;ve fixed is indeed fixed. Thanks for your help and the traces and logs.&lt;/p&gt;

&lt;p&gt;The other Exception occurs in the serializer:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.Exception: The data preparation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task &lt;span class=&quot;code-quote&quot;&gt;&apos;CoGroup (CoGroup at groupReduceOnNeighbors(Graph.java:1405))&apos;&lt;/span&gt; , caused an error: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger spilling thread&apos;&lt;/span&gt; terminated due to an exception: Index: 53, Size: 0
	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:476)
	at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:366)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:576)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
Caused by: java.lang.RuntimeException: Error obtaining the sorted input: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger spilling thread&apos;&lt;/span&gt; terminated due to an exception: Index: 53, Size: 0
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger.getIterator(UnilateralSortMerger.java:607)
	at org.apache.flink.runtime.operators.RegularPactTask.getInput(RegularPactTask.java:1096)
	at org.apache.flink.runtime.operators.CoGroupDriver.prepare(CoGroupDriver.java:98)
	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)
	... 3 more
Caused by: java.io.IOException: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;SortMerger spilling thread&apos;&lt;/span&gt; terminated due to an exception: Index: 53, Size: 0
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:784)
Caused by: java.lang.IndexOutOfBoundsException: Index: 53, Size: 0
	at java.util.ArrayList.rangeCheck(ArrayList.java:604)
	at java.util.ArrayList.get(ArrayList.java:382)
	at com.esotericsoftware.kryo.util.MapReferenceResolver.getReadObject(MapReferenceResolver.java:42)
	at com.esotericsoftware.kryo.Kryo.readReferenceOrNull(Kryo.java:805)
	at com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:759)
	at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.deserialize(KryoSerializer.java:211)
	at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.deserialize(TupleSerializer.java:127)
	at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.deserialize(TupleSerializer.java:30)
	at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.deserialize(TupleSerializer.java:127)
	at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.deserialize(TupleSerializer.java:30)
	at org.apache.flink.runtime.operators.sort.NormalizedKeySorter.writeToOutput(NormalizedKeySorter.java:531)
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$SpillingThread.go(UnilateralSortMerger.java:1328)
	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:781)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will go ahead and push my fix and open a separate issue for the new problem. In general, I think it&apos;s easier to track problems with one issue per problem. In your case both were IndexOutOfBoundsExceptions, but unrelated ones.&lt;/p&gt;</comment>
                            <comment id="14648956" author="uce" created="Fri, 31 Jul 2015 09:03:53 +0000"  >&lt;p&gt;Fixed via a56aad7 (0.10) and 012dd05 (0.9.1).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hz9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>