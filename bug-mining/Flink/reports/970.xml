<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3519] Subclasses of Tuples don&apos;t work if the declared type of a DataSet is not the descendant</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3519</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;If I have a subclass of TupleN, then objects of this type will turn into TupleNs when I try to use them in a DataSet&amp;lt;TupleN&amp;gt;.&lt;/p&gt;

&lt;p&gt;For example, if I have a class like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Tuple1&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt; a;

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Foo() {}

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Foo(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; f0, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a) {
		&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.f0 = f0;
		&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.a = (&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;)a;
	}

	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;(&quot;&lt;/span&gt; + f0 + &lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt; + a + &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;;
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And then I do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;env.fromElements(0,0,0).map(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapFunction&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, Tuple1&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt;() {
	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Tuple1&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; value) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(5, 6);
	}
}).print();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then I don&apos;t have Foos in the output, but only Tuples:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(5)
(5)
(5)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is caused by the TupleSerializer not caring about subclasses at all. I guess the reason for this is performance: we don&apos;t want to deal with writing and reading subclass tags when we have Tuples.&lt;/p&gt;

&lt;p&gt;I see three options for solving this:&lt;br/&gt;
1. Add subclass tags to the TupleSerializer: This is not really an option, because we don&apos;t want to loose performance.&lt;br/&gt;
2. Document this behavior in the javadoc of the Tuple classes.&lt;br/&gt;
3. Make the Tuple types final: this would be the clean solution, but it is API breaking, and the first victim would be Gelly: the Vertex and Edge types extend from tuples. (Note that the issue doesn&apos;t appear there, because the DataSets there always have the type of the descendant class.)&lt;/p&gt;

&lt;p&gt;When deciding between 2. and 3., an important point to note is that if you have your class extend from a Tuple type instead of just adding the f0, f1, ... fields manually in the hopes of getting the performance boost associated with Tuples, then you are out of luck: the PojoSerializer will kick in anyway when the declared types of your DataSets are the descendant type.&lt;/p&gt;

&lt;p&gt;If someone knows about a good reason to extend from a Tuple class, then please comment.&lt;/p&gt;

&lt;p&gt;For 2., this is a suggested wording for the javadoc of the Tuple classes:&lt;br/&gt;
Warning: Please don&apos;t subclass Tuple classes, but if you do, then be sure to always declare the element type of your DataSets to your descendant type. (That is, if you have a &quot;class A extends Tuple2&quot;, then don&apos;t use instances of A in a DataSet&amp;lt;Tuple2&amp;gt;, but use DataSet&amp;lt;A&amp;gt;.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12944848">FLINK-3519</key>
            <summary>Subclasses of Tuples don&apos;t work if the declared type of a DataSet is not the descendant</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="11">Done</resolution>
                                        <assignee username="ggevay">G&#225;bor G&#233;vay</assignee>
                                    <reporter username="ggevay">G&#225;bor G&#233;vay</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Feb 2016 10:22:26 +0000</created>
                <updated>Wed, 4 May 2016 19:28:03 +0000</updated>
                            <resolved>Wed, 4 May 2016 19:28:03 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15168787" author="stephanewen" created="Fri, 26 Feb 2016 10:27:23 +0000"  >&lt;p&gt;We came across this issue before.&lt;/p&gt;

&lt;p&gt;We decided back then that Tuples should be the high-performance data types without subclass handling.&lt;br/&gt;
Subclass handling applies only to PoJos.&lt;/p&gt;

&lt;p&gt;I am still in favor of that solution, actually. Maybe some checks would be good to avoid the confusion.&lt;/p&gt;</comment>
                            <comment id="15168808" author="ggevay" created="Fri, 26 Feb 2016 10:40:25 +0000"  >&lt;p&gt;So you mean that you are in favor of 2?&lt;/p&gt;</comment>
                            <comment id="15168811" author="stephanewen" created="Fri, 26 Feb 2016 10:48:53 +0000"  >&lt;p&gt;Yes, I would be in favor of (2).&lt;br/&gt;
Although, in my experience, few users bother with reading the JavaDocs, so this will not catch it in many cases.&lt;/p&gt;</comment>
                            <comment id="15168812" author="ggevay" created="Fri, 26 Feb 2016 10:52:04 +0000"  >&lt;p&gt;But if you were aware of this problem, then what was the original reason for not making them final?&lt;/p&gt;</comment>
                            <comment id="15168823" author="stephanewen" created="Fri, 26 Feb 2016 11:05:57 +0000"  >&lt;p&gt;To allow subclass usage in the style of Gelly&lt;/p&gt;</comment>
                            <comment id="15168836" author="ggevay" created="Fri, 26 Feb 2016 11:21:09 +0000"  >&lt;p&gt;OK, I have found a good reason for the Gelly style subclassing: the getField(int pos), setField(int pos) methods are actually handy sometimes.&lt;/p&gt;

&lt;p&gt;Then I&apos;ll create a PR with (2).&lt;/p&gt;</comment>
                            <comment id="15169190" author="githubbot" created="Fri, 26 Feb 2016 15:31:23 +0000"  >&lt;p&gt;GitHub user ggevay opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3519&quot; title=&quot;Subclasses of Tuples don&amp;#39;t work if the declared type of a DataSet is not the descendant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3519&quot;&gt;&lt;del&gt;FLINK-3519&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Add warning about subclasses to Tuple javadocs.&lt;/p&gt;

&lt;p&gt;    I went with option (2), that is, adding a warning to the javadocs.&lt;/p&gt;

&lt;p&gt;    The generated classes were out of sync with the TupleGenerator, so the first commit just brings the TupleGenerator up-to-date.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ggevay/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ggevay/flink&lt;/a&gt; tuple-subclass&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1724&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit dcd70fb46d7b5235dd246bc40528f48cae4590ba&lt;br/&gt;
Author: Gabor Gevay &amp;lt;ggab90@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-26T15:09:56Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Bring TupleGenerator up to date with the Tuple classes.&lt;/p&gt;

&lt;p&gt;commit 3c96f85c8fec39d13ebc97b1e7761ee76cf23086&lt;br/&gt;
Author: Gabor Gevay &amp;lt;ggab90@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-26T15:16:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3519&quot; title=&quot;Subclasses of Tuples don&amp;#39;t work if the declared type of a DataSet is not the descendant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3519&quot;&gt;&lt;del&gt;FLINK-3519&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Add warning about subclasses to Tuple javadocs.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15169202" author="githubbot" created="Fri, 26 Feb 2016 15:40:09 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-189326695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-189326695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I have also added that a subclass of TupleN can only be a POJO. (see TypeExtractor.java:1686)&lt;/p&gt;</comment>
                            <comment id="15169440" author="githubbot" created="Fri, 26 Feb 2016 18:03:49 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-189400067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-189400067&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Good idea to update these comments.&lt;/p&gt;

&lt;p&gt;    I am not quite sure even, if Tuple subclasses have to be POJOs.&lt;/p&gt;</comment>
                            <comment id="15171709" author="githubbot" created="Mon, 29 Feb 2016 10:23:55 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-190143075&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-190143075&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;gt; I am not quite sure even, if Tuple subclasses have to be POJOs.&lt;/p&gt;

&lt;p&gt;    I wrote that based on the comment at TypeExtractor.java:1687. (I also tried adding a check there for the result of the analyzePojo call being null, and calling privateGetForClass in this case, but then I get an exception from TypeExtractor.java:1379.)&lt;/p&gt;</comment>
                            <comment id="15191343" author="githubbot" created="Fri, 11 Mar 2016 18:32:41 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-195490545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-195490545&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    What kind of exception do you get?&lt;/p&gt;

&lt;p&gt;    Also, subclasses of tuples that do not have additional fields can need not be Pojos (even though Tuples by themselves should actually meet the Pojo rules)&lt;/p&gt;</comment>
                            <comment id="15222156" author="githubbot" created="Fri, 1 Apr 2016 18:48:01 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-204517362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-204517362&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks, I like the docs now!&lt;br/&gt;
    Sorry for nitpicking, but could you&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make the bullet list in the docs use the html tags (`&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;`)? It does not render properly in the docs otherwise.&lt;/li&gt;
	&lt;li&gt;Write references to for example `DataSet&amp;lt;Tuple10&amp;gt;` as `DataStream&amp;lt;Tuple10&amp;gt;`/`DataSet&amp;lt;Tuple10&amp;gt;`? I think the DataStream API is used more by now, so would be nice to have it in there.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15222822" author="githubbot" created="Sat, 2 Apr 2016 09:30:27 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-204682353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-204682353&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    OK, no problem, I&apos;ve updated the PR.&lt;/p&gt;</comment>
                            <comment id="15267587" author="githubbot" created="Mon, 2 May 2016 21:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-216378193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-216378193&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 to merge&lt;/p&gt;</comment>
                            <comment id="15270795" author="githubbot" created="Wed, 4 May 2016 15:13:24 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724#issuecomment-216896787&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724#issuecomment-216896787&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging&lt;/p&gt;</comment>
                            <comment id="15271259" author="githubbot" created="Wed, 4 May 2016 19:22:55 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1724&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1724&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15271278" author="fhueske" created="Wed, 4 May 2016 19:28:03 +0000"  >&lt;p&gt;Done for 1.1.0 with f186446d015f3fb676012ff416fde64808449250&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2tt33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>