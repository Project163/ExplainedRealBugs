<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:55:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-21386] FromElements ignores returns()</title>
                <link>https://issues.apache.org/jira/browse/FLINK-21386</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;StreamExEnv#fromElements eagerly serializes data with the automatically determined serializer. This can result in errors for example when generic avro records are used, because it will default to Kryo.&lt;/p&gt;

&lt;p&gt;Subsequent calls to returns() have no effect because the typeinformation is never forwarded to the function.&lt;/p&gt;

&lt;p&gt;Annoyingly the fact that it serializes data isn&apos;t logged anywhere. and there doesn&apos;t seem to be a way to change the serializer except by using fromCollection() instead.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13358964">FLINK-21386</key>
            <summary>FromElements ignores returns()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kezhuw">Kezhu Wang</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>usability</label>
                    </labels>
                <created>Tue, 16 Feb 2021 23:14:02 +0000</created>
                <updated>Fri, 28 May 2021 09:00:51 +0000</updated>
                            <resolved>Thu, 8 Apr 2021 07:59:13 +0000</resolved>
                                    <version>1.13.0</version>
                                    <fixVersion>1.13.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17292152" author="kezhuw" created="Sat, 27 Feb 2021 14:37:44 +0000"  >&lt;p&gt;I think implementing &lt;tt&gt;OutputTypeConfigurable&lt;/tt&gt; for &lt;tt&gt;FromElementsFunction&lt;/tt&gt; could solve this. &lt;tt&gt;AbstractUdfStreamOperator&lt;/tt&gt; will redirect &lt;tt&gt;OutputTypeConfigurable&lt;/tt&gt; to user defined function. Here is my proposed steps:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Store a &lt;tt&gt;transient&lt;/tt&gt; &lt;tt&gt;elements&lt;/tt&gt; field for original elements.&lt;/li&gt;
	&lt;li&gt;Keep eagerly serialization but re-serialize if serializer from &lt;tt&gt;setOutputType&lt;/tt&gt; differs from existing one.&lt;/li&gt;
	&lt;li&gt;Add new constructors with no &lt;tt&gt;serializer&lt;/tt&gt; to postpone serialization to &lt;tt&gt;setOutputType&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt; What do you think ?&lt;/p&gt;</comment>
                            <comment id="17292736" author="zentol" created="Mon, 1 Mar 2021 08:53:36 +0000"  >&lt;p&gt;How does that address the issue of the function using kryo in the first place (aka, not automatically determining that avro should be used)?&lt;/p&gt;</comment>
                            <comment id="17292765" author="kezhuw" created="Mon, 1 Mar 2021 09:25:45 +0000"  >&lt;p&gt;&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; Combination of #1 and #3 could solve this. In construction of &lt;tt&gt;FromElementsFunction&lt;/tt&gt;, only &lt;tt&gt;elements&lt;/tt&gt; will pass to constructor. In stream graph generation, &lt;tt&gt;setOutputType&lt;/tt&gt; will be called with correct serializer and we can generate serialized data in that stage. In case that incorrect serializer will success in serialization(eg. kryo case as I tested), combination of #1 and #2 could also solve this. But there might be some waste and indeterminate for other incorrect serializer, I plan to no serializer in construction in first place.&lt;/p&gt;</comment>
                            <comment id="17292831" author="zentol" created="Mon, 1 Mar 2021 11:11:32 +0000"  >&lt;p&gt;&lt;tt&gt;OutputTypeConfigurable&lt;/tt&gt; only works for operators, not functions.&lt;/p&gt;</comment>
                            <comment id="17292839" author="kezhuw" created="Mon, 1 Mar 2021 11:35:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; It works for function also, I have verified that. &lt;tt&gt;AbstractUdfStreamOperator&lt;/tt&gt; will redirect &lt;tt&gt;setOutputType&lt;/tt&gt; to its &lt;tt&gt;userFunction&lt;/tt&gt;. I also planed to write a test in &lt;tt&gt;StreamGraphGeneratorTest&lt;/tt&gt; to assert this, there are tests for operators already. I just pushed a preview &lt;a href=&quot;https://github.com/kezhuw/flink/commit/a48df8a13ae75da954bd3cbbdf1ffc68c7ae135c#diff-8a1048680bd7aefdaf6d1007f9065b4f85a04c8a8ff9e936ad202b979df0874fR212&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt; if you are unsure with this.&lt;/p&gt;</comment>
                            <comment id="17307087" author="kezhuw" created="Tue, 23 Mar 2021 13:56:16 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;&#160;could I take over this ?&lt;/p&gt;</comment>
                            <comment id="17316086" author="dawidwys" created="Wed, 7 Apr 2021 07:48:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kezhuw&quot; class=&quot;user-hover&quot; rel=&quot;kezhuw&quot;&gt;kezhuw&lt;/a&gt;,&lt;br/&gt;
Would you still like to work on this for 1.13?&lt;/p&gt;</comment>
                            <comment id="17316150" author="kezhuw" created="Wed, 7 Apr 2021 09:09:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;, I could give it a try.&lt;/p&gt;</comment>
                            <comment id="17316941" author="dawidwys" created="Thu, 8 Apr 2021 07:59:13 +0000"  >&lt;p&gt;Fixed in 0fc03e408cb80f37699e116230a5876dd7ff03e9&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nqio:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>