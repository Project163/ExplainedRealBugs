<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:07:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24800] BufferTimeoutITCase.testDisablingBufferTimeout failed on Azure</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24800</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-11-05T12:18:50.5272055Z Nov 05 12:18:50 [INFO] Results:
2021-11-05T12:18:50.5273369Z Nov 05 12:18:50 [INFO] 
2021-11-05T12:18:50.5274011Z Nov 05 12:18:50 [ERROR] Failures: 
2021-11-05T12:18:50.5274518Z Nov 05 12:18:50 [ERROR]   BufferTimeoutITCase.testDisablingBufferTimeout:85 
2021-11-05T12:18:50.5274871Z Nov 05 12:18:50 Expected: &amp;lt;0&amp;gt;
2021-11-05T12:18:50.5275150Z Nov 05 12:18:50      but: was &amp;lt;1&amp;gt;
2021-11-05T12:18:50.5276136Z Nov 05 12:18:50 [INFO] 
2021-11-05T12:18:50.5276667Z Nov 05 12:18:50 [ERROR] Tests run: 1849, Failures: 1, Errors: 0, Skipped: 58
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26018&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10850&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26018&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10850&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13410262">FLINK-24800</key>
            <summary>BufferTimeoutITCase.testDisablingBufferTimeout failed on Azure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="akalashnikov">Anton Kalashnikov</assignee>
                                    <reporter username="gaoyunhaii">Yun Gao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 5 Nov 2021 14:00:03 +0000</created>
                <updated>Wed, 15 Dec 2021 01:44:06 +0000</updated>
                            <resolved>Thu, 11 Nov 2021 13:40:49 +0000</resolved>
                                    <version>1.13.3</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.14.3</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Runtime / Network</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17440343" author="zentol" created="Mon, 8 Nov 2021 10:07:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26021&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26021&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440356" author="till.rohrmann" created="Mon, 8 Nov 2021 10:20:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26104&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5116&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26104&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5116&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440357" author="till.rohrmann" created="Mon, 8 Nov 2021 10:20:34 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440957" author="till.rohrmann" created="Tue, 9 Nov 2021 08:01:53 +0000"  >&lt;p&gt;Another instance: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26136&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=4736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26136&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=4736&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440958" author="till.rohrmann" created="Tue, 9 Nov 2021 08:02:15 +0000"  >&lt;p&gt;Can we disable this test and create a blocker for fixing it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17440961" author="till.rohrmann" created="Tue, 9 Nov 2021 08:05:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26158&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10759&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26158&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10759&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440971" author="till.rohrmann" created="Tue, 9 Nov 2021 08:22:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26181&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5061&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26181&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5061&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17441040" author="till.rohrmann" created="Tue, 9 Nov 2021 10:16:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26142&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26142&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5119&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17441553" author="fabian.paul" created="Wed, 10 Nov 2021 07:39:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26241&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26241&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17441565" author="till.rohrmann" created="Wed, 10 Nov 2021 08:11:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26239&amp;amp;view=logs&amp;amp;j=d8d26c26-7ec2-5ed2-772e-7a1a1eb8317c&amp;amp;t=ec8797b0-5eee-5a0e-f936-8db65cff44cc&amp;amp;l=11094&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26239&amp;amp;view=logs&amp;amp;j=d8d26c26-7ec2-5ed2-772e-7a1a1eb8317c&amp;amp;t=ec8797b0-5eee-5a0e-f936-8db65cff44cc&amp;amp;l=11094&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17441734" author="dawidwys" created="Wed, 10 Nov 2021 13:23:26 +0000"  >&lt;p&gt;Temporarily disabled the test in 133943fc1fd6870c056515bf09d20f458fb1b447&lt;/p&gt;</comment>
                            <comment id="17441800" author="till.rohrmann" created="Wed, 10 Nov 2021 15:45:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26271&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5063&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26271&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=5063&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17441866" author="akalashnikov" created="Wed, 10 Nov 2021 17:31:31 +0000"  >&lt;p&gt;I have fixed the test but the problem is not the test but the race condition in `&lt;b&gt;PipelinedSubpartition#add&lt;/b&gt;`:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Suppose we add the event to the empty queue(event is always the finished buffer)&lt;/li&gt;
	&lt;li&gt;`&lt;b&gt;notifyDataAvailable&lt;/b&gt;` is set to true because we have only one buffer in the queue which is finished&lt;/li&gt;
	&lt;li&gt;we call the `&lt;b&gt;notifyDataAvailable&lt;/b&gt;` method&lt;/li&gt;
	&lt;li&gt;we add one more unfinished buffer which will be the second in the queue&lt;/li&gt;
	&lt;li&gt;`notifyDataAvailable` is set to true because it is the second buffer(in fact, we should set this flag to false because we already notified about the first buffer but unfortunately we don&apos;t have such information so we want to notify again, just in case)&lt;/li&gt;
	&lt;li&gt;reader thread polls(`&lt;b&gt;PipelinedSubpartition#pollBuffer&lt;/b&gt;`) the first buffer from the queue(finished one).&lt;/li&gt;
	&lt;li&gt;only now, we call the `&lt;b&gt;notifyDataAvailable&lt;/b&gt;` method but in fact, we have only one unfinished buffer in the queue so this notification doesn&apos;t make sense.&lt;/li&gt;
	&lt;li&gt;reader thread polls the unfinished buffer from the queue.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;So as you can see it is possible to notify about one buffer twice which can lead to the situation when the unfinished buffer will be read. This can happen because the calculation of `notifyDataAvailable` happens inside the `synchronized` block while the calling `notifyDataAvailable` happens outside of this block which leads to a race condition.&lt;/p&gt;

&lt;p&gt;at least for now, I personally don&apos;t think that it is a big problem and I don&apos;t think that it makes sense to complicate our implementation of data availability notification in order to fix this problem. It is why I just have fixed the test. But I am still thinking about that and maybe I will change my mind.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; , Anyway, I am not really confident in my conclusion so let&apos;s discuss it especially if you think that it is a more serious problem than I think.&lt;/p&gt;</comment>
                            <comment id="17442272" author="pnowojski" created="Thu, 11 Nov 2021 13:01:55 +0000"  >&lt;p&gt;I agree with your assessment &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akalashnikov&quot; class=&quot;user-hover&quot; rel=&quot;akalashnikov&quot;&gt;akalashnikov&lt;/a&gt;. Let&apos;s keep the existing production code behaviour and let&apos;s just try to fix this in the tests.&lt;/p&gt;</comment>
                            <comment id="17442285" author="dawidwys" created="Thu, 11 Nov 2021 13:40:43 +0000"  >&lt;p&gt;Fixed and re-enabled the test in &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master
	&lt;ul&gt;
		&lt;li&gt;23e8c8ce62e50d478cb55bee2288a4a35af83d4f&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;1.14.1
	&lt;ul&gt;
		&lt;li&gt;39866ce3418974c9f9b746a3fb8b8e5c30a5f5db&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17445025" author="gaoyunhaii" created="Wed, 17 Nov 2021 09:03:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26626&amp;amp;view=logs&amp;amp;j=2c3cbe13-dee0-5837-cf47-3053da9a8a78&amp;amp;t=2c7d57b9-7341-5a87-c9af-2cf7cc1a37dc&amp;amp;l=4712&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26626&amp;amp;view=logs&amp;amp;j=2c3cbe13-dee0-5837-cf47-3053da9a8a78&amp;amp;t=2c7d57b9-7341-5a87-c9af-2cf7cc1a37dc&amp;amp;l=4712&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akalashnikov&quot; class=&quot;user-hover&quot; rel=&quot;akalashnikov&quot;&gt;akalashnikov&lt;/a&gt; , Might we pick the fix also to 1.13.x ~?&lt;/p&gt;</comment>
                            <comment id="17445039" author="akalashnikov" created="Wed, 17 Nov 2021 09:32:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoyunhaii&quot; class=&quot;user-hover&quot; rel=&quot;gaoyunhaii&quot;&gt;gaoyunhaii&lt;/a&gt; , yes, sure, I have prepared the PR - &lt;a href=&quot;https://github.com/apache/flink/pull/17818&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/17818&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17445676" author="gaoyunhaii" created="Thu, 18 Nov 2021 06:56:17 +0000"  >&lt;p&gt;Very thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akalashnikov&quot; class=&quot;user-hover&quot; rel=&quot;akalashnikov&quot;&gt;akalashnikov&lt;/a&gt; for backporting the fix! I&apos;ll try having a look~&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0wh9s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>