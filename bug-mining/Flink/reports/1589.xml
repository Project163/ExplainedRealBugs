<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2814] DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2814</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;A delta iteration that closes with a solution set which is a &lt;tt&gt;JoinOperator&lt;/tt&gt; throws the following exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.flink.client.program.ProgramInvocationException: The main method caused an error.
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:444)
	at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:345)
	at org.apache.flink.client.program.Client.runBlocking(Client.java:289)
	at org.apache.flink.client.CliFrontend.executeProgramBlocking(CliFrontend.java:669)
	at org.apache.flink.client.CliFrontend.run(CliFrontend.java:324)
	at org.apache.flink.client.CliFrontend.parseParameters(CliFrontend.java:969)
	at org.apache.flink.client.CliFrontend.main(CliFrontend.java:1019)
Caused by: java.lang.ClassCastException: org.apache.flink.optimizer.plan.DualInputPlanNode cannot be cast to org.apache.flink.optimizer.plan.SingleInputPlanNode
	at org.apache.flink.optimizer.dag.WorksetIterationNode.instantiate(WorksetIterationNode.java:432)
	at org.apache.flink.optimizer.dag.TwoInputNode.addLocalCandidates(TwoInputNode.java:557)
	at org.apache.flink.optimizer.dag.TwoInputNode.getAlternativePlans(TwoInputNode.java:478)
	at org.apache.flink.optimizer.dag.DataSinkNode.getAlternativePlans(DataSinkNode.java:204)
	at org.apache.flink.optimizer.dag.TwoInputNode.getAlternativePlans(TwoInputNode.java:309)
	at org.apache.flink.optimizer.dag.TwoInputNode.getAlternativePlans(TwoInputNode.java:308)
	at org.apache.flink.optimizer.Optimizer.compile(Optimizer.java:500)
	at org.apache.flink.optimizer.Optimizer.compile(Optimizer.java:402)
	at org.apache.flink.client.program.Client.getOptimizedPlan(Client.java:271)
	at org.apache.flink.client.program.Client.getOptimizedPlan(Client.java:543)
	at org.apache.flink.client.program.Client.runBlocking(Client.java:350)
	at org.apache.flink.client.program.ContextEnvironment.execute(ContextEnvironment.java:64)
	at org.apache.flink.api.java.ExecutionEnvironment.execute(ExecutionEnvironment.java:796)
	at org.apache.flink.api.java.DataSet.collect(DataSet.java:424)
	at org.apache.flink.api.java.DataSet.print(DataSet.java:1365)
	at Driver.main(Driver.java:366)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:429)
	... 6 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Temporary fix is to attach an identity mapper.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902193">FLINK-2814</key>
            <summary>DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rekhajoshm">Rekha Joshi</assignee>
                                    <reporter username="greghogan">Greg Hogan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Oct 2015 20:07:34 +0000</created>
                <updated>Thu, 28 Feb 2019 14:30:07 +0000</updated>
                            <resolved>Fri, 31 Mar 2017 16:37:23 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>API / DataSet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15298739" author="githubbot" created="Tue, 24 May 2016 19:12:07 +0000"  >&lt;p&gt;GitHub user rekhajoshm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt; Fix for DualInputPlanNode cannot be cast to SingleInputPlanNode&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt; Fix for DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rekhajoshm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rekhajoshm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2029&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 166407b6e35ffb104d11d8b0c41ace34bfbb0ecd&lt;br/&gt;
Author: Joshi &amp;lt;rekhajoshm@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-05-24T19:14:15Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt; DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15301967" author="githubbot" created="Thu, 26 May 2016 11:47:59 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029#issuecomment-221849475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029#issuecomment-221849475&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for this fix! I think it may be sufficient, but to be sure, this would need a test.&lt;br/&gt;
    Maybe @greghogan can contribute his example that caused the error as a test?&lt;/p&gt;</comment>
                            <comment id="15888401" author="githubbot" created="Tue, 28 Feb 2017 16:40:06 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen it is line 454: `solutionSetCandidate = siSolutionDeltaCandidate.getInput().getSource();` where I am seeing `solutionSetCandidate` changed from a `SingleInputPlanNode` to `DualInputPlanNode`. Why are we not exiting the loops after creating and adding the `WorksetIterationPlanNode`?&lt;/p&gt;</comment>
                            <comment id="15905762" author="githubbot" created="Fri, 10 Mar 2017 21:57:20 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen should I create an alternate PR?&lt;/p&gt;</comment>
                            <comment id="15922875" author="githubbot" created="Mon, 13 Mar 2017 20:26:48 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @greghogan I think you are right with your suggestion. Would be great if you can create an alternate fix.&lt;/p&gt;</comment>
                            <comment id="15930371" author="githubbot" created="Fri, 17 Mar 2017 17:49:26 +0000"  >&lt;p&gt;GitHub user greghogan opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;optimizer&amp;#93;&lt;/span&gt; DualInputPlanNode cannot be cast to SingleInputPlanNode&lt;/p&gt;

&lt;p&gt;    WorksetIterationNode#instantiate loops over all solution and work set candidates. Since the solution set reference is modified in place when the predecessor node can be used in its place, swith this variable to the inner loop.&lt;/p&gt;

&lt;p&gt;    @StephanEwen this is similar to #2029 but resets the reference in the loop. I believe my prior suggestion to immediately return upon adding a node was incorrect as the `instantiate` methods look to be compiling all valid combinations.&lt;/p&gt;

&lt;p&gt;    IntelliJ code coverage on `flink-optimizer` shows 105 hits through `WorksetIterationNode#instantiate` and it does fix this issue with my Katz Centrality algorithm (which should not be using delta iterations, but I was young and naive when I wrote it).&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/greghogan/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/greghogan/flink&lt;/a&gt; 2814_deltaiteration_dualinputplannode_cannot_be_cast_to_singleinputplannode&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3563&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 34f017834e17fa69e2b7c72bd95e1a819e4e6aa3&lt;br/&gt;
Author: Greg Hogan &amp;lt;code@greghogan.com&amp;gt;&lt;br/&gt;
Date:   2017-03-17T16:09:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2814&quot; title=&quot;DeltaIteration: DualInputPlanNode cannot be cast to SingleInputPlanNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2814&quot;&gt;&lt;del&gt;FLINK-2814&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;optimizer&amp;#93;&lt;/span&gt; DualInputPlanNode cannot be cast to SingleInputPlanNode&lt;/p&gt;

&lt;p&gt;    WorksetIterationNode#instantiate loops over all solution and work set&lt;br/&gt;
    candidates. Since the solution set reference is modified in place when&lt;br/&gt;
    the predecessor node can be used in its place, swith this variable to&lt;br/&gt;
    the inner loop.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15930377" author="githubbot" created="Fri, 17 Mar 2017 17:51:02 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I created #3563 which combines this PR and my suggestion.&lt;/p&gt;</comment>
                            <comment id="15932498" author="githubbot" created="Mon, 20 Mar 2017 11:07:16 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Nice, looks like a compact fix. &lt;br/&gt;
    With the explanation about test coverage, +1 from my side&lt;/p&gt;</comment>
                            <comment id="15947040" author="githubbot" created="Wed, 29 Mar 2017 12:41:00 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @greghogan I think you can go ahead and merge this...&lt;/p&gt;</comment>
                            <comment id="15947049" author="githubbot" created="Wed, 29 Mar 2017 12:49:27 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen thanks for the reminder. Do you think this should also be merged to 1.2 or 1.1?&lt;/p&gt;</comment>
                            <comment id="15951233" author="githubbot" created="Fri, 31 Mar 2017 16:36:33 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15951238" author="greghogan" created="Fri, 31 Mar 2017 16:37:23 +0000"  >&lt;p&gt;Fixed in 43158a86d9c3f3d6e3d612c8871625e9d22e7ba3&lt;/p&gt;</comment>
                            <comment id="15951243" author="githubbot" created="Fri, 31 Mar 2017 16:40:38 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @rehevkor5 thanks for this identifying bug and submitting this PR. My apologies for taking so long to look into this issue. With #3563 accepted I think you can go ahead and close this PR.&lt;/p&gt;</comment>
                            <comment id="15953831" author="githubbot" created="Mon, 3 Apr 2017 17:07:16 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3563&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think cherry-picking this into the `release-1.2` branch would be nice&lt;/p&gt;</comment>
                            <comment id="16003355" author="githubbot" created="Tue, 9 May 2017 19:21:28 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2029&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mjwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>