<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4259] Unclosed FSDataOutputStream in FileCache#copy()</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4259</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          FSDataOutputStream lfsOutput = tFS.create(targetPath, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
          FSDataInputStream fsInput = sFS.open(sourcePath);
          IOUtils.copyBytes(fsInput, lfsOutput);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The FSDataOutputStream lfsOutput should be closed upon exit.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12991939">FLINK-4259</key>
            <summary>Unclosed FSDataOutputStream in FileCache#copy()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="neelesh77">Neelesh Srinivas Salian</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Jul 2016 20:21:33 +0000</created>
                <updated>Thu, 28 Jul 2016 17:50:56 +0000</updated>
                            <resolved>Thu, 28 Jul 2016 17:50:55 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15392596" author="neelesh77" created="Mon, 25 Jul 2016 20:25:22 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;yuzhihong@gmail.com&lt;/a&gt;, Can i provide a quick fix to this?&lt;/p&gt;</comment>
                            <comment id="15394713" author="githubbot" created="Tue, 26 Jul 2016 22:53:01 +0000"  >&lt;p&gt;GitHub user nssalian opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4259&quot; title=&quot;Unclosed FSDataOutputStream in FileCache#copy()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4259&quot;&gt;&lt;del&gt;FLINK-4259&lt;/del&gt;&lt;/a&gt;: Unclosed FSDataOutputStream in FileCache#copy(): Added a &#8230;&lt;/p&gt;

&lt;p&gt;    Thanks for contributing to Apache Flink. Before you open your pull request, please take the following check list into consideration.&lt;br/&gt;
    If your changes take all of the items into account, feel free to open your pull request. For more information and/or questions please refer to the &lt;span class=&quot;error&quot;&gt;&amp;#91;How To Contribute guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/how-to-contribute.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/how-to-contribute.html&lt;/a&gt;).&lt;br/&gt;
    In addition to going through the list, please provide a meaningful description of your changes.&lt;/p&gt;

&lt;p&gt;    Description of Changes:&lt;br/&gt;
    Add a close statement for closing the FSDataOutputStream.&lt;br/&gt;
    Requesting review.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] General&lt;/li&gt;
	&lt;li&gt;The pull request references the related JIRA issue (&quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4259&quot; title=&quot;Unclosed FSDataOutputStream in FileCache#copy()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4259&quot;&gt;&lt;del&gt;FLINK-4259&lt;/del&gt;&lt;/a&gt; Unclosed FSDataOutputStream in FileCache#copy()&quot;)&lt;/li&gt;
	&lt;li&gt;The pull request addresses only one issue&lt;/li&gt;
	&lt;li&gt;Each commit in the PR has a meaningful commit message (including the JIRA id)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Documentation&lt;/li&gt;
	&lt;li&gt;Documentation has been added for new functionality&lt;/li&gt;
	&lt;li&gt;Old documentation affected by the pull request has been updated&lt;/li&gt;
	&lt;li&gt;JavaDoc for public methods has been added&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Tests &amp;amp; Build&lt;/li&gt;
	&lt;li&gt;Functionality added by the pull request is covered by tests&lt;/li&gt;
	&lt;li&gt;`mvn clean verify` has been executed successfully locally or a Travis build has passed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &#8230;close statement to close the FSDataOutputStream object&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nssalian/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nssalian/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4259&quot; title=&quot;Unclosed FSDataOutputStream in FileCache#copy()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4259&quot;&gt;&lt;del&gt;FLINK-4259&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2299&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f77780aa9c997eeac3950cfd2194b7c08851ef8d&lt;br/&gt;
Author: Neelesh Srinivas Salian &amp;lt;nsalian@cloudera.com&amp;gt;&lt;br/&gt;
Date:   2016-07-25T20:30:42Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4259&quot; title=&quot;Unclosed FSDataOutputStream in FileCache#copy()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4259&quot;&gt;&lt;del&gt;FLINK-4259&lt;/del&gt;&lt;/a&gt;: Unclosed FSDataOutputStream in FileCache#copy(): Added a close statement to close the FSDataOutputStream object&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15394746" author="githubbot" created="Tue, 26 Jul 2016 23:15:43 +0000"  >&lt;p&gt;Github user mbalassi commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @nssalian has just reached out to me in person. I will have a look at this.&lt;/p&gt;</comment>
                            <comment id="15394759" author="githubbot" created="Tue, 26 Jul 2016 23:21:09 +0000"  >&lt;p&gt;Github user nssalian commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @mbalassi &lt;/p&gt;</comment>
                            <comment id="15394842" author="githubbot" created="Wed, 27 Jul 2016 00:34:10 +0000"  >&lt;p&gt;Github user mbalassi commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The code change is very concise and looks right, the one issue that bugs me is that there are no direct tests in place to verify it - and it is not necessarily straight forward to test as it is a resource leak issue.&lt;/p&gt;

&lt;p&gt;    I tried building the project locally and in fact `PythonPlanBinderTest` that uses the change transitively got stuck, but I could not manage to reproduce the issue when running solely that test from IntelliJ.&lt;/p&gt;

&lt;p&gt;    I have fired up a travis test myself and the PR is also triggering one, let us whether those go through.&lt;/p&gt;

&lt;p&gt;    @nssalian do you see a straight forward way to test the behaviour? &lt;/p&gt;

&lt;p&gt;    PS: Could you enabled the travis build on your repo, please? (As Flink comes with a travis.yml all you need to do is to go to Travis, login with your github user and hit enable on the repo.) &lt;/p&gt;</comment>
                            <comment id="15394917" author="githubbot" created="Wed, 27 Jul 2016 01:42:50 +0000"  >&lt;p&gt;Github user nssalian commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    hi @mbalassim thank you for the review. I have kicked off a build for my flink repo. Let me observe what happens.&lt;br/&gt;
    With regards to a test, I was thinking something on the lines  of FileCacheDeleteValidationTest.java with creating and checking whether the output stream is closed. &lt;/p&gt;</comment>
                            <comment id="15395271" author="githubbot" created="Wed, 27 Jul 2016 08:58:30 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think it would be fine to merge it without a test; we merged plenty of PR&apos;s like this without requiring a test.&lt;/p&gt;

&lt;p&gt;    The PythonPlanBinderTest failing is odd, but i would guess that it is unrelated to this change. Nevertheless, does it get stuck every time you execute it? And, of course, does it no longer fail without this commit?&lt;/p&gt;</comment>
                            <comment id="15395718" author="githubbot" created="Wed, 27 Jul 2016 13:59:28 +0000"  >&lt;p&gt;Github user nssalian commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @zentol , thank you.I ran the build once locally and it went through. Just kicked off another for sanity.&lt;/p&gt;</comment>
                            <comment id="15396041" author="githubbot" created="Wed, 27 Jul 2016 17:42:41 +0000"  >&lt;p&gt;Github user nssalian commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @mbalassi and @zentol, I ran the builds twice and both instances the PythonBinderTest passed.&lt;br/&gt;
    The 2nd build ran with a failure on 2 with:&lt;br/&gt;
    MVN exited with EXIT CODE: 1.&lt;br/&gt;
    java.io.FileNotFoundException: build-target/lib/flink-dist-*.jar (No such file or directory)&lt;/p&gt;

&lt;p&gt;    which, if I am not wrong, isn&apos;t related here.&lt;br/&gt;
    Please let me know if you need me to add anything additional. &lt;/p&gt;</comment>
                            <comment id="15396049" author="githubbot" created="Wed, 27 Jul 2016 17:49:28 +0000"  >&lt;p&gt;Github user mbalassi commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @nssalian, merging then.&lt;/p&gt;</comment>
                            <comment id="15396066" author="githubbot" created="Wed, 27 Jul 2016 17:57:50 +0000"  >&lt;p&gt;Github user nssalian commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @mbalassi  and @zentol for the review. &lt;/p&gt;</comment>
                            <comment id="15397892" author="githubbot" created="Thu, 28 Jul 2016 17:50:04 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2299&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15397895" author="mbalassi" created="Thu, 28 Jul 2016 17:50:56 +0000"  >&lt;p&gt;Fixed via 5d7e949.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31egn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>