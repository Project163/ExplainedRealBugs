<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2394] HadoopOutFormat OutputCommitter is default to FileOutputCommiter</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2394</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;MongoOutputFormat does not write back in collection because the HadoopOutputFormat wrapper does not allow to set the MongoOutputCommiter and is set as default to FileOutputCommitter. Therefore, on close and globalFinalize execution the commit does not happen and mongo collection stays untouched. &lt;/p&gt;

&lt;p&gt;A simple solution would be to:&lt;/p&gt;

&lt;p&gt;1 - create a constructor of HadoopOutputFormatBase and HadoopOutputFormat that gets the OutputCommitter as a parameter&lt;br/&gt;
2 - change the outputCommitter field of HadoopOutputFormatBase to be a generic OutputCommitter&lt;br/&gt;
3 - remove the default assignment in the open() and finalizeGlobal to the outputCommitter to FileOutputCommitter(), or keep it as a default in case of no specific assignment.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12846923">FLINK-2394</key>
            <summary>HadoopOutFormat OutputCommitter is default to FileOutputCommiter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fhueske">Fabian Hueske</assignee>
                                    <reporter username="stefano.bortoli">Stefano Bortoli</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Jul 2015 15:26:09 +0000</created>
                <updated>Thu, 16 Jun 2016 17:07:55 +0000</updated>
                            <resolved>Wed, 26 Aug 2015 12:27:16 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                    <component>API / DataSet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14639545" author="fhueske" created="Thu, 23 Jul 2015 21:32:24 +0000"  >&lt;p&gt;Hadoop handles &lt;tt&gt;OutputCommitters&lt;/tt&gt; differently for its both APIs (&lt;tt&gt;mapred&lt;/tt&gt; and &lt;tt&gt;mapreduce&lt;/tt&gt;).&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For the newer &lt;tt&gt;mapreduce&lt;/tt&gt; API, things are quite simple.&lt;br/&gt;
&lt;tt&gt;org.apache.hadoop.mapreduce.OutputFormat&lt;/tt&gt; has an abstract method &lt;tt&gt;getOutputCommitter(TaskAttemptContext context)&lt;/tt&gt; which provides the output committer that must be used. So updating the Flink &lt;tt&gt;mapreduce.HadoopOutputFormatBase&lt;/tt&gt;&#160;class such that it gets the &lt;tt&gt;OutputCommitter&lt;/tt&gt; directly from the &lt;tt&gt;OutputFormat&lt;/tt&gt; instead of creating a &lt;tt&gt;FileOutputCommitter&lt;/tt&gt; should be easy.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For the older &lt;tt&gt;mapred&lt;/tt&gt; API, the OutputFormat interface does not define a &lt;tt&gt;getOutputCommitter()&lt;/tt&gt; method. Instead the &lt;tt&gt;JobConf&lt;/tt&gt; has a &lt;tt&gt;getOutputCommitter()&lt;/tt&gt; method which returns a &lt;tt&gt;FileOutputCommitter&lt;/tt&gt; if nothing else is defined. So we could update the &lt;tt&gt;mapred.HadoopOutputFormatBase&lt;/tt&gt; to get the &lt;tt&gt;OutputCommitter&lt;/tt&gt; from the &lt;tt&gt;JobConf&lt;/tt&gt;. However, this would require that users manually set a different &lt;tt&gt;OutputCommitter&lt;/tt&gt; in the &lt;tt&gt;JobConf&lt;/tt&gt; which is not really intuitive. We could offer an additional constructor which sets a &lt;tt&gt;OutputCommitter&lt;/tt&gt;&#160;in the provided &lt;tt&gt;JobConf&lt;/tt&gt; argument, like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefano.bortoli&quot; class=&quot;user-hover&quot; rel=&quot;stefano.bortoli&quot;&gt;stefano.bortoli&lt;/a&gt; suggested.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14640007" author="stefano.bortoli" created="Fri, 24 Jul 2015 06:37:36 +0000"  >&lt;p&gt;I see. I was in fact a little disappointed with mongo-hadoop for having a method getOutputCommitter() which was not standard in the OutputFormat. However, my first implementation was using the mapred Hadoop, so no big surprises.&lt;/p&gt;

&lt;p&gt;I would say that a good idea could be to simply have either 2 HadoopOutputFormatBase classes (1 per version of Hadoop), or handle the hadoop version to get the OutputCommitter accordingly.&lt;/p&gt;

&lt;p&gt;Meanwhile, I have implemented my own MongoHadoopOutputFormat extending the HadoopOutputFormat and overriding the open and close methods replacing the FileOutputCommitter with the MongoOutputCommiter. &lt;/p&gt;</comment>
                            <comment id="14640999" author="fhueske" created="Fri, 24 Jul 2015 19:56:31 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefano.bortoli&quot; class=&quot;user-hover&quot; rel=&quot;stefano.bortoli&quot;&gt;stefano.bortoli&lt;/a&gt;, we do already have two HadoopOutputFormatBase classes, one for each Hadoop API. So treating both APIs differently is not a problem. The issue is that one API supports different OutputCommitters out-of-the-box (mapreduce) and the other one requires that the OutputCommitter is explicitly set (mapred), unless I overlooked something.&lt;/p&gt;</comment>
                            <comment id="14711474" author="githubbot" created="Tue, 25 Aug 2015 15:45:24 +0000"  >&lt;p&gt;GitHub user fhueske opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2394&quot; title=&quot;HadoopOutFormat OutputCommitter is default to FileOutputCommiter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2394&quot;&gt;&lt;del&gt;FLINK-2394&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;fix&amp;#93;&lt;/span&gt; HadoopOutputFormats use correct OutputCommitters.&lt;/p&gt;

&lt;p&gt;    Right now, Flink&apos;s wrappers for Hadoop OutputFormats always use a `FileOutputCommitter`.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In the `mapreduce` API, Hadoop OutputFormats have a method `getOutputCommitter()` which can be overwritten and returns the `FileOutputFormat` by default.&lt;/li&gt;
	&lt;li&gt;In the `mapred`API, the `OutputCommitter` should be obtained from the `JobConf`. If nothing custom is set, a `FileOutputCommitter` is returned.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This PR uses the respective methods to obtain the correct `OutputCommitter`. Since, `FileOutputCommitter` is the default in both cases, the original semantics are preserved if no custom committer is implemented or set by the user.&lt;br/&gt;
    I also added convenience methods to the constructors of the `mapred` wrappers to set the `OutputCommitter` in the `JobConf`.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/fhueske/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fhueske/flink&lt;/a&gt; hadoopOutCommitter&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1056&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a632203a948f2e7973339a0eab88750f7ce70cc5&lt;br/&gt;
Author: Fabian Hueske &amp;lt;fhueske@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-07-30T19:47:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2394&quot; title=&quot;HadoopOutFormat OutputCommitter is default to FileOutputCommiter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2394&quot;&gt;&lt;del&gt;FLINK-2394&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;fix&amp;#93;&lt;/span&gt; HadoopOutputFormats use correct OutputCommitters.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14712929" author="githubbot" created="Wed, 26 Aug 2015 10:46:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056#discussion_r37968466&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056#discussion_r37968466&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/hadoop/mapred/HadoopOutputFormat.scala &amp;#8212;&lt;br/&gt;
    @@ -18,11 +18,17 @@&lt;br/&gt;
     package org.apache.flink.api.scala.hadoop.mapred&lt;/p&gt;

&lt;p&gt;     import org.apache.flink.api.java.hadoop.mapred.HadoopOutputFormatBase&lt;br/&gt;
    -import org.apache.hadoop.mapred.&lt;/p&gt;
{JobConf, OutputFormat}
&lt;p&gt;    +import org.apache.hadoop.mapred.&lt;/p&gt;
{OutputCommitter, JobConf, OutputFormat}

&lt;p&gt;     class HadoopOutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;(mapredOutputFormat: OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;, job: JobConf)&lt;br/&gt;
       extends HadoopOutputFormatBase&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V, (K, V)&amp;#93;&lt;/span&gt;(mapredOutputFormat, job) {&lt;/p&gt;

&lt;p&gt;    +  def this(mapredOutputFormat: OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;, outputCommitterClass: Class&lt;span class=&quot;error&quot;&gt;&amp;#91;OutputCommitter&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +           job: JobConf) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Can we use multi line parameter lists as in other Scala files?&lt;/p&gt;</comment>
                            <comment id="14712936" author="githubbot" created="Wed, 26 Aug 2015 11:00:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056#discussion_r37969330&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056#discussion_r37969330&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-scala/src/main/scala/org/apache/flink/api/scala/hadoop/mapred/HadoopOutputFormat.scala &amp;#8212;&lt;br/&gt;
    @@ -18,11 +18,17 @@&lt;br/&gt;
     package org.apache.flink.api.scala.hadoop.mapred&lt;/p&gt;

&lt;p&gt;     import org.apache.flink.api.java.hadoop.mapred.HadoopOutputFormatBase&lt;br/&gt;
    -import org.apache.hadoop.mapred.&lt;/p&gt;
{JobConf, OutputFormat}
&lt;p&gt;    +import org.apache.hadoop.mapred.&lt;/p&gt;
{OutputCommitter, JobConf, OutputFormat}

&lt;p&gt;     class HadoopOutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;(mapredOutputFormat: OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;, job: JobConf)&lt;br/&gt;
       extends HadoopOutputFormatBase&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V, (K, V)&amp;#93;&lt;/span&gt;(mapredOutputFormat, job) {&lt;/p&gt;

&lt;p&gt;    +  def this(mapredOutputFormat: OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;K, V&amp;#93;&lt;/span&gt;, outputCommitterClass: Class&lt;span class=&quot;error&quot;&gt;&amp;#91;OutputCommitter&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +           job: JobConf) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Fixed. &lt;br/&gt;
    I&apos;d propose to add this to the Scala checkstyle, if we want to enforce it.&lt;/p&gt;</comment>
                            <comment id="14713022" author="githubbot" created="Wed, 26 Aug 2015 12:23:09 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056#issuecomment-134982359&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056#issuecomment-134982359&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM. +1 for merging.&lt;/p&gt;</comment>
                            <comment id="14713023" author="githubbot" created="Wed, 26 Aug 2015 12:23:38 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056#issuecomment-134982439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056#issuecomment-134982439&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This looks good. I&apos;m merging this to the release branch. We have an issue to add tests for the output formats, so it&apos;s fine that this does not include a test yet.&lt;/p&gt;</comment>
                            <comment id="14713026" author="githubbot" created="Wed, 26 Aug 2015 12:26:04 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1056&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14713028" author="uce" created="Wed, 26 Aug 2015 12:27:16 +0000"  >&lt;p&gt;Fixed via 6e1de98 (master), eb9c75f (release-0.9).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hk67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>