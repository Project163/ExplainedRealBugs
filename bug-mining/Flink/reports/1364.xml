<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5097] The TypeExtractor is missing input type information in some Graph methods</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5097</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The TypeExtractor is called without information about the input type in &lt;tt&gt;mapVertices&lt;/tt&gt; and &lt;tt&gt;mapEdges&lt;/tt&gt; although this information can be easily retrieved.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13021749">FLINK-5097</key>
            <summary>The TypeExtractor is missing input type information in some Graph methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vkalavri">Vasia Kalavri</assignee>
                                    <reporter username="vkalavri">Vasia Kalavri</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Nov 2016 13:23:46 +0000</created>
                <updated>Fri, 16 Dec 2016 10:29:02 +0000</updated>
                            <resolved>Fri, 16 Dec 2016 10:29:02 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Library / Graph Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15683517" author="githubbot" created="Mon, 21 Nov 2016 12:56:34 +0000"  >&lt;p&gt;GitHub user vasia opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5097&quot; title=&quot;The TypeExtractor is missing input type information in some Graph methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5097&quot;&gt;&lt;del&gt;FLINK-5097&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Add is missing input type information to TypeExtr&#8230;&lt;/p&gt;

&lt;p&gt;    I&apos;ve managed to reproduce @otherwise777&apos;s error as reported in the mailing list and added a test case that failed before the change. @twalthr please take a look when you have some time, thanks!&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/vasia/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vasia/flink&lt;/a&gt; flink-5097&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2842&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit ea098c767151b6ba91fe54669a921e6303cd8c4d&lt;br/&gt;
Author: vasia &amp;lt;vasia@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-11-19T14:35:43Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5097&quot; title=&quot;The TypeExtractor is missing input type information in some Graph methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5097&quot;&gt;&lt;del&gt;FLINK-5097&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Add is missing input type information to TypeExtractor&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15683912" author="githubbot" created="Mon, 21 Nov 2016 15:52:50 +0000"  >&lt;p&gt;Github user greghogan commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88921327&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88921327&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception &lt;/p&gt;
{
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Long&amp;gt;&amp;gt; vertices = TestGraphUtils.getLongLongVertexData(env);
    +		DataSet&amp;lt;Edge&amp;lt;Long, Long&amp;gt;&amp;gt; edges = TestGraphUtils.getLongLongEdgeData(env);
    +		inputGraph = Graph.fromDataSet(vertices, edges, env);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public class TestGraphWithGeneric&amp;lt;K&amp;gt; {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This class is necessary?&lt;/p&gt;</comment>
                            <comment id="15683913" author="githubbot" created="Mon, 21 Nov 2016 15:52:50 +0000"  >&lt;p&gt;Github user greghogan commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88919762&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88919762&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception {&lt;br/&gt;
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Do we want a local or collections environment?&lt;/p&gt;</comment>
                            <comment id="15683914" author="githubbot" created="Mon, 21 Nov 2016 15:52:50 +0000"  >&lt;p&gt;Github user greghogan commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88914659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88914659&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception &lt;/p&gt;
{
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Long&amp;gt;&amp;gt; vertices = TestGraphUtils.getLongLongVertexData(env);
    +		DataSet&amp;lt;Edge&amp;lt;Long, Long&amp;gt;&amp;gt; edges = TestGraphUtils.getLongLongEdgeData(env);
    +		inputGraph = Graph.fromDataSet(vertices, edges, env);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public class TestGraphWithGeneric&amp;lt;K&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		public DataSet&amp;lt;Vertex&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapVertices(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapVertices(new VertexMapper&amp;lt;K&amp;gt;()).getVertices();
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		public DataSet&amp;lt;Edge&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapEdges(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapEdges(new EdgeMapper&amp;lt;K&amp;gt;()).getEdges();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMapVerticesType() throws Exception {&lt;br/&gt;
    +		TestGraphWithGeneric&amp;lt;Long&amp;gt; test = new TestGraphWithGeneric&amp;lt;&amp;gt;();&lt;br/&gt;
    +&lt;br/&gt;
    +		// test type extraction in mapVertices&lt;br/&gt;
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;&amp;gt; outVertices = test.mapVertices(inputGraph);&lt;br/&gt;
    +		Assert.assertEquals(true, (new TupleTypeInfo(Vertex.class, BasicTypeInfo.LONG_TYPE_INFO,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `Assert.assertTrue`?&lt;/p&gt;</comment>
                            <comment id="15683915" author="githubbot" created="Mon, 21 Nov 2016 15:52:50 +0000"  >&lt;p&gt;Github user greghogan commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88919069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88919069&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Extra newline.&lt;/p&gt;</comment>
                            <comment id="15683916" author="githubbot" created="Mon, 21 Nov 2016 15:52:50 +0000"  >&lt;p&gt;Github user greghogan commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88920404&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88920404&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception &lt;/p&gt;
{
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Long&amp;gt;&amp;gt; vertices = TestGraphUtils.getLongLongVertexData(env);
    +		DataSet&amp;lt;Edge&amp;lt;Long, Long&amp;gt;&amp;gt; edges = TestGraphUtils.getLongLongEdgeData(env);
    +		inputGraph = Graph.fromDataSet(vertices, edges, env);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public class TestGraphWithGeneric&amp;lt;K&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		public DataSet&amp;lt;Vertex&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapVertices(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapVertices(new VertexMapper&amp;lt;K&amp;gt;()).getVertices();
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		public DataSet&amp;lt;Edge&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapEdges(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapEdges(new EdgeMapper&amp;lt;K&amp;gt;()).getEdges();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMapVerticesType() throws Exception &lt;/p&gt;
{
    +		TestGraphWithGeneric&amp;lt;Long&amp;gt; test = new TestGraphWithGeneric&amp;lt;&amp;gt;();
    +
    +		// test type extraction in mapVertices
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;&amp;gt; outVertices = test.mapVertices(inputGraph);
    +		Assert.assertEquals(true, (new TupleTypeInfo(Vertex.class, BasicTypeInfo.LONG_TYPE_INFO,
    +			new TupleTypeInfo&amp;lt;Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;(BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.INT_TYPE_INFO)))
    +			.equals(outVertices.getType()));
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMapEdgesType() throws Exception &lt;/p&gt;
{
    +		TestGraphWithGeneric&amp;lt;Long&amp;gt; test = new TestGraphWithGeneric&amp;lt;&amp;gt;();
    +
    +		// test type extraction in mapEdges
    +		DataSet&amp;lt;Edge&amp;lt;Long, Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;&amp;gt; outEdges = test.mapEdges(inputGraph);
    +		Assert.assertEquals(true, (new TupleTypeInfo(Edge.class, BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.LONG_TYPE_INFO,
    +			new TupleTypeInfo&amp;lt;Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;(BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.INT_TYPE_INFO)))
    +			.equals(outEdges.getType()));
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public static final class VertexMapper&amp;lt;K&amp;gt; implements MapFunction&amp;lt;Vertex&amp;lt;K, Long&amp;gt;, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		private final Tuple2&amp;lt;K, Integer&amp;gt; outTuple = new Tuple2&amp;lt;&amp;gt;();&lt;br/&gt;
    +&lt;br/&gt;
    +		@Override&lt;br/&gt;
    +		public Tuple2&amp;lt;K, Integer&amp;gt; map(Vertex&amp;lt;K, Long&amp;gt; inputVertex) throws Exception {&lt;br/&gt;
    +			outTuple.setField(inputVertex.getId(),  0);&lt;br/&gt;
    +			outTuple.setField(inputVertex.getValue().intValue(),  0);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This and again below should set field 1? I&apos;m not seeing how this is compiling since outTuple.f0 is typed to `K`.&lt;/p&gt;</comment>
                            <comment id="15683938" author="githubbot" created="Mon, 21 Nov 2016 16:00:31 +0000"  >&lt;p&gt;Github user vasia commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88925478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88925478&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception {&lt;br/&gt;
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I don&apos;t think it&apos;d make a difference. There is no execution.&lt;/p&gt;</comment>
                            <comment id="15683950" author="githubbot" created="Mon, 21 Nov 2016 16:04:33 +0000"  >&lt;p&gt;Github user vasia commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88926534&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88926534&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception &lt;/p&gt;
{
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Long&amp;gt;&amp;gt; vertices = TestGraphUtils.getLongLongVertexData(env);
    +		DataSet&amp;lt;Edge&amp;lt;Long, Long&amp;gt;&amp;gt; edges = TestGraphUtils.getLongLongEdgeData(env);
    +		inputGraph = Graph.fromDataSet(vertices, edges, env);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public class TestGraphWithGeneric&amp;lt;K&amp;gt; {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Not necessary. I tried to create a minimal example of the reported case. The mapping methods could also be called inside the test methods.&lt;/p&gt;</comment>
                            <comment id="15683952" author="githubbot" created="Mon, 21 Nov 2016 16:05:20 +0000"  >&lt;p&gt;Github user vasia commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842#discussion_r88926689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842#discussion_r88926689&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/test/operations/TypeExtractorTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,106 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test.operations;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.TupleTypeInfo;&lt;br/&gt;
    +import org.apache.flink.graph.Edge;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.apache.flink.graph.Vertex;&lt;br/&gt;
    +import org.apache.flink.graph.test.TestGraphUtils;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TypeExtractorTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private Graph&amp;lt;Long, Long, Long&amp;gt; inputGraph;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void setUp() throws Exception &lt;/p&gt;
{
    +		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Long&amp;gt;&amp;gt; vertices = TestGraphUtils.getLongLongVertexData(env);
    +		DataSet&amp;lt;Edge&amp;lt;Long, Long&amp;gt;&amp;gt; edges = TestGraphUtils.getLongLongEdgeData(env);
    +		inputGraph = Graph.fromDataSet(vertices, edges, env);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public class TestGraphWithGeneric&amp;lt;K&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		public DataSet&amp;lt;Vertex&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapVertices(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapVertices(new VertexMapper&amp;lt;K&amp;gt;()).getVertices();
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		public DataSet&amp;lt;Edge&amp;lt;K, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt;&amp;gt; mapEdges(Graph&amp;lt;K, Long, Long&amp;gt; input) &lt;/p&gt;
{
    +			return input.mapEdges(new EdgeMapper&amp;lt;K&amp;gt;()).getEdges();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMapVerticesType() throws Exception &lt;/p&gt;
{
    +		TestGraphWithGeneric&amp;lt;Long&amp;gt; test = new TestGraphWithGeneric&amp;lt;&amp;gt;();
    +
    +		// test type extraction in mapVertices
    +		DataSet&amp;lt;Vertex&amp;lt;Long, Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;&amp;gt; outVertices = test.mapVertices(inputGraph);
    +		Assert.assertEquals(true, (new TupleTypeInfo(Vertex.class, BasicTypeInfo.LONG_TYPE_INFO,
    +			new TupleTypeInfo&amp;lt;Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;(BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.INT_TYPE_INFO)))
    +			.equals(outVertices.getType()));
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testMapEdgesType() throws Exception &lt;/p&gt;
{
    +		TestGraphWithGeneric&amp;lt;Long&amp;gt; test = new TestGraphWithGeneric&amp;lt;&amp;gt;();
    +
    +		// test type extraction in mapEdges
    +		DataSet&amp;lt;Edge&amp;lt;Long, Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;&amp;gt; outEdges = test.mapEdges(inputGraph);
    +		Assert.assertEquals(true, (new TupleTypeInfo(Edge.class, BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.LONG_TYPE_INFO,
    +			new TupleTypeInfo&amp;lt;Tuple2&amp;lt;Long, Integer&amp;gt;&amp;gt;(BasicTypeInfo.LONG_TYPE_INFO, BasicTypeInfo.INT_TYPE_INFO)))
    +			.equals(outEdges.getType()));
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	public static final class VertexMapper&amp;lt;K&amp;gt; implements MapFunction&amp;lt;Vertex&amp;lt;K, Long&amp;gt;, Tuple2&amp;lt;K, Integer&amp;gt;&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		private final Tuple2&amp;lt;K, Integer&amp;gt; outTuple = new Tuple2&amp;lt;&amp;gt;();&lt;br/&gt;
    +&lt;br/&gt;
    +		@Override&lt;br/&gt;
    +		public Tuple2&amp;lt;K, Integer&amp;gt; map(Vertex&amp;lt;K, Long&amp;gt; inputVertex) throws Exception {&lt;br/&gt;
    +			outTuple.setField(inputVertex.getId(),  0);&lt;br/&gt;
    +			outTuple.setField(inputVertex.getValue().intValue(),  0);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `map()` could even be empty here, since this is never executed.&lt;/p&gt;</comment>
                            <comment id="15683964" author="githubbot" created="Mon, 21 Nov 2016 16:09:10 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @greghogan if the input types are known, we should pass them, yes. What other cases did you find?&lt;/p&gt;</comment>
                            <comment id="15684009" author="githubbot" created="Mon, 21 Nov 2016 16:26:12 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I count nine uses of `TypeExtractor.createTypeInfo` in `Graph` and one each in `ScatterGatherIteration`, `VertexCentricIteration`, and `GatherSumApplyIteration`. The latter still need to allow for the UDF to implement `ResultTypeQueryable`.&lt;/p&gt;

&lt;p&gt;    For example, won&apos;t `ScatterGatherIteration` type extraction currently fail on a `ScatterFunction` where the `Message` type is based on `K`, &apos;VV`, or `EV`?&lt;/p&gt;</comment>
                            <comment id="15684040" author="githubbot" created="Mon, 21 Nov 2016 16:37:30 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks! Let me look into these and I&apos;ll get back to you.&lt;/p&gt;</comment>
                            <comment id="15686757" author="githubbot" created="Tue, 22 Nov 2016 13:26:46 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @greghogan,&lt;br/&gt;
    I was able to fix the problem in `fromDataSet()` and `groupReduceOnEdges()` with `EdgesFunction`. In the rest of the uses, I don&apos;t seem to find a way to pass all the input types correctly. The remaining cases all have 3 input types and the `createTypeInfo()` method only accepts two. I have also tried extracting the input types from the wrapping functions, but that didn&apos;t work either. Any ideas?&lt;/p&gt;</comment>
                            <comment id="15687902" author="githubbot" created="Tue, 22 Nov 2016 21:12:15 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @vasia should `Graph` be using the function specific `TypeExtractor.getMapReturnTypes` (not sure why this is plural) and similar where core Functions are used?&lt;/p&gt;

&lt;p&gt;    For `Gelly` functions, I think you are right that this capability is lacking, i.e. `NeighborsFunctionWithVertexValue` has three input types and `TypeExtractor` only provides `getUnaryOperatorReturnType` and `getBinaryOperatorReturnType`? It also looks like `TypeExtractor` expects a specific though natural ordering (input types before output types).&lt;/p&gt;

&lt;p&gt;    @twalthr what do you recommend?&lt;/p&gt;</comment>
                            <comment id="15712056" author="githubbot" created="Thu, 1 Dec 2016 14:11:20 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @vasia You are right. The `TypeExtractor` doesn&apos;t support functions with more than 2 inputs. That has never been required so far as the runtime operators always have two inputs. You could open an issue for that if this feature makes sense.&lt;/p&gt;

&lt;p&gt;    `TypeExtractor.getMapReturnTypes` has support for Java 8 lambdas and checks for the `ResultTypeQueryable` interface first, so I would use the more specific `getXXXReturnTypes` (the plural has historic reasons) method if possible and the generic `createTypeInfo` method otherwise. Just make sure that you don&apos;t set the `allowMissing` flag otherwise you might get a `MissingTypeInfo` back.&lt;/p&gt;</comment>
                            <comment id="15728099" author="githubbot" created="Wed, 7 Dec 2016 08:20:59 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @twalthr, thank you so much for looking into this. I&apos;ll create an issue for functions with &amp;gt; 2 inputs.&lt;br/&gt;
    I have replaced `createTypeInfo` with `getMapReturnTypes` where possible, but I&apos;m getting a test failure now that I can&apos;t figure out. Please see `org.apache.flink.graph.scala.test.operations.GraphCreationWithCsvITCase#testCsvWithMapperValues`. Am I using the `getMapReturnTypes` method properly?&lt;/p&gt;</comment>
                            <comment id="15751615" author="githubbot" created="Thu, 15 Dec 2016 15:17:11 +0000"  >&lt;p&gt;Github user greghogan commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @vasia, as this PR fixes the reported issue, should we rebase and commit for 1.2 and leave the remaining updates for a separate ticket?&lt;/p&gt;</comment>
                            <comment id="15751854" author="githubbot" created="Thu, 15 Dec 2016 16:53:47 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Sure, I can revert using `getMapReturnTypes` , rebase, and merge.&lt;/p&gt;</comment>
                            <comment id="15752120" author="githubbot" created="Thu, 15 Dec 2016 18:33:05 +0000"  >&lt;p&gt;Github user vasia commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Done. I&apos;ll wait for travis, then merge.&lt;/p&gt;</comment>
                            <comment id="15754052" author="githubbot" created="Fri, 16 Dec 2016 10:26:05 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2842&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36i5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>