<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:40:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-13534] Unable to query Hive table with decimal column</title>
                <link>https://issues.apache.org/jira/browse/FLINK-13534</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hit the following exception when access a Hive table with decimal column:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
Caused by: org.apache.flink.table.api.TableException: TableSource of type org.apache.flink.batch.connectors.hive.HiveTableSource returned a DataSet of data type ROW&amp;lt;`x` LEGACY(BigDecimal)&amp;gt; that does not match with the data type ROW&amp;lt;`x` DECIMAL(10, 0)&amp;gt; declared by the TableSource.getProducedDataType() method. Please validate the implementation of the TableSource.
 at org.apache.flink.table.plan.nodes.dataset.BatchTableSourceScan.translateToPlan(BatchTableSourceScan.scala:118)
 at org.apache.flink.table.api.internal.BatchTableEnvImpl.translate(BatchTableEnvImpl.scala:303)
 at org.apache.flink.table.api.internal.BatchTableEnvImpl.translate(BatchTableEnvImpl.scala:281)
 at org.apache.flink.table.api.internal.BatchTableEnvImpl.writeToSink(BatchTableEnvImpl.scala:117)
 at org.apache.flink.table.api.internal.TableEnvImpl.insertInto(TableEnvImpl.scala:564)
 at org.apache.flink.table.api.internal.TableEnvImpl.insertInto(TableEnvImpl.scala:516)
 at org.apache.flink.table.api.internal.BatchTableEnvImpl.insertInto(BatchTableEnvImpl.scala:59)
 at org.apache.flink.table.api.internal.TableImpl.insertInto(TableImpl.java:428)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13248327">FLINK-13534</key>
            <summary>Unable to query Hive table with decimal column</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lirui">Rui Li</assignee>
                                    <reporter username="lirui">Rui Li</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 1 Aug 2019 12:28:16 +0000</created>
                <updated>Tue, 27 Aug 2019 04:09:08 +0000</updated>
                            <resolved>Tue, 13 Aug 2019 21:39:54 +0000</resolved>
                                    <version>1.9.0</version>
                                    <fixVersion>1.9.1</fixVersion>
                    <fixVersion>1.10.0</fixVersion>
                                    <component>Connectors / Hive</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16898069" author="lirui" created="Thu, 1 Aug 2019 13:01:14 +0000"  >&lt;p&gt;It seems in &lt;tt&gt;BatchTableSourceScan.translateToPlan&lt;/tt&gt; the produced type gets converted back and forth between &lt;tt&gt;TypeInformation&lt;/tt&gt; and &lt;tt&gt;DataType&lt;/tt&gt;, and somehow there&apos;s a type mismatch. Similarly the following experimental test would fail. Not sure whether this is intended behavior.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
DataType dataType = DataTypes.DECIMAL(10, 0);
TypeInformation typeInfo = TypeConversions.fromDataTypeToLegacyInfo(dataType);
DataType convertedDataType = TypeConversions.fromLegacyInfoToDataType(typeInfo);
assertEquals(dataType, convertedDataType);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; would you mind share your thoughts about this issue? Thanks.&lt;/p&gt;

&lt;p&gt;And here&apos;s &lt;tt&gt;HiveTableSource.getProducedDataType&lt;/tt&gt;, in case there&apos;s something wrong with this method.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DataType getProducedDataType() {
		TableSchema tableSchema = catalogTable.getSchema();
		DataTypes.Field[] fields = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DataTypes.Field[tableSchema.getFieldCount()];
		&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; fields.length; i++) {
			fields[i] = DataTypes.FIELD(tableSchema.getFieldName(i).get(), tableSchema.getFieldDataType(i).get());
		}
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; DataTypes.ROW(fields);
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16898091" author="lzljs3620320" created="Thu, 1 Aug 2019 13:33:55 +0000"  >&lt;p&gt;you can try rebase the PR of&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13495&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-13495&lt;/a&gt;&#160;, and see whether it be fixed.&lt;/p&gt;</comment>
                            <comment id="16898734" author="lirui" created="Fri, 2 Aug 2019 09:32:51 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13495&quot; title=&quot;blink-planner should support decimal precision to table source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13495&quot;&gt;&lt;del&gt;FLINK-13495&lt;/del&gt;&lt;/a&gt; seems to help, but I think there&apos;s still some issue with Hive connector code. We did some conversions between &lt;tt&gt;DataType&lt;/tt&gt; and &lt;tt&gt;TypeInformation&lt;/tt&gt; in Hive connector. My question is what&apos;s the recommended way to do such conversions? And is the conversion planner-specific?&lt;/p&gt;</comment>
                            <comment id="16898746" author="lzljs3620320" created="Fri, 2 Aug 2019 09:51:08 +0000"  >&lt;p&gt;It should be&#160;OK now.&lt;/p&gt;

&lt;p&gt;The better is using blink planner-specific conversion.. But in this way, user must run job with blink-planner dependent.&lt;/p&gt;</comment>
                            <comment id="16898825" author="lirui" created="Fri, 2 Aug 2019 11:48:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; I&apos;m afraid we need to avoid planner-specific code, as long as we still want Hive connector to work with both planners. I&apos;ll see whether we can reduce our usage of &lt;tt&gt;TypeConversions&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16900601" author="lirui" created="Tue, 6 Aug 2019 04:08:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; Just verified latest PR of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13495&quot; title=&quot;blink-planner should support decimal precision to table source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13495&quot;&gt;&lt;del&gt;FLINK-13495&lt;/del&gt;&lt;/a&gt; fixes the issues of reading decimal/char/varchar types in Hive connector (with some changes to Hive source/sink). I&apos;ll submit a PR for this ticket once &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13495&quot; title=&quot;blink-planner should support decimal precision to table source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13495&quot;&gt;&lt;del&gt;FLINK-13495&lt;/del&gt;&lt;/a&gt; is in.&lt;/p&gt;</comment>
                            <comment id="16906640" author="phoenixjiangnan" created="Tue, 13 Aug 2019 21:39:54 +0000"  >&lt;p&gt;merged in master: f33a6f0fd6d46d666d95707ac320115ada21cb0f  1.9.0: 3b04db5c9c6efda58883d4b11f3834b39491612d&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="13248526">FLINK-13549</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13247811">FLINK-13495</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z058m8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>