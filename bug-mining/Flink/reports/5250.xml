<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:55:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22084] RescalingITCase fails with adaptive scheduler</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22084</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15934&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4472&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15934&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4472&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-03-31T22:16:07.8416407Z [ERROR] testSavepointRescalingOutKeyedStateDerivedMaxParallelism[backend = rocksdb](org.apache.flink.test.checkpointing.RescalingITCase)  Time elapsed: 9.945 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
2021-03-31T22:16:07.8417534Z org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
2021-03-31T22:16:07.8418516Z 	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:144)
2021-03-31T22:16:07.8419281Z 	at org.apache.flink.test.util.TestUtils.submitJobAndWaitForResult(TestUtils.java:63)
2021-03-31T22:16:07.8420142Z 	at org.apache.flink.test.checkpointing.RescalingITCase.testSavepointRescalingKeyedState(RescalingITCase.java:251)
2021-03-31T22:16:07.8421173Z 	at org.apache.flink.test.checkpointing.RescalingITCase.testSavepointRescalingOutKeyedStateDerivedMaxParallelism(RescalingITCase.java:168)
2021-03-31T22:16:07.8421985Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
2021-03-31T22:16:07.8422651Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
2021-03-31T22:16:07.8423649Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2021-03-31T22:16:07.8424231Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2021-03-31T22:16:07.8424657Z 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
2021-03-31T22:16:07.8425147Z 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
2021-03-31T22:16:07.8425609Z 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
2021-03-31T22:16:07.8426183Z 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
2021-03-31T22:16:07.8569060Z 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
2021-03-31T22:16:07.8569781Z 	at org.apache.flink.util.TestNameProvider$1.evaluate(TestNameProvider.java:45)
2021-03-31T22:16:07.8570451Z 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
2021-03-31T22:16:07.8571040Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2021-03-31T22:16:07.8571604Z 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
2021-03-31T22:16:07.8572303Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
2021-03-31T22:16:07.8573259Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
2021-03-31T22:16:07.8573975Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2021-03-31T22:16:07.8574660Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2021-03-31T22:16:07.8575359Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2021-03-31T22:16:07.8576037Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2021-03-31T22:16:07.8576728Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2021-03-31T22:16:07.8577588Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2021-03-31T22:16:07.8578181Z 	at org.junit.runners.Suite.runChild(Suite.java:128)
2021-03-31T22:16:07.8578771Z 	at org.junit.runners.Suite.runChild(Suite.java:27)
2021-03-31T22:16:07.8579402Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2021-03-31T22:16:07.8580061Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2021-03-31T22:16:07.8580774Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2021-03-31T22:16:07.8581480Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2021-03-31T22:16:07.8582148Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2021-03-31T22:16:07.8582896Z 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
2021-03-31T22:16:07.8583762Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2021-03-31T22:16:07.8584427Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2021-03-31T22:16:07.8585069Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2021-03-31T22:16:07.8585671Z 	at org.junit.runners.Suite.runChild(Suite.java:128)
2021-03-31T22:16:07.8586254Z 	at org.junit.runners.Suite.runChild(Suite.java:27)
2021-03-31T22:16:07.8586875Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2021-03-31T22:16:07.8587643Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2021-03-31T22:16:07.8779731Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2021-03-31T22:16:07.8780398Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2021-03-31T22:16:07.8781024Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2021-03-31T22:16:07.8781702Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2021-03-31T22:16:07.8782346Z 	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
2021-03-31T22:16:07.8783166Z 	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
2021-03-31T22:16:07.8784006Z 	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
2021-03-31T22:16:07.8784796Z 	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
2021-03-31T22:16:07.8785556Z 	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
2021-03-31T22:16:07.8786346Z 	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
2021-03-31T22:16:07.8787299Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
2021-03-31T22:16:07.8788104Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
2021-03-31T22:16:07.8815851Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
2021-03-31T22:16:07.8816576Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-03-31T22:16:07.8819737Z Caused by: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: java.lang.IllegalStateException: Failed to rollback to checkpoint/savepoint Checkpoint Metadata. Max parallelism mismatch between checkpoint/savepoint state and &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program. Cannot map &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; 20ba6b65f97481d5570070de90e4e791 with max parallelism 13 to &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program with max parallelism 128. This indicates that the program has been changed in a non-compatible way after the checkpoint/savepoint.
2021-03-31T22:16:07.8821554Z 	at org.apache.flink.runtime.concurrent.FutureUtils.lambda$switchExecutor$23(FutureUtils.java:1362)
2021-03-31T22:16:07.8822349Z 	at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:836)
2021-03-31T22:16:07.8823178Z 	at java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:811)
2021-03-31T22:16:07.8823948Z 	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
2021-03-31T22:16:07.8824698Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRunAsync(AkkaRpcActor.java:440)
2021-03-31T22:16:07.8825485Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:208)
2021-03-31T22:16:07.8826318Z 	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:77)
2021-03-31T22:16:07.8827203Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:158)
2021-03-31T22:16:07.8827925Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2021-03-31T22:16:07.8828561Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2021-03-31T22:16:07.8829192Z 	at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2021-03-31T22:16:07.8829860Z 	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2021-03-31T22:16:07.8830536Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2021-03-31T22:16:07.8831187Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2021-03-31T22:16:07.8831853Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2021-03-31T22:16:07.8832477Z 	at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2021-03-31T22:16:07.8833155Z 	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2021-03-31T22:16:07.8833784Z 	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2021-03-31T22:16:07.8834351Z 	at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2021-03-31T22:16:07.8835134Z 	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2021-03-31T22:16:07.8835693Z 	at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2021-03-31T22:16:07.8836208Z 	at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2021-03-31T22:16:07.8836805Z 	at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2021-03-31T22:16:07.8837571Z 	at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2021-03-31T22:16:07.8838263Z 	at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2021-03-31T22:16:07.8838962Z 	at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2021-03-31T22:16:07.8841344Z Caused by: java.util.concurrent.CompletionException: java.lang.IllegalStateException: Failed to rollback to checkpoint/savepoint Checkpoint Metadata. Max parallelism mismatch between checkpoint/savepoint state and &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program. Cannot map &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; 20ba6b65f97481d5570070de90e4e791 with max parallelism 13 to &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program with max parallelism 128. This indicates that the program has been changed in a non-compatible way after the checkpoint/savepoint.
2021-03-31T22:16:07.8843188Z 	at org.apache.flink.runtime.scheduler.adaptive.BackgroundTask.lambda$&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;$0(BackgroundTask.java:59)
2021-03-31T22:16:07.8843956Z 	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
2021-03-31T22:16:07.8844829Z 	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
2021-03-31T22:16:07.8845596Z 	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
2021-03-31T22:16:07.8846306Z 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
2021-03-31T22:16:07.8846964Z 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
2021-03-31T22:16:07.8847833Z 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
2021-03-31T22:16:07.8848782Z 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
2021-03-31T22:16:07.8849613Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2021-03-31T22:16:07.8850360Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2021-03-31T22:16:07.8850983Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
2021-03-31T22:16:07.8852976Z Caused by: java.lang.IllegalStateException: Failed to rollback to checkpoint/savepoint Checkpoint Metadata. Max parallelism mismatch between checkpoint/savepoint state and &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program. Cannot map &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; 20ba6b65f97481d5570070de90e4e791 with max parallelism 13 to &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; program with max parallelism 128. This indicates that the program has been changed in a non-compatible way after the checkpoint/savepoint.
2021-03-31T22:16:07.8854549Z 	at org.apache.flink.runtime.checkpoint.Checkpoints.loadAndValidateCheckpoint(Checkpoints.java:181)
2021-03-31T22:16:07.8855424Z 	at org.apache.flink.runtime.checkpoint.CheckpointCoordinator.restoreSavepoint(CheckpointCoordinator.java:1630)
2021-03-31T22:16:07.8856440Z 	at org.apache.flink.runtime.scheduler.DefaultExecutionGraphFactory.tryRestoreExecutionGraphFromSavepoint(DefaultExecutionGraphFactory.java:163)
2021-03-31T22:16:07.8862100Z 	at org.apache.flink.runtime.scheduler.DefaultExecutionGraphFactory.createAndRestoreExecutionGraph(DefaultExecutionGraphFactory.java:138)
2021-03-31T22:16:07.8863316Z 	at org.apache.flink.runtime.scheduler.adaptive.AdaptiveScheduler.createExecutionGraphAndRestoreState(AdaptiveScheduler.java:971)
2021-03-31T22:16:07.8864391Z 	at org.apache.flink.runtime.scheduler.adaptive.AdaptiveScheduler.lambda$createExecutionGraphAndRestoreStateAsync$24(AdaptiveScheduler.java:961)
2021-03-31T22:16:07.8865366Z 	at org.apache.flink.runtime.scheduler.adaptive.BackgroundTask.lambda$&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;$0(BackgroundTask.java:57)
2021-03-31T22:16:07.8865913Z 	... 10 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13369040">FLINK-22084</key>
            <summary>RescalingITCase fails with adaptive scheduler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="austince">Austin Cawley-Edwards</assignee>
                                    <reporter username="dwysakowicz">Dawid Wysakowicz</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Thu, 1 Apr 2021 07:26:12 +0000</created>
                <updated>Tue, 22 Jun 2021 13:55:45 +0000</updated>
                            <resolved>Thu, 8 Apr 2021 22:18:42 +0000</resolved>
                                    <version>1.13.0</version>
                                    <fixVersion>1.13.0</fixVersion>
                                    <component>Runtime / Checkpointing</component>
                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17315281" author="maguowei" created="Tue, 6 Apr 2021 06:39:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16056&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4468&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16056&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4468&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17315293" author="maguowei" created="Tue, 6 Apr 2021 06:56:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16044&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16044&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4805&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17315301" author="maguowei" created="Tue, 6 Apr 2021 07:10:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16036&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16036&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4748&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17315320" author="till.rohrmann" created="Tue, 6 Apr 2021 07:41:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=austince&quot; class=&quot;user-hover&quot; rel=&quot;austince&quot;&gt;austince&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; could this be caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21844&quot; title=&quot;Do not auto-configure maxParallelism when setting &amp;quot;scheduler-mode: reactive&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21844&quot;&gt;&lt;del&gt;FLINK-21844&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17315387" author="maguowei" created="Tue, 6 Apr 2021 09:30:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16030&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16030&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4748&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17315603" author="austince" created="Tue, 6 Apr 2021 14:22:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt; very likely &#8211; I&apos;ll take this.&lt;/p&gt;</comment>
                            <comment id="17315618" author="zentol" created="Tue, 6 Apr 2021 14:36:56 +0000"  >&lt;p&gt;The test seems to use different maxParallelism values for subsequent job submissions; the first one uses 13, while in one of the test cases it later uses -1 to let Flink decide, and we come up with 128.&lt;/p&gt;

&lt;p&gt;I would think that this use-case shouldn&apos;t even be supported because it technically modifies the maxParallelism, but apparently it was supported so far.&lt;/p&gt;</comment>
                            <comment id="17315716" author="austince" created="Tue, 6 Apr 2021 16:51:12 +0000"  >&lt;p&gt;That is unfortunate, and yes I agree that it seems like it should not be supported. I guess this was supported before by allowing autoconfigured max parallelism to be overridden by the state restore.&lt;/p&gt;

&lt;p&gt;I believe this is broken because we first compute the &quot;initialParallelismStore&quot;, which defaults/ records if it has been autoconfigured, and then use that to create an &quot;adjusted&quot; parallelism store when creating the execution graph &lt;b&gt;without transferring autoconfiguration details&lt;/b&gt;, thus hiding if a vertex&apos;s max parallelism can be rescaled by the state.&lt;/p&gt;</comment>
                            <comment id="17316018" author="arvid" created="Wed, 7 Apr 2021 06:29:47 +0000"  >&lt;p&gt;We shouldn&apos;t support changes in maxParallelism. But in this case, we are telling Flink in the second run to use a value by itself and that should be set to 13.&lt;/p&gt;

&lt;p&gt;I&apos;m mostly wondering why it was working before and doesn&apos;t work anymore? Are we replacing -1 with 128 at the correct place?&lt;/p&gt;

&lt;p&gt;Btw f it&apos;s now too complicated to support, I&apos;d also be fine with dropping it (since it&apos;s super rare), but I still think that this is a valid use.&lt;/p&gt;</comment>
                            <comment id="17316037" author="dawidwys" created="Wed, 7 Apr 2021 06:50:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16093&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4808&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16093&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4808&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17316132" author="till.rohrmann" created="Wed, 7 Apr 2021 08:51:08 +0000"  >&lt;p&gt;I think this is one of these cases where we try to be super smart instead of requiring explicit configuration and failing if the job is not properly configured.&lt;/p&gt;

&lt;p&gt;Unfortunately, it is now supported by Flink and ideally we don&apos;t break this behaviour. If we decouple the state restore from the &lt;tt&gt;ExecutionGraph&lt;/tt&gt; creation (or at least move it out of the EG and do it before we create the EG), then it should be easy to fix. Now we probably need a workaround until this is possible.&lt;/p&gt;</comment>
                            <comment id="17317051" author="till.rohrmann" created="Thu, 8 Apr 2021 09:52:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=austince&quot; class=&quot;user-hover&quot; rel=&quot;austince&quot;&gt;austince&lt;/a&gt; can you move this ticket to in progress?&lt;/p&gt;</comment>
                            <comment id="17317523" author="zentol" created="Thu, 8 Apr 2021 22:18:42 +0000"  >&lt;p&gt;master: 4a6518b3f6301589e6b5869bb295dd146092fc7e&lt;/p&gt;</comment>
                            <comment id="17317713" author="dawidwys" created="Fri, 9 Apr 2021 06:42:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16232&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16232&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4751&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The run did not include the fix commit yet. Therefore I am not reopening the issue&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 31 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0pfuw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>