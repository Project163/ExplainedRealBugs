<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:46:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17958] Kubernetes session constantly allocates taskmanagers after cancel a job</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17958</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When i am testing the &lt;tt&gt;kubernetes-session.sh&lt;/tt&gt;, i find that the &lt;tt&gt;KubernetesResourceManager&lt;/tt&gt; will&#160;constantly allocate taskmanager after cancel a job. I think it may be caused by a bug of the following code. When the &lt;tt&gt;dividend&lt;/tt&gt; is 0 and &lt;tt&gt;divisor&lt;/tt&gt; is bigger than 1, the return value will be 1. However, we expect it to be 0.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * Divide and rounding up to integer.
 * E.g., divideRoundUp(3, 2) returns 2.
 * @param dividend value to be divided by the divisor
 * @param divisor value by which the dividend is to be divided
 * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the quotient rounding up to integer
 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; divideRoundUp(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; dividend, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; divisor) {
   &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (dividend - 1) / divisor + 1;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;How to reproduce this issue?&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Start a Kubernetes session&lt;/li&gt;
	&lt;li&gt;Submit a Flink job to the existing session&lt;/li&gt;
	&lt;li&gt;Cancel the job and wait for the TaskManager released via idle timeout&lt;/li&gt;
	&lt;li&gt;More and more TaskManagers will be allocated&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13307647">FLINK-17958</key>
            <summary>Kubernetes session constantly allocates taskmanagers after cancel a job</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xtsong">Xintong Song</assignee>
                                    <reporter username="wangyang0918">Yang Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 27 May 2020 08:21:17 +0000</created>
                <updated>Thu, 28 May 2020 07:57:16 +0000</updated>
                            <resolved>Thu, 28 May 2020 07:57:16 +0000</resolved>
                                    <version>1.11.0</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17117515" author="xintongsong" created="Wed, 27 May 2020 08:39:02 +0000"  >&lt;p&gt;True. I agree that the bug in &lt;tt&gt;MathUtils#divideRoundUp&lt;/tt&gt; is the cause of the problem.&lt;/p&gt;

&lt;p&gt;I think we should do the following things.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Make &lt;tt&gt;MathUtils#divideRoundUp&lt;/tt&gt; return 0 when &lt;tt&gt;dividend&lt;/tt&gt; is 0.&lt;/li&gt;
	&lt;li&gt;Check that &lt;tt&gt;dividend &amp;gt;= 0 &amp;amp;&amp;amp; divisor &amp;gt; 0&lt;/tt&gt;, and throw an exception otherwise.&lt;/li&gt;
	&lt;li&gt;Add more test cases for &lt;tt&gt;MathUtils#divideRoundUp&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;In &lt;tt&gt;WorkerSpecContainerResourceAdapter#normalize&lt;/tt&gt;, we should return &lt;tt&gt;unitValue&lt;/tt&gt; in case &lt;tt&gt;MathUtils#divideRoundUp&lt;/tt&gt; returns 0.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17118417" author="till.rohrmann" created="Thu, 28 May 2020 07:57:16 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;master: 1386e0db962a794e5cb78b72917a1c5340bd027e&lt;br/&gt;
1.11.0: 2cac04d7a74ff8fa7987bd137056381020775f07&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0f7bc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>