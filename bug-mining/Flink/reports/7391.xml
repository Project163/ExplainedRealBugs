<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:19:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-34034] When kv hint and list hint handle duplicate query hints, the results are different.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-34034</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When there are duplicate keys in the kv hint, calcite will overwrite the previous value with the later value.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@TestTemplate
def test(): Unit = {
  val sql =
    &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT &lt;span class=&quot;code-comment&quot;&gt;/*+ LOOKUP(&lt;span class=&quot;code-quote&quot;&gt;&apos;table&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;D&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;retry-predicate&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;lookup_miss&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;retry-strategy&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;fixed_delay&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;fixed-delay&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10s&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;max-attempts&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;3&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;max-attempts&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;4&apos;&lt;/span&gt;) */&lt;/span&gt; * FROM MyTable AS T JOIN LookupTable &quot;&lt;/span&gt; +
      &lt;span class=&quot;code-quote&quot;&gt;&quot;FOR SYSTEM_TIME AS OF T.proctime AS D ON T.a = D.id&quot;&lt;/span&gt;
  util.verifyExecPlan(sql)
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Calc(select=[a, b, c, PROCTIME_MATERIALIZE(proctime) AS proctime, rowtime, id, name, age]) 
  +- LookupJoin(table=[default_catalog.default_database.LookupTable], joinType=[InnerJoin], lookup=[id=a], select=[a, b, c, proctime, rowtime, id, name, age], retry=[lookup_miss, FIXED_DELAY, 10000ms, 4]) 
    +- DataStreamScan(table=[[default_catalog, default_database, MyTable]], fields=[a, b, c, proctime, rowtime])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But when a list hint is duplicated (such as a join hint), we will choose the first one as the effective hint.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13563994">FLINK-34034</key>
            <summary>When kv hint and list hint handle duplicate query hints, the results are different.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="337361684@qq.com">Yunhong Zheng</assignee>
                                    <reporter username="xuyangzhong">Xuyang Zhong</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 9 Jan 2024 06:48:20 +0000</created>
                <updated>Sun, 4 Feb 2024 09:51:50 +0000</updated>
                            <resolved>Sun, 4 Feb 2024 09:49:50 +0000</resolved>
                                    <version>1.18.0</version>
                    <version>1.19.0</version>
                    <version>1.18.1</version>
                                    <fixVersion>1.19.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17804601" author="qingyue" created="Tue, 9 Jan 2024 07:07:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuyangzhong&quot; class=&quot;user-hover&quot; rel=&quot;xuyangzhong&quot;&gt;xuyangzhong&lt;/a&gt;, thanks for reporting this issue.&lt;/p&gt;

&lt;p&gt;According to the implementation, the description of the &lt;a href=&quot;https://nightlies.apache.org/flink/flink-docs-release-1.18/docs/dev/table/sql/queries/hints/#conflict-cases-in-join-hints&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;hint doc&lt;/a&gt; does not match the actual behavior.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If the Join Hints conflicts occur, Flink will choose the most matching one. Conflict in one same Join Hint strategy, Flink will choose the first matching table for a join. Conflict in different Join Hints strategies, Flink will choose the first matching hint for a join.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However, I think having different behavior for the list option and KV options makes sense. For example, Java Map does not allow duplicate KVs, while the List is okay to have duplicated items.&lt;/p&gt;</comment>
                            <comment id="17804611" author="xuyangzhong" created="Tue, 9 Jan 2024 07:44:44 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qingyue&quot; class=&quot;user-hover&quot; rel=&quot;qingyue&quot;&gt;qingyue&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Our documentation currently seems not to expose whether table hints and join hints are kv hints or list hints. I believe that further exposing to users whether a certain type of query hint is a list or kv hint is not beneficial, as it would then need to tell users about their different behaviors: in case of a conflict, a list hint will choose the first one, whereas a kv hint, processed by Calcite, will select the last one when their keys are the same one. I prefer to let the framework ensure the consistency of these behaviors. WDYT?&lt;/p&gt;</comment>
                            <comment id="17814060" author="qingyue" created="Sun, 4 Feb 2024 09:49:50 +0000"  >&lt;p&gt;Fixed in master 433b025b057b2be7453cafd6f363ecb4eee48642&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 40 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mmq0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>