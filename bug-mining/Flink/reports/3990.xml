<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:45:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-16423] test_ha_per_job_cluster_datastream.sh gets stuck</title>
                <link>https://issues.apache.org/jira/browse/FLINK-16423</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;This was seen in &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=5905&amp;amp;view=logs&amp;amp;j=b1623ac9-0979-5b0d-2e5e-1377d695c991&amp;amp;t=e7804547-1789-5225-2bcf-269eeaa37447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=5905&amp;amp;view=logs&amp;amp;j=b1623ac9-0979-5b0d-2e5e-1377d695c991&amp;amp;t=e7804547-1789-5225-2bcf-269eeaa37447&lt;/a&gt; ... the relevant part of the logs is here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-03-04T11:27:25.4819486Z ==============================================================================
2020-03-04T11:27:25.4820470Z Running &lt;span class=&quot;code-quote&quot;&gt;&apos;Running HA per-job cluster (rocks, non-incremental) end-to-end test&apos;&lt;/span&gt;
2020-03-04T11:27:25.4820922Z ==============================================================================
2020-03-04T11:27:25.4840177Z TEST_DATA_DIR: /home/vsts/work/1/s/flink-end-to-end-tests/test-scripts/temp-test-directory-25482960156
2020-03-04T11:27:25.6712478Z Flink dist directory: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT
2020-03-04T11:27:25.6830402Z Flink dist directory: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT
2020-03-04T11:27:26.2988914Z Starting zookeeper daemon on host fv-az655.
2020-03-04T11:27:26.3001237Z Running on HA mode: parallelism=4, backend=rocks, asyncSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, and incremSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.
2020-03-04T11:27:27.4206924Z Starting standalonejob daemon on host fv-az655.
2020-03-04T11:27:27.4217066Z Start 1 more task managers
2020-03-04T11:27:30.8412541Z Starting taskexecutor daemon on host fv-az655.
2020-03-04T11:27:38.1779980Z Job (00000000000000000000000000000000) is running.
2020-03-04T11:27:38.1781375Z Running JM watchdog @ 89778
2020-03-04T11:27:38.1781858Z Running TM watchdog @ 89779
2020-03-04T11:27:38.1783272Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; text Completed checkpoint [1-9]* &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; job 00000000000000000000000000000000 to appear 2 of times in logs...
2020-03-04T13:21:29.9076797Z ##[error]The operation was canceled.
2020-03-04T13:21:29.9094090Z ##[section]Finishing: Run e2e tests
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The last three lines indicate that the test is waiting forever for a checkpoint to appear.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13289537">FLINK-16423</key>
            <summary>test_ha_per_job_cluster_datastream.sh gets stuck</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 4 Mar 2020 13:34:24 +0000</created>
                <updated>Wed, 29 Apr 2020 13:19:31 +0000</updated>
                            <resolved>Mon, 20 Apr 2020 16:04:27 +0000</resolved>
                                                                    <component>Runtime / Checkpointing</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17066646" author="rmetzger" created="Wed, 25 Mar 2020 12:42:10 +0000"  >&lt;p&gt;This time, it is the &quot;Running HA (rocks, non-incremental) end-to-end&quot; test (defined in test_ha_datastream.sh): &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=6605&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=6605&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-03-25T07:58:13.0519937Z ==============================================================================
2020-03-25T07:58:13.0520821Z Running &lt;span class=&quot;code-quote&quot;&gt;&apos;Running HA (rocks, non-incremental) end-to-end test&apos;&lt;/span&gt;
2020-03-25T07:58:13.0521463Z ==============================================================================
2020-03-25T07:58:13.0568337Z TEST_DATA_DIR: /home/vsts/work/1/s/flink-end-to-end-tests/test-scripts/temp-test-directory-13056102659
2020-03-25T07:58:13.2459951Z Flink dist directory: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT
2020-03-25T07:58:13.2641419Z Flink dist directory: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT
2020-03-25T07:58:13.4935708Z Starting zookeeper daemon on host fv-az678.
2020-03-25T07:58:13.6586879Z Starting HA cluster with 1 masters.
2020-03-25T07:58:14.1123374Z Starting standalonesession daemon on host fv-az678.
2020-03-25T07:58:16.3858487Z Starting taskexecutor daemon on host fv-az678.
2020-03-25T07:58:16.4569875Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-03-25T07:58:17.5191614Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-03-25T07:58:18.5738994Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-03-25T07:58:19.9690298Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-03-25T07:58:21.0494277Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-03-25T07:58:22.0961059Z Dispatcher REST endpoint is up.
2020-03-25T07:58:22.0961573Z Running on HA mode: parallelism=4, backend=rocks, asyncSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, and incremSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.
2020-03-25T07:58:33.1308229Z Job (65f21654a530ff9063116a91f419eb1b) is running.
2020-03-25T07:58:33.1309909Z Running JM watchdog @ 62236
2020-03-25T07:58:38.1331595Z Running TM watchdog @ 64235
2020-03-25T07:58:38.1333335Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; text Completed checkpoint [1-9]* &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; job 65f21654a530ff9063116a91f419eb1b to appear 2 of times in logs...
2020-03-25T07:58:41.6939725Z Killed TM @ 60470
2020-03-25T09:55:52.6931725Z ##[error]The operation was canceled.
2020-03-25T09:55:52.6947548Z ##[section]Finishing: Run e2e tests
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I report the failure from a different script here as well, as I suspect them to be related.&lt;/p&gt;</comment>
                            <comment id="17073664" author="rmetzger" created="Thu, 2 Apr 2020 12:01:27 +0000"  >&lt;p&gt;Another case: &lt;a href=&quot;https://dev.azure.com/rmetzger/5bd3ef0a-4359-41af-abca-811b04098d2e/_apis/build/builds/6965/logs/155&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/5bd3ef0a-4359-41af-abca-811b04098d2e/_apis/build/builds/6965/logs/155&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17074350" author="rmetzger" created="Fri, 3 Apr 2020 07:41:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7014&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7014&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17074396" author="rmetzger" created="Fri, 3 Apr 2020 08:25:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7013&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7013&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17074429" author="till.rohrmann" created="Fri, 3 Apr 2020 09:20:15 +0000"  >&lt;p&gt;Shouldn&apos;t the component be &lt;tt&gt;Runtime / Checkpointing&lt;/tt&gt; if the checkpoints don&apos;t appear &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17076476" author="rmetzger" created="Mon, 6 Apr 2020 17:07:59 +0000"  >&lt;p&gt;I&apos;m not sure yet what the root cause of the problem is. Once I&apos;ve identified it, I&apos;ll assign the component properly.&lt;/p&gt;

&lt;p&gt;Another case: &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7104&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7104&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17076995" author="rmetzger" created="Tue, 7 Apr 2020 07:20:27 +0000"  >&lt;p&gt;Another case: &lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7128&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=7128&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17077466" author="rmetzger" created="Tue, 7 Apr 2020 17:46:05 +0000"  >&lt;p&gt;Analysis of failed jobs + last message:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;HA per-job cluster (rocks, non-incremental) end-to-end test: Waiting for text Completed checkpoint&lt;/li&gt;
	&lt;li&gt;Running HA (rocks, non-incremental) end-to-end test: Killed TM @ 60470&lt;/li&gt;
	&lt;li&gt;Running HA (rocks, non-incremental) end-to-end test: Killed TM @ 70629&lt;/li&gt;
	&lt;li&gt;Running HA (rocks, non-incremental) end-to-end test: Killed TM @ 62146&lt;/li&gt;
	&lt;li&gt;Running HA (file, sync) end-to-end test: Killed TM @ 53085&lt;/li&gt;
	&lt;li&gt;Running HA per-job cluster (file, sync) end-to-end test: Killed TM @ 97323&lt;/li&gt;
	&lt;li&gt;Running HA (rocks, non-incremental) end-to-end test: Killed TM @ 50490&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17078019" author="rmetzger" created="Wed, 8 Apr 2020 10:07:27 +0000"  >&lt;p&gt;I was finally able to isolate a failure with good logs. This issue seems to be related to the checkpointing.&lt;/p&gt;

&lt;p&gt;here is the output from the e2e test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-04-08T09:14:35.0313320Z Starting zookeeper daemon on host fv-az32.
2020-04-08T09:14:35.1677419Z Starting HA cluster with 1 masters.
2020-04-08T09:14:35.5878680Z Starting standalonesession daemon on host fv-az32.
2020-04-08T09:14:38.0473360Z Starting taskexecutor daemon on host fv-az32.
2020-04-08T09:14:38.0871778Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-04-08T09:14:39.1349049Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-04-08T09:14:40.6058895Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-04-08T09:14:41.7923885Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Dispatcher REST endpoint to come up...
2020-04-08T09:14:42.8574257Z Dispatcher REST endpoint is up.
2020-04-08T09:14:43.5236634Z Running on HA mode: parallelism=4, backend=file, asyncSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, and incremSnapshots=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.
2020-04-08T09:14:53.2042561Z Job (8f0e52b7936bf3c3562869a1245c09a7) is running.
2020-04-08T09:14:53.2070245Z Running JM watchdog @ 39872
2020-04-08T09:14:58.2126283Z Running TM watchdog @ 40353
2020-04-08T09:14:58.2131214Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; text Completed checkpoint [1-9]* &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; job 8f0e52b7936bf3c3562869a1245c09a7 to appear 2 of times in logs...
2020-04-08T09:14:58.8598035Z Killed JM @ 38795
2020-04-08T09:14:58.8637495Z Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; text Completed checkpoint [1-9]* &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; job 8f0e52b7936bf3c3562869a1245c09a7 to appear 2 of times in logs...
2020-04-08T09:14:58.8950102Z grep: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT/log/*standalonesession-1*.log: No such file or directory
2020-04-08T09:14:59.8373637Z Starting standalonesession daemon on host fv-az32.
2020-04-08T09:14:59.9034988Z grep: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT/log/*standalonesession-1*.log: No such file or directory
2020-04-08T09:15:01.5369130Z grep: /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT/log/*standalonesession-1*.log: No such file or directory
2020-04-08T09:15:01.7818592Z Killed TM @ 39090
2020-04-08T09:15:48.1832528Z Killed TM @ 41002
2020-04-08T09:16:00.5940266Z Killed TM @ 42747
2020-04-08T09:24:34.8032228Z Test (pid: 38219) did not finish after 600 seconds.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I only checked the logs of the second standalone session, and I found the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;it successfully restores the last checkpoint from the first standalone session (checkpoint 5)&lt;/li&gt;
	&lt;li&gt;It completes checkpoint 8 (not sure where 6,7 are?)&lt;/li&gt;
	&lt;li&gt;it triggers checkpoint 9&lt;/li&gt;
	&lt;li&gt;it has an artificial failure&lt;/li&gt;
	&lt;li&gt;it fails trying to restore checkpoint 9 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-04-08 09:15:45,639 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - SlidingWindowCheckMapper -&amp;gt; Sink: SlidingWindowCheckPrintSink (2/4) (27bca3ef87f434874ab87b5d7eede1b9) switched from RUNNING to FAILED.
java.lang.Exception: Exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:191) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:246) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.OperatorChain.initializeStateAndOpenOperators(OperatorChain.java:293) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$beforeInvoke$0(StreamTask.java:436) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.runThrowing(StreamTaskActionExecutor.java:47) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.beforeInvoke(StreamTask.java:432) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:445) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:718) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:542) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) ~[?:1.8.0_242]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; StreamFlatMap_149799a3e2c39804818236cc493c243c_(2/4) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:135) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:304) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:131) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	... 9 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Failed when trying to restore heap backend
	at org.apache.flink.runtime.state.heap.HeapKeyedStateBackendBuilder.build(HeapKeyedStateBackendBuilder.java:116) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.filesystem.FsStateBackend.createKeyedStateBackend(FsStateBackend.java:529) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$1(StreamTaskStateInitializerImpl.java:288) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:142) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:121) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:304) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:131) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	... 9 more
Caused by: java.io.FileNotFoundException: /home/vsts/work/1/s/flink-end-to-end-tests/test-scripts/temp-test-directory-34578709671/checkpoints/8f0e52b7936bf3c3562869a1245c09a7/chk-9/f16bc9dd-7b4b-413a-9c8e-876d62acc46a (No such file or directory)
	at java.io.FileInputStream.open0(Native Method) ~[?:1.8.0_242]
	at java.io.FileInputStream.open(FileInputStream.java:195) ~[?:1.8.0_242]
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:138) ~[?:1.8.0_242]
	at org.apache.flink.core.fs.local.LocalDataInputStream.&amp;lt;init&amp;gt;(LocalDataInputStream.java:50) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.core.fs.local.LocalFileSystem.open(LocalFileSystem.java:142) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.core.fs.SafetyNetWrapperFileSystem.open(SafetyNetWrapperFileSystem.java:85) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.filesystem.FileStateHandle.openInputStream(FileStateHandle.java:68) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.KeyGroupsStateHandle.openInputStream(KeyGroupsStateHandle.java:112) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.heap.HeapRestoreOperation.restore(HeapRestoreOperation.java:125) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.heap.HeapKeyedStateBackendBuilder.build(HeapKeyedStateBackendBuilder.java:114) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.runtime.state.filesystem.FsStateBackend.createKeyedStateBackend(FsStateBackend.java:529) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$1(StreamTaskStateInitializerImpl.java:288) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:142) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:121) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:304) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:131) ~[flink-dist_2.11-1.11-SNAPSHOT.jar:1.11-SNAPSHOT]
	... 9 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I attached the logs&lt;/p&gt;</comment>
                            <comment id="17078057" author="sleepy" created="Wed, 8 Apr 2020 10:55:29 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt; for analyzing so deeply. I checked the attached log. I believe the scenario is same with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16770&quot; title=&quot;Resuming Externalized Checkpoint (rocks, incremental, scale up) end-to-end test fails with no such file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16770&quot;&gt;&lt;del&gt;FLINK-16770&lt;/del&gt;&lt;/a&gt;. The problem happens when checkpoint 9 is doing finalization. We can see that the &lt;tt&gt;CheckpointCoordinator&lt;/tt&gt; tried to recover from checkpoint 9. So the checkpoint 9 must be added into &lt;tt&gt;CompletedCheckpointStore&lt;/tt&gt;. However we can&apos;t find the log &quot;Completed checkpoint 9 ...&quot;. It must failed after being added into &lt;tt&gt;CompletedCheckpointStore&lt;/tt&gt;, like being aborted due to the &quot;artificial failure&quot;. Regarding to &quot;where is the checkpoint 6, 7, 8&quot;, since we only keep 1 successful checkpoint in &lt;tt&gt;CompletedCheckpointStore&lt;/tt&gt;, they must be subsumed when checkpoint 9 was adding into &lt;tt&gt;CompletedCheckpointStore&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The work-around fixing so far of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16770&quot; title=&quot;Resuming Externalized Checkpoint (rocks, incremental, scale up) end-to-end test fails with no such file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16770&quot;&gt;&lt;del&gt;FLINK-16770&lt;/del&gt;&lt;/a&gt; is that keeping 2 successful checkpoints in &lt;tt&gt;CompletedCheckpointStore&lt;/tt&gt;&#160;for these cases. So even if checkpoint 9 doesn&apos;t finish the finalization, there should be at least checkpoint 8 existing.&lt;/p&gt;

&lt;p&gt;If it gets stuck quite frequently, we could apply the work-around fixing for the case. However this bug has to be fixed completely before releasing 1.11.&lt;/p&gt;</comment>
                            <comment id="17078304" author="rmetzger" created="Wed, 8 Apr 2020 13:58:17 +0000"  >&lt;p&gt;I fully agree that we need to fix this before releasing 1.11.&lt;/p&gt;

&lt;p&gt;I would suggest to disable the tests, because our checkpointing is currently broken.&lt;br/&gt;
As part of the pull request disabling the tests, I will also improve the tests so that they time out and write the logs (that&apos;s how I was able to find the issue).&lt;/p&gt;</comment>
                            <comment id="17087960" author="rmetzger" created="Mon, 20 Apr 2020 17:41:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; I kept this ticket open because I wanted to improve the e2e test failing because of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16770&quot; title=&quot;Resuming Externalized Checkpoint (rocks, incremental, scale up) end-to-end test fails with no such file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16770&quot;&gt;&lt;del&gt;FLINK-16770&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The test is stalling forever in case of an error, I opened a PR 2 hours ago to fix that.&lt;/p&gt;

&lt;p&gt;Ok to reopen this until the PR is merged?&lt;/p&gt;</comment>
                            <comment id="17088375" author="pnowojski" created="Tue, 21 Apr 2020 07:22:13 +0000"  >&lt;p&gt;Ops, I&apos;ve missed that. I&apos;m not sure if this should be a new ticket then or not. But in case you would like to repurpose this ticket I think this should be changed from bug to improvement and deprioritized.&lt;/p&gt;</comment>
                            <comment id="17088453" author="till.rohrmann" created="Tue, 21 Apr 2020 09:03:53 +0000"  >&lt;p&gt;Duplicates should not have a fix version since the original issue will decide when it is fixed. Removing the fix version now.&lt;/p&gt;</comment>
                            <comment id="17091312" author="rmetzger" created="Fri, 24 Apr 2020 08:02:05 +0000"  >&lt;p&gt;Another case: &lt;a href=&quot;https://api.travis-ci.org/v3/job/678609505/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://api.travis-ci.org/v3/job/678609505/log.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17091340" author="till.rohrmann" created="Fri, 24 Apr 2020 08:44:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt; shouldn&apos;t your comment go to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16770&quot; title=&quot;Resuming Externalized Checkpoint (rocks, incremental, scale up) end-to-end test fails with no such file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16770&quot;&gt;&lt;del&gt;FLINK-16770&lt;/del&gt;&lt;/a&gt; since this is a duplicate which has been closed?&lt;/p&gt;</comment>
                            <comment id="17091376" author="rmetzger" created="Fri, 24 Apr 2020 09:28:42 +0000"  >&lt;p&gt;Okay, I can also post there. I didn&apos;t want to distract the discussion on how to resolve the issue by my case reports.&lt;/p&gt;</comment>
                            <comment id="17091557" author="till.rohrmann" created="Fri, 24 Apr 2020 13:11:00 +0000"  >&lt;p&gt;I was just wondering whether this report will be noticed if the issue has&lt;br/&gt;
been closed.&lt;/p&gt;

&lt;p&gt;On Fri, Apr 24, 2020 at 11:29 AM Robert Metzger (Jira) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="17091561" author="rmetzger" created="Fri, 24 Apr 2020 13:15:56 +0000"  >&lt;p&gt;No, you are right. It was good that I posted the case on &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16770&quot; title=&quot;Resuming Externalized Checkpoint (rocks, incremental, scale up) end-to-end test fails with no such file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16770&quot;&gt;&lt;del&gt;FLINK-16770&lt;/del&gt;&lt;/a&gt;, as you can see from Piotr&apos;s reaction &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="17095447" author="rmetzger" created="Wed, 29 Apr 2020 13:19:31 +0000"  >&lt;p&gt;Improved E2E test in &lt;a href=&quot;https://github.com/apache/flink/commit/1855bf39773f46f94845c528519a9bb820b520fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/1855bf39773f46f94845c528519a9bb820b520fe&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13293757">FLINK-16770</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13293757">FLINK-16770</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12999312" name="20200408.1.tgz" size="6978708" author="rmetzger" created="Wed, 8 Apr 2020 10:08:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 28 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0c5o8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>