<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:21:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-37093] The catalog that failed validation due to no type still exists in catalogStoreHolder</title>
                <link>https://issues.apache.org/jira/browse/FLINK-37093</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;here&apos;s sql-client (1.20 &amp;amp; 2.0-preview1):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; create catalog cat1;&lt;/b&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Could not execute SQL statement. Reason:&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;org.apache.flink.table.api.ValidationException: Catalog options do not contain an option key &apos;type&apos; for discovering a catalog.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; show catalogs;&lt;/b&gt;&lt;br/&gt;
&lt;ins&gt;-----------------&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160; &#160;catalog name&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;-----------------&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160; &#160; &#160; &#160; &#160; &#160;cat1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;default_catalog&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;-----------------&lt;/ins&gt;&lt;br/&gt;
2 rows in set&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; use catalog cat1;&lt;/b&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Could not execute SQL statement. Reason:&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;org.apache.flink.table.api.ValidationException: Catalog options do not contain an option key &apos;type&apos; for discovering a catalog.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; alter catalog cat1 comment &apos;no type&apos;;&lt;/b&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Could not execute SQL statement. Reason:&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;org.apache.flink.table.api.ValidationException: Catalog options do not contain an option key &apos;type&apos; for discovering a catalog.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; create catalog cat1;&lt;/b&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Could not execute SQL statement. Reason:&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#ff0000&quot;&gt;org.apache.flink.table.catalog.exceptions.CatalogException: Catalog cat1 already exists.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; drop catalog cat1;&lt;/b&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Execute statement succeeded.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Flink SQL&amp;gt; show catalogs;&lt;/b&gt;&lt;br/&gt;
&lt;ins&gt;-----------------&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160; &#160;catalog name&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;-----------------&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;default_catalog&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;ins&gt;-----------------&lt;/ins&gt;&lt;br/&gt;
1 row in set&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When I create a catalog without type , the sql will parsed successfully. According to the code :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void createCatalog(
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; catalogName, CatalogDescriptor catalogDescriptor, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ignoreIfExists)
&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; CatalogException {
checkArgument(
!StringUtils.isNullOrWhitespaceOnly(catalogName),
&lt;span class=&quot;code-quote&quot;&gt;&quot;Catalog name cannot be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; or empty.&quot;&lt;/span&gt;);
checkNotNull(catalogDescriptor, &lt;span class=&quot;code-quote&quot;&gt;&quot;Catalog descriptor cannot be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; catalogExistsInStore = catalogStoreHolder.catalogStore().contains(catalogName);
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; catalogExistsInMemory = catalogs.containsKey(catalogName);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (catalogExistsInStore || catalogExistsInMemory) {
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!ignoreIfExists)
{ &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CatalogException(format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Catalog %s already exists.&quot;&lt;/span&gt;, catalogName)); }
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; { 
&lt;span class=&quot;code-comment&quot;&gt;// Store the catalog in the catalog store 
&lt;/span&gt;catalogStoreHolder.catalogStore().storeCatalog(catalogName, catalogDescriptor); 

&lt;span class=&quot;code-comment&quot;&gt;// Initialize and store the catalog in memory 
&lt;/span&gt;Catalog catalog = initCatalog(catalogName, catalogDescriptor); 
catalog.open(); 
catalogs.put(catalogName, catalog); 
}
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the catalog will store in the catalog store first, then failed in initCatalog() method.&lt;/p&gt;

&lt;p&gt;the result is the catalog still exists in catalogStoreHolder. And I cannot use, alter or create it again.&lt;/p&gt;

&lt;p&gt;I noticed the alterCatalog() method, the proces is :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Catalog newCatalog = initCatalog(catalogName, newDescriptor);
catalogStore.removeCatalog(catalogName, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (catalogs.containsKey(catalogName))
{ catalogs.get(catalogName).close(); }
newCatalog.open();
catalogs.put(catalogName, newCatalog);
catalogStoreHolder.catalogStore().storeCatalog(catalogName, newDescriptor); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;store in catalogStoreHolder should after initCatalog() and open().&lt;/p&gt;</description>
                <environment>&lt;p&gt;mac os&lt;/p&gt;</environment>
        <key id="13604475">FLINK-37093</key>
            <summary>The catalog that failed validation due to no type still exists in catalogStoreHolder</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jiefei30">Mingcan Wang</assignee>
                                    <reporter username="jiefei30">Mingcan Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 10 Jan 2025 07:56:27 +0000</created>
                <updated>Mon, 24 Feb 2025 01:50:41 +0000</updated>
                            <resolved>Tue, 11 Feb 2025 01:25:40 +0000</resolved>
                                    <version>1.20.0</version>
                    <version>2.0-preview</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17911817" author="JIRAUSER302010" created="Fri, 10 Jan 2025 08:13:18 +0000"  >&lt;p&gt;can anyone assign this issue to me ? thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17925809" author="fsk119" created="Tue, 11 Feb 2025 01:25:27 +0000"  >&lt;p&gt;Merged into master: 14b5d53472efe95ae89543d9a0ec0b0c1f9d1994&lt;/p&gt;</comment>
                            <comment id="17929547" author="hackergin" created="Mon, 24 Feb 2025 01:50:41 +0000"  >&lt;p&gt;Merged into release-2.0: fb4d6624e7adfeb75bd8210fd98e32fb3a93c718&lt;/p&gt;

&lt;p&gt;release-1.20: d24c626735de906e493373ef17b9fd7af29ae492&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tj0w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>