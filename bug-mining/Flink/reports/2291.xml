<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4569] JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4569</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The mentioned test seems to fail frequently, without being detected, because the Assert.fail() is called in a separate thread which doesn&apos;t forward exceptions.&lt;br/&gt;
&lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/156177995/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/156177995/log.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002317">FLINK-4569</key>
            <summary>JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 2 Sep 2016 10:21:01 +0000</created>
                <updated>Thu, 15 Mar 2018 07:02:54 +0000</updated>
                            <resolved>Thu, 15 Mar 2018 07:02:54 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Command Line Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16395079" author="githubbot" created="Mon, 12 Mar 2018 11:07:25 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5681&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5681&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4569&quot; title=&quot;JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4569&quot;&gt;&lt;del&gt;FLINK-4569&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Fix JobRetrievalITCase&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This PR contains 2 changes to the `JobRetrievalITCase`.&lt;/p&gt;

&lt;p&gt;    1) We now store exceptions that occur in the submitting thread in a `AtomicReference` that we evaluate at the end of the test.&lt;/p&gt;

&lt;p&gt;    2) It could happen that the lock (preventing the job from terminating) was released before the client had a chance to finish the retrieval. To remedy this we now only release the lock if the thread has terminated, either by successfully connecting or failing with an error.&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 4569&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5681.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5681.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5681&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d45d8883365ef73c7064adfd098feea208d2ca4c&lt;br/&gt;
Author: zentol &amp;lt;chesnay@...&amp;gt;&lt;br/&gt;
Date:   2018-03-12T11:01:57Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4569&quot; title=&quot;JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4569&quot;&gt;&lt;del&gt;FLINK-4569&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Fix JobRetrievalITCase&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16395253" author="githubbot" created="Mon, 12 Mar 2018 13:52:35 +0000"  >&lt;p&gt;Github user zentol closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5681&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5681&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16396865" author="githubbot" created="Tue, 13 Mar 2018 12:05:00 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4569&quot; title=&quot;JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4569&quot;&gt;&lt;del&gt;FLINK-4569&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Respect exceptions thrown in thread in JobRetrievalITCase&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This PR ensures that exceptions that occur in the submitting thread actually fail the test. Also contains minor fixes, like setting a thread name (for debugging purposes) and releasing the lock in the `SemaphoreInvokable` to allow multiple runs in the IDE.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    One can modify the test to throw an exception after connecting successfully, which will fail the test.&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 4569&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5689&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 13c383d439550b1ebdc869981a7ffa19a6c8a151&lt;br/&gt;
Author: zentol &amp;lt;chesnay@...&amp;gt;&lt;br/&gt;
Date:   2018-03-13T12:00:47Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4569&quot; title=&quot;JobRetrievalITCase.testJobRetrieval() does not forward exceptions to parent thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4569&quot;&gt;&lt;del&gt;FLINK-4569&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Respect exceptions thrown in thread in JobRetrievalITCase&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16396953" author="githubbot" created="Tue, 13 Mar 2018 13:49:21 +0000"  >&lt;p&gt;Github user kl0u commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689#discussion_r174135885&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689#discussion_r174135885&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/java/org/apache/flink/test/example/client/JobRetrievalITCase.java &amp;#8212;&lt;br/&gt;
    @@ -119,6 +121,11 @@ public void run() {&lt;br/&gt;
     		lock.release();&lt;/p&gt;

&lt;p&gt;     		resumingThread.join();&lt;br/&gt;
    +&lt;br/&gt;
    +		Throwable exception = error.get();&lt;br/&gt;
    +		if (exception != null) &lt;/p&gt;
{
    +			throw new AssertionError(exception);
    +		}
&lt;p&gt;    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Is this any different from using `Assert.assertNull(error.get())`? Not that it makes any difference but just to know why you picked throwing the exception here. Personally I think that the assertNull seems more explicit when you read the code and it is less verbose.&lt;/p&gt;</comment>
                            <comment id="16396968" author="githubbot" created="Tue, 13 Mar 2018 14:00:16 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689#discussion_r174140412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689#discussion_r174140412&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/java/org/apache/flink/test/example/client/JobRetrievalITCase.java &amp;#8212;&lt;br/&gt;
    @@ -119,6 +121,11 @@ public void run() {&lt;br/&gt;
     		lock.release();&lt;/p&gt;

&lt;p&gt;     		resumingThread.join();&lt;br/&gt;
    +&lt;br/&gt;
    +		Throwable exception = error.get();&lt;br/&gt;
    +		if (exception != null) &lt;/p&gt;
{
    +			throw new AssertionError(exception);
    +		}
&lt;p&gt;    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    assertNull throws a NPE. This throws the actual exception with stacktrace etc and is the most equivalent to just throwing the exception.&lt;/p&gt;</comment>
                            <comment id="16399199" author="githubbot" created="Wed, 14 Mar 2018 19:48:03 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging,&lt;/p&gt;</comment>
                            <comment id="16400007" author="githubbot" created="Thu, 15 Mar 2018 07:01:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5689&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16400012" author="zentol" created="Thu, 15 Mar 2018 07:02:54 +0000"  >&lt;p&gt;master: a04c8a08383e329213bd74c726f9834b7d19762d&lt;br/&gt;
1.5: 9b1b7f385f11745544eab21f0383ca3f73e63814&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i336gv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>