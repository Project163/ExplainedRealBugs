<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:19:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-34343] ResourceManager registration is not completed when registering the JobMaster</title>
                <link>https://issues.apache.org/jira/browse/FLINK-34343</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=57203&amp;amp;view=logs&amp;amp;j=64debf87-ecdb-5aef-788d-8720d341b5cb&amp;amp;t=2302fb98-0839-5df2-3354-bbae636f81a7&amp;amp;l=8066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=57203&amp;amp;view=logs&amp;amp;j=64debf87-ecdb-5aef-788d-8720d341b5cb&amp;amp;t=2302fb98-0839-5df2-3354-bbae636f81a7&amp;amp;l=8066&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The test run failed due to a NullPointerException:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Feb 02 01:11:55 2024-02-02 01:11:47,791 INFO  org.apache.flink.runtime.rpc.pekko.FencedPekkoRpcActor       [] - The rpc endpoint org.apache.flink.runtime.resourcemanager.active.ActiveResourceManager has not been started yet. Discarding message LocalFencedMessage(0000000000000000000
0000000000000, LocalRpcInvocation(ResourceManagerGateway.registerJobMaster(JobMasterId, ResourceID, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, JobID, Time))) until processing is started.
Feb 02 01:11:55 2024-02-02 01:11:47,797 WARN  org.apache.flink.runtime.rpc.pekko.SupervisorActor           [] - RpcActor pekko:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/rpc/resourcemanager_2 has failed. Shutting it down now.
&lt;/span&gt;Feb 02 01:11:55 java.lang.NullPointerException: Cannot invoke &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink.runtime.rpc.RpcServer.getAddress()&quot;&lt;/span&gt; because &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rpcServer&quot;&lt;/span&gt; is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
Feb 02 01:11:55         at org.apache.flink.runtime.rpc.RpcEndpoint.getAddress(RpcEndpoint.java:322) ~[flink-dist-1.19-SNAPSHOT.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleMessage(PekkoRpcActor.java:182) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:33) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:29) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at scala.PartialFunction.applyOrElse(PartialFunction.scala:127) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at scala.PartialFunction.applyOrElse$(PartialFunction.scala:126) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:29) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:175) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.actor.Actor.aroundReceive(Actor.scala:547) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.actor.Actor.aroundReceive$(Actor.scala:545) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.actor.AbstractActor.aroundReceive(AbstractActor.scala:229) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.actor.ActorCell.receiveMessage(ActorCell.scala:590) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.actor.ActorCell.invoke(ActorCell.scala:557) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.dispatch.Mailbox.processMailbox(Mailbox.scala:280) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.dispatch.Mailbox.run(Mailbox.scala:241) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at org.apache.pekko.dispatch.Mailbox.exec(Mailbox.scala:253) ~[flink-rpc-akka06a9bb81-2e68-483a-b236-a283d0b1d097.jar:1.19-SNAPSHOT]
Feb 02 01:11:55         at java.util.concurrent.ForkJoinTask.doExec(Unknown Source) ~[?:?]
Feb 02 01:11:55         at java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(Unknown Source) ~[?:?]
Feb 02 01:11:55         at java.util.concurrent.ForkJoinPool.scan(Unknown Source) ~[?:?]
Feb 02 01:11:55         at java.util.concurrent.ForkJoinPool.runWorker(Unknown Source) ~[?:?]
Feb 02 01:11:55         at java.util.concurrent.ForkJoinWorkerThread.run(Unknown Source) ~[?:?]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13567177">FLINK-34343</key>
            <summary>ResourceManager registration is not completed when registering the JobMaster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 2 Feb 2024 11:25:41 +0000</created>
                <updated>Mon, 5 Feb 2024 11:46:33 +0000</updated>
                            <resolved>Mon, 5 Feb 2024 11:46:33 +0000</resolved>
                                    <version>1.17.2</version>
                    <version>1.19.0</version>
                    <version>1.18.1</version>
                                    <fixVersion>1.19.0</fixVersion>
                    <fixVersion>1.17.3</fixVersion>
                    <fixVersion>1.18.2</fixVersion>
                                    <component>Runtime / Coordination</component>
                    <component>Runtime / RPC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17813624" author="mapohl" created="Fri, 2 Feb 2024 11:28:29 +0000"  >&lt;p&gt;Initially, I thought that it would be caused by the &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34007&quot; title=&quot;Flink Job stuck in suspend state after losing leadership in HA Mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34007&quot;&gt;&lt;del&gt;FLINK-34007&lt;/del&gt;&lt;/a&gt; changes. But that&apos;s not the case. The &quot;Run kubernetes application test&quot; doesn&apos;t rely HA but uses &lt;tt&gt;StandaloneLeaderElection&lt;/tt&gt; (sessionId: &lt;tt&gt;00000000000000000000000000000000&lt;/tt&gt;).&lt;/p&gt;</comment>
                            <comment id="17813627" author="mapohl" created="Fri, 2 Feb 2024 11:36:41 +0000"  >&lt;p&gt;I attached the logs of the corresponding failure to this issue.&lt;/p&gt;</comment>
                            <comment id="17813629" author="mapohl" created="Fri, 2 Feb 2024 11:39:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; do you have capacity to look at that one? I&apos;m still investigating the &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34007&quot; title=&quot;Flink Job stuck in suspend state after losing leadership in HA Mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34007&quot;&gt;&lt;del&gt;FLINK-34007&lt;/del&gt;&lt;/a&gt; test instability.&lt;/p&gt;</comment>
                            <comment id="17813902" author="zentol" created="Sat, 3 Feb 2024 10:18:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt; and I looked at this together and concluded that his is one hell of a race condition. There&apos;s a short window where the underlying infrastructure for &lt;em&gt;receiving&lt;/em&gt; messages already exists, without the rpcServer field being set yet in the RpcEndpoint.&lt;br/&gt;
While these messages are correctly rejected by the RpcActor before being passed to the RpcEndpoint (as it hasn&apos;t started yet), for logging purposes we access the RpcEndpoint&apos;s address; but that one is contingent of the rpcServer field being set.&lt;br/&gt;
In the end it boils down to accesses to the RpcEndpoint while it is still being set up.&lt;/p&gt;

&lt;p&gt;An easy fix is to just not use the address but the actor path.&lt;/p&gt;</comment>
                            <comment id="17814330" author="zentol" created="Mon, 5 Feb 2024 11:46:33 +0000"  >&lt;p&gt;master: 839f298c3838f2f4981e271554b82fae770747d8&lt;br/&gt;
1.18: ee9945cd785577d0f68092823b71abbb53d127f8&lt;br/&gt;
1.17: 3f22b6363e6cad4352821f42907ec8a2a181e675&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                                                <inwardlinks description="Discovered while testing">
                                        <issuelink>
            <issuekey id="13563759">FLINK-34007</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13066432" name="FLINK-34343_k8s_application_cluster_e2e_test.log" size="141006" author="mapohl" created="Fri, 2 Feb 2024 11:36:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1n6d4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>