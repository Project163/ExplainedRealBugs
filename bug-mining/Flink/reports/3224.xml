<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:40:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-13588] StreamTask.handleAsyncException throws away the exception cause</title>
                <link>https://issues.apache.org/jira/browse/FLINK-13588</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Code below throws the reason &apos;message&apos; away making it hard to diagnose why a split has failed for instance.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/apache/flink/blob/master/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java#L909
&lt;/span&gt;
@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void handleAsyncException(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message, Throwable exception) {
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isRunning) {
	&lt;span class=&quot;code-comment&quot;&gt;// only fail &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the task is still running
&lt;/span&gt;	getEnvironment().failExternally(exception);
	}
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Need to pass the message through so that we see it in logs please.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13248949">FLINK-13588</key>
            <summary>StreamTask.handleAsyncException throws away the exception cause</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="johnlon">John Lonergan</assignee>
                                    <reporter username="johnlon">John Lonergan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 5 Aug 2019 18:58:59 +0000</created>
                <updated>Fri, 12 Nov 2021 22:47:52 +0000</updated>
                            <resolved>Wed, 21 Aug 2019 06:14:24 +0000</resolved>
                                    <version>1.8.1</version>
                                    <fixVersion>1.9.1</fixVersion>
                    <fixVersion>1.10.0</fixVersion>
                                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="16900947" author="yanghua" created="Tue, 6 Aug 2019 12:00:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnlon&quot; class=&quot;user-hover&quot; rel=&quot;johnlon&quot;&gt;johnlon&lt;/a&gt; I think your opinion is reasonable. I&apos;d like to fix this issue. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16901925" author="till.rohrmann" created="Wed, 7 Aug 2019 09:30:46 +0000"  >&lt;p&gt;I think the rationale is that exceptions which occur after the task has stopped running should no longer be relevant and hence don&apos;t need to be logged. Exceptions could occur when shutting down the task, for example. This is expected and should not be reported. Does this make sense &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnlon&quot; class=&quot;user-hover&quot; rel=&quot;johnlon&quot;&gt;johnlon&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16903278" author="johnlon" created="Thu, 8 Aug 2019 20:04:00 +0000"  >&lt;p&gt;Don&apos;t agree.&lt;/p&gt;

&lt;p&gt;If there is context then the code should not throw it away. Principal.&lt;/p&gt;

&lt;p&gt;Without the exception message I cannot discover why the split failed.&lt;/p&gt;

&lt;p&gt;For example we had a failure because of a zero byte avro file in hdfs. The&lt;br/&gt;
error message had the filename in it but the code throws it away.&lt;/p&gt;

&lt;p&gt;As a result we had to write and run a separate trivial job that brute&lt;br/&gt;
forced reading all the files (100k) without flinks help.&lt;/p&gt;

&lt;p&gt;The change is justified.&lt;br/&gt;
I don&apos;t think it&apos;s reasonable to throw this away. It looks like the error&lt;br/&gt;
handling /logging is a bit inconsistent for sure.&lt;/p&gt;

&lt;p&gt;We are now running with a modified version of this class that wraps the&lt;br/&gt;
original exception into a runtime exception that includes the cause text.&lt;/p&gt;






</comment>
                            <comment id="16907053" author="till.rohrmann" created="Wed, 14 Aug 2019 09:12:09 +0000"  >&lt;p&gt;Ah I think I misunderstood the problem. You are proposing to do the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void handleAsyncException(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message, Throwable exception) {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isRunning) {
    getEnvironment().failExternally(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AsyncFlinkException(message, exception));
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;?&lt;/p&gt;

&lt;p&gt;If that is the case, then I can assign you to this issue and you could then open a PR to fix it.&lt;/p&gt;</comment>
                            <comment id="16907109" author="johnlon" created="Wed, 14 Aug 2019 09:50:00 +0000"  >&lt;p&gt;Hi yes that&apos;s how we&quot;fixed&quot; it because it limits the change to a one liner.&lt;/p&gt;


</comment>
                            <comment id="16907128" author="till.rohrmann" created="Wed, 14 Aug 2019 10:13:58 +0000"  >&lt;p&gt;Great, I&apos;ve assigned you to this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnlon&quot; class=&quot;user-hover&quot; rel=&quot;johnlon&quot;&gt;johnlon&lt;/a&gt;. Now you could open a PR for this fix. Ping me and I&apos;ll review it. If you don&apos;t have time for this, then let me know and I&apos;ll do it.&lt;/p&gt;</comment>
                            <comment id="16908529" author="johnlon" created="Thu, 15 Aug 2019 22:48:15 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/flink/pull/9456&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/9456&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hi done the work including test - trivial change.&lt;/p&gt;

&lt;p&gt;Unfortunately I cannot verify the test as I couldn&apos;t work out how to make the existing build including tests on master run to completion without tests hanging for ages, and loads of errors.&lt;/p&gt;

&lt;p&gt;I am using Java 8 221&lt;/p&gt;

&lt;p&gt;Tried maven 3.1.1 and 3.2.5&lt;/p&gt;

&lt;p&gt;No idea how to fix.&lt;/p&gt;

&lt;p&gt;The following works but doesn&apos;t run tests ....&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;mvn clean package -DskipTests # this will take up to 10 minutes&lt;/tt&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Also couldn&apos;t run test in IntelliJ getting error&#160;&lt;/p&gt;

&lt;p&gt;Error:java: invalid flag: --add-exports=java.base/sun.net.util=ALL-UNNAMED&lt;/p&gt;</comment>
                            <comment id="16908841" author="till.rohrmann" created="Fri, 16 Aug 2019 08:20:58 +0000"  >&lt;p&gt;Thanks for opening ta PR &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johnlon&quot; class=&quot;user-hover&quot; rel=&quot;johnlon&quot;&gt;johnlon&lt;/a&gt;. I&apos;ll take a look at the PR.&lt;/p&gt;

&lt;p&gt;Just curious, where was the build hanging exactly?&lt;/p&gt;</comment>
                            <comment id="16911975" author="till.rohrmann" created="Wed, 21 Aug 2019 06:14:24 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.10.0: 8935ebf1b1f36109e3b1c48a5aba8e63f9df263a&lt;br/&gt;
1.9.1: 6f7d62528eba6387dae20f8e1678af2fd36a46c6&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05cgg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>