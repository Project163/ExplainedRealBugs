<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:17:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-610] Replace Avro serialization by Kryo </title>
                <link>https://issues.apache.org/jira/browse/FLINK-610</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>

&lt;p&gt;---------------- Imported from GitHub ----------------&lt;br/&gt;
Url: &lt;a href=&quot;https://github.com/stratosphere/stratosphere/issues/610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stratosphere/stratosphere/issues/610&lt;/a&gt;&lt;br/&gt;
Created by: &lt;a href=&quot;https://github.com/rmetzger&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;rmetzger&lt;/a&gt;&lt;br/&gt;
Labels: java api, &lt;br/&gt;
Milestone: Release 0.6 (unplanned)&lt;br/&gt;
Created at: Tue Mar 18 17:29:28 CET 2014&lt;br/&gt;
State: open&lt;/p&gt;</description>
                <environment></environment>
        <key id="12719785">FLINK-610</key>
            <summary>Replace Avro serialization by Kryo </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="github-import">GitHub Import</reporter>
                        <labels>
                            <label>github-import</label>
                    </labels>
                <created>Mon, 9 Jun 2014 12:36:25 +0000</created>
                <updated>Thu, 28 Feb 2019 14:29:42 +0000</updated>
                            <resolved>Thu, 18 Dec 2014 11:01:17 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14024088" author="github-import" created="Mon, 9 Jun 2014 12:36:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/alexff91]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Tue Mar 18 20:07:21 CET 2014, Author: [alexff91&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You want to add addon - Kryo? &lt;br/&gt;
and change the following code:&lt;br/&gt;
 ```java&lt;br/&gt;
@Override&lt;br/&gt;
	public void write(DataOutput out) throws IOException {&lt;br/&gt;
		// the null flag&lt;br/&gt;
		if (datum() == null) &lt;/p&gt;
{
			out.writeBoolean(false);
		}
&lt;p&gt; else &lt;/p&gt;
{
			out.writeBoolean(true);
			
			DataOutputEncoder encoder = getEncoder();
			encoder.setOut(out);
			getWriter().write(datum(), encoder);
		}
&lt;p&gt;	}&lt;br/&gt;
```&lt;/p&gt;

&lt;p&gt;To something like:&lt;br/&gt;
 ```java&lt;br/&gt;
@Override&lt;br/&gt;
    public&lt;br/&gt;
    void write(&lt;br/&gt;
            Kryo kryo,&lt;br/&gt;
            Output output) &lt;/p&gt;
{
        kryo.writeObject(output,
                         blockId);
    }

&lt;p&gt;    @Override&lt;br/&gt;
    public&lt;br/&gt;
    void read(&lt;br/&gt;
            Kryo kryo,&lt;br/&gt;
            Input input) &lt;/p&gt;
{
        Integer blockId = kryo.readObject(input,
                                          Integer.class);
        this.blockId = blockId;
    }
&lt;p&gt; ```&lt;/p&gt;</comment>
                            <comment id="14024089" author="github-import" created="Mon, 9 Jun 2014 12:36:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/rmetzger]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Wed Mar 19 09:53:49 CET 2014, Author: [rmetzger&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As far as I understand the issue, the goal is to use the much faster Kryo serialization framework instead of Avro.&lt;br/&gt;
Right now, we use the serializers from Avro for the new Java API&apos;s support to use arbitrary objects. We hope to increase the performance by using Kryo for that task.&lt;/p&gt;

&lt;p&gt;Where have you taken the first code-snipped from?&lt;/p&gt;</comment>
                            <comment id="14024090" author="github-import" created="Mon, 9 Jun 2014 12:36:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/alexff91]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Wed Mar 19 10:52:07 CET 2014, Author: [alexff91&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have taken this from avro-addon for stratosphere project.l, by searching&lt;br/&gt;
usages of Avro in API.&lt;br/&gt;
19.03.2014 12:53 &#208;&#207;&#204;&#216;&#218;&#207;&#215;&#193;&#212;&#197;&#204;&#216; &quot;Robert Metzger&quot; &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
&#206;&#193;&#208;&#201;&#211;&#193;&#204;:&lt;/p&gt;

&lt;p&gt;&amp;gt; As far as I understand the issue, the goal is to use the much faster Kryo&lt;br/&gt;
&amp;gt; serialization framework instead of Avro.&lt;br/&gt;
&amp;gt; Right now, we use the serializers from Avro for the new Java API&apos;s support&lt;br/&gt;
&amp;gt; to use arbitrary objects. We hope to increase the performance by using Kryo&lt;br/&gt;
&amp;gt; for that task.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; Where have you taken the first code-snipped from?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; &amp;#8211;&lt;br/&gt;
&amp;gt; Reply to this email directly or view it on GitHub&amp;lt;&lt;a href=&quot;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38028827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38028827&lt;/a&gt;&amp;gt;&lt;br/&gt;
&amp;gt; .&lt;br/&gt;
&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14024091" author="github-import" created="Mon, 9 Jun 2014 12:36:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/StephanEwen]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Wed Mar 19 11:12:21 CET 2014, Author: [StephanEwen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Have a look at the&lt;br/&gt;
eu.stratosphere.api.java.typeutils.runtime.AvroSerializer&lt;/p&gt;

&lt;p&gt;A Kryo Serializer would implement the same interface.&lt;/p&gt;


&lt;p&gt;On Wed, Mar 19, 2014 at 10:52 AM, Aleksandr &amp;lt;notifications@github.com&amp;gt;wrote:&lt;/p&gt;

&lt;p&gt;&amp;gt; I have taken this from avro-addon for stratosphere project.l, by searching&lt;br/&gt;
&amp;gt; usages of Avro in API.&lt;br/&gt;
&amp;gt; 19.03.2014 12:53 &#208;&#207;&#204;&#216;&#218;&#207;&#215;&#193;&#212;&#197;&#204;&#216; &quot;Robert Metzger&quot; &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
&amp;gt; &#206;&#193;&#208;&#201;&#211;&#193;&#204;:&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; &amp;gt; As far as I understand the issue, the goal is to use the much faster&lt;br/&gt;
&amp;gt; Kryo&lt;br/&gt;
&amp;gt; &amp;gt; serialization framework instead of Avro.&lt;br/&gt;
&amp;gt; &amp;gt; Right now, we use the serializers from Avro for the new Java API&apos;s&lt;br/&gt;
&amp;gt; support&lt;br/&gt;
&amp;gt; &amp;gt; to use arbitrary objects. We hope to increase the performance by using&lt;br/&gt;
&amp;gt; Kryo&lt;br/&gt;
&amp;gt; &amp;gt; for that task.&lt;br/&gt;
&amp;gt; &amp;gt;&lt;br/&gt;
&amp;gt; &amp;gt; Where have you taken the first code-snipped from?&lt;br/&gt;
&amp;gt; &amp;gt;&lt;br/&gt;
&amp;gt; &amp;gt; &amp;#8211;&lt;br/&gt;
&amp;gt; &amp;gt; Reply to this email directly or view it on GitHub&amp;lt;&lt;br/&gt;
&amp;gt; &lt;a href=&quot;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38028827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38028827&lt;/a&gt;&amp;gt;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; &amp;gt; .&lt;br/&gt;
&amp;gt; &amp;gt;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; &#8212;&lt;br/&gt;
&amp;gt; Reply to this email directly or view it on GitHub&amp;lt;&lt;a href=&quot;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38033001&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stratosphere/stratosphere/issues/610#issuecomment-38033001&lt;/a&gt;&amp;gt;&lt;br/&gt;
&amp;gt; .&lt;br/&gt;
&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14024092" author="github-import" created="Mon, 9 Jun 2014 12:36:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/alexff91]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Wed Mar 19 13:57:12 CET 2014, Author: [alexff91&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I will add KryoSerializer near AvroSerializer and  test for testing which of them faster.&lt;/p&gt;</comment>
                            <comment id="14024093" author="github-import" created="Mon, 9 Jun 2014 12:36:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/fabiofumarola]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Tue Apr 08 10:32:16 CEST 2014, Author: [fabiofumarola&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It is not need to try yourself which is the fast. Have a look at &lt;a href=&quot;https://github.com/eishay/jvm-serializers/wiki&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eishay/jvm-serializers/wiki&lt;/a&gt;. There is a deeply analysis on jvm serializers performance. My option is that would be better to do overloading on the methods in order to support different serialization frameworks. &lt;/p&gt;</comment>
                            <comment id="14024094" author="github-import" created="Mon, 9 Jun 2014 12:36:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/alexff91]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Date: Tue Apr 08 10:44:07 CEST 2014, Author: [alexff91&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the link @fabiofumarola. I&apos;m trying to do KryoSerializer like AvroSerializer by overloading methods, but I can&apos;t find any test which uses AvroSerializer to check if everything is ok. &lt;/p&gt;</comment>
                            <comment id="14065153" author="githubbot" created="Thu, 17 Jul 2014 17:14:55 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-610&quot; title=&quot;Replace Avro serialization by Kryo &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-610&quot;&gt;&lt;del&gt;FLINK-610&lt;/del&gt;&lt;/a&gt; Added KryoSerializer&lt;/p&gt;

&lt;p&gt;    I added the KryoSerializer and replaced the AvroSerializer as the standard generic type serializer. Due to the way Flink&apos;s serialization works, we cannot exploit Kryo&apos;s Inputs which buffer data for serialization. Instead, we have to read byte after byte if we do not know the length of the underlying data. This has consequences for variable length encodings. Kryo will fall back to a slow deserialization of these types, since it will read only one byte at a time. I do not know the implications of this on Kryo&apos;s performance. Therefore, I did not remove Avro completely yet. Furthermore, Kryo should be tested on the cluster and if possible its performance should be compared to Avro.&lt;/p&gt;

&lt;p&gt;    We could mitigate the problem if we don&apos;t use variable length encodings for types such as ```int```s and ```long```s. This, however, comes at the price of larger serialized objects. For UTF8 strings, the problem would  persist.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/incubator-flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/incubator-flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-610&quot; title=&quot;Replace Avro serialization by Kryo &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-610&quot;&gt;&lt;del&gt;FLINK-610&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #74&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0c618c20bc7be64de82e0e7d3f7734e8c68593bb&lt;br/&gt;
Author: Till Rohrmann &amp;lt;till.rohrmann@gmail.com&amp;gt;&lt;br/&gt;
Date:   2014-07-17T15:21:59Z&lt;/p&gt;

&lt;p&gt;    Added KryoSerializer&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14066189" author="githubbot" created="Fri, 18 Jul 2014 09:27:02 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-49411918&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-49411918&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for doing this so fast.&lt;/p&gt;

&lt;p&gt;    Do you know whether the problems you mentioned will be resolved by &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; title=&quot;Extend TypeSerializers and -Comparators to work directly on Memory Segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-987&quot;&gt;FLINK-987&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987)?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-987)?&lt;/a&gt; In other words, are the problems only temporary until &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; title=&quot;Extend TypeSerializers and -Comparators to work directly on Memory Segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-987&quot;&gt;FLINK-987&lt;/a&gt; is done?&lt;/p&gt;</comment>
                            <comment id="14066234" author="githubbot" created="Fri, 18 Jul 2014 10:22:11 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-49416463&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-49416463&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The underlying problem is that Flink can use different serializers for serialized objects in one stream. Thus, it is not possible to use the Kryo serializer all the time. If that weren&apos;t the case, it would not matter whether Kryo already read some data into its buffer belonging to the next object.&lt;/p&gt;

&lt;p&gt;    If we have a memory abstraction instead of a stream, as proposed in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; title=&quot;Extend TypeSerializers and -Comparators to work directly on Memory Segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-987&quot;&gt;FLINK-987&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-987&lt;/a&gt;), which allows to seek the current pointer, we should be able to virtually write data back which has been read from a different object. However, that would require that we can seek backwards over memory segment borders.&lt;/p&gt;</comment>
                            <comment id="14066244" author="githubbot" created="Fri, 18 Jul 2014 10:33:57 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-49417330&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-49417330&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I might be able to provide that as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; title=&quot;Extend TypeSerializers and -Comparators to work directly on Memory Segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-987&quot;&gt;FLINK-987&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-987&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-987&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="14103373" author="githubbot" created="Wed, 20 Aug 2014 04:59:21 +0000"  >&lt;p&gt;Github user hsaputra commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-52734136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-52734136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Do you use tab in the patch source or is it 4 spaces?&lt;/p&gt;</comment>
                            <comment id="14103677" author="githubbot" created="Wed, 20 Aug 2014 09:31:04 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-52753332&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-52753332&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We agreed to use single tab spaces for indentation. Due to that the code on Github does not look so compactly. Did I mix it up somewhere in the code?&lt;/p&gt;</comment>
                            <comment id="14103889" author="githubbot" created="Wed, 20 Aug 2014 13:53:28 +0000"  >&lt;p&gt;Github user hsaputra commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74#issuecomment-52780715&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74#issuecomment-52780715&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    No, you were right. It caught me by surprise because most of the Java/ Scala code I have been working with use spaces for indentation.&lt;/p&gt;</comment>
                            <comment id="14118391" author="githubbot" created="Tue, 2 Sep 2014 17:26:27 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/74&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/74&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14169143" author="rmetzger" created="Mon, 13 Oct 2014 09:55:53 +0000"  >&lt;p&gt;I just found out that Avro is not even able to serialize java.util.Date (it took me some time to figure out why my join is not working). They have already fixed the issue in the upcoming 1.8.0 release: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-739&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-739&lt;/a&gt;&lt;br/&gt;
Still, I think this issue is very important if we claim to support arbitrary java objects in our API.&lt;/p&gt;</comment>
                            <comment id="14248082" author="rmetzger" created="Tue, 16 Dec 2014 10:13:59 +0000"  >&lt;p&gt;Another user is affected by this issue.&lt;br/&gt;
I&apos;ll replace the generic serialization with Kryo for the 0.8 release. &lt;/p&gt;</comment>
                            <comment id="14248841" author="githubbot" created="Tue, 16 Dec 2014 20:18:08 +0000"  >&lt;p&gt;GitHub user rmetzger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-610&quot; title=&quot;Replace Avro serialization by Kryo &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-610&quot;&gt;&lt;del&gt;FLINK-610&lt;/del&gt;&lt;/a&gt; Replace Avro with Kryo as the GenericType serializer&lt;/p&gt;

&lt;p&gt;    This pull request is basically a collection of the work of others &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    @tillrohrmann contributed some of the tests (in particular for the serializer itself). He did the integration with &lt;span class=&quot;error&quot;&gt;&amp;#91;Chill&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/twitter/chill&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twitter/chill&lt;/a&gt;).&lt;br/&gt;
    @twalthr contributed one commit for fixing a TypeExtractor bug.&lt;/p&gt;

&lt;p&gt;    I added two IT cases, checking it to work with the following types:&lt;/p&gt;

&lt;p&gt;    ```java&lt;br/&gt;
    java.util.List&amp;lt;String&amp;gt;&lt;br/&gt;
    scala.math.BigInt&lt;br/&gt;
    java.io.File&lt;br/&gt;
    java.math.BigDecimal;&lt;br/&gt;
    java.math.BigInteger;&lt;br/&gt;
    java.util.HashMap;&lt;br/&gt;
    java.io.Serializable;&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    I also tested it on a cluster with a Collection of Objects (containing Strings and Integers). It worked. I didn&apos;t test it for performance yet. The purpose of the pull request is to extend the type support for cases we don&apos;t cover by our own serialization framework.&lt;/p&gt;

&lt;p&gt;    I&apos;ll now test the change with the code that brought the issue on top of my TODO list: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-629?focusedCommentId=14241856&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14241856&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-629?focusedCommentId=14241856&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14241856&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rmetzger/incubator-flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rmetzger/incubator-flink&lt;/a&gt; flink610-master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #271&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b9dac6bad47e41fc3bc1dafc3eaede1a3bf63496&lt;br/&gt;
Author: twalthr &amp;lt;info@twalthr.com&amp;gt;&lt;br/&gt;
Date:   2014-12-10T21:02:07Z&lt;/p&gt;

&lt;p&gt;    Fix invalid type hierarchy creation by Pojo logic&lt;/p&gt;

&lt;p&gt;commit 64d2e52970f761ad117aec0080d0618f7f7ace95&lt;br/&gt;
Author: Robert Metzger &amp;lt;rmetzger@apache.org&amp;gt;&lt;br/&gt;
Date:   2014-12-16T10:30:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-610&quot; title=&quot;Replace Avro serialization by Kryo &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-610&quot;&gt;&lt;del&gt;FLINK-610&lt;/del&gt;&lt;/a&gt; Replace Avro by Kryo as the GenericType serializer&lt;/p&gt;

&lt;p&gt;    The performance of data-intensive jobs using Kryo is probably going to be slow.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14249662" author="githubbot" created="Wed, 17 Dec 2014 09:53:15 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67299689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67299689&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I rebased the pull request to the 0.8 branch and added a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1333&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-1333&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14249667" author="githubbot" created="Wed, 17 Dec 2014 09:58:16 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67300275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67300275&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Very good idea. I think we could fix this still a bit and make it better:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Avro created a schema from the objects to serialize (somewhat a simple thing as our POJO analysis). That way, it does not need to write all classnames. Kryo writes all classnames by default, which is very painful, unless they are registered. I think that was one of the reasons why Avro was actually faster for us out of the box.&lt;/li&gt;
	&lt;li&gt;We should register the types at Kryo that we see as being (recursively contained in the type information)&lt;/li&gt;
	&lt;li&gt;We should also allow at the execution environment to manually register types or serializers.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Why is the `copy()` method not using Kryo&apos;s copy functionality? The current implementation seems painfully inefficient, and will still be used until @aljoscha &apos;s change about reuse/non-reuse mode is in.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The tests that have a hardwired check for the KryoSerializer break design...&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;    It seems that the Java/Scala code is moving closer together still, with the common serializer being configured in the Java API for Scala classes. That means we might really collapse the projects at some point.&lt;/p&gt;</comment>
                            <comment id="14249711" author="githubbot" created="Wed, 17 Dec 2014 10:59:26 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67307001&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67307001&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thank you for the feedback.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;We are using the Twitter Chill library. It registers many commonly used classes with Kryo (Collections, Date, BigInt, ...). So the issue with class names being written does only apply to userdefined types.&lt;br/&gt;
    You are indeed right that we should provide facilities to register custom classes and that we should register all classes we see during type analysis.&lt;br/&gt;
    I didn&apos;t implement these features because Timo is actually working on this and I wanted to have at least basic Kryo support in the release. Timo will integrate Kryo more tightly with the type analysis.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The `copy()` method of Kryo is not implemented for many types (in particular those by Chill). For example the java.sql.Date type (&lt;a href=&quot;https://github.com/twitter/chill/blob/develop/chill-java/src/main/java/com/twitter/chill/java/SqlDateSerializer.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twitter/chill/blob/develop/chill-java/src/main/java/com/twitter/chill/java/SqlDateSerializer.java&lt;/a&gt;) doesn&apos;t have a copy() method.&lt;br/&gt;
    Kryo provides a default copy() method which fails on mutable types. (&lt;a href=&quot;https://github.com/EsotericSoftware/kryo/blob/master/src/com/esotericsoftware/kryo/Serializer.java#L102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/EsotericSoftware/kryo/blob/master/src/com/esotericsoftware/kryo/Serializer.java#L102&lt;/a&gt;). I thought about contributing the missing copy() methods for chill.&lt;br/&gt;
    We could also whitelist some classes for kryo&apos;s copy and fall back to the slow variant.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The hardwired check for the KryoSerializer is very ugly. Maybe I can come up with a different solution. Till suggested to add a method (`canCreateInstance`) to all serializers .. but thats a lot of code for one test case.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14249804" author="githubbot" created="Wed, 17 Dec 2014 12:57:22 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67318300&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67318300&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    How about we try to use Kryo&apos;s copy method and fall back to serialization&lt;br/&gt;
    copies upon failure?&lt;br/&gt;
    Am 17.12.2014 11:59 schrieb &quot;Robert Metzger&quot; &amp;lt;notifications@github.com&amp;gt;:&lt;/p&gt;

&lt;p&gt;    &amp;gt; Thank you for the feedback.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt;    -&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt;    We are using the Twitter Chill library. It registers many commonly&lt;br/&gt;
    &amp;gt;    used classes with Kryo (Collections, Date, BigInt, ...). So the issue with&lt;br/&gt;
    &amp;gt;    class names being written does only apply to userdefined types.&lt;br/&gt;
    &amp;gt;    You are indeed right that we should provide facilities to register&lt;br/&gt;
    &amp;gt;    custom classes and that we should register all classes we see during type&lt;br/&gt;
    &amp;gt;    analysis.&lt;br/&gt;
    &amp;gt;    I didn&apos;t implement these features because Timo is actually working on&lt;br/&gt;
    &amp;gt;    this and I wanted to have at least basic Kryo support in the release. Timo&lt;br/&gt;
    &amp;gt;    will integrate Kryo more tightly with the type analysis.&lt;br/&gt;
    &amp;gt;    -&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt;    The copy() method of Kryo is not implemented for many types (in&lt;br/&gt;
    &amp;gt;    particular those by Chill). For example the java.sql.Date type (&lt;br/&gt;
    &amp;gt;    &lt;a href=&quot;https://github.com/twitter/chill/blob/develop/chill-java/src/main/java/com/twitter/chill/java/SqlDateSerializer.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twitter/chill/blob/develop/chill-java/src/main/java/com/twitter/chill/java/SqlDateSerializer.java&lt;/a&gt;)&lt;br/&gt;
    &amp;gt;    doesn&apos;t have a copy() method.&lt;br/&gt;
    &amp;gt;    Kryo provides a default copy() method which fails on mutable types. (&lt;br/&gt;
    &amp;gt;    &lt;a href=&quot;https://github.com/EsotericSoftware/kryo/blob/master/src/com/esotericsoftware/kryo/Serializer.java#L102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/EsotericSoftware/kryo/blob/master/src/com/esotericsoftware/kryo/Serializer.java#L102&lt;/a&gt;).&lt;br/&gt;
    &amp;gt;    I thought about contributing the missing copy() methods for chill.&lt;br/&gt;
    &amp;gt;    We could also whitelist some classes for kryo&apos;s copy and fall back to&lt;br/&gt;
    &amp;gt;    the slow variant.&lt;br/&gt;
    &amp;gt;    -&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt;    The hardwired check for the KryoSerializer is very ugly. Maybe I can&lt;br/&gt;
    &amp;gt;    come up with a different solution. Till suggested to add a method (&lt;br/&gt;
    &amp;gt;    canCreateInstance) to all serializers .. but thats a lot of code for&lt;br/&gt;
    &amp;gt;    one test case.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &#8212;&lt;br/&gt;
    &amp;gt; Reply to this email directly or view it on GitHub&lt;br/&gt;
    &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67307001&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67307001&lt;/a&gt;&amp;gt;&lt;br/&gt;
    &amp;gt; .&lt;br/&gt;
    &amp;gt;&lt;/p&gt;</comment>
                            <comment id="14249809" author="githubbot" created="Wed, 17 Dec 2014 12:58:19 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67318414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67318414&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Okay, I&apos;ll add that&lt;/p&gt;</comment>
                            <comment id="14250016" author="githubbot" created="Wed, 17 Dec 2014 15:46:20 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67341195&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67341195&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    That makes sense.&lt;/p&gt;

&lt;p&gt;    +1 to merge&lt;/p&gt;</comment>
                            <comment id="14251505" author="githubbot" created="Thu, 18 Dec 2014 11:00:27 +0000"  >&lt;p&gt;Github user rmetzger commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271#issuecomment-67470974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271#issuecomment-67470974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Manually closing it. Has been merged&lt;/p&gt;</comment>
                            <comment id="14251506" author="githubbot" created="Thu, 18 Dec 2014 11:00:28 +0000"  >&lt;p&gt;Github user rmetzger closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/271&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/271&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14251509" author="rmetzger" created="Thu, 18 Dec 2014 11:01:17 +0000"  >&lt;p&gt;&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/incubator-flink/commit/a70aa67a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/incubator-flink/commit/a70aa67a&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12766895">FLINK-1391</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>397984</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wiof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>398111</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>