<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:45:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17390] Container resource cannot be mapped on Hadoop 2.10+</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17390</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16438&quot; title=&quot;Make YarnResourceManager starts workers using WorkerResourceSpec requested by SlotManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16438&quot;&gt;&lt;del&gt;FLINK-16438&lt;/del&gt;&lt;/a&gt;, we introduced &lt;tt&gt;WorkerSpecContainerResourceAdapter&lt;/tt&gt; for mapping Yarn container &lt;tt&gt;Resource&lt;/tt&gt; with Flink &lt;tt&gt;WorkerResourceSpec&lt;/tt&gt;. Inside this class, we use &lt;tt&gt;Resource&lt;/tt&gt; for hash map keys and set elements, assuming that &lt;tt&gt;Resource&lt;/tt&gt; instances that describes the same set of resources have the same hash code.&lt;/p&gt;

&lt;p&gt;This assumption is not always true. &lt;tt&gt;Resource&lt;/tt&gt; is an abstract class and may have different implementations. In Hadoop 2.10+, &lt;tt&gt;LightWeightResource&lt;/tt&gt;, a new implementation of &lt;tt&gt;Resource&lt;/tt&gt;, is introduced for &lt;tt&gt;Resource&lt;/tt&gt; generated by &lt;tt&gt;Resource.newInstance&lt;/tt&gt; on the AM side, which overrides the &lt;tt&gt;hashCode&lt;/tt&gt; method. That means, a&#160;&lt;tt&gt;Resource&lt;/tt&gt; generated on AM may have a different hash code compared to an equal &lt;tt&gt;Resource&lt;/tt&gt; returned from Yarn.&lt;/p&gt;

&lt;p&gt;To solve this problem, we may introduce an &lt;tt&gt;InternalResource&lt;/tt&gt; as an inner class of &lt;tt&gt;WorkerSpecContainerResourceAdapter&lt;/tt&gt;, with &lt;tt&gt;hashCode&lt;/tt&gt; method depends only on the fields needed by Flink (ATM memroy and vcores). &lt;tt&gt;WorkerSpecContainerResourceAdapter&lt;/tt&gt; should only use &lt;tt&gt;InternalResource&lt;/tt&gt; for internal state management, and do conversions for &lt;tt&gt;Resource&lt;/tt&gt; passed into and returned from it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13301075">FLINK-17390</key>
            <summary>Container resource cannot be mapped on Hadoop 2.10+</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xtsong">Xintong Song</assignee>
                                    <reporter username="xtsong">Xintong Song</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sun, 26 Apr 2020 11:47:37 +0000</created>
                <updated>Mon, 27 Apr 2020 13:27:13 +0000</updated>
                            <resolved>Mon, 27 Apr 2020 13:27:13 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Deployment / YARN</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17092679" author="xintongsong" created="Sun, 26 Apr 2020 11:50:06 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17093101" author="till.rohrmann" created="Mon, 27 Apr 2020 07:24:46 +0000"  >&lt;p&gt;Sounds like a good fix to me. I&apos;ve assigned you to this ticket &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xintongsong&quot; class=&quot;user-hover&quot; rel=&quot;xintongsong&quot;&gt;xintongsong&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17093104" author="till.rohrmann" created="Mon, 27 Apr 2020 07:25:16 +0000"  >&lt;p&gt;Thanks for creating the PR so quickly.&lt;/p&gt;</comment>
                            <comment id="17093524" author="till.rohrmann" created="Mon, 27 Apr 2020 13:27:13 +0000"  >&lt;p&gt;Fixed via 537a56441a49b67ed2d8f271e079ef6b5094f506&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13289765">FLINK-16438</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0e334:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>