<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:20:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-35537] Error when setting state.backend.rocksdb.compression.per.level</title>
                <link>https://issues.apache.org/jira/browse/FLINK-35537</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In flink 1.9.0, when I submit a job to a standalone cluster, the TM throws&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.IllegalArgumentException: Could not parse value &lt;span class=&quot;code-quote&quot;&gt;&apos;[NO_COMPRESSION]&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; key &lt;span class=&quot;code-quote&quot;&gt;&apos;state.backend.rocksdb.compression.per.level&apos;&lt;/span&gt;.
	at org.apache.flink.configuration.Configuration.getOptional(Configuration.java:827)
	at org.apache.flink.contrib.streaming.state.RocksDBResourceContainer.internalGetOption(RocksDBResourceContainer.java:312)
	at org.apache.flink.contrib.streaming.state.RocksDBResourceContainer.setColumnFamilyOptionsFromConfigurableOptions(RocksDBResourceContainer.java:361)
	at org.apache.flink.contrib.streaming.state.RocksDBResourceContainer.getColumnOptions(RocksDBResourceContainer.java:181)
	at org.apache.flink.contrib.streaming.state.EmbeddedRocksDBStateBackend.lambda$createKeyedStateBackend$0(EmbeddedRocksDBStateBackend.java:449)
	at org.apache.flink.contrib.streaming.state.RocksDBOperationUtils.createColumnFamilyOptions(RocksDBOperationUtils.java:219)
	at org.apache.flink.contrib.streaming.state.restore.RocksDBHandle.loadDb(RocksDBHandle.java:138)
	at org.apache.flink.contrib.streaming.state.restore.RocksDBHandle.openDB(RocksDBHandle.java:113)
	at org.apache.flink.contrib.streaming.state.restore.RocksDBNoneRestoreOperation.restore(RocksDBNoneRestoreOperation.java:62)
	at org.apache.flink.contrib.streaming.state.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:333)
	... 19 more
Caused by: java.lang.IllegalArgumentException: Could not parse value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.rocksdb.CompressionType. Expected one of: [[NO_COMPRESSION, SNAPPY_COMPRESSION, ZLIB_COMPRESSION, BZLIB2_COMPRESSION, LZ4_COMPRESSION, LZ4HC_COMPRESSION, XPRESS_COMPRESSION, ZSTD_COMPRESSION, DISABLE_COMPRESSION_OPTION]]
	at org.apache.flink.configuration.ConfigurationUtils.lambda$convertToEnum$12(ConfigurationUtils.java:502)
	at java.util.Optional.orElseThrow(Optional.java:290)
	at org.apache.flink.configuration.ConfigurationUtils.convertToEnum(ConfigurationUtils.java:499)
	at org.apache.flink.configuration.ConfigurationUtils.convertValue(ConfigurationUtils.java:392)
	at org.apache.flink.configuration.ConfigurationUtils.lambda$convertToListWithLegacyProperties$4(ConfigurationUtils.java:440)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at org.apache.flink.configuration.ConfigurationUtils.convertToListWithLegacyProperties(ConfigurationUtils.java:441)
	at org.apache.flink.configuration.ConfigurationUtils.convertToList(ConfigurationUtils.java:432)
	at org.apache.flink.configuration.Configuration.lambda$getOptional$3(Configuration.java:819)
	at java.util.Optional.map(Optional.java:215)
	at org.apache.flink.configuration.Configuration.getOptional(Configuration.java:819)
	... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I configured &apos;state.backend.rocksdb.compression.per.level: NO_COMPRESSION&apos; in flink-conf.yaml. I also tried the flink-1.18.1, and it runs well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13581749">FLINK-35537</key>
            <summary>Error when setting state.backend.rocksdb.compression.per.level</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zakelly">Zakelly Lan</assignee>
                                    <reporter username="zakelly">Zakelly Lan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 6 Jun 2024 07:07:08 +0000</created>
                <updated>Fri, 7 Jun 2024 10:00:19 +0000</updated>
                            <resolved>Fri, 7 Jun 2024 09:59:52 +0000</resolved>
                                    <version>1.19.0</version>
                                    <fixVersion>1.20.0</fixVersion>
                    <fixVersion>1.19.2</fixVersion>
                                    <component>Runtime / Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17852663" author="zakelly" created="Thu, 6 Jun 2024 07:11:01 +0000"  >&lt;p&gt;In my guess this is something like the option is parsed twice, since the error message gives the raw value is &apos;&lt;span class=&quot;error&quot;&gt;&amp;#91;NO_COMPRESSION&amp;#93;&lt;/span&gt;&apos; instead of &apos;NO_COMPRESSION&apos;.&lt;/p&gt;</comment>
                            <comment id="17852688" author="zakelly" created="Thu, 6 Jun 2024 08:45:52 +0000"  >&lt;p&gt;I have confirmed that the problem comes from the &lt;tt&gt;EmbeddedRocksDBStateBackend#mergeConfigurableOptions&lt;/tt&gt;, which merges two configuration map into one. It uses &lt;tt&gt;toString&lt;/tt&gt; of each already parsed value and insert the value string into a new raw map. The &lt;tt&gt;toString&lt;/tt&gt; gives the string format of enum list, not the legacy form of the value. The new raw map get parsed later, that&apos;s when the error happens.&lt;/p&gt;</comment>
                            <comment id="17853091" author="zakelly" created="Fri, 7 Jun 2024 10:00:19 +0000"  >&lt;p&gt;master: 20816c906a2eb726d5feb67eb59fe0ea0709c575&lt;/p&gt;

&lt;p&gt;1.19: 72267c47fa98b9110133328a44cbd49cfee827e9&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1pn9c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>