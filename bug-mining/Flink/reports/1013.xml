<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3944] Add optimization rules to reorder Cartesian products and joins</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3944</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently, we do not support the execution of Cartesian products. &lt;br/&gt;
Because we do not optimize the order of joins (due to missing statistics), joins are executed in the order in which they are specified. This works well for the Table API, however it can be problematic in case of SQL queries where the order of tables in the FROM clause should not matter.&lt;/p&gt;

&lt;p&gt;In case of SQL queries, it can happen that the optimized plan contains Cartesian products because joins are not reordered. If we add optimization rules that switch Cartesian products and joins, such situations can be resolved.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12971519">FLINK-3944</key>
            <summary>Add optimization rules to reorder Cartesian products and joins</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="fhueske">Fabian Hueske</assignee>
                                    <reporter username="fhueske">Fabian Hueske</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 May 2016 12:59:01 +0000</created>
                <updated>Tue, 14 Jun 2016 16:27:03 +0000</updated>
                            <resolved>Tue, 14 Jun 2016 16:27:03 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15303992" author="githubbot" created="Fri, 27 May 2016 12:24:28 +0000"  >&lt;p&gt;GitHub user fhueske opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2044&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3944&quot; title=&quot;Add optimization rules to reorder Cartesian products and joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3944&quot;&gt;&lt;del&gt;FLINK-3944&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tableAPI&amp;#93;&lt;/span&gt; Add rewrite rules to reorder Cartesian products and joins.&lt;/p&gt;

&lt;p&gt;    The Table API / SQL interface do not reorder joins due to missing stats and estimates.&lt;/p&gt;

&lt;p&gt;    This can lead to situations where a query with two inner equi joins cannot be executed due to missing support for Cartesian products. For instance the following query would not be executed:&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    SELECT * &lt;br/&gt;
    FROM t1, t2, t3&lt;br/&gt;
    WHERE t1.a = t3.a AND t2.b = t3.b&lt;br/&gt;
    ```&lt;br/&gt;
    because the plan would first compute the Cartesian product of  `t1` and `t2` because both are listed first in the `FROM` clause.&lt;/p&gt;

&lt;p&gt;    This PR adds optimization rules to reorder joins and Cartesian products to resolve such situation.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/fhueske/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fhueske/flink&lt;/a&gt; tableCrossOrder&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2044.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2044.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2044&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 760ffe29bc1e2f4462f453f378c06c7b1f980dee&lt;br/&gt;
Author: Fabian Hueske &amp;lt;fhueske@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-05-27T11:04:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3944&quot; title=&quot;Add optimization rules to reorder Cartesian products and joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3944&quot;&gt;&lt;del&gt;FLINK-3944&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tableAPI&amp;#93;&lt;/span&gt; Add rewrite rules to reorder Cartesian products and joins.&lt;/p&gt;

&lt;p&gt;    These rules are necessary to resolve join orders that initially contain Cartesian products&lt;br/&gt;
    due to the order in which base relations are added in the FROM clause (SQL) or joined (Table API).&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15324036" author="githubbot" created="Fri, 10 Jun 2016 07:47:01 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2044&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I will merge this PR later today.&lt;/p&gt;</comment>
                            <comment id="15324955" author="githubbot" created="Fri, 10 Jun 2016 17:52:33 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2044&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15324959" author="fhueske" created="Fri, 10 Jun 2016 17:54:25 +0000"  >&lt;p&gt;Fixed with 85793a25a78ba5be96fabc2a26569318c6b53853&lt;/p&gt;</comment>
                            <comment id="15327666" author="fhueske" created="Mon, 13 Jun 2016 16:14:13 +0000"  >&lt;p&gt;I tried the fix on another query and found that the search space grew too large due to the added rewrite rules. On a moderately complex query and the optimization did not terminate. Since we do not have reliable estimates, the optimizer cannot effectively prune search space and the enumeration of alternatives takes too much time. &lt;/p&gt;

&lt;p&gt;I propose to revert this commit. Users will have to specify tables in an order that does not include Cartesian products.&lt;/p&gt;</comment>
                            <comment id="15327687" author="fhueske" created="Mon, 13 Jun 2016 16:23:34 +0000"  >&lt;p&gt;I will open a PR to revert the commit.&lt;/p&gt;</comment>
                            <comment id="15327693" author="githubbot" created="Mon, 13 Jun 2016 16:26:31 +0000"  >&lt;p&gt;GitHub user fhueske opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2098&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;revert&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3944&quot; title=&quot;Add optimization rules to reorder Cartesian products and joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3944&quot;&gt;&lt;del&gt;FLINK-3944&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tableAPI&amp;#93;&lt;/span&gt; Reverts &quot;Add rewrite rules to reorder Cartesian products and joins.&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit 85793a25a78ba5be96fabc2a26569318c6b53853.&lt;br/&gt;
    Added rewrite rules blow up search space which cannot be effectively pruned without cardinality estimates.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/fhueske/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fhueske/flink&lt;/a&gt; tableCrossRevert&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2098.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2098.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2098&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit df438a9fe5e9fcd191c371a888056c49aa246992&lt;br/&gt;
Author: Fabian Hueske &amp;lt;fhueske@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-06-13T16:18:42Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;revert&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3944&quot; title=&quot;Add optimization rules to reorder Cartesian products and joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3944&quot;&gt;&lt;del&gt;FLINK-3944&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tableAPI&amp;#93;&lt;/span&gt; Reverts &quot;Add rewrite rules to reorder Cartesian products and joins.&quot;&lt;/p&gt;

&lt;p&gt;    This reverts commit 85793a25a78ba5be96fabc2a26569318c6b53853.&lt;br/&gt;
    Added rewrite rules blow up search space which cannot be effectively pruned without cardinality estimates.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15329467" author="githubbot" created="Tue, 14 Jun 2016 13:09:33 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2098&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging&lt;/p&gt;</comment>
                            <comment id="15329804" author="fhueske" created="Tue, 14 Jun 2016 16:27:03 +0000"  >&lt;p&gt;Reverted previous fix with commit e0b9e8d3fef724a8785d51007174dc1e684e5f28&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2y9xr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>