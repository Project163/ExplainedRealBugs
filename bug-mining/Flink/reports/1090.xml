<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4053] Return value from Connection should be checked against null</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4053</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In RMQSource.java and RMQSink.java, there is code in the following pattern:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      connection = factory.newConnection();
      channel = connection.createChannel();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;According to &lt;a href=&quot;https://www.rabbitmq.com/releases/rabbitmq-java-client/current-javadoc/com/rabbitmq/client/Connection.html#createChannel(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.rabbitmq.com/releases/rabbitmq-java-client/current-javadoc/com/rabbitmq/client/Connection.html#createChannel(&lt;/a&gt;) :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Returns:
a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; channel descriptor, or &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; none is available
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The return value should be checked against null.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12977356">FLINK-4053</key>
            <summary>Return value from Connection should be checked against null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivan.mushketyk">Ivan Mushketyk</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Jun 2016 19:40:31 +0000</created>
                <updated>Fri, 15 Jul 2016 10:44:49 +0000</updated>
                            <resolved>Fri, 15 Jul 2016 10:19:05 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15333323" author="ivan.mushketyk" created="Thu, 16 Jun 2016 08:08:59 +0000"  >&lt;p&gt;I&apos;ll fix this.&lt;/p&gt;</comment>
                            <comment id="15336994" author="githubbot" created="Fri, 17 Jun 2016 21:28:21 +0000"  >&lt;p&gt;GitHub user mushketyk opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4053&quot; title=&quot;Return value from Connection should be checked against null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4053&quot;&gt;&lt;del&gt;FLINK-4053&lt;/del&gt;&lt;/a&gt; Return value from Connection should be checked against null&lt;/p&gt;

&lt;p&gt;    Thanks for contributing to Apache Flink. Before you open your pull request, please take the following check list into consideration.&lt;br/&gt;
    If your changes take all of the items into account, feel free to open your pull request. For more information and/or questions please refer to the &lt;span class=&quot;error&quot;&gt;&amp;#91;How To Contribute guide&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://flink.apache.org/how-to-contribute.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink.apache.org/how-to-contribute.html&lt;/a&gt;).&lt;br/&gt;
    In addition to going through the list, please provide a meaningful description of your changes.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; General&lt;/li&gt;
	&lt;li&gt;The pull request references the related JIRA issue (&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;FLINK-XXX&amp;#93;&lt;/span&gt; Jira title text&quot;)&lt;/li&gt;
	&lt;li&gt;The pull request addresses only one issue&lt;/li&gt;
	&lt;li&gt;Each commit in the PR has a meaningful commit message (including the JIRA id)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Documentation&lt;/li&gt;
	&lt;li&gt;Documentation has been added for new functionality&lt;/li&gt;
	&lt;li&gt;Old documentation affected by the pull request has been updated&lt;/li&gt;
	&lt;li&gt;JavaDoc for public methods has been added&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;x&amp;#93;&lt;/span&gt; Tests &amp;amp; Build&lt;/li&gt;
	&lt;li&gt;Functionality added by the pull request is covered by tests&lt;/li&gt;
	&lt;li&gt;`mvn clean verify` has been executed successfully locally or a Travis build has passed&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mushketyk/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mushketyk/flink&lt;/a&gt; check-null&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2128&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 06ecc0e817743e2b2b6bf6e582a600b0dd070fde&lt;br/&gt;
Author: Ivan Mushketyk &amp;lt;ivan.mushketik@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-06-17T20:45:25Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4053&quot; title=&quot;Return value from Connection should be checked against null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4053&quot;&gt;&lt;del&gt;FLINK-4053&lt;/del&gt;&lt;/a&gt; Add tests for SMQSink&lt;/p&gt;

&lt;p&gt;commit 35a82d8780183146719cc7dac485e7878d016ad4&lt;br/&gt;
Author: Ivan Mushketyk &amp;lt;ivan.mushketik@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-06-17T21:22:31Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4053&quot; title=&quot;Return value from Connection should be checked against null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4053&quot;&gt;&lt;del&gt;FLINK-4053&lt;/del&gt;&lt;/a&gt; Check return value of RabbitMQ against null&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15348349" author="githubbot" created="Fri, 24 Jun 2016 14:32:08 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128#discussion_r68406562&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128#discussion_r68406562&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/common/Utils.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,47 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
    + * contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
    + * this work for additional information regarding copyright ownership.&lt;br/&gt;
    + * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
    + * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
    + * the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *    &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.streaming.connectors.rabbitmq.common;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.rabbitmq.client.Channel;&lt;br/&gt;
    +import com.rabbitmq.client.Connection;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Common utils for RabbitMQ streaming connector.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class Utils {&lt;br/&gt;
    +	private Utils() {}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 *	Create RabbitMQ and check for null reference.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param connection RabbitMQ connection&lt;br/&gt;
    +	 * @return RabbitMQ channel&lt;br/&gt;
    +	 * @throws IOException if failed to open RabbitMQ channel&lt;br/&gt;
    +	 * @throws RuntimeException if connection object returned null channel&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static Channel createChannel(Connection connection) throws IOException {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    a separate class and static method is a bit overkill for a null check.&lt;/p&gt;</comment>
                            <comment id="15348353" author="githubbot" created="Fri, 24 Jun 2016 14:34:06 +0000"  >&lt;p&gt;Github user mushketyk commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I wanted to avoid this bit of duplication, but I have no strong preferences for that. Will remove this static method.&lt;/p&gt;</comment>
                            <comment id="15348354" author="githubbot" created="Fri, 24 Jun 2016 14:34:19 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128#discussion_r68406896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128#discussion_r68406896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/common/RMQSinkTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,125 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
    + * contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
    + * this work for additional information regarding copyright ownership.&lt;br/&gt;
    + * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
    + * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
    + * the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *    &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.streaming.connectors.rabbitmq.common;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.rabbitmq.client.Channel;&lt;br/&gt;
    +import com.rabbitmq.client.Connection;&lt;br/&gt;
    +import com.rabbitmq.client.ConnectionFactory;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.streaming.connectors.rabbitmq.RMQSink;&lt;br/&gt;
    +import org.apache.flink.streaming.util.serialization.SerializationSchema;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.mockito.Mockito.*;&lt;br/&gt;
    +&lt;br/&gt;
    +public class RMQSinkTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String QUEUE_NAME = &quot;queue&quot;;&lt;br/&gt;
    +	private static final String MESSAGE_STR = &quot;msg&quot;;&lt;br/&gt;
    +	private static final byte[] MESSAGE = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private RMQConnectionConfig rmqConnectionConfig;&lt;br/&gt;
    +	private ConnectionFactory connectionFactory;&lt;br/&gt;
    +	private Connection connection;&lt;br/&gt;
    +	private Channel channel;&lt;br/&gt;
    +	private SerializationSchema&amp;lt;String&amp;gt; serializationSchema;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void before() throws Exception &lt;/p&gt;
{
    +		serializationSchema = spy(new DummySerializationSchema());
    +		rmqConnectionConfig = mock(RMQConnectionConfig.class);
    +		connectionFactory = mock(ConnectionFactory.class);
    +		connection = mock(Connection.class);
    +		channel = mock(Channel.class);
    +
    +		when(rmqConnectionConfig.getConnectionFactory()).thenReturn(connectionFactory);
    +		when(connectionFactory.newConnection()).thenReturn(connection);
    +		when(connection.createChannel()).thenReturn(channel);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void openCallDeclaresQueue() throws Exception &lt;/p&gt;
{
    +		createRMQSink();
    +
    +		verify(channel).queueDeclare(QUEUE_NAME, false, false, false, null);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void throwExceptionIfChannenIsNull() throws Exception {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    type: ChannelIsNull&lt;/p&gt;</comment>
                            <comment id="15348364" author="githubbot" created="Fri, 24 Jun 2016 14:42:35 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128#discussion_r68408173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128#discussion_r68408173&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/common/RMQSinkTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,125 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
    + * contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
    + * this work for additional information regarding copyright ownership.&lt;br/&gt;
    + * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
    + * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
    + * the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *    &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.streaming.connectors.rabbitmq.common;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.rabbitmq.client.Channel;&lt;br/&gt;
    +import com.rabbitmq.client.Connection;&lt;br/&gt;
    +import com.rabbitmq.client.ConnectionFactory;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.streaming.connectors.rabbitmq.RMQSink;&lt;br/&gt;
    +import org.apache.flink.streaming.util.serialization.SerializationSchema;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.mockito.Mockito.*;&lt;br/&gt;
    +&lt;br/&gt;
    +public class RMQSinkTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String QUEUE_NAME = &quot;queue&quot;;&lt;br/&gt;
    +	private static final String MESSAGE_STR = &quot;msg&quot;;&lt;br/&gt;
    +	private static final byte[] MESSAGE = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private RMQConnectionConfig rmqConnectionConfig;&lt;br/&gt;
    +	private ConnectionFactory connectionFactory;&lt;br/&gt;
    +	private Connection connection;&lt;br/&gt;
    +	private Channel channel;&lt;br/&gt;
    +	private SerializationSchema&amp;lt;String&amp;gt; serializationSchema;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void before() throws Exception &lt;/p&gt;
{
    +		serializationSchema = spy(new DummySerializationSchema());
    +		rmqConnectionConfig = mock(RMQConnectionConfig.class);
    +		connectionFactory = mock(ConnectionFactory.class);
    +		connection = mock(Connection.class);
    +		channel = mock(Channel.class);
    +
    +		when(rmqConnectionConfig.getConnectionFactory()).thenReturn(connectionFactory);
    +		when(connectionFactory.newConnection()).thenReturn(connection);
    +		when(connection.createChannel()).thenReturn(channel);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void openCallDeclaresQueue() throws Exception &lt;/p&gt;
{
    +		createRMQSink();
    +
    +		verify(channel).queueDeclare(QUEUE_NAME, false, false, false, null);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void throwExceptionIfChannenIsNull() throws Exception {&lt;br/&gt;
    +		when(connection.createChannel()).thenReturn(null);&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			createRMQSink();
    +		}
&lt;p&gt; catch (RuntimeException ex) &lt;/p&gt;
{
    +			assertEquals(&quot;RabbitMQ connection returned null channel&quot;, ex.getMessage());
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	private RMQSink&amp;lt;String&amp;gt; createRMQSink() throws Exception &lt;/p&gt;
{
    +		RMQSink rmqSink = new RMQSink&amp;lt;String&amp;gt;(rmqConnectionConfig, QUEUE_NAME, serializationSchema);
    +		rmqSink.open(new Configuration());
    +		return rmqSink;
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void invokePublishBytesToQueue() throws Exception &lt;/p&gt;
{
    +		RMQSink&amp;lt;String&amp;gt; rmqSink = createRMQSink();
    +
    +		rmqSink.invoke(MESSAGE_STR);
    +		verify(serializationSchema).serialize(MESSAGE_STR);
    +		verify(channel).basicPublish(&quot;&quot;, QUEUE_NAME, null, MESSAGE);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test(expected = RuntimeException.class)&lt;br/&gt;
    +	public void exceptionDuringPublishingIfNotIgnoredError() throws Exception {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    should this be called &quot;exceptionDuringPublishingIsNotIgnored&quot;?&lt;/p&gt;</comment>
                            <comment id="15348740" author="githubbot" created="Fri, 24 Jun 2016 21:54:22 +0000"  >&lt;p&gt;Github user mushketyk commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol I&apos;ve fixed my PR according to your comments.&lt;/p&gt;</comment>
                            <comment id="15351056" author="githubbot" created="Mon, 27 Jun 2016 14:01:12 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128#discussion_r68580911&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128#discussion_r68580911&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSink.java &amp;#8212;&lt;br/&gt;
    @@ -76,6 +76,9 @@ public void open(Configuration config) throws Exception {&lt;br/&gt;
     		try {&lt;br/&gt;
     			connection = factory.newConnection();&lt;br/&gt;
     			channel = connection.createChannel();&lt;br/&gt;
    +			if (channel == null) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Do you know under which circumstances this can occur and/or what a user can do to resolve it?&lt;/p&gt;</comment>
                            <comment id="15351104" author="githubbot" created="Mon, 27 Jun 2016 14:19:44 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I tihnk this looks good.&lt;/p&gt;

&lt;p&gt;    One remark for future contributions though: I think some of your tests are too specific. &lt;br/&gt;
    These include `openCallDeclaresQueue`,  `throwExceptionIfChannelIsNull` and `invokePublishBytesToQueue`.&lt;/p&gt;

&lt;p&gt;    Effectively you are not testing functionality but putting a lock on every single line of the implementation. &lt;/p&gt;

&lt;p&gt;    We will now get a test failure (which &lt;em&gt;should&lt;/em&gt; mean that the functionality is broken) if we change the exception message (or even handle it completely), use a different `basicPublish` method (or pass different arguments) or pass different `queueDeclare` arguments.&lt;/p&gt;</comment>
                            <comment id="15351793" author="githubbot" created="Mon, 27 Jun 2016 20:55:31 +0000"  >&lt;p&gt;Github user mushketyk commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128#discussion_r68654363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128#discussion_r68654363&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSink.java &amp;#8212;&lt;br/&gt;
    @@ -76,6 +76,9 @@ public void open(Configuration config) throws Exception {&lt;br/&gt;
     		try {&lt;br/&gt;
     			connection = factory.newConnection();&lt;br/&gt;
     			channel = connection.createChannel();&lt;br/&gt;
    +			if (channel == null) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    As far as I understand in RabbitMQ every real TCP connection has a number of virtual connections implemented on top of it. If we request a channel and it&apos;s not available &quot;createChannel&quot; returns null.&lt;br/&gt;
    I&apos;ve updated the exception message to reflect that.&lt;/p&gt;

&lt;p&gt;    I don&apos;t think this generally will be an issue, since we only request one channel for a connection, but it would be beneficial to throw an exception with an appropriate message instead of a NullPointerException in case if anything goes wrong.&lt;/p&gt;</comment>
                            <comment id="15358651" author="githubbot" created="Fri, 1 Jul 2016 08:27:41 +0000"  >&lt;p&gt;Github user mushketyk commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol Should I update this PR somehow?&lt;/p&gt;</comment>
                            <comment id="15358655" author="githubbot" created="Fri, 1 Jul 2016 08:31:04 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thank your for reminding me, i forgot about this PR a bit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;    The PR is fine imo, +1 to merge.&lt;/p&gt;</comment>
                            <comment id="15369327" author="githubbot" created="Sat, 9 Jul 2016 22:29:18 +0000"  >&lt;p&gt;Github user mushketyk commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi all. If this is fine and useful, could someone please merge this?&lt;/p&gt;</comment>
                            <comment id="15379172" author="githubbot" created="Fri, 15 Jul 2016 10:13:00 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging&lt;/p&gt;</comment>
                            <comment id="15379184" author="zentol" created="Fri, 15 Jul 2016 10:19:06 +0000"  >&lt;p&gt;Fixed in a0c3b879b25b5e935e9540422b50bbc031a20735&lt;/p&gt;</comment>
                            <comment id="15379185" author="githubbot" created="Fri, 15 Jul 2016 10:19:23 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15379216" author="githubbot" created="Fri, 15 Jul 2016 10:44:49 +0000"  >&lt;p&gt;Github user mushketyk commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thank you @zentol !&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z8tr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>