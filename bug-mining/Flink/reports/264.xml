<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:18:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1587] coGroup throws NoSuchElementException on iterator.next()</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1587</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I am receiving the following exception when running a simple job that extracts outdegree from a graph using Gelly. It is currently only failing on the cluster and I am not able to reproduce it locally. Will try that the next days.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;02/20/2015 02:27:02:	CoGroup (CoGroup at inDegrees(Graph.java:675)) (5/64) switched to FAILED
java.util.NoSuchElementException
	at java.util.Collections$EmptyIterator.next(Collections.java:3006)
	at flink.graphs.Graph$CountNeighborsCoGroup.coGroup(Graph.java:665)
	at org.apache.flink.runtime.operators.CoGroupDriver.run(CoGroupDriver.java:130)
	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:493)
	at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:360)
	at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:257)
	at java.lang.Thread.run(Thread.java:745)

02/20/2015 02:27:02:	Job execution switched to status FAILING

...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error occurs in Gellys Graph.java at this line: &lt;a href=&quot;https://github.com/apache/flink/blob/a51c02f6e8be948d71a00c492808115d622379a7/flink-staging/flink-gelly/src/main/java/org/apache/flink/graph/Graph.java#L636&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/a51c02f6e8be948d71a00c492808115d622379a7/flink-staging/flink-gelly/src/main/java/org/apache/flink/graph/Graph.java#L636&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is there any valid case where a coGroup Iterator may be empty? As far as I see there is a bug somewhere.&lt;/p&gt;

&lt;p&gt;I&apos;d like to write a test case for this to reproduce the issue. Where can I put such a test?&lt;/p&gt;</description>
                <environment>&lt;p&gt;flink-0.8.0-SNAPSHOT&lt;/p&gt;</environment>
        <key id="12776352">FLINK-1587</key>
            <summary>coGroup throws NoSuchElementException on iterator.next()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andralungu">Andra Lungu</assignee>
                                    <reporter username="cebe">Carsten Brandt</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Feb 2015 03:48:03 +0000</created>
                <updated>Sun, 15 Mar 2015 16:45:59 +0000</updated>
                            <resolved>Sat, 7 Mar 2015 19:37:21 +0000</resolved>
                                                    <fixVersion>0.9</fixVersion>
                                    <component>Library / Graph Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14328583" author="andralungu" created="Fri, 20 Feb 2015 05:47:59 +0000"  >&lt;p&gt;Hi Carsten, &lt;/p&gt;

&lt;p&gt;Nice catch. &lt;br/&gt;
You can add the test here: &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesITCase.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesITCase.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The coGroup Iterator may be empty because  you may have an ID in the edges that does not exist in the vertex data set.&lt;/p&gt;

&lt;p&gt;The problem is that you cannot reproduce this locally. Maybe the dataset got tampered with on the cluster. Keep us posted on how things evolve. &lt;/p&gt;

&lt;p&gt;Best of luck, &lt;br/&gt;
Andra &lt;/p&gt;
</comment>
                            <comment id="14328808" author="vkalavri" created="Fri, 20 Feb 2015 10:47:22 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;you can easily reproduce if you have an edge set with an invalid edge ID, as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andralungu&quot; class=&quot;user-hover&quot; rel=&quot;andralungu&quot;&gt;andralungu&lt;/a&gt; says.&lt;br/&gt;
This is a case that shouldn&apos;t happen, so I suggest we add a check and throw an exception. This should probably be taken care of in the other 2 degrees methods. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andralungu&quot; class=&quot;user-hover&quot; rel=&quot;andralungu&quot;&gt;andralungu&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cebe&quot; class=&quot;user-hover&quot; rel=&quot;cebe&quot;&gt;cebe&lt;/a&gt; any of you would like to take care of this? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;-V.&lt;/p&gt;</comment>
                            <comment id="14329218" author="andralungu" created="Fri, 20 Feb 2015 17:28:36 +0000"  >&lt;p&gt;If there are no time constraints, I will take it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="14337483" author="githubbot" created="Wed, 25 Feb 2015 23:40:48 +0000"  >&lt;p&gt;GitHub user andralungu opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1587&quot; title=&quot;coGroup throws NoSuchElementException on iterator.next()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1587&quot;&gt;&lt;del&gt;FLINK-1587&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Added additional check for edge src/trg id validity&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/andralungu/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/andralungu/flink&lt;/a&gt; exceptionBugFix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #440&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c36cf215ce68ae772a25333af99907730f4847d7&lt;br/&gt;
Author: andralungu &amp;lt;lungu.andra@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-02-25T23:39:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1587&quot; title=&quot;coGroup throws NoSuchElementException on iterator.next()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1587&quot;&gt;&lt;del&gt;FLINK-1587&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Added additional check for edge src/trg id validity&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14339413" author="githubbot" created="Thu, 26 Feb 2015 23:38:08 +0000"  >&lt;p&gt;Github user rmetzger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#discussion_r25476732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#discussion_r25476732&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesWithExceptionITCase.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,123 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.NoSuchElementException;&lt;br/&gt;
    +&lt;br/&gt;
    +public class DegreesWithExceptionITCase {&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testOutDegreesInvalidEdgeSrcId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test outDegrees() with an edge having a srcId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidSrcData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			graph.outDegrees().print();
    +			env.execute();
    +		}
&lt;p&gt; catch (Exception e) {&lt;br/&gt;
    +			assert e.getCause().getMessage().equals(&quot;The edge src/trg id could not be found within the vertexIds&quot;);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I don&apos;t think we are using Java assertions in test cases.&lt;br/&gt;
    We usually use junit assertions, such as `Assert.assertTrue()` in testcases.&lt;/p&gt;

&lt;p&gt;    I&apos;m not even sure if assertions are always enabled when running tests through maven.&lt;/p&gt;</comment>
                            <comment id="14340151" author="githubbot" created="Fri, 27 Feb 2015 14:13:01 +0000"  >&lt;p&gt;Github user vasia commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-76399944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-76399944&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the revision @andralungu! Looks good to merge.&lt;/p&gt;</comment>
                            <comment id="14344831" author="githubbot" created="Tue, 3 Mar 2015 09:36:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-76914047&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-76914047&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The failure in TaskManagerFailsITCase should be unrelated to your PR. This&lt;br/&gt;
    should be fixed once the proper shading is in place. So don&apos;t worry and go&lt;br/&gt;
    ahead merging it.&lt;/p&gt;

&lt;p&gt;    On Mon, Mar 2, 2015 at 8:55 PM, Vasia Kalavri &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
    wrote:&lt;/p&gt;

&lt;p&gt;    &amp;gt; There is a failure in TaskManagerFailsITCase for Hadoop 2.0.0-alpha on&lt;br/&gt;
    &amp;gt; travis.&lt;br/&gt;
    &amp;gt; Is this fixed or something I can ignore and go ahead and merge this one?&lt;br/&gt;
    &amp;gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &#8212;&lt;br/&gt;
    &amp;gt; Reply to this email directly or view it on GitHub&lt;br/&gt;
    &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-76799370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-76799370&lt;/a&gt;&amp;gt;.&lt;br/&gt;
    &amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14345455" author="githubbot" created="Tue, 3 Mar 2015 18:32:13 +0000"  >&lt;p&gt;Github user vasia commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77004964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77004964&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    perfect, thanks!&lt;/p&gt;</comment>
                            <comment id="14346050" author="githubbot" created="Wed, 4 Mar 2015 00:06:58 +0000"  >&lt;p&gt;Github user vasia commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77068115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77068115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi,&lt;br/&gt;
    I was about to merge this one, but I have two doubts:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the tests print all execution output, including the exceptions, in standard output. Is this OK or should we avoid it?&lt;/li&gt;
	&lt;li&gt;apart from the expected exception, the last 3 tests also produce the following:&lt;br/&gt;
    ``` &lt;br/&gt;
    java.lang.Exception: The data preparation for task &apos;Reduce(SUM(1), at getDegrees(Graph.java:664) (981992a0fbf442e4039eba434b173362)&apos; , caused an error: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Bug in input gate/channel logic: input gate gotnotified by channel about available data, but none was available.&lt;br/&gt;
    	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:471)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.RegularPactTask.invoke(RegularPactTask.java:362)&lt;br/&gt;
    	at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:205)&lt;br/&gt;
    	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
    Caused by: java.lang.RuntimeException: Error obtaining the sorted input: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Bug in input gate/channel logic: input gate gotnotified by channel about available data, but none was available.&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger.getIterator(UnilateralSortMerger.java:607)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.RegularPactTask.getInput(RegularPactTask.java:1131)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.GroupReduceDriver.prepare(GroupReduceDriver.java:94)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.RegularPactTask.run(RegularPactTask.java:466)&lt;br/&gt;
    	... 3 more&lt;br/&gt;
    Caused by: java.io.IOException: Thread &apos;SortMerger Reading Thread&apos; terminated due to an exception: Bug in input gate/channel logic: input gate gotnotified by channel about available data, but none was available.&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:784)&lt;br/&gt;
    Caused by: java.lang.IllegalStateException: Bug in input gate/channel logic: input gate gotnotified by channel about available data, but none was available.&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.getNextBufferOrEvent(SingleInputGate.java:314)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.UnionInputGate.getNextBufferOrEvent(UnionInputGate.java:141)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:75)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:34)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ReadingThread.go(UnilateralSortMerger.java:958)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:781)&lt;br/&gt;
    ```&lt;br/&gt;
    I&apos;m not sure where this is coming from and whether it&apos;s a problem in this case. Any ideas?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Thanks ^^&lt;/p&gt;</comment>
                            <comment id="14346654" author="githubbot" created="Wed, 4 Mar 2015 09:45:03 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77125258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77125258&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hey Vasia,&lt;/p&gt;

&lt;p&gt;    1. I think the tests shouldn&apos;t print to stdout, but use the logger for test output.&lt;br/&gt;
    2. The exceptions were wrong-fully logged for cancelled/failed task. I&apos;ve fixed it yesterday in 9255594fb3b9b7c00d9088c3b630af9ecbdf22f4. Have you already rebased on the recent master?&lt;/p&gt;

&lt;p&gt;    &#8211; Ufuk&lt;/p&gt;</comment>
                            <comment id="14346905" author="githubbot" created="Wed, 4 Mar 2015 14:11:47 +0000"  >&lt;p&gt;Github user vasia commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77163740&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77163740&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks Ufuk!&lt;br/&gt;
    @andralungu, could you please change the test to use the logger?&lt;br/&gt;
    @uce, regarding the exceptions output, I see this after having rebased on the latest master (double checked the commit you&apos;re referring to is in there..)&lt;/p&gt;</comment>
                            <comment id="14346918" author="githubbot" created="Wed, 4 Mar 2015 14:22:01 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77165497&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77165497&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks, Vasia! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It still seems to be a problem. I&apos;ve re-opened the &lt;span class=&quot;error&quot;&gt;&amp;#91;corresponding issue&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1577&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-1577&lt;/a&gt;) and will fix it. In any case, nothing should be wrong with the code here (it is a task cancellation race).&lt;/p&gt;</comment>
                            <comment id="14347396" author="githubbot" created="Wed, 4 Mar 2015 19:12:36 +0000"  >&lt;p&gt;Github user andralungu commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77224411&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77224411&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @uce!&lt;/p&gt;

&lt;p&gt;    I am using a data set&apos;s print() method in that particular test suite. I tried several mixes and matches with the logger but none were successful. &lt;/p&gt;

&lt;p&gt;    If, for example you do a log.info, that requires a string. How can you add the DataSet there? I tried adding it with .toString() in the end, but the problem is that, then, env.execute(), which expects a print or write in order to consume the data will no longer work.&lt;/p&gt;

&lt;p&gt;    Could you give me more details?&lt;br/&gt;
    Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    Andra  &lt;/p&gt;

</comment>
                            <comment id="14348373" author="githubbot" created="Thu, 5 Mar 2015 08:23:51 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77324311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77324311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi Andra, if you are using ```print()``` only because you need a sink in your job, then I think you could also use ```dataset.output(new DiscardingOutputFormat())```. This will simply discard all output.&lt;/p&gt;</comment>
                            <comment id="14348375" author="githubbot" created="Thu, 5 Mar 2015 08:25:50 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#discussion_r25846311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#discussion_r25846311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesWithExceptionITCase.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,124 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.NoSuchElementException;&lt;br/&gt;
    +&lt;br/&gt;
    +public class DegreesWithExceptionITCase {&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testOutDegreesInvalidEdgeSrcId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test outDegrees() with an edge having a srcId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidSrcData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			graph.outDegrees().print();&lt;br/&gt;
    +			env.execute();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    If you expect always an exception here, then we should add a ```fail``` after the call. Otherwise the test would also pass if no exception was thrown.&lt;/p&gt;</comment>
                            <comment id="14348376" author="githubbot" created="Thu, 5 Mar 2015 08:26:01 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#discussion_r25846323&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#discussion_r25846323&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesWithExceptionITCase.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,124 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.NoSuchElementException;&lt;br/&gt;
    +&lt;br/&gt;
    +public class DegreesWithExceptionITCase {&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testOutDegreesInvalidEdgeSrcId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test outDegrees() with an edge having a srcId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidSrcData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			graph.outDegrees().print();
    +			env.execute();
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			Assert.assertEquals(&quot;The edge src/trg id could not be found within the vertexIds&quot;, e.getCause().getMessage());
    +			Assert.assertTrue(e.getCause() instanceof NoSuchElementException);
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testInDegreesInvalidEdgeTrgId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test inDegrees() with an edge having a trgId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidTrgData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			graph.inDegrees().print();&lt;br/&gt;
    +			env.execute();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    same here&lt;/p&gt;</comment>
                            <comment id="14348378" author="githubbot" created="Thu, 5 Mar 2015 08:26:15 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#discussion_r25846333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#discussion_r25846333&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-gelly/src/test/java/org/apache/flink/graph/test/DegreesWithExceptionITCase.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,124 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.graph.test;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.graph.Graph;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.NoSuchElementException;&lt;br/&gt;
    +&lt;br/&gt;
    +public class DegreesWithExceptionITCase {&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testOutDegreesInvalidEdgeSrcId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test outDegrees() with an edge having a srcId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidSrcData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			graph.outDegrees().print();
    +			env.execute();
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			Assert.assertEquals(&quot;The edge src/trg id could not be found within the vertexIds&quot;, e.getCause().getMessage());
    +			Assert.assertTrue(e.getCause() instanceof NoSuchElementException);
    +		}&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testInDegreesInvalidEdgeTrgId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test inDegrees() with an edge having a trgId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidTrgData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {
    +			graph.inDegrees().print();
    +			env.execute();
    +		} catch (Exception e) {    +			Assert.assertEquals(&quot;The edge src/trg id could not be found within the vertexIds&quot;, e.getCause().getMessage());    +			Assert.assertTrue(e.getCause() instanceof NoSuchElementException);    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testGetDegreesInvalidEdgeTrgId() throws Exception {&lt;br/&gt;
    +		/*&lt;br/&gt;
    +		* Test getDegrees() with an edge having a trgId that does not exist in the vertex DataSet&lt;br/&gt;
    +		*/&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +&lt;br/&gt;
    +		Graph&amp;lt;Long, Long, Long&amp;gt; graph = Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),&lt;br/&gt;
    +				TestGraphUtils.getLongLongEdgeInvalidTrgData(env), env);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			graph.getDegrees().print();&lt;br/&gt;
    +			env.execute();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I guess it&apos;s the same for all test cases.&lt;/p&gt;</comment>
                            <comment id="14351550" author="githubbot" created="Sat, 7 Mar 2015 12:40:22 +0000"  >&lt;p&gt;Github user vasia commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440#issuecomment-77687765&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440#issuecomment-77687765&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the updates @andralungu. I&apos;ll merge this today &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14351758" author="githubbot" created="Sat, 7 Mar 2015 19:35:02 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/440&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/440&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 37 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25ubb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>