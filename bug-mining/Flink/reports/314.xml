<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:18:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1656] Filtered Semantic Properties for Operators with Iterators</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1656</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The documentation of ForwardedFields is incomplete for operators with iterator inputs (GroupReduce, CoGroup). &lt;br/&gt;
This should be fixed ASAP, because it can lead to incorrect program execution.&lt;/p&gt;

&lt;p&gt;The conditions for forwarded fields on operators with iterator input are:&lt;/p&gt;

&lt;p&gt;1) forwarded fields must be emitted in the order in which they are received through the iterator&lt;br/&gt;
2) all forwarded fields of a record must stick together, i.e., if your function builds record from field 0 of the 1st, 3rd, 5th, ... and field 1 of the 2nd, 4th, ... record coming through the iterator, these are not valid forwarded fields.&lt;br/&gt;
3) it is OK to completely filter out records coming through the iterator.&lt;/p&gt;

&lt;p&gt;The reason for these conditions is that the optimizer uses forwarded fields to reason about physical data properties such as order and grouping. Mixing up the order of records or emitting records which are composed from different input records, might destroy a (secondary) order or grouping.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12780034">FLINK-1656</key>
            <summary>Filtered Semantic Properties for Operators with Iterators</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fhueske">Fabian Hueske</assignee>
                                    <reporter username="fhueske">Fabian Hueske</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Mar 2015 10:29:31 +0000</created>
                <updated>Wed, 2 Oct 2019 17:45:45 +0000</updated>
                            <resolved>Fri, 3 Apr 2015 19:35:41 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14350262" author="fhueske" created="Fri, 6 Mar 2015 11:56:41 +0000"  >&lt;p&gt;Comment by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt; copied from dev mailing list:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I think the order of emitting elements is not part of the forward field&lt;br/&gt;
properties, but would rather be a separate one that we do not have right&lt;br/&gt;
now.&lt;/p&gt;

&lt;p&gt;At the moment, we would assume that all group operations destroy secondary&lt;br/&gt;
orders.&lt;/p&gt;

&lt;p&gt;In that sense, forward fields in group operations only make sense for&lt;br/&gt;
fields where all fields are the same in the group (key fields).&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14350263" author="fhueske" created="Fri, 6 Mar 2015 11:58:41 +0000"  >&lt;p&gt;Right, that&apos;s a good point.&lt;br/&gt;
+1 limiting to key fields. That&apos;s much easier to reason about for users.&lt;/p&gt;

&lt;p&gt;However, I am not sure how it is implemented right now. &lt;br/&gt;
I guess secondary sort info is already removed by the property filtering, but I need to verify that.&lt;/p&gt;</comment>
                            <comment id="14375665" author="fhueske" created="Mon, 23 Mar 2015 10:15:14 +0000"  >&lt;p&gt;I am going to address this issue on two levels:&lt;/p&gt;

&lt;p&gt;1. The optimizer will filter out all forward field information on non-key fields for operators with iterators.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;non-key fields of GroupReduce&lt;/li&gt;
	&lt;li&gt;non-key fields of CoGroup&lt;/li&gt;
	&lt;li&gt;all fields of MapPartition&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2. The APIs will log a warning if a user adds forward field information for non-key fields of GroupReduce and CoGroup and throw an exception if a user adds forward field information for MapPartition and Filter.&lt;/p&gt;</comment>
                            <comment id="14376777" author="githubbot" created="Mon, 23 Mar 2015 22:25:55 +0000"  >&lt;p&gt;GitHub user fhueske opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1656&quot; title=&quot;Filtered Semantic Properties for Operators with Iterators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1656&quot;&gt;&lt;del&gt;FLINK-1656&lt;/del&gt;&lt;/a&gt; Filter ForwardedField properties for group-at-a-time operators in Optimizer&lt;/p&gt;

&lt;p&gt;    Restricts forward field information for group-wise operators.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For `GroupReduce`, `GroupCombine`, and `CoGroup` operators forward field information is restricted to grouping key fields.&lt;/li&gt;
	&lt;li&gt;For `MapPartition` operators all forwarded field information is discarded.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Extended documentation accordingly.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/fhueske/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fhueske/flink&lt;/a&gt; groupKeySemProps&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #525&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a49967db7ecea782860d7a0fa430cb2281653b03&lt;br/&gt;
Author: Fabian Hueske &amp;lt;fhueske@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-03-23T10:55:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1656&quot; title=&quot;Filtered Semantic Properties for Operators with Iterators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1656&quot;&gt;&lt;del&gt;FLINK-1656&lt;/del&gt;&lt;/a&gt; Filter ForwardedField properties for group-at-a-time operators in Optimizer.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14377574" author="githubbot" created="Tue, 24 Mar 2015 09:33:55 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-85422608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-85422608&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think this is good to fix this.&lt;/p&gt;

&lt;p&gt;    I was wondering now whether we can actually solve this a bit more global/local property specific. Cancelling out the properties from the non-key fields was originally motivated by the fact that the group operation destroys orders/groupings, which are actually local properties.&lt;/p&gt;

&lt;p&gt;    Is there a way we can preserve the global properties still? &lt;/p&gt;

&lt;p&gt;    What would happen if we move the new code that &quot;cleans&quot; the semantic properties from the API operators to the optimizer&apos;s operator descriptor. There we can filter the local properties and global properties independently.&lt;/p&gt;

&lt;p&gt;    The main benefit is probably to preserve the global properties for `mapPartition()`, which is desirable.&lt;/p&gt;
</comment>
                            <comment id="14377846" author="githubbot" created="Tue, 24 Mar 2015 13:37:05 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-85499509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-85499509&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yes, I agree. The fix is more conservative than necessary.&lt;br/&gt;
    I think we can safely relax it if we make the rule for forwarded fields on group-wise operators as follows:&lt;/p&gt;

&lt;p&gt;    &lt;b&gt;&quot;All forwarded fields of an emitted record must be forwarded from the same input record. Each output record can have forwarded values from a different input record.&quot;&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;    This allows to preserve partitionings (also on composite keys) but voids all grouping / sorting on non-key fields because the order of the emitted records is not specified.&lt;/p&gt;</comment>
                            <comment id="14377959" author="githubbot" created="Tue, 24 Mar 2015 14:36:01 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-85528267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-85528267&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Good catch, that is a critical distinction (one output record forwarded from same input record). Mostl relevant to MapPartition, though.&lt;/p&gt;</comment>
                            <comment id="14377965" author="githubbot" created="Tue, 24 Mar 2015 14:39:00 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-85531186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-85531186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Do you think this rule is &quot;easy enough&quot; for users? &lt;br/&gt;
    It would make the handling consistent for all group-wise operators.&lt;/p&gt;</comment>
                            <comment id="14381564" author="githubbot" created="Thu, 26 Mar 2015 08:34:07 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-86400852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-86400852&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I updated the PR as discussed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;GlobalProperties are filtered with the user-specified semantic properties.&lt;/li&gt;
	&lt;li&gt;LocalProperties for are filtered with forward field info for key fields only (sorting/grouping can only be preserved for key fields and is completely destroyed for key-less operators such as AllReduce or MapPartition).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Documentation is adapted accordingly.&lt;/p&gt;</comment>
                            <comment id="14393167" author="githubbot" created="Thu, 2 Apr 2015 18:59:45 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525#issuecomment-89009870&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525#issuecomment-89009870&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Will merge this in about 24h unless somebody raises a flag.&lt;/p&gt;</comment>
                            <comment id="14394967" author="githubbot" created="Fri, 3 Apr 2015 19:33:28 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/525&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14394974" author="fhueske" created="Fri, 3 Apr 2015 19:35:41 +0000"  >&lt;p&gt;Fixed with dda8565e6b4f519ac77d66d710a5dc64f1c5740b&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26fyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>