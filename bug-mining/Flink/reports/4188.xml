<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:46:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17466] toRetractStream doesn&apos;t work correctly with Pojo conversion class</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17466</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The toRetractStream(table, Pojo.class) does not map the query columns properly to the pojo fields.&lt;/p&gt;

&lt;p&gt;This either leads to exceptions due to type incompatibility or simply incorrect results.&lt;/p&gt;

&lt;p&gt;It can be simple reproduced by the following test code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testRetract() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
 EnvironmentSettings settings = EnvironmentSettings
 .newInstance()
 .useBlinkPlanner()
 .inStreamingMode()
 .build();

 StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
 StreamTableEnvironment tableEnv = StreamTableEnvironment
 .create(StreamExecutionEnvironment.getExecutionEnvironment(), settings);

 tableEnv.createTemporaryView(&lt;span class=&quot;code-quote&quot;&gt;&quot;person&quot;&lt;/span&gt;, env.fromElements(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Person()));
 tableEnv.toRetractStream(tableEnv.sqlQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;select name, age from person&quot;&lt;/span&gt;), Person.class).print();
 tableEnv.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;Test&quot;&lt;/span&gt;);

}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Person {
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = &lt;span class=&quot;code-quote&quot;&gt;&quot;bob&quot;&lt;/span&gt;;
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; age = 1;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Runtime Error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.ClassCastException: org.apache.flink.table.dataformat.BinaryString cannot be cast to java.lang.Integer&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Changing the query to &quot;select age,name from person&quot; in this case would resolve the problem but it also highlights the possible underlying issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13301828">FLINK-17466</key>
            <summary>toRetractStream doesn&apos;t work correctly with Pojo conversion class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jark">Jark Wu</assignee>
                                    <reporter username="gyfora">Gyula Fora</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 29 Apr 2020 15:30:44 +0000</created>
                <updated>Thu, 4 Jun 2020 07:30:58 +0000</updated>
                            <resolved>Thu, 4 Jun 2020 07:30:58 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.10.2</fixVersion>
                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17095552" author="gyfora" created="Wed, 29 Apr 2020 15:32:20 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&#160;, I could not find this issue on Jira before but it could be a duplicate of something else&lt;/p&gt;</comment>
                            <comment id="17095562" author="jark" created="Wed, 29 Apr 2020 15:45:11 +0000"  >&lt;p&gt;A duplicate issue of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-16108&quot; title=&quot;StreamSQLExample is failed if running in blink planner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-16108&quot;&gt;&lt;del&gt;FLINK-16108&lt;/del&gt;&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17095579" author="gyfora" created="Wed, 29 Apr 2020 16:00:31 +0000"  >&lt;p&gt;I think I am running on a branch that already has this fix in, so might be a different bug.&lt;/p&gt;</comment>
                            <comment id="17095580" author="gyfora" created="Wed, 29 Apr 2020 16:00:56 +0000"  >&lt;p&gt;But I need to double check and verify this on the release-1.10 branch&lt;/p&gt;</comment>
                            <comment id="17095581" author="gyfora" created="Wed, 29 Apr 2020 16:02:14 +0000"  >&lt;p&gt;Also we do not get a planner error as in the linked issue, this is a purely runtime problem that only happens on the retract stream (not the append)&lt;/p&gt;</comment>
                            <comment id="17096478" author="gyfora" created="Thu, 30 Apr 2020 12:28:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160;I have confirmed that this is not a duplicate issue and it is still broken on the latest release-1.10 branch. You can verify yourself by applying this patch for the test case:&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13001716/13001716_retract-issue.patch&quot; title=&quot;retract-issue.patch attached to FLINK-17466&quot;&gt;retract-issue.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17097389" author="jark" created="Fri, 1 May 2020 14:05:23 +0000"  >&lt;p&gt;Yes. I checked in master and this is still another bug. Sad...&lt;/p&gt;</comment>
                            <comment id="17125527" author="jark" created="Thu, 4 Jun 2020 04:08:27 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master (1.12.0): fabe02177cad5eb99193d2d0cc76ab15be7b3b41&lt;/li&gt;
	&lt;li&gt;1.11.0: 9d7dc33f7c05e6b44293e5bae9dff2fac9f647cf&lt;/li&gt;
	&lt;li&gt;1.10.2: a412840bc077d471813c84d0387a664fd95dae27&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="13001716" name="retract-issue.patch" size="953" author="gyfora" created="Thu, 30 Apr 2020 12:28:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0e7q8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>