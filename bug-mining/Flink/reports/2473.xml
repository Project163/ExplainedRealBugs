<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9366] Distribute Cache only works for client-accessible files</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9366</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8620&quot; title=&quot;Enable shipping custom artifacts to BlobStore and accessing them through DistributedCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8620&quot;&gt;&lt;del&gt;FLINK-8620&lt;/del&gt;&lt;/a&gt; the distributed cache was modified to the distribute files via the blob store, instead of downloading them from a distributed filesystem.&lt;/p&gt;

&lt;p&gt;Previously, taskmanagers would download requested files from the DFS. Now, they retrieve it form the blob store. This requires the client to preemptively upload all files used with distributed cache.&lt;/p&gt;

&lt;p&gt;As a result it is no longer possible to use the distributed cache for files that reside in a cluster-internal DFS, as the client cannot download it. This is a regression from the previous behavior and may break existing setups.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dawidwys&quot; class=&quot;user-hover&quot; rel=&quot;dawidwys&quot;&gt;dawidwys&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13159354">FLINK-9366</key>
            <summary>Distribute Cache only works for client-accessible files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dwysakowicz">Dawid Wysakowicz</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 May 2018 09:54:25 +0000</created>
                <updated>Fri, 15 Jun 2018 15:34:56 +0000</updated>
                            <resolved>Fri, 15 Jun 2018 15:34:56 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Command Line Client</component>
                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16496516" author="githubbot" created="Thu, 31 May 2018 13:12:00 +0000"  >&lt;p&gt;GitHub user dawidwys opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9366&quot; title=&quot;Distribute Cache only works for client-accessible files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9366&quot;&gt;&lt;del&gt;FLINK-9366&lt;/del&gt;&lt;/a&gt; DistributedCache works with Distributed File System&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Allows to use DistributeCache to cache files from cluster internal DFS (reverted behaviour).&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    &lt;b&gt;(for example&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/b&gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Local files (based on uri schema) are distributed via BlobServer&lt;/li&gt;
	&lt;li&gt;Files in DFS are cached from DFS&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul&gt;
	&lt;li&gt;Added test for distributing files through DFS: org.apache.flink.hdfstests.DistributedCacheDfsTest&lt;/li&gt;
	&lt;li&gt;local files shipping covered by previous tests&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`:no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dawidwys/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dawidwys/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9366&quot; title=&quot;Distribute Cache only works for client-accessible files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9366&quot;&gt;&lt;del&gt;FLINK-9366&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6107&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit cc1344d18e2b1d9953e21d5189f2813fdabd7b01&lt;br/&gt;
Author: Dawid Wysakowicz &amp;lt;dwysakowicz@...&amp;gt;&lt;br/&gt;
Date:   2018-05-31T12:35:44Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9366&quot; title=&quot;Distribute Cache only works for client-accessible files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9366&quot;&gt;&lt;del&gt;FLINK-9366&lt;/del&gt;&lt;/a&gt; DistributedCache works with Distributed File System&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16496517" author="githubbot" created="Thu, 31 May 2018 13:13:20 +0000"  >&lt;p&gt;Github user dawidwys commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Could you have a look @zentol @aljoscha ?&lt;/p&gt;</comment>
                            <comment id="16497162" author="githubbot" created="Thu, 31 May 2018 20:55:07 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192234433&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192234433&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-fs-tests/src/test/java/org/apache/flink/hdfstests/DistributedCacheDfsTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,166 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.hdfstests;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.RichMapFunction;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileStatus;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.Path;&lt;br/&gt;
    +import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.test.util.MiniClusterResource;&lt;br/&gt;
    +import org.apache.flink.util.NetUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
    +import org.apache.hadoop.hdfs.MiniDFSCluster;&lt;br/&gt;
    +import org.junit.AfterClass;&lt;br/&gt;
    +import org.junit.BeforeClass;&lt;br/&gt;
    +import org.junit.ClassRule;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.rules.TemporaryFolder;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.DataInputStream;&lt;br/&gt;
    +import java.io.DataOutputStream;&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.assertFalse;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests for distributing files with &lt;/p&gt;
{@link org.apache.flink.api.common.cache.DistributedCache}
&lt;p&gt; via HDFS.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class DistributedCacheDfsTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String testFileContent = &quot;Goethe - Faust: Der Tragoedie erster Teil\n&quot; + &quot;Prolog im Himmel.\n&quot;&lt;br/&gt;
    +		+ &quot;Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n&quot; + &quot;Erzengel treten vor.\n&quot;&lt;br/&gt;
    +		+ &quot;RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n&quot;&lt;br/&gt;
    +		+ &quot;Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n&quot;&lt;br/&gt;
    +		+ &quot;gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n&quot;&lt;br/&gt;
    +		+ &quot;hohen Werke Sind herrlich wie am ersten Tag.\n&quot;&lt;br/&gt;
    +		+ &quot;GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n&quot;&lt;br/&gt;
    +		+ &quot;Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n&quot;&lt;br/&gt;
    +		+ &quot;schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n&quot;&lt;br/&gt;
    +		+ &quot;Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n&quot;&lt;br/&gt;
    +		+ &quot;MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n&quot;&lt;br/&gt;
    +		+ &quot;aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n&quot;&lt;br/&gt;
    +		+ &quot;Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n&quot;&lt;br/&gt;
    +		+ &quot;deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static TemporaryFolder tempFolder = new TemporaryFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +	private static MiniClusterResource miniClusterResource;&lt;br/&gt;
    +	private static MiniDFSCluster hdfsCluster;&lt;br/&gt;
    +	private static Configuration conf = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +	private static Path testFile;&lt;br/&gt;
    +	private static Path testDir;&lt;br/&gt;
    +&lt;br/&gt;
    +	@BeforeClass&lt;br/&gt;
    +	public static void setup() throws Exception {&lt;br/&gt;
    +		File dataDir = tempFolder.newFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +		conf.set(MiniDFSCluster.HDFS_MINIDFS_BASEDIR, dataDir.getAbsolutePath());&lt;br/&gt;
    +		MiniDFSCluster.Builder builder = new MiniDFSCluster.Builder(conf);&lt;br/&gt;
    +		hdfsCluster = builder.build();&lt;br/&gt;
    +&lt;br/&gt;
    +		String hdfsURI = &quot;hdfs://&quot;&lt;br/&gt;
    +			+ NetUtils.hostAndPortToUrlString(hdfsCluster.getURI().getHost(), hdfsCluster.getNameNodePort())&lt;br/&gt;
    +			+ &quot;/&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +		miniClusterResource = new MiniClusterResource(&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    is it necessary that the flink cluster is started afte rthe dfs cluster? Otherwise you could use this as a JUnit `Rule`,&lt;/p&gt;</comment>
                            <comment id="16497750" author="githubbot" created="Fri, 1 Jun 2018 08:49:40 +0000"  >&lt;p&gt;Github user dawidwys commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192334113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192334113&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-fs-tests/src/test/java/org/apache/flink/hdfstests/DistributedCacheDfsTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,166 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.hdfstests;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.RichMapFunction;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileStatus;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.Path;&lt;br/&gt;
    +import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.test.util.MiniClusterResource;&lt;br/&gt;
    +import org.apache.flink.util.NetUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
    +import org.apache.hadoop.hdfs.MiniDFSCluster;&lt;br/&gt;
    +import org.junit.AfterClass;&lt;br/&gt;
    +import org.junit.BeforeClass;&lt;br/&gt;
    +import org.junit.ClassRule;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.rules.TemporaryFolder;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.DataInputStream;&lt;br/&gt;
    +import java.io.DataOutputStream;&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.assertFalse;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests for distributing files with &lt;/p&gt;
{@link org.apache.flink.api.common.cache.DistributedCache}
&lt;p&gt; via HDFS.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class DistributedCacheDfsTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String testFileContent = &quot;Goethe - Faust: Der Tragoedie erster Teil\n&quot; + &quot;Prolog im Himmel.\n&quot;&lt;br/&gt;
    +		+ &quot;Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n&quot; + &quot;Erzengel treten vor.\n&quot;&lt;br/&gt;
    +		+ &quot;RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n&quot;&lt;br/&gt;
    +		+ &quot;Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n&quot;&lt;br/&gt;
    +		+ &quot;gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n&quot;&lt;br/&gt;
    +		+ &quot;hohen Werke Sind herrlich wie am ersten Tag.\n&quot;&lt;br/&gt;
    +		+ &quot;GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n&quot;&lt;br/&gt;
    +		+ &quot;Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n&quot;&lt;br/&gt;
    +		+ &quot;schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n&quot;&lt;br/&gt;
    +		+ &quot;Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n&quot;&lt;br/&gt;
    +		+ &quot;MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n&quot;&lt;br/&gt;
    +		+ &quot;aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n&quot;&lt;br/&gt;
    +		+ &quot;Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n&quot;&lt;br/&gt;
    +		+ &quot;deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static TemporaryFolder tempFolder = new TemporaryFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +	private static MiniClusterResource miniClusterResource;&lt;br/&gt;
    +	private static MiniDFSCluster hdfsCluster;&lt;br/&gt;
    +	private static Configuration conf = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +	private static Path testFile;&lt;br/&gt;
    +	private static Path testDir;&lt;br/&gt;
    +&lt;br/&gt;
    +	@BeforeClass&lt;br/&gt;
    +	public static void setup() throws Exception {&lt;br/&gt;
    +		File dataDir = tempFolder.newFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +		conf.set(MiniDFSCluster.HDFS_MINIDFS_BASEDIR, dataDir.getAbsolutePath());&lt;br/&gt;
    +		MiniDFSCluster.Builder builder = new MiniDFSCluster.Builder(conf);&lt;br/&gt;
    +		hdfsCluster = builder.build();&lt;br/&gt;
    +&lt;br/&gt;
    +		String hdfsURI = &quot;hdfs://&quot;&lt;br/&gt;
    +			+ NetUtils.hostAndPortToUrlString(hdfsCluster.getURI().getHost(), hdfsCluster.getNameNodePort())&lt;br/&gt;
    +			+ &quot;/&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +		miniClusterResource = new MiniClusterResource(&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    It is not necessary. Changed it.&lt;/p&gt;</comment>
                            <comment id="16500016" author="githubbot" created="Mon, 4 Jun 2018 10:29:16 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192695014&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192695014&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-fs-tests/src/test/java/org/apache/flink/hdfstests/DistributedCacheDfsTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,160 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.hdfstests;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.RichMapFunction;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileStatus;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.Path;&lt;br/&gt;
    +import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.test.util.MiniClusterResource;&lt;br/&gt;
    +import org.apache.flink.util.NetUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
    +import org.apache.hadoop.hdfs.MiniDFSCluster;&lt;br/&gt;
    +import org.junit.AfterClass;&lt;br/&gt;
    +import org.junit.BeforeClass;&lt;br/&gt;
    +import org.junit.ClassRule;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.rules.TemporaryFolder;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.DataInputStream;&lt;br/&gt;
    +import java.io.DataOutputStream;&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.assertFalse;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests for distributing files with &lt;/p&gt;
{@link org.apache.flink.api.common.cache.DistributedCache}
&lt;p&gt; via HDFS.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class DistributedCacheDfsTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String testFileContent = &quot;Goethe - Faust: Der Tragoedie erster Teil\n&quot; + &quot;Prolog im Himmel.\n&quot;&lt;br/&gt;
    +		+ &quot;Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n&quot; + &quot;Erzengel treten vor.\n&quot;&lt;br/&gt;
    +		+ &quot;RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n&quot;&lt;br/&gt;
    +		+ &quot;Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n&quot;&lt;br/&gt;
    +		+ &quot;gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n&quot;&lt;br/&gt;
    +		+ &quot;hohen Werke Sind herrlich wie am ersten Tag.\n&quot;&lt;br/&gt;
    +		+ &quot;GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n&quot;&lt;br/&gt;
    +		+ &quot;Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n&quot;&lt;br/&gt;
    +		+ &quot;schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n&quot;&lt;br/&gt;
    +		+ &quot;Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n&quot;&lt;br/&gt;
    +		+ &quot;MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n&quot;&lt;br/&gt;
    +		+ &quot;aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n&quot;&lt;br/&gt;
    +		+ &quot;Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n&quot;&lt;br/&gt;
    +		+ &quot;deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static TemporaryFolder tempFolder = new TemporaryFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static MiniClusterResource miniClusterResource  = new MiniClusterResource(&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can be final, double space before `=`.&lt;/p&gt;</comment>
                            <comment id="16500017" author="githubbot" created="Mon, 4 Jun 2018 10:29:16 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192695040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192695040&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-fs-tests/src/test/java/org/apache/flink/hdfstests/DistributedCacheDfsTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,160 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.hdfstests;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.RichMapFunction;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileStatus;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.Path;&lt;br/&gt;
    +import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.test.util.MiniClusterResource;&lt;br/&gt;
    +import org.apache.flink.util.NetUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
    +import org.apache.hadoop.hdfs.MiniDFSCluster;&lt;br/&gt;
    +import org.junit.AfterClass;&lt;br/&gt;
    +import org.junit.BeforeClass;&lt;br/&gt;
    +import org.junit.ClassRule;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.rules.TemporaryFolder;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.DataInputStream;&lt;br/&gt;
    +import java.io.DataOutputStream;&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.assertFalse;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests for distributing files with &lt;/p&gt;
{@link org.apache.flink.api.common.cache.DistributedCache}
&lt;p&gt; via HDFS.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class DistributedCacheDfsTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String testFileContent = &quot;Goethe - Faust: Der Tragoedie erster Teil\n&quot; + &quot;Prolog im Himmel.\n&quot;&lt;br/&gt;
    +		+ &quot;Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n&quot; + &quot;Erzengel treten vor.\n&quot;&lt;br/&gt;
    +		+ &quot;RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n&quot;&lt;br/&gt;
    +		+ &quot;Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n&quot;&lt;br/&gt;
    +		+ &quot;gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n&quot;&lt;br/&gt;
    +		+ &quot;hohen Werke Sind herrlich wie am ersten Tag.\n&quot;&lt;br/&gt;
    +		+ &quot;GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n&quot;&lt;br/&gt;
    +		+ &quot;Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n&quot;&lt;br/&gt;
    +		+ &quot;schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n&quot;&lt;br/&gt;
    +		+ &quot;Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n&quot;&lt;br/&gt;
    +		+ &quot;MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n&quot;&lt;br/&gt;
    +		+ &quot;aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n&quot;&lt;br/&gt;
    +		+ &quot;Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n&quot;&lt;br/&gt;
    +		+ &quot;deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static TemporaryFolder tempFolder = new TemporaryFolder();&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can be final.&lt;/p&gt;</comment>
                            <comment id="16500018" author="githubbot" created="Mon, 4 Jun 2018 10:29:16 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192692204&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192692204&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/filecache/FileCache.java &amp;#8212;&lt;br/&gt;
    @@ -302,6 +308,30 @@ public Path call() throws IOException {&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Asynchronous file copy process.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	private static class CopyFromDFSProcess implements Callable&amp;lt;Path&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +		private final Path filePath;&lt;br/&gt;
    +		private final Path cachedPath;&lt;br/&gt;
    +		private boolean executable;&lt;br/&gt;
    +&lt;br/&gt;
    +		public CopyFromDFSProcess(DistributedCacheEntry e, Path cachedPath) &lt;/p&gt;
{
    +			this.filePath = new Path(e.filePath);
    +			this.executable = e.isExecutable;
    +			this.cachedPath = cachedPath;
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		@Override&lt;br/&gt;
    +		public Path call() throws IOException {&lt;br/&gt;
    +			// let exceptions propagate. we can retrieve them later from&lt;br/&gt;
    +			// the future and report them upon access to the result&lt;br/&gt;
    +			copy(filePath, cachedPath, this.executable);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can you prefix this with `FileUtils`? Imo this makes the code more readable.&lt;/p&gt;</comment>
                            <comment id="16500019" author="githubbot" created="Mon, 4 Jun 2018 10:29:16 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192691637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192691637&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/StreamExecutionEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -690,12 +690,11 @@ class StreamExecutionEnvironment(javaEnv: JavaEnv) &lt;/p&gt;
{
         f
       }

&lt;p&gt;    -&lt;br/&gt;
       /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Registers a file at the distributed cache under the given name. The file will be accessible&lt;/li&gt;
	&lt;li&gt;from any user-defined function in the (distributed) runtime under a local path. Files&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* may be local files (as long as all relevant workers have access to it), or files in a&lt;/li&gt;
	&lt;li&gt;* distributed file system. The runtime will copy the files temporarily to a local cache,&lt;br/&gt;
    +    * may be local files (will be distributed via BlobServer), or files in a distributed file
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    add `which` before `will` for better flow`. Also applies to other instances of this method.&lt;/p&gt;</comment>
                            <comment id="16500022" author="githubbot" created="Mon, 4 Jun 2018 10:29:35 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good functionality wise, had some minor comments.&lt;/p&gt;</comment>
                            <comment id="16500132" author="githubbot" created="Mon, 4 Jun 2018 12:10:20 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192718847&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192718847&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/cache/DistributedCache.java &amp;#8212;&lt;br/&gt;
    @@ -15,8 +15,12 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;See the License for the specific language governing permissions and&lt;/li&gt;
	&lt;li&gt;limitations under the License.&lt;br/&gt;
      */&lt;br/&gt;
    +&lt;br/&gt;
     package org.apache.flink.api.common.cache;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +import org.apache.flink.annotation.Public;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    If you make this file checkstyle-compliant please also remove the exclusion in `tools/maven/suppressions-core.xml`&lt;/p&gt;</comment>
                            <comment id="16500142" author="githubbot" created="Mon, 4 Jun 2018 12:19:37 +0000"  >&lt;p&gt;Github user dawidwys commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r192721111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r192721111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/cache/DistributedCache.java &amp;#8212;&lt;br/&gt;
    @@ -15,8 +15,12 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;See the License for the specific language governing permissions and&lt;/li&gt;
	&lt;li&gt;limitations under the License.&lt;br/&gt;
      */&lt;br/&gt;
    +&lt;br/&gt;
     package org.apache.flink.api.common.cache;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +import org.apache.flink.annotation.Public;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Sure, I wondered why it did not fail the build before...&lt;/p&gt;</comment>
                            <comment id="16503024" author="githubbot" created="Wed, 6 Jun 2018 09:00:25 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r193340830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r193340830&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -844,7 +844,7 @@ public JobExecutionResult execute() throws Exception {&lt;br/&gt;
     	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Registers a file at the distributed cache under the given name. The file will be accessible&lt;/li&gt;
	&lt;li&gt;from any user-defined function in the (distributed) runtime under a local path. Files&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* may be local files (will be distributed via BlobServer), or files in a distributed file system.&lt;br/&gt;
    +	 * may be local files (which will be distributed viaBlobServer), or files in a distributed file system.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    missing space `viaBlobServer`&lt;/p&gt;</comment>
                            <comment id="16503025" author="githubbot" created="Wed, 6 Jun 2018 09:02:32 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r193341492&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r193341492&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -844,7 +844,7 @@ public JobExecutionResult execute() throws Exception {&lt;br/&gt;
     	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Registers a file at the distributed cache under the given name. The file will be accessible&lt;/li&gt;
	&lt;li&gt;from any user-defined function in the (distributed) runtime under a local path. Files&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* may be local files (as long as all relevant workers have access to it), or files in a distributed file system.&lt;br/&gt;
    +	 * may be local files (which will be distributed viaBlobServer), or files in a distributed file system.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    missing space after via (several instances)&lt;/p&gt;</comment>
                            <comment id="16509515" author="githubbot" created="Tue, 12 Jun 2018 11:40:03 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r194705137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r194705137&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/JobGraph.java &amp;#8212;&lt;br/&gt;
    @@ -584,17 +584,25 @@ public void uploadUserArtifacts(InetSocketAddress blobServerAddress, Configurati&lt;br/&gt;
     		if (!userArtifacts.isEmpty()) {&lt;br/&gt;
     			try (BlobClient blobClient = new BlobClient(blobServerAddress, clientConfig)) {&lt;br/&gt;
     				for (Map.Entry&amp;lt;String, DistributedCache.DistributedCacheEntry&amp;gt; userArtifact : userArtifacts.entrySet()) {&lt;br/&gt;
    -&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final PermanentBlobKey key = blobClient.uploadFile(jobID,&lt;/li&gt;
	&lt;li&gt;new Path(userArtifact.getValue().filePath));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;DistributedCache.writeFileInfoToConfig(&lt;/li&gt;
	&lt;li&gt;userArtifact.getKey(),&lt;/li&gt;
	&lt;li&gt;new DistributedCache.DistributedCacheEntry(&lt;/li&gt;
	&lt;li&gt;userArtifact.getValue().filePath,&lt;/li&gt;
	&lt;li&gt;userArtifact.getValue().isExecutable,&lt;/li&gt;
	&lt;li&gt;InstantiationUtil.serializeObject(key)),&lt;/li&gt;
	&lt;li&gt;jobConfiguration);&lt;br/&gt;
    +					Path filePath = new Path(userArtifact.getValue().filePath);&lt;br/&gt;
    +&lt;br/&gt;
    +					if (filePath.getFileSystem().isDistributedFS()) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The file-system class may not be accessible on the client, so you have to guard this with a try-catch block and write it into the config in both cases.&lt;/p&gt;</comment>
                            <comment id="16509516" author="githubbot" created="Tue, 12 Jun 2018 11:40:03 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107#discussion_r194703701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107#discussion_r194703701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-fs-tests/src/test/java/org/apache/flink/hdfstests/DistributedCacheDfsTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,160 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.hdfstests;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.RichMapFunction;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileStatus;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.Path;&lt;br/&gt;
    +import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.test.util.MiniClusterResource;&lt;br/&gt;
    +import org.apache.flink.util.NetUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
    +import org.apache.hadoop.hdfs.MiniDFSCluster;&lt;br/&gt;
    +import org.junit.AfterClass;&lt;br/&gt;
    +import org.junit.BeforeClass;&lt;br/&gt;
    +import org.junit.ClassRule;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.rules.TemporaryFolder;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.DataInputStream;&lt;br/&gt;
    +import java.io.DataOutputStream;&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.assertFalse;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests for distributing files with &lt;/p&gt;
{@link org.apache.flink.api.common.cache.DistributedCache}
&lt;p&gt; via HDFS.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class DistributedCacheDfsTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String testFileContent = &quot;Goethe - Faust: Der Tragoedie erster Teil\n&quot; + &quot;Prolog im Himmel.\n&quot;&lt;br/&gt;
    +		+ &quot;Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n&quot; + &quot;Erzengel treten vor.\n&quot;&lt;br/&gt;
    +		+ &quot;RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n&quot;&lt;br/&gt;
    +		+ &quot;Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n&quot;&lt;br/&gt;
    +		+ &quot;gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n&quot;&lt;br/&gt;
    +		+ &quot;hohen Werke Sind herrlich wie am ersten Tag.\n&quot;&lt;br/&gt;
    +		+ &quot;GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n&quot;&lt;br/&gt;
    +		+ &quot;Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n&quot;&lt;br/&gt;
    +		+ &quot;schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n&quot;&lt;br/&gt;
    +		+ &quot;Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n&quot;&lt;br/&gt;
    +		+ &quot;MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n&quot;&lt;br/&gt;
    +		+ &quot;aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n&quot;&lt;br/&gt;
    +		+ &quot;Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n&quot;&lt;br/&gt;
    +		+ &quot;deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static final TemporaryFolder TEMP_FOLDER = new TemporaryFolder();&lt;br/&gt;
    +&lt;br/&gt;
    +	@ClassRule&lt;br/&gt;
    +	public static final MiniClusterResource MINI_CLUSTER_RESOURCE = new MiniClusterResource(&lt;br/&gt;
    +		new MiniClusterResource.MiniClusterResourceConfiguration(&lt;br/&gt;
    +			new org.apache.flink.configuration.Configuration(),&lt;br/&gt;
    +			1,&lt;br/&gt;
    +			1));&lt;br/&gt;
    +&lt;br/&gt;
    +	private static MiniDFSCluster hdfsCluster;&lt;br/&gt;
    +	private static Configuration conf = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +	private static Path testFile;&lt;br/&gt;
    +	private static Path testDir;&lt;br/&gt;
    +&lt;br/&gt;
    +	@BeforeClass&lt;br/&gt;
    +	public static void setup() throws Exception &lt;/p&gt;
{
    +		File dataDir = TEMP_FOLDER.newFolder();
    +
    +		conf.set(MiniDFSCluster.HDFS_MINIDFS_BASEDIR, dataDir.getAbsolutePath());
    +		MiniDFSCluster.Builder builder = new MiniDFSCluster.Builder(conf);
    +		hdfsCluster = builder.build();
    +
    +		String hdfsURI = &quot;hdfs://&quot;
    +			+ NetUtils.hostAndPortToUrlString(hdfsCluster.getURI().getHost(), hdfsCluster.getNameNodePort())
    +			+ &quot;/&quot;;
    +
    +		FileSystem dfs = FileSystem.get(new URI(hdfsURI));
    +		testFile = writeFile(dfs, dfs.getHomeDirectory(), &quot;testFile&quot;);
    +
    +		testDir = new Path(dfs.getHomeDirectory(), &quot;testDir&quot;);
    +		dfs.mkdirs(testDir);
    +		writeFile(dfs, testDir, &quot;testFile1&quot;);
    +		writeFile(dfs, testDir, &quot;testFile2&quot;);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	private static Path writeFile(FileSystem dfs, Path rootDir, String fileName) throws IOException {&lt;br/&gt;
    +		Path file = new Path(rootDir, fileName);&lt;br/&gt;
    +		try (&lt;br/&gt;
    +			DataOutputStream outStream = new DataOutputStream(dfs.create(file,&lt;br/&gt;
    +				FileSystem.WriteMode.OVERWRITE))) &lt;/p&gt;
{
    +			outStream.writeUTF(testFileContent);
    +		}
&lt;p&gt;    +		return file;&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@AfterClass&lt;br/&gt;
    +	public static void teardown() &lt;/p&gt;
{
    +		hdfsCluster.shutdown();
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testDistributeFileViaDFS() throws Exception &lt;/p&gt;
{
    +
    +		final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
    +		env.setParallelism(1);
    +
    +		env.registerCachedFile(testFile.toString(), &quot;test_data&quot;, false);
    +		env.registerCachedFile(testDir.toString(), &quot;test_dir&quot;, false);
    +
    +		env.fromElements(1)
    +			.map(new TestMapFunction())
    +			.print();
    +
    +		env.execute(&quot;Distributed Cache Via Blob Test Program&quot;);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	static class TestMapFunction extends RichMapFunction&amp;lt;Integer, String&amp;gt; {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    can we make this private?&lt;/p&gt;</comment>
                            <comment id="16513751" author="githubbot" created="Fri, 15 Jun 2018 12:26:49 +0000"  >&lt;p&gt;Github user dawidwys commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging.&lt;/p&gt;</comment>
                            <comment id="16513976" author="githubbot" created="Fri, 15 Jun 2018 15:34:36 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6107&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3tpv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>