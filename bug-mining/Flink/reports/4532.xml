<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:49:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-18959] Fail to archiveExecutionGraph because job is not finished when dispatcher close</title>
                <link>https://issues.apache.org/jira/browse/FLINK-18959</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When job is cancelled, we expect to see it in flink&apos;s history server. But I can not see my job after it is cancelled.&lt;/p&gt;

&lt;p&gt;After digging into the problem, I find that the function archiveExecutionGraph is not executed. Below is the brief log:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;log&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;2020-08-14 15:10:06,406 INFO org.apache.flink.runtime.executiongraph.ExecutionGraph &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher- 15&amp;#93;&lt;/span&gt; - Job EtlAndWindow (6f784d4cc5bae88a332d254b21660372) switched from state RUNNING to CANCELLING.&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,415 DEBUG org.apache.flink.runtime.dispatcher.MiniDispatcher &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-3&amp;#93;&lt;/span&gt; - Shutting down per-job cluster because the job was canceled.&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,629 INFO org.apache.flink.runtime.dispatcher.MiniDispatcher &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-3&amp;#93;&lt;/span&gt; - Stopping dispatcher akka.tcp://flink@bjfk-c9865.yz02:38663/user/dispatcher.&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,629 INFO org.apache.flink.runtime.dispatcher.MiniDispatcher &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-3&amp;#93;&lt;/span&gt; - Stopping all currently running jobs of dispatcher akka.tcp://flink@bjfk-c9865.yz02:38663/user/dispatcher.&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,631 INFO org.apache.flink.runtime.jobmaster.JobMaster &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-29&amp;#93;&lt;/span&gt; - Stopping the JobMaster for job EtlAndWindow(6f784d4cc5bae88a332d254b21660372).&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,632 DEBUG org.apache.flink.runtime.jobmaster.JobMaster &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-29&amp;#93;&lt;/span&gt; - Disconnect TaskExecutor container_e144_1590060720089_2161_01_000006 because: Stopping JobMaster for job EtlAndWindow(6f784d4cc5bae88a332d254b21660372).&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,646 INFO org.apache.flink.runtime.executiongraph.ExecutionGraph &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-29&amp;#93;&lt;/span&gt; - Job EtlAndWindow (6f784d4cc5bae88a332d254b21660372) switched from state CANCELLING to CANCELED.&lt;/p&gt;

&lt;p&gt;2020-08-14 15:10:06,664 DEBUG org.apache.flink.runtime.dispatcher.MiniDispatcher &lt;span class=&quot;error&quot;&gt;&amp;#91;flink-akka.actor.default-dispatcher-4&amp;#93;&lt;/span&gt; - There is a newer JobManagerRunner for the job 6f784d4cc5bae88a332d254b21660372.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From the log, we can see that&#160;job is not finished when dispatcher closes. The process is as following:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Receive cancel command and send it to all tasks async.&lt;/li&gt;
	&lt;li&gt;In&#160;MiniDispatcher, begin to shutting down per-job cluster.&lt;/li&gt;
	&lt;li&gt;Stopping dispatcher and remove job.&lt;/li&gt;
	&lt;li&gt;Job is cancelled and&#160;callback is executed in method&#160;startJobManagerRunner.&lt;/li&gt;
	&lt;li&gt;Because job is removed before, so&#160;currentJobManagerRunner is null which not equals to the original jobManagerRunner. In this case,&#160;archivedExecutionGraph will not be uploaded.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In normal cases, I find that job is cancelled first and then dispatcher is stopped so that archivedExecutionGraph will succeed. But I think that the order is not constrained and it is hard to know which comes first.&#160;&lt;/p&gt;

&lt;p&gt;Above is what I&#160;suspected. If so, then we should fix it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13322706">FLINK-18959</key>
            <summary>Fail to archiveExecutionGraph because job is not finished when dispatcher close</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Jiangang">Liu</assignee>
                                    <reporter username="Jiangang">Liu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 14 Aug 2020 08:40:01 +0000</created>
                <updated>Fri, 4 Sep 2020 07:40:30 +0000</updated>
                            <resolved>Fri, 4 Sep 2020 07:40:30 +0000</resolved>
                                    <version>1.10.0</version>
                    <version>1.11.1</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.10.3</fixVersion>
                    <fixVersion>1.11.2</fixVersion>
                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17177695" author="rmetzger" created="Fri, 14 Aug 2020 10:53:21 +0000"  >&lt;p&gt;How are you submitting and cancelling your Flink job? Can you attach the full log on DEBUG level to this ticket?&lt;/p&gt;</comment>
                            <comment id="17177706" author="jiangang" created="Fri, 14 Aug 2020 11:17:22 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&#160;.The job is per-job and is running on yarn. I am using command &quot;flink cancel&quot; to stop the job. The log is attached.&#160;&lt;/p&gt;</comment>
                            <comment id="17177719" author="till.rohrmann" created="Fri, 14 Aug 2020 11:46:22 +0000"  >&lt;p&gt;Thanks a lot for reporting this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;. I think your analysis is correct. At the moment, the Flink cluster does not wait for the job to complete &lt;tt&gt;Dispatcher.jobReachedGLoballyTerminalState()&lt;/tt&gt; because it completes directly the &lt;tt&gt;shutDownFuture&lt;/tt&gt; in &lt;tt&gt;MiniDispatcher.cancelJob&lt;/tt&gt;. I think this is a regression which has been introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15116&quot; title=&quot;Make JobClient stateless, remove AutoCloseable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15116&quot;&gt;&lt;del&gt;FLINK-15116&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tison&quot; class=&quot;user-hover&quot; rel=&quot;tison&quot;&gt;tison&lt;/a&gt; why was it necessary to directly shut down the cluster? Why is it not possible to wait for the normal shutdown cycle after the job has reached a globally terminal state?&lt;/p&gt;</comment>
                            <comment id="17178414" author="jiangang" created="Sun, 16 Aug 2020 03:48:55 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;. I have the same confusion with you. In previous implementation, job reaches globally terminal state first and then archiveExecutionGraph is done. Finally, the dispatcher is shut down.&lt;/p&gt;</comment>
                            <comment id="17181104" author="zhushang" created="Thu, 20 Aug 2020 11:14:31 +0000"  >&lt;p&gt;i also found that&#160;archiveExecutionGraph can not be reached when the job is running&lt;/p&gt;</comment>
                            <comment id="17181706" author="jiangang" created="Fri, 21 Aug 2020 08:15:55 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;. The problem&#160;has been raised for some time. We should try to fix it. I suggest not to shut down per-job cluster at once after cancelJob in MiniDispatcher. Instead, we should&#160;shut down per-job cluster after&#160;jobReachedGloballyTerminalState, no matter&#160;executionMode is&#160;DETACHED or&#160;NORMAL. In this way, archivedExecutionGraph will be uploaded successfully and the semantic will not change. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tison&quot; class=&quot;user-hover&quot; rel=&quot;tison&quot;&gt;tison&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17181861" author="till.rohrmann" created="Fri, 21 Aug 2020 12:47:11 +0000"  >&lt;p&gt;I agree that we should fix this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;. The thing I am asking myself is why it has been done differently in the first place because the original behaviour has been like you described it in your solution proposal. That&apos;s why I&apos;ve pulled in Aljoscha and Tison who worked on the change.&lt;/p&gt;

&lt;p&gt;What you could try to do is to revert the &lt;tt&gt;MiniDispatcher&lt;/tt&gt; changes and then see whether some tests fail &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17182261" author="zhushang" created="Sat, 22 Aug 2020 07:37:13 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;,&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-18685&quot; title=&quot;JobClient.getAccumulators() blocks until streaming job has finished in local environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-18685&quot;&gt;&lt;del&gt;FLINK-18685&lt;/del&gt;&lt;/a&gt; is related to this issue?when i want to get accumulators from minicluster when the job is running.&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 miniCluster
   .getExecutionGraph(jobID)
   .thenApply(AccessExecutionGraph::getAccumulatorsSerialized)
   .thenApply(accumulators -&amp;gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; AccumulatorHelper.deserializeAndUnwrapAccumulators(accumulators, classLoader);
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
         &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CompletionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot deserialize and unwrap accumulators properly.&quot;&lt;/span&gt;, e);
      }
   });
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but it dosen&apos;t work.&lt;/p&gt;</comment>
                            <comment id="17183037" author="till.rohrmann" created="Mon, 24 Aug 2020 08:04:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ZhuShang&quot; class=&quot;user-hover&quot; rel=&quot;ZhuShang&quot;&gt;ZhuShang&lt;/a&gt; I believe that this is unrelated since the problem of this ticket should only affect the per-job cluster deployments (deployments which use the &lt;tt&gt;MiniDispatcher&lt;/tt&gt;).&lt;/p&gt;</comment>
                            <comment id="17183137" author="jiangang" created="Mon, 24 Aug 2020 10:19:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;, thanks for your advice. I just try to revert the change in MiniDispatcher caused by&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15116&quot; title=&quot;Make JobClient stateless, remove AutoCloseable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15116&quot;&gt;&lt;del&gt;FLINK-15116&lt;/del&gt;&lt;/a&gt;. Can you assign this ticket to me? I will do my best to fix it.&lt;/p&gt;</comment>
                            <comment id="17183188" author="till.rohrmann" created="Mon, 24 Aug 2020 12:08:48 +0000"  >&lt;p&gt;I&apos;ve assigned it to you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17183202" author="aljoscha" created="Mon, 24 Aug 2020 12:24:40 +0000"  >&lt;p&gt;Yes, this is an unintended side effect of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15116&quot; title=&quot;Make JobClient stateless, remove AutoCloseable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15116&quot;&gt;&lt;del&gt;FLINK-15116&lt;/del&gt;&lt;/a&gt;. Before that change, shutting down a per-job cluster was handled by the client, which meant that the cluster could get &quot;stuck&quot; in case the client disconnected. With the change, we&apos;re eagerly shutting down the cluster when cancelling from &quot;within the cluster&quot;. It seems we&apos;re shutting down too eagerly, though, and we should wait in the cluster until cancel/shutdown went through all the stages (including storing the archived execution graph).&lt;/p&gt;</comment>
                            <comment id="17183207" author="till.rohrmann" created="Mon, 24 Aug 2020 12:29:58 +0000"  >&lt;p&gt;So it should be fine to simply remove &lt;tt&gt;MiniDispatcher.cancelJob&lt;/tt&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17183342" author="aljoscha" created="Mon, 24 Aug 2020 14:22:14 +0000"  >&lt;p&gt;If that means the cluster still shuts down by itself upon cancellation, then yes.&lt;/p&gt;</comment>
                            <comment id="17183683" author="jiangang" created="Tue, 25 Aug 2020 02:21:55 +0000"  >&lt;p&gt;Thanks for the reply, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;. After reverting the code in MiniDispatcher, all tests run ok. But I also notice that something else should be changed. In&#160;MiniDispatcher&apos;s method&#160;jobReachedGloballyTerminalState, the cluster shuts down only if&#160;executionMode is DETACHED. Upon cancellation, the dispatcher will not shut down if&#160;executionMode is NORMAL. So we should shut down cluster&#160;no matter&#160;executionMode is&#160;DETACHED or&#160;NORMAL.&lt;/p&gt;</comment>
                            <comment id="17183761" author="till.rohrmann" created="Tue, 25 Aug 2020 06:28:47 +0000"  >&lt;p&gt;This is true &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jiangang&quot; class=&quot;user-hover&quot; rel=&quot;Jiangang&quot;&gt;Jiangang&lt;/a&gt;. Was this the requirement you had &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; that a per job cluster also shuts down in NORMAL mode when calling cancel w/o requesting the final job result?&lt;/p&gt;</comment>
                            <comment id="17183821" author="aljoscha" created="Tue, 25 Aug 2020 07:43:15 +0000"  >&lt;p&gt;Yes, exactly. The cluster should shut down in both modes. Maybe we can even get rid of the split between NORMAL and DETACHED by now.&lt;/p&gt;</comment>
                            <comment id="17183878" author="till.rohrmann" created="Tue, 25 Aug 2020 09:06:21 +0000"  >&lt;p&gt;How would this work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;? Are you referring to removing the &lt;tt&gt;NORMAL&lt;/tt&gt; and &lt;tt&gt;DETACHED&lt;/tt&gt; mode in general or only for the cancel call? If you are deploying a per job cluster in normal mode, then you might want to obtain the final job result (w/o cancellation). If the cluster does not wait until it is served, then there is no way to obtain it.&lt;/p&gt;</comment>
                            <comment id="17186453" author="aljoscha" created="Fri, 28 Aug 2020 10:20:11 +0000"  >&lt;p&gt;I think for this issue we would just change the behaviour for cancellation. In the long run, I think we should not block on shutdown anymore because this can lead to stuck clusters if the client (or connection) is down.&lt;/p&gt;

&lt;p&gt;The job/cluster lifecycle should be independent of the client once it is submitted and we should rely on the (long-running) cluster management system to allow retrieval of final job results: When running Flink in standalone/session mode, the Flink cluster itself is the long-running system that can return job results and that can be queried for past jobs. When using YARN, this should be the long-running system that allows querying jobs and job results, same for Kubernetes. We could also think about delegating to the history server for these purposes. WDYT?&lt;/p&gt;</comment>
                            <comment id="17187559" author="till.rohrmann" created="Mon, 31 Aug 2020 08:37:41 +0000"  >&lt;p&gt;In theory I agree that it would be great to get rid of this special case behaviour. If we always had a system where one could persist the final job result, this would work. However, I am not sure whether this is always the case.  And I am not sure whether it would improve Flink&apos;s usability if our users would always have to deploy/start a second system in order to use Flink&apos;s per-job mode.&lt;/p&gt;

&lt;p&gt;On the other hand, I also agree that depending on the client behaviour for deciding when to shut down or not, is also not ideal. One could mitigate the problem of a deadlocked cluster by introducing a timeout for the final job result serving.&lt;/p&gt;</comment>
                            <comment id="17188277" author="aljoscha" created="Tue, 1 Sep 2020 08:56:56 +0000"  >&lt;p&gt;Agreed on everything. But that&apos;s a new Jira issue, right? For this one, we should just change the CANCEL path to go through all the normal steps.&lt;/p&gt;</comment>
                            <comment id="17188303" author="till.rohrmann" created="Tue, 1 Sep 2020 09:27:58 +0000"  >&lt;p&gt;Yes exactly. The scope of this ticket is to fix the current regression which means to that cancelling a job should still trigger its archiving.&lt;/p&gt;</comment>
                            <comment id="17188887" author="jiangang" created="Wed, 2 Sep 2020 00:34:21 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;. If we just revert the&#160;&lt;tt&gt;MiniDispatcher&lt;/tt&gt;&#160;changes and do nothing else,&#160;&#160;the dispatcher may not shutdown at last in the case that the client is shutdown unexpectedly before. The discussion above also proves it. Should we resolve the problem or just&#160;revert the&#160;&lt;tt&gt;MiniDispatcher&lt;/tt&gt;&#160;changes in this ticket and create another ticket for the problem? Thank you.&lt;/p&gt;</comment>
                            <comment id="17189057" author="till.rohrmann" created="Wed, 2 Sep 2020 07:56:09 +0000"  >&lt;p&gt;I think we can record whether &lt;tt&gt;MiniDispatcher.cancelJob&lt;/tt&gt; has been called and then complete the &lt;tt&gt;shutDownFuture&lt;/tt&gt; if either this has happened or the execution mode is &lt;tt&gt;DETACHED&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17190604" author="till.rohrmann" created="Fri, 4 Sep 2020 07:40:30 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;master: d9bddfd3c49203034141fafa0b1d522e7ea0b6e7&lt;br/&gt;
1.11.2: 7e2294c2b5ca9a17c924ff948a0dcd87d90c8327&lt;br/&gt;
1.10.3: 40f81b7794bde837aee8acac8944929ec43b6ef6&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13272823">FLINK-15116</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13009856" name="flink-debug-log" size="67959" author="Jiangang" created="Fri, 14 Aug 2020 11:13:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hrrc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>