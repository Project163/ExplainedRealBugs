<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:00:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24062] Exception encountered during timer serialization in Python DataStream API </title>
                <link>https://issues.apache.org/jira/browse/FLINK-24062</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;For the following example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
################################################################################
#  Licensed to the Apache Software Foundation (ASF) under one
#  or more contributor license agreements.  See the NOTICE file
#  distributed with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; work &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; additional information
#  regarding copyright ownership.  The ASF licenses &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; file
#  to you under the Apache License, Version 2.0 (the
#  &lt;span class=&quot;code-quote&quot;&gt;&quot;License&quot;&lt;/span&gt;); you may not use &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; file except in compliance
#  with the License.  You may obtain a copy of the License at
#
#      http:&lt;span class=&quot;code-comment&quot;&gt;//www.apache.org/licenses/LICENSE-2.0
&lt;/span&gt;#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an &lt;span class=&quot;code-quote&quot;&gt;&quot;AS IS&quot;&lt;/span&gt; BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the specific language governing permissions and
# limitations under the License.
################################################################################
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; argparse
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; logging
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; sys

from pyflink.common &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; WatermarkStrategy, Encoder, Types
from pyflink.datastream &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; StreamExecutionEnvironment, RuntimeExecutionMode
from pyflink.datastream.connectors &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; (FileSource, StreamFormat, FileSink, OutputFileConfig,
                                           RollingPolicy)


word_count_data = [&lt;span class=&quot;code-quote&quot;&gt;&quot;To be, or not to be,--that is the question:--&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Whether &apos;tis nobler in the mind to suffer&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The slings and arrows of outrageous fortune&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Or to take arms against a sea of troubles,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;And by opposing end them?--To die,--to sleep,--&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;No more; and by a sleep to say we end&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The heartache, and the thousand natural shocks&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;That flesh is heir to,--&apos;tis a consummation&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Devoutly to be wish&apos;d. To die,--to sleep;--&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;To sleep! perchance to dream:--ay, there&apos;s the rub;&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;For in that sleep of death what dreams may come,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;When we have shuffled off &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; mortal coil,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Must give us pause: there&apos;s the respect&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;That makes calamity of so &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; life;&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;For who would bear the whips and scorns of time,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The oppressor&lt;span class=&quot;code-quote&quot;&gt;&apos;s wrong, the proud man&apos;&lt;/span&gt;s contumely,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The pangs of despis&lt;span class=&quot;code-quote&quot;&gt;&apos;d love, the law&apos;&lt;/span&gt;s delay,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The insolence of office, and the spurns&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;That patient merit of the unworthy takes,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;When he himself might his quietus make&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;With a bare bodkin? who would these fardels bear,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;To grunt and sweat under a weary life,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;But that the dread of something after death,--&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The undiscover&apos;d country, from whose bourn&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;No traveller returns,--puzzles the will,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;And makes us rather bear those ills we have&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Than fly to others that we know not of?&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Thus conscience does make cowards of us all;&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;And thus the &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; hue of resolution&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Is sicklied o&apos;er with the pale &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; of thought;&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;And enterprises of great pith and moment,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;With &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; regard, their currents turn awry,&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;And lose the name of action.--Soft you now!&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;The fair Ophelia!--Nymph, in thy orisons&quot;&lt;/span&gt;,
                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Be all my sins remember&apos;d.&quot;&lt;/span&gt;]


def word_count(input_path, output_path):
    env = StreamExecutionEnvironment.get_execution_environment()
    env.set_runtime_mode(RuntimeExecutionMode.BATCH)
    # write all the data to one file
    env.set_parallelism(1)

    # define the source
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; input_path is not None:
        ds = env.from_source(
            source=FileSource.for_record_stream_format(StreamFormat.text_line_format(),
                                                       input_path)
                             .process_static_file_set().build(),
            watermark_strategy=WatermarkStrategy.for_monotonous_timestamps(),
            source_name=&lt;span class=&quot;code-quote&quot;&gt;&quot;file_source&quot;&lt;/span&gt;
        )
    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
        print(&lt;span class=&quot;code-quote&quot;&gt;&quot;Executing word_count example with &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; input data set.&quot;&lt;/span&gt;)
        print(&lt;span class=&quot;code-quote&quot;&gt;&quot;Use --input to specify file input.&quot;&lt;/span&gt;)
        ds = env.from_collection(word_count_data)

    def split(line):
        yield from line.split()

    # compute word count
    ds = ds.flat_map(split) \
           .map(lambda i: (i, 1), output_type=Types.TUPLE([Types.STRING(), Types.INT()])) \
           .key_by(lambda i: i[0]) \
           .reduce(lambda i, j: (i[0], i[1] + j[1]))

    # define the sink
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; output_path is not None:
        ds.sink_to(
            sink=FileSink.for_row_format(
                base_path=output_path,
                encoder=Encoder.simple_string_encoder())
            .with_output_file_config(
                OutputFileConfig.builder()
                .with_part_prefix(&lt;span class=&quot;code-quote&quot;&gt;&quot;prefix&quot;&lt;/span&gt;)
                .with_part_suffix(&lt;span class=&quot;code-quote&quot;&gt;&quot;.ext&quot;&lt;/span&gt;)
                .build())
            .with_rolling_policy(RollingPolicy.default_rolling_policy())
            .build()
        )
    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
        print(&lt;span class=&quot;code-quote&quot;&gt;&quot;Printing result to stdout. Use --output to specify output path.&quot;&lt;/span&gt;)
        ds.print()

    # submit &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; execution
    env.execute()


&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;code-quote&quot;&gt;&apos;__main__&apos;&lt;/span&gt;:
    logging.basicConfig(stream=sys.stdout, level=logging.INFO, format=&lt;span class=&quot;code-quote&quot;&gt;&quot;%(message)s&quot;&lt;/span&gt;)

    parser = argparse.ArgumentParser()
    parser.add_argument(
        &lt;span class=&quot;code-quote&quot;&gt;&apos;--input&apos;&lt;/span&gt;,
        dest=&lt;span class=&quot;code-quote&quot;&gt;&apos;input&apos;&lt;/span&gt;,
        required=False,
        help=&lt;span class=&quot;code-quote&quot;&gt;&apos;Input file to process.&apos;&lt;/span&gt;)
    parser.add_argument(
        &lt;span class=&quot;code-quote&quot;&gt;&apos;--output&apos;&lt;/span&gt;,
        dest=&lt;span class=&quot;code-quote&quot;&gt;&apos;output&apos;&lt;/span&gt;,
        required=False,
        help=&lt;span class=&quot;code-quote&quot;&gt;&apos;Output file to write results to.&apos;&lt;/span&gt;)

    argv = sys.argv[1:]
    known_args, _ = parser.parse_known_args(argv)

    word_count(known_args.input, known_args.output)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will throw the following exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;pyflink/examples/datastream/word_count.py&quot;&lt;/span&gt;, line 134, in &amp;lt;module&amp;gt;
    word_count(known_args.input, known_args.output)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;pyflink/examples/datastream/word_count.py&quot;&lt;/span&gt;, line 113, in word_count
    env.execute()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/dianfu/venv/examples-37/lib/python3.7/site-packages/pyflink/datastream/stream_execution_environment.py&quot;&lt;/span&gt;, line 691, in execute
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; JobExecutionResult(self._j_stream_execution_environment.execute(j_stream_graph))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/dianfu/venv/examples-37/lib/python3.7/site-packages/py4j/java_gateway.py&quot;&lt;/span&gt;, line 1286, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/dianfu/venv/examples-37/lib/python3.7/site-packages/pyflink/util/exceptions.py&quot;&lt;/span&gt;, line 146, in deco
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; f(*a, **kw)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/dianfu/venv/examples-37/lib/python3.7/site-packages/py4j/protocol.py&quot;&lt;/span&gt;, line 328, in get_return_value
    format(target_id, &lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt;, name), value)
py4j.protocol.Py4JJavaError: An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; calling o3.execute.
: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:144)
	at org.apache.flink.runtime.minicluster.MiniClusterJobClient.lambda$getJobExecutionResult$3(MiniClusterJobClient.java:137)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.flink.runtime.rpc.akka.AkkaInvocationHandler.lambda$invokeRpc$0(AkkaInvocationHandler.java:250)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.flink.util.concurrent.FutureUtils.doForward(FutureUtils.java:1389)
	at org.apache.flink.runtime.concurrent.akka.ClassLoadingUtils.lambda$&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;$1(ClassLoadingUtils.java:93)
	at org.apache.flink.runtime.concurrent.akka.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:68)
	at org.apache.flink.runtime.concurrent.akka.ClassLoadingUtils.lambda$guardCompletionWithContextClassLoader$2(ClassLoadingUtils.java:92)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.flink.runtime.concurrent.akka.AkkaFutureUtils$1.onComplete(AkkaFutureUtils.java:47)
	at akka.dispatch.OnComplete.internal(Future.scala:300)
	at akka.dispatch.OnComplete.internal(Future.scala:297)
	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:224)
	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:221)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:60)
	at org.apache.flink.runtime.concurrent.akka.AkkaFutureUtils$DirectExecutionContext.execute(AkkaFutureUtils.java:65)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:68)
	at scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1(Promise.scala:284)
	at scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1$adapted(Promise.scala:284)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:284)
	at akka.pattern.PromiseActorRef.$bang(AskSupport.scala:621)
	at akka.pattern.PipeToSupport$PipeableFuture$$anonfun$pipeTo$1.applyOrElse(PipeToSupport.scala:24)
	at akka.pattern.PipeToSupport$PipeableFuture$$anonfun$pipeTo$1.applyOrElse(PipeToSupport.scala:23)
	at scala.concurrent.Future.$anonfun$andThen$1(Future.scala:532)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:29)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:29)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:60)
	at akka.dispatch.BatchingExecutor$AbstractBatch.processBatch(BatchingExecutor.scala:63)
	at akka.dispatch.BatchingExecutor$BlockableBatch.$anonfun$run$1(BatchingExecutor.scala:100)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:81)
	at akka.dispatch.BatchingExecutor$BlockableBatch.run(BatchingExecutor.scala:100)
	at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:49)
	at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(ForkJoinExecutorConfigurator.scala:48)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1067)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1703)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:172)
Caused by: org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy
	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:138)
	at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:82)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:228)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:218)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:209)
	at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:679)
	at org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:79)
	at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:441)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.lambda$handleRpcInvocation$1(AkkaRpcActor.java:316)
	at org.apache.flink.runtime.concurrent.akka.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:83)
	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:314)
	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:217)
	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:78)
	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:163)
	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:24)
	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:20)
	at scala.PartialFunction.applyOrElse(PartialFunction.scala:123)
	at scala.PartialFunction.applyOrElse$(PartialFunction.scala:122)
	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:20)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172)
	at akka.actor.Actor.aroundReceive(Actor.scala:537)
	at akka.actor.Actor.aroundReceive$(Actor.scala:535)
	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:220)
	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:580)
	at akka.actor.ActorCell.invoke(ActorCell.scala:548)
	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:270)
	at akka.dispatch.Mailbox.run(Mailbox.scala:231)
	at akka.dispatch.Mailbox.exec(Mailbox.scala:243)
	... 4 more
Caused by: java.lang.RuntimeException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BeamPythonFunctionRunner flush
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.invokeFinishBundle(AbstractPythonFunctionOperator.java:361)
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.processElementsOfCurrentKeyIfNeeded(AbstractPythonFunctionOperator.java:257)
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.setCurrentKey(AbstractPythonFunctionOperator.java:246)
	at org.apache.flink.streaming.api.operators.python.PythonKeyedProcessOperator.setCurrentKey(PythonKeyedProcessOperator.java:225)
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.setKeyContextElement(AbstractStreamOperator.java:504)
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.setKeyContextElement1(AbstractStreamOperator.java:491)
	at org.apache.flink.streaming.api.operators.OneInputStreamOperator.setKeyContextElement(OneInputStreamOperator.java:36)
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask$StreamTaskNetworkOutput.emitRecord(OneInputStreamTask.java:229)
	at org.apache.flink.streaming.api.operators.sort.SortingDataInput.emitNextSortedRecord(SortingDataInput.java:207)
	at org.apache.flink.streaming.api.operators.sort.SortingDataInput.emitNext(SortingDataInput.java:187)
	at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:489)
	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:203)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:819)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.executeInvoke(StreamTask.java:746)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:785)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:728)
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:786)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:572)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
Caused by: java.lang.RuntimeException: Failed to close remote bundle
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.finishBundle(BeamPythonFunctionRunner.java:377)
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.flush(BeamPythonFunctionRunner.java:361)
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.lambda$invokeFinishBundle$2(AbstractPythonFunctionOperator.java:340)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: java.util.concurrent.ExecutionException: org.apache.beam.sdk.coders.CoderException: java.io.EOFException
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1908)
	at org.apache.beam.sdk.fn.data.CompletableFutureInboundDataClient.awaitCompletion(CompletableFutureInboundDataClient.java:48)
	at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver.awaitCompletion(BeamFnDataInboundObserver.java:73)
	at org.apache.beam.runners.fnexecution.control.SdkHarnessClient$BundleProcessor$ActiveBundle.close(SdkHarnessClient.java:542)
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory$1.close(DefaultJobBundleFactory.java:555)
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.finishBundle(BeamPythonFunctionRunner.java:375)
	... 7 more
Caused by: org.apache.beam.sdk.coders.CoderException: java.io.EOFException
	at org.apache.beam.sdk.coders.StringUtf8Coder.decode(StringUtf8Coder.java:104)
	at org.apache.beam.sdk.coders.StringUtf8Coder.decode(StringUtf8Coder.java:90)
	at org.apache.beam.runners.core.construction.Timer$Coder.decode(Timer.java:195)
	at org.apache.beam.runners.core.construction.Timer$Coder.decode(Timer.java:158)
	at org.apache.beam.sdk.fn.data.DecodingFnDataReceiver.accept(DecodingFnDataReceiver.java:43)
	at org.apache.beam.sdk.fn.data.DecodingFnDataReceiver.accept(DecodingFnDataReceiver.java:25)
	at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver.accept(BeamFnDataInboundObserver.java:65)
	at org.apache.beam.sdk.fn.data.BeamFnDataInboundObserver.accept(BeamFnDataInboundObserver.java:29)
	at org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer$InboundObserver.onNext(BeamFnDataGrpcMultiplexer.java:178)
	at org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer$InboundObserver.onNext(BeamFnDataGrpcMultiplexer.java:127)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:251)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:309)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:292)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:782)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	... 3 more
Caused by: java.io.EOFException
	at org.apache.beam.sdk.util.VarInt.decodeLong(VarInt.java:73)
	at org.apache.beam.sdk.util.VarInt.decodeInt(VarInt.java:56)
	at org.apache.beam.sdk.coders.StringUtf8Coder.readString(StringUtf8Coder.java:55)
	at org.apache.beam.sdk.coders.StringUtf8Coder.decode(StringUtf8Coder.java:100)
	... 20 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13398361">FLINK-24062</key>
            <summary>Exception encountered during timer serialization in Python DataStream API </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dianfu">Dian Fu</assignee>
                                    <reporter username="dianfu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>release-testing</label>
                    </labels>
                <created>Tue, 31 Aug 2021 05:13:47 +0000</created>
                <updated>Wed, 1 Sep 2021 09:12:54 +0000</updated>
                            <resolved>Wed, 1 Sep 2021 03:46:57 +0000</resolved>
                                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17407792" author="dianfu" created="Wed, 1 Sep 2021 03:46:57 +0000"  >&lt;p&gt;Fixed in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master via 4ba14cc3ef786623885e3b92a2f949a83edab2aa&lt;/li&gt;
	&lt;li&gt;release-1.14 via 9c3957f7a42b5378d4b3ccad281f052fe2285d61&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ufvs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>