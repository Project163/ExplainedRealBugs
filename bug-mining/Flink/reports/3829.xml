<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:44:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15771] SQLClientKafkaITCase.testKafka failed on Travis</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15771</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The end-to-end test &lt;tt&gt;SQLClientKafkaITCase.testKafka&lt;/tt&gt; failed with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
22:09:36.957 [ERROR] Tests run: 3, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 129.244 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.tests.util.kafka.SQLClientKafkaITCase
22:09:36.958 [ERROR] testKafka[2: kafka-version:universal kafka-sql-version:.*kafka.jar](org.apache.flink.tests.util.kafka.SQLClientKafkaITCase)  Time elapsed: 45.954 s  &amp;lt;&amp;lt;&amp;lt; FAILURE!
org.junit.ComparisonFailure: 
expected:&amp;lt;...-03-12 09:00:00.000,[Bob,This was another warning.,1,Success constant folding.
2018-03-12 09:00:00.000,Steve,This was another info.,2],Success constant fo...&amp;gt; but was:&amp;lt;...-03-12 09:00:00.000,[Steve,This was another info.,2,Success constant folding.
2018-03-12 09:00:00.000,Bob,This was another warning.,1],Success constant fo...&amp;gt;
	at org.apache.flink.tests.util.kafka.SQLClientKafkaITCase.checkCsvResultFile(SQLClientKafkaITCase.java:226)
	at org.apache.flink.tests.util.kafka.SQLClientKafkaITCase.testKafka(SQLClientKafkaITCase.java:154)

22:09:37.287 [INFO] 
22:09:37.288 [INFO] Results:
22:09:37.288 [INFO] 
22:09:37.288 [ERROR] Failures: 
22:09:37.288 [ERROR]   SQLClientKafkaITCase.testKafka:154-&amp;gt;checkCsvResultFile:226 expected:&amp;lt;...-03-12 09:00:00.000,[Bob,This was another warning.,1,Success constant folding.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://api.travis-ci.org/v3/job/641346345/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://api.travis-ci.org/v3/job/641346345/log.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13281554">FLINK-15771</key>
            <summary>SQLClientKafkaITCase.testKafka failed on Travis</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Sat, 25 Jan 2020 17:24:53 +0000</created>
                <updated>Fri, 29 May 2020 06:21:13 +0000</updated>
                            <resolved>Fri, 29 May 2020 06:20:03 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                    <component>Table SQL / Client</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17023897" author="zentol" created="Sun, 26 Jan 2020 18:33:50 +0000"  >&lt;p&gt;A bit more readable error-message:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
expected:&amp;lt;
...-03-12 09:00:00.000,[Bob,This was another warning.,1,Success constant folding.
2018-03-12 09:00:00.000,Steve,This was another info.,2],Success constant fo...&amp;gt;
but was:&amp;lt;
...-03-12 09:00:00.000,[Steve,This was another info.,2,Success constant folding.
2018-03-12 09:00:00.000,Bob,This was another warning.,1],Success constant fo...&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that order is incorrect. I don&apos;t know whether the order is &lt;em&gt;supposed&lt;/em&gt; to be fixed (nothing in the query seems to guarantee that); maybe adding a sort statement to &lt;tt&gt;insertIntoCsvSinkTable&lt;/tt&gt; is enough.&lt;/p&gt;</comment>
                            <comment id="17024412" author="till.rohrmann" created="Mon, 27 Jan 2020 15:14:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=openinx&quot; class=&quot;user-hover&quot; rel=&quot;openinx&quot;&gt;openinx&lt;/a&gt; could you help with fixing this test?&lt;/p&gt;</comment>
                            <comment id="17025073" author="dawidwys" created="Tue, 28 Jan 2020 12:26:18 +0000"  >&lt;p&gt;I am not sure what can we do about it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I can&apos;t reproduce it locally. I run the test ~100 times and it succeeds all the time. It&apos;s true we are not strictly enforcing the order, but we are effectively running the test with parallelism of 1, which should produce deterministic results. We do group by window, but it should nevertheless output in order of incoming keys. Unless I am missing something here &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I agree it might make sense to add some sorting at the end. The problem is we cannot add the sorting in the query because it is a streaming query without time attributes. This would mean we would have to apply a global sorting on a stream which is not possible. We would have to rework the whole structure of the test.&lt;/p&gt;

&lt;p&gt;I am also not 100% sure what do we actually want to test with this e2e test. If we just want to test that dependencies, classloading issues with different connectors. We could probably simplify the test. &lt;/p&gt;</comment>
                            <comment id="17028660" author="jark" created="Mon, 3 Feb 2020 03:52:00 +0000"  >&lt;p&gt;I guess the problem might be in the group window timer. The timers are ordered by the timestamp but not the key and namespace. However, &quot;Steve&quot; and &quot;Bob&quot; have the same timestamp but different keys. I guess &lt;tt&gt;InternalPriorityQueue.peak()&lt;/tt&gt;  doesn&apos;t guarantee the insertion order, but only the timestamp order (is that right &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;?). Hence, the result of the group window is not deterministic. &lt;/p&gt;

&lt;p&gt;I think we can sort the result before checking which is also the paradigm in our Table IT cases. What do you think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17028729" author="dawidwys" created="Mon, 3 Feb 2020 07:38:04 +0000"  >&lt;p&gt;We came to the same conclusion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Personally I don&apos;t like the automatic, generic sorting in our IT tests. I think it might be quite surprising at times, as it was surprising for me in this case. There are cases when I think it makes sense to assert also on the order. I&apos;d be inclined to rather rework this IT test so that it produces deterministic results. I would start though with collecting a list of features that it tries to test. Right now it&apos;s unclear for me what is actually being testes and what is asserted there by coincidence.&lt;/p&gt;</comment>
                            <comment id="17060142" author="twalthr" created="Mon, 16 Mar 2020 11:42:51 +0000"  >&lt;p&gt;How about we avoid using the same timestamp in this test? And check if this solve the problem long-term? We can still decide on sorting the results later.&lt;/p&gt;</comment>
                            <comment id="17060259" author="jark" created="Mon, 16 Mar 2020 14:29:59 +0000"  >&lt;p&gt;Sounds good to me. I think the purpose of e2e tests are mainly for packaging and classloading, not the result order.&lt;/p&gt;</comment>
                            <comment id="17062444" author="twalthr" created="Thu, 19 Mar 2020 10:40:01 +0000"  >&lt;p&gt;Fixed in 1.11.0: 6269a2a1f6b604d2e850b7cf5b0f0050085798b7&lt;/p&gt;</comment>
                            <comment id="17118580" author="rmetzger" created="Thu, 28 May 2020 11:45:36 +0000"  >&lt;p&gt;I&apos;m reopening this, as this error happened again: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=2323&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=2323&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=1e2bbe5b-4657-50be-1f07-d84bfce5b1f5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17118587" author="zentol" created="Thu, 28 May 2020 11:52:35 +0000"  >&lt;p&gt;I&apos;d argue that this is a different error, so there should be a separate JIRA. It&apos;s not about order; the result is just wrong.&lt;/p&gt;</comment>
                            <comment id="17119299" author="dawidwys" created="Fri, 29 May 2020 06:21:13 +0000"  >&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; here. I opened a separate issue for it &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-18020&quot; title=&quot;SQLClientKafkaITCase.testKafka is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-18020&quot;&gt;&lt;del&gt;FLINK-18020&lt;/del&gt;&lt;/a&gt;. I also observed that in my local fork.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13290650">FLINK-16514</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13286049">FLINK-16156</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0av0w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>