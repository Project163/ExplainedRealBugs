<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:18:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1628] Strange behavior of &quot;where&quot; function during a join</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1628</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hello!&lt;/p&gt;

&lt;p&gt;If I use the `where` function with a field list during a join, it exhibits strange behavior.&lt;/p&gt;

&lt;p&gt;Here is the sample code that triggers the error: &lt;a href=&quot;https://gist.github.com/balidani/d9789b713e559d867d5c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/balidani/d9789b713e559d867d5c&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This example joins a DataSet with itself, then counts the number of rows. If I use `.where(0, 1)` the result is (22), which is not correct. If I use `EdgeKeySelector`, I get the correct result (101).&lt;/p&gt;

&lt;p&gt;When I pass a field list to the `equalTo` function (but not `where`), everything works again.&lt;/p&gt;

&lt;p&gt;If I don&apos;t include the `groupBy` and `reduceGroup` parts, everything works.&lt;/p&gt;

&lt;p&gt;Also, when working with large DataSets, passing a field list to `where` makes it incredibly slow, even though I don&apos;t see any exceptions in the log (in DEBUG mode).&lt;/p&gt;

&lt;p&gt;Does anybody know what might cause this problem?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12778807">FLINK-1628</key>
            <summary>Strange behavior of &quot;where&quot; function during a join</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fhueske">Fabian Hueske</assignee>
                                    <reporter username="balidani">Daniel Bali</reporter>
                        <labels>
                            <label>batch</label>
                    </labels>
                <created>Mon, 2 Mar 2015 17:52:27 +0000</created>
                <updated>Thu, 28 Feb 2019 14:30:09 +0000</updated>
                            <resolved>Tue, 10 Mar 2015 00:51:53 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9</fixVersion>
                    <fixVersion>0.8.2</fixVersion>
                                    <component>API / DataSet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14343584" author="stephanewen" created="Mon, 2 Mar 2015 19:04:45 +0000"  >&lt;p&gt;Is this specific to the combination of tuple positions and key selector in the where clause, or does it also occur when using tuple positions for both inputs (where and equalTo clause)&lt;/p&gt;</comment>
                            <comment id="14343619" author="balidani" created="Mon, 2 Mar 2015 19:24:28 +0000"  >&lt;p&gt;It also occurs when using tuple positions for both inputs.&lt;/p&gt;

&lt;p&gt;Also, when I change the order of the joined DataSets, it&apos;s the `equalTo` that fails when using tuple positions.&lt;/p&gt;</comment>
                            <comment id="14345350" author="aljoscha" created="Tue, 3 Mar 2015 17:13:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt; and I found the bug in the optimizer. We still have to run some tests, though, to be sure.&lt;/p&gt;</comment>
                            <comment id="14345353" author="aljoscha" created="Tue, 3 Mar 2015 17:14:11 +0000"  >&lt;p&gt;This is the fix, line 128 in AbstractJoinDescriptor:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; areCompatible(RequestedGlobalProperties requested1, RequestedGlobalProperties requested2,
			GlobalProperties produced1, GlobalProperties produced2)
	{
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (requested1.getPartitioning().isPartitionedOnKey() &amp;amp;&amp;amp; requested2.getPartitioning().isPartitionedOnKey()) {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; produced1.getPartitioning() == produced2.getPartitioning() &amp;amp;&amp;amp;
					produced1.getPartitioningFields().equals(produced2.getPartitioningFields()) &amp;amp;&amp;amp;
					(produced1.getCustomPartitioner() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 
						produced2.getCustomPartitioner() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; :
						produced1.getCustomPartitioner().equals(produced2.getCustomPartitioner()));
		} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
		}

	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14349652" author="githubbot" created="Fri, 6 Mar 2015 00:01:00 +0000"  >&lt;p&gt;GitHub user fhueske opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/458&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1628&quot; title=&quot;Strange behavior of &amp;quot;where&amp;quot; function during a join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1628&quot;&gt;&lt;del&gt;FLINK-1628&lt;/del&gt;&lt;/a&gt; Fix partitioning properties for Joins and CoGroups.&lt;/p&gt;

&lt;p&gt;    Fix partitioning properties for Joins and CoGroups and some smaller bugs on the way.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/fhueske/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/fhueske/flink&lt;/a&gt; joinCompilerBug&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/458.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/458.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #458&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 89c3bd0b76c1b4ace58e93571b361cdc0af2cbd6&lt;br/&gt;
Author: Fabian Hueske &amp;lt;fhueske@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-03-04T17:49:22Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1628&quot; title=&quot;Strange behavior of &amp;quot;where&amp;quot; function during a join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1628&quot;&gt;&lt;del&gt;FLINK-1628&lt;/del&gt;&lt;/a&gt; Fix partitioning properties for Joins and CoGroups.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14352025" author="githubbot" created="Sun, 8 Mar 2015 12:43:33 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/458#issuecomment-77746801&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/458#issuecomment-77746801&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good. Impressive test coverage!&lt;/p&gt;

&lt;p&gt;    +1 to merge&lt;/p&gt;</comment>
                            <comment id="14353989" author="githubbot" created="Tue, 10 Mar 2015 00:44:49 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/458&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14354002" author="fhueske" created="Tue, 10 Mar 2015 00:51:53 +0000"  >&lt;p&gt;Fixed with b0a57c32fc68d4a1369e5ece25d3a6e986ee1e2a&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2690n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>