<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-31324] Broken SingleThreadFetcherManager constructor API</title>
                <link>https://issues.apache.org/jira/browse/FLINK-31324</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-28853&quot; title=&quot;FLIP-217 Support watermark alignment of source splits&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-28853&quot;&gt;&lt;del&gt;FLINK-28853&lt;/del&gt;&lt;/a&gt; changed the default constructor of &lt;tt&gt;SingleThreadFetcherManager&lt;/tt&gt;. Though the &lt;tt&gt;SingleThreadFetcherManager&lt;/tt&gt; is annotated as &lt;tt&gt;Internal&lt;/tt&gt;, it actually acts as some-degree public API, which is widely used in many connector projects:&lt;br/&gt;
&lt;a href=&quot;https://github.com/ververica/flink-cdc-connectors/blob/release-2.3.0/flink-connector-mysql-cdc/src/main/java/com/ververica/cdc/connectors/mysql/source/reader/MySqlSourceReader.java#L93&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flink-cdc-connector&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/flink-connector-mongodb/blob/main/flink-connector-mongodb/src/main/java/org/apache/flink/connector/mongodb/source/reader/MongoSourceReader.java#L58&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;flink-connector-mongodb&lt;/a&gt; and so on.&lt;/p&gt;

&lt;p&gt;Once flink-1.17 is released, all these existing connectors are broken and cannot be used in new release version, and will throw exceptions like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.NoSuchMethodError: org.apache.flink.connector.base.source.reader.fetcher.SingleThreadFetcherManager.&amp;lt;init&amp;gt;(Lorg/apache/flink/connector/base/source/reader/synchronization/FutureCompletingBlockingQueue;Ljava/util/function/Supplier;)V
	at com.ververica.cdc.connectors.mysql.source.reader.MySqlSourceReader.&amp;lt;init&amp;gt;(MySqlSourceReader.java:91) ~[flink-sql-connector-mysql-cdc-2.3.0.jar:2.3.0]
	at com.ververica.cdc.connectors.mysql.source.MySqlSource.createReader(MySqlSource.java:159) ~[flink-sql-connector-mysql-cdc-2.3.0.jar:2.3.0]
	at org.apache.flink.streaming.api.operators.SourceOperator.initReader(SourceOperator.java:312) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.SourceOperatorStreamTask.init(SourceOperatorStreamTask.java:94) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:699) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:675) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:952) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:921) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:745) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:562) ~[flink-dist-1.17-SNAPSHOT.jar:1.17-SNAPSHOT]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:750) ~[?:1.8.0_362]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Thus, I suggest to make the original SingleThreadFetcherManager constructor as depreacted instead of removing it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13527091">FLINK-31324</key>
            <summary>Broken SingleThreadFetcherManager constructor API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yunta">Yun Tang</assignee>
                                    <reporter username="yunta">Yun Tang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sat, 4 Mar 2023 15:40:15 +0000</created>
                <updated>Mon, 6 Mar 2023 10:13:53 +0000</updated>
                            <resolved>Mon, 6 Mar 2023 10:13:53 +0000</resolved>
                                                    <fixVersion>1.17.0</fixVersion>
                    <fixVersion>1.18.0</fixVersion>
                                    <component>Connectors / Parent</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17696457" author="yunta" created="Sat, 4 Mar 2023 15:42:04 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mxm&quot; class=&quot;user-hover&quot; rel=&quot;mxm&quot;&gt;mxm&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17696653" author="jark" created="Mon, 6 Mar 2023 02:29:45 +0000"  >&lt;p&gt;+1 for keeping compatibility. &lt;/p&gt;

&lt;p&gt;Besides, I think &lt;tt&gt;SingleThreadFetcherManager&lt;/tt&gt; should be annotated &lt;tt&gt;@PublicEvolving&lt;/tt&gt; because it is referenced by the public constructor of the  &lt;tt&gt;@PublicEvolving&lt;/tt&gt; class &lt;tt&gt;SingleThreadMultiplexSourceReaderBase&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;According to FLIP-196,&lt;br/&gt;
&amp;gt; Per default, all public members of an API object inherit the stability guarantee of the owning object.&lt;/p&gt;

&lt;p&gt;But I think this annotating &lt;tt&gt;@PublicEvolving&lt;/tt&gt; may need another issue and discussion on the dev ML. &lt;/p&gt;

&lt;p&gt;What do you think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yunta&quot; class=&quot;user-hover&quot; rel=&quot;yunta&quot;&gt;yunta&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17696673" author="yunta" created="Mon, 6 Mar 2023 03:31:39 +0000"  >&lt;p&gt;I think we can discuss changing the annotation of &lt;tt&gt;SingleThreadFetcherManager&lt;/tt&gt;. However, the &lt;tt&gt;Internal&lt;/tt&gt; annotation is introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22358&quot; title=&quot;Add missing stability annotation to Split Reader API classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22358&quot;&gt;&lt;del&gt;FLINK-22358&lt;/del&gt;&lt;/a&gt;, which changed a lot of classes. Since I am not so familiar with these changes, I think we need to involve more committers on connector topics for discussion. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=becket_qin&quot; class=&quot;user-hover&quot; rel=&quot;becket_qin&quot;&gt;becket_qin&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=renqs&quot; class=&quot;user-hover&quot; rel=&quot;renqs&quot;&gt;renqs&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17696756" author="becket_qin" created="Mon, 6 Mar 2023 08:22:18 +0000"  >&lt;p&gt;I think `SingleThreadFetcherManager` is indeed somewhat public at the moment. Connector implementations extend this class from time to time. So we probably need to make it backwards compatible even though it is marked as internal.&lt;/p&gt;

&lt;p&gt;It also looks OK if we make it PublicEvolving. If we do so, the only additional class that we also need to make public is `FutureCompletingBlockingQueue` as PublicEvolving. So it does not pull in much unnecessary class exposures to the users.&lt;/p&gt;</comment>
                            <comment id="17696765" author="yunta" created="Mon, 6 Mar 2023 08:41:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=becket_qin&quot; class=&quot;user-hover&quot; rel=&quot;becket_qin&quot;&gt;becket_qin&lt;/a&gt;, thanks for the reply. As the expert on the connector modules, I think you&apos;re more suitable to launch the discussion in the dev ML, and we can have a deep discussion in another ticket.&lt;/p&gt;</comment>
                            <comment id="17696839" author="yunta" created="Mon, 6 Mar 2023 10:13:53 +0000"  >&lt;p&gt;merged,&lt;br/&gt;
master: 4d285753b75157ca078ba0917412c273d147aba9&lt;br/&gt;
release-1.17: 8acec2c14a2a56b9293354693008cc9c3e77692e&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13475610">FLINK-28853</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gc8w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>