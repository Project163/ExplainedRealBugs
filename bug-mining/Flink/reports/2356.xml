<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9103] SSL verification on TaskManager when parallelism &gt; 1</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9103</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In dynamic environments like Kubernetes, the SSL certificates&#160;can be&#160;generated to use only the DNS addresses&#160;for validation of the identity of servers, given that the IP can change eventually.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In this cases&#160;when&#160;executing Jobs with Parallelism set to 1, the SSL validations are good and the Jobmanager can communicate with Task manager and vice versa.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;But with parallelism set to more than 1, SSL validation fails when Task Managers communicate to each other as it seems to try to validate against IP address:&lt;/p&gt;


&lt;p&gt;Caused by: java.security.cert.CertificateException: No subject alternative names matching IP address 172.xx.xxx.xxx found&#160;&lt;br/&gt;
at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:168)&#160;&lt;br/&gt;
at sun.security.util.HostnameChecker.match(HostnameChecker.java:94)&#160;&lt;br/&gt;
at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:455)&#160;&lt;br/&gt;
at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:436)&#160;&lt;br/&gt;
at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:252)&#160;&lt;br/&gt;
at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:136)&#160;&lt;br/&gt;
at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1601)&#160;&lt;br/&gt;
... 21 more&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
From the logs,&#160;it seems the task managers register successfully its full address to Netty, but still the IP is used.&lt;br/&gt;
&#160;&lt;br/&gt;
Attached pertinent logs from JobManager and a TaskManager.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13148604">FLINK-9103</key>
            <summary>SSL verification on TaskManager when parallelism &gt; 1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edRojas">Edward Rojas</assignee>
                                    <reporter username="edRojas">Edward Rojas</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Mar 2018 15:15:22 +0000</created>
                <updated>Thu, 28 Feb 2019 11:31:27 +0000</updated>
                            <resolved>Fri, 13 Apr 2018 20:18:46 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.3</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>flink-docker</component>
                    <component>Runtime / Network</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16419213" author="githubbot" created="Thu, 29 Mar 2018 15:39:55 +0000"  >&lt;p&gt;GitHub user EAlexRojas opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5789&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9103&quot; title=&quot;SSL verification on TaskManager when parallelism &amp;gt; 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9103&quot;&gt;&lt;del&gt;FLINK-9103&lt;/del&gt;&lt;/a&gt; Using CanonicalHostName instead of IP for SSL connection on NettyClient&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This pull request makes the NettyClient use the CanonicalHostName instead of the IP address for SSL communication. That way dynamic environments like kubernetes can be fully supported as certificates with wildcard DNS can be used.&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use CanonicalHostName instead of HostNameAddress to identify the server on the NettyClient&lt;/li&gt;
&lt;/ul&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is already covered by existing tests, such as:&lt;/p&gt;

&lt;p&gt;    NettyClientServerSslTest (org.apache.flink.runtime.io.network.netty)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;testValidSslConnection&lt;/li&gt;
	&lt;li&gt;testSslHandshakeError&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Also manually verified the change by running a 4 node kubernetes cluster with 1 JobManagers and 3 TaskManagers, using wildcard DNS certificates and executing a stateful streaming program with parallelism set to 2 and verifying that all nodes are able to communicate to each other successfully. &lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency):  no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? not applicable&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/EAlexRojas/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/EAlexRojas/flink&lt;/a&gt; release-1.4&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5789.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5789.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5789&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 202672da7901fe7df912e6a057d6d0c29ccaf0fd&lt;br/&gt;
Author: EAlexRojas &amp;lt;alexrojas235@...&amp;gt;&lt;br/&gt;
Date:   2018-03-29T14:01:24Z&lt;/p&gt;

&lt;p&gt;    Using CanonicalHostName instead of IP for SSL coonection on NettyClient&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16437853" author="githubbot" created="Fri, 13 Apr 2018 20:17:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5789&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16437856" author="till.rohrmann" created="Fri, 13 Apr 2018 20:18:46 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
master: ffb03821ff118b0949d7d42d6b67312ee8732c2b&lt;br/&gt;
1.5.0: 688630c6432dd3318936613a3f657f7de475fce7&lt;br/&gt;
1.4.3: e76b10d07c657bcf3250ca08b5649c6a242bb01f&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12916633" name="job.log" size="20406" author="edRojas" created="Wed, 28 Mar 2018 15:14:27 +0000"/>
                            <attachment id="12916632" name="task0.log" size="114454" author="edRojas" created="Wed, 28 Mar 2018 15:14:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rwan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>