<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:19:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1793] Streaming File Source cannot be canceled</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1793</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The streaming WordCount gets stuck in the &quot;CANCELED&quot; state after it has been canceled using either the web interface or the command line interface.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12786161">FLINK-1793</key>
            <summary>Streaming File Source cannot be canceled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbalassi">M&#225;rton Balassi</assignee>
                                    <reporter username="mxm">Maximilian Michels</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Mar 2015 10:56:46 +0000</created>
                <updated>Thu, 28 Feb 2019 11:15:48 +0000</updated>
                            <resolved>Tue, 14 Apr 2015 22:05:21 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14383829" author="rmetzger" created="Fri, 27 Mar 2015 13:39:18 +0000"  >&lt;p&gt;How long did you wait after cancelling the Job?&lt;br/&gt;
With higher parallelism, this can take minutes &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14383850" author="mxm" created="Fri, 27 Mar 2015 13:48:23 +0000"  >&lt;p&gt;Some minutes. Can&apos;t give you an exact time period though. The parallelism was set to 20 in the experiments. 10 task managers with two task slots each.&lt;/p&gt;</comment>
                            <comment id="14383878" author="mbalassi" created="Fri, 27 Mar 2015 14:11:48 +0000"  >&lt;p&gt;Just cancelled a streaming job successfully after running it for 10 minutes on 10 taskmanagers. Cancellation took around 8-10 seconds in this case (the use case is the infamous chained mapper though).&lt;/p&gt;</comment>
                            <comment id="14485291" author="mxm" created="Wed, 8 Apr 2015 14:22:55 +0000"  >&lt;p&gt;My bad, they are cancelled eventually. It can take up to several minutes though.&lt;/p&gt;</comment>
                            <comment id="14485320" author="mxm" created="Wed, 8 Apr 2015 14:45:09 +0000"  >&lt;p&gt;Here&apos;s an example of a cancellation which takes 28 minutes:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(1/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(2/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(3/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(4/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(5/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(6/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(7/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(8/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(9/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(10/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(11/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(12/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(13/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(14/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(15/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(16/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(17/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(18/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(19/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	File Source -&amp;gt; Flat Map(20/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(1/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(2/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(3/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(4/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(5/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(6/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(7/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(8/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(9/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(10/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(11/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(12/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(13/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(14/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(15/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(16/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(17/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(18/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(19/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:17	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(20/20) switched to CANCELING 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(13/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(11/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(1/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(3/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(14/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(17/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(4/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(7/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(2/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(12/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(15/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(5/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(8/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(18/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(20/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(10/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(6/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(16/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(9/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:18	StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink(19/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:14:58	File Source -&amp;gt; Flat Map(1/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:15:05	File Source -&amp;gt; Flat Map(20/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:16:47	File Source -&amp;gt; Flat Map(15/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:18:17	File Source -&amp;gt; Flat Map(9/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:19:08	File Source -&amp;gt; Flat Map(5/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:19:10	File Source -&amp;gt; Flat Map(11/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:19:28	File Source -&amp;gt; Flat Map(19/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:20:43	File Source -&amp;gt; Flat Map(10/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:22:13	File Source -&amp;gt; Flat Map(3/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:22:36	File Source -&amp;gt; Flat Map(4/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:22:41	File Source -&amp;gt; Flat Map(14/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:24:22	File Source -&amp;gt; Flat Map(17/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:24:23	File Source -&amp;gt; Flat Map(7/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:27:53	File Source -&amp;gt; Flat Map(13/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:33:15	File Source -&amp;gt; Flat Map(18/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:35:57	File Source -&amp;gt; Flat Map(8/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:40:04	File Source -&amp;gt; Flat Map(16/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:40:22	File Source -&amp;gt; Flat Map(2/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:40:29	File Source -&amp;gt; Flat Map(12/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:42:16	File Source -&amp;gt; Flat Map(6/20) switched to CANCELED 
[104.155.72.196] out: 04/08/2015 14:42:16	Job execution switched to status CANCELED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14485339" author="stephanewen" created="Wed, 8 Apr 2015 14:55:41 +0000"  >&lt;p&gt;Okay, this looks like the source is actually not canceled, but just waits for the input to be finished... and then regularly exists...&lt;/p&gt;

&lt;p&gt;That is actually a real problem&lt;/p&gt;</comment>
                            <comment id="14485342" author="stephanewen" created="Wed, 8 Apr 2015 14:56:07 +0000"  >&lt;p&gt;Okay, this looks like the source is actually not canceled, but just waits for the input to be finished... and then regularly exists...&lt;/p&gt;</comment>
                            <comment id="14485355" author="mbalassi" created="Wed, 8 Apr 2015 15:03:42 +0000"  >&lt;p&gt;Ok, let me look into it.&lt;/p&gt;</comment>
                            <comment id="14485390" author="mxm" created="Wed, 8 Apr 2015 15:29:56 +0000"  >&lt;p&gt;Some more debug information. Upon cancellation on all TaskManagers:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;4:14:17,864 INFO  org.apache.flink.runtime.taskmanager.Task                     - File Source -&amp;gt; Flat Map (5/20) switched to CANCELING
14:14:17,867 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling File Source -&amp;gt; Flat Map (5/20) (6d97278384fa2cf2c4b7d2851844beea).
14:14:17,878 ERROR org.apache.flink.streaming.api.collector.StreamOutput         - Emit failed due to: java.lang.InterruptedException
        at java.lang.Object.wait(Native Method)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBuffer(LocalBufferPool.java:163)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBufferBlocking(LocalBufferPool.java:133)
        at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:91)
        at org.apache.flink.streaming.api.collector.StreamOutput.collect(StreamOutput.java:66)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:105)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:93)
        at org.apache.flink.streaming.api.invokable.operator.FlatMapInvokable.callUserFunction(FlatMapInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.ChainableInvokable.collect(ChainableInvokable.java:54)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.api.function.source.FileSourceFunction.run(FileSourceFunction.java:72)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.callUserFunction(SourceInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.invoke(SourceInvokable.java:37)
        at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:170)
        at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:217)
        at java.lang.Thread.run(Thread.java:745)

14:14:17,866 INFO  org.apache.flink.runtime.taskmanager.Task                     - File Source -&amp;gt; Flat Map (15/20) switched to CANCELING
14:14:17,870 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (15/20) switched to CANCELING
14:14:17,890 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling File Source -&amp;gt; Flat Map (15/20) (4ce2b555b5032ddd6404568e93147a51).
14:14:17,882 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (5/20) switched to CANCELING
14:14:17,925 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (5/20) (ba96dfac87ccb3669397425562f5d54d).
14:14:17,915 ERROR org.apache.flink.streaming.api.collector.StreamOutput         - Emit failed due to: java.lang.InterruptedException
        at java.lang.Object.wait(Native Method)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBuffer(LocalBufferPool.java:163)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBufferBlocking(LocalBufferPool.java:133)
        at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:91)
        at org.apache.flink.streaming.api.collector.StreamOutput.collect(StreamOutput.java:66)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:105)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:93)
        at org.apache.flink.streaming.api.invokable.operator.FlatMapInvokable.callUserFunction(FlatMapInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.ChainableInvokable.collect(ChainableInvokable.java:54)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.api.function.source.FileSourceFunction.run(FileSourceFunction.java:72)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.callUserFunction(SourceInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.invoke(SourceInvokable.java:37)
        at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:170)
        at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:217)
        at java.lang.Thread.run(Thread.java:745)

14:14:17,866 INFO  org.apache.flink.runtime.taskmanager.Task                     - File Source -&amp;gt; Flat Map (15/20) switched to CANCELING
14:14:17,870 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (15/20) switched to CANCELING
14:14:17,890 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling File Source -&amp;gt; Flat Map (15/20) (4ce2b555b5032ddd6404568e93147a51).
14:14:17,882 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (5/20) switched to CANCELING
14:14:17,925 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (5/20) (ba96dfac87ccb3669397425562f5d54d).
14:14:17,915 ERROR org.apache.flink.streaming.api.collector.StreamOutput         - Emit failed due to: java.lang.InterruptedException
        at java.lang.Object.wait(Native Method)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBuffer(LocalBufferPool.java:163)
        at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBufferBlocking(LocalBufferPool.java:133)
        at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:91)
        at org.apache.flink.streaming.api.collector.StreamOutput.collect(StreamOutput.java:66)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:105)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:93)
        at org.apache.flink.streaming.api.invokable.operator.FlatMapInvokable.callUserFunction(FlatMapInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.ChainableInvokable.collect(ChainableInvokable.java:54)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.api.function.source.FileSourceFunction.run(FileSourceFunction.java:72)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.callUserFunction(SourceInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.invoke(SourceInvokable.java:37)
        at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:170)
        at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:217)
        at java.lang.Thread.run(Thread.java:745)

14:14:17,915 INFO  org.apache.flink.runtime.execution.RuntimeEnvironment         - Canceling StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (15/20) (ef9e5c001e33e7e7f57436277e38a19c).
14:14:18,013 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (15/20) switched to CANCELED
14:14:18,020 INFO  org.apache.flink.runtime.taskmanager.Task                     - StreamDiscretizer -&amp;gt; SlidingCountGroupedPreReducer -&amp;gt; Window Flatten -&amp;gt; Stream Sink (5/20) switched to CANCELED
14:14:18,021 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Unregister task with execution ID ef9e5c001e33e7e7f57436277e38a19c.
14:14:18,126 ERROR org.apache.flink.streaming.api.collector.StreamOutput         - Emit failed due to: java.lang.NullPointerException
        at org.apache.flink.runtime.io.network.api.serialization.SpanningRecordSerializer.setNextBuffer(SpanningRecordSerializer.java:93)
        at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:92)
        at org.apache.flink.streaming.api.collector.StreamOutput.collect(StreamOutput.java:66)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:105)
        at org.apache.flink.streaming.examples.wordcount.WordCount$Tokenizer.flatMap(WordCount.java:93)
        at org.apache.flink.streaming.api.invokable.operator.FlatMapInvokable.callUserFunction(FlatMapInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.ChainableInvokable.collect(ChainableInvokable.java:54)
        at org.apache.flink.streaming.api.collector.CollectorWrapper.collect(CollectorWrapper.java:39)
        at org.apache.flink.streaming.api.function.source.FileSourceFunction.run(FileSourceFunction.java:72)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.callUserFunction(SourceInvokable.java:42)
        at org.apache.flink.streaming.api.invokable.StreamInvokable.callUserFunctionAndLogException(StreamInvokable.java:139)
        at org.apache.flink.streaming.api.invokable.SourceInvokable.invoke(SourceInvokable.java:37)
        at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:170)
        at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:217)
        at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After all tasks have thrown the InterruptedException, they throw NullPointerExceptions endlessly. In this case, they managed to produce 10GB of log data within half an hour..&lt;/p&gt;</comment>
                            <comment id="14486181" author="gyfora" created="Wed, 8 Apr 2015 22:13:53 +0000"  >&lt;p&gt;I pushed a fix to a bug in the file source cancelling logic here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/commit/62c465c30c75523ecaa57233a0119ddc3d80ed4a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/62c465c30c75523ecaa57233a0119ddc3d80ed4a&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think this should solve this issue completely, but I couldn&apos;t verify it at the moment. Marton said he will check it the next time you test it with the larger dataset.&lt;/p&gt;</comment>
                            <comment id="14487092" author="stephanewen" created="Thu, 9 Apr 2015 10:23:15 +0000"  >&lt;p&gt;Looks correct.&lt;/p&gt;

&lt;p&gt;Since thread existing can only be cooperative in Java (the run method has to want to exit), please make sure all driver loops in all operators have such checks. Otherwise the canceling hangs. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27g13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>