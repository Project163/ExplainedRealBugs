<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:07:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24806] RMQSourceITCase.testStopWithSavepoint and testAckFailure failed on azure due to connection error</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24806</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Nov 05 22:12:57 [INFO] Running org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase
Nov 05 22:13:18 [ERROR] Tests run: 3, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 20.921 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase
Nov 05 22:13:18 [ERROR] testStopWithSavepoint  Time elapsed: 3.39 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
Nov 05 22:13:18 java.io.IOException
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:129)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:125)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:396)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.recovery.RecoveryAwareAMQConnectionFactory.newConnection(RecoveryAwareAMQConnectionFactory.java:64)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.recovery.AutorecoveringConnection.init(AutorecoveringConnection.java:156)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1130)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1087)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1045)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1207)
Nov 05 22:13:18 	at org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase.getRMQConnection(RMQSourceITCase.java:203)
Nov 05 22:13:18 	at org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase.setUp(RMQSourceITCase.java:98)
Nov 05 22:13:18 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
Nov 05 22:13:18 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
Nov 05 22:13:18 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
Nov 05 22:13:18 	at java.lang.reflect.Method.invoke(Method.java:498)
Nov 05 22:13:18 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
Nov 05 22:13:18 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
Nov 05 22:13:18 
Nov 05 22:13:18 [ERROR] testAckFailure  Time elapsed: 1.842 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
Nov 05 22:13:18 java.io.IOException
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:129)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:125)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:396)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.recovery.RecoveryAwareAMQConnectionFactory.newConnection(RecoveryAwareAMQConnectionFactory.java:64)
Nov 05 22:13:18 	at com.rabbitmq.client.impl.recovery.AutorecoveringConnection.init(AutorecoveringConnection.java:156)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1130)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1087)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1045)
Nov 05 22:13:18 	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1207)
Nov 05 22:13:18 	at org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase.getRMQConnection(RMQSourceITCase.java:203)
Nov 05 22:13:18 	at org.apache.flink.streaming.connectors.rabbitmq.RMQSourceITCase.setUp(RMQSourceITCase.java:98)
Nov 05 22:13:18 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
Nov 05 22:13:18 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
Nov 05 22:13:18 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26065&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26065&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13478&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13410354">FLINK-24806</key>
            <summary>RMQSourceITCase.testStopWithSavepoint and testAckFailure failed on azure due to connection error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cmick">Micha&#322; Ciesielczyk</assignee>
                                    <reporter username="gaoyunhaii">Yun Gao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Sat, 6 Nov 2021 03:55:30 +0000</created>
                <updated>Wed, 15 Dec 2021 01:44:17 +0000</updated>
                            <resolved>Mon, 8 Nov 2021 10:47:00 +0000</resolved>
                                    <version>1.14.0</version>
                    <version>1.13.3</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.13.6</fixVersion>
                    <fixVersion>1.14.3</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Connectors/ RabbitMQ</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17439594" author="gaoyunhaii" created="Sat, 6 Nov 2021 04:01:57 +0000"  >&lt;p&gt;Also cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpaul&quot; class=&quot;user-hover&quot; rel=&quot;fpaul&quot;&gt;fpaul&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmick&quot; class=&quot;user-hover&quot; rel=&quot;cmick&quot;&gt;cmick&lt;/a&gt;&#160;for I saw you ever working on RabbitMQ related issues, is this problem similar to the previous timeout issues~?&lt;/p&gt;</comment>
                            <comment id="17439638" author="roman_khachatryan" created="Sat, 6 Nov 2021 09:59:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26072&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13479&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26072&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13479&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440024" author="gaoyunhaii" created="Sun, 7 Nov 2021 15:39:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=961f8f81-6b52-53df-09f6-7291a2e4af6a&amp;amp;t=f53023d8-92c3-5d78-ec7e-70c2bf37be20&amp;amp;l=13663&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=961f8f81-6b52-53df-09f6-7291a2e4af6a&amp;amp;t=f53023d8-92c3-5d78-ec7e-70c2bf37be20&amp;amp;l=13663&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440026" author="gaoyunhaii" created="Sun, 7 Nov 2021 15:40:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=e9af9cde-9a65-5281-a58e-2c8511d36983&amp;amp;t=c520d2c3-4d17-51f1-813b-4b0b74a0c307&amp;amp;l=13362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=e9af9cde-9a65-5281-a58e-2c8511d36983&amp;amp;t=c520d2c3-4d17-51f1-813b-4b0b74a0c307&amp;amp;l=13362&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440027" author="gaoyunhaii" created="Sun, 7 Nov 2021 15:40:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=c91190b6-40ae-57b2-5999-31b869b0a7c1&amp;amp;t=41463ccd-0694-5d4d-220d-8f771e7d098b&amp;amp;l=13478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26083&amp;amp;view=logs&amp;amp;j=c91190b6-40ae-57b2-5999-31b869b0a7c1&amp;amp;t=41463ccd-0694-5d4d-220d-8f771e7d098b&amp;amp;l=13478&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440140" author="cmick" created="Mon, 8 Nov 2021 01:48:59 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoyunhaii&quot; class=&quot;user-hover&quot; rel=&quot;gaoyunhaii&quot;&gt;gaoyunhaii&lt;/a&gt; , the issue reported here is caused by the RabbitMQ service not started before trying to connect to it (so I&apos;m not sure if this can be related to timeout issues).&lt;/p&gt;

&lt;p&gt;In the current code, we wait for the RMQ socket to be opened during the container startup (here: &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceITCase.java#L94&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceITCase.java#L94&lt;/a&gt; ). It seems, it is possible that the port is opened, but the RabbitMQ service has not started yet.&lt;/p&gt;

&lt;p&gt;To resolve it I would recommend to just remove this line.. If removed, it will use the default RabbitMQContainer wait strategy, which is to wait for a specific log message (&quot;Server startup complete&quot; to be specific).&#160;&lt;/p&gt;

&lt;p&gt;What do you think? Can I prepare a PR for this?&lt;/p&gt;</comment>
                            <comment id="17440254" author="till.rohrmann" created="Mon, 8 Nov 2021 07:52:57 +0000"  >&lt;p&gt;Another instance: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26093&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13479&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=26093&amp;amp;view=logs&amp;amp;j=d44f43ce-542c-597d-bf94-b0718c71e5e8&amp;amp;t=ed165f3f-d0f6-524b-5279-86f8ee7d0e2d&amp;amp;l=13479&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17440255" author="till.rohrmann" created="Mon, 8 Nov 2021 07:53:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cmick&quot; class=&quot;user-hover&quot; rel=&quot;cmick&quot;&gt;cmick&lt;/a&gt; sure. A fix will be highly appreciated by the community. I&apos;ll assign the ticket to you.&lt;/p&gt;</comment>
                            <comment id="17440398" author="till.rohrmann" created="Mon, 8 Nov 2021 10:47:00 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.15.0: dd3cf70ac8d167ee79c302c0c5f9183d58b6b0b4&lt;br/&gt;
1.14.1: b8810cc68969c2dc8dd51158d222650e76a3b56b&lt;br/&gt;
1.13.4: 8707347fb7ab300580791bb58e4d188f20db607a&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0whu8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>