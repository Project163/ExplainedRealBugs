<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:52:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-21158] wrong jvm metaspace and overhead size show in  taskmanager metric page</title>
                <link>https://issues.apache.org/jira/browse/FLINK-21158</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;the size of jvm metaspace and jvm overhead&#160; on taskmanager metrics page&#160; not the derived value from flink-conf.yaml&#160; but&lt;/p&gt;

&lt;p&gt;always&#160; be the default value.&lt;/p&gt;

&lt;p&gt;i used the defalut flink-conf.yaml&lt;/p&gt;

&lt;p&gt;default value:&#160;&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; &#160;JVM_METASPACE&#160;&#160;- 256M&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; &#160;JVM_OVERHEAD_MAX - 1GB&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019480/13019480_image-2021-01-27-16-30-51-834.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019479/13019479_image-2021-01-27-16-19-16-390.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13354841">FLINK-21158</key>
            <summary>wrong jvm metaspace and overhead size show in  taskmanager metric page</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pengkangjing">pengkangjing</assignee>
                                    <reporter username="pengkangjing">pengkangjing</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 27 Jan 2021 07:48:02 +0000</created>
                <updated>Thu, 28 Jan 2021 13:12:40 +0000</updated>
                            <resolved>Thu, 28 Jan 2021 13:12:40 +0000</resolved>
                                    <version>1.12.1</version>
                                    <fixVersion>1.12.2</fixVersion>
                    <fixVersion>1.13.0</fixVersion>
                                    <component>Runtime / Web Frontend</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="10800">3h</timeoriginalestimate>
                            <timeestimate seconds="10800">3h</timeestimate>
                                        <comments>
                            <comment id="17272658" author="rocmarshal" created="Wed, 27 Jan 2021 08:23:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Could you describe more information about this scene? Such as pictures, deployment modes, etc.&lt;/p&gt;</comment>
                            <comment id="17272674" author="pengkangjing" created="Wed, 27 Jan 2021 08:36:40 +0000"  >&lt;p&gt;i just uploaded two pics&#160; &#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt;.&#160;&#160;&lt;/p&gt;

&lt;p&gt;could you&#160;assigned it to me&#65311;&lt;/p&gt;</comment>
                            <comment id="17272695" author="rocmarshal" created="Wed, 27 Jan 2021 09:00:02 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;When I set the configuration-items like &apos;taskmanager.memory.jvm-metaspace.size: 500m&lt;br/&gt;
taskmanager.memory.jvm-overhead.max: 800m&apos; in ${FLINK_HOME}/conf/flink-conf.yaml with local standalonesession mode, the page of taskmanager-metric shown as the follows:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019486/13019486_image-2021-01-27-16-59-28-488.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;And&#160;I don&apos;t know your deployment mode now, so we need more deployment detail to confirm the cause of it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17272710" author="pengkangjing" created="Wed, 27 Jan 2021 09:34:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt; you can try to not&#160; set&#160; &#160;the value&#160;taskmanager.memory.jvm-metaspace.size: 500m and&#160;taskmanager.memory.jvm-overhead.max: 800m&#160; in flink-conf.yaml.&lt;/p&gt;

&lt;p&gt;&#160;then&#160; you can find&#160; in&#160; taskmanager&#160; log file&#160; &#160;like this:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019510/13019510_image-2021-01-27-18-31-07-616.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;but&#160; on flink ui&#160; is like this:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019496/13019496_image-2021-01-27-17-34-32-454.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17272713" author="rocmarshal" created="Wed, 27 Jan 2021 09:40:44 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17272718" author="rocmarshal" created="Wed, 27 Jan 2021 09:46:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt;&#160;This looks like jobmanager information&#65311;&lt;/p&gt;</comment>
                            <comment id="17272720" author="pengkangjing" created="Wed, 27 Jan 2021 09:49:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160; could you&#160;assigned it to me&#65311; i have been fixed it .&lt;/p&gt;</comment>
                            <comment id="17272721" author="pengkangjing" created="Wed, 27 Jan 2021 09:50:19 +0000"  >&lt;p&gt;only taskmanager&#160; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17272723" author="zentol" created="Wed, 27 Jan 2021 09:52:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt; We haven&apos;t even established what the issue is; so what exactly have you &quot;fixed&quot;?&lt;/p&gt;</comment>
                            <comment id="17272730" author="pengkangjing" created="Wed, 27 Jan 2021 10:00:59 +0000"  >&lt;p&gt;sorry , i have some idea to fix it .&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17272734" author="zentol" created="Wed, 27 Jan 2021 10:03:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt; Please outline your approach that. What are you going to change?&lt;/p&gt;</comment>
                            <comment id="17272741" author="pengkangjing" created="Wed, 27 Jan 2021 10:15:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;&#160; add&#160; the value&#160;derived from TaskExecutorProcessUtils.processSpecFromConfig&#160; to&#160; DynamicConfigsStr&#160;&#160;&lt;/p&gt;

&lt;p&gt;flink/flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/TaskExecutorProcessUtils&#160;&#160;&lt;/p&gt;

&lt;p&gt;just like this:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019508/13019508_image-2021-01-27-18-18-18-241.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &#160;&lt;/p&gt;</comment>
                            <comment id="17272743" author="rocmarshal" created="Wed, 27 Jan 2021 10:21:09 +0000"  >&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13019509/13019509_image-2021-01-27-18-19-31-121.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The one you want to post is this picture, right&#65311;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17272747" author="pengkangjing" created="Wed, 27 Jan 2021 10:25:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt;&#160; yes , only taskmanager ,&#160; i am sorry for that uoloaded some misleading picture.&#160;&lt;/p&gt;

&lt;p&gt;i will replace that misleading pic and edit the description again&lt;/p&gt;</comment>
                            <comment id="17272777" author="zentol" created="Wed, 27 Jan 2021 11:16:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xintongsong&quot; class=&quot;user-hover&quot; rel=&quot;xintongsong&quot;&gt;xintongsong&lt;/a&gt;&lt;font color=&quot;#172b4d&quot;&gt; What do you think about the proposed change? (adding &lt;tt&gt;JVM_OVERHEAD&lt;span class=&quot;error&quot;&gt;&amp;#91;_MIN/_MAX&amp;#93;&lt;/span&gt;&lt;/tt&gt; to &lt;tt&gt;TaskExecutorProcessUtils#generateDynamicConfigsStr&lt;/tt&gt;)&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17272790" author="xintongsong" created="Wed, 27 Jan 2021 11:33:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt; for reporting this, and thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; for looking into this.&lt;/p&gt;

&lt;p&gt;I think this is a valid problem. When implementing FLIP-49, we have not set derived jvm metaspace/overhead sizes via dynamic properties, due to the assumption that these values will not be used after the JVM process being launched. This assumption is no longer true since in FLIP-102 we start to display these configuration values on the web ui.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pengkangjing&quot; class=&quot;user-hover&quot; rel=&quot;pengkangjing&quot;&gt;pengkangjing&lt;/a&gt;, the changes you proposed look good to me. I&apos;ve assigned you to this ticket. Please go ahead.&lt;/p&gt;</comment>
                            <comment id="17272862" author="pengkangjing" created="Wed, 27 Jan 2021 13:41:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xintongsong&quot; class=&quot;user-hover&quot; rel=&quot;xintongsong&quot;&gt;xintongsong&lt;/a&gt;&#160;Thanks for assigned this work to me&#65292;and thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RocMarshal&quot; class=&quot;user-hover&quot; rel=&quot;RocMarshal&quot;&gt;RocMarshal&lt;/a&gt;&#160; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt;&#160; &#160;for&#160;discussing this issuse .&#160; I&apos;ve done it&#65292;the pull request link is &lt;a href=&quot;https://github.com/apache/flink/pull/14779&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/14779&lt;/a&gt;&#160;&#160;&lt;/p&gt;</comment>
                            <comment id="17273564" author="xintongsong" created="Thu, 28 Jan 2021 13:12:40 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master (1.13): 8ae563a2da0355596c11252dd8ffffefe8fbd564&lt;/li&gt;
	&lt;li&gt;release-1.12: fa06f4c8f7507a64be367f07e9299ee781cd0229&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="13019479" name="image-2021-01-27-16-19-16-390.png" size="892426" author="pengkangjing" created="Wed, 27 Jan 2021 08:19:23 +0000"/>
                            <attachment id="13019480" name="image-2021-01-27-16-30-51-834.png" size="872714" author="pengkangjing" created="Wed, 27 Jan 2021 08:30:54 +0000"/>
                            <attachment id="13019486" name="image-2021-01-27-16-59-28-488.png" size="216096" author="RocMarshal" created="Wed, 27 Jan 2021 08:59:29 +0000"/>
                            <attachment id="13019495" name="image-2021-01-27-17-33-25-300.png" size="1173644" author="pengkangjing" created="Wed, 27 Jan 2021 09:33:28 +0000"/>
                            <attachment id="13019496" name="image-2021-01-27-17-34-32-454.png" size="62544" author="pengkangjing" created="Wed, 27 Jan 2021 09:34:33 +0000"/>
                            <attachment id="13019505" name="image-2021-01-27-18-07-16-558.png" size="2429817" author="pengkangjing" created="Wed, 27 Jan 2021 10:07:19 +0000"/>
                            <attachment id="13019507" name="image-2021-01-27-18-17-01-917.png" size="1796295" author="pengkangjing" created="Wed, 27 Jan 2021 10:17:04 +0000"/>
                            <attachment id="13019508" name="image-2021-01-27-18-18-18-241.png" size="1609077" author="pengkangjing" created="Wed, 27 Jan 2021 10:18:20 +0000"/>
                            <attachment id="13019509" name="image-2021-01-27-18-19-31-121.png" size="749657" author="RocMarshal" created="Wed, 27 Jan 2021 10:19:33 +0000"/>
                            <attachment id="13019510" name="image-2021-01-27-18-31-07-616.png" size="1495388" author="pengkangjing" created="Wed, 27 Jan 2021 10:31:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0n13k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>