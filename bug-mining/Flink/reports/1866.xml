<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7082] Flip-6: Generic entry point for Flink sessions</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7082</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Implement a generic entry point for Flink sessions. This &lt;tt&gt;ClusterEntryPoint&lt;/tt&gt; has to start a &lt;tt&gt;ResourceManager&lt;/tt&gt;, the &lt;tt&gt;Dispatcher&lt;/tt&gt; component and the cluster&apos;s RESTful endpoint. This class could serve as the basis for a &lt;tt&gt;Mesos-&lt;/tt&gt; and &lt;tt&gt;YarnEntryPoint&lt;/tt&gt; to run Flink sessions.&lt;/p&gt;

&lt;p&gt;Maybe we can use a common base for the session and the per-job mode. The session has to start a dispatcher component and the per-job mode retrieves the &lt;tt&gt;JobGraph&lt;/tt&gt; and directly starts a &lt;tt&gt;JobManager&lt;/tt&gt; with this job.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13084367">FLINK-7082</key>
            <summary>Flip-6: Generic entry point for Flink sessions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>flip-6</label>
                    </labels>
                <created>Mon, 3 Jul 2017 22:40:58 +0000</created>
                <updated>Thu, 28 Feb 2019 14:12:52 +0000</updated>
                            <resolved>Wed, 26 Jul 2017 23:25:52 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16074757" author="githubbot" created="Wed, 5 Jul 2017 13:34:15 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7082&quot; title=&quot;Flip-6: Generic entry point for Flink sessions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7082&quot;&gt;&lt;del&gt;FLINK-7082&lt;/del&gt;&lt;/a&gt; Add generic entry point for session and per-job clusters&lt;/p&gt;

&lt;p&gt;    This PR is based on #4260 and #4259.&lt;/p&gt;

&lt;p&gt;    This PR introduces a generic entry point `ClusterEntrypoint` for Flink clusters. `ClusterEntrypoint` performs common operations like parsing command line options, loading the Flink configuration and setting up common services (e.g. `RPCService`).&lt;/p&gt;

&lt;p&gt;    The two sub classes `JobClusterEntrypoint` and `SessionClusterEntrypoint` are the specialization for the per-job and session mode. The former entrypoint spawns a `ResourceManager`, tries to retrieve the `JobGraph` and then launches a `JobManagerRunner` with the retrieved `JobGraph`. The latter starts a `ResourceManager` and the `Dispatcher` component in order to receive job submissions.&lt;/p&gt;

&lt;p&gt;    The PR also includes a specialization of the `SessionClusterEntrypoint` which is the `StandaloneSessionClusterEntrypoint`. This class simply spawns the `StandaloneResourceManager` for a standalone session cluster.&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; addClusterEntrypoint&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4261&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit cba1cb11a3eaaea3511120fa7864028a2c47e6a5&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-04T21:15:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7103&quot; title=&quot;Implement skeletal structure of dispatcher component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7103&quot;&gt;&lt;del&gt;FLINK-7103&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;dispatcher&amp;#93;&lt;/span&gt; Add skeletal structure of Dispatcher component&lt;/p&gt;

&lt;p&gt;    The Dispatcher is responsible for receiving job submissions, persisting the JobGraphs,&lt;br/&gt;
    spawning JobManager to execute the jobs and recovering the jobs in case of a master&lt;br/&gt;
    failure. This commit adds the basic skeleton including the RPC call for job submission.&lt;/p&gt;

&lt;p&gt;    Add cleanup logic for finished jobs&lt;/p&gt;

&lt;p&gt;    Pass BlobService to JobManagerRunner&lt;/p&gt;

&lt;p&gt;commit 476239fb52ef45926b0a28b97339158b8095bc3c&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-04T15:47:37Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7082&quot; title=&quot;Flip-6: Generic entry point for Flink sessions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7082&quot;&gt;&lt;del&gt;FLINK-7082&lt;/del&gt;&lt;/a&gt; Add generic entry point for session and per-job clusters&lt;/p&gt;

&lt;p&gt;commit 4c45f574d66cab076b7711696c0edbb485cb3cd4&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-05T11:38:35Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7105&quot; title=&quot;Make ActorSystem creation per default non-daemonic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7105&quot;&gt;&lt;del&gt;FLINK-7105&lt;/del&gt;&lt;/a&gt; Make ActorSystems non daemonic&lt;/p&gt;

&lt;p&gt;    In order to not having to explicitly wait on the termination of an ActorSystem&lt;br/&gt;
    in the main thread, we now create the ActorSystems in non-daemonic mode. That&lt;br/&gt;
    way the process won&apos;t terminate if there is still an active actor.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16092263" author="githubbot" created="Tue, 18 Jul 2017 22:11:26 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261#discussion_r128109508&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261#discussion_r128109508&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/entrypoint/ClusterEntrypoint.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,247 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.entrypoint;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.time.Time;&lt;br/&gt;
    +import org.apache.flink.api.java.utils.ParameterTool;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.configuration.GlobalConfiguration;&lt;br/&gt;
    +import org.apache.flink.configuration.JobManagerOptions;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.blob.BlobServer;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.BootstrapTools;&lt;br/&gt;
    +import org.apache.flink.runtime.heartbeat.HeartbeatServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServicesUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistry;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistryConfiguration;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.FatalErrorHandler;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.RpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.akka.AkkaRpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityContext;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityUtils;&lt;br/&gt;
    +import org.apache.flink.util.ExceptionUtils;&lt;br/&gt;
    +import org.apache.flink.util.FlinkException;&lt;br/&gt;
    +&lt;br/&gt;
    +import akka.actor.ActorSystem;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.concurrent.GuardedBy;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.concurrent.Callable;&lt;br/&gt;
    +import java.util.concurrent.Executor;&lt;br/&gt;
    +&lt;br/&gt;
    +import scala.concurrent.duration.FiniteDuration;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Base class for the Flink cluster entry points.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;Specialization of this class can be used for the session mode and the per-job mode&lt;br/&gt;
    + */&lt;br/&gt;
    +public abstract class ClusterEntrypoint implements FatalErrorHandler {&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final Logger LOG = LoggerFactory.getLogger(ClusterEntrypoint.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final int SUCCESS_RETURN_CODE = 0;&lt;br/&gt;
    +	protected static final int STARTUP_FAILURE_RETURN_CODE = 1;&lt;br/&gt;
    +	protected static final int RUNTIME_FAILURE_RETURN_CODE = 2;&lt;br/&gt;
    +&lt;br/&gt;
    +	/** The lock to guard startup / shutdown / manipulation methods. */&lt;br/&gt;
    +	private final Object lock = new Object();&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private MetricRegistry metricRegistry = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HighAvailabilityServices haServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private BlobServer blobServer = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HeartbeatServices heartbeatServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private RpcService commonRpcService = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	protected void startCluster(String[] args) {&lt;br/&gt;
    +		final ClusterConfiguration clusterConfiguration = parseArguments(args);&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration configuration = loadConfiguration(clusterConfiguration);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			SecurityContext securityContext = installSecurityContext(configuration);&lt;br/&gt;
    +&lt;br/&gt;
    +			securityContext.runSecured(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
    +				@Override&lt;br/&gt;
    +				public Void call() throws Exception &lt;/p&gt;
{
    +					runCluster(configuration);
    +
    +					return null;
    +				}
&lt;p&gt;    +			});&lt;br/&gt;
    +		} catch (Throwable t) {&lt;br/&gt;
    +			LOG.error(&quot;Cluster initialization failed.&quot;, t);&lt;br/&gt;
    +&lt;br/&gt;
    +			try &lt;/p&gt;
{
    +				shutDown(false);
    +			}
&lt;p&gt; catch (Throwable st) &lt;/p&gt;
{
    +				LOG.error(&quot;Could not properly shut down cluster entrypoint.&quot;, st);
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			System.exit(STARTUP_FAILURE_RETURN_CODE);&lt;br/&gt;
    +		}&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	protected ClusterConfiguration parseArguments(String[] args) &lt;/p&gt;
{
    +		ParameterTool parameterTool = ParameterTool.fromArgs(args);
    +
    +		final String configDir = parameterTool.get(&quot;configDir&quot;, &quot;&quot;);
    +
    +		return new ClusterConfiguration(configDir);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	protected Configuration loadConfiguration(ClusterConfiguration clusterConfiguration) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Consider supporting dynamic properties, e.g. `jobmanager.sh -Djobmanager.rpc.port=1234` to assist with YARN/Mesos scenarios, where adjusting the `flink-conf.yaml` might not be feasible.&lt;/p&gt;

&lt;p&gt;    As seen in `MesosTaskManagerRunner`:&lt;br/&gt;
    ```&lt;br/&gt;
    final Configuration dynamicProperties = BootstrapTools.parseDynamicProperties(cmd);&lt;br/&gt;
    GlobalConfiguration.setDynamicProperties(dynamicProperties);&lt;br/&gt;
    ```&lt;/p&gt;

</comment>
                            <comment id="16092347" author="githubbot" created="Tue, 18 Jul 2017 23:43:22 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looking at the various diagrams of FLIP-6, there&apos;s quite a few possible arrangements of the &apos;building blocks&apos;.   I wonder if composition over inheritance would be preferable as we develop the other modes.   Maybe an approach similar to traits &lt;span class=&quot;error&quot;&gt;&amp;#91;example&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://opencredo.com/traits-java-8-default-methods/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://opencredo.com/traits-java-8-default-methods/&lt;/a&gt;) to be mixed in to subclasses of `ClusterEntrypoint`.&lt;/p&gt;</comment>
                            <comment id="16101348" author="githubbot" created="Wed, 26 Jul 2017 08:45:42 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261#discussion_r129513928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261#discussion_r129513928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/entrypoint/ClusterEntrypoint.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,247 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.entrypoint;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.time.Time;&lt;br/&gt;
    +import org.apache.flink.api.java.utils.ParameterTool;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.configuration.GlobalConfiguration;&lt;br/&gt;
    +import org.apache.flink.configuration.JobManagerOptions;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.blob.BlobServer;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.BootstrapTools;&lt;br/&gt;
    +import org.apache.flink.runtime.heartbeat.HeartbeatServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServicesUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistry;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistryConfiguration;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.FatalErrorHandler;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.RpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.akka.AkkaRpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityContext;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityUtils;&lt;br/&gt;
    +import org.apache.flink.util.ExceptionUtils;&lt;br/&gt;
    +import org.apache.flink.util.FlinkException;&lt;br/&gt;
    +&lt;br/&gt;
    +import akka.actor.ActorSystem;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.concurrent.GuardedBy;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.concurrent.Callable;&lt;br/&gt;
    +import java.util.concurrent.Executor;&lt;br/&gt;
    +&lt;br/&gt;
    +import scala.concurrent.duration.FiniteDuration;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Base class for the Flink cluster entry points.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;Specialization of this class can be used for the session mode and the per-job mode&lt;br/&gt;
    + */&lt;br/&gt;
    +public abstract class ClusterEntrypoint implements FatalErrorHandler {&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final Logger LOG = LoggerFactory.getLogger(ClusterEntrypoint.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final int SUCCESS_RETURN_CODE = 0;&lt;br/&gt;
    +	protected static final int STARTUP_FAILURE_RETURN_CODE = 1;&lt;br/&gt;
    +	protected static final int RUNTIME_FAILURE_RETURN_CODE = 2;&lt;br/&gt;
    +&lt;br/&gt;
    +	/** The lock to guard startup / shutdown / manipulation methods. */&lt;br/&gt;
    +	private final Object lock = new Object();&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private MetricRegistry metricRegistry = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HighAvailabilityServices haServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private BlobServer blobServer = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HeartbeatServices heartbeatServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private RpcService commonRpcService = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	protected void startCluster(String[] args) {&lt;br/&gt;
    +		final ClusterConfiguration clusterConfiguration = parseArguments(args);&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration configuration = loadConfiguration(clusterConfiguration);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			SecurityContext securityContext = installSecurityContext(configuration);&lt;br/&gt;
    +&lt;br/&gt;
    +			securityContext.runSecured(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
    +				@Override&lt;br/&gt;
    +				public Void call() throws Exception &lt;/p&gt;
{
    +					runCluster(configuration);
    +
    +					return null;
    +				}
&lt;p&gt;    +			});&lt;br/&gt;
    +		} catch (Throwable t) {&lt;br/&gt;
    +			LOG.error(&quot;Cluster initialization failed.&quot;, t);&lt;br/&gt;
    +&lt;br/&gt;
    +			try &lt;/p&gt;
{
    +				shutDown(false);
    +			}
&lt;p&gt; catch (Throwable st) &lt;/p&gt;
{
    +				LOG.error(&quot;Could not properly shut down cluster entrypoint.&quot;, st);
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			System.exit(STARTUP_FAILURE_RETURN_CODE);&lt;br/&gt;
    +		}&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	protected ClusterConfiguration parseArguments(String[] args) &lt;/p&gt;
{
    +		ParameterTool parameterTool = ParameterTool.fromArgs(args);
    +
    +		final String configDir = parameterTool.get(&quot;configDir&quot;, &quot;&quot;);
    +
    +		return new ClusterConfiguration(configDir);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	protected Configuration loadConfiguration(ClusterConfiguration clusterConfiguration) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes we should add support for dynamic properties. We can add the parsed dynamic properties after we have loaded the configuration. I would like to do it as a follow up because I would also like to change the usage of static fields in `GlobalConfiguration`.&lt;/p&gt;</comment>
                            <comment id="16101380" author="githubbot" created="Wed, 26 Jul 2017 08:57:52 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    You&apos;re totally right about the current problem with inheritance when having multiple dimensions (job vs. session, yarn vs. standalone. vs Mesos). I&apos;ve looked at the link you&apos;ve posted and it looks really interesting. Once we have ditched Java 7 support, we can change the code to use this technique in order to reduce code duplication.&lt;/p&gt;</comment>
                            <comment id="16101400" author="githubbot" created="Wed, 26 Jul 2017 09:12:14 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261#discussion_r129519933&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261#discussion_r129519933&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/entrypoint/ClusterEntrypoint.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,247 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.entrypoint;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.time.Time;&lt;br/&gt;
    +import org.apache.flink.api.java.utils.ParameterTool;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.configuration.GlobalConfiguration;&lt;br/&gt;
    +import org.apache.flink.configuration.JobManagerOptions;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.blob.BlobServer;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.BootstrapTools;&lt;br/&gt;
    +import org.apache.flink.runtime.heartbeat.HeartbeatServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServices;&lt;br/&gt;
    +import org.apache.flink.runtime.highavailability.HighAvailabilityServicesUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistry;&lt;br/&gt;
    +import org.apache.flink.runtime.metrics.MetricRegistryConfiguration;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.FatalErrorHandler;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.RpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.rpc.akka.AkkaRpcService;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityContext;&lt;br/&gt;
    +import org.apache.flink.runtime.security.SecurityUtils;&lt;br/&gt;
    +import org.apache.flink.util.ExceptionUtils;&lt;br/&gt;
    +import org.apache.flink.util.FlinkException;&lt;br/&gt;
    +&lt;br/&gt;
    +import akka.actor.ActorSystem;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.concurrent.GuardedBy;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.concurrent.Callable;&lt;br/&gt;
    +import java.util.concurrent.Executor;&lt;br/&gt;
    +&lt;br/&gt;
    +import scala.concurrent.duration.FiniteDuration;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Base class for the Flink cluster entry points.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;Specialization of this class can be used for the session mode and the per-job mode&lt;br/&gt;
    + */&lt;br/&gt;
    +public abstract class ClusterEntrypoint implements FatalErrorHandler {&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final Logger LOG = LoggerFactory.getLogger(ClusterEntrypoint.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final int SUCCESS_RETURN_CODE = 0;&lt;br/&gt;
    +	protected static final int STARTUP_FAILURE_RETURN_CODE = 1;&lt;br/&gt;
    +	protected static final int RUNTIME_FAILURE_RETURN_CODE = 2;&lt;br/&gt;
    +&lt;br/&gt;
    +	/** The lock to guard startup / shutdown / manipulation methods. */&lt;br/&gt;
    +	private final Object lock = new Object();&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private MetricRegistry metricRegistry = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HighAvailabilityServices haServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private BlobServer blobServer = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private HeartbeatServices heartbeatServices = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	@GuardedBy(&quot;lock&quot;)&lt;br/&gt;
    +	private RpcService commonRpcService = null;&lt;br/&gt;
    +&lt;br/&gt;
    +	protected void startCluster(String[] args) {&lt;br/&gt;
    +		final ClusterConfiguration clusterConfiguration = parseArguments(args);&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration configuration = loadConfiguration(clusterConfiguration);&lt;br/&gt;
    +&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			SecurityContext securityContext = installSecurityContext(configuration);&lt;br/&gt;
    +&lt;br/&gt;
    +			securityContext.runSecured(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
    +				@Override&lt;br/&gt;
    +				public Void call() throws Exception &lt;/p&gt;
{
    +					runCluster(configuration);
    +
    +					return null;
    +				}
&lt;p&gt;    +			});&lt;br/&gt;
    +		} catch (Throwable t) {&lt;br/&gt;
    +			LOG.error(&quot;Cluster initialization failed.&quot;, t);&lt;br/&gt;
    +&lt;br/&gt;
    +			try &lt;/p&gt;
{
    +				shutDown(false);
    +			}
&lt;p&gt; catch (Throwable st) &lt;/p&gt;
{
    +				LOG.error(&quot;Could not properly shut down cluster entrypoint.&quot;, st);
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			System.exit(STARTUP_FAILURE_RETURN_CODE);&lt;br/&gt;
    +		}&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	protected ClusterConfiguration parseArguments(String[] args) &lt;/p&gt;
{
    +		ParameterTool parameterTool = ParameterTool.fromArgs(args);
    +
    +		final String configDir = parameterTool.get(&quot;configDir&quot;, &quot;&quot;);
    +
    +		return new ClusterConfiguration(configDir);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	protected Configuration loadConfiguration(ClusterConfiguration clusterConfiguration) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Follow-up JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7270&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-7270&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16101411" author="githubbot" created="Wed, 26 Jul 2017 09:17:13 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @EronWright. We&apos;ll address your comments with a follow up. I&apos;ll rebase this PR and if Travis gives green light, then I&apos;ll merge it.&lt;/p&gt;</comment>
                            <comment id="16101880" author="githubbot" created="Wed, 26 Jul 2017 16:29:28 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4261&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16102453" author="till.rohrmann" created="Wed, 26 Jul 2017 23:25:52 +0000"  >&lt;p&gt;Added via e08ebce906a0a8b05e728c8d3c275433f52788b9&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="13014916">FLINK-4897</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="13084419">FLINK-7086</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13090147">FLINK-7270</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h1tb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>