<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:47:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-18076] Sql client uses wrong class loader when parsing queries</title>
                <link>https://issues.apache.org/jira/browse/FLINK-18076</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Sql-client when parsing queries does not use the user class loader from &lt;tt&gt;ExecutionContext&lt;/tt&gt;. This makes it impossible to query any sources if the dependencies are added with &lt;tt&gt;-j&lt;/tt&gt; flag.&lt;/p&gt;

&lt;p&gt;In order to reproduce it try querying e.g. KafkaDynamicSource with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE TABLE MyUserTable (
   f0 BIGINT
) WITH (
  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;,       

  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;topic_name&apos;&lt;/span&gt;, -- required: topic name from which the table is read

 -- required: specify the Kafka server connection string
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
  -- required &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Kafka source, optional &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Kafka sink, specify consumer group
  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.group.id&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;testGroup&apos;&lt;/span&gt;,
  -- optional: valid modes are &lt;span class=&quot;code-quote&quot;&gt;&quot;earliest-offset&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;latest-offset&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;group-offsets&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;specific-offsets&quot;&lt;/span&gt; or &lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;scan.startup.mode&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;earliest-offset&apos;&lt;/span&gt;,

   &lt;span class=&quot;code-quote&quot;&gt;&apos;format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;avro&apos;&lt;/span&gt;
);


SELECT * FROM MyUserTable;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It give exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.flink.table.client.SqlClientException: Unexpected exception. This is a bug. Please consider filing an issue.
	at org.apache.flink.table.client.SqlClient.main(SqlClient.java:213)
Caused by: org.apache.flink.table.client.gateway.SqlExecutionException: Invalidate SQL statement.
	at org.apache.flink.table.client.cli.SqlCommandParser.parseBySqlParser(SqlCommandParser.java:95)
	at org.apache.flink.table.client.cli.SqlCommandParser.parse(SqlCommandParser.java:79)
	at org.apache.flink.table.client.cli.CliClient.parseCommand(CliClient.java:256)
	at org.apache.flink.table.client.cli.CliClient.open(CliClient.java:212)
	at org.apache.flink.table.client.SqlClient.openCli(SqlClient.java:142)
	at org.apache.flink.table.client.SqlClient.start(SqlClient.java:114)
	at org.apache.flink.table.client.SqlClient.main(SqlClient.java:201)
Caused by: org.apache.flink.table.api.ValidationException: Unable to create a source &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reading table &lt;span class=&quot;code-quote&quot;&gt;&apos;default_catalog.default_database.MyUserTable&apos;&lt;/span&gt;.

Table options are:

&lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;format&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;avro&apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;properties.group.id&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;testGroup&apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;scan.startup.mode&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;earliest-offset&apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;topic_name&apos;&lt;/span&gt;
	at org.apache.flink.table.factories.FactoryUtil.createTableSource(FactoryUtil.java:125)
	at org.apache.flink.table.planner.plan.schema.CatalogSourceTable.buildTableScan(CatalogSourceTable.scala:135)
	at org.apache.flink.table.planner.plan.schema.CatalogSourceTable.toRel(CatalogSourceTable.scala:78)
	at org.apache.calcite.sql2rel.SqlToRelConverter.toRel(SqlToRelConverter.java:3492)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertIdentifier(SqlToRelConverter.java:2415)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2102)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2051)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertSelectImpl(SqlToRelConverter.java:661)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertSelect(SqlToRelConverter.java:642)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertQueryRecursive(SqlToRelConverter.java:3345)
	at org.apache.calcite.sql2rel.SqlToRelConverter.convertQuery(SqlToRelConverter.java:568)
	at org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$rel(FlinkPlannerImpl.scala:164)
	at org.apache.flink.table.planner.calcite.FlinkPlannerImpl.rel(FlinkPlannerImpl.scala:151)
	at org.apache.flink.table.planner.operations.SqlToOperationConverter.toQueryOperation(SqlToOperationConverter.java:773)
	at org.apache.flink.table.planner.operations.SqlToOperationConverter.convertSqlQuery(SqlToOperationConverter.java:745)
	at org.apache.flink.table.planner.operations.SqlToOperationConverter.convert(SqlToOperationConverter.java:238)
	at org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:66)
	at org.apache.flink.table.client.cli.SqlCommandParser.parseBySqlParser(SqlCommandParser.java:90)
	... 6 more
Caused by: org.apache.flink.table.api.ValidationException: Cannot discover a connector using option &lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;connector&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;&apos;.
	at org.apache.flink.table.factories.FactoryUtil.getDynamicTableFactory(FactoryUtil.java:329)
	at org.apache.flink.table.factories.FactoryUtil.createTableSource(FactoryUtil.java:118)
	... 23 more
Caused by: org.apache.flink.table.api.ValidationException: Could not find any factory &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; identifier &lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt; that &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.flink.table.factories.DynamicTableSourceFactory&apos;&lt;/span&gt; in the classpath.

Available factory identifiers are:

datagen
	at org.apache.flink.table.factories.FactoryUtil.discoverFactory(FactoryUtil.java:240)
	at org.apache.flink.table.factories.FactoryUtil.getDynamicTableFactory(FactoryUtil.java:326)
	... 24 more

Shutting down the session...
done.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because the factories are present only in the user classloader.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13309048">FLINK-18076</key>
            <summary>Sql client uses wrong class loader when parsing queries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leonard">Leonard Xu</assignee>
                                    <reporter username="dwysakowicz">Dawid Wysakowicz</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 2 Jun 2020 21:09:06 +0000</created>
                <updated>Fri, 5 Jun 2020 12:18:10 +0000</updated>
                            <resolved>Fri, 5 Jun 2020 12:18:10 +0000</resolved>
                                    <version>1.11.0</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17124547" author="jark" created="Wed, 3 Jun 2020 02:55:05 +0000"  >&lt;p&gt;From the recently bug issues, it seems that it&apos;s urgent to add end-to-end tests for the new connectors and new DDLs. &lt;/p&gt;</comment>
                            <comment id="17125650" author="dawidwys" created="Thu, 4 Jun 2020 07:53:16 +0000"  >&lt;p&gt;I will review the issue. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt; could you move the issue to in progress?&lt;/p&gt;</comment>
                            <comment id="17125668" author="leonard xu" created="Thu, 4 Jun 2020 08:07:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;&#160;sure, thanks.&lt;/p&gt;</comment>
                            <comment id="17126298" author="apche-px" created="Fri, 5 Jun 2020 01:06:28 +0000"  >&lt;p&gt;Yes&#160; ! Urgent requirements&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17126721" author="dawidwys" created="Fri, 5 Jun 2020 12:18:10 +0000"  >&lt;p&gt;Fixed in:&lt;br/&gt;
master: 61e6f70dba3e724c479b8cd7753b314ebb1d5517&lt;br/&gt;
1.11: e7902bb4d1329833870ee53c782c6431cfc8cb80&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ffw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>