<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:43:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15552] parameters --library and --jar doesn&apos;t work for DDL in sqlClient</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15552</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;How to Reproduce:&lt;br/&gt;
first, I start a sql client and using `-l` to point to a kafka connector directory.&lt;/p&gt;

&lt;p&gt;`&lt;br/&gt;
 bin/sql-client.sh embedded -l /xx/connectors/kafka/&lt;/p&gt;

&lt;p&gt;`&lt;/p&gt;

&lt;p&gt;Then, I create a Kafka Table like following &lt;br/&gt;
`&lt;br/&gt;
Flink SQL&amp;gt; CREATE TABLE MyUserTable (&lt;br/&gt;
&amp;gt;   content String&lt;br/&gt;
&amp;gt; ) WITH (&lt;br/&gt;
&amp;gt;   &apos;connector.type&apos; = &apos;kafka&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.version&apos; = &apos;universal&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.topic&apos; = &apos;test&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.properties.zookeeper.connect&apos; = &apos;localhost:2181&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.properties.bootstrap.servers&apos; = &apos;localhost:9092&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.properties.group.id&apos; = &apos;testGroup&apos;,&lt;br/&gt;
&amp;gt;   &apos;connector.startup-mode&apos; = &apos;earliest-offset&apos;,&lt;br/&gt;
&amp;gt;   &apos;format.type&apos; = &apos;csv&apos;&lt;br/&gt;
&amp;gt;  );&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Table has been created.&lt;br/&gt;
`&lt;/p&gt;

&lt;p&gt;Then I select from just created table and an exception been thrown: &lt;/p&gt;

&lt;p&gt;`&lt;br/&gt;
Flink SQL&amp;gt; select * from MyUserTable;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Could not execute SQL statement. Reason:&lt;br/&gt;
org.apache.flink.table.api.NoMatchingTableFactoryException: Could not find a suitable table factory for &apos;org.apache.flink.table.factories.TableSourceFactory&apos; in&lt;br/&gt;
the classpath.&lt;/p&gt;

&lt;p&gt;Reason: Required context properties mismatch.&lt;/p&gt;

&lt;p&gt;The matching candidates:&lt;br/&gt;
org.apache.flink.table.sources.CsvBatchTableSourceFactory&lt;br/&gt;
Mismatched properties:&lt;br/&gt;
&apos;connector.type&apos; expects &apos;filesystem&apos;, but is &apos;kafka&apos;&lt;/p&gt;

&lt;p&gt;The following properties are requested:&lt;br/&gt;
connector.properties.bootstrap.servers=localhost:9092&lt;br/&gt;
connector.properties.group.id=testGroup&lt;br/&gt;
connector.properties.zookeeper.connect=localhost:2181&lt;br/&gt;
connector.startup-mode=earliest-offset&lt;br/&gt;
connector.topic=test&lt;br/&gt;
connector.type=kafka&lt;br/&gt;
connector.version=universal&lt;br/&gt;
format.type=csv&lt;br/&gt;
schema.0.data-type=VARCHAR(2147483647)&lt;br/&gt;
schema.0.name=content&lt;/p&gt;

&lt;p&gt;The following factories have been considered:&lt;br/&gt;
org.apache.flink.table.sources.CsvBatchTableSourceFactory&lt;br/&gt;
org.apache.flink.table.sources.CsvAppendTableSourceFactory&lt;br/&gt;
`&lt;br/&gt;
Potential Reasons:&lt;br/&gt;
Now we use  `TableFactoryUtil#findAndCreateTableSource`  to convert a CatalogTable to TableSource,  but when call `TableFactoryService.find` we don&apos;t pass current classLoader to this method, the default loader will be BootStrapClassLoader, which can not find our factory.&lt;/p&gt;

&lt;p&gt;I verified in my box, it&apos;s truly caused by this behavior.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13278706">FLINK-15552</key>
            <summary>parameters --library and --jar doesn&apos;t work for DDL in sqlClient</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leonard">Leonard Xu</assignee>
                                    <reporter username="Terry1897">Terry Wang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 10 Jan 2020 12:45:16 +0000</created>
                <updated>Tue, 11 Feb 2020 10:30:28 +0000</updated>
                            <resolved>Thu, 23 Jan 2020 12:59:38 +0000</resolved>
                                                    <fixVersion>1.10.0</fixVersion>
                                    <component>Table SQL / Client</component>
                    <component>Table SQL / Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17014069" author="jark" created="Mon, 13 Jan 2020 07:06:43 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Terry1897&quot; class=&quot;user-hover&quot; rel=&quot;Terry1897&quot;&gt;Terry1897&lt;/a&gt;, are you sure there is kafka sql jar under &lt;tt&gt;/xx/connectors/kafka/&lt;/tt&gt; ? Because AFAIK, SQL CLI e2e tests also uses --library and --jars to test. &lt;/p&gt;</comment>
                            <comment id="17014903" author="terry1897" created="Tue, 14 Jan 2020 07:28:43 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;.  I&apos;m sure about it. As for SQL CLI e2e tests, maybe there is kafka jar under /lib directory.&lt;/p&gt;</comment>
                            <comment id="17014944" author="leonard xu" created="Tue, 14 Jan 2020 08:59:30 +0000"  >&lt;p&gt;I reproduce this too. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Terry1897&quot; class=&quot;user-hover&quot; rel=&quot;Terry1897&quot;&gt;Terry1897&lt;/a&gt; &lt;br/&gt;
 &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&#160;Do we have some SQL CLI e2e test before&#65311;I had some e2e tests about Table sources/sinks/computed-column in local by maven project which is different with this.&lt;/p&gt;</comment>
                            <comment id="17015072" author="jark" created="Tue, 14 Jan 2020 13:07:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt; you can see &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-end-to-end-tests/test-scripts/test_sql_client_kafka011.sh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-end-to-end-tests/test-scripts/test_sql_client_kafka011.sh&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17016775" author="leonard xu" created="Thu, 16 Jan 2020 10:02:01 +0000"  >&lt;p&gt;Hi,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Terry1897&quot; class=&quot;user-hover&quot; rel=&quot;Terry1897&quot;&gt;Terry1897&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;e2e test &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-end-to-end-tests/test-scripts/test_sql_client_kafka011.sh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;test_sql_client_kafka011.sh&lt;/a&gt;&#160;can run normally because it defines Kafka source Table in YAML way as environment file&#160; which will create when SqlClient start , and it will use FlinkUserCodeClassLoaders#ParentFirstClassLoader, so TableFactoryService#find() can find correct KafkaTableSource class from user defined jars(like flink-sql-connector-kafka-0.11_2.11-1.10-SNAPSHOT.jar) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//ExecutionContext.java
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// create &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;loader and load user defined jars
&lt;/span&gt;classLoader = FlinkUserCodeClassLoaders.parentFirst(
      dependencies.toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URL[dependencies.size()]),
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getClassLoader());

&lt;span class=&quot;code-comment&quot;&gt;//create table soure 
&lt;/span&gt;
environment.getTables().forEach((name, entry) -&amp;gt; {
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; SourceTableEntry || entry &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; SourceSinkTableEntry) {
      tableSources.put(name, createTableSource(environment.getExecution(), entry.asMap(), classLoader));
   }
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; SinkTableEntry || entry &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; SourceSinkTableEntry) {
      tableSinks.put(name, createTableSink(environment.getExecution(), entry.asMap(), classLoader));
   }
});
});
&lt;span class=&quot;code-comment&quot;&gt;// register table sources
&lt;/span&gt;tableSources.forEach(tableEnv::registerTableSource);
....
&lt;span class=&quot;code-comment&quot;&gt;// use  FlinkUserCodeClassLoaders#ParentFirstClassLoader here
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; TableSource&amp;lt;?&amp;gt; createTableSource(ExecutionEntry execution, Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; sourceProperties, &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt; classLoader) {
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (execution.isStreamingPlanner()) {
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; TableSourceFactory&amp;lt;?&amp;gt; factory = (TableSourceFactory&amp;lt;?&amp;gt;)
         TableFactoryService.find(TableSourceFactory.class, sourceProperties, classLoader);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; factory.createTableSource(sourceProperties);
   } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (execution.isBatchPlanner()) {
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BatchTableSourceFactory&amp;lt;?&amp;gt; factory = (BatchTableSourceFactory&amp;lt;?&amp;gt;)
         TableFactoryService.find(BatchTableSourceFactory.class, sourceProperties, classLoader);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; factory.createBatchTableSource(sourceProperties);
   }
   &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SqlExecutionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unsupported execution type &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; sources.&quot;&lt;/span&gt;);
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;when we define a Kafka source/sink table in cli way,&#160; DDL sql will translate to tEnv.sqlUpdate(ddl), this will not throw exception right now because&#160; tEnv.sqlUpdate() is executing lazily. when we input&#160; `select * from kafkaTable`,&#160;&#160;tEnv will create kafkaTable and execute the query by:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//LocalExecutor.java 
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// create table
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Table table = createTable(context, context.getTableEnvironment(), query);
...
/**
 * Creates a table using the given query in the given table environment.
 */
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &amp;lt;C&amp;gt; Table createTable(ExecutionContext&amp;lt;C&amp;gt; context, TableEnvironment tableEnv, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; selectQuery) {
   &lt;span class=&quot;code-comment&quot;&gt;// parse and validate query
&lt;/span&gt;   &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; context.wrapClassLoader(() -&amp;gt; tableEnv.sqlQuery(selectQuery));
   } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable t) {
      &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; everything such that the query does not crash the executor
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SqlExecutionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Invalid SQL statement.&quot;&lt;/span&gt;, t);
   }
}

...
&lt;span class=&quot;code-comment&quot;&gt;//DatabaseCalciteSchema.java
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Table convertCatalogTable(ObjectPath tablePath, CatalogTable table, @Nullable TableFactory tableFactory) {
   &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; TableSource&amp;lt;?&amp;gt; tableSource;
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tableFactory != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tableFactory &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; TableSourceFactory) {
         tableSource = ((TableSourceFactory) tableFactory).createTableSource(tablePath, table);
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
         &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TableException(
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot query a sink-only table. TableFactory provided by catalog must implement TableSourceFactory&quot;&lt;/span&gt;);
      }
   } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      tableSource = TableFactoryUtil.findAndCreateTableSource(table);
   }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;there are no `classLoader` parameter in&#160;TableFactoryUtil#findAndCreateTableSource(table) , and&#160;TableFactoryUtil will use its default classLoader&#160; which can not load KafkaTableSource class from use defined jars(like flink-sql-connector-kafka-0.11_2.11-1.10-SNAPSHOT.jar).&#160;&lt;/p&gt;

&lt;p&gt;Do you have any suggestion to fix this ?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17016853" author="jark" created="Thu, 16 Jan 2020 12:20:52 +0000"  >&lt;p&gt;Thanks for the investigation &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt;. I got it. The reason why e2e works is because it uses YAML which uses the correct classloader in SQL CLI.&lt;br/&gt;
 However, the classloader is not correctly if it is registered via DDL. So problem is &lt;tt&gt;--library&lt;/tt&gt; doesn&apos;t work for DDL.&lt;/p&gt;

&lt;p&gt;The fixing might be simple, we should use current classloader when &lt;tt&gt;TableFactoryUtil#findAndCreateTableSource(table)&lt;/tt&gt; which contains the user&apos;s jars.&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17016868" author="twalthr" created="Thu, 16 Jan 2020 12:29:13 +0000"  >&lt;p&gt;Whenever we run the optimizer we need to make sure that we set the context class loader. There is a &lt;tt&gt;wrapClassloader&lt;/tt&gt; utility for doing this. &lt;tt&gt;findAndCreateTableSource&lt;/tt&gt; might also has a method for setting the classloader explicitly.&lt;/p&gt;</comment>
                            <comment id="17016989" author="leonard xu" created="Thu, 16 Jan 2020 14:35:38 +0000"  >&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I fix and test it in my local environment and test e2e SQL test too, I will file a PR soon, cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Flink SQL&amp;gt; CREATE TABLE orders (
&amp;gt; order_id STRING,
&amp;gt; item    STRING,
&amp;gt; currency STRING,
&amp;gt; amount INT,
&amp;gt; order_time TIMESTAMP(3),
&amp;gt; proc_time as PROCTIME(),
&amp;gt; amount_kg as amount * 1000,
&amp;gt; ts as order_time + INTERVAL &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt; SECOND,
&amp;gt; WATERMARK FOR order_time AS order_time
&amp;gt; ) WITH (
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.type&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.version&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;0.10&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;flink_orders3&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.properties.zookeeper.connect&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:2181&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:9092&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.properties.group.id&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;testGroup3&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector.startup-mode&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;earliest-offset&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;format.type&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;,
&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;format.derive-schema&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;
&amp;gt; );
[INFO] Table has been created.Flink 
SQL&amp;gt; select order_id,item from orders;
[INFO] Result retrieval cancelled.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2020-01-16T22:29:57,039][INFO ][o.e.c.m.MetaDataDeleteIndexService] [zjSoRnz] [my_users/RiFewmsDQ62pwkp8blJ7ug] deleting index
{&lt;span class=&quot;code-quote&quot;&gt;&quot;acknowledged&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;}Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; errors...
No errors in log files.
Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; exceptions...
No exceptions in log files.
Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; non-empty .out files...
No non-empty .out files.
[PASS] &lt;span class=&quot;code-quote&quot;&gt;&apos;flink-end-to-end-tests/test-scripts/test_sql_client.sh&apos;&lt;/span&gt; passed after 2 minutes and 47 seconds! Test exited with exit code 0.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17017642" author="lzljs3620320" created="Fri, 17 Jan 2020 01:50:09 +0000"  >&lt;p&gt;It looks like there are so many calling for &lt;tt&gt;tableEnv&lt;/tt&gt;. They are dangerous. We don&apos;t know if we will depend on user jar in the future. So I suggest adding &lt;tt&gt;wrapClassLoader&lt;/tt&gt; all.&lt;/p&gt;</comment>
                            <comment id="17017643" author="lzljs3620320" created="Fri, 17 Jan 2020 01:51:14 +0000"  >&lt;p&gt;BTW, it is not the first time of classloader problem, see&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15167&quot; title=&quot;SQL CLI library option doesn&amp;#39;t work for Hive connector&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15167&quot;&gt;&lt;del&gt;FLINK-15167&lt;/del&gt;&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="17017649" author="jark" created="Fri, 17 Jan 2020 02:00:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt; we are calling &lt;tt&gt;wrapClassLoader&lt;/tt&gt; already right. The problem is in &lt;tt&gt;org.apache.flink.table.factories.TableFactoryService#discoverFactories&lt;/tt&gt; which doesn&apos;t use thread&apos;s context class loader. &lt;/p&gt;</comment>
                            <comment id="17017658" author="lzljs3620320" created="Fri, 17 Jan 2020 02:22:04 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;, I see,&#160;we are calling&#160;&lt;tt&gt;wrapClassLoader&lt;/tt&gt;&#160;in &lt;tt&gt;sqlQuery&lt;/tt&gt;&#160;already right.&lt;/p&gt;

&lt;p&gt;But I am talking about the other invokings, we have discussed in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15509&quot; title=&quot;Use sql cilents create view occur Unexpected exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15509&quot;&gt;&lt;del&gt;FLINK-15509&lt;/del&gt;&lt;/a&gt; , we are considering to validate/create source/sink in &lt;tt&gt;sqlUpdate(DDL)&lt;/tt&gt;. We can do more things to ensure safety.&lt;/p&gt;</comment>
                            <comment id="17017941" author="twalthr" created="Fri, 17 Jan 2020 12:08:47 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15635&quot; title=&quot;Allow passing a ClassLoader to EnvironmentSettings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15635&quot;&gt;&lt;del&gt;FLINK-15635&lt;/del&gt;&lt;/a&gt; for the long-term fix.&lt;/p&gt;</comment>
                            <comment id="17022059" author="jark" created="Thu, 23 Jan 2020 12:59:38 +0000"  >&lt;p&gt;Fixed in 1.11.0: 338ae70d2468e5951d566b9e55d8dd18a649c9c9&lt;br/&gt;
1.10.0: 275cc946736857b4d8f1177d47e1c03cab723ec5&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13280122">FLINK-15635</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13284543">FLINK-15992</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0aduo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>