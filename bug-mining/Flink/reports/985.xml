<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3893] LeaderChangeStateCleanupTest times out</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3893</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;tt&gt;cluster.waitForTaskManagersToBeRegistered();&lt;/tt&gt; needs to be replaced by &lt;tt&gt;cluster.waitForTaskManagersToBeRegistered(timeout);&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;testStateCleanupAfterListenerNotification(org.apache.flink.runtime.leaderelection.LeaderChangeStateCleanupTest)  Time elapsed: 10.106 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.util.concurrent.TimeoutException: Futures timed out after [10000 milliseconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:219)
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:153)
	at scala.concurrent.Await$$anonfun$ready$1.apply(package.scala:86)
	at scala.concurrent.Await$$anonfun$ready$1.apply(package.scala:86)
	at scala.concurrent.BlockContext$DefaultBlockContext$.blockOn(BlockContext.scala:53)
	at scala.concurrent.Await$.ready(package.scala:86)
	at org.apache.flink.runtime.minicluster.FlinkMiniCluster.waitForTaskManagersToBeRegistered(FlinkMiniCluster.scala:455)
	at org.apache.flink.runtime.minicluster.FlinkMiniCluster.waitForTaskManagersToBeRegistered(FlinkMiniCluster.scala:439)
	at org.apache.flink.runtime.leaderelection.LeaderChangeStateCleanupTest.testStateCleanupAfterListenerNotification(LeaderChangeStateCleanupTest.java:181)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12966758">FLINK-3893</key>
            <summary>LeaderChangeStateCleanupTest times out</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="mxm">Maximilian Michels</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Tue, 10 May 2016 14:21:43 +0000</created>
                <updated>Mon, 28 Nov 2016 11:07:10 +0000</updated>
                            <resolved>Fri, 20 May 2016 15:44:32 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15278245" author="mxm" created="Tue, 10 May 2016 15:10:30 +0000"  >&lt;p&gt;After fixing this, I get the following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IllegalStateException: The retrieval service has not been started properly.
	at org.apache.flink.runtime.leaderelection.TestingLeaderRetrievalService.notifyListener(TestingLeaderRetrievalService.java:65)
	at org.apache.flink.runtime.leaderelection.LeaderElectionRetrievalTestingCluster.notifyRetrievalListeners(LeaderElectionRetrievalTestingCluster.java:123)
	at org.apache.flink.runtime.leaderelection.LeaderChangeStateCleanupTest.testStateCleanupAfterNewLeaderElectionAndListenerNotification(LeaderChangeStateCleanupTest.java:97)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;tt&gt;LeaderRetrievalService&lt;/tt&gt; may not been started yet (because the Actors are started asynchronously). I propose to remove this check.&lt;/p&gt;</comment>
                            <comment id="15290841" author="githubbot" created="Thu, 19 May 2016 10:08:09 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2009&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2009&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3893&quot; title=&quot;LeaderChangeStateCleanupTest times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3893&quot;&gt;&lt;del&gt;FLINK-3893&lt;/del&gt;&lt;/a&gt; improve LeaderChangeStateCleanupTest&lt;/p&gt;

&lt;p&gt;    Fixes discovered in the course of #1978.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3893&quot; title=&quot;LeaderChangeStateCleanupTest times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3893&quot;&gt;&lt;del&gt;FLINK-3893&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2009.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2009.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2009&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 75fe6bdbcb4770ce336fd9066fe57589a9685176&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-04-25T08:41:05Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3893&quot; title=&quot;LeaderChangeStateCleanupTest times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3893&quot;&gt;&lt;del&gt;FLINK-3893&lt;/del&gt;&lt;/a&gt; use test timeout in LeaderChangeStateCleanupTest&lt;/p&gt;

&lt;p&gt;commit 94adc427d02ea974706d133fb22f1219c4d5fe41&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-05-10T14:45:48Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3893&quot; title=&quot;LeaderChangeStateCleanupTest times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3893&quot;&gt;&lt;del&gt;FLINK-3893&lt;/del&gt;&lt;/a&gt; don&apos;t fail if leader retrieval service has been started&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15290855" author="githubbot" created="Thu, 19 May 2016 10:23:25 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2009#discussion_r63854365&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2009#discussion_r63854365&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/leaderelection/TestingLeaderRetrievalService.java &amp;#8212;&lt;br/&gt;
    @@ -61,8 +61,6 @@ public void stop() throws Exception {&lt;br/&gt;
     	public void notifyListener(String address, UUID leaderSessionID) {&lt;br/&gt;
     		if (listener != null) &lt;/p&gt;
{
     			listener.notifyLeaderAddress(address, leaderSessionID);
    -		}
&lt;p&gt; else {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw new IllegalStateException(&quot;The retrieval service has not been started properly.&quot;);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    the commit name doesn&apos;t seem to properly reflect the change made; it should be &quot;don&apos;t fail if ... service has &lt;em&gt;not&lt;/em&gt; been started&quot;&lt;/p&gt;</comment>
                            <comment id="15290861" author="githubbot" created="Thu, 19 May 2016 10:27:09 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2009#discussion_r63854760&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2009#discussion_r63854760&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/leaderelection/TestingLeaderRetrievalService.java &amp;#8212;&lt;br/&gt;
    @@ -61,8 +61,6 @@ public void stop() throws Exception {&lt;br/&gt;
     	public void notifyListener(String address, UUID leaderSessionID) {&lt;br/&gt;
     		if (listener != null) &lt;/p&gt;
{
     			listener.notifyLeaderAddress(address, leaderSessionID);
    -		}
&lt;p&gt; else {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw new IllegalStateException(&quot;The retrieval service has not been started properly.&quot;);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Good catch! Fixing that.&lt;/p&gt;</comment>
                            <comment id="15293571" author="githubbot" created="Fri, 20 May 2016 15:44:18 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2009&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2009&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15293574" author="mxm" created="Fri, 20 May 2016 15:44:32 +0000"  >&lt;p&gt;9b8de6a6cb3b1cc9ebeb623371e7fef3a6cb763d&lt;/p&gt;</comment>
                            <comment id="15701655" author="uce" created="Mon, 28 Nov 2016 11:07:10 +0000"  >&lt;p&gt;I got this again locally with what I believe to be unrelated changes:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;testStateCleanupAfterNewLeaderElectionAndListenerNotification(org.apache.flink.runtime.leaderelection.LeaderChangeStateCleanupTest)  Time elapsed: 120.077 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.util.concurrent.TimeoutException: Futures timed out after [2 minutes]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:219)
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:153)
	at scala.concurrent.Await$$anonfun$ready$1.apply(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.scala:86)
	at scala.concurrent.Await$$anonfun$ready$1.apply(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.scala:86)
	at scala.concurrent.BlockContext$DefaultBlockContext$.blockOn(BlockContext.scala:53)
	at scala.concurrent.Await$.ready(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.scala:86)
	at org.apache.flink.runtime.minicluster.FlinkMiniCluster.waitForTaskManagersToBeRegistered(FlinkMiniCluster.scala:469)
	at org.apache.flink.runtime.leaderelection.LeaderChangeStateCleanupTest.testStateCleanupAfterNewLeaderElectionAndListenerNotification(LeaderChangeStateCleanupTest.java:102)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xgmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>