<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:56:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22442] Using scala api to change the TimeCharacteristic of the PatternStream is invalid</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22442</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Using scala api to change the TimeCharacteristic of the PatternStream is invalid&lt;br/&gt;
you can only use the eventTime for PatternStream&lt;/p&gt;

&lt;p&gt;the bug is &#65306;&lt;br/&gt;
in the code in   org.apache.flink.cep.scala.PatternStream&lt;br/&gt;
when we called function like inProcessingTime()&lt;br/&gt;
the real JPatternStream in the object not be updated&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// org.apache.flink.cep.scala.PatternStream
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;PatternStream[T](jPatternStream: JPatternStream[T]) {

  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;[flink] def wrappedPatternStream = jPatternStream
 ...... 
 def sideOutputLateData(lateDataOutputTag: OutputTag[T]): PatternStream[T] = {
   jPatternStream.sideOutputLateData(lateDataOutputTag)
   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
 }
  def inProcessingTime(): PatternStream[T] = {
    jPatternStream.inProcessingTime()
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
  }
  def inEventTime(): PatternStream[T] = {
    jPatternStream.inEventTime()
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
  }
&#65373;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment></environment>
        <key id="13374819">FLINK-22442</key>
            <summary>Using scala api to change the TimeCharacteristic of the PatternStream is invalid</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wydhcws">Cedric Chen</assignee>
                                    <reporter username="wydhcws">Cedric Chen</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sat, 24 Apr 2021 13:32:58 +0000</created>
                <updated>Fri, 28 May 2021 11:08:43 +0000</updated>
                            <resolved>Wed, 5 May 2021 19:12:55 +0000</resolved>
                                    <version>1.12.0</version>
                    <version>1.12.1</version>
                    <version>1.12.2</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.1</fixVersion>
                    <fixVersion>1.12.4</fixVersion>
                                    <component>Library / CEP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17331236" author="wydhcws" created="Sat, 24 Apr 2021 13:35:33 +0000"  >&lt;p&gt;I want to fix this bug &#65292;Please assign this fix to me, thanks.&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;&lt;br/&gt;
and &lt;br/&gt;
Test case is :&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestCepJava {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NoSuchFieldException, IllegalAccessException {
        testJPatternStreamChangeTimeCharacteristic(getJPatternStream());
/*
    * the result  is
    * EventTime
    * ProcessingTime
    *
    * the  JPatternStream&apos;s  TimeCharacteristic  is be changed
    * */
  }
    }


    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; PatternStream&amp;lt;Event&amp;gt; getJPatternStream(){
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

        DataStream&amp;lt;Event&amp;gt; input =
                env.fromElements(
                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Event(1, &lt;span class=&quot;code-quote&quot;&gt;&quot;barfoo&quot;&lt;/span&gt;, 1.0),
                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Event(8, &lt;span class=&quot;code-quote&quot;&gt;&quot;end&quot;&lt;/span&gt;, 1.0));

        Pattern&amp;lt;Event, ?&amp;gt; pattern =
                Pattern.&amp;lt;Event&amp;gt;begin(&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;)
                        .where(
                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleCondition&amp;lt;Event&amp;gt;() {

                                    @Override
                                    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; filter(Event value) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
                                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value.getName().equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;);
                                    }
                                });
        PatternStream&amp;lt;Event&amp;gt; eventPatternStream = CEP.pattern(input, pattern);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; eventPatternStream;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; void testJPatternStreamChangeTimeCharacteristic(PatternStream&amp;lt;T&amp;gt; estream) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NoSuchFieldException, IllegalAccessException {
        getTimeBehaviour(estream);
        PatternStream&amp;lt;T&amp;gt; pStream = estream.inProcessingTime();
        getTimeBehaviour(pStream);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; void getTimeBehaviour(PatternStream pstream) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NoSuchFieldException, IllegalAccessException {
        Field builder = pstream.getClass().getDeclaredField(&lt;span class=&quot;code-quote&quot;&gt;&quot;builder&quot;&lt;/span&gt;);
        builder.setAccessible(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o = builder.get(pstream);
        Field timeBehaviour = o.getClass().getDeclaredField(&lt;span class=&quot;code-quote&quot;&gt;&quot;timeBehaviour&quot;&lt;/span&gt;);
        timeBehaviour.setAccessible(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(timeBehaviour.get(o));
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-scala&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Some comments here
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//    org.apache.flink.cep.scala.PatternStream
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//    org.apache.flink.cep.PatternStream
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;object&lt;/span&gt; TestCepScala {
  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; main(args: Array[String]): Unit = {
    updateCepTimeCharacteristicByScalaApi()

    /*
    * the result  is
    * EventTime
    * EventTime
    *
    * the real JPatternStream&apos;s  TimeCharacteristic  is not be changed
    * */
  }

  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; updateCepTimeCharacteristicByScalaApi(): Unit = {

    &lt;span class=&quot;code-comment&quot;&gt;//  get  org.apache.flink.cep.PatternStream
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; jestream: org.apache.flink.cep.PatternStream[Event] = TestCepJava.getJPatternStream

    &lt;span class=&quot;code-comment&quot;&gt;//get org.apache.flink.cep.scala.PatternStream
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; sePstream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PatternStream[Event](jestream)

    &lt;span class=&quot;code-comment&quot;&gt;//get and print TimeBehaviour
&lt;/span&gt;    getTimeBehaviourFromScalaPatternStream(sePstream)
    &lt;span class=&quot;code-comment&quot;&gt;//change TimeCharacteristic use scala api
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; sPstream: PatternStream[Event] = sePstream.inProcessingTime()

    &lt;span class=&quot;code-comment&quot;&gt;//get and print TimeBehaviour
&lt;/span&gt;    getTimeBehaviourFromScalaPatternStream(sPstream)


  }

  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; getTimeBehaviourFromScalaPatternStream(scPstream: org.apache.flink.cep.scala.PatternStream[Event]): Unit = {
    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; field: Field = scPstream.getClass.getDeclaredField(&lt;span class=&quot;code-quote&quot;&gt;&quot;jPatternStream&quot;&lt;/span&gt;)
    field.setAccessible(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; JPattern: &lt;span class=&quot;code-object&quot;&gt;AnyRef&lt;/span&gt; = field.get(scPstream)
    &lt;span class=&quot;code-keyword&quot;&gt;val&lt;/span&gt; stream: cep.PatternStream[Event] = JPattern.asInstanceOf[cep.PatternStream[Event]]
    TestCepJava.getTimeBehaviour(stream)
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="17331344" author="wydhcws" created="Sun, 25 Apr 2021 00:56:19 +0000"  >&lt;p&gt;fix  and  add the test in CEPScalaApiPatternStreamTest.scala&lt;/p&gt;</comment>
                            <comment id="17339860" author="dawidwys" created="Wed, 5 May 2021 19:12:55 +0000"  >&lt;p&gt;Fixed in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master
	&lt;ul&gt;
		&lt;li&gt;cb0d8eb85048cfb08be54e75f2f90b1d590b7ae0&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;1.13.1
	&lt;ul&gt;
		&lt;li&gt;32c64bb4d30499f602079cd34c73371106fe09c3&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;1.12.4
	&lt;ul&gt;
		&lt;li&gt;c9b51568d56b57a905d28b898408166db1f66a15&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qets:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>