<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:11:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-25097] Bug in inner join when the filter condition is boolean type</title>
                <link>https://issues.apache.org/jira/browse/FLINK-25097</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When I test the inner join, the column type of the filter condition is Boolean, and there is an error in the SQL conversion process&#12290;&lt;br/&gt;
The SQL as follow&#65306;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
source-1&#65306;
&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE IF NOT EXISTS data_source (\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; id INT,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; name STRING,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; sex &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;) WITH (\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;datagen&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;rows-per-second&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.kind&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;sequence&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.start&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.end&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.name.kind&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;random&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.name.length&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;; &#160; 
source-2&#65306;
&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE IF NOT EXISTS info (\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; id INT,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; name STRING,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; sex &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;) WITH (\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;datagen&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;rows-per-second&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.kind&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;sequence&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.start&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.id.end&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.name.kind&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;random&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;fields.name.length&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;; &#160; 
sink&#65306;
&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE IF NOT EXISTS print_sink ( \n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; id INT,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; name STRING,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; left_sex &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;,\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; right_sex &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;) WITH (\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;print&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;; &#160;&#160; 

SQL-1:
&lt;span class=&quot;code-quote&quot;&gt;&quot;insert into print_sink&quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot; select l.id, l.name, l.sex, r.sex from data_source l &quot;&lt;/span&gt; +
&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; join info r on l.sex = r.sex where l.sex is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The SQL fails with&#65306;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
The program finished with the following exception:
org.apache.flink.client.program.ProgramInvocationException: The main method caused an error: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; applying rule FlinkLogicalCalcConverter(in:NONE,out:LOGICAL), args [rel#135:LogicalCalc.NONE.any.None: 0.[NONE].[NONE](input=RelSubset#115,expr#0..5={inputs},proj#0..2={exprs},3=$t5)]
&#160; &#160; &#160; &#160; at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:366)
&#160; &#160; &#160; &#160; at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:219)
&#160; &#160; &#160; &#160; at org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:114)
&#160; &#160; &#160; &#160; at org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:812)
&#160; &#160; &#160; &#160; at org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:246)
&#160; &#160; &#160; &#160; at org.apache.flink.client.cli.CliFrontend.parseAndRun(CliFrontend.java:1054)
&#160; &#160; &#160; &#160; at org.apache.flink.client.cli.CliFrontend.lambda$main$10(CliFrontend.java:1132)
&#160; &#160; &#160; &#160; at java.security.AccessController.doPrivileged(Native Method)
&#160; &#160; &#160; &#160; at javax.security.auth.Subject.doAs(Subject.java:422)
&#160; &#160; &#160; &#160; at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1844)
&#160; &#160; &#160; &#160; at org.apache.flink.runtime.security.contexts.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)
&#160; &#160; &#160; &#160; at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1132)
Caused by: java.lang.RuntimeException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; applying rule FlinkLogicalCalcConverter(in:NONE,out:LOGICAL), args [rel#135:LogicalCalc.NONE.any.None: 0.[NONE].[NONE](input=RelSubset#115,expr#0..5={inputs},proj#0..2={exprs},3=$t5)]
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoRuleCall.onMatch(VolcanoRuleCall.java:256)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.IterativeRuleDriver.drive(IterativeRuleDriver.java:58)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.findBestExp(VolcanoPlanner.java:510)
&#160; &#160; &#160; &#160; at org.apache.calcite.tools.Programs$RuleSetProgram.run(Programs.java:312)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkVolcanoProgram.optimize(FlinkVolcanoProgram.scala:64)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram$$anonfun$optimize$1.apply(FlinkChainedProgram.scala:62)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram$$anonfun$optimize$1.apply(FlinkChainedProgram.scala:58)
&#160; &#160; &#160; &#160; at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:157)
&#160; &#160; &#160; &#160; at scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:157)
&#160; &#160; &#160; &#160; at scala.collection.Iterator$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(Iterator.scala:891)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
&#160; &#160; &#160; &#160; at scala.collection.IterableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(IterableLike.scala:72)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
&#160; &#160; &#160; &#160; at scala.collection.TraversableOnce$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foldLeft(TraversableOnce.scala:157)
&#160; &#160; &#160; &#160; at scala.collection.AbstractTraversable.foldLeft(Traversable.scala:104)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram.optimize(FlinkChainedProgram.scala:57)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.StreamCommonSubGraphBasedOptimizer.optimizeTree(StreamCommonSubGraphBasedOptimizer.scala:163)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.StreamCommonSubGraphBasedOptimizer.doOptimize(StreamCommonSubGraphBasedOptimizer.scala:79)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.optimize.CommonSubGraphBasedOptimizer.optimize(CommonSubGraphBasedOptimizer.scala:77)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.delegation.PlannerBase.optimize(PlannerBase.scala:287)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.delegation.StreamPlanner.explain(StreamPlanner.scala:100)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.delegation.StreamPlanner.explain(StreamPlanner.scala:42)
&#160; &#160; &#160; &#160; at org.apache.flink.table.api.internal.TableEnvironmentImpl.explainSql(TableEnvironmentImpl.java:625)
&#160; &#160; &#160; &#160; at com.xue.testSql.main(testSql.java:60)
&#160; &#160; &#160; &#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
&#160; &#160; &#160; &#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
&#160; &#160; &#160; &#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
&#160; &#160; &#160; &#160; at java.lang.reflect.Method.invoke(Method.java:498)
&#160; &#160; &#160; &#160; at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:349)
&#160; &#160; &#160; &#160; ... 11 more
Caused by: java.lang.RuntimeException: Error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; applying rule FlinkLogicalCalcConverter(in:NONE,out:LOGICAL)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoRuleCall.transformTo(VolcanoRuleCall.java:161)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.RelOptRuleCall.transformTo(RelOptRuleCall.java:268)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.RelOptRuleCall.transformTo(RelOptRuleCall.java:283)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.convert.ConverterRule.onMatch(ConverterRule.java:169)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoRuleCall.onMatch(VolcanoRuleCall.java:229)
&#160; &#160; &#160; &#160; ... 39 more
Caused by: java.lang.ClassCastException: org.apache.calcite.rex.RexInputRef cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.calcite.rex.RexCall
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$.org$apache$flink$table$planner$plan$utils$ColumnIntervalUtil$$columnIntervalOfSinglePredicate(ColumnIntervalUtil.scala:236)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$$anonfun$5$$anonfun$6.apply(ColumnIntervalUtil.scala:223)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$$anonfun$5$$anonfun$6.apply(ColumnIntervalUtil.scala:223)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.Iterator$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(Iterator.scala:891)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
&#160; &#160; &#160; &#160; at scala.collection.IterableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(IterableLike.scala:72)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;map(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.AbstractTraversable.map(Traversable.scala:104)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$$anonfun$5.apply(ColumnIntervalUtil.scala:223)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$$anonfun$5.apply(ColumnIntervalUtil.scala:221)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.Iterator$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(Iterator.scala:891)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
&#160; &#160; &#160; &#160; at scala.collection.IterableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(IterableLike.scala:72)
&#160; &#160; &#160; &#160; at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
&#160; &#160; &#160; &#160; at scala.collection.TraversableLike$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;map(TraversableLike.scala:234)
&#160; &#160; &#160; &#160; at scala.collection.AbstractTraversable.map(Traversable.scala:104)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil$.getColumnIntervalWithFilter(ColumnIntervalUtil.scala:221)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdColumnInterval.getColumnIntervalOfCalc(FlinkRelMdColumnInterval.scala:227)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdColumnInterval.getColumnInterval(FlinkRelMdColumnInterval.scala:203)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_ColumnInterval.getColumnInterval_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_ColumnInterval.getColumnInterval(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMetadataQuery.getColumnInterval(FlinkRelMetadataQuery.java:112)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdColumnInterval.getColumnInterval(FlinkRelMdColumnInterval.scala:801)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_ColumnInterval.getColumnInterval_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_ColumnInterval.getColumnInterval(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMetadataQuery.getColumnInterval(FlinkRelMetadataQuery.java:112)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount$$anonfun$1.apply(FlinkRelMdRowCount.scala:308)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount$$anonfun$1.apply(FlinkRelMdRowCount.scala:306)
&#160; &#160; &#160; &#160; at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;prefixLengthImpl(IndexedSeqOptimized.scala:38)
&#160; &#160; &#160; &#160; at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;exists(IndexedSeqOptimized.scala:46)
&#160; &#160; &#160; &#160; at scala.collection.mutable.ArrayBuffer.exists(ArrayBuffer.scala:48)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getEquiInnerJoinRowCount(FlinkRelMdRowCount.scala:306)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:268)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:212)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:410)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:212)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMdUtil.estimateFilteredRows(RelMdUtil.java:766)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMdUtil.estimateFilteredRows(RelMdUtil.java:761)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:62)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_RowCount.getRowCount(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:212)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.nodes.common.CommonCalc.computeSelfCost(CommonCalc.scala:59)
&#160; &#160; &#160; &#160; at org.apache.flink.table.planner.plan.metadata.FlinkRelMdNonCumulativeCost.getNonCumulativeCost(FlinkRelMdNonCumulativeCost.scala:41)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_NonCumulativeCost.getNonCumulativeCost_$(Unknown Source)
&#160; &#160; &#160; &#160; at GeneratedMetadataHandler_NonCumulativeCost.getNonCumulativeCost(Unknown Source)
&#160; &#160; &#160; &#160; at org.apache.calcite.rel.metadata.RelMetadataQuery.getNonCumulativeCost(RelMetadataQuery.java:288)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.getCost(VolcanoPlanner.java:705)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.RelSubset.propagateCostImprovements0(RelSubset.java:415)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.RelSubset.propagateCostImprovements(RelSubset.java:398)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.addRelToSet(VolcanoPlanner.java:1268)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.registerImpl(VolcanoPlanner.java:1227)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.register(VolcanoPlanner.java:589)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoPlanner.ensureRegistered(VolcanoPlanner.java:604)
&#160; &#160; &#160; &#160; at org.apache.calcite.plan.volcano.VolcanoRuleCall.transformTo(VolcanoRuleCall.java:148)
&#160; &#160; &#160; &#160; ... 43 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I change the flink version&#65292;such as&#160; 1.12.2 &#65292;1.13.3 and 1.14.0&#65292;this error occur in all versions during executeSql&#12290;&lt;/p&gt;

&lt;p&gt;There is a little different in 1.12.2 &#160;between other version.The above errors will be reported directly when explain SQL-1&#160; in 1.12.2,but other version explain SQL-1 successfully.&#160;&lt;/p&gt;

&lt;p&gt;Then,I modify the SQL-1 .Change l.sex from true to false&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SQL-2:
insert into print_sink select l.id, l.name, l.sex, r.sex from data_source l &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; join info r on l.sex = r.sex where l.sex is &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The SQL-2 can run normally.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I attempt to modify org.apache.flink.table.planner.plan.utils.ColumnIntervalUtil#columnIntervalOfSinglePredicate,like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; def columnIntervalOfSinglePredicate(condition: RexNode): ValueInterval = {
&lt;span class=&quot;code-comment&quot;&gt;//Add a judgment
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( !condition.isInstanceOf[RexCall] ){
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
}
val convertedCondition = condition.asInstanceOf[RexCall]
...
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;Both SQL-1 and SQL-2 run normally.Result are &lt;a href=&quot;#ConditionTrueResult.txt&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ConditionTrueResult.txt&lt;/a&gt; and &lt;a href=&quot;#ConditionFalseResult.txt&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ConditionFalseResult.txt&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13414315">FLINK-25097</key>
            <summary>Bug in inner join when the filter condition is boolean type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="337361684@qq.com">Yunhong Zheng</assignee>
                                    <reporter username="xuechu">Chu Xue</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 29 Nov 2021 14:28:36 +0000</created>
                <updated>Mon, 31 Mar 2025 06:28:38 +0000</updated>
                            <resolved>Tue, 5 Jul 2022 14:09:59 +0000</resolved>
                                    <version>1.12.2</version>
                    <version>1.13.0</version>
                    <version>1.14.0</version>
                                    <fixVersion>1.16.0</fixVersion>
                    <fixVersion>1.15.2</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17450836" author="qingru zhang" created="Tue, 30 Nov 2021 03:39:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuechu&quot; class=&quot;user-hover&quot; rel=&quot;xuechu&quot;&gt;xuechu&lt;/a&gt;Thanks for reporting this problem, would you like to fix this bug?&lt;br/&gt;
BTW, if input condition of columnIntervalOfSinglePredicate is RexInputRef, ValueInterval still could be inferred which lower equals to upper, right?&lt;/p&gt;</comment>
                            <comment id="17452907" author="xuechu" created="Fri, 3 Dec 2021 10:53:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingzhang&quot; class=&quot;user-hover&quot; rel=&quot;jingzhang&quot;&gt;jingzhang&lt;/a&gt; I am sorry to reply you late for the reason was that I have something to do these day.First, I don&apos;t think RexInputRef should be Passed to columnIntervalOfSinglePredicate in theory.Then, a previous optimization rule may subtract the judgment condition(is true), resulting in a bug in the ValueInterval of joinkey when predicate push down.Next, considering that the evaluation result of the expression(is false) is null, return null directly when rexinputref is passed.If there are other conditions will be subtracted by some optimization rules, causing another RexInputRef is passed to columnIntervalOfSinglePredicate, there may be a problem.However, the boundary of the predicate is maximized after null is returned, and the SQL results are consistent.Finally, we should solve the bug of optimization rules. Above modifications is equivalent to a protective measure.&lt;/p&gt;</comment>
                            <comment id="17522157" author="JIRAUSER287975" created="Thu, 14 Apr 2022 08:30:49 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuechu&quot; class=&quot;user-hover&quot; rel=&quot;xuechu&quot;&gt;xuechu&lt;/a&gt; , I think your are right. Do you have time to fix this bug&#65311; If not, I will fix it.&lt;/p&gt;</comment>
                            <comment id="17524672" author="JIRAUSER287975" created="Wed, 20 Apr 2022 02:35:33 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt;&#160; could you assign this to me, thanks.&lt;/p&gt;</comment>
                            <comment id="17527873" author="godfreyhe" created="Tue, 26 Apr 2022 03:56:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=337361684%40qq.com&quot; class=&quot;user-hover&quot; rel=&quot;337361684@qq.com&quot;&gt;337361684@qq.com&lt;/a&gt; assign to you&lt;/p&gt;</comment>
                            <comment id="17559142" author="godfreyhe" created="Mon, 27 Jun 2022 12:15:15 +0000"  >&lt;p&gt;Fixed in&lt;br/&gt;
master: 686634aa05aadc33cc7b655d25ad162fe59e41fd&lt;br/&gt;
1.15: 1e47430137f6db24e2e24cafc30e1227787c6720&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13036762" name="ColumnIntervalUtil.scala" size="12323" author="xuechu" created="Mon, 29 Nov 2021 14:16:11 +0000"/>
                            <attachment id="13036761" name="ConditionFalseResult.txt" size="903" author="xuechu" created="Mon, 29 Nov 2021 14:26:29 +0000"/>
                            <attachment id="13036760" name="ConditionTrueResult.txt" size="705" author="xuechu" created="Mon, 29 Nov 2021 14:26:29 +0000"/>
                            <attachment id="13036763" name="errorLog.txt" size="11717" author="xuechu" created="Mon, 29 Nov 2021 13:54:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0x64w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>