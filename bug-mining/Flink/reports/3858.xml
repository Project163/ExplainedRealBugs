<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:44:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15438] Counter metrics are incorrectly reported as total counts to DataDog</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15438</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The Flink semantics of a counter are not matching with the counters in DataDog.&lt;/p&gt;

&lt;p&gt;In Flink a counter counts the total of increment and decrement calls.&lt;br/&gt;
In DataDog a counter is a rate over the reporting interval. &lt;/p&gt;

&lt;p&gt;The Flink implementation of the DataDog reporter seems to send the Flink counter value each time the metrics are reported. Correct would be to send the delta of the counter since the last report.&lt;/p&gt;

&lt;p&gt;There are some features in DataDog which are easier to use if this could be fixed, e.g. alerts based on counters.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13276886">FLINK-15438</key>
            <summary>Counter metrics are incorrectly reported as total counts to DataDog</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="joern">J&#246;rn Kottmann</assignee>
                                    <reporter username="joern">J&#246;rn Kottmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 30 Dec 2019 13:41:14 +0000</created>
                <updated>Thu, 26 Mar 2020 09:54:53 +0000</updated>
                            <resolved>Thu, 26 Mar 2020 09:54:53 +0000</resolved>
                                    <version>1.9.1</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Runtime / Metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17005414" author="x1q1j1" created="Mon, 30 Dec 2019 15:57:28 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joern&quot; class=&quot;user-hover&quot; rel=&quot;joern&quot;&gt;joern&lt;/a&gt;&#160;can you give an example of a specific counter? This can be easily checked and resolved.&lt;/p&gt;</comment>
                            <comment id="17005487" author="joern" created="Mon, 30 Dec 2019 17:28:28 +0000"  >&lt;p&gt;Yes, one of the counters I need is numRecordsIn for a specific operator. The current implementation sends always the counter value for the total runtime of the job, and not the counter value of for the reporting interval (the delta since the last report).&lt;/p&gt;

&lt;p&gt;I am happy to send a patch to resolve this issue.&lt;/p&gt;</comment>
                            <comment id="17005760" author="joern" created="Mon, 30 Dec 2019 18:56:14 +0000"  >&lt;p&gt;I would like to propose to change DCounter to always return the delta in the counter since the last call. To be able to compute it an instance variable with the last count has to be added to DCounter.&lt;/p&gt;</comment>
                            <comment id="17006743" author="zentol" created="Thu, 2 Jan 2020 11:39:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joern&quot; class=&quot;user-hover&quot; rel=&quot;joern&quot;&gt;joern&lt;/a&gt; I&apos;ve assigned the issue to you. Your proposed solution sounds good to me.&lt;/p&gt;</comment>
                            <comment id="17008657" author="joern" created="Mon, 6 Jan 2020 09:15:57 +0000"  >&lt;p&gt;I am still working on the issue.&lt;/p&gt;

&lt;p&gt;I extended DCounter with instance variables to track the last reported reading to be able to compute the delta for the interval, but the reported metrics in Datadog are still quite a bit different from the values which are displayed in Flink. I need to understand this first before I can send the fix.&lt;/p&gt;
</comment>
                            <comment id="17027402" author="zentol" created="Fri, 31 Jan 2020 11:06:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=joern&quot; class=&quot;user-hover&quot; rel=&quot;joern&quot;&gt;joern&lt;/a&gt; Were you able to figure out what the problem is?&lt;/p&gt;</comment>
                            <comment id="17028127" author="joern" created="Sat, 1 Feb 2020 15:49:58 +0000"  >&lt;p&gt;No, didn&apos;t mange to find the exact cause.&lt;/p&gt;

&lt;p&gt;The current implementation is sending counts that are really wrong, with my changes this is much better. &lt;/p&gt;

&lt;p&gt;Should I send the PR for it and you could give it a critical review? &lt;/p&gt;
</comment>
                            <comment id="17058677" author="zentol" created="Fri, 13 Mar 2020 12:06:15 +0000"  >&lt;p&gt;Yes, a PR would be highly appreciated.&lt;/p&gt;</comment>
                            <comment id="17067534" author="zentol" created="Thu, 26 Mar 2020 09:38:41 +0000"  >&lt;p&gt;Delta reporting merged to master:&lt;br/&gt;
69f20e929b9f6c58b3220dd41b41b21ad5f4bcdd&lt;br/&gt;
2db31ff808da1217ba04438af9530b08b3d33cb6&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0a2yg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>The DataDog metrics reporter now reports counts as the number of events over the reporting interval, instead of the total count. This aligns the count semantics with the DataDog documentation.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>