<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:38:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-11201] Document SBT dependency requirements when using MiniClusterResource</title>
                <link>https://issues.apache.org/jira/browse/FLINK-11201</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Starting with Flink 1.7, there&apos;s lack of `runtime.testutils.MiniClusterResource` class in `flink-test-utils` distribution.&lt;/p&gt;

&lt;p&gt;Steps to reproduce (Scala code)&lt;/p&gt;

&lt;p&gt;build.sbt&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
name := &lt;span class=&quot;code-quote&quot;&gt;&quot;flink-17-test-issue&quot;&lt;/span&gt;

organization := &lt;span class=&quot;code-quote&quot;&gt;&quot;x.y.z&quot;&lt;/span&gt;
scalaVersion := &lt;span class=&quot;code-quote&quot;&gt;&quot;2.11.12&quot;&lt;/span&gt;
val flinkVersion = &lt;span class=&quot;code-quote&quot;&gt;&quot;1.7.0&quot;&lt;/span&gt;

libraryDependencies ++= Seq(
  &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; %% &lt;span class=&quot;code-quote&quot;&gt;&quot;flink-streaming-scala&quot;&lt;/span&gt; % flinkVersion % Provided,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;org.scalatest&quot;&lt;/span&gt; %% &lt;span class=&quot;code-quote&quot;&gt;&quot;scalatest&quot;&lt;/span&gt; % &lt;span class=&quot;code-quote&quot;&gt;&quot;3.0.5&quot;&lt;/span&gt; % Test,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; %% &lt;span class=&quot;code-quote&quot;&gt;&quot;flink-test-utils&quot;&lt;/span&gt; % flinkVersion % Test
&lt;span class=&quot;code-comment&quot;&gt;//  ,&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink&quot;&lt;/span&gt; %% &lt;span class=&quot;code-quote&quot;&gt;&quot;flink-runtime&quot;&lt;/span&gt; % flinkVersion % Test classifier Artifact.TestsClassifier
&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;test class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SimpleTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; AbstractTestBase with FlatSpecLike {
  implicit val env: StreamExecutionEnvironment = StreamExecutionEnvironment.getExecutionEnvironment
  env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime)
  env.setParallelism(1)
  env.setRestartStrategy(RestartStrategies.noRestart())

  &lt;span class=&quot;code-quote&quot;&gt;&quot;SimpleTest&quot;&lt;/span&gt; should &lt;span class=&quot;code-quote&quot;&gt;&quot;work&quot;&lt;/span&gt; in {
    val inputDs = env.fromElements(1,2,3)

    inputDs.print()

    env.execute()
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Results in:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A needed &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;was not found. This could be due to an error in your runpath. Missing class: org/apache/flink/runtime/testutils/MiniClusterResource
java.lang.NoClassDefFoundError: org/apache/flink/runtime/testutils/MiniClusterResource
...
Caused by: java.lang.ClassNotFoundException: org.apache.flink.runtime.testutils.MiniClusterResource
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:424)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:357)
	... 31 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This can be fixed by adding flink-runtime distribution with test classifier into dependencies list.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13205336">FLINK-11201</key>
            <summary>Document SBT dependency requirements when using MiniClusterResource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="eyushin">eugen yushin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Dec 2018 10:46:07 +0000</created>
                <updated>Thu, 14 Feb 2019 16:23:04 +0000</updated>
                            <resolved>Thu, 20 Dec 2018 18:23:29 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.2</fixVersion>
                    <fixVersion>1.8.0</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16724897" author="zentol" created="Wed, 19 Dec 2018 11:18:46 +0000"  >&lt;p&gt;flink-test-utils has a dependency on flink-runtime, including the test-jar. I don&apos;t understand why this isn&apos;t pulled in; is this an sbt thing?&lt;/p&gt;</comment>
                            <comment id="16724931" author="eyushin" created="Wed, 19 Dec 2018 11:51:00 +0000"  >&lt;p&gt;it works like a charm in 1.6, so I think something has been changed in 1.7 version regarding dependency management for flink-test-utils.&lt;br/&gt;
btw, class from an error `org.apache.flink.runtime.testutils.MiniClusterResource` comes from test sources of flink-runtime, not the source code.&lt;/p&gt;</comment>
                            <comment id="16724969" author="zentol" created="Wed, 19 Dec 2018 12:54:14 +0000"  >&lt;p&gt;In 1.6 the MiniClusterResource resided entirely in flink-test-utils.&lt;/p&gt;

&lt;p&gt;In 1.7 we moved the core logic to flink-runtime (as test classes), retained the existing class in flink-test-utils as an alias (to not break existing tests), and added a dependency on flink-runtime:test-jar to flink-test-utils.&lt;/p&gt;

&lt;p&gt;Looking at the dependency tree with maven the test-jar dependency on flink-runtime is correctly pulled in when depending on flink-test-utils; so as far as I can tell this is either an issue on the side of sbt or there&apos;s a magic property that should be set in your build.sbt to include transitive dependencies of test dependencies during testing.&lt;/p&gt;

&lt;p&gt;In any case I would argue that this is not an issue on the side of Flink.&lt;/p&gt;</comment>
                            <comment id="16725115" author="eyushin" created="Wed, 19 Dec 2018 15:37:18 +0000"  >&lt;p&gt;It&apos;s a behavior change which is not reflected in docs.&lt;br/&gt;
If code from the description works fine on your env, I have no questions. But it doesn&apos;t on 2 dev&apos;s machines I have.&lt;/p&gt;</comment>
                            <comment id="16725130" author="eyushin" created="Wed, 19 Dec 2018 15:57:08 +0000"  >&lt;p&gt;at the same time, looks like to sbt issue mentioned in:&lt;br/&gt;
Transitive dependencies with classifier &quot;test&quot; are not include in the classpath #2964&lt;br/&gt;
&lt;a href=&quot;https://github.com/sbt/sbt/issues/2964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/sbt/sbt/issues/2964&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nevertheless, I think it makes sense to add a note into docs to point out this explicitly. So nobody will spend extra time seeking for this behavior explanation in future.&lt;/p&gt;</comment>
                            <comment id="16726071" author="till.rohrmann" created="Thu, 20 Dec 2018 17:37:16 +0000"  >&lt;p&gt;Thanks for reporting this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eyushin&quot; class=&quot;user-hover&quot; rel=&quot;eyushin&quot;&gt;eyushin&lt;/a&gt;. I agree with you that this behaviour change should be documented. I will add it to the release notes so that others will be made aware of it.&lt;/p&gt;</comment>
                            <comment id="16726111" author="till.rohrmann" created="Thu, 20 Dec 2018 18:23:29 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
1.8.0: eadfae0a65246132ef51cabe7bc647da993ec42b&lt;br/&gt;
1.7.2: 290587b531d2c768340b04cc0999ff0e9594d4b6&lt;/p&gt;</comment>
                            <comment id="16726719" author="eyushin" created="Fri, 21 Dec 2018 13:01:56 +0000"  >&lt;p&gt;thx guys for a quick turnaround&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 47 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u004i0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>