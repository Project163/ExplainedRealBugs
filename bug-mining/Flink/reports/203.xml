<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:18:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1438] ClassCastException for Custom InputSplit in local mode and invalid type code in distributed mode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1438</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Jobs with custom InputSplits fail with a ClassCastException such as &lt;tt&gt;org.apache.flink.examples.java.misc.CustomSplitTestJob$TestFileInputSplit cannot be cast to org.apache.flink.examples.java.misc.CustomSplitTestJob$TestFileInputSplit&lt;/tt&gt; if executed on a local setup. &lt;/p&gt;

&lt;p&gt;This issue is probably related to different ClassLoaders used by the JobManager when InputSplits are generated and when they are handed to the InputFormat by the TaskManager. Moving the class of the custom InputSplit into the &lt;tt&gt;./lib&lt;/tt&gt; folder and removing it from the job&apos;s makes the job work.&lt;/p&gt;

&lt;p&gt;To reproduce the bug, run the following job on a local setup. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomSplitTestJob {

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

		DataSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; x = env.createInput(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestFileInputFormat());
		x.print();

		env.execute();
	}

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestFileInputFormat &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; InputFormat&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,TestFileInputSplit&amp;gt; {

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure(Configuration parameters) {

		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; BaseStatistics getStatistics(BaseStatistics cachedStatistics) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; TestFileInputSplit[] createInputSplits(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; minNumSplits) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestFileInputSplit[]{&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestFileInputSplit()};
		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; InputSplitAssigner getInputSplitAssigner(TestFileInputSplit[] inputSplits) {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LocatableInputSplitAssigner(inputSplits);
		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void open(TestFileInputSplit split) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; reachedEnd() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; nextRecord(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; reuse) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
			&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		}

		@Override
		&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

		}
	}

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestFileInputSplit &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; FileInputSplit {

	}

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The same happens in distributed mode just that Akka terminates the transmission of the input split with a meaningless &lt;tt&gt;invalid type code: 00&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12769636">FLINK-1438</key>
            <summary>ClassCastException for Custom InputSplit in local mode and invalid type code in distributed mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="fhueske">Fabian Hueske</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Jan 2015 13:29:26 +0000</created>
                <updated>Thu, 28 Feb 2019 14:01:51 +0000</updated>
                            <resolved>Fri, 6 Feb 2015 17:48:29 +0000</resolved>
                                    <version>0.8.0</version>
                    <version>0.9</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14298847" author="till.rohrmann" created="Fri, 30 Jan 2015 16:46:54 +0000"  >&lt;p&gt;This is not only happening in local mode but also on cloud-11 with jobs which contain the InputSplit class information in the user code jars.&lt;/p&gt;

&lt;p&gt;The result is that Akka cannot deserialize the object and terminates the transmission with the following error:&lt;/p&gt;

&lt;p&gt;WARN  akka.remote.ReliableDeliverySupervisor                        - Association with remote system &lt;span class=&quot;error&quot;&gt;&amp;#91;akka.tcp://flink@cloud-22.dima.tu-berlin.de:53627&amp;#93;&lt;/span&gt; has failed, address is now gated for &lt;span class=&quot;error&quot;&gt;&amp;#91;5000&amp;#93;&lt;/span&gt; ms. Reason is: &lt;span class=&quot;error&quot;&gt;&amp;#91;invalid type code: 00&amp;#93;&lt;/span&gt;.&lt;/p&gt;</comment>
                            <comment id="14299802" author="rmetzger" created="Sat, 31 Jan 2015 13:37:16 +0000"  >&lt;p&gt;Do you think this is related? &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1390&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-1390&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14299842" author="till.rohrmann" created="Sat, 31 Jan 2015 14:42:39 +0000"  >&lt;p&gt;Hard to say without further information about the issue 1390.&lt;/p&gt;</comment>
                            <comment id="14309515" author="stephanewen" created="Fri, 6 Feb 2015 17:48:29 +0000"  >&lt;p&gt;Fixed via a07d59d72fc059a600a3eb1f479b02964ca256f5&lt;/p&gt;</comment>
                            <comment id="14310891" author="rmetzger" created="Sat, 7 Feb 2015 19:41:03 +0000"  >&lt;p&gt;We should add this also to release-0.8 in my optinion&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24q2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>