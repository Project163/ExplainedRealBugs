<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:47:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-18161] Changing parallelism is not possible in sql-client.sh</title>
                <link>https://issues.apache.org/jira/browse/FLINK-18161</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I tried using &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SET execution.parallelism=12
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and changing the parallelism in the configuration file.&lt;/p&gt;

&lt;p&gt;My SQL queries were always running with p=1 for all operators.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13309736">FLINK-18161</key>
            <summary>Changing parallelism is not possible in sql-client.sh</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="godfreyhe">godfrey he</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 5 Jun 2020 13:51:11 +0000</created>
                <updated>Tue, 30 Jun 2020 14:03:10 +0000</updated>
                            <resolved>Tue, 16 Jun 2020 13:53:40 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17126788" author="dawidwys" created="Fri, 5 Jun 2020 13:59:48 +0000"  >&lt;p&gt;The problem is that the command will result in setting the parallelism directly on the underlying StreamExecutionEnvironment/BatchExecutionEnvironment. &lt;/p&gt;

&lt;p&gt;At the same time the &lt;tt&gt;TableConfig&lt;/tt&gt; is populated with a &lt;tt&gt;Configuration&lt;/tt&gt; (&lt;tt&gt;LocalExecutor#flinkConfig&lt;/tt&gt;) populated from the &lt;tt&gt;GlobalConfiguration&lt;/tt&gt; which sets the &lt;tt&gt;parallelism.default&lt;/tt&gt;.&lt;br/&gt;
This setting always overwrites the parallelism of the &lt;tt&gt;StreamExecutionEnvironment&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The flow is as follows:&lt;br/&gt;
1. We set value of &lt;tt&gt;execution.parallelism&lt;/tt&gt; through &lt;tt&gt;StreamExecutionEnvironment#setParallelism&lt;/tt&gt;&lt;br/&gt;
2. We set value of &lt;tt&gt;parallelism.default&lt;/tt&gt; from TableConfig#configuration on &lt;tt&gt;StreamExecutionEnvironment&lt;/tt&gt; effectively overwriting the previous setting.&lt;/p&gt;</comment>
                            <comment id="17126872" author="jark" created="Fri, 5 Jun 2020 15:20:48 +0000"  >&lt;p&gt;Does &lt;tt&gt;parallelism.default&lt;/tt&gt; works? &lt;/p&gt;</comment>
                            <comment id="17126873" author="dawidwys" created="Fri, 5 Jun 2020 15:23:01 +0000"  >&lt;p&gt;&lt;tt&gt;parallelism.default&lt;/tt&gt; works from &lt;tt&gt;flink-conf.yaml&lt;/tt&gt; There is no way to set it from the &lt;tt&gt;sql-client&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;execution.parallelism&lt;/tt&gt; works if we remove the &lt;tt&gt;parallelism.default&lt;/tt&gt; from &lt;tt&gt;flink-conf.yaml&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17126875" author="dawidwys" created="Fri, 5 Jun 2020 15:24:43 +0000"  >&lt;p&gt;The simplest fix would be to overwrite the &lt;tt&gt;parallelism.default&lt;/tt&gt; with the value of &lt;tt&gt;execution.parallelism&lt;/tt&gt; (which is only sql-client specific).&lt;/p&gt;</comment>
                            <comment id="17126882" author="jark" created="Fri, 5 Jun 2020 15:29:20 +0000"  >&lt;p&gt;Could we just allow SQL CLI to set Flink configurations? This will also make it possible to set checkpointing/watermark in SQL CLI. &lt;/p&gt;</comment>
                            <comment id="17135006" author="godfreyhe" created="Sun, 14 Jun 2020 02:24:38 +0000"  >&lt;p&gt;For 1.11, I think we want to just fix the problem that the flink configurations overwrite sql-client properties. &lt;br/&gt;
For 1.12, I want to remove the sql-client&apos;s specific properties (e.g. &lt;tt&gt;execution.parallelism&lt;/tt&gt;, &lt;tt&gt;execution.time-characteristic&lt;/tt&gt;, &lt;tt&gt;execution.restart-strategy.type&lt;/tt&gt;), instead we should use the properties defined in flink runtime (e.g. &lt;tt&gt;parallelism.default&lt;/tt&gt;, &lt;tt&gt;pipeline.time-characteristic&lt;/tt&gt;, &lt;tt&gt;restart-strategy&lt;/tt&gt;). &lt;tt&gt;Configuration&lt;/tt&gt; section in sql-client file can be set options defined in table and runtime. And then, we can also set checkpointing/watermark in SQL CLI.&lt;/p&gt;

&lt;p&gt;I investigate that if we just deprecate the sql-client&apos;s specific properties and also introduce flink runtime&apos;s properties. (that means they can both work in sql-client) the code is very complex to handle the conflicts and users will very confuse about the behavior. The possible scenarios and solutions are listed below:&lt;br/&gt;
1. conflicts in one sql-client config file, which one should be used?   ---&amp;gt;  throw exception if exists, add log to tell users which keys are deprecated, and give suggested keys to replace them.&lt;br/&gt;
2. conflicts in default config file and session config file, which one should be used?   ---&amp;gt;  throw exception if exists. add log to tell users which keys are deprecated, and give suggested keys to replace them.&lt;br/&gt;
3. conflicts in &lt;tt&gt;set&lt;/tt&gt; operation, which one should be used? ---&amp;gt; if the given key in &lt;tt&gt;set&lt;/tt&gt; operation is deprecated, check wether there is a corresponding new key exists in &lt;tt&gt;Environment&lt;/tt&gt;. if exists, remove it first (to make sure the final result is correct), and then set the value to  &lt;tt&gt;Environment&lt;/tt&gt; . vice versa. If users execute &lt;tt&gt;set&lt;/tt&gt; command to list all properties, they may find some properties do not exist.&lt;/p&gt;

&lt;p&gt;WDYT? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="17135028" author="jark" created="Sun, 14 Jun 2020 05:04:02 +0000"  >&lt;p&gt;+1 to remove the duplicate congiuratiion in SQL CLI in the future. &lt;/p&gt;

&lt;p&gt;For now, I would suggest to make &lt;tt&gt;execution.parallelism&lt;/tt&gt; as a synonym for &lt;tt&gt;parallelism.default&lt;/tt&gt;. The set of &lt;tt&gt;execution.parallelism&lt;/tt&gt; will be translated to &lt;tt&gt;parallelism.default&lt;/tt&gt;. So there is no priority problem, it&apos;s just depends on the set order. And I guess this will simplify much things? &lt;/p&gt;</comment>
                            <comment id="17135384" author="godfreyhe" created="Mon, 15 Jun 2020 03:50:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;, thanks for the suggestion, but I don&apos;t think that could simplify design. First, If sql-client&apos;s configuration accept &lt;tt&gt;parallelism.default&lt;/tt&gt;, we also should handle the conflict. Second, when users execute &lt;tt&gt;execution.parallelism=12&lt;/tt&gt; and then execute &lt;tt&gt;set&lt;/tt&gt; command to list all properties, they find &lt;tt&gt;execution.parallelism&lt;/tt&gt; does not exist . Last, we must handle this special case in &lt;tt&gt;ConfigurationEntry&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17135421" author="dawidwys" created="Mon, 15 Jun 2020 05:49:34 +0000"  >&lt;p&gt;Thanks for the discussion. I don&apos;t know if it is the right solution, but I&apos;d go with:&lt;/p&gt;

&lt;p&gt;For 1.11 I&apos;d keep the old behaviour and make the &lt;tt&gt;execution.parallelism&lt;/tt&gt; work. I&apos;d not care too much to make the &lt;tt&gt;parallelism.default&lt;/tt&gt; work well in that version, as it was not supported, it is not documented and it&apos;s more of a coincidence it works. To achieve that I&apos;d do what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; is suggesting, meaning instead of using &lt;tt&gt;env.setParallelism()&lt;/tt&gt; I&apos;d use &lt;tt&gt;set(&quot;parallelism.default&quot;, ...)&lt;/tt&gt; for the &lt;tt&gt;execution.parallelism&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;For 1.12 I&apos;d be ok with removing the sql-cli specific parameters and supporting the common parameters. Probably though I&apos;d still support the old parameters for one more version and thrown either an exception or very prominent warning that this setting will be removed in the next version. &lt;/p&gt;</comment>
                            <comment id="17135461" author="jark" created="Mon, 15 Jun 2020 06:30:57 +0000"  >&lt;p&gt;I have the similar thought,&#160;&lt;/p&gt;

&lt;p&gt;either (1) we fix &lt;tt&gt;execution.parallelism&lt;/tt&gt; only in 1.11, and support &lt;tt&gt;parallelism.default&lt;/tt&gt; in 1.12 (warning for &lt;tt&gt;execution.parallelism&lt;/tt&gt;), and remove&#160;&lt;tt&gt;execution.parallelism&lt;/tt&gt; in 1.13&lt;br/&gt;
or (2)&#160;we fix &lt;tt&gt;execution.parallelism&lt;/tt&gt; and support &lt;tt&gt;parallelism.default&lt;/tt&gt; in 1.11 (warning for &lt;tt&gt;execution.parallelism&lt;/tt&gt;), and remove in 1.12&lt;/p&gt;</comment>
                            <comment id="17135647" author="godfreyhe" created="Mon, 15 Jun 2020 09:11:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;, I had opened a pr, it&apos;s very appreciate that you could have a look. In that pr, I do not introduce &lt;tt&gt;parallelism.default&lt;/tt&gt;, instead I change the sql-client&apos;s special properties to common parameters when building &lt;tt&gt;TableConfig&lt;/tt&gt; instance.&lt;/p&gt;

&lt;p&gt;For 1.12, I also prefer to just deprecate the sql-client&apos;s special properties, and throw an exception directly when meeting a conflict.&lt;/p&gt;</comment>
                            <comment id="17136669" author="dawidwys" created="Tue, 16 Jun 2020 13:53:40 +0000"  >&lt;p&gt;Fixed in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master
	&lt;ul&gt;
		&lt;li&gt;02cdfe88d5e686bedb7461e8e0b5f60bf807e095...94ea5e6ca9a1a0c6dda6b832473e40578207e78b&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;1.11
	&lt;ul&gt;
		&lt;li&gt;1b0d73a0599b6b7bceaeeecd50f3df48d835ef10...0ce4297e524397ec6bb8cf74c129db6daf86146a&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13309624">FLINK-18144</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0fk4w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>