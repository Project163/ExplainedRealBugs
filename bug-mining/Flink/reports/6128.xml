<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:08:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24163] PartiallyFinishedSourcesITCase fails due to timeout</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24163</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23529&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10996&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23529&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10996&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Sep 04 04:35:28 [ERROR] Tests run: 6, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 155.236 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.runtime.operators.lifecycle.PartiallyFinishedSourcesITCase
Sep 04 04:35:28 [ERROR] test[complex graph ALL_SUBTASKS, failover: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;]  Time elapsed: 65.999 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
Sep 04 04:35:28 java.util.concurrent.TimeoutException: Condition was not met in given timeout.
Sep 04 04:35:28 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:164)
Sep 04 04:35:28 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:142)
Sep 04 04:35:28 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:134)
Sep 04 04:35:28 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitForSubtasksToFinish(CommonTestUtils.java:297)
Sep 04 04:35:28 	at org.apache.flink.runtime.operators.lifecycle.TestJobExecutor.waitForSubtasksToFinish(TestJobExecutor.java:219)
Sep 04 04:35:28 	at org.apache.flink.runtime.operators.lifecycle.PartiallyFinishedSourcesITCase.test(PartiallyFinishedSourcesITCase.java:82)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13399498">FLINK-24163</key>
            <summary>PartiallyFinishedSourcesITCase fails due to timeout</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gaoyunhaii">Yun Gao</assignee>
                                    <reporter username="xtsong">Xintong Song</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 6 Sep 2021 03:08:24 +0000</created>
                <updated>Tue, 25 Jan 2022 06:45:16 +0000</updated>
                            <resolved>Tue, 25 Jan 2022 06:45:16 +0000</resolved>
                                    <version>1.14.0</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17410323" author="xintongsong" created="Mon, 6 Sep 2021 03:08:50 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17410336" author="xintongsong" created="Mon, 6 Sep 2021 03:32:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23544&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=5403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23544&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=5403&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17410337" author="xintongsong" created="Mon, 6 Sep 2021 03:32:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23544&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23544&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10983&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17410345" author="xintongsong" created="Mon, 6 Sep 2021 03:36:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23547&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10995&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23547&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10995&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17410504" author="gaoyunhaii" created="Mon, 6 Sep 2021 09:41:55 +0000"  >&lt;p&gt;This one should be called by the test configuration. There are two problems:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The checkpoint timeout 5s is still not large enough, it might be caused when the unaligned checkpoint is enabled, the checkpoint performance id bounded by disk IO.&lt;/li&gt;
	&lt;li&gt;We also met with&#160;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.util.concurrent.ExecutionException: java.io.IOException: Size of the state is larger than the maximum permitted memory-backed state. Size=8641168, maxSize=5242880. Consider using a different checkpoint storage, like the FileSystemCheckpointStorage.
    at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357) ~[?:1.8.0_292]
    at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1908) ~[?:1.8.0_292]
    at org.apache.flink.streaming.api.operators.OperatorSnapshotFinalizer.&amp;lt;init&amp;gt;(OperatorSnapshotFinalizer.java:66) ~[flink-streaming-java_2.11-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.streaming.runtime.tasks.AsyncCheckpointRunnable.finalizeNonFinishedSnapshots(AsyncCheckpointRunnable.java:177) ~[flink-streaming-java_2.11-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.streaming.runtime.tasks.AsyncCheckpointRunnable.run(AsyncCheckpointRunnable.java:124) [flink-streaming-java_2.11-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) [?:1.8.0_292]
Caused by: java.io.IOException: Size of the state is larger than the maximum permitted memory-backed state. Size=8641168, maxSize=5242880. Consider using a different checkpoint storage, like the FileSystemCheckpointStorage.
    at org.apache.flink.runtime.state.memory.MemCheckpointStreamFactory.checkSize(MemCheckpointStreamFactory.java:63) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.state.memory.MemCheckpointStreamFactory$MemoryCheckpointOutputStream.closeAndGetBytes(MemCheckpointStreamFactory.java:140) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.state.memory.MemCheckpointStreamFactory$MemoryCheckpointOutputStream.closeAndGetHandle(MemCheckpointStreamFactory.java:120) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.finishWriteAndResult(ChannelStateCheckpointWriter.java:218) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.doComplete(ChannelStateCheckpointWriter.java:240) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.lambda$complete$5(ChannelStateCheckpointWriter.java:202) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.runWithChecks(ChannelStateCheckpointWriter.java:296) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.complete(ChannelStateCheckpointWriter.java:200) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateCheckpointWriter.completeInput(ChannelStateCheckpointWriter.java:187) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.CheckpointInProgressRequest.execute(ChannelStateWriteRequest.java:212) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatchInternal(ChannelStateWriteRequestDispatcherImpl.java:85) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestDispatcherImpl.dispatch(ChannelStateWriteRequestDispatcherImpl.java:62) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.loop(ChannelStateWriteRequestExecutorImpl.java:96) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    at org.apache.flink.runtime.checkpoint.channel.ChannelStateWriteRequestExecutorImpl.run(ChannelStateWriteRequestExecutorImpl.java:75) ~[flink-runtime-1.14-SNAPSHOT.jar:1.14-SNAPSHOT]
    ... 1 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This might be caused by we have channel state with unaligned checkpoints.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;ll open a PR to increase the checkpoint timeout and change to another statebackend type. &lt;br/&gt;
&#160; &#160;&#160;&lt;/p&gt;</comment>
                            <comment id="17410875" author="xintongsong" created="Tue, 7 Sep 2021 02:03:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23560&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10993&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23560&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10993&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17410876" author="xintongsong" created="Tue, 7 Sep 2021 02:04:46 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoyunhaii&quot; class=&quot;user-hover&quot; rel=&quot;gaoyunhaii&quot;&gt;gaoyunhaii&lt;/a&gt;. I&apos;ve assigned you to the ticket.&lt;/p&gt;</comment>
                            <comment id="17410932" author="xintongsong" created="Tue, 7 Sep 2021 06:00:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23629&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10995&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23629&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=10995&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17411672" author="xintongsong" created="Wed, 8 Sep 2021 04:00:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23718&amp;amp;view=logs&amp;amp;j=baf26b34-3c6a-54e8-f93f-cf269b32f802&amp;amp;t=8c9d126d-57d2-5a9e-a8c8-ff53f7b35cd9&amp;amp;l=4710&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=23718&amp;amp;view=logs&amp;amp;j=baf26b34-3c6a-54e8-f93f-cf269b32f802&amp;amp;t=8c9d126d-57d2-5a9e-a8c8-ff53f7b35cd9&amp;amp;l=4710&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17411734" author="dawidwys" created="Wed, 8 Sep 2021 07:02:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoyunhaii&quot; class=&quot;user-hover&quot; rel=&quot;gaoyunhaii&quot;&gt;gaoyunhaii&lt;/a&gt; Did we fix this issue with the PR you merged?&lt;/p&gt;</comment>
                            <comment id="17411749" author="gaoyunhaii" created="Wed, 8 Sep 2021 07:39:32 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt;&#160;the issue would be fixed after we also merge&#160;&lt;a href=&quot;https://github.com/apache/flink/pull/17165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/17165&lt;/a&gt;, I&apos;ll have a double look ~&lt;/p&gt;</comment>
                            <comment id="17412052" author="gaoyunhaii" created="Wed, 8 Sep 2021 16:11:08 +0000"  >&lt;p&gt;Fixed on master via 6eff01b07eb5704dda5c9a48dc75603ffb70049f and c740f9269ab2836a69cc3fac9dc4a670f6aa86d2&lt;br/&gt;
Fixed on release-1.14 via 3a8a6b0d998bc66195de93d8b92dceca9cf94e71 and b56041b9acc8fafa2ab1500e9162bed7bbcb333d&lt;/p&gt;

&lt;p&gt;I&apos;ll close the issue for now, we could reopen it if it reproduced~&lt;/p&gt;</comment>
                            <comment id="17477644" author="till.rohrmann" created="Tue, 18 Jan 2022 08:14:10 +0000"  >&lt;p&gt;It happened again: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=16008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=16008&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17477645" author="till.rohrmann" created="Tue, 18 Jan 2022 08:15:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=10402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=10402&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17477646" author="till.rohrmann" created="Tue, 18 Jan 2022 08:15:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=16828&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29598&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=16828&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17477647" author="gaoyunhaii" created="Tue, 18 Jan 2022 08:18:46 +0000"  >&lt;p&gt;l&apos;ll have a look~&lt;/p&gt;</comment>
                            <comment id="17478366" author="gaoyunhaii" created="Wed, 19 Jan 2022 07:17:10 +0000"  >&lt;p&gt;This seems to be due to different reason.&#160;&lt;/p&gt;

&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt; , by binary search it seems with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-25395&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-25395&lt;/a&gt; the running time of PartiallyFinishedSourcesITCase#test&lt;span class=&quot;error&quot;&gt;&amp;#91;complex graph SINGLE_SUBTASK, failover: true, strategy: region&amp;#93;&lt;/span&gt; has increased from 2s to about 1 minute, the case is blocked on restoring state after failover:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;transform-2-keyed (1/4)#1&quot;&lt;/span&gt; #1517 prio=5 os_prio=31 tid=0x00007f862136a000 nid=0x10423 runnable [0x0000700011fee000]
&#160;&#160; java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: RUNNABLE
	at java.io.FileInputStream.readBytes(Native Method)
	at java.io.FileInputStream.read(FileInputStream.java:255)
	at org.apache.flink.core.fs.local.LocalDataInputStream.read(LocalDataInputStream.java:73)
	at org.apache.flink.core.fs.FSDataInputStreamWrapper.read(FSDataInputStreamWrapper.java:60)
	at org.apache.flink.runtime.util.ForwardingInputStream.read(ForwardingInputStream.java:52)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.flink.api.java.typeutils.runtime.DataInputViewStream.read(DataInputViewStream.java:68)
	at com.esotericsoftware.kryo.io.Input.fill(Input.java:146)
	at org.apache.flink.api.java.typeutils.runtime.NoFetchingInput.require(NoFetchingInput.java:77)
	at com.esotericsoftware.kryo.io.Input.readAscii_slow(Input.java:598)
	at com.esotericsoftware.kryo.io.Input.readAscii(Input.java:576)
	at com.esotericsoftware.kryo.io.Input.readString(Input.java:454)
	at com.esotericsoftware.kryo.serializers.DefaultSerializers$StringSerializer.read(DefaultSerializers.java:177)
	at com.esotericsoftware.kryo.serializers.DefaultSerializers$StringSerializer.read(DefaultSerializers.java:166)
	at com.esotericsoftware.kryo.Kryo.readObjectOrNull(Kryo.java:730)
	at com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:113)
	at com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)
	at com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:761)
	at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.deserialize(KryoSerializer.java:402)
	at org.apache.flink.runtime.state.heap.StateTableByKeyGroupReaders.lambda$createV2PlusReader$0(StateTableByKeyGroupReaders.java:78)
	at org.apache.flink.runtime.state.heap.StateTableByKeyGroupReaders$$Lambda$2196/1169355256.readElement(Unknown Source)
	at org.apache.flink.runtime.state.KeyGroupPartitioner$PartitioningResultKeyGroupReader.readMappingsInKeyGroup(KeyGroupPartitioner.java:297)
	at org.apache.flink.runtime.state.heap.HeapRestoreOperation.readKeyGroupStateData(HeapRestoreOperation.java:258)
	at org.apache.flink.runtime.state.heap.HeapRestoreOperation.readStateHandleStateData(HeapRestoreOperation.java:220)
	at org.apache.flink.runtime.state.heap.HeapRestoreOperation.restore(HeapRestoreOperation.java:166)
	at org.apache.flink.runtime.state.heap.HeapRestoreOperation.restore(HeapRestoreOperation.java:62)
	at org.apache.flink.runtime.state.heap.HeapKeyedStateBackendBuilder.restoreState(HeapKeyedStateBackendBuilder.java:169)
	at org.apache.flink.runtime.state.heap.HeapKeyedStateBackendBuilder.build(HeapKeyedStateBackendBuilder.java:106)
	at org.apache.flink.runtime.state.hashmap.HashMapStateBackend.createKeyedStateBackend(HashMapStateBackend.java:137) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Could you help to have a look~?&lt;/p&gt;

&lt;p&gt;The commit before the PR on the master branch is 265a0a0708ae743c63505bb02e0659984a565fbb and the commit right after the PR is&#160;4691b66545010ed812624a259869c7a522663720 .&#160;&lt;/p&gt;</comment>
                            <comment id="17478475" author="till.rohrmann" created="Wed, 19 Jan 2022 09:29:46 +0000"  >&lt;p&gt;Another instance: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29668&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=10402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29668&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=10402&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17478479" author="till.rohrmann" created="Wed, 19 Jan 2022 09:30:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29668&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=16828&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=29668&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=16828&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17478483" author="roman_khachatryan" created="Wed, 19 Jan 2022 09:35:28 +0000"  >&lt;p&gt;Hi Yun, sure, I&apos;ll take a look.&lt;/p&gt;

&lt;p&gt;As for the mentioned commit, it reverted RocksDB snapshotting back to the older behavior which is slower. So the increase there is expected.&lt;/p&gt;</comment>
                            <comment id="17478573" author="gaoyunhaii" created="Wed, 19 Jan 2022 10:52:39 +0000"  >&lt;p&gt;Very thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt; for the explanation! If the behavior is expected, I think I could first try to modify the test to reduce the running time or extend the waiting time. And for the long run, does it affect normal jobs in realistic and do we have plan to reduce this part~?&lt;/p&gt;</comment>
                            <comment id="17478849" author="roman_khachatryan" created="Wed, 19 Jan 2022 17:49:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaoyunhaii&quot; class=&quot;user-hover&quot; rel=&quot;gaoyunhaii&quot;&gt;gaoyunhaii&lt;/a&gt;, I found that the reason is actually the 2nd commit from &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-25395&quot; title=&quot;FileNotFoundException during recovery caused by Incremental shared state being discarded by TM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-25395&quot;&gt;&lt;del&gt;FLINK-25395&lt;/del&gt;&lt;/a&gt;, which added keyed state to one of the test operators.&lt;/p&gt;

&lt;p&gt;That state can grow significantly because the stream is keyed by all the fields of an element, including sequenceNumber (so each stream element creates a separate state entry which also probably causes memory pressure).&#160;&lt;/p&gt;

&lt;p&gt;I prepared a PR to fix keying: &lt;a href=&quot;https://github.com/apache/flink/pull/18403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/18403&lt;/a&gt;. Locally, the runtime is reduced from ~14s to ~5sec.&lt;/p&gt;

&lt;p&gt;Could you take a look at it?&lt;/p&gt;</comment>
                            <comment id="17479115" author="gaoyunhaii" created="Thu, 20 Jan 2022 06:36:39 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt;&#160; for the PR! LGTM and merged via&#160;d33c39d974f08a5ac520f220219ecb0796c9448c.&#160;&lt;/p&gt;

&lt;p&gt;Locally the issue is fixed, if it does not happen in the following period I&apos;ll close this issue~&lt;/p&gt;</comment>
                            <comment id="17481581" author="gaoyunhaii" created="Tue, 25 Jan 2022 06:44:47 +0000"  >&lt;p&gt;Would close this issue since it does not occur. We could reopen it if it re-occur&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13399487">FLINK-24160</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13418691">FLINK-25395</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0umw8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>