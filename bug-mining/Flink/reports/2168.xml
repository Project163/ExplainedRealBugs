<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:31:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8355] DataSet Should not union a NULL row for AGG without GROUP BY clause.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8355</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently &lt;tt&gt;DataSetAggregateWithNullValuesRule&lt;/tt&gt; will UINON a NULL row for  non grouped aggregate query. when &lt;tt&gt;CountAggFunction&lt;/tt&gt; support &lt;tt&gt;COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/tt&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8325&quot; title=&quot;Add COUNT AGG support constant parameter, i.e. COUNT(*), COUNT(1) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8325&quot;&gt;&lt;del&gt;FLINK-8325&lt;/del&gt;&lt;/a&gt;).  the result will incorrect.&lt;br/&gt;
for example, if Tabble &lt;tt&gt;T1&lt;/tt&gt; has 3 records. when we run the follow SQL in DataSet: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SELECT COUNT(*) as cnt from Tab &lt;span class=&quot;code-comment&quot;&gt;// cnt = 4(incorrect).&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13128248">FLINK-8355</key>
            <summary>DataSet Should not union a NULL row for AGG without GROUP BY clause.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sunjincheng121">sunjincheng</assignee>
                                    <reporter username="sunjincheng121">sunjincheng</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jan 2018 14:38:01 +0000</created>
                <updated>Fri, 19 Jan 2018 22:14:27 +0000</updated>
                            <resolved>Fri, 19 Jan 2018 22:14:27 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.4.1</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16318619" author="fhueske" created="Tue, 9 Jan 2018 15:40:20 +0000"  >&lt;p&gt;The motivation for the &lt;tt&gt;DataSetAggregateWithNullValuesRule&lt;/tt&gt; is to prevent incorrect aggreagtion results for empty tables. For instance the query &lt;tt&gt;SELECT COUNT( *) FROM mytable&lt;/tt&gt; should return a row &lt;tt&gt;(0)&lt;/tt&gt; and not an empty result. &lt;/p&gt;

&lt;p&gt;Until now, the built-in aggregations were working correctly because they ignored &lt;tt&gt;null&lt;/tt&gt; values. However, UDAGGs might compute incorrect results if they would not ignore &lt;tt&gt;null&lt;/tt&gt; values. Hence, it definitely makes sense to remove the rule.&lt;/p&gt;

&lt;p&gt;A solution would be to add a &lt;tt&gt;MapPartitionFunction&lt;/tt&gt; with parallelism 1 after a groupless aggregation. The &lt;tt&gt;MapPartitionFunction&lt;/tt&gt; would simply forward all input data. If the input is empty, it emits a single result row with all aggregates at initialized state.&lt;/p&gt;</comment>
                            <comment id="16325903" author="sunjincheng121" created="Mon, 15 Jan 2018 05:41:01 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt; Thanks for your suggestion. I open the PR(&lt;a href=&quot;https://github.com/apache/flink/pull/5241)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5241)&lt;/a&gt;&#160;with&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8325&quot; title=&quot;Add COUNT AGG support constant parameter, i.e. COUNT(*), COUNT(1) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8325&quot;&gt;&lt;del&gt;FLINK-8325&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Best,&lt;/p&gt;

&lt;p&gt;Jincheng&lt;/p&gt;</comment>
                            <comment id="16332738" author="githubbot" created="Fri, 19 Jan 2018 18:48:09 +0000"  >&lt;p&gt;GitHub user sunjincheng121 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8355&quot; title=&quot;DataSet Should not union a NULL row for AGG without GROUP BY clause.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8355&quot;&gt;&lt;del&gt;FLINK-8355&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; remove DataSetAggregateWithNullValuesRule.&lt;/p&gt;

&lt;p&gt;    &lt;b&gt;Thank you very much for contributing to Apache Flink - we are happy that you want to help us improve Flink. To help the community review your contribution in the best possible way, please go through the checklist below, which will get the contribution into a shape in which it can be best reviewed.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;    &lt;b&gt;Please understand that we do not do this to make contributions to Flink a hassle. In order to uphold a high standard of quality for code contributions, while at the same time managing a large number of contributions, we need contributors to prepare the contributions well, and give reviewers enough contextual information for the review. Please also understand that contributions that do not follow this guide will take longer to review and thus typically be picked up with lower priority by the community.&lt;/b&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    &lt;b&gt;(Remove DataSetAggregateWithNullValuesRule,DataSet Should not union a NULL row for AGG without GROUP BY clause..)&lt;/b&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;Add interface for `DataSetAggFunction`, and in non-grouped non-pre agg emits a single result row with all aggregates at initialized state.&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Change some test case.&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change added tests and can be verified as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;Add `testAggregateEmptyDataSets` in `AggregateITCase`&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Change some plan check test case.&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: ( no )&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: ( no )&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? ( no)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/sunjincheng121/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/sunjincheng121/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8355&quot; title=&quot;DataSet Should not union a NULL row for AGG without GROUP BY clause.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8355&quot;&gt;&lt;del&gt;FLINK-8355&lt;/del&gt;&lt;/a&gt;-PR&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5320.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5320.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5320&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e8c0b10189910cc14ffcce0dabe0ac5eb32e4396&lt;br/&gt;
Author: &#37329;&#31481; &amp;lt;jincheng.sunjc@...&amp;gt;&lt;br/&gt;
Date:   2018-01-03T15:13:49Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8325&quot; title=&quot;Add COUNT AGG support constant parameter, i.e. COUNT(*), COUNT(1) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8325&quot;&gt;&lt;del&gt;FLINK-8325&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Add COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;,COUNT(1) supported&lt;/p&gt;

&lt;p&gt;commit fe1b50bb095ee528b280a2a16b46dffa83b7e13d&lt;br/&gt;
Author: sunjincheng121 &amp;lt;sunjincheng121@...&amp;gt;&lt;br/&gt;
Date:   2018-01-06T16:15:02Z&lt;/p&gt;

&lt;p&gt;    Add SUM(2) supported in OVER window.&lt;/p&gt;

&lt;p&gt;commit 585bb2f152bedd1fdce68d62841e596a345c8d26&lt;br/&gt;
Author: sunjincheng121 &amp;lt;sunjincheng121@...&amp;gt;&lt;br/&gt;
Date:   2018-01-09T15:00:22Z&lt;/p&gt;

&lt;p&gt;    improve code arroding feedback&lt;/p&gt;

&lt;p&gt;commit 956a956608701fada55b56c69e675555fee6a45b&lt;br/&gt;
Author: sunjincheng121 &amp;lt;sunjincheng121@...&amp;gt;&lt;br/&gt;
Date:   2018-01-15T00:07:34Z&lt;/p&gt;

&lt;p&gt;    Fix non-merged aggregate bug &lt;span class=&quot;error&quot;&gt;&amp;#91;FlINK-8355&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;commit 4ae9b65e6e90afa99fcab13ff67c3540ef767d72&lt;br/&gt;
Author: sunjincheng121 &amp;lt;sunjincheng121@...&amp;gt;&lt;br/&gt;
Date:   2018-01-19T18:00:41Z&lt;/p&gt;

&lt;p&gt;    improve the code&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16332840" author="githubbot" created="Fri, 19 Jan 2018 19:59:38 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the PR @sunjincheng121.&lt;br/&gt;
    It looks very good. I&apos;ll run final tests and will merge it.&lt;/p&gt;

&lt;p&gt;    Fabian&lt;/p&gt;</comment>
                            <comment id="16332919" author="githubbot" created="Fri, 19 Jan 2018 21:39:11 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5320&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16332946" author="fhueske" created="Fri, 19 Jan 2018 22:14:27 +0000"  >&lt;p&gt;Fixed for 1.4.1 with bfe3ff07c3b4cfa710b78db0db588086182884ef&lt;br/&gt;
Fixed for 1.5.0 with 20faf262de9bb52aa614ff2d989a49e8ea82b963&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13127485">FLINK-8325</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 43 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ogtj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>