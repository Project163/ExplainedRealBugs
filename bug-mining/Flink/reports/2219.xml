<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7124] Allow to rescale JobGraph on JobManager</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7124</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In order to support dynamic scaling, the &lt;tt&gt;JobManager&lt;/tt&gt; has to be able to change the parallelism of the submitted &lt;tt&gt;JobGraph&lt;/tt&gt;. This basically entails that we can change the parallelism settings on the cluster side.&lt;/p&gt;

&lt;p&gt;We already have the functionality that we can change the parallelism if it was set to &lt;tt&gt;ExecutionConfig.PARALLELISM_AUTO_MAX&lt;/tt&gt;. Therefore, I think the task is mostly about making sure that things really properly work when requesting a parallelism change.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13085427">FLINK-7124</key>
            <summary>Allow to rescale JobGraph on JobManager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tzulitai">Tzu-Li (Gordon) Tai</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Jul 2017 07:04:47 +0000</created>
                <updated>Sat, 10 Feb 2018 22:51:33 +0000</updated>
                            <resolved>Sat, 10 Feb 2018 22:50:38 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16100231" author="till.rohrmann" created="Tue, 25 Jul 2017 15:44:11 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tzulitai&quot; class=&quot;user-hover&quot; rel=&quot;tzulitai&quot;&gt;tzulitai&lt;/a&gt;, what&apos;s the state of this issue?&lt;/p&gt;</comment>
                            <comment id="16101083" author="tzulitai" created="Wed, 26 Jul 2017 02:33:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann@apache.org&quot;&gt;trohrmann@apache.org&lt;/a&gt;&lt;br/&gt;
I was blocked on fixes and testing for Flink 1.3.2 at the moment and haven&apos;t started with this yet.&lt;br/&gt;
My intention is to start with this issue near the end of the week.&lt;/p&gt;</comment>
                            <comment id="16121116" author="githubbot" created="Thu, 10 Aug 2017 06:13:17 +0000"  >&lt;p&gt;GitHub user tzulitai opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7124&quot; title=&quot;Allow to rescale JobGraph on JobManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7124&quot;&gt;&lt;del&gt;FLINK-7124&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;flip-6&amp;#93;&lt;/span&gt; Add test to verify rescaling JobGraphs works correctly&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This pull request adds test to verify that rescaling `JobGraph`s to arbitrary valid DOPs works correctly, such that the generated `ExecutionGraph` of each rescale is correct.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add `ExecutionGraphRescalingTest` class.&lt;/li&gt;
	&lt;li&gt;Contains a test that consecutively rescales (up and down) a given `JobGraph`.&lt;/li&gt;
	&lt;li&gt;Contains a test that rescales to DOP beyond max parallelism. `TODO` ignored for now since the test doesn&apos;t properly fail as expected.&lt;/li&gt;
	&lt;li&gt;`&lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt;` refactor `ExecutionGraphConstructionTest` to share utility graph validation code.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    The changes themselves are a verification of existing features. See above.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The serializers: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? &lt;b&gt;no&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? &lt;b&gt;not applicable&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tzulitai/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tzulitai/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7124&quot; title=&quot;Allow to rescale JobGraph on JobManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7124&quot;&gt;&lt;del&gt;FLINK-7124&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4510&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit ce4635f209c91241757662fda9e894557bac298b&lt;br/&gt;
Author: Tzu-Li (Gordon) Tai &amp;lt;tzulitai@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-08-10T05:41:40Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7124&quot; title=&quot;Allow to rescale JobGraph on JobManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7124&quot;&gt;&lt;del&gt;FLINK-7124&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;flip-6&amp;#93;&lt;/span&gt; Add test to verify rescaling JobGraphs works correctly&lt;/p&gt;

&lt;p&gt;    This commit adds two tests to verify behaviours of rescaling JobGraphs:&lt;br/&gt;
    1. JobGraphs can be consecutively rescaled to arbitrary valid DOPs&lt;br/&gt;
    2. Rescaling beyond max parallelism would fail&lt;/p&gt;

&lt;p&gt;    The second test, however, is temporarily disabled for now since it&lt;br/&gt;
    doesn&apos;t properly fail.&lt;/p&gt;

&lt;p&gt;commit d2ecca2428d1801b4e96233c83216992da13a9bb&lt;br/&gt;
Author: Tzu-Li (Gordon) Tai &amp;lt;tzulitai@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-08-10T05:57:09Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; Refactor graph verification code in ExecutionGraphConstructionTest&lt;/p&gt;

&lt;p&gt;    The refactoring resuses utility methods in ExecutionGraphTestUtils to&lt;br/&gt;
    verify constructed ExecutionGraphs.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16121120" author="githubbot" created="Thu, 10 Aug 2017 06:15:26 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    R: @tillrohrmann &lt;/p&gt;</comment>
                            <comment id="16153754" author="githubbot" created="Tue, 5 Sep 2017 14:41:21 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137005513&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137005513&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph}
&lt;p&gt;,&lt;br/&gt;
    + * constructed &lt;/p&gt;
{@link ExecutionGraph}
&lt;p&gt;s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Why is this the case? I think we should remove this limitation as stated by your TODO.&lt;/p&gt;</comment>
                            <comment id="16153755" author="githubbot" created="Tue, 5 Sep 2017 14:41:21 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137005950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137005950&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph},&lt;br/&gt;
    + * constructed {@link ExecutionGraph}s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		ExecutionGraph eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				5,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(5, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify scaling up works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				10,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(10, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify down scaling works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +			null,&lt;br/&gt;
    +			jobGraph,&lt;br/&gt;
    +			config,&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +			Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +			new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +			AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +			new NoRestartStrategy(),&lt;br/&gt;
    +			new UnregisteredMetricsGroup(),&lt;br/&gt;
    +			2,&lt;br/&gt;
    +			TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(2, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Verifies that building an {@link ExecutionGraph} from a {@link JobGraph}
&lt;p&gt; with&lt;br/&gt;
    +	 * parallelism higher than the maximum parallelism fails.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * TODO this test is ignored, since currently the rescale does not properly fail when rescaling to DOP above max.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    What happens if we rescale to something higher?&lt;/p&gt;</comment>
                            <comment id="16154961" author="githubbot" created="Wed, 6 Sep 2017 07:57:58 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137196004&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137196004&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph},&lt;br/&gt;
    + * constructed {@link ExecutionGraph}s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		ExecutionGraph eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				5,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(5, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify scaling up works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				10,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(10, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify down scaling works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +			null,&lt;br/&gt;
    +			jobGraph,&lt;br/&gt;
    +			config,&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +			Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +			new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +			AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +			new NoRestartStrategy(),&lt;br/&gt;
    +			new UnregisteredMetricsGroup(),&lt;br/&gt;
    +			2,&lt;br/&gt;
    +			TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(2, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Verifies that building an {@link ExecutionGraph} from a {@link JobGraph}
&lt;p&gt; with&lt;br/&gt;
    +	 * parallelism higher than the maximum parallelism fails.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * TODO this test is ignored, since currently the rescale does not properly fail when rescaling to DOP above max.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann currently the rescale doesn&apos;t fail, and the created `ExecutionGraph` will have DOP as specified (above max).&lt;/p&gt;</comment>
                            <comment id="16154965" author="githubbot" created="Wed, 6 Sep 2017 08:00:17 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137196450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137196450&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph}
&lt;p&gt;,&lt;br/&gt;
    + * constructed &lt;/p&gt;
{@link ExecutionGraph}
&lt;p&gt;s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    AFAIK, the only limitation causing this is how the parallelism is verified in `ExecutionGraphBuilder.buildGraph`. Though I&apos;m not sure of why we needed that verification in the first place, it should be fairly simple to remove this limitation. Was planning to do that as a separate PR, while using this PR to first get some consensus on this.&lt;/p&gt;</comment>
                            <comment id="16154969" author="githubbot" created="Wed, 6 Sep 2017 08:05:31 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137197610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137197610&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph}
&lt;p&gt;,&lt;br/&gt;
    + * constructed &lt;/p&gt;
{@link ExecutionGraph}
&lt;p&gt;s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think this can be included in this PR because that&apos;s what the scope of the issue is about.&lt;/p&gt;</comment>
                            <comment id="16154971" author="githubbot" created="Wed, 6 Sep 2017 08:07:20 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137197996&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137197996&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph},&lt;br/&gt;
    + * constructed {@link ExecutionGraph}s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		ExecutionGraph eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				5,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(5, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify scaling up works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				10,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(10, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify down scaling works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +			null,&lt;br/&gt;
    +			jobGraph,&lt;br/&gt;
    +			config,&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +			Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +			new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +			AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +			new NoRestartStrategy(),&lt;br/&gt;
    +			new UnregisteredMetricsGroup(),&lt;br/&gt;
    +			2,&lt;br/&gt;
    +			TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(2, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Verifies that building an {@link ExecutionGraph} from a {@link JobGraph}
&lt;p&gt; with&lt;br/&gt;
    +	 * parallelism higher than the maximum parallelism fails.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * TODO this test is ignored, since currently the rescale does not properly fail when rescaling to DOP above max.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I mean it makes sense for operators to be scalable beyond max parallelism which don&apos;t have keyed state (not sure whether we do this distinction). For operators with keyed state a scaling beyond max parallelism should produce a proper failure message. Maybe we can add this.&lt;/p&gt;</comment>
                            <comment id="16154978" author="githubbot" created="Wed, 6 Sep 2017 08:14:35 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137199417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137199417&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph}
&lt;p&gt;,&lt;br/&gt;
    + * constructed &lt;/p&gt;
{@link ExecutionGraph}
&lt;p&gt;s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Ok makes sense. I&apos;ll include that here.&lt;/p&gt;</comment>
                            <comment id="16156061" author="githubbot" created="Wed, 6 Sep 2017 21:29:23 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510#discussion_r137395149&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510#discussion_r137395149&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,235 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.executiongraph;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.ExecutionConfig;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.checkpoint.StandaloneCheckpointRecoveryFactory;&lt;br/&gt;
    +import org.apache.flink.runtime.executiongraph.restart.NoRestartStrategy;&lt;br/&gt;
    +import org.apache.flink.runtime.io.network.partition.ResultPartitionType;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.DistributionPattern;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobGraph;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.JobVertex;&lt;br/&gt;
    +import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;&lt;br/&gt;
    +import org.apache.flink.runtime.testingUtils.TestingUtils;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.junit.Ignore;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertEquals;&lt;br/&gt;
    +import static org.junit.Assert.fail;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * This class contains tests that verify when rescaling a &lt;/p&gt;
{@link JobGraph},&lt;br/&gt;
    + * constructed {@link ExecutionGraph}s are correct.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ExecutionGraphRescalingTest {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger TEST_LOGGER = LoggerFactory.getLogger(ExecutionGraphRescalingTest.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testExecutionGraphArbitraryDopConstructionTest() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final Configuration config = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		final JobVertex[] jobVertices = createVerticesForSimpleBipartiteJobGraph();&lt;br/&gt;
    +		final JobGraph jobGraph = new JobGraph(jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		ExecutionGraph eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				5,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(5, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify scaling up works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +				null,&lt;br/&gt;
    +				jobGraph,&lt;br/&gt;
    +				config,&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				TestingUtils.defaultExecutor(),&lt;br/&gt;
    +				new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +				Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +				new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +				AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +				new NoRestartStrategy(),&lt;br/&gt;
    +				new UnregisteredMetricsGroup(),&lt;br/&gt;
    +				10,&lt;br/&gt;
    +				TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(10, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +&lt;br/&gt;
    +		// &amp;#8212; verify down scaling works correctly &amp;#8212;&lt;br/&gt;
    +&lt;br/&gt;
    +		// TODO rescaling the JobGraph is currently only supported if the&lt;br/&gt;
    +		// TODO configured parallelism is ExecutionConfig.PARALLELISM_AUTO_MAX.&lt;br/&gt;
    +		// TODO this limitation should be removed.&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			jv.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		eg = ExecutionGraphBuilder.buildGraph(&lt;br/&gt;
    +			null,&lt;br/&gt;
    +			jobGraph,&lt;br/&gt;
    +			config,&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			TestingUtils.defaultExecutor(),&lt;br/&gt;
    +			new Scheduler(TestingUtils.defaultExecutionContext()),&lt;br/&gt;
    +			Thread.currentThread().getContextClassLoader(),&lt;br/&gt;
    +			new StandaloneCheckpointRecoveryFactory(),&lt;br/&gt;
    +			AkkaUtils.getDefaultTimeout(),&lt;br/&gt;
    +			new NoRestartStrategy(),&lt;br/&gt;
    +			new UnregisteredMetricsGroup(),&lt;br/&gt;
    +			2,&lt;br/&gt;
    +			TEST_LOGGER);&lt;br/&gt;
    +&lt;br/&gt;
    +		for (JobVertex jv : jobVertices) {
    +			assertEquals(2, jv.getParallelism());
    +		}&lt;br/&gt;
    +		verifyGeneratedExecutionGraphOfSimpleBitartiteJobGraph(eg, jobVertices);&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Verifies that building an {@link ExecutionGraph} from a {@link JobGraph}
&lt;p&gt; with&lt;br/&gt;
    +	 * parallelism higher than the maximum parallelism fails.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * TODO this test is ignored, since currently the rescale does not properly fail when rescaling to DOP above max.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I like that `maxParallelism` applies to all operators as a constraint.&lt;/p&gt;</comment>
                            <comment id="16337902" author="githubbot" created="Wed, 24 Jan 2018 17:10:05 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tzulitai is anything left to do here?&lt;/p&gt;</comment>
                            <comment id="16359661" author="till.rohrmann" created="Sat, 10 Feb 2018 22:50:38 +0000"  >&lt;p&gt;Fixed via&#160;&lt;/p&gt;

&lt;p&gt;5fe31cbf26f35ae6921d543d362d2d9f006f45db&lt;/p&gt;

&lt;p&gt;aee578b14dab17d56e7ee6e08f02c9d858ebec5b&lt;/p&gt;</comment>
                            <comment id="16359662" author="githubbot" created="Sat, 10 Feb 2018 22:51:33 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4510&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h8bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>