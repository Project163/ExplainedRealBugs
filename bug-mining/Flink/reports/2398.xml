<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8286] Fix Flink-Yarn-Kerberos integration for FLIP-6</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8286</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The current Flink-Yarn-Kerberos in Flip-6 is broken. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13125719">FLINK-8286</key>
            <summary>Fix Flink-Yarn-Kerberos integration for FLIP-6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="suez1224">Shuyi Chen</assignee>
                                    <reporter username="suez1224">Shuyi Chen</reporter>
                        <labels>
                            <label>flip-6</label>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 18 Dec 2017 21:10:14 +0000</created>
                <updated>Thu, 18 Jun 2020 08:18:06 +0000</updated>
                            <resolved>Tue, 8 May 2018 13:55:20 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Deployment / YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16419037" author="till.rohrmann" created="Thu, 29 Mar 2018 14:00:03 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suez1224&quot; class=&quot;user-hover&quot; rel=&quot;suez1224&quot;&gt;suez1224&lt;/a&gt;, what are the problems you&apos;ve observed with Kerberos?&lt;/p&gt;</comment>
                            <comment id="16444149" author="aljoscha" created="Thu, 19 Apr 2018 14:47:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suez1224&quot; class=&quot;user-hover&quot; rel=&quot;suez1224&quot;&gt;suez1224&lt;/a&gt; Is there any update on this?&lt;/p&gt;</comment>
                            <comment id="16445560" author="suez1224" created="Fri, 20 Apr 2018 09:55:19 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;, the context is that there is a regression in flink kerberos yarn integration in 1.4, which is addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;FLINK-8275&lt;/a&gt;. This task is created at that time to make sure that there is no regression on flip6 as well. I&apos;ll take a look the next few days.&lt;/p&gt;

&lt;p&gt;Also, can you point me to some existing integration tests for flip6 deployment that actually run a streaming/batch job on a mini-YARN cluster? Thanks.&lt;/p&gt;</comment>
                            <comment id="16447411" author="suez1224" created="Sun, 22 Apr 2018 23:29:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt;, spent some time on this, the Flink-Yarn-Kerberos integration is also broken. I&apos;ll provide a fix soon.&lt;/p&gt;</comment>
                            <comment id="16447648" author="githubbot" created="Mon, 23 Apr 2018 07:02:47 +0000"  >&lt;p&gt;GitHub user suez1224 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8286&quot; title=&quot;Fix Flink-Yarn-Kerberos integration for FLIP-6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8286&quot;&gt;&lt;del&gt;FLINK-8286&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Security&amp;#93;&lt;/span&gt; Fix kerberos security configuration for YarnTaskExecutor&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Fix broken YARN kerberos integration for flip-6.&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fix kerberos onfigurations.&lt;/li&gt;
	&lt;li&gt;Refactor code.&lt;/li&gt;
	&lt;li&gt;Add unittest.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change added tests and can be verified as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*Added test that validates kerberos credentials are set correctly *&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: ( no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no )&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/suez1224/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/suez1224/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8286&quot; title=&quot;Fix Flink-Yarn-Kerberos integration for FLIP-6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8286&quot;&gt;&lt;del&gt;FLINK-8286&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5896&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit dfeb614c5d5ecba21390c4ee7ceefdefa3a48bf1&lt;br/&gt;
Author: Shuyi Chen &amp;lt;shuyi@...&amp;gt;&lt;br/&gt;
Date:   2018-04-23T00:35:37Z&lt;/p&gt;

&lt;p&gt;    Fix kerberos security configuration for YarnTaskExecutor&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16458774" author="aljoscha" created="Mon, 30 Apr 2018 17:14:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=suez1224&quot; class=&quot;user-hover&quot; rel=&quot;suez1224&quot;&gt;suez1224&lt;/a&gt; Could you describe a bit what the problem was and how this fixes it? I&apos;m also mostly interested in why &lt;tt&gt;YARNSessionFIFOSecuredITCase&lt;/tt&gt; didn&apos;t fail, for example.&lt;/p&gt;</comment>
                            <comment id="16458784" author="githubbot" created="Mon, 30 Apr 2018 17:27:22 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185052704&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185052704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
    +			LOG.error(t.getMessage(), t);
    +			return null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// configure local directory&lt;/li&gt;
	&lt;li&gt;if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    -				LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    -					&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    -			}&lt;/li&gt;
	&lt;li&gt;else {&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;/li&gt;
	&lt;li&gt;configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// tell akka to die in case of an error&lt;/li&gt;
	&lt;li&gt;configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;br/&gt;
    +		// configure local directory&lt;br/&gt;
    +		if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    +			LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    +				&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    +		}
&lt;p&gt;    +		else {&lt;br/&gt;
    +			LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;br/&gt;
    +			configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;br/&gt;
    +		}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String keytabPath = null;&lt;/li&gt;
	&lt;li&gt;if (remoteKeytabPath != null) {&lt;/li&gt;
	&lt;li&gt;File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;/li&gt;
	&lt;li&gt;keytabPath = f.getAbsolutePath();&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;keytab path: {}&quot;, keytabPath);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    +		// tell akka to die in case of an error&lt;br/&gt;
    +		configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +		try {&lt;br/&gt;
     			UserGroupInformation currentUser = UserGroupInformation.getCurrentUser();&lt;/p&gt;

&lt;p&gt;     			LOG.info(&quot;YARN daemon is running as: {} Yarn client user obtainer: {}&quot;,&lt;br/&gt;
     					currentUser.getShortUserName(), yarnClientUsername);&lt;/p&gt;

&lt;p&gt;    +			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Is the only change really that we always do this instead of having the check on `remoteKeytabPath`, as the old code had?&lt;/p&gt;

&lt;p&gt;    The old code had this on line 120:&lt;br/&gt;
    ```&lt;br/&gt;
    if (remoteKeytabPath != null) {&lt;br/&gt;
    	File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;br/&gt;
    	keytabPath = f.getAbsolutePath();&lt;br/&gt;
    	LOG.info(&quot;keytab path: {}&quot;, keytabPath);&lt;br/&gt;
    }&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="16458785" author="githubbot" created="Mon, 30 Apr 2018 17:27:22 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185050544&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185050544&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) {&lt;br/&gt;
    +			LOG.error(t.getMessage(), t);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Why is this exception being swallowed?&lt;/p&gt;</comment>
                            <comment id="16459237" author="githubbot" created="Mon, 30 Apr 2018 23:09:55 +0000"  >&lt;p&gt;Github user suez1224 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185135031&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185135031&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
    +			LOG.error(t.getMessage(), t);
    +			return null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// configure local directory&lt;/li&gt;
	&lt;li&gt;if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    -				LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    -					&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    -			}&lt;/li&gt;
	&lt;li&gt;else {&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;/li&gt;
	&lt;li&gt;configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// tell akka to die in case of an error&lt;/li&gt;
	&lt;li&gt;configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;br/&gt;
    +		// configure local directory&lt;br/&gt;
    +		if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    +			LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    +				&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    +		}
&lt;p&gt;    +		else {&lt;br/&gt;
    +			LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;br/&gt;
    +			configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;br/&gt;
    +		}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String keytabPath = null;&lt;/li&gt;
	&lt;li&gt;if (remoteKeytabPath != null) {&lt;/li&gt;
	&lt;li&gt;File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;/li&gt;
	&lt;li&gt;keytabPath = f.getAbsolutePath();&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;keytab path: {}&quot;, keytabPath);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    +		// tell akka to die in case of an error&lt;br/&gt;
    +		configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +		try {&lt;br/&gt;
     			UserGroupInformation currentUser = UserGroupInformation.getCurrentUser();&lt;/p&gt;

&lt;p&gt;     			LOG.info(&quot;YARN daemon is running as: {} Yarn client user obtainer: {}&quot;,&lt;br/&gt;
     					currentUser.getShortUserName(), yarnClientUsername);&lt;/p&gt;

&lt;p&gt;    +			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    No, this is a refactoring becaust that part of code is kinda redundant. &lt;/p&gt;

&lt;p&gt;    The real change is moving this code block below before the call to &quot;new SecurityConfiguration()&quot;:&lt;/p&gt;

&lt;p&gt;    configuration.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, f.getAbsolutePath());&lt;br/&gt;
    configuration.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);&lt;/p&gt;</comment>
                            <comment id="16459238" author="githubbot" created="Mon, 30 Apr 2018 23:09:55 +0000"  >&lt;p&gt;Github user suez1224 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185134529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185134529&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) {&lt;br/&gt;
    +			LOG.error(t.getMessage(), t);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Good point. Added exceptions to method signature and let caller handle it.&lt;/p&gt;</comment>
                            <comment id="16460696" author="githubbot" created="Wed, 2 May 2018 08:20:32 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185422695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185422695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
    +			LOG.error(t.getMessage(), t);
    +			return null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// configure local directory&lt;/li&gt;
	&lt;li&gt;if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    -				LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    -					&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    -			}&lt;/li&gt;
	&lt;li&gt;else {&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;/li&gt;
	&lt;li&gt;configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// tell akka to die in case of an error&lt;/li&gt;
	&lt;li&gt;configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;br/&gt;
    +		// configure local directory&lt;br/&gt;
    +		if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    +			LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    +				&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    +		}
&lt;p&gt;    +		else {&lt;br/&gt;
    +			LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;br/&gt;
    +			configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;br/&gt;
    +		}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String keytabPath = null;&lt;/li&gt;
	&lt;li&gt;if (remoteKeytabPath != null) {&lt;/li&gt;
	&lt;li&gt;File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;/li&gt;
	&lt;li&gt;keytabPath = f.getAbsolutePath();&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;keytab path: {}&quot;, keytabPath);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    +		// tell akka to die in case of an error&lt;br/&gt;
    +		configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +		try {&lt;br/&gt;
     			UserGroupInformation currentUser = UserGroupInformation.getCurrentUser();&lt;/p&gt;

&lt;p&gt;     			LOG.info(&quot;YARN daemon is running as: {} Yarn client user obtainer: {}&quot;,&lt;br/&gt;
     					currentUser.getShortUserName(), yarnClientUsername);&lt;/p&gt;

&lt;p&gt;    +			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I see, could you maybe split this PR in two commits then? One that does the refactoring and one that does the actual fix. This way, it&apos;s clearer what exactly the fix is.&lt;/p&gt;</comment>
                            <comment id="16461503" author="githubbot" created="Wed, 2 May 2018 19:06:38 +0000"  >&lt;p&gt;Github user suez1224 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896#discussion_r185606093&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896#discussion_r185606093&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskExecutorRunnerFactory.java &amp;#8212;&lt;br/&gt;
    @@ -73,61 +105,68 @@ public static void main(String[] args) {&lt;br/&gt;
     		SignalHandler.register(LOG);&lt;br/&gt;
     		JvmShutdownSafeguard.installAsShutdownHook(LOG);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;run(args);&lt;br/&gt;
    +		try 
{
    +			SecurityUtils.getInstalledContext().runSecured(
    +					YarnTaskExecutorRunnerFactory.create(System.getenv()));
    +		}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +			LOG.error(&quot;Exception occurred while launching Task Executor runner&quot;, e);
    +			throw new RuntimeException(e);
    +		}
&lt;p&gt;     	}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     	/**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The instance entry point for the YARN task executor. Obtains user group information and calls&lt;/li&gt;
	&lt;li&gt;* the main work method 
{@link TaskManagerRunner#runTaskManager(Configuration, ResourceID)}
&lt;p&gt;  as a&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* privileged action.&lt;br/&gt;
    +	 * Creates a 
{@link YarnTaskExecutorRunnerFactory.Runner}
&lt;p&gt;.&lt;br/&gt;
     	 *&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;* @param args The command line arguments.&lt;br/&gt;
    +	 * @param envs environment variables.&lt;br/&gt;
     	 */&lt;/li&gt;
	&lt;li&gt;private static void run(String[] args) {&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;All environment variables: {}&quot;, ENV);&lt;br/&gt;
    +	@VisibleForTesting&lt;br/&gt;
    +	protected static Runner create(Map&amp;lt;String, String&amp;gt; envs) {&lt;br/&gt;
    +		LOG.debug(&quot;All environment variables: {}&quot;, envs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String yarnClientUsername = ENV.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;/li&gt;
	&lt;li&gt;final String localDirs = ENV.get(Environment.LOCAL_DIRS.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;br/&gt;
    +		final String yarnClientUsername = envs.get(YarnConfigKeys.ENV_HADOOP_USER_NAME);&lt;br/&gt;
    +		final String localDirs = envs.get(Environment.LOCAL_DIRS.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working/local Directory: {}&quot;, localDirs);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String currDir = ENV.get(Environment.PWD.key());&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;br/&gt;
    +		final String currDir = envs.get(Environment.PWD.key());&lt;br/&gt;
    +		LOG.info(&quot;Current working Directory: {}&quot;, currDir);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPath = ENV.get(YarnConfigKeys.KEYTAB_PATH);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab path obtained {}&quot;, remoteKeytabPath);&lt;br/&gt;
    +		final String remoteKeytabPrincipal = envs.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;br/&gt;
    +		LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final String remoteKeytabPrincipal = ENV.get(YarnConfigKeys.KEYTAB_PRINCIPAL);&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;TM: remote keytab principal obtained {}&quot;, remoteKeytabPrincipal);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final Configuration configuration = GlobalConfiguration.loadConfiguration(currDir);&lt;br/&gt;
    +		final Configuration configuration;&lt;br/&gt;
    +		try 
{
    +			configuration = GlobalConfiguration.loadConfiguration(currDir);
     			FileSystem.initialize(configuration);
    +		}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
    +			LOG.error(t.getMessage(), t);
    +			return null;
    +		}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// configure local directory&lt;/li&gt;
	&lt;li&gt;if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    -				LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    -					&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    -			}&lt;/li&gt;
	&lt;li&gt;else {&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;/li&gt;
	&lt;li&gt;configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;// tell akka to die in case of an error&lt;/li&gt;
	&lt;li&gt;configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;br/&gt;
    +		// configure local directory&lt;br/&gt;
    +		if (configuration.contains(CoreOptions.TMP_DIRS)) 
{
    +			LOG.info(&quot;Overriding YARN&apos;s temporary file directories with those &quot; +
    +				&quot;specified in the Flink config: &quot; + configuration.getValue(CoreOptions.TMP_DIRS));
    +		}
&lt;p&gt;    +		else {&lt;br/&gt;
    +			LOG.info(&quot;Setting directories for temporary files to: {}&quot;, localDirs);&lt;br/&gt;
    +			configuration.setString(CoreOptions.TMP_DIRS, localDirs);&lt;br/&gt;
    +		}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String keytabPath = null;&lt;/li&gt;
	&lt;li&gt;if (remoteKeytabPath != null) {&lt;/li&gt;
	&lt;li&gt;File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;/li&gt;
	&lt;li&gt;keytabPath = f.getAbsolutePath();&lt;/li&gt;
	&lt;li&gt;LOG.info(&quot;keytab path: {}&quot;, keytabPath);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    +		// tell akka to die in case of an error&lt;br/&gt;
    +		configuration.setBoolean(AkkaOptions.JVM_EXIT_ON_FATAL_ERROR, true);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +		try {&lt;br/&gt;
     			UserGroupInformation currentUser = UserGroupInformation.getCurrentUser();&lt;/p&gt;

&lt;p&gt;     			LOG.info(&quot;YARN daemon is running as: {} Yarn client user obtainer: {}&quot;,&lt;br/&gt;
     					currentUser.getShortUserName(), yarnClientUsername);&lt;/p&gt;

&lt;p&gt;    +			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    @aljoscha done, please take another look. Thanks.&lt;/p&gt;</comment>
                            <comment id="16467319" author="githubbot" created="Tue, 8 May 2018 12:12:32 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @suez1224 I&apos;ll now merge the actual fix, but I&apos;m not 100 % sure the refactoring is correct.&lt;/p&gt;

&lt;p&gt;    After the fix, we have roughly this path through the code:&lt;br/&gt;
    ```&lt;br/&gt;
    if (keytabPath != null &amp;amp;&amp;amp; remoteKeytabPrincipal != null) &lt;/p&gt;
{
    	configuration.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, keytabPath);
    	configuration.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);
    }&lt;br/&gt;
    &lt;br/&gt;
    SecurityConfiguration sc = new SecurityConfiguration(configuration);&lt;br/&gt;
    &lt;br/&gt;
    SecurityUtils.install(sc);&lt;br/&gt;
    &lt;br/&gt;
    SecurityUtils.getInstalledContext().runSecured(new Callable&amp;lt;Void&amp;gt;() {&lt;br/&gt;
    	@Override&lt;br/&gt;
    	public Void call() throws Exception {
    		TaskManagerRunner.runTaskManager(configuration, new ResourceID(containerId));
    		return null;
    	}&lt;br/&gt;
    });&lt;br/&gt;
    ```&lt;br/&gt;
    &lt;br/&gt;
    after the fix, that becomes&lt;br/&gt;
    &lt;br/&gt;
    ```&lt;br/&gt;
    // in main()&lt;br/&gt;
    SecurityUtils.getInstalledContext().runSecured(&lt;br/&gt;
       YarnTaskExecutorRunnerFactory.create(System.getenv()));&lt;br/&gt;
    &lt;br/&gt;
    // in YarnTaskExecutorRunnerFactory.create()&lt;br/&gt;
    if (keytabPath != null &amp;amp;&amp;amp; remoteKeytabPrincipal != null) {
    	configuration.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, keytabPath);
    	configuration.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);
    }

&lt;p&gt;    SecurityConfiguration sc = new SecurityConfiguration(configuration);&lt;/p&gt;

&lt;p&gt;    SecurityUtils.install(sc);&lt;/p&gt;

&lt;p&gt;    return new Runner()&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    Meaning, that if someone messes with how things are called it can happen that `SecurityUtils.getInstalledContext()` is called before `SecurityUtils.install(sc)` is called in `YarnTaskExecutorRunnerFactory.create`. I think this can potentially lead to problems and the old path is much clearer. What do you think?&lt;/p&gt;
</comment>
                            <comment id="16467446" author="aljoscha" created="Tue, 8 May 2018 13:55:20 +0000"  >&lt;p&gt;release-1.5:&lt;br/&gt;
93d1c47a14ab500b07331b2c415c86973fbeca29&lt;/p&gt;

&lt;p&gt;master:&lt;br/&gt;
ba3e2711a2091b7c0907a5caf3ea527f837a442f&lt;/p&gt;</comment>
                            <comment id="16467447" author="githubbot" created="Tue, 8 May 2018 13:56:01 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merged, could you please close the PR after discussion of the refactoring?&lt;/p&gt;</comment>
                            <comment id="16468519" author="githubbot" created="Wed, 9 May 2018 07:53:08 +0000"  >&lt;p&gt;Github user suez1224 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @aljoscha that&apos;s a very good catch. I added another commit to make sure the call order is always correct (&lt;a href=&quot;https://github.com/apache/flink/pull/5896/commits/1298b04ea80b9160ac7e4ae8a171f80112a95945&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896/commits/1298b04ea80b9160ac7e4ae8a171f80112a95945&lt;/a&gt;). Could you please let me know what you think? I think we should have the unittest in place since this is the second time it breaks. I can create another PR for the refactoring commit.&lt;/p&gt;</comment>
                            <comment id="16469718" author="githubbot" created="Thu, 10 May 2018 00:02:25 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This PR seems to obfuscate the fix.  The issue was with the interpretation of the keytab path, right?  But the bulk of the change was to clarify the ordering of context installation vs use?&lt;/p&gt;</comment>
                            <comment id="16477391" author="githubbot" created="Wed, 16 May 2018 13:03:05 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @EronWright the fix is really one this: &lt;a href=&quot;https://github.com/apache/flink/commit/ba3e2711a2091b7c0907a5caf3ea527f837a442f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/ba3e2711a2091b7c0907a5caf3ea527f837a442f&lt;/a&gt; But I haven&apos;t yet managed to reproduce a failure on my system without the fix. Still working on it.&lt;/p&gt;</comment>
                            <comment id="16477394" author="githubbot" created="Wed, 16 May 2018 13:04:21 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5896&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @suez1224 Did you rebase on master? I think that krb5-specific could should not be there anymore.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3o19r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>