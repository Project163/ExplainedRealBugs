<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:16:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-31297] FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager unstable when running it a single time</title>
                <link>https://issues.apache.org/jira/browse/FLINK-31297</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;We noticed a weird test-instability in &lt;tt&gt;FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager&lt;/tt&gt; when switching to sequential test execution (see &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-31278&quot; title=&quot;exit code 137 (i.e. OutOfMemoryError) in core module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-31278&quot;&gt;FLINK-31278&lt;/a&gt;). I couldn&apos;t reproduce it in 1.16, therefore, marking it as a blocker for now. But it feels to be more of a test code issue.&lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=46671&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=24c3384f-1bcb-57b3-224f-51bf973bbee8&amp;amp;l=9695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=46671&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=24c3384f-1bcb-57b3-224f-51bf973bbee8&amp;amp;l=9695&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Mar 01 15:20:17 [ERROR] org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager  Time elapsed: 0.746 s  &amp;lt;&amp;lt;&amp;lt; FAILURE!
Mar 01 15:20:17 java.lang.AssertionError: 
Mar 01 15:20:17 
Mar 01 15:20:17 Expected size: 1 but was: 0 in:
Mar 01 15:20:17 []
Mar 01 15:20:17 	at org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager(FineGrainedSlotManagerTest.java:209)
Mar 01 15:20:17 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13526828">FLINK-31297</key>
            <summary>FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager unstable when running it a single time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="huwh">!huwh</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Thu, 2 Mar 2023 09:51:18 +0000</created>
                <updated>Mon, 6 Mar 2023 15:03:21 +0000</updated>
                            <resolved>Mon, 6 Mar 2023 13:30:04 +0000</resolved>
                                    <version>1.17.0</version>
                                    <fixVersion>1.17.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17695615" author="mapohl" created="Thu, 2 Mar 2023 09:53:02 +0000"  >&lt;p&gt;I can reproduce it locally &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=huwh&quot; class=&quot;user-hover&quot; rel=&quot;huwh&quot;&gt;huwh&lt;/a&gt; may you have a look at it?&lt;/p&gt;</comment>
                            <comment id="17695636" author="xzw0223" created="Thu, 2 Mar 2023 10:22:44 +0000"  >&lt;p&gt;After adding the PendingTaskManager, the pending is cleaned up in the registerTaskManager, I think the expected value should be 0 instead of 1.&lt;/p&gt;</comment>
                            <comment id="17695644" author="weijie guo" created="Thu, 2 Mar 2023 10:33:26 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt; for reporting this, I will take a look at this and contact &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=huwh&quot; class=&quot;user-hover&quot; rel=&quot;huwh&quot;&gt;huwh&lt;/a&gt; at the same time.&lt;/p&gt;</comment>
                            <comment id="17695649" author="weijie guo" created="Thu, 2 Mar 2023 10:37:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xzw0223&quot; class=&quot;user-hover&quot; rel=&quot;xzw0223&quot;&gt;xzw0223&lt;/a&gt; Thanks for looking into this, but I do not think directly change the expected value is the right approach. As the comments before the assertion, we can see that `task manager with allocated slot cannot deduct pending task manager`, the expected behavior is the pending taskmanager will not be reduced to 0, right?&lt;/p&gt;</comment>
                            <comment id="17695657" author="weijie guo" created="Thu, 2 Mar 2023 10:55:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt; By offline discuss with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=huwh&quot; class=&quot;user-hover&quot; rel=&quot;huwh&quot;&gt;huwh&lt;/a&gt;, this is just a test code issue, I think we can down the priority.&lt;/p&gt;</comment>
                            <comment id="17695659" author="mapohl" created="Thu, 2 Mar 2023 11:05:14 +0000"  >&lt;p&gt;Thanks for your verification &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I downgraded it to Critical. It&apos;s kind of blocking some efforts around &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-31278&quot; title=&quot;exit code 137 (i.e. OutOfMemoryError) in core module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-31278&quot;&gt;FLINK-31278&lt;/a&gt;, though.&lt;/p&gt;</comment>
                            <comment id="17695795" author="huwh" created="Thu, 2 Mar 2023 16:02:39 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt; for reporting this bug. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Weijie+Guo&quot; class=&quot;user-hover&quot; rel=&quot;Weijie Guo&quot;&gt;Weijie Guo&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xzw0223&quot; class=&quot;user-hover&quot; rel=&quot;xzw0223&quot;&gt;xzw0223&lt;/a&gt; for your attention.&lt;/p&gt;

&lt;p&gt;This bug was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-18229&quot; title=&quot;Pending worker requests should be properly cleared&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-18229&quot;&gt;&lt;del&gt;FLINK-18229&lt;/del&gt;&lt;/a&gt;. We release the pending task manager when these is no more resource requirements.&lt;/p&gt;

&lt;p&gt;In FineGrainedSlotManagerTest.testTaskManagerRegistrationDeductPendingTaskManager, we skip the FineGrainedSlotManager and invoke TaskManagerTracker.addPendingTaskManager directly to allocate pending task manager. This make the resource requirements different between SlotManager and TaskManagerTracker. After requirementCheckDelay(50ms by default), the requirement check will release the pending task manager.&lt;/p&gt;</comment>
                            <comment id="17696682" author="huwh" created="Mon, 6 Mar 2023 03:54:20 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xtsong&quot; class=&quot;user-hover&quot; rel=&quot;xtsong&quot;&gt;xtsong&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Weijie+Guo&quot; class=&quot;user-hover&quot; rel=&quot;Weijie Guo&quot;&gt;Weijie Guo&lt;/a&gt; Could you help review this bugfix.&lt;/p&gt;</comment>
                            <comment id="17696951" author="weijie guo" created="Mon, 6 Mar 2023 13:30:04 +0000"  >&lt;p&gt;master(1.18) via bec6a4589703bb7619cfc04bf69822995b49893f.&lt;br/&gt;
release-1.17 via c71d880dd01bddf926b4cebc33beb6c92b9aa25d.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13310548">FLINK-18229</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                                                <inwardlinks description="Discovered while testing">
                                        <issuelink>
            <issuekey id="13526647">FLINK-31278</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gamo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>