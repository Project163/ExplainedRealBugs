<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:36:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10763] Interval join produces wrong result type in Scala API</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10763</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When stream is a Scala case class, the TypeInformation will fall back to GenericType in the process function which result in bad performance when union another DataStream.&lt;/p&gt;

&lt;p&gt;In the union method of DataStream, the type is first checked for equality.&lt;/p&gt;

&lt;p&gt;Here is an example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
object Test {

    def main(args: Array[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;]): Unit = {
      val env = StreamExecutionEnvironment.getExecutionEnvironment

      val orderA: DataStream[Order] = env.fromCollection(Seq(
        Order(1L, &lt;span class=&quot;code-quote&quot;&gt;&quot;beer&quot;&lt;/span&gt;, 3),
         Order(1L, &lt;span class=&quot;code-quote&quot;&gt;&quot;diaper&quot;&lt;/span&gt;, 4),
         Order(3L, &lt;span class=&quot;code-quote&quot;&gt;&quot;rubber&quot;&lt;/span&gt;, 2)))

      val orderB: DataStream[Order] = env.fromCollection(Seq(
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Order(2L, &lt;span class=&quot;code-quote&quot;&gt;&quot;pen&quot;&lt;/span&gt;, 3),
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Order(2L, &lt;span class=&quot;code-quote&quot;&gt;&quot;rubber&quot;&lt;/span&gt;, 3),
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Order(4L, &lt;span class=&quot;code-quote&quot;&gt;&quot;beer&quot;&lt;/span&gt;, 1)))

      val orderC: DataStream[Order] = orderA.keyBy(_.user)
        .intervalJoin(orderB.keyBy(_.user))
        .between(Time.seconds(0), Time.seconds(0))
        .process(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ProcessJoinFunction[Order, Order, Order] {
          override def processElement(left: Order, right: Order, ctx: ProcessJoinFunction[Order, Order, Order]#Context, out: Collector[Order]): Unit = {
            out.collect(left)
          }})

      println(&lt;span class=&quot;code-quote&quot;&gt;&quot;C: &quot;&lt;/span&gt; + orderC.dataType.toString)
      println(&lt;span class=&quot;code-quote&quot;&gt;&quot;B: &quot;&lt;/span&gt; + orderB.dataType.toString)

      orderC.union(orderB).print()

      env.execute()
    }

    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Order(user: &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, product: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, amount: Int)
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is the Exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.IllegalArgumentException: Cannot union streams of different types: GenericType&amp;lt;com.manbuyun.awesome.flink.Test.Order&amp;gt; and com.manbuyun.awesome.flink.Test$Order(user: &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, product: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, amount: &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
 at org.apache.flink.streaming.api.datastream.DataStream.union(DataStream.java:219)
 at org.apache.flink.streaming.api.scala.DataStream.union(DataStream.scala:357)
 at com.manbuyun.awesome.flink.Test$.main(Test.scala:38)
 at com.manbuyun.awesome.flink.Test.main(Test.scala)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13195911">FLINK-10763</key>
            <summary>Interval join produces wrong result type in Scala API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="csbliss">jinhai</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 2 Nov 2018 14:50:38 +0000</created>
                <updated>Wed, 28 Nov 2018 17:40:45 +0000</updated>
                            <resolved>Wed, 28 Nov 2018 17:40:45 +0000</resolved>
                                    <version>1.6.2</version>
                                    <fixVersion>1.6.3</fixVersion>
                    <fixVersion>1.7.0</fixVersion>
                    <fixVersion>1.8.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16673214" author="githubbot" created="Fri, 2 Nov 2018 15:03:40 +0000"  >&lt;p&gt;manbuyun opened a new pull request #7007: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Cannot union streams of different types in the union method of DataStream class&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7007&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   JIRA Issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-10763&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   When stream is a Scala case class, the TypeInformation will fall back to GenericType in the process function which result in bad performance when union another DataStream&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16691810" author="githubbot" created="Mon, 19 Nov 2018 15:04:10 +0000"  >&lt;p&gt;twalthr opened a new pull request #7141: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Fix interval join return type in Scala&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7141&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   This PR fixes the wrong result type of interval joins in the DataStream Scala API. The API did not call the Scala type extraction stack but was using the default one offered by the DataStream Java API.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use Scala implicit type extraction instead&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   Existing test modified.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: yes&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? not applicable&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16691812" author="twalthr" created="Mon, 19 Nov 2018 15:06:36 +0000"  >&lt;p&gt;I looked into this issue. The union operator is not the problem here. Instead, the interval join produces a wrong result type because it relies on the Java instead of the Scala type extraction.&#160;&lt;/p&gt;</comment>
                            <comment id="16691817" author="githubbot" created="Mon, 19 Nov 2018 15:08:41 +0000"  >&lt;p&gt;twalthr commented on issue #7007: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Cannot union streams of different types in the union method of DataStream class&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7007#issuecomment-439924787&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7007#issuecomment-439924787&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks @manbuyun. But your PR only solves the symptom but not the cause. See the description in JIRA. I will close this.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16691818" author="githubbot" created="Mon, 19 Nov 2018 15:08:42 +0000"  >&lt;p&gt;twalthr closed pull request #7007: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Cannot union streams of different types in the union method of DataStream class&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7007&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java&lt;br/&gt;
index 271d9bec33f..a423c6d25f0 100644&lt;br/&gt;
&amp;#8212; a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java&lt;br/&gt;
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java&lt;br/&gt;
@@ -214,7 +214,7 @@ public ExecutionConfig getExecutionConfig() {&lt;br/&gt;
 		unionedTransforms.add(this.transformation);&lt;/p&gt;

&lt;p&gt; 		for (DataStream&amp;lt;T&amp;gt; newStream : streams) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (!getType().equals(newStream.getType())) {&lt;br/&gt;
+			if (!getType().getTypeClass().equals(newStream.getType().getTypeClass())) 
{
 				throw new IllegalArgumentException(&quot;Cannot union streams of different types: &quot;
 						+ getType() + &quot; and &quot; + newStream.getType());
 			}&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16691849" author="githubbot" created="Mon, 19 Nov 2018 15:23:27 +0000"  >&lt;p&gt;kl0u commented on a change in pull request #7141: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Fix interval join return type in Scala&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7141#discussion_r234660025&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7141#discussion_r234660025&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/KeyedStream.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -201,15 +201,18 @@ class KeyedStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T, K&amp;#93;&lt;/span&gt;(javaStream: KeyedJavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T, K&amp;#93;&lt;/span&gt;) extends DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return Returns a DataStream&lt;br/&gt;
       */&lt;br/&gt;
     @PublicEvolving&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def process&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt;(processJoinFunction: ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;IN1, IN2, OUT&amp;#93;&lt;/span&gt;): DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
+    def process&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT: TypeInformation&amp;#93;&lt;/span&gt;(&lt;br/&gt;
+        processJoinFunction: ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;IN1, IN2, OUT&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+      : DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
+&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I would suggest to have a specific var for the type info, sth like:&lt;br/&gt;
   `val outType : TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt; = implicitly[TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt;]`&lt;br/&gt;
   so that it stands out.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16693010" author="githubbot" created="Tue, 20 Nov 2018 10:22:10 +0000"  >&lt;p&gt;twalthr commented on issue #7141: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Fix interval join return type in Scala&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7141#issuecomment-440221163&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7141#issuecomment-440221163&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thank you @kl0u. I will address you minor comments and merge this.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16693015" author="githubbot" created="Tue, 20 Nov 2018 10:30:05 +0000"  >&lt;p&gt;asfgit closed pull request #7141: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10763&quot; title=&quot;Interval join produces wrong result type in Scala API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10763&quot;&gt;&lt;del&gt;FLINK-10763&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Fix interval join return type in Scala&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/7141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/7141&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/KeyedStream.scala b/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/KeyedStream.scala&lt;br/&gt;
index 580dd46d683..dc8df5035c0 100644&lt;br/&gt;
&amp;#8212; a/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/KeyedStream.scala&lt;br/&gt;
+++ b/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/KeyedStream.scala&lt;br/&gt;
@@ -201,7 +201,10 @@ class KeyedStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T, K&amp;#93;&lt;/span&gt;(javaStream: KeyedJavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T, K&amp;#93;&lt;/span&gt;) extends DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return Returns a DataStream&lt;br/&gt;
       */&lt;br/&gt;
     @PublicEvolving&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def process&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt;(processJoinFunction: ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;IN1, IN2, OUT&amp;#93;&lt;/span&gt;): DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;OUT&amp;#93;&lt;/span&gt; = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+    def process[OUT}&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/IntervalJoinITCase.scala b/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/IntervalJoinITCase.scala&lt;br/&gt;
index 80701c6725a..a9ace36cc49 100644&lt;br/&gt;
&amp;#8212; a/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/IntervalJoinITCase.scala&lt;br/&gt;
+++ b/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/IntervalJoinITCase.scala&lt;br/&gt;
@@ -18,6 +18,7 @@&lt;/p&gt;

&lt;p&gt; package org.apache.flink.streaming.api.scala&lt;/p&gt;

&lt;p&gt;+import org.apache.flink.api.scala.typeutils.CaseClassTypeInfo&lt;br/&gt;
 import org.apache.flink.streaming.api.TimeCharacteristic&lt;br/&gt;
 import org.apache.flink.streaming.api.functions.co.ProcessJoinFunction&lt;br/&gt;
 import org.apache.flink.streaming.api.functions.sink.SinkFunction&lt;br/&gt;
@@ -25,7 +26,8 @@ import org.apache.flink.streaming.api.functions.timestamps.AscendingTimestampExt&lt;br/&gt;
 import org.apache.flink.streaming.api.windowing.time.Time&lt;br/&gt;
 import org.apache.flink.test.util.AbstractTestBase&lt;br/&gt;
 import org.apache.flink.util.Collector&lt;br/&gt;
-import org.junit.&lt;/p&gt;
{Assert, Test}
&lt;p&gt;+import org.junit.Assert.assertTrue&lt;br/&gt;
+import org.junit.Test&lt;/p&gt;

&lt;p&gt; import scala.collection.mutable.ListBuffer&lt;/p&gt;

&lt;p&gt;@@ -47,22 +49,25 @@ class IntervalJoinITCase extends AbstractTestBase &lt;/p&gt;
{
 
     val sink = new ResultSink()
 
-    dataStream1.intervalJoin(dataStream2)
+    val join = dataStream1.intervalJoin(dataStream2)
       .between(Time.milliseconds(0), Time.milliseconds(2))
-      .process(new CombineToStringJoinFunction())
-      .addSink(sink)
+      .process(new CombineJoinFunction())
+
+    assertTrue(join.dataType.isInstanceOf[CaseClassTypeInfo[_]])
+
+    join.addSink(sink)
 
     env.execute()
 
     sink.expectInAnyOrder(
-      &quot;(key,0):(key,0)&quot;,
-      &quot;(key,0):(key,1)&quot;,
-      &quot;(key,0):(key,2)&quot;,
+      &quot;(key:key,0)&quot;,
+      &quot;(key:key,1)&quot;,
+      &quot;(key:key,2)&quot;,
 
-      &quot;(key,1):(key,1)&quot;,
-      &quot;(key,1):(key,2)&quot;,
+      &quot;(key:key,2)&quot;,
+      &quot;(key:key,3)&quot;,
 
-      &quot;(key,2):(key,2)&quot;
+      &quot;(key:key,4)&quot;
     )
   }

&lt;p&gt;@@ -82,18 +87,21 @@ class IntervalJoinITCase extends AbstractTestBase &lt;/p&gt;
{
 
     val sink = new ResultSink()
 
-    dataStream1.intervalJoin(dataStream2)
+    val join = dataStream1.intervalJoin(dataStream2)
       .between(Time.milliseconds(0), Time.milliseconds(2))
       .lowerBoundExclusive()
       .upperBoundExclusive()
-      .process(new CombineToStringJoinFunction())
-      .addSink(sink)
+      .process(new CombineJoinFunction())
+
+    assertTrue(join.dataType.isInstanceOf[CaseClassTypeInfo[_]])
+
+    join.addSink(sink)
 
     env.execute()
 
     sink.expectInAnyOrder(
-      &quot;(key,0):(key,1)&quot;,
-      &quot;(key,1):(key,2)&quot;
+      &quot;(key:key,1)&quot;,
+      &quot;(key:key,3)&quot;
     )
   }
&lt;p&gt; }&lt;br/&gt;
@@ -102,14 +110,14 @@ object Companion &lt;/p&gt;
{
   val results: ListBuffer[String] = new ListBuffer()
 }

&lt;p&gt;-class ResultSink extends SinkFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; {&lt;br/&gt;
+class ResultSink extends SinkFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long)&amp;#93;&lt;/span&gt; {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;override def invoke(value: String, context: SinkFunction.Context&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt;): Unit = {&lt;/li&gt;
	&lt;li&gt;Companion.results.append(value)&lt;br/&gt;
+  override def invoke(value: (String, Long), context: SinkFunction.Context&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt;): Unit = 
{
+    Companion.results.append(value.toString())
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   def expectInAnyOrder(expected: String*): Unit = &lt;/p&gt;
{
-    Assert.assertTrue(expected.toSet.equals(Companion.results.toSet))
+    assertTrue(expected.toSet.equals(Companion.results.toSet))
   }
&lt;p&gt; }&lt;/p&gt;

&lt;p&gt;@@ -117,14 +125,14 @@ class TimestampExtractor extends AscendingTimestampExtractor&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long)&amp;#93;&lt;/span&gt; &lt;/p&gt;
{
   override def extractAscendingTimestamp(element: (String, Long)): Long = element._2
 }

&lt;p&gt;-class CombineToStringJoinFunction&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long), (String, Long), String&amp;#93;&lt;/span&gt; {&lt;br/&gt;
+class CombineJoinFunction&lt;br/&gt;
+  extends ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long), (String, Long), (String, Long)&amp;#93;&lt;/span&gt; {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   override def processElement(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;left: (String, Long),&lt;/li&gt;
	&lt;li&gt;right: (String, Long),&lt;/li&gt;
	&lt;li&gt;ctx: ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long), (String, Long), String&amp;#93;&lt;/span&gt;#Context,&lt;/li&gt;
	&lt;li&gt;out: Collector&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;): Unit = {&lt;/li&gt;
	&lt;li&gt;out.collect(left + &quot;:&quot; + right)&lt;br/&gt;
+      left: (String, Long),&lt;br/&gt;
+      right: (String, Long),&lt;br/&gt;
+      ctx: ProcessJoinFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long), (String, Long), (String, Long)&amp;#93;&lt;/span&gt;#Context,&lt;br/&gt;
+      out: Collector&lt;span class=&quot;error&quot;&gt;&amp;#91;(String, Long)&amp;#93;&lt;/span&gt;): Unit = 
{
+    out.collect((left._1 + &quot;:&quot; + right._1, left._2 + right._2))
   }
&lt;p&gt; }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16693022" author="twalthr" created="Tue, 20 Nov 2018 10:36:20 +0000"  >&lt;p&gt;Fixed in master: f629b05a2cdc2c07f4a19456cf5b3e5fdd6ff607&lt;br/&gt;
Fixed in 1.7.1: 43aa594e9f0787e9e1c5fcddaa60e845a748a237&lt;br/&gt;
Fixed in 1.6.3: febd1c6f534a4108a0eaf6fa6847e2d01e0b0712&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s002gw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>