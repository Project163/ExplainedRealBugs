<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6001] NPE on TumblingEventTimeWindows with ContinuousEventTimeTrigger and allowedLateness</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6001</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I try to isolate the problem in a small and simple reproducer by extracting the data from my real setup.&lt;/p&gt;

&lt;p&gt;I fails with NPE at :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NullPointerException: null
	at org.apache.flink.streaming.api.windowing.triggers.ContinuousEventTimeTrigger.onEventTime(ContinuousEventTimeTrigger.java:81) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.runtime.operators.windowing.WindowOperator$Context.onEventTime(WindowOperator.java:721) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.runtime.operators.windowing.WindowOperator.onEventTime(WindowOperator.java:425) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.api.operators.HeapInternalTimerService.advanceWatermark(HeapInternalTimerService.java:276) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.processWatermark(AbstractStreamOperator.java:858) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.runtime.io.StreamInputProcessor.processInput(StreamInputProcessor.java:168) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask.run(OneInputStreamTask.java:63) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:272) ~[flink-streaming-java_2.11-1.2.0.jar:1.2.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:655) ~[flink-runtime_2.11-1.2.0.jar:1.2.0]
	at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_121]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It fails only with the Thread.sleep. If you uncomment it, it won&apos;t fail.&lt;br/&gt;
So, you may have to increase the sleep time depending of your environment.&lt;br/&gt;
I know this is not a very rigourous test, but this is the only way I&apos;ve found to reproduce it.&lt;/p&gt;

&lt;p&gt;You can find the reproducer here :&lt;br/&gt;
&lt;a href=&quot;https://github.com/vpernin/flink-window-npe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vpernin/flink-window-npe&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13049316">FLINK-6001</key>
            <summary>NPE on TumblingEventTimeWindows with ContinuousEventTimeTrigger and allowedLateness</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aljoscha">Aljoscha Krettek</assignee>
                                    <reporter username="vpernin">Vladislav Pernin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Mar 2017 17:00:13 +0000</created>
                <updated>Thu, 28 Feb 2019 10:46:08 +0000</updated>
                            <resolved>Wed, 15 Mar 2017 13:48:08 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.2.1</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15901616" author="vpernin" created="Wed, 8 Mar 2017 17:29:51 +0000"  >&lt;p&gt;I have simplified the reproducer but it fails less often. Please use the following branch :&lt;br/&gt;
&lt;a href=&quot;https://github.com/vpernin/flink-window-npe/tree/simpler-but-fails-less-often&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vpernin/flink-window-npe/tree/simpler-but-fails-less-often&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15901756" author="vpernin" created="Wed, 8 Mar 2017 18:45:30 +0000"  >&lt;p&gt;Another reproducer version without a &quot;sleeping map&quot; but a slow source function that try to mimic the reality :&lt;br/&gt;
&lt;a href=&quot;https://github.com/vpernin/flink-window-npe/tree/slow-serializer&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vpernin/flink-window-npe/tree/slow-serializer&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15924615" author="vpernin" created="Tue, 14 Mar 2017 17:23:13 +0000"  >&lt;p&gt;Maybe related to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5713&quot; title=&quot;Protect against NPE in WindowOperator window cleanup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5713&quot;&gt;&lt;del&gt;FLINK-5713&lt;/del&gt;&lt;/a&gt; ? I have to test.&lt;/p&gt;</comment>
                            <comment id="15925844" author="githubbot" created="Wed, 15 Mar 2017 10:17:25 +0000"  >&lt;p&gt;GitHub user aljoscha opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3544&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3544&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6001&quot; title=&quot;NPE on TumblingEventTimeWindows with ContinuousEventTimeTrigger and allowedLateness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6001&quot;&gt;&lt;del&gt;FLINK-6001&lt;/del&gt;&lt;/a&gt; Fix ContinuousEventTimeTrigger firing without state&lt;/p&gt;

&lt;p&gt;    R: @kl0u &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/aljoscha/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/aljoscha/flink&lt;/a&gt; jira-6001-fix-cont-trigger-npe&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3544.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3544.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3544&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 31fd820666d1715c57298c3f4d8a434a96431a1f&lt;br/&gt;
Author: Aljoscha Krettek &amp;lt;aljoscha.krettek@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-03-13T14:04:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6001&quot; title=&quot;NPE on TumblingEventTimeWindows with ContinuousEventTimeTrigger and allowedLateness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6001&quot;&gt;&lt;del&gt;FLINK-6001&lt;/del&gt;&lt;/a&gt; Fix ContinuousEventTimeTrigger firing without state&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15925861" author="vpernin" created="Wed, 15 Mar 2017 10:29:13 +0000"  >&lt;p&gt;Very nice, it works.&lt;br/&gt;
I was reluctant to push a PR myself with your NPE protection without being aware of possible side effects.&lt;/p&gt;</comment>
                            <comment id="15926193" author="githubbot" created="Wed, 15 Mar 2017 13:46:56 +0000"  >&lt;p&gt;Github user aljoscha closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3544&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3544&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15926194" author="aljoscha" created="Wed, 15 Mar 2017 13:48:08 +0000"  >&lt;p&gt;Fixed on release-1.2 in&lt;br/&gt;
697ede00d044af4eb18a981fd2734fba3e112a30&lt;/p&gt;

&lt;p&gt;Fixed on master in&lt;br/&gt;
0a501e9f7f56baba2905002b74746998458db007&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3b4mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>