<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:52:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-12461] Document binary compatibility situation with Scala beyond 2.12.8</title>
                <link>https://issues.apache.org/jira/browse/FLINK-12461</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When using 1.8 with Scala 2.12.8 and trying to parse a scala.Map (not a java.util.Map), I get a: java.lang.ClassNotFoundException: scala.math.Ordering$$anon$9&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;start with the Scala Maven archetype (org.apache.flink:flink-quickstart-scala:1.8.0)&lt;/li&gt;
	&lt;li&gt;in the POM, set the scala.version to 2.12.8 and the scala.binary.version to 2.12&lt;/li&gt;
	&lt;li&gt;in StreamingJob, add: env.fromElements[Map&lt;span class=&quot;error&quot;&gt;&amp;#91;String, Int&amp;#93;&lt;/span&gt;]()&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It works with Scala 2.12.7 (well, without putting anything in the job, it fails with &quot;No operators defined in streaming topology&quot;, which is expected).&lt;/p&gt;

&lt;p&gt;I suspect this is linked to the binary incompatiblity of 2.12.8 with 2.12.7 (see the release note of 2.12.8), so compiling Flink with 2.12.8 instead of 2.12.7 might be enough (although it might stop working with 2.12.7?)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13232397">FLINK-12461</key>
            <summary>Document binary compatibility situation with Scala beyond 2.12.8</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10005">Workaround</resolution>
                                        <assignee username="aljoscha">Aljoscha Krettek</assignee>
                                    <reporter username="gael">Ga&#235;l Renoux</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 9 May 2019 07:51:16 +0000</created>
                <updated>Fri, 20 May 2022 09:28:42 +0000</updated>
                            <resolved>Thu, 28 Jan 2021 13:18:09 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>1.12.2</fixVersion>
                    <fixVersion>1.13.0</fixVersion>
                                    <component>API / Scala</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="16836288" author="aljoscha" created="Thu, 9 May 2019 11:26:41 +0000"  >&lt;p&gt;A slap in the face, from the &lt;a href=&quot;https://github.com/scala/scala/releases/tag/v2.12.8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;release notes&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
The second fix is not binary compatible: the 2.12.8 compiler omits certain methods that are generated by earlier 2.12 compilers. However, we believe that these methods are never used and existing compiled code will &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; to work. See the&#160;pull request description&#160;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more details.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16838423" author="aljoscha" created="Mon, 13 May 2019 09:50:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gael&quot; class=&quot;user-hover&quot; rel=&quot;gael&quot;&gt;gael&lt;/a&gt; Did you try manually building Flink for Scala 2.12.8 and see if that works? Just to check if this would work.&lt;/p&gt;</comment>
                            <comment id="16838445" author="aljoscha" created="Mon, 13 May 2019 10:14:59 +0000"  >&lt;p&gt;Closing for now because we cannot work around this on our side.&lt;/p&gt;</comment>
                            <comment id="16840415" author="gael" created="Wed, 15 May 2019 13:46:42 +0000"  >&lt;p&gt;If compiling with Scala 2.12.8 is not an option, we should at least update the documentation with a warning to not use it. It has been out for months, it is going to be the default option for anyone installing Flink now.&lt;/p&gt;</comment>
                            <comment id="16842062" author="aljoscha" created="Fri, 17 May 2019 10:03:19 +0000"  >&lt;p&gt;I tried building Flink 1.8 with Scala 2.12.8. It fails with binary compatibility checks because the compiler changes how some methods are generated:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal com.github.siom79.japicmp:japicmp-maven-plugin:0.11.0:cmp (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;) on project flink-scala_2.12: Breaking the build because there is at least one incompatibility: org.apache.flink.api.scala.CoGroupDataSet.$anonfun$buildGroupSortList$1(org.apache.flink.api.common.typeinfo.TypeInformation,java.util.ArrayList,scala.Tuple2):METHOD_REMOVED,org.apache.flink.api.scala.typeutils.CaseClassTypeInfo.$anonfun$getFlatFields$1(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,java.util.List,scala.runtime.IntRef,org.apache.flink.api.common.typeinfo.TypeInformation):METHOD_REMOVED,org.apache.flink.api.scala.typeutils.CaseClassTypeInfo.$anonfun$getFlatFields$1$adapted(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,java.util.List,scala.runtime.IntRef,org.apache.flink.api.common.typeinfo.TypeInformation):METHOD_REMOVED -&amp;gt; [Help 1]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17006931" author="gael" created="Thu, 2 Jan 2020 16:48:13 +0000"  >&lt;p&gt;By the way, I just tested Scala 2.12.10 with Flink 1.9.1, and it works fine. Flink 1.8 is no longer the default choice for a new project, so I guess it&apos;s not a big deal anymore and this ticket can be closed. I still think the doc could use a compatibility page, though.&lt;/p&gt;

&lt;p&gt;EDIT: my bad, I messed up my test. Flink 1.9.1 has the same problem. It&apos;s still only compatible with Scala 2.12.7.&lt;/p&gt;</comment>
                            <comment id="17269333" author="eloisant" created="Thu, 21 Jan 2021 14:19:52 +0000"  >&lt;p&gt;I tried to update Flink to Scala 2.12.13 (the latest version) but I&apos;m having a compatibility error:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;{{&lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal com.github.siom79.japicmp:japicmp-maven-plugin:0.11.0:cmp (default) on project flink-scala_2.12: Breaking the build because there is at least one incompatibility: org.apache.flink.api.scala.CoGroupDataSet.$anonfun$buildGroupSortList$1(org.apache.flink.api.common.typeinfo.TypeInformation,java.util.ArrayList,scala.Tuple2):METHOD_REMOVED,org.apache.flink.api.scala.typeutils.CaseClassTypeInfo.$anonfun$getFlatFields$1(int,java.util.List,scala.runtime.IntRef,org.apache.flink.api.common.typeinfo.TypeInformation):METHOD_REMOVED,org.apache.flink.api.scala.typeutils.CaseClassTypeInfo.$anonfun$getFlatFields$1$adapted(int,java.util.List,scala.runtime.IntRef,org.apache.flink.api.common.typeinfo.TypeInformation):METHOD_REMOVED -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;/tt&gt;}}&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Any idea how to fix that?&lt;/p&gt;</comment>
                            <comment id="17270046" author="aljoscha" created="Fri, 22 Jan 2021 10:20:44 +0000"  >&lt;p&gt;This should be related to my first comment. The problem is that there is no binary compatibility between Scala 2.12.x versions after 2.12.8 and our binary compatibility check will discover that. To fix this, you can disable japicmp locally for your build and see if everything else works out fine. However, I don&apos;t think we can do releases with this, because we would have to do releases for individual Scala 2.12.x versions, which seems a bit overkill.&lt;/p&gt;

&lt;p&gt;The situation with Scala is not ideal here. &#128584;&lt;/p&gt;</comment>
                            <comment id="17270054" author="eloisant" created="Fri, 22 Jan 2021 10:30:43 +0000"  >&lt;p&gt;So does that mean we&apos;re stuck with 2.12.8 forever, for the 2.12.x branch?&lt;/p&gt;</comment>
                            <comment id="17272273" author="stephanewen" created="Tue, 26 Jan 2021 17:29:58 +0000"  >&lt;p&gt;Maybe to clarify / sum this up:&lt;/p&gt;

&lt;p&gt;You should still be able to use Flink with any Scala 2.12.x version by&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiling Flink against that version: &lt;tt&gt;mvn clean install -DskipTests -Djapicmp.skip -Dscala-2.12 -Dscala.version=2.12.12&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;compiling your Flink application with dependencies on that custom compiled build (so it uses the Scala Macros from the right Scala version).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17273629" author="aljoscha" created="Thu, 28 Jan 2021 13:16:58 +0000"  >&lt;p&gt;I added an explanation of the situation to the docs. I&apos;d close the issue now, because I don&apos;t think there&apos;s much we can do here still. What do you think?&lt;/p&gt;

&lt;p&gt;Added explanation in commits:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master: bbee6cd749f0ca462db47fb9feaac27538748112&lt;/li&gt;
	&lt;li&gt;release-1.12: 0e49396853ef41d83dd8591bce9a44b99428535d&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17273631" author="aljoscha" created="Thu, 28 Jan 2021 13:18:09 +0000"  >&lt;p&gt;The workaround is compiling manually for the specific Scala version.&lt;/p&gt;</comment>
                            <comment id="17273637" author="zentol" created="Thu, 28 Jan 2021 13:31:16 +0000"  >&lt;p&gt;Do we maybe want to do a survey on the user ML whether users would prefer breaking the API over being stuck with scala 2.12.8?&lt;/p&gt;</comment>
                            <comment id="17273651" author="eloisant" created="Thu, 28 Jan 2021 13:54:17 +0000"  >&lt;p&gt;Yes it sucks, but it might not be worth it.&lt;/p&gt;

&lt;p&gt;Maybe at least find a way it doesn&apos;t happen in the Scala 2.13.x branch?&lt;/p&gt;</comment>
                            <comment id="17540006" author="martijnvisser" created="Fri, 20 May 2022 09:28:42 +0000"  >&lt;p&gt;FYI, I&apos;ve opened a discussion thread on this topic. See &lt;a href=&quot;https://lists.apache.org/thread/9ft0tbhj45fplt5j3gtb7jzbt4tdr6rh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread/9ft0tbhj45fplt5j3gtb7jzbt4tdr6rh&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13352178">FLINK-20969</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02j3c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>