<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2460] ReduceOnNeighborsWithExceptionITCase failure</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2460</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I noticed a build error due to failure on this case. It was on a branch of my fork, which didn&apos;t actually have anything to do with the failed test or the runtime system at all.&lt;/p&gt;

&lt;p&gt;Here&apos;s the error log: &lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/73695554/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/73695554/log.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12850794">FLINK-2460</key>
            <summary>ReduceOnNeighborsWithExceptionITCase failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uce">Ufuk Celebi</assignee>
                                    <reporter username="sachingoel0101">Sachin Goel</reporter>
                        <labels>
                    </labels>
                <created>Sat, 1 Aug 2015 18:17:36 +0000</created>
                <updated>Wed, 26 Aug 2015 10:27:22 +0000</updated>
                            <resolved>Wed, 26 Aug 2015 10:27:22 +0000</resolved>
                                                    <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14651695" author="uce" created="Mon, 3 Aug 2015 10:00:49 +0000"  >&lt;p&gt;Thanks for reporting the issue Sachin. I&apos;m looking into whether this an instance of a recently fixed issue or if it is a separate thing.&lt;/p&gt;</comment>
                            <comment id="14709474" author="githubbot" created="Mon, 24 Aug 2015 15:40:29 +0000"  >&lt;p&gt;GitHub user uce opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2460&quot; title=&quot;ReduceOnNeighborsWithExceptionITCase failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2460&quot;&gt;&lt;del&gt;FLINK-2460&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Check parent state in isReleased() check of partition view&lt;/p&gt;

&lt;p&gt;    Adds a check for the state of the parent partition a partition *&lt;b&gt;view&lt;/b&gt;* belongs to (the view consumes a sub partition).&lt;/p&gt;

&lt;p&gt;    During cancelling there was a possible interleaving when a released partition was not noticed by the consumer. The issue for this PR reported the following stack trace:&lt;/p&gt;

&lt;p&gt;    ```bash&lt;br/&gt;
    &quot;SortMerger Reading Thread&quot; daemon prio=10 tid=0x00007f7740107800 nid=0x13cbc runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f7722bb1000&amp;#93;&lt;/span&gt;&lt;br/&gt;
       java.lang.Thread.State: RUNNABLE&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.LocalInputChannel.getNextLookAhead(LocalInputChannel.java:256)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.LocalInputChannel.requestSubpartition(LocalInputChannel.java:120)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x00000000ef9c1028&amp;gt; (a java.lang.Object)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.requestPartitions(SingleInputGate.java:377)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00000000ef9c0da8&amp;gt; (a java.lang.Object)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.getNextBufferOrEvent(SingleInputGate.java:400)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.api.reader.AbstractRecordReader.getNextRecord(AbstractRecordReader.java:79)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.api.reader.MutableRecordReader.next(MutableRecordReader.java:34)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.util.ReaderIterator.next(ReaderIterator.java:59)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ReadingThread.go(UnilateralSortMerger.java:958)&lt;br/&gt;
    	at org.apache.flink.runtime.operators.sort.UnilateralSortMerger$ThreadBase.run(UnilateralSortMerger.java:781)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &quot;CoGroup (CoGroup at groupReduceOnNeighbors(Graph.java:1405)) (4/4)&quot; daemon prio=10 tid=0x00007f772c45a800 nid=0x13c9e waiting for monitor entry &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f7721ba1000&amp;#93;&lt;/span&gt;&lt;br/&gt;
       java.lang.Thread.State: BLOCKED (on object monitor)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.releaseAllResources(SingleInputGate.java:322)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x00000000ef9c0da8&amp;gt; (a java.lang.Object)&lt;br/&gt;
    	at org.apache.flink.runtime.io.network.NetworkEnvironment.unregisterTask(NetworkEnvironment.java:379)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00000000d5519898&amp;gt; (a java.lang.Object)&lt;br/&gt;
    	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:674)&lt;br/&gt;
    	at java.lang.Thread.run(Thread.java:701)&lt;br/&gt;
    ```&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This PR adds a test that verifies that the parent release state is checked by the respective views as well.&lt;/p&gt;

&lt;p&gt;    *&lt;b&gt;Note&lt;/b&gt;*: This needs to be merged to `release-0.9` as well.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/uce/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/uce/flink&lt;/a&gt; cogroup_closer-2460&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1051&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7c99da9c716238349e5bfd17a1d48c6a338e5f76&lt;br/&gt;
Author: Ufuk Celebi &amp;lt;uce@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-08-10T13:15:07Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2460&quot; title=&quot;ReduceOnNeighborsWithExceptionITCase failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2460&quot;&gt;&lt;del&gt;FLINK-2460&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;runtime&amp;#93;&lt;/span&gt; Check parent state in isReleased() check of partition view&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14711098" author="githubbot" created="Tue, 25 Aug 2015 11:26:57 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051#discussion_r37854662&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051#discussion_r37854662&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedSubpartition.java &amp;#8212;&lt;br/&gt;
    @@ -167,6 +167,13 @@ public int releaseMemory() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	@Override&lt;br/&gt;
    +	public boolean isReleased() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think it makes no difference to synchronize around variable access. A variable read is atomic anyways, the synchronization does not add anything there...&lt;/p&gt;</comment>
                            <comment id="14711099" author="githubbot" created="Tue, 25 Aug 2015 11:27:30 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051#issuecomment-134559089&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051#issuecomment-134559089&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Other than the given comment, this looks good.&lt;/p&gt;</comment>
                            <comment id="14711111" author="githubbot" created="Tue, 25 Aug 2015 11:42:33 +0000"  >&lt;p&gt;Github user uce commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051#discussion_r37855608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051#discussion_r37855608&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedSubpartition.java &amp;#8212;&lt;br/&gt;
    @@ -167,6 +167,13 @@ public int releaseMemory() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	@Override&lt;br/&gt;
    +	public boolean isReleased() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    True, but a different thread than the consumer may release the partition and update the flag. I can make the flag `volatile`.&lt;/p&gt;</comment>
                            <comment id="14711192" author="githubbot" created="Tue, 25 Aug 2015 12:40:45 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051#discussion_r37859713&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051#discussion_r37859713&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedSubpartition.java &amp;#8212;&lt;br/&gt;
    @@ -167,6 +167,13 @@ public int releaseMemory() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	@Override&lt;br/&gt;
    +	public boolean isReleased() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think that would be the way to go&lt;/p&gt;</comment>
                            <comment id="14711653" author="githubbot" created="Tue, 25 Aug 2015 17:22:35 +0000"  >&lt;p&gt;Github user uce commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051#issuecomment-134676740&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051#issuecomment-134676740&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Addressing the comment and merging this for 0.10 and 0.9.1.&lt;/p&gt;</comment>
                            <comment id="14712759" author="githubbot" created="Wed, 26 Aug 2015 09:08:24 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1051&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1051&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14712760" author="uce" created="Wed, 26 Aug 2015 09:09:14 +0000"  >&lt;p&gt;Fixed via a17d4e8 in master.&lt;/p&gt;

&lt;p&gt;Back port to release-0.9 pending on ML discussion (&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/flink-dev/201508.mbox/%3cCANC1h_voqCXu_-5RqOcwf0q=87p_bQrXXv-gS2qcBPkfcC2kPA@mail.gmail.com%3e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/flink-dev/201508.mbox/%3cCANC1h_voqCXu_-5RqOcwf0q=87p_bQrXXv-gS2qcBPkfcC2kPA@mail.gmail.com%3e&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="14712903" author="uce" created="Wed, 26 Aug 2015 10:27:22 +0000"  >&lt;p&gt;Fixed in c89851d (release-0.9)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i7qn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>