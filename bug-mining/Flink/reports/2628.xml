<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:35:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10222] Table scalar function expression parses error when function name equals the exists keyword suffix</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10222</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Suffix extraction in ExpressionParser.scala does not actually support extraction of keywords with the same prefix. For example: Adding suffix parsing rules for &lt;tt&gt;a.fun&lt;/tt&gt; and &lt;tt&gt;a.function&lt;/tt&gt; simultaneously will causes exceptions. &lt;/p&gt;

&lt;p&gt;some discussion :&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/pull/6432#issuecomment-416127815&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6432#issuecomment-416127815&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/pull/6585#discussion_r212797015&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6585#discussion_r212797015&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13181275">FLINK-10222</key>
            <summary>Table scalar function expression parses error when function name equals the exists keyword suffix</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanghua">vinoyang</assignee>
                                    <reporter username="yanghua">vinoyang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 27 Aug 2018 09:45:34 +0000</created>
                <updated>Thu, 19 Sep 2019 19:18:02 +0000</updated>
                            <resolved>Mon, 5 Nov 2018 22:52:33 +0000</resolved>
                                                    <fixVersion>1.4.3</fixVersion>
                    <fixVersion>1.5.5</fixVersion>
                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>1.7.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16593824" author="rongr" created="Mon, 27 Aug 2018 15:27:22 +0000"  >&lt;p&gt;Agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt;&apos;s observation. This will cause many collisions especially with many of Table API&apos;s keyword being short as 3-4 characters. &lt;/p&gt;</comment>
                            <comment id="16593852" author="yanghua" created="Mon, 27 Aug 2018 15:47:19 +0000"  >&lt;p&gt;So, what do you think exactly matches a keyword as a suffix? Because the suffix keyword is deterministic and semantically clear.&#160;Or is there any other better solution? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=walterddr&quot; class=&quot;user-hover&quot; rel=&quot;walterddr&quot;&gt;walterddr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16593861" author="rongr" created="Mon, 27 Aug 2018 15:52:52 +0000"  >&lt;p&gt;I think making it exactly match is probably the best solution here. I briefly considered making the &lt;tt&gt;opt(&quot;()&quot;)&lt;/tt&gt; mandatory but that breaks backward compatibility. Most of the reasons why this was not surface previously was that may of the short keywords requires arguments, such as &lt;tt&gt;as&lt;/tt&gt;.  &lt;/p&gt;</comment>
                            <comment id="16593881" author="yanghua" created="Mon, 27 Aug 2018 16:07:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=walterddr&quot; class=&quot;user-hover&quot; rel=&quot;walterddr&quot;&gt;walterddr&lt;/a&gt; you are right,&#160;&#160;I tried a lot of test cases built on keywords in the suffix list. I have always wondered why some keywords do not appear, such as the &lt;b&gt;log&lt;/b&gt; keyword, &lt;b&gt;log2&lt;/b&gt;, &lt;b&gt;log10&lt;/b&gt;, &lt;b&gt;logabc&lt;/b&gt;, can be resolved normally, and later found that it requires parameters.&#160;Well, if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt;&#160;have no objections, I can fix this PR, in the form of a regular exact match.&lt;/p&gt;</comment>
                            <comment id="16593899" author="fhueske" created="Mon, 27 Aug 2018 16:26:12 +0000"  >&lt;p&gt;I think we should try to use the built-in tooling of the parser framework, such as `Keyword` if possible.&lt;/p&gt;</comment>
                            <comment id="16593914" author="yanghua" created="Mon, 27 Aug 2018 16:36:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt; agree,&#160;The exact match I call the regular expression is actually from the keyword2Parser method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
implicit def keyword2Parser(kw: Keyword): Parser[&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;] = {
  (&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;&quot;(?i)\Q&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; + kw.key + &quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;\E&quot;&lt;/span&gt;&quot;&quot;).r
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This method will convert the keyword into a Parser object.&#160;If I change it, then we will make an exact match for all the keywords. I feel that there should be no problem with this. What do you think?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16594755" author="githubbot" created="Tue, 28 Aug 2018 09:34:46 +0000"  >&lt;p&gt;yanghua opened a new pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   &lt;b&gt;This pull request fix Table scalar function expression parses error when function name equals the exists keyword suffix&lt;/b&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;uses an exact matching mode for some suffix keyword&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   This change added tests and can be verified as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;KeywordAsSuffixTest#testFunctionNameContainsSuffixKeyword&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable / docs / JavaDocs / *&lt;b&gt;not documented&lt;/b&gt;*)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16595985" author="githubbot" created="Wed, 29 Aug 2018 06:39:08 +0000"  >&lt;p&gt;yanghua commented on issue #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#issuecomment-416841852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#issuecomment-416841852&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @fhueske can you review this PR?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16596212" author="githubbot" created="Wed, 29 Aug 2018 11:26:41 +0000"  >&lt;p&gt;yanghua commented on issue #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#issuecomment-416919005&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#issuecomment-416919005&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @walterddr &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16605964" author="githubbot" created="Thu, 6 Sep 2018 15:53:47 +0000"  >&lt;p&gt;yanghua commented on issue #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#issuecomment-419146677&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#issuecomment-419146677&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @twalthr If you have time, can you help me review this PR? It blocked my other PR which contributes a  scalar function about `ASCII`. thanks~&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16610790" author="githubbot" created="Tue, 11 Sep 2018 15:23:10 +0000"  >&lt;p&gt;yanghua commented on issue #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#issuecomment-420313214&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#issuecomment-420313214&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @xccui and @hequn8128 Can you help to review this PR? It blocks ASCII scalar function because `ASCII` is the prefix of the `ASC` (which is sql keyword suffix of `ORDER BY`)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611559" author="githubbot" created="Wed, 12 Sep 2018 04:05:55 +0000"  >&lt;p&gt;walterddr commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r216891057&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r216891057&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   I felt like this should be by default applied to all Keywords when using `suffix`&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611560" author="githubbot" created="Wed, 12 Sep 2018 04:05:55 +0000"  >&lt;p&gt;walterddr commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r216891199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r216891199&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   probably directly changing the `implicit def keyword2Parser` might have been a better idea?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611643" author="githubbot" created="Wed, 12 Sep 2018 06:17:29 +0000"  >&lt;p&gt;yanghua commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r216907736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r216907736&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   @walterddr I have tried your idea, but some suffix keywords can be used as a prefix at the same time, and some suffix keywords can take parameters. Applying this rule to them will cause their test cases to fail.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16612467" author="githubbot" created="Wed, 12 Sep 2018 17:02:36 +0000"  >&lt;p&gt;walterddr commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217113231&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217113231&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   I dont necessarily think making the suffix keyword to always situated at end of line (`$` assertion) is a must. We just need to prevent potentially keyword collision with identical prefix. Probably adding an assertion that `Keyword` does not follow by alphabetical character is suffice?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16614130" author="githubbot" created="Thu, 13 Sep 2018 22:36:26 +0000"  >&lt;p&gt;fhueske commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217554963&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217554963&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Yes, I agree with @walterddr. This seems to be a better approach. &lt;br/&gt;
   A keyword should only match if it is not followed by another identifier (see &lt;span class=&quot;error&quot;&gt;&amp;#91;Java identifier specs&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8&lt;/a&gt;)) character. &lt;/p&gt;

&lt;p&gt;   What do you think @yanghua?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16614498" author="githubbot" created="Fri, 14 Sep 2018 08:10:02 +0000"  >&lt;p&gt;yanghua commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217632097&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217632097&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,13 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an exact matching mode. scenes to be used:&lt;br/&gt;
+  // a keyword as a suffix no required parameter and not as a prefix&lt;br/&gt;
+  def keyword2ParserForSuffixButNotAsPrefix(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   @fhueske @walterddr I agree with you and have updated the PR. Please review again, thank you.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16614795" author="githubbot" created="Fri, 14 Sep 2018 12:54:18 +0000"  >&lt;p&gt;fhueske commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217701805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217701805&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,12 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an more precisely matching mode for suffix keywords.&lt;br/&gt;
+  def suffixKeyword2Parser(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
+    (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E(?!&lt;span class=&quot;error&quot;&gt;&amp;#91;_$a-zA-Z0-9&amp;#93;&lt;/span&gt;)&quot;&quot;&quot;).r&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   We should match also Unicode letters, not just ASCII (`a-zA-Z`).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16614796" author="githubbot" created="Fri, 14 Sep 2018 12:54:18 +0000"  >&lt;p&gt;fhueske commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217701567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217701567&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -45,6 +45,12 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers &lt;/p&gt;
{
     (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
   }

&lt;p&gt;+  // Convert the keyword into an case insensitive Parser&lt;br/&gt;
+  // It uses an more precisely matching mode for suffix keywords.&lt;br/&gt;
+  def suffixKeyword2Parser(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
+    (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E(?!&lt;span class=&quot;error&quot;&gt;&amp;#91;_$a-zA-Z0-9&amp;#93;&lt;/span&gt;)&quot;&quot;&quot;).r&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   We can use this for all Keyword matches. Just replace `keyword2Parser` by this. &lt;br/&gt;
   This would be the only change in the `ExpressionParser`.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16615011" author="githubbot" created="Fri, 14 Sep 2018 15:54:35 +0000"  >&lt;p&gt;yanghua commented on issue #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#issuecomment-421402903&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#issuecomment-421402903&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @fhueske , thanks for your suggestion, I have refactored the PR.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16616459" author="githubbot" created="Sat, 15 Sep 2018 18:58:40 +0000"  >&lt;p&gt;fhueske commented on a change in pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622#discussion_r217892719&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622#discussion_r217892719&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -42,7 +42,8 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;/p&gt;

&lt;p&gt;   // Convert the keyword into an case insensitive Parser&lt;br/&gt;
   implicit def keyword2Parser(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r&lt;br/&gt;
+    (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key +&lt;br/&gt;
+      &quot;&quot;&quot;\E(?!&lt;span class=&quot;error&quot;&gt;&amp;#91;_$a-zA-Z0-9\u005f\u0024\u0061-\u007a\u0041-\u005a\u0030-\u0039&amp;#93;&lt;/span&gt;)&quot;&quot;&quot;).r&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I&apos;ll replace `a-zA-Z0-9\u005f\u0024\u0061-\u007a\u0041-\u005a\u0030-\u0039` by `\p&lt;/p&gt;
{javaJavaIdentifierPart}
&lt;p&gt;` which matches all valid characters of Java identifiers.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16616907" author="githubbot" created="Sun, 16 Sep 2018 21:45:02 +0000"  >&lt;p&gt;asfgit closed pull request #6622: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10222&quot; title=&quot;Table scalar function expression parses error when function name equals the exists keyword suffix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10222&quot;&gt;&lt;del&gt;FLINK-10222&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table scalar function expression parses error when function name equals the exists keyword suffix&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6622&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6622&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
index 4909d2c79da..a8f73a21bdf 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
@@ -42,7 +42,8 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;/p&gt;

&lt;p&gt;   // Convert the keyword into an case insensitive Parser&lt;br/&gt;
   implicit def keyword2Parser(kw: Keyword): Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt; = &lt;/p&gt;
{
-    (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key + &quot;&quot;&quot;\E&quot;&quot;&quot;).r
+    (&quot;&quot;&quot;(?i)\Q&quot;&quot;&quot; + kw.key +
+      &quot;&quot;&quot;\E(?![_$a-zA-Z0-9\u005f\u0024\u0061-\u007a\u0041-\u005a\u0030-\u0039])&quot;&quot;&quot;).r
   }

&lt;p&gt;   // Keyword&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/KeywordParseTest.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/KeywordParseTest.scala&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..05c464a37ea&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/KeywordParseTest.scala&lt;br/&gt;
@@ -0,0 +1,75 @@&lt;br/&gt;
+/*&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License.  You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+ * See the License for the specific language governing permissions and&lt;br/&gt;
+ * limitations under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.flink.table.expressions&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
+import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
+import org.apache.flink.table.expressions.utils.ExpressionTestBase&lt;br/&gt;
+import org.apache.flink.types.Row&lt;br/&gt;
+import org.junit.&lt;/p&gt;
{Assert, Test}
&lt;p&gt;+&lt;br/&gt;
+/**&lt;br/&gt;
+  * Tests keyword as suffix.&lt;br/&gt;
+  */&lt;br/&gt;
+class KeywordParseTest extends ExpressionTestBase {&lt;br/&gt;
+&lt;br/&gt;
+  @Test&lt;br/&gt;
+  def testFunctionNameContainsSuffixKeyword(): Unit = &lt;/p&gt;
{
+    // ASC / DESC (no parameter)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.ascii()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;ASCII&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.iiascii()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;IIASCII&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.iiasc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;IIASC&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.descabc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;DESCABC&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.abcdescabc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;ABCDESCABC&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.abcdesc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;ABCDESC&quot;)
+    // LOG has parameter
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.logabc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;LOGABC&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.abclogabc()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;ABCLOGABC&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.abclog()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;ABCLOG&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.log2()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;LOG2&quot;)
+    Assert.assertEquals(
+      ((ExpressionParser.parseExpression(&quot;f0.log10()&quot;)).asInstanceOf[Call]).functionName,
+      &quot;LOG10&quot;)
+  }
&lt;p&gt;+&lt;br/&gt;
+  override def testData: Any = new Row(0)&lt;br/&gt;
+&lt;br/&gt;
+  override def typeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt; =&lt;br/&gt;
+    new RowTypeInfo().asInstanceOf[TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;]&lt;br/&gt;
+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16616932" author="fhueske" created="Sun, 16 Sep 2018 22:44:41 +0000"  >&lt;p&gt;Fixed for 1.7.0 with 4f219f40c3ab8c454ce52a60a857c3a2a0c56451&lt;br/&gt;
Fixed for 1.6.2 with 737b988cd901ab39240371de79d1f303153172eb&lt;br/&gt;
Fixed for 1.5.5 with d2034ca3ff6cb4736efef2c1918513f40f0d2243&lt;br/&gt;
Fixed for 1.4.3 with 2cdec3fb9ed2d2502ce6acdbcf0322e535efab47&lt;/p&gt;</comment>
                            <comment id="16675854" author="tison" created="Mon, 5 Nov 2018 22:52:13 +0000"  >&lt;p&gt;For correcting fix versions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xg0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>