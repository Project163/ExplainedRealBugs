<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5039] Avro GenericRecord support is broken</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5039</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Avro GenericRecord support was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3691&quot; title=&quot;Extend AvroInputFormat to support Avro GenericRecord&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3691&quot;&gt;&lt;del&gt;FLINK-3691&lt;/del&gt;&lt;/a&gt;, but it seems like the GenericRecords are not properly (de)serialized.&lt;/p&gt;

&lt;p&gt;This can be easily seen with a program like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  env.createInput(new AvroInputFormat&amp;lt;&amp;gt;(new Path(&quot;somefile.avro&quot;), GenericRecord.class))
    .first(10)
    .print();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which will print records in which all fields have the same value:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&quot;foo&quot;: 1478628723066, &quot;bar&quot;: 1478628723066, &quot;baz&quot;: 1478628723066, ...}
{&quot;foo&quot;: 1478628723179, &quot;bar&quot;: 1478628723179, &quot;baz&quot;: 1478628723179, ...}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I&apos;m not mistaken, the AvroInputFormat does essentially TypeExtractor.getForClass(GenericRecord.class), but GenericRecords are not POJOs.&lt;/p&gt;

&lt;p&gt;Furthermore, each GenericRecord contains a pointer to the record schema. I guess the current naive approach will serialize this schema with each record, which is quite inefficient (the schema is typically more complex and much larger than the data). We probably need a TypeInformation and TypeSerializer specific to Avro GenericRecords, which could just use avro serialization.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13019539">FLINK-5039</key>
            <summary>Avro GenericRecord support is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="bruno">Bruno Dumon</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Nov 2016 13:43:34 +0000</created>
                <updated>Thu, 28 Feb 2019 13:46:07 +0000</updated>
                            <resolved>Thu, 8 Dec 2016 21:10:08 +0000</resolved>
                                    <version>1.1.3</version>
                                    <fixVersion>1.1.4</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>API / DataSet</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15718737" author="dtorok" created="Sat, 3 Dec 2016 21:05:48 +0000"  >&lt;p&gt;I have spent 2 days on this and HAVE THE SOLUTION.&lt;/p&gt;

&lt;p&gt;Fix:  Bump Avro version to at least 1.7.7 from the current 1.7.6.&lt;/p&gt;

&lt;p&gt;Root Cause.  Within &quot;Schema.class&quot; the &quot;field&quot; position is a TRANSIENT and does not get serialized by Kryo!&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1476&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1476&lt;/a&gt;  and specififcally mentions kyro&lt;/p&gt;

&lt;p&gt;This was fixed in 1.7.7&lt;/p&gt;

&lt;p&gt;This is also the cause for other GenericRecord issues such as the &apos;union&apos; issue mentioned here &lt;a href=&quot;http://stackoverflow.com/questions/37115618/apache-flink-union-operator-giving-wrong-response&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/37115618/apache-flink-union-operator-giving-wrong-response&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;PLEASE BUMP THIS ASAP!!!!&lt;/p&gt;

&lt;p&gt;I have verified the fix in my local machine by replacing the Avro classes within the flink-dist_2.11-1.1.3.jar and it corrected my issue.&lt;/p&gt;</comment>
                            <comment id="15721865" author="rmetzger" created="Mon, 5 Dec 2016 10:21:47 +0000"  >&lt;p&gt;Thanks a lot for looking into the issue. I think we can upgrade the Avro version to 1.7.7 for Flink 1.1.4 and 1.2.0.&lt;br/&gt;
I&apos;ll open a PR.&lt;/p&gt;</comment>
                            <comment id="15721927" author="bruno" created="Mon, 5 Dec 2016 10:48:07 +0000"  >&lt;p&gt;Looks like a suboptimal solution to me, given that the schema will still be serialized in each instance record.&lt;/p&gt;</comment>
                            <comment id="15722448" author="stephanewen" created="Mon, 5 Dec 2016 14:49:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bruno&quot; class=&quot;user-hover&quot; rel=&quot;bruno&quot;&gt;bruno&lt;/a&gt; True, we need to change it such that the Avro Serializer is used for Avro Types.&lt;/p&gt;

&lt;p&gt;The tricky part is that we cannot simply swap serializers, since that breaks the savepoint compatibility.&lt;br/&gt;
We are introducing versioning information into the savepoints in the next release. That allows us to add a &quot;state upgrade&quot; path in which we can swap serializers without breaking safepoints.&lt;/p&gt;</comment>
                            <comment id="15726541" author="rmetzger" created="Tue, 6 Dec 2016 20:01:44 +0000"  >&lt;p&gt;Just using the Avro serializer doesn&apos;t solve the problem here. We also need to include the schema into the TypeInformation so that the can initialize the GenericRecordSerializer with it.&lt;br/&gt;
This also means that users can not use GenericRecords with different schemas in the same stream.&lt;/p&gt;

&lt;p&gt;Doing a minor avro version bump was meant as a temporary fix to make it at least work correctly, before we make it fast &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  I believe a Avro dependency upgrade won&apos;t destroy old savepoints because avro serialization is determined purely by the schema.&lt;/p&gt;</comment>
                            <comment id="15726553" author="githubbot" created="Tue, 6 Dec 2016 20:04:46 +0000"  >&lt;p&gt;GitHub user rmetzger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5039&quot; title=&quot;Avro GenericRecord support is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5039&quot;&gt;&lt;del&gt;FLINK-5039&lt;/del&gt;&lt;/a&gt; Bump Avro version&lt;/p&gt;

&lt;p&gt;    This is a critical issue for some of our users.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rmetzger/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rmetzger/flink&lt;/a&gt; flink5039&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2953&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b3da788361b5ffe72edb033d663a58433a695c73&lt;br/&gt;
Author: Robert Metzger &amp;lt;rmetzger@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-12-06T20:03:10Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5039&quot; title=&quot;Avro GenericRecord support is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5039&quot;&gt;&lt;del&gt;FLINK-5039&lt;/del&gt;&lt;/a&gt; Bump Avro version&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15731863" author="githubbot" created="Thu, 8 Dec 2016 11:06:31 +0000"  >&lt;p&gt;Github user rmetzger commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Rebased to master to include fixed build.&lt;/p&gt;</comment>
                            <comment id="15732419" author="githubbot" created="Thu, 8 Dec 2016 14:56:22 +0000"  >&lt;p&gt;Github user davetorok commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for this!  I was going to PR yesterday but you beat me to it.  Successfully running 25,825,230 Avro / GenericRecords in the past 48 hrs.&lt;/p&gt;</comment>
                            <comment id="15732640" author="githubbot" created="Thu, 8 Dec 2016 16:23:55 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 to merge this for 1.2 and 1.1.4&lt;/p&gt;</comment>
                            <comment id="15732844" author="githubbot" created="Thu, 8 Dec 2016 17:34:33 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 &lt;br/&gt;
    Merging&lt;/p&gt;</comment>
                            <comment id="15733311" author="githubbot" created="Thu, 8 Dec 2016 20:24:45 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2953&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2953&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15733409" author="fhueske" created="Thu, 8 Dec 2016 21:10:08 +0000"  >&lt;p&gt;Fixed for 1.1.4 with 3ae6e9e09ba74f88fe87d1ac130b3cc232a5e88c&lt;br/&gt;
Fixed for 1.2.0 with 2d8f03e7ad12af3a0dcb7bec087c25f19a4fd03e&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 49 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i364if:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>