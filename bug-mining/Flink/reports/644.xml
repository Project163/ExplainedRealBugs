<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:21:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2852] Fix flaky ScalaShellITSuite</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2852</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The &lt;tt&gt;ScalaShellITSuite&lt;/tt&gt; checks the log output whether a job has successful completed or not. For that to happen it checks for a &lt;tt&gt;Job execution switched to status FINISHED&lt;/tt&gt; string in the log output. However, if the &lt;tt&gt;FlinkClientActor&lt;/tt&gt; receives first a &lt;tt&gt;JobResultSuccess&lt;/tt&gt; message before receiving the &lt;tt&gt;JobStatusChanged&lt;/tt&gt; message, then it will send the execution result back to the &lt;tt&gt;Client&lt;/tt&gt; and terminate itself. This has the consequence that the output will never contain the above-mentioned string.&lt;/p&gt;

&lt;p&gt;I propose to use a different mean to check whether a job has finished successfully or not.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12904893">FLINK-2852</key>
            <summary>Fix flaky ScalaShellITSuite</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 14 Oct 2015 14:46:35 +0000</created>
                <updated>Tue, 20 Oct 2015 08:01:58 +0000</updated>
                            <resolved>Tue, 20 Oct 2015 08:01:58 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Scala Shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14963270" author="sachingoel0101" created="Mon, 19 Oct 2015 13:03:39 +0000"  >&lt;p&gt;This is proving to be a major headache, failing almost every other build. Two things:&lt;br/&gt;
1. We definitely need a better way to ensure that a job has finished. I propose this:&lt;br/&gt;
In &lt;tt&gt;JobClient&lt;/tt&gt;, there is a &lt;tt&gt;if-else&lt;/tt&gt; block for&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (answer &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; JobManagerMessages.JobResultSuccess) {
    LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Job execution complete&quot;&lt;/span&gt;);
    ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We can simply add this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sysoutLogUpdates) {
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Job execution complete.&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and check for this string in the result.&lt;/p&gt;

&lt;p&gt;2. Why do we actually need this check in these two tests? None of the other tests in &lt;tt&gt;ScalaShellITSuite&lt;/tt&gt; verify this exact line. We can just have the usual tests which are:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;output should not include &lt;span class=&quot;code-quote&quot;&gt;&quot;Error&quot;&lt;/span&gt;
output should not include &lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;
output should not include &lt;span class=&quot;code-quote&quot;&gt;&quot;Exception&quot;&lt;/span&gt;
output should not include &lt;span class=&quot;code-quote&quot;&gt;&quot;failed&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1 is not a very major issue, and not very important. If this needs to be fixed, it should be in a separate jira. To fix this flaky test, we can just remove the check, as if the execution ever failed, one of the four checks will fail.&lt;br/&gt;
Also, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;val input: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;val els = env.fromElements(\&quot;&lt;/span&gt;a\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;b\&lt;span class=&quot;code-quote&quot;&gt;&quot;);\nels.print\nError\n:q\n&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is somewhat poorly written &lt;span class=&quot;error&quot;&gt;&amp;#91;in both Scala shell integration tests&amp;#93;&lt;/span&gt;. I fail to understand why the &lt;tt&gt;Error&lt;/tt&gt; is left in there. Perhaps it was for debugging purposes, but it should&apos;ve been removed before committing. We should fix this also under this jira.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, if you&apos;re busy with something else, I can push a quick fix for the 2nd point now. We can decide on 1st later.&lt;/p&gt;</comment>
                            <comment id="14963722" author="sachingoel0101" created="Mon, 19 Oct 2015 18:18:59 +0000"  >&lt;p&gt;I was working on a fix. Here&apos;s the code: &lt;a href=&quot;https://github.com/sachingoel0101/flink/tree/flink-2852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/sachingoel0101/flink/tree/flink-2852&lt;/a&gt;&lt;br/&gt;
If you haven&apos;t worked on it yet, I can open a PR from my branch.&lt;/p&gt;</comment>
                            <comment id="14964757" author="till.rohrmann" created="Tue, 20 Oct 2015 08:01:46 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sachingoel0101&quot; class=&quot;user-hover&quot; rel=&quot;sachingoel0101&quot;&gt;sachingoel0101&lt;/a&gt;, you&apos;re right that the test is not robust. I&apos;ve reworked and pushed a commit which should hopefully solve the problem.&lt;/p&gt;</comment>
                            <comment id="14964758" author="till.rohrmann" created="Tue, 20 Oct 2015 08:01:58 +0000"  >&lt;p&gt;Fixed in 630798d&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2n0cv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>