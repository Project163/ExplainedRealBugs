<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19907] Channel state (upstream) can be restored after emission of new elements (watermarks)</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19907</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In&#160;StreamTask.beforeInvoke:&lt;/p&gt;

&lt;p&gt;1. operatorChain.initializeStateAndOpenOperators(createStreamTaskStateInitializer());&lt;/p&gt;

&lt;p&gt;2. readRecoveredChannelState();&lt;/p&gt;

&lt;p&gt;&#160;But&#160;operatorChain.initializeStateAndOpenOperators can emit watermarks (or potentially some other stream elements).&lt;/p&gt;

&lt;p&gt;&#160;I&apos;ve encountered this issue while adding an EndOfRecovery marker - in some runs of in&#160;OverWindowITCase.testRowTimeBoundedPartitionedRangeOver the marker was emitted after the watermark.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjwang&quot; class=&quot;user-hover&quot; rel=&quot;zjwang&quot;&gt;zjwang&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13338219">FLINK-19907</key>
            <summary>Channel state (upstream) can be restored after emission of new elements (watermarks)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="roman">Roman Khachatryan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Sat, 31 Oct 2020 16:56:00 +0000</created>
                <updated>Tue, 22 Jun 2021 13:55:43 +0000</updated>
                            <resolved>Tue, 3 Nov 2020 12:12:51 +0000</resolved>
                                    <version>1.11.2</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.11.3</fixVersion>
                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Network</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17224507" author="zjwang" created="Mon, 2 Nov 2020 08:50:19 +0000"  >&lt;p&gt;I am not quite sure the actual semantic for the new emitted elements while initializing operator state here. But I think we should consider two issues for guaranteeing the precision.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Determinacy for repeated restore: That means the behavior should be consistent while executing the state restore multiple times.&lt;/li&gt;
	&lt;li&gt;Consistency with normal running: Assume the new emitted elements also exist while state snapshot, what is the sequence between them and in-flight channel state, then we should also obey the same sequence after restoring.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17224534" author="arvid" created="Mon, 2 Nov 2020 09:30:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt;&apos;s PR fixes the second case while maintaining the first.&lt;/p&gt;

&lt;p&gt;The issue is that the watermarks are already emitted from a state that is after the in-flight data of the output and input.&lt;/p&gt;</comment>
                            <comment id="17224536" author="arvid" created="Mon, 2 Nov 2020 09:30:49 +0000"  >&lt;p&gt;Merged into master as 3ab31a0473c01c27feb3b64c3f379ebe481a71ce.&lt;/p&gt;</comment>
                            <comment id="17225326" author="arvid" created="Tue, 3 Nov 2020 12:12:37 +0000"  >&lt;p&gt;Also merged in release-1.11 as 8addf891ad97ce83bb22c559aef28411f3953014. Closing issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13337646">FLINK-19856</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0k6fk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>