<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:22:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3254] CombineFunction interface not respected</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3254</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The DataSet API offers a &lt;tt&gt;CombineFunction&lt;/tt&gt; interface, which differs from the &lt;tt&gt;GroupCombineFunction&lt;/tt&gt; interface by being restricted to return a single value instead of returning arbitrary many values through a &lt;tt&gt;Collector&lt;/tt&gt;.&lt;br/&gt;
The JavaDocs of the &lt;tt&gt;GroupCombineFunction&lt;/tt&gt; point to the &lt;tt&gt;CombineFunction&lt;/tt&gt; interface, advertising it as more efficient.&lt;/p&gt;

&lt;p&gt;However, the &lt;tt&gt;CombineFunction&lt;/tt&gt; interface is nor respected by Flink, i.e., a &lt;tt&gt;GroupReduceFunction&lt;/tt&gt; that implements this interface is executed without leveraging the combine method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12932171">FLINK-3254</key>
            <summary>CombineFunction interface not respected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kkl0u">Kostas Kloudas</assignee>
                                    <reporter username="fhueske">Fabian Hueske</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Jan 2016 15:04:36 +0000</created>
                <updated>Wed, 3 Feb 2016 23:30:40 +0000</updated>
                            <resolved>Wed, 3 Feb 2016 23:30:40 +0000</resolved>
                                    <version>0.10.1</version>
                    <version>1.0.0</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>API / DataSet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15126309" author="githubbot" created="Mon, 1 Feb 2016 14:38:54 +0000"  >&lt;p&gt;GitHub user kl0u opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3254&quot; title=&quot;CombineFunction interface not respected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3254&quot;&gt;&lt;del&gt;FLINK-3254&lt;/del&gt;&lt;/a&gt;: Adding functionality to support the CombineFunction contract.&lt;/p&gt;

&lt;p&gt;    Solves ISSUE-3254: now a function that implements the GroupReduceFunction and the CombineFunction interfaces will be executed with a combiner. Before, this was the case only if the function was implementing the GroupReduceFunction and the GroupCombineFunction interfaces.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kl0u/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kl0u/flink&lt;/a&gt; combiner_fix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1568&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 49aabd959472a49f9803023bbec360fec824db75&lt;br/&gt;
Author: Kostas Kloudas &amp;lt;kkloudas@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-01T08:46:00Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3254&quot; title=&quot;CombineFunction interface not respected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3254&quot;&gt;&lt;del&gt;FLINK-3254&lt;/del&gt;&lt;/a&gt;: Adding functionality to support the CombineFunction contract.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15126318" author="githubbot" created="Mon, 1 Feb 2016 14:46:49 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51425707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51425707&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/functions/util/CombineToGroupCombineWrapper.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,49 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +package org.apache.flink.api.common.functions.util;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.google.common.base.Preconditions;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.CombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupCombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupReduceFunction;&lt;br/&gt;
    +import org.apache.flink.util.Collector;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A wrapper the wraps a function that implements both &lt;/p&gt;
{@link CombineFunction}
&lt;p&gt; and &lt;/p&gt;
{@link GroupReduceFunction} interfaces&lt;br/&gt;
    + * and makes it look like a function that implements {@link GroupCombineFunction} and {@link GroupReduceFunction}
&lt;p&gt; to the runtime.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class CombineToGroupCombineWrapper&amp;lt;IN, OUT, F extends CombineFunction&amp;lt;IN, OUT&amp;gt; &amp;amp; GroupReduceFunction&amp;lt;IN, OUT&amp;gt;&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    The generic parameters of the `CombineFunction` and `GroupCombineFunction` should be `&amp;lt;IN, IN&amp;gt;`&lt;/p&gt;</comment>
                            <comment id="15126319" author="githubbot" created="Mon, 1 Feb 2016 14:47:48 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51425852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51425852&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/functions/util/CombineToGroupCombineWrapper.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,49 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +package org.apache.flink.api.common.functions.util;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.google.common.base.Preconditions;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.CombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupCombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupReduceFunction;&lt;br/&gt;
    +import org.apache.flink.util.Collector;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A wrapper the wraps a function that implements both &lt;/p&gt;
{@link CombineFunction}
&lt;p&gt; and &lt;/p&gt;
{@link GroupReduceFunction} interfaces&lt;br/&gt;
    + * and makes it look like a function that implements {@link GroupCombineFunction} and {@link GroupReduceFunction}
&lt;p&gt; to the runtime.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class CombineToGroupCombineWrapper&amp;lt;IN, OUT, F extends CombineFunction&amp;lt;IN, OUT&amp;gt; &amp;amp; GroupReduceFunction&amp;lt;IN, OUT&amp;gt;&amp;gt;&lt;br/&gt;
    +	implements GroupCombineFunction&amp;lt;IN, OUT&amp;gt;, GroupReduceFunction&amp;lt;IN, OUT&amp;gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +	private final F wrappedFunction;&lt;br/&gt;
    +&lt;br/&gt;
    +	public CombineToGroupCombineWrapper(F wrappedFunction) &lt;/p&gt;
{
    +		this.wrappedFunction = Preconditions.checkNotNull(wrappedFunction);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Override&lt;br/&gt;
    +	public void combine(Iterable&amp;lt;IN&amp;gt; values, Collector&amp;lt;OUT&amp;gt; out) throws Exception {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Should be `Collector&amp;lt;IN&amp;gt;`. A combine function (if applied in the context of a reduce function) must preserve the input type.&lt;/p&gt;</comment>
                            <comment id="15126329" author="githubbot" created="Mon, 1 Feb 2016 14:54:36 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51426746&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51426746&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java &amp;#8212;&lt;br/&gt;
    @@ -119,6 +123,8 @@ private void checkCombinability() {&lt;br/&gt;
     				combineTypes != null &amp;amp;&amp;amp; combineTypes.length == 2) {&lt;/p&gt;

&lt;p&gt;     				if (reduceTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.equals(combineTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;) &amp;amp;&amp;amp; reduceTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.equals(combineTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;)) {&lt;br/&gt;
    +					LOG.info(&quot;Combine() and Reduce() methods have compatible input and output types. &quot; +&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This is expected behavior. I would remove this log statement. &lt;/p&gt;</comment>
                            <comment id="15126338" author="githubbot" created="Mon, 1 Feb 2016 14:57:00 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51427090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51427090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java &amp;#8212;&lt;br/&gt;
    @@ -156,8 +162,8 @@ public boolean isCombinable() {&lt;/p&gt;

&lt;p&gt;     	public GroupReduceOperator&amp;lt;IN, OUT&amp;gt; setCombinable(boolean combinable) {&lt;br/&gt;
     		// sanity check that the function is a subclass of the combine interface&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (combinable &amp;amp;&amp;amp; !(function instanceof GroupCombineFunction)) {&lt;/li&gt;
	&lt;li&gt;throw new IllegalArgumentException(&quot;The function does not implement the combine interface.&quot;);&lt;br/&gt;
    +		if (combinable &amp;amp;&amp;amp; !(function instanceof GroupCombineFunction || function instanceof CombineFunction)) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If we change the `checkCombinability` method to return a boolean instead of setting `this.combinable` directly, we can also use it here.&lt;/p&gt;</comment>
                            <comment id="15126339" author="githubbot" created="Mon, 1 Feb 2016 14:59:31 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51427409&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51427409&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/functions/util/CombineToGroupCombineWrapper.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,49 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +package org.apache.flink.api.common.functions.util;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Wrappers such as this function are located in the `flink-java` module in the `org.apache.flink.api.java.operators.translation` package.&lt;/p&gt;</comment>
                            <comment id="15126345" author="githubbot" created="Mon, 1 Feb 2016 15:00:49 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51427575&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51427575&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java &amp;#8212;&lt;br/&gt;
    @@ -193,7 +199,11 @@ public SingleInputSemanticProperties getSemanticProperties() {&lt;br/&gt;
     	protected GroupReduceOperatorBase&amp;lt;?, OUT, ?&amp;gt; translateToDataFlow(Operator&amp;lt;IN&amp;gt; input) {&lt;/p&gt;

&lt;p&gt;     		String name = getName() != null ? getName() : &quot;GroupReduce at &quot; + defaultName;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;p&gt;    +&lt;br/&gt;
    +		this.function = (function instanceof CombineFunction) ?&lt;br/&gt;
    +			new CombineToGroupCombineWrapper((CombineFunction) function) :&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This does also add a bit of overhead to the `reduce` method because it is wrapped. However, this should be OK since it is called just once per group.&lt;/p&gt;</comment>
                            <comment id="15126347" author="githubbot" created="Mon, 1 Feb 2016 15:01:50 +0000"  >&lt;p&gt;Github user kl0u commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51427689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51427689&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java &amp;#8212;&lt;br/&gt;
    @@ -156,8 +162,8 @@ public boolean isCombinable() {&lt;/p&gt;

&lt;p&gt;     	public GroupReduceOperator&amp;lt;IN, OUT&amp;gt; setCombinable(boolean combinable) {&lt;br/&gt;
     		// sanity check that the function is a subclass of the combine interface&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (combinable &amp;amp;&amp;amp; !(function instanceof GroupCombineFunction)) {&lt;/li&gt;
	&lt;li&gt;throw new IllegalArgumentException(&quot;The function does not implement the combine interface.&quot;);&lt;br/&gt;
    +		if (combinable &amp;amp;&amp;amp; !(function instanceof GroupCombineFunction || function instanceof CombineFunction)) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Hi @fhueske, could you explain this a bit more?&lt;/p&gt;
</comment>
                            <comment id="15126353" author="githubbot" created="Mon, 1 Feb 2016 15:06:23 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#discussion_r51428276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#discussion_r51428276&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-tests/src/test/java/org/apache/flink/test/javaApiOperators/ReduceWithCombinerITCase.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,377 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.test.javaApiOperators;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.CombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupCombineFunction;&lt;br/&gt;
    +import org.apache.flink.api.common.functions.GroupReduceFunction;&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet;&lt;br/&gt;
    +import org.apache.flink.api.java.ExecutionEnvironment;&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector;&lt;br/&gt;
    +import org.apache.flink.api.java.operators.UnsortedGrouping;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.api.java.tuple.Tuple3;&lt;br/&gt;
    +import org.apache.flink.test.util.MultipleProgramsTestBase;&lt;br/&gt;
    +import org.apache.flink.util.Collector;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.junit.runner.RunWith;&lt;br/&gt;
    +import org.junit.runners.Parameterized;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.Comparator;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +&lt;br/&gt;
    +@SuppressWarnings(&quot;serial&quot;)&lt;br/&gt;
    +@RunWith(Parameterized.class)&lt;br/&gt;
    +public class ReduceWithCombinerITCase extends MultipleProgramsTestBase {&lt;br/&gt;
    +&lt;br/&gt;
    +	public ReduceWithCombinerITCase(TestExecutionMode mode) &lt;/p&gt;
{
    +		super(TestExecutionMode.CLUSTER);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testReduceOnNonKeyedDataset() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();&lt;br/&gt;
    +		env.setParallelism(4);&lt;br/&gt;
    +&lt;br/&gt;
    +		// creates the input data and distributes them evenly among the available downstream tasks&lt;br/&gt;
    +		DataSet&amp;lt;Tuple2&amp;lt;Integer, Boolean&amp;gt;&amp;gt; input = createNonKeyedInput(env);&lt;br/&gt;
    +&lt;br/&gt;
    +		List&amp;lt;Tuple2&amp;lt;Integer, Boolean&amp;gt;&amp;gt; actual = input.reduceGroup(new NonKeyedCombReducer()).collect();&lt;br/&gt;
    +		List&amp;lt;Tuple2&amp;lt;Integer, Boolean&amp;gt;&amp;gt; expected = Collections.singletonList(new Tuple2&amp;lt;&amp;gt;(10, true));&lt;br/&gt;
    +&lt;br/&gt;
    +		compareResultCollections(expected, actual, new Comparator&amp;lt;Tuple2&amp;lt;Integer, Boolean&amp;gt;&amp;gt;() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Can you use `compareResultAsText` or `compareResultAsTuples` to make the tests more concise?&lt;/p&gt;</comment>
                            <comment id="15126373" author="githubbot" created="Mon, 1 Feb 2016 15:15:21 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#issuecomment-178011362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#issuecomment-178011362&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the PR. I had a few minor comments. Looks good otherwise.&lt;/p&gt;</comment>
                            <comment id="15126435" author="githubbot" created="Mon, 1 Feb 2016 15:53:52 +0000"  >&lt;p&gt;Github user kl0u commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#issuecomment-178039470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#issuecomment-178039470&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks a lot for the comments @fhueske . They are already integrated.&lt;/p&gt;</comment>
                            <comment id="15126515" author="githubbot" created="Mon, 1 Feb 2016 16:37:59 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#issuecomment-178060233&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#issuecomment-178060233&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Good to merge. Thanks!&lt;/p&gt;</comment>
                            <comment id="15131119" author="githubbot" created="Wed, 3 Feb 2016 21:02:30 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568#issuecomment-179464772&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568#issuecomment-179464772&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging this.&lt;/p&gt;</comment>
                            <comment id="15131367" author="githubbot" created="Wed, 3 Feb 2016 23:27:23 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1568&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15131376" author="fhueske" created="Wed, 3 Feb 2016 23:30:40 +0000"  >&lt;p&gt;Fixed with aabb2688a3f4b69a95a87c773a4fe86c76b8ef0f&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rn7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>