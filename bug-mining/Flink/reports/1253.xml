<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:25:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4795] CsvStringify crashes in case of tuple in tuple, t.e. (&quot;a&quot;, True, (1,5))</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4795</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;CsvStringify crashes in case of tuple in tuple, t.e. (&quot;a&quot;, True, (1,5))&lt;/p&gt;

&lt;p&gt;Looks like, mistyping in CsvStringify._map()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def _map(self, value): 
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; isinstance(value, (tuple, list)): 
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;(&quot;&lt;/span&gt; + b&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;.join([self.map(x) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; x in value]) + &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt; 
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;: 
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; str(value) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;self._map() should be called&lt;/p&gt;

&lt;p&gt;But this will affect write_csv() and read_csv().&lt;br/&gt;
write_csv() will work automatically&lt;br/&gt;
and read_csv() should be implemented to be able to read Tuple type.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13011217">FLINK-4795</key>
            <summary>CsvStringify crashes in case of tuple in tuple, t.e. (&quot;a&quot;, True, (1,5))</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="gyag">Yakov Goldberg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Oct 2016 01:53:10 +0000</created>
                <updated>Fri, 21 Oct 2016 09:04:24 +0000</updated>
                            <resolved>Fri, 21 Oct 2016 09:04:24 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15564695" author="zentol" created="Tue, 11 Oct 2016 06:53:18 +0000"  >&lt;p&gt;Thank you for reporting this. As a general remark it is always helpful to include the error message you got.&lt;/p&gt;

&lt;p&gt;You are correct that _map should be called instead.&lt;/p&gt;

&lt;p&gt;read_csv not supporting nested tuples is intended to be consistent with the java &amp;amp; scala counterparts.&lt;/p&gt;</comment>
                            <comment id="15566022" author="gyag" created="Tue, 11 Oct 2016 17:22:44 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.RuntimeException: External process &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task MapPartition (PythonMap) terminated prematurely due to an error.
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/plan.py&quot;&lt;/span&gt;, line 527, in &amp;lt;module&amp;gt;
    env.execute(local=True)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/plan/Environment.py&quot;&lt;/span&gt;, line 181, in execute
    &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;._go()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/functions/Function.py&quot;&lt;/span&gt;, line 64, in _go
    self._run()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/functions/MapFunction.py&quot;&lt;/span&gt;, line 29, in _run
    collector.collect(function(value))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/plan/DataSet.py&quot;&lt;/span&gt;, line 49, in map
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.delim.join([self._map(field) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; field in value])
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/plan/DataSet.py&quot;&lt;/span&gt;, line 53, in _map
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;(&quot;&lt;/span&gt; + b&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;.join([self.map(x) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; x in value]) + &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/flink-dist-cache-f5206634-8cfa-466c-baf4-30eb37f8af10/a229b7e91bc650d230f62eaf039397ec/flink/flink/plan/DataSet.py&quot;&lt;/span&gt;, line 49, in map
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.delim.join([self._map(field) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; field in value])
TypeError: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt; object is not iterable
	at org.apache.flink.python.api.streaming.data.PythonStreamer.streamBufferWithoutGroups(PythonStreamer.java:268)
	at org.apache.flink.python.api.functions.PythonMapPartition.mapPartition(PythonMapPartition.java:54)
	at org.apache.flink.runtime.operators.MapPartitionDriver.run(MapPartitionDriver.java:98)
	at org.apache.flink.runtime.operators.BatchTask.run(BatchTask.java:480)
	at org.apache.flink.runtime.operators.BatchTask.invoke(BatchTask.java:345)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15594544" author="zentol" created="Fri, 21 Oct 2016 09:04:24 +0000"  >&lt;p&gt;Fixed in af96c0776ea1a48838f1d452efb42c03caa64251&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34pbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>