<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6493] Ineffective null check in RegisteredOperatorBackendStateMetaInfo#equals()</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6493</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &amp;amp;&amp;amp; ((partitionStateSerializer == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
          || partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))
        &amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
          || partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The null check for partitionStateSerializer / partitionStateSerializerConfigSnapshot is in combination with another clause.&lt;/p&gt;

&lt;p&gt;This may lead to NPE in the partitionStateSerializer.equals() call.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13070081">FLINK-6493</key>
            <summary>Ineffective null check in RegisteredOperatorBackendStateMetaInfo#equals()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mingleizhang">zhangminglei</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 May 2017 17:57:14 +0000</created>
                <updated>Mon, 12 Mar 2018 15:44:21 +0000</updated>
                            <resolved>Mon, 12 Mar 2018 15:44:21 +0000</resolved>
                                                    <fixVersion>1.3.4</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16085030" author="mingleizhang" created="Thu, 13 Jul 2017 01:45:23 +0000"  >&lt;p&gt;Thanks Ted. &lt;tt&gt;partitionStateSerializerConfigSnapshot.equals()&lt;/tt&gt; also may lead to NPE I guess.&lt;/p&gt;</comment>
                            <comment id="16085054" author="mingleizhang" created="Thu, 13 Jul 2017 02:21:15 +0000"  >&lt;p&gt;Actually, Sorry. I dont think null check is ineffective, as it just combination with another clause which belongs to not empty constructor has &lt;tt&gt;Preconditions.checkNotNull&lt;/tt&gt;. In empty constructor, it does not have a null check. Even though,it would be still throw an NPE when call &lt;tt&gt;partitionStateSerializer.equals()&lt;/tt&gt; if &lt;tt&gt;partitionStateSerializer&lt;/tt&gt; is null and &lt;tt&gt;((Snapshot) obj).getPartitionStateSerializer() == null&lt;/tt&gt; return a false. So, I believe in this case, we should return a false instead of throw an NPE.&lt;/p&gt;</comment>
                            <comment id="16086659" author="githubbot" created="Fri, 14 Jul 2017 00:51:37 +0000"  >&lt;p&gt;GitHub user zhangminglei opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6493&quot; title=&quot;Ineffective null check in RegisteredOperatorBackendStateMetaInfo#equals()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6493&quot;&gt;&lt;del&gt;FLINK-6493&lt;/del&gt;&lt;/a&gt; Fix ineffective null check in RegisteredOperatorBackendS&#8230;&lt;/p&gt;

&lt;p&gt;    This PR is simlar to &lt;a href=&quot;https://github.com/apache/flink/pull/1871/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1871/files&lt;/a&gt;. @tedyu What do you think of this Change ?&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zhangminglei/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zhangminglei/flink&lt;/a&gt; flink-6493-Ineffective-null-check-in-RegisteredOperatorBackendStateMetaInfo#equals&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4328&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 5e771d6a877867cf450fd7ce40c069db6ce97482&lt;br/&gt;
Author: zhangminglei &amp;lt;zml13856086071@163.com&amp;gt;&lt;br/&gt;
Date:   2017-07-14T00:48:51Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6493&quot; title=&quot;Ineffective null check in RegisteredOperatorBackendStateMetaInfo#equals()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6493&quot;&gt;&lt;del&gt;FLINK-6493&lt;/del&gt;&lt;/a&gt; Fix ineffective null check in RegisteredOperatorBackendStateMetaInfo#equals&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16090349" author="githubbot" created="Mon, 17 Jul 2017 19:03:14 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Good fix, thanks!&lt;/p&gt;

&lt;p&gt;    I would suggest to improve the `equals(...)` method all together by pulling out the repeated casts to `Snapshot`.&lt;/p&gt;</comment>
                            <comment id="16091034" author="githubbot" created="Tue, 18 Jul 2017 02:51:44 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    PR has been updated. Please helps to check again. Thanks ~&lt;/p&gt;</comment>
                            <comment id="16106355" author="githubbot" created="Sun, 30 Jul 2017 07:32:00 +0000"  >&lt;p&gt;Github user tedyu commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r130235370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r130235370&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,21 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			Snapshot snapshot;&lt;br/&gt;
    +&lt;br/&gt;
    +			if (obj instanceof Snapshot) &lt;/p&gt;
{
    +				snapshot = (Snapshot)obj;
    +			}
&lt;p&gt; else {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    nit: if you place the condition for else first, declaration and assignment to snapshot can be done in one line.&lt;/p&gt;</comment>
                            <comment id="16106728" author="githubbot" created="Mon, 31 Jul 2017 01:56:33 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks to @tedyu . It is a good idea and code have been updated based on your suggestion. Please check it out again ~ &lt;/p&gt;</comment>
                            <comment id="16110624" author="githubbot" created="Wed, 2 Aug 2017 09:34:58 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zhangminglei there seems to be a checkstyle violation. Please check the Travis logs.&lt;br/&gt;
    Other than that this looks good to merge. Will merge after the violation is fixed.&lt;/p&gt;</comment>
                            <comment id="16110627" author="githubbot" created="Wed, 2 Aug 2017 09:41:41 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r130831063&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r130831063&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (partitionStateSerializer != null &amp;amp;&amp;amp; partitionStateSerializer.equals(snapshot.getPartitionStateSerializer())))&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializerConfigSnapshot() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (partitionStateSerializerConfigSnapshot != null &amp;amp;&amp;amp; partitionStateSerializerConfigSnapshot.equals(snapshot.getPartitionStateSerializerConfigSnapshot())));&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The parentheses of this condition check chain doesn&apos;t look right, leading to compilation errors.&lt;/p&gt;</comment>
                            <comment id="16112038" author="githubbot" created="Thu, 3 Aug 2017 01:36:26 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks @tzulitai. I updated the code, let us wait the build ending. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16112082" author="githubbot" created="Thu, 3 Aug 2017 02:32:51 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This time, build pass.&lt;br/&gt;
    !&lt;span class=&quot;error&quot;&gt;&amp;#91;build&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://user-images.githubusercontent.com/6520673/28903370-11085ea4-7837-11e7-8805-ac4dcc6e9eda.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://user-images.githubusercontent.com/6520673/28903370-11085ea4-7837-11e7-8805-ac4dcc6e9eda.png&lt;/a&gt;)&lt;/p&gt;



</comment>
                            <comment id="16112235" author="githubbot" created="Thu, 3 Aug 2017 06:01:26 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM, merging ..&lt;/p&gt;</comment>
                            <comment id="16112321" author="githubbot" created="Thu, 3 Aug 2017 07:16:53 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131068135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131068135&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We could simplify this using `Objects.equals()`&lt;/p&gt;</comment>
                            <comment id="16112329" author="githubbot" created="Thu, 3 Aug 2017 07:21:10 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131068854&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131068854&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    That makes sense. Haven&apos;t performed the merge yet, @zhangminglei would you like to address this comment?&lt;/p&gt;</comment>
                            <comment id="16112349" author="githubbot" created="Thu, 3 Aug 2017 07:39:05 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131071909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131071909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes. @tzulitai Hahaha, I am so flattered. Any comments is definitely welcomed.&lt;/p&gt;</comment>
                            <comment id="16112503" author="githubbot" created="Thu, 3 Aug 2017 09:45:01 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131097669&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131097669&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +175,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Cool. Please ping me again once updated!&lt;/p&gt;</comment>
                            <comment id="16112546" author="githubbot" created="Thu, 3 Aug 2017 10:22:16 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, @tzulitai I updated the code, I have to say, it is a very good method. Or, xxx.equals probably leading to NPE in our code. Especially in the production environment, people sometime forget make a check for Null.&lt;/p&gt;</comment>
                            <comment id="16112551" author="githubbot" created="Thu, 3 Aug 2017 10:31:17 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131107143&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131107143&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return Objects.equals(name, snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; Objects.equals(assignmentMode, snapshot.getAssignmentMode())&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We don&apos;t need `null` checks for the assignment mode and name.&lt;br/&gt;
    Those are already guaranteed to be non-null in the constructor.&lt;/p&gt;</comment>
                            <comment id="16112553" author="githubbot" created="Thu, 3 Aug 2017 10:33:25 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131107573&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131107573&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return Objects.equals(name, snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; Objects.equals(assignmentMode, snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer())))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    ```&lt;br/&gt;
    &amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer())))&lt;br/&gt;
    ```&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;    These two lines can just be `&amp;amp;&amp;amp; Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer())`, because the `Objects.equals` method returns `true` if both arguments are `null`.&lt;/p&gt;
</comment>
                            <comment id="16112555" author="githubbot" created="Thu, 3 Aug 2017 10:33:36 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131107598&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131107598&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return Objects.equals(name, snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; Objects.equals(assignmentMode, snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer())))&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializerConfigSnapshot() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (Objects.equals(partitionStateSerializerConfigSnapshot, snapshot.getPartitionStateSerializerConfigSnapshot())))));&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Same for these two.&lt;/p&gt;</comment>
                            <comment id="16112636" author="githubbot" created="Thu, 3 Aug 2017 12:20:13 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131125429&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131125429&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return Objects.equals(name, snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; Objects.equals(assignmentMode, snapshot.getAssignmentMode())&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes. You are right. I did this because I want make them have the same way, Objects.equal. Now, I will return to the previously method. Thanks ~&lt;/p&gt;</comment>
                            <comment id="16112647" author="githubbot" created="Thu, 3 Aug 2017 12:31:21 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131127614&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131127614&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,19 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return Objects.equals(name, snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; Objects.equals(assignmentMode, snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; (snapshot.getPartitionStateSerializer() == null)&lt;br/&gt;
    +					&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; (Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer())))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Thanks you so much! Have been addressed.&lt;/p&gt;</comment>
                            <comment id="16112653" author="githubbot" created="Thu, 3 Aug 2017 12:34:58 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hello, @tzulitai Code have been updated. Please check it out. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16112877" author="githubbot" created="Thu, 3 Aug 2017 15:01:37 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328#discussion_r131167537&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328#discussion_r131167537&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/state/RegisteredOperatorBackendStateMetaInfo.java &amp;#8212;&lt;br/&gt;
    @@ -175,14 +176,17 @@ public boolean equals(Object obj) &lt;/p&gt;
{
     				return false;
     			}

&lt;p&gt;    +			if (!(obj instanceof Snapshot)) &lt;/p&gt;
{
    +				return false;
    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			Snapshot snapshot = (Snapshot)obj;&lt;br/&gt;
    +&lt;br/&gt;
     			// need to check for nulls because serializer and config snapshots may be null on restore&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return (obj instanceof Snapshot)&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; name.equals(((Snapshot) obj).getName())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; assignmentMode.equals(((Snapshot) obj).getAssignmentMode())&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializer == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializer() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; ((partitionStateSerializerConfigSnapshot == null &amp;amp;&amp;amp; ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)&lt;/li&gt;
	&lt;li&gt;&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));&lt;br/&gt;
    +			return name.equals(snapshot.getName())&lt;br/&gt;
    +				&amp;amp;&amp;amp; assignmentMode.equals(snapshot.getAssignmentMode())&lt;br/&gt;
    +				&amp;amp;&amp;amp; (Objects.equals(partitionStateSerializer, snapshot.getPartitionStateSerializer()))&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    These extra most-outer wrapping parenthesis are redundant.&lt;br/&gt;
    I&apos;ll remove them when merging.&lt;/p&gt;</comment>
                            <comment id="16112878" author="githubbot" created="Thu, 3 Aug 2017 15:02:07 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks! Alright, this looks good now, merging (will address my final own comment while merging)!&lt;/p&gt;</comment>
                            <comment id="16112899" author="githubbot" created="Thu, 3 Aug 2017 15:11:10 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Sorry, Sir. I&apos;ll pay attention to the details of the next time.&lt;/p&gt;</comment>
                            <comment id="16113808" author="githubbot" created="Fri, 4 Aug 2017 02:07:37 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, @tzulitai I have removed the extra most-outer wrapping parenthesis by myself.&lt;/p&gt;</comment>
                            <comment id="16113827" author="githubbot" created="Fri, 4 Aug 2017 02:32:07 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for that @zhangminglei. However, I&apos;ve already finished testing a batch of commits with this fix included, and would like to merge that now. Sometimes I collect a batch of commits and run them on Travis before merging (that&apos;s why it isn&apos;t actually merged yet).&lt;/p&gt;

&lt;p&gt;    It&apos;s safe to leave some final minor cosmetic fix to the person merging the PR if they mentioned they&apos;ll fix it when merging. That&apos;ll also avoid duplicate work and wasted efforts.&lt;/p&gt;</comment>
                            <comment id="16113832" author="githubbot" created="Fri, 4 Aug 2017 02:34:50 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4328&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16113878" author="tzulitai" created="Fri, 4 Aug 2017 03:36:49 +0000"  >&lt;p&gt;Thanks for the contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mingleizhang&quot; class=&quot;user-hover&quot; rel=&quot;mingleizhang&quot;&gt;mingleizhang&lt;/a&gt;!&lt;br/&gt;
Fixed in master via 875a1369c2ecfd721e3797f59f7ae29e7c522840.&lt;br/&gt;
Fixed in 1.3 via 856d44cdb6147970f0a5912652bedbfaf8f9ca33.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 15 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3enev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>