<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:16:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-941] Possible deadlock after increasing my data set size</title>
                <link>https://issues.apache.org/jira/browse/FLINK-941</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;If I increase my data set, my algorithm stops at some point and doesn&apos;t continue anymore. I already waited a quite amount of time, but nothing happens. The linux processor explorer also displays that the process is sleeping and waiting for something to happen, could maybe be a deadlock.&lt;/p&gt;

&lt;p&gt;I attached the source of my program, the class HAC_2 is the actual algorithm.&lt;br/&gt;
Changing the line 271 from &quot;if(Integer.parseInt(tokens&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;) &amp;gt; 282)&quot; to &quot;if(Integer.parseInt(tokens&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;) &amp;gt; 283)&quot; at my PC &quot;enables&quot; the bug. The numbers 282, 283 are the numbers of the documents in my test data and this line skips all documents with an id greater than that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12721396">FLINK-941</key>
            <summary>Possible deadlock after increasing my data set size</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="bastiank">Bastian K&#246;cher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Jun 2014 11:55:55 +0000</created>
                <updated>Fri, 4 Jul 2014 08:36:23 +0000</updated>
                            <resolved>Fri, 4 Jul 2014 08:36:23 +0000</resolved>
                                    <version>pre-apache-0.5.1</version>
                                    <fixVersion>0.6-incubating</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14032370" author="bastiank" created="Mon, 16 Jun 2014 11:59:20 +0000"  >&lt;p&gt;Source of the program&lt;/p&gt;</comment>
                            <comment id="14032404" author="uce" created="Mon, 16 Jun 2014 13:03:36 +0000"  >&lt;p&gt;I could reproduce the deadlock, but didn&apos;t immediately figure out why it is happening.&lt;/p&gt;

&lt;p&gt;I&apos;ve commented out lines 284 and 285 of &lt;tt&gt;HAC_2&lt;/tt&gt;, which just return early for the first flat map and for DOP 1 the group reduce, which outputs the cluster pair (line 354) is blocked while requesting a buffer for the local receiver.&lt;/p&gt;

&lt;p&gt;I will look into it later.&lt;/p&gt;</comment>
                            <comment id="14034621" author="stephanewen" created="Tue, 17 Jun 2014 23:54:08 +0000"  >&lt;p&gt;When I change line 271 as you said, I do not get the deadlock.&lt;/p&gt;

&lt;p&gt;The deadlock may be dependent on how many buffers are available for intermediate results. What DOPs have you used and what is your maximum head size? I have tried it with DOP 1 and DOP4 on -Xmx192m and it worked.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=uce&quot; class=&quot;user-hover&quot; rel=&quot;uce&quot;&gt;uce&lt;/a&gt; How did you reproduce it?&lt;/p&gt;</comment>
                            <comment id="14035670" author="stephanewen" created="Wed, 18 Jun 2014 13:07:44 +0000"  >&lt;p&gt;I was able to repdroduce the problem, thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=uce&quot; class=&quot;user-hover&quot; rel=&quot;uce&quot;&gt;uce&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The issue is that Broadcast variables are not &lt;/p&gt;

&lt;p&gt;I think the correct way to solve that is to make sure that we never allow backpressure on intermediate results that are consumed by multiple targets. That does depend on the redesigned handling of intermediate result partitions (which &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=uce&quot; class=&quot;user-hover&quot; rel=&quot;uce&quot;&gt;uce&lt;/a&gt; has drafted).&lt;/p&gt;</comment>
                            <comment id="14035686" author="bastiank" created="Wed, 18 Jun 2014 13:35:53 +0000"  >&lt;p&gt;&quot;The issue is that Broadcast variables are not&quot;, I think there is something missing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
So this means I have to wait for a fix in Flink?&lt;/p&gt;</comment>
                            <comment id="14035689" author="stephanewen" created="Wed, 18 Jun 2014 13:40:35 +0000"  >&lt;p&gt;Right &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; The issue is that Broadcast variables are not taken into account when deciding where to place pipeline breakers.&lt;/p&gt;

&lt;p&gt;You need a fix in flink. I am working on it now.&lt;/p&gt;</comment>
                            <comment id="14035708" author="stephanewen" created="Wed, 18 Jun 2014 14:05:06 +0000"  >&lt;p&gt;I think I fixed the issue. A patch should be in the 0.6-SNAPSHOT version in a few hours (pending tests).&lt;/p&gt;

&lt;p&gt;You would have to download and build that version yourself, though.&lt;/p&gt;</comment>
                            <comment id="14035920" author="stephanewen" created="Wed, 18 Jun 2014 16:43:49 +0000"  >&lt;p&gt;Fixed (with test) in 3a452e5bbabe1967ffc04aa34f2959d1efece282&lt;/p&gt;</comment>
                            <comment id="14043227" author="bastiank" created="Wed, 25 Jun 2014 09:09:07 +0000"  >&lt;p&gt;Okay, we tried it now with the latest git version, but we still get the Deadlock :/&lt;/p&gt;</comment>
                            <comment id="14051273" author="uce" created="Thu, 3 Jul 2014 09:52:14 +0000"  >&lt;p&gt;Is there an update? I am curious whether you tried it with a version after &lt;a href=&quot;https://github.com/apache/incubator-flink/commit/f13ad5b415a57e7d1c97319935a04f076cc1776b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;f13ad5b415a57e7d1c97319935a04f076cc1776b&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14051989" author="bastiank" created="Thu, 3 Jul 2014 23:03:59 +0000"  >&lt;p&gt;Yeah, now the Deadlock is gone &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12650555" name="IMPRO-3.SS14.G03.zip" size="4264383" author="bastiank" created="Mon, 16 Jun 2014 11:59:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wsf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399701</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>