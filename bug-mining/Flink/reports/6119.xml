<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:08:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-24444] OperatorCoordinatorSchedulerTest#testGlobalFailoverDoesNotNotifyLocalRestore fails with IllegalState</title>
                <link>https://issues.apache.org/jira/browse/FLINK-24444</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=24727&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=8053&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=24727&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=8053&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13404735">FLINK-24444</key>
            <summary>OperatorCoordinatorSchedulerTest#testGlobalFailoverDoesNotNotifyLocalRestore fails with IllegalState</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dmvk">David Mor&#225;vek</assignee>
                                    <reporter username="dwysakowicz">Dawid Wysakowicz</reporter>
                        <labels>
                            <label>auto-deprioritized-major</label>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 4 Oct 2021 07:43:31 +0000</created>
                <updated>Sun, 16 Jan 2022 11:31:33 +0000</updated>
                            <resolved>Sun, 16 Jan 2022 11:31:25 +0000</resolved>
                                    <version>1.14.0</version>
                                    <fixVersion>1.14.4</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17427039" author="mapohl" created="Mon, 11 Oct 2021 09:41:45 +0000"  >&lt;p&gt;The link to the build failure in the ticket description and the ticket title are a bit misleading. The actual failure is caused by &lt;tt&gt;testGlobalFailoverDoesNotNotifyLocalRestore&lt;/tt&gt; (see &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=24727&amp;amp;view=logs&amp;amp;j=4d4a0d10-fca2-5507-8eed-c07f0bdf4887&amp;amp;t=7b25afdf-cc6c-566f-5459-359dc2585798&amp;amp;l=7565&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;same build in line 7565&lt;/a&gt;):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Oct 04 02:09:28 java.lang.IllegalStateException: Valve closed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; different checkpoint: closed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; = -9223372036854775808, expected = 1
Oct 04 02:09:28 	at org.apache.flink.runtime.operators.coordination.OperatorEventValve.openValveAndUnmarkCheckpoint(OperatorEventValve.java:147)
Oct 04 02:09:28 	at org.apache.flink.runtime.operators.coordination.OperatorCoordinatorHolder.lambda$afterSourceBarrierInjection$5(OperatorCoordinatorHolder.java:358)
Oct 04 02:09:28 	at org.apache.flink.core.testutils.ManuallyTriggeredScheduledExecutorService.trigger(ManuallyTriggeredScheduledExecutorService.java:195)
Oct 04 02:09:28 	at org.apache.flink.core.testutils.ManuallyTriggeredScheduledExecutorService.triggerAll(ManuallyTriggeredScheduledExecutorService.java:180)
Oct 04 02:09:28 	at org.apache.flink.runtime.operators.coordination.OperatorCoordinatorSchedulerTest.closeScheduler(OperatorCoordinatorSchedulerTest.java:873)
Oct 04 02:09:28 	at org.apache.flink.runtime.operators.coordination.OperatorCoordinatorSchedulerTest.shutdownScheduler(OperatorCoordinatorSchedulerTest.java:122)
Oct 04 02:09:28 	at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)
Oct 04 02:09:28 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
Oct 04 02:09:28 	at java.lang.reflect.Method.invoke(Method.java:498)
Oct 04 02:09:28 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
Oct 04 02:09:28 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
Oct 04 02:09:28 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
Oct 04 02:09:28 	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
Oct 04 02:09:28 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
Oct 04 02:09:28 	at org.apache.flink.util.TestNameProvider$1.evaluate(TestNameProvider.java:45)
Oct 04 02:09:28 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
Oct 04 02:09:28 	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
Oct 04 02:09:28 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
Oct 04 02:09:28 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
Oct 04 02:09:28 	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
Oct 04 02:09:28 	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
Oct 04 02:09:28 	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
Oct 04 02:09:28 	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
Oct 04 02:09:28 	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
Oct 04 02:09:28 	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
Oct 04 02:09:28 	at java.util.Iterator.forEachRemaining(Iterator.java:116)
Oct 04 02:09:28 	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
Oct 04 02:09:28 	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
Oct 04 02:09:28 	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
Oct 04 02:09:28 	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
Oct 04 02:09:28 	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
Oct 04 02:09:28 	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
Oct 04 02:09:28 	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
Oct 04 02:09:28 	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m going to update the ticket title accordingly.&lt;/p&gt;</comment>
                            <comment id="17427040" author="mapohl" created="Mon, 11 Oct 2021 09:43:32 +0000"  >&lt;p&gt;We observed the same issue in the VVP fork of Flink 1.14: &lt;a href=&quot;https://dev.azure.com/ververica-dev/daplatform-flink/_build/results?buildId=1566&amp;amp;view=logs&amp;amp;j=9dc1b5dc-bcfa-5f83-eaa7-0cb181ddc267&amp;amp;t=511d2595-ec54-5ab7-86ce-92f328796f20&amp;amp;l=8740&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/ververica-dev/daplatform-flink/_build/results?buildId=1566&amp;amp;view=logs&amp;amp;j=9dc1b5dc-bcfa-5f83-eaa7-0cb181ddc267&amp;amp;t=511d2595-ec54-5ab7-86ce-92f328796f20&amp;amp;l=8740&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17457592" author="flink-jira-bot" created="Sat, 11 Dec 2021 10:39:20 +0000"  >&lt;p&gt;I am the &lt;a href=&quot;https://github.com/apache/flink-jira-bot/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Flink Jira Bot&lt;/a&gt; and I help the community manage its development. I see this issues has been marked as Major but is unassigned and neither itself nor its Sub-Tasks have been updated for 60 days. I have gone ahead and added a &quot;stale-major&quot; to the issue&quot;. If this ticket is a Major, please either assign yourself or give an update. Afterwards, please remove the label or in 7 days the issue will be deprioritized.&lt;/p&gt;</comment>
                            <comment id="17462143" author="flink-jira-bot" created="Sun, 19 Dec 2021 10:39:25 +0000"  >&lt;p&gt;This issue was labeled &quot;stale-major&quot; 7 days ago and has not received any updates so it is being deprioritized. If this ticket is actually Major, please raise the priority and ask a committer to assign you the issue or revive the public discussion.&lt;/p&gt;</comment>
                            <comment id="17468752" author="davidmoravek" created="Tue, 4 Jan 2022 17:24:23 +0000"  >&lt;p&gt;This is caused by the fact, that the checkpoint can complete before opening the operator event valve (valve is opened by calling `afterSourceBarrierInjection` on `OperatorCoordinatorCheckpointContext`).&lt;/p&gt;</comment>
                            <comment id="17476769" author="zentol" created="Sun, 16 Jan 2022 11:31:25 +0000"  >&lt;p&gt;master: f5429e8b4ecd80043cabf0a1bf8141fa9e171e93&lt;br/&gt;
1.14: 97fe1723d7e9071a0a3c93612a50a2dc9652e1d6&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 43 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vj7c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>