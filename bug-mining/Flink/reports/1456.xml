<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5298] TaskManager crashes when TM log not existant</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5298</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.io.FileNotFoundException: flink-taskmanager.out (No such file or directory)
    at java.io.FileInputStream.open0(Native Method)
    at java.io.FileInputStream.open(FileInputStream.java:195)
    at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:138)
    at org.apache.flink.runtime.taskmanager.TaskManager.org$apache$flink$runtime$taskmanager$TaskManager$$handleRequestTaskManagerLog(TaskManager.scala:833)
    at org.apache.flink.runtime.taskmanager.TaskManager$$anonfun$handleMessage$1.applyOrElse(TaskManager.scala:340)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply$mcVL$sp(AbstractPartialFunction.scala:33)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:33)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:25)
    at org.apache.flink.runtime.LeaderSessionMessageFilter$$anonfun$receive$1.applyOrElse(LeaderSessionMessageFilter.scala:44)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply$mcVL$sp(AbstractPartialFunction.scala:33)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:33)
    at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:25)
    at org.apache.flink.runtime.LogMessages$$anon$1.apply(LogMessages.scala:33)
    at org.apache.flink.runtime.LogMessages$$anon$1.apply(LogMessages.scala:28)
    at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:118)
    at org.apache.flink.runtime.LogMessages$$anon$1.applyOrElse(LogMessages.scala:28)
    at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:465)
    at org.apache.flink.runtime.taskmanager.TaskManager.aroundReceive(TaskManager.scala:122)
    at akka.actor.ActorCell.receiveMessage(ActorCell.scala:516)
    at akka.actor.ActorCell.invoke(ActorCell.scala:487)
    at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:254)
    at akka.dispatch.Mailbox.run(Mailbox.scala:221)
    at akka.dispatch.Mailbox.exec(Mailbox.scala:231)
    at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
    at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
    at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
    at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2016-12-08 16:45:14,995 INFO  org.apache.flink.mesos.runtime.clusterframework.MesosTaskManager  - Stopping TaskManager akka:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/taskmanager#1361882659.
&lt;/span&gt;2016-12-08 16:45:14,995 INFO  org.apache.flink.mesos.runtime.clusterframework.MesosTaskManager  - Disassociating from JobManager
2016-12-08 16:45:14,997 INFO  org.apache.flink.runtime.blob.BlobCache                       - Shutting down BlobCache
2016-12-08 16:45:15,006 INFO  org.apache.flink.runtime.io.disk.iomanager.IOManager          - I/O manager removed spill file directory /tmp/flink-io-e61f717b-630c-4a2a-b3e3-62ccb40aa2f9
2016-12-08 16:45:15,006 INFO  org.apache.flink.runtime.io.network.NetworkEnvironment        - Shutting down the network environment and its components.
2016-12-08 16:45:15,008 INFO  org.apache.flink.runtime.io.network.netty.NettyClient         - Successful shutdown (took 1 ms).
2016-12-08 16:45:15,009 INFO  org.apache.flink.runtime.io.network.netty.NettyServer         - Successful shutdown (took 0 ms).
2016-12-08 16:45:15,020 INFO  org.apache.flink.mesos.runtime.clusterframework.MesosTaskManager  - Task manager akka:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/taskmanager is completely shut down.
&lt;/span&gt;2016-12-08 16:45:15,023 ERROR org.apache.flink.runtime.taskmanager.TaskManager              - Actor akka:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/taskmanager#1361882659 terminated, stopping process...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13026732">FLINK-5298</key>
            <summary>TaskManager crashes when TM log not existant</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="Makman2">Mischa Kr&#252;ger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Dec 2016 16:56:24 +0000</created>
                <updated>Sun, 29 Jan 2017 14:42:24 +0000</updated>
                            <resolved>Mon, 23 Jan 2017 21:21:17 +0000</resolved>
                                    <version>1.1.0</version>
                    <version>1.2.0</version>
                    <version>1.3.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>Deployment / Mesos</component>
                    <component>Runtime / Coordination</component>
                    <component>Runtime / Web Frontend</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15732728" author="makman2" created="Thu, 8 Dec 2016 16:58:59 +0000"  >&lt;p&gt;This happened when the log was requested via the web UI.&lt;/p&gt;</comment>
                            <comment id="15733003" author="githubbot" created="Thu, 8 Dec 2016 18:31:41 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5298&quot; title=&quot;TaskManager crashes when TM log not existant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5298&quot;&gt;&lt;del&gt;FLINK-5298&lt;/del&gt;&lt;/a&gt; TM checks that log file exists&lt;/p&gt;

&lt;p&gt;    This PR slightly modifies the `TaskManager#handleRequestTaskManagerLog`. For one it verifies that the log file actually exists before opening it. Second, if the logFilePathOption is empty it no longer throws an IOException (which &lt;em&gt;could&lt;/em&gt; crash the TM) but instead forwards it to the sender.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 5298_tm_log&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2974&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c135d1940e61a4a80b274042e6e095f3369ec911&lt;br/&gt;
Author: zentol &amp;lt;chesnay@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-12-08T18:28:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5298&quot; title=&quot;TaskManager crashes when TM log not existant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5298&quot;&gt;&lt;del&gt;FLINK-5298&lt;/del&gt;&lt;/a&gt; TM checks that log file exists&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15736215" author="githubbot" created="Fri, 9 Dec 2016 20:05:11 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol what is the new behavior?  Does the webui show the IOException?&lt;/p&gt;</comment>
                            <comment id="15736276" author="githubbot" created="Fri, 9 Dec 2016 20:29:43 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This doesn&apos;t really address the &apos;root cause&apos; here, that the .out file is missing (for Mesos deployments).  While we could change `mesos-taskmanager.sh` to redirect the output, I honestly hesitate to, because Mesos is already redirecting the output to &apos;stdout&apos; and &apos;stderr&apos;.   It has log-rolling features too.   Therefore I think it a step backwards to redirect to `flink-taskmanager.out`.&lt;/p&gt;

&lt;p&gt;    So, I think Flink should treat the lack of a log as a &apos;not applicable&apos; situation, not an &apos;error&apos; situation.&lt;/p&gt;
</comment>
                            <comment id="15736346" author="githubbot" created="Fri, 9 Dec 2016 21:04:02 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It should display &quot;Fetching TaskManager log failed.&quot;, and log the exception. (see `TaskManagerLogHandler#respondAsLeader(): logPathFuture.exceptionally(...))&lt;/p&gt;

&lt;p&gt;    This isn&apos;t a case that can only happen on Mesos. If the log was is deleted while the TM is running we have the exact same problem, except in this case it is in fact an error and should be displayed as such. Same if the logging is broken.&lt;/p&gt;

&lt;p&gt;    I agree that we should display something different if we know that no log file should exist; how/whether we can find that out however i simply don&apos;t know. That&apos;s maybe something that you could weigh in.&lt;/p&gt;
</comment>
                            <comment id="15736736" author="githubbot" created="Fri, 9 Dec 2016 23:57:55 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol I am fine with the &apos;error&apos; behavior.&lt;/p&gt;</comment>
                            <comment id="15826422" author="githubbot" created="Tue, 17 Jan 2017 17:22:43 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    What is the state of this PR? It would be great to merge this for the next release candidate.&lt;/p&gt;</comment>
                            <comment id="15826436" author="githubbot" created="Tue, 17 Jan 2017 17:28:33 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann well it still needs a review.&lt;/p&gt;</comment>
                            <comment id="15829765" author="githubbot" created="Thu, 19 Jan 2017 11:47:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r96843830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r96843830&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala &amp;#8212;&lt;br/&gt;
    @@ -830,19 +830,24 @@ class TaskManager(&lt;br/&gt;
               case StdOutFileRequest =&amp;gt;&lt;br/&gt;
                 new File(logFilePath.substring(0, logFilePath.length - 4) + &quot;.out&quot;);&lt;br/&gt;
             }&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val fis = new FileInputStream(file);&lt;/li&gt;
	&lt;li&gt;Future 
{
    -          val client: BlobClient = blobService.get.createClient()
    -          client.put(fis);
    -        }
&lt;p&gt;(context.dispatcher)&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;.onComplete {&lt;/li&gt;
	&lt;li&gt;case Success(value) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! value&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;/li&gt;
	&lt;li&gt;case Failure(e) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! e&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;br/&gt;
    +        if (file.exists()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +          val fis = new FileInputStream(file);    +          Future {
    +            val client: BlobClient = blobService.get.createClient()
    +            client.put(fis);
               }(context.dispatcher)    +            .onComplete {
    +              case Success(value) =&amp;gt;
    +                sender ! value
    +                fis.close()
    +              case Failure(e) =&amp;gt;
    +                sender ! e
    +                fis.close()
    +            }(context.dispatcher)    +        }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else {&lt;br/&gt;
    +          sender ! new IOException(&quot;TaskManager log files are unavailable. &quot; +&lt;br/&gt;
    +            &quot;Log file does not exist.&quot;)&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Maybe we could add the path under which we&apos;ve looked for the log file to the error message.&lt;/p&gt;</comment>
                            <comment id="15829766" author="githubbot" created="Thu, 19 Jan 2017 11:47:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r96843747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r96843747&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala &amp;#8212;&lt;br/&gt;
    @@ -830,19 +830,24 @@ class TaskManager(&lt;br/&gt;
               case StdOutFileRequest =&amp;gt;&lt;br/&gt;
                 new File(logFilePath.substring(0, logFilePath.length - 4) + &quot;.out&quot;);&lt;br/&gt;
             }&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val fis = new FileInputStream(file);&lt;/li&gt;
	&lt;li&gt;Future 
{
    -          val client: BlobClient = blobService.get.createClient()
    -          client.put(fis);
    -        }
&lt;p&gt;(context.dispatcher)&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;.onComplete {&lt;/li&gt;
	&lt;li&gt;case Success(value) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! value&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;/li&gt;
	&lt;li&gt;case Failure(e) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! e&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;br/&gt;
    +        if (file.exists()) {&lt;br/&gt;
    +          val fis = new FileInputStream(file);&lt;br/&gt;
    +          Future 
{
    +            val client: BlobClient = blobService.get.createClient()
    +            client.put(fis);
               }
&lt;p&gt;(context.dispatcher)&lt;br/&gt;
    +            .onComplete {&lt;br/&gt;
    +              case Success(value) =&amp;gt;&lt;br/&gt;
    +                sender ! value&lt;br/&gt;
    +                fis.close()&lt;br/&gt;
    +              case Failure(e) =&amp;gt;&lt;br/&gt;
    +                sender ! e&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    And here `akka.actor.Status.Failure`.&lt;/p&gt;</comment>
                            <comment id="15829767" author="githubbot" created="Thu, 19 Jan 2017 11:47:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r96843719&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r96843719&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala &amp;#8212;&lt;br/&gt;
    @@ -830,19 +830,24 @@ class TaskManager(&lt;br/&gt;
               case StdOutFileRequest =&amp;gt;&lt;br/&gt;
                 new File(logFilePath.substring(0, logFilePath.length - 4) + &quot;.out&quot;);&lt;br/&gt;
             }&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val fis = new FileInputStream(file);&lt;/li&gt;
	&lt;li&gt;Future 
{
    -          val client: BlobClient = blobService.get.createClient()
    -          client.put(fis);
    -        }
&lt;p&gt;(context.dispatcher)&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;.onComplete {&lt;/li&gt;
	&lt;li&gt;case Success(value) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! value&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;/li&gt;
	&lt;li&gt;case Failure(e) =&amp;gt;&lt;/li&gt;
	&lt;li&gt;sender ! e&lt;/li&gt;
	&lt;li&gt;fis.close()&lt;br/&gt;
    +        if (file.exists()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +          val fis = new FileInputStream(file);    +          Future {
    +            val client: BlobClient = blobService.get.createClient()
    +            client.put(fis);
               }(context.dispatcher)    +            .onComplete {
    +              case Success(value) =&amp;gt;
    +                sender ! value
    +                fis.close()
    +              case Failure(e) =&amp;gt;
    +                sender ! e
    +                fis.close()
    +            }(context.dispatcher)    +        }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else {&lt;br/&gt;
    +          sender ! new IOException(&quot;TaskManager log files are unavailable. &quot; +&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The same here with `akka.actor.Status.Failure`.&lt;/p&gt;</comment>
                            <comment id="15829768" author="githubbot" created="Thu, 19 Jan 2017 11:47:03 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r96843696&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r96843696&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala &amp;#8212;&lt;br/&gt;
    @@ -821,7 +821,7 @@ class TaskManager(&lt;br/&gt;
         val logFilePathOption = Option(config.configuration.getString(&lt;br/&gt;
           ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, System.getProperty(&quot;log.file&quot;)));&lt;br/&gt;
         logFilePathOption match {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;case None =&amp;gt; throw new IOException(&quot;TaskManager log files are unavailable. &quot; +&lt;br/&gt;
    +      case None =&amp;gt; sender ! new IOException(&quot;TaskManager log files are unavailable. &quot; +
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    In order to send an `Exception` over the wire to the sender it has to be packed into `akka.actor.Status.Failure`. Otherwise it will only be sent as a normal response type.&lt;/p&gt;</comment>
                            <comment id="15834493" author="githubbot" created="Mon, 23 Jan 2017 13:36:17 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann I&apos;ve addressed your comments.&lt;/p&gt;</comment>
                            <comment id="15834786" author="githubbot" created="Mon, 23 Jan 2017 15:53:42 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r97346693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r97346693&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskManagerTest.java &amp;#8212;&lt;br/&gt;
    @@ -1074,6 +1080,79 @@ protected void run() {&lt;br/&gt;
     		}};&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	@Test&lt;br/&gt;
    +	public void testLogNotFoundHandling() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		new JavaTestKit(system){{&lt;br/&gt;
    +&lt;br/&gt;
    +			ActorGateway jobManager = null;&lt;br/&gt;
    +			ActorGateway taskManager = null;&lt;br/&gt;
    +&lt;br/&gt;
    +			final ActorGateway testActorGateway = new AkkaActorGateway(&lt;br/&gt;
    +				getTestActor(),&lt;br/&gt;
    +				leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +			try {&lt;br/&gt;
    +				final IntermediateDataSetID resultId = new IntermediateDataSetID();&lt;br/&gt;
    +&lt;br/&gt;
    +				// Create the JM&lt;br/&gt;
    +				ActorRef jm = system.actorOf(Props.create(&lt;br/&gt;
    +					new SimplePartitionStateLookupJobManagerCreator(leaderSessionID, getTestActor())));&lt;br/&gt;
    +&lt;br/&gt;
    +				jobManager = new AkkaActorGateway(jm, leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +				final int dataPort = NetUtils.getAvailablePort();&lt;br/&gt;
    +				Configuration config = new Configuration();&lt;br/&gt;
    +				config.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY, dataPort);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);&lt;br/&gt;
    +				config.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, &quot;/i/dont/exist&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +				taskManager = TestingUtils.createTaskManager(&lt;br/&gt;
    +					system,&lt;br/&gt;
    +					jobManager,&lt;br/&gt;
    +					config,&lt;br/&gt;
    +					false,&lt;br/&gt;
    +					true);&lt;br/&gt;
    +&lt;br/&gt;
    +				// ---------------------------------------------------------------------------------&lt;br/&gt;
    +&lt;br/&gt;
    +				final ActorGateway tm = taskManager;&lt;br/&gt;
    +				final ExecutionContextExecutor context = ExecutionContext$.MODULE$.fromExecutor(Executors.newSingleThreadExecutor());&lt;br/&gt;
    +&lt;br/&gt;
    +				new Within(d) {&lt;br/&gt;
    +					@Override&lt;br/&gt;
    +					protected void run() {&lt;br/&gt;
    +						Future&amp;lt;Object&amp;gt; logFuture = tm.ask(TaskManagerMessages.getRequestTaskManagerLog(), timeout);&lt;br/&gt;
    +&lt;br/&gt;
    +						logFuture.onSuccess(new OnSuccess&amp;lt;Object&amp;gt;() {&lt;br/&gt;
    +								@Override&lt;br/&gt;
    +								public void onSuccess(Object result) throws Throwable &lt;/p&gt;
{
    +									Assert.fail();
    +								}
&lt;p&gt;    +							}, context);&lt;br/&gt;
    +						logFuture.onFailure(new OnFailure() {&lt;br/&gt;
    +							@Override&lt;br/&gt;
    +							public void onFailure(Throwable failure) throws Throwable &lt;/p&gt;
{
    +								testActorGateway.tell(new Status.Success(&quot;success&quot;));
    +							}
&lt;p&gt;    +						}, context);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Maybe `Await.result` is a bit more succinct.&lt;/p&gt;</comment>
                            <comment id="15834787" author="githubbot" created="Mon, 23 Jan 2017 15:53:42 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r97346342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r97346342&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskManagerTest.java &amp;#8212;&lt;br/&gt;
    @@ -1074,6 +1080,79 @@ protected void run() {&lt;br/&gt;
     		}};&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	@Test&lt;br/&gt;
    +	public void testLogNotFoundHandling() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		new JavaTestKit(system){{&lt;br/&gt;
    +&lt;br/&gt;
    +			ActorGateway jobManager = null;&lt;br/&gt;
    +			ActorGateway taskManager = null;&lt;br/&gt;
    +&lt;br/&gt;
    +			final ActorGateway testActorGateway = new AkkaActorGateway(&lt;br/&gt;
    +				getTestActor(),&lt;br/&gt;
    +				leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +			try {&lt;br/&gt;
    +				final IntermediateDataSetID resultId = new IntermediateDataSetID();&lt;br/&gt;
    +&lt;br/&gt;
    +				// Create the JM&lt;br/&gt;
    +				ActorRef jm = system.actorOf(Props.create(&lt;br/&gt;
    +					new SimplePartitionStateLookupJobManagerCreator(leaderSessionID, getTestActor())));&lt;br/&gt;
    +&lt;br/&gt;
    +				jobManager = new AkkaActorGateway(jm, leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +				final int dataPort = NetUtils.getAvailablePort();&lt;br/&gt;
    +				Configuration config = new Configuration();&lt;br/&gt;
    +				config.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY, dataPort);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);&lt;br/&gt;
    +				config.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, &quot;/i/dont/exist&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +				taskManager = TestingUtils.createTaskManager(&lt;br/&gt;
    +					system,&lt;br/&gt;
    +					jobManager,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    maybe `ActorRef.noSender()` is enough here.&lt;/p&gt;</comment>
                            <comment id="15834788" author="githubbot" created="Mon, 23 Jan 2017 15:53:43 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r97347534&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r97347534&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime-web/src/test/java/org/apache/flink/runtime/webmonitor/handlers/TaskManagerLogHandlerTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,134 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +package org.apache.flink.runtime.webmonitor.handlers;&lt;br/&gt;
    +&lt;br/&gt;
    +import io.netty.buffer.ByteBuf;&lt;br/&gt;
    +import io.netty.channel.ChannelHandlerContext;&lt;br/&gt;
    +import io.netty.handler.codec.http.DefaultFullHttpRequest;&lt;br/&gt;
    +import io.netty.handler.codec.http.HttpMethod;&lt;br/&gt;
    +import io.netty.handler.codec.http.HttpVersion;&lt;br/&gt;
    +import io.netty.handler.codec.http.router.Routed;&lt;br/&gt;
    +import org.apache.flink.api.common.time.Time;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.runtime.akka.AkkaUtils;&lt;br/&gt;
    +import org.apache.flink.runtime.blob.BlobKey;&lt;br/&gt;
    +import org.apache.flink.runtime.clusterframework.types.ResourceID;&lt;br/&gt;
    +import org.apache.flink.runtime.concurrent.CompletableFuture;&lt;br/&gt;
    +import org.apache.flink.runtime.concurrent.impl.FlinkCompletableFuture;&lt;br/&gt;
    +import org.apache.flink.runtime.instance.ActorGateway;&lt;br/&gt;
    +import org.apache.flink.runtime.instance.Instance;&lt;br/&gt;
    +import org.apache.flink.runtime.instance.InstanceID;&lt;br/&gt;
    +import org.apache.flink.runtime.jobmanager.slots.TaskManagerGateway;&lt;br/&gt;
    +import org.apache.flink.runtime.messages.JobManagerMessages;&lt;br/&gt;
    +import org.apache.flink.runtime.webmonitor.JobManagerRetriever;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +import org.mockito.invocation.InvocationOnMock;&lt;br/&gt;
    +import org.mockito.stubbing.Answer;&lt;br/&gt;
    +import scala.Option;&lt;br/&gt;
    +import scala.collection.JavaConverters;&lt;br/&gt;
    +import scala.concurrent.ExecutionContext$;&lt;br/&gt;
    +import scala.concurrent.Future$;&lt;br/&gt;
    +import scala.concurrent.duration.FiniteDuration;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.concurrent.Executor;&lt;br/&gt;
    +import java.util.concurrent.atomic.AtomicReference;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.mockito.Matchers.any;&lt;br/&gt;
    +import static org.mockito.Matchers.isA;&lt;br/&gt;
    +import static org.powermock.api.mockito.PowerMockito.mock;&lt;br/&gt;
    +import static org.powermock.api.mockito.PowerMockito.when;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TaskManagerLogHandlerTest {&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testLogFetchingFailure() throws Exception {&lt;br/&gt;
    +		// ========= setup TaskManager =================================================================================&lt;br/&gt;
    +		InstanceID tmID = new InstanceID();&lt;br/&gt;
    +		ResourceID tmRID = new ResourceID(tmID.toString());&lt;br/&gt;
    +		TaskManagerGateway taskManagerGateway = mock(TaskManagerGateway.class);&lt;br/&gt;
    +		when(taskManagerGateway.getAddress()).thenReturn(&quot;/tm/address&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +		Instance taskManager = mock(Instance.class);&lt;br/&gt;
    +		when(taskManager.getId()).thenReturn(tmID);&lt;br/&gt;
    +		when(taskManager.getTaskManagerID()).thenReturn(tmRID);&lt;br/&gt;
    +		when(taskManager.getTaskManagerGateway()).thenReturn(taskManagerGateway);&lt;br/&gt;
    +		CompletableFuture&amp;lt;BlobKey&amp;gt; future = new FlinkCompletableFuture&amp;lt;&amp;gt;();&lt;br/&gt;
    +		future.completeExceptionally(new IOException(&quot;failure&quot;));&lt;br/&gt;
    +		when(taskManagerGateway.requestTaskManagerLog(any(Time.class))).thenReturn(future);&lt;br/&gt;
    +&lt;br/&gt;
    +		// ========= setup JobManager ==================================================================================&lt;br/&gt;
    +&lt;br/&gt;
    +		ActorGateway jobManagerGateway = mock(ActorGateway.class);&lt;br/&gt;
    +		Object registeredTaskManagersAnswer = new JobManagerMessages.RegisteredTaskManagers(&lt;br/&gt;
    +			JavaConverters.collectionAsScalaIterableConverter(Collections.singletonList(taskManager)).asScala());&lt;br/&gt;
    +&lt;br/&gt;
    +		when(jobManagerGateway.ask(isA(JobManagerMessages.RequestRegisteredTaskManagers$.class), any(FiniteDuration.class)))&lt;br/&gt;
    +			.thenReturn(Future$.MODULE$.successful(registeredTaskManagersAnswer));&lt;br/&gt;
    +		when(jobManagerGateway.ask(isA(JobManagerMessages.getRequestBlobManagerPort().getClass()), any(FiniteDuration.class)))&lt;br/&gt;
    +			.thenReturn(Future$.MODULE$.successful((Object) 5));&lt;br/&gt;
    +		when(jobManagerGateway.ask(isA(JobManagerMessages.RequestTaskManagerInstance.class), any(FiniteDuration.class)))&lt;br/&gt;
    +			.thenReturn(Future$.MODULE$.successful((Object) new JobManagerMessages.TaskManagerInstance(Option.apply(taskManager))));&lt;br/&gt;
    +		when(jobManagerGateway.path()).thenReturn(&quot;/jm/address&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +		JobManagerRetriever retriever = mock(JobManagerRetriever.class);&lt;br/&gt;
    +		when(retriever.getJobManagerGatewayAndWebPort())&lt;br/&gt;
    +			.thenReturn(Option.apply(new scala.Tuple2&amp;lt;ActorGateway, Integer&amp;gt;(jobManagerGateway, 0)));&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +		TaskManagerLogHandler handler = new TaskManagerLogHandler(&lt;br/&gt;
    +			retriever,&lt;br/&gt;
    +			ExecutionContext$.MODULE$.fromExecutor(new CurrentThreadExecutor()),&lt;br/&gt;
    +			Future$.MODULE$.successful(&quot;/jm/address&quot;),&lt;br/&gt;
    +			AkkaUtils.getDefaultClientTimeout(),&lt;br/&gt;
    +			TaskManagerLogHandler.FileMode.LOG,&lt;br/&gt;
    +			new Configuration(),&lt;br/&gt;
    +			false);&lt;br/&gt;
    +&lt;br/&gt;
    +		final AtomicReference&amp;lt;String&amp;gt; exception = new AtomicReference&amp;lt;&amp;gt;();&lt;br/&gt;
    +		&lt;br/&gt;
    +		ChannelHandlerContext ctx = mock(ChannelHandlerContext.class);&lt;br/&gt;
    +		when(ctx.write(isA(ByteBuf.class))).thenAnswer(new Answer&amp;lt;Object&amp;gt;() {&lt;br/&gt;
    +			@Override&lt;br/&gt;
    +			public Object answer(InvocationOnMock invocationOnMock) throws Throwable &lt;/p&gt;
{
    +				ByteBuf data = invocationOnMock.getArgumentAt(0, ByteBuf.class);
    +				exception.set(new String(data.array()));
    +				return null;
    +			}
&lt;p&gt;    +		});&lt;br/&gt;
    +&lt;br/&gt;
    +		Map&amp;lt;String, String&amp;gt; pathParams = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
    +		pathParams.put(TaskManagersHandler.TASK_MANAGER_ID_KEY, tmID.toString());&lt;br/&gt;
    +		Routed routed = mock(Routed.class);&lt;br/&gt;
    +		when(routed.pathParams()).thenReturn(pathParams);&lt;br/&gt;
    +		when(routed.request()).thenReturn(new DefaultFullHttpRequest(HttpVersion.HTTP_1_1, HttpMethod.GET, &quot;/taskmanagers/&quot; + tmID + &quot;/log&quot;));&lt;br/&gt;
    +&lt;br/&gt;
    +		handler.respondAsLeader(ctx, routed, jobManagerGateway);&lt;br/&gt;
    +&lt;br/&gt;
    +		Assert.assertEquals(&quot;Fetching TaskManager log failed.&quot;, exception.get());&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	public class CurrentThreadExecutor implements Executor {&lt;br/&gt;
    +		public void execute(Runnable r) &lt;/p&gt;
{
    +			r.run();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `Executors.directExecutor` could help.&lt;/p&gt;</comment>
                            <comment id="15834789" author="githubbot" created="Mon, 23 Jan 2017 15:53:43 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r97346835&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r97346835&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskManagerTest.java &amp;#8212;&lt;br/&gt;
    @@ -1074,6 +1080,79 @@ protected void run() {&lt;br/&gt;
     		}};&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	@Test&lt;br/&gt;
    +	public void testLogNotFoundHandling() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		new JavaTestKit(system){{&lt;br/&gt;
    +&lt;br/&gt;
    +			ActorGateway jobManager = null;&lt;br/&gt;
    +			ActorGateway taskManager = null;&lt;br/&gt;
    +&lt;br/&gt;
    +			final ActorGateway testActorGateway = new AkkaActorGateway(&lt;br/&gt;
    +				getTestActor(),&lt;br/&gt;
    +				leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +			try {&lt;br/&gt;
    +				final IntermediateDataSetID resultId = new IntermediateDataSetID();&lt;br/&gt;
    +&lt;br/&gt;
    +				// Create the JM&lt;br/&gt;
    +				ActorRef jm = system.actorOf(Props.create(&lt;br/&gt;
    +					new SimplePartitionStateLookupJobManagerCreator(leaderSessionID, getTestActor())));&lt;br/&gt;
    +&lt;br/&gt;
    +				jobManager = new AkkaActorGateway(jm, leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +				final int dataPort = NetUtils.getAvailablePort();&lt;br/&gt;
    +				Configuration config = new Configuration();&lt;br/&gt;
    +				config.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY, dataPort);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);&lt;br/&gt;
    +				config.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, &quot;/i/dont/exist&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +				taskManager = TestingUtils.createTaskManager(&lt;br/&gt;
    +					system,&lt;br/&gt;
    +					jobManager,&lt;br/&gt;
    +					config,&lt;br/&gt;
    +					false,&lt;br/&gt;
    +					true);&lt;br/&gt;
    +&lt;br/&gt;
    +				// ---------------------------------------------------------------------------------&lt;br/&gt;
    +&lt;br/&gt;
    +				final ActorGateway tm = taskManager;&lt;br/&gt;
    +				final ExecutionContextExecutor context = ExecutionContext$.MODULE$.fromExecutor(Executors.newSingleThreadExecutor());&lt;br/&gt;
    +&lt;br/&gt;
    +				new Within(d) {&lt;br/&gt;
    +					@Override&lt;br/&gt;
    +					protected void run() {&lt;br/&gt;
    +						Future&amp;lt;Object&amp;gt; logFuture = tm.ask(TaskManagerMessages.getRequestTaskManagerLog(), timeout);&lt;br/&gt;
    +&lt;br/&gt;
    +						logFuture.onSuccess(new OnSuccess&amp;lt;Object&amp;gt;() {&lt;br/&gt;
    +								@Override&lt;br/&gt;
    +								public void onSuccess(Object result) throws Throwable &lt;/p&gt;
{
    +									Assert.fail();
    +								}
&lt;p&gt;    +							}, context);&lt;br/&gt;
    +						logFuture.onFailure(new OnFailure() {&lt;br/&gt;
    +							@Override&lt;br/&gt;
    +							public void onFailure(Throwable failure) throws Throwable &lt;/p&gt;
{
    +								testActorGateway.tell(new Status.Success(&quot;success&quot;));
    +							}
&lt;p&gt;    +						}, context);&lt;br/&gt;
    +						&lt;br/&gt;
    +						Status.Success msg = expectMsgClass(Status.Success.class);&lt;br/&gt;
    +						Assert.assertEquals(&quot;success&quot;, msg.status());&lt;br/&gt;
    +					}&lt;br/&gt;
    +				};&lt;br/&gt;
    +			}&lt;br/&gt;
    +			catch(Exception e) {&lt;br/&gt;
    +				e.printStackTrace();&lt;br/&gt;
    +				fail(e.getMessage());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Better let the exception bubble up. Less code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15834825" author="githubbot" created="Mon, 23 Jan 2017 16:18:41 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann I&apos;ve addressed your comments. Will merge this once travis passes.&lt;/p&gt;</comment>
                            <comment id="15834826" author="githubbot" created="Mon, 23 Jan 2017 16:19:26 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974#discussion_r97354396&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974#discussion_r97354396&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskManagerTest.java &amp;#8212;&lt;br/&gt;
    @@ -1074,6 +1080,79 @@ protected void run() {&lt;br/&gt;
     		}};&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	@Test&lt;br/&gt;
    +	public void testLogNotFoundHandling() throws Exception {&lt;br/&gt;
    +&lt;br/&gt;
    +		new JavaTestKit(system){{&lt;br/&gt;
    +&lt;br/&gt;
    +			ActorGateway jobManager = null;&lt;br/&gt;
    +			ActorGateway taskManager = null;&lt;br/&gt;
    +&lt;br/&gt;
    +			final ActorGateway testActorGateway = new AkkaActorGateway(&lt;br/&gt;
    +				getTestActor(),&lt;br/&gt;
    +				leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +			try {&lt;br/&gt;
    +				final IntermediateDataSetID resultId = new IntermediateDataSetID();&lt;br/&gt;
    +&lt;br/&gt;
    +				// Create the JM&lt;br/&gt;
    +				ActorRef jm = system.actorOf(Props.create(&lt;br/&gt;
    +					new SimplePartitionStateLookupJobManagerCreator(leaderSessionID, getTestActor())));&lt;br/&gt;
    +&lt;br/&gt;
    +				jobManager = new AkkaActorGateway(jm, leaderSessionID);&lt;br/&gt;
    +&lt;br/&gt;
    +				final int dataPort = NetUtils.getAvailablePort();&lt;br/&gt;
    +				Configuration config = new Configuration();&lt;br/&gt;
    +				config.setInteger(ConfigConstants.TASK_MANAGER_DATA_PORT_KEY, dataPort);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);&lt;br/&gt;
    +				config.setInteger(TaskManagerOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);&lt;br/&gt;
    +				config.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, &quot;/i/dont/exist&quot;);&lt;br/&gt;
    +&lt;br/&gt;
    +				taskManager = TestingUtils.createTaskManager(&lt;br/&gt;
    +					system,&lt;br/&gt;
    +					jobManager,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Without a JobManager no BlobService is started. This means the TM would fail earlier then we want him to.&lt;/p&gt;

&lt;p&gt;    While trying it out i found another exception that should be wrapped though :&amp;gt;&lt;/p&gt;</comment>
                            <comment id="15835216" author="githubbot" created="Mon, 23 Jan 2017 21:19:26 +0000"  >&lt;p&gt;Github user zentol closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2974&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15835221" author="zentol" created="Mon, 23 Jan 2017 21:21:17 +0000"  >&lt;p&gt;master: b8fa8c65638e8749f9ad994da8ec69a6c34df029&lt;br/&gt;
1.2: f791024eda9ae9d9e3a073754dcb71684d98cb04&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13034378">FLINK-5470</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13035635">FLINK-5533</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37cwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>