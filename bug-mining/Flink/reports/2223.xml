<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8423] OperatorChain#pushToOperator catch block may fail with NPE</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8423</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &amp;lt;X&amp;gt; void pushToOperator(StreamRecord&amp;lt;X&amp;gt; record) {
	&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
		&lt;span class=&quot;code-comment&quot;&gt;// we know that the given outputTag matches our OutputTag so the record
&lt;/span&gt;		&lt;span class=&quot;code-comment&quot;&gt;// must be of the type that our &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; (and Serializer) expects.
&lt;/span&gt;		@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
		StreamRecord&amp;lt;T&amp;gt; castRecord = (StreamRecord&amp;lt;T&amp;gt;) record;

		numRecordsIn.inc();
		StreamRecord&amp;lt;T&amp;gt; copy = castRecord.copy(serializer.copy(castRecord.getValue()));
		&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.setKeyContextElement1(copy);
		&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.processElement(copy);
	} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ClassCastException e) {
		&lt;span class=&quot;code-comment&quot;&gt;// Enrich error message
&lt;/span&gt;		ClassCastException replace = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassCastException(
			&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(
				&lt;span class=&quot;code-quote&quot;&gt;&quot;%s. Failed to push OutputTag with id &lt;span class=&quot;code-quote&quot;&gt;&apos;%s&apos;&lt;/span&gt; to &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;. &quot;&lt;/span&gt; +
				&lt;span class=&quot;code-quote&quot;&gt;&quot;This can occur when multiple OutputTags with different types &quot;&lt;/span&gt; +
				&lt;span class=&quot;code-quote&quot;&gt;&quot;but identical names are being used.&quot;&lt;/span&gt;,
				e.getMessage(),
				outputTag.getId()));

		&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ExceptionInChainedOperatorException(replace);

	} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
		&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ExceptionInChainedOperatorException(e);
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If outputTag is null (as is the case when no sideOutput was defined) the catch block will crash with a NullPointerException. This may happen if &lt;tt&gt;operator.processElement&lt;/tt&gt; throws a ClassCastException.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13130579">FLINK-8423</key>
            <summary>OperatorChain#pushToOperator catch block may fail with NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mingleizhang">zhangminglei</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Jan 2018 16:49:31 +0000</created>
                <updated>Wed, 2 Oct 2019 17:49:46 +0000</updated>
                            <resolved>Tue, 13 Feb 2018 08:54:05 +0000</resolved>
                                    <version>1.4.0</version>
                    <version>1.5.0</version>
                                    <fixVersion>1.4.2</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16358322" author="mingleizhang" created="Fri, 9 Feb 2018 12:19:59 +0000"  >&lt;p&gt;I will fix this issue.&lt;/p&gt;</comment>
                            <comment id="16359208" author="mingleizhang" created="Sat, 10 Feb 2018 02:34:31 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; Does this NPE will make the jvm died ?&lt;/p&gt;</comment>
                            <comment id="16359213" author="githubbot" created="Sat, 10 Feb 2018 02:40:13 +0000"  >&lt;p&gt;GitHub user zhangminglei opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8423&quot; title=&quot;OperatorChain#pushToOperator catch block may fail with NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8423&quot;&gt;&lt;del&gt;FLINK-8423&lt;/del&gt;&lt;/a&gt; OperatorChain#pushToOperator catch block may fail with NPE&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;br/&gt;
    Fix the NPE when outputTag is null.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;br/&gt;
    Add when outputTag is not null, then do the catch block work.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is a trivial rework / code cleanup without any test coverage.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: ( no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): ( no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no )&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (/ no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? ( not documented)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zhangminglei/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zhangminglei/flink&lt;/a&gt; flink-8423&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5447&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 65ac580ca5a3b4c78c954ff08eef9bedcb1e9713&lt;br/&gt;
Author: zhangminglei &amp;lt;zml13856086071@...&amp;gt;&lt;br/&gt;
Date:   2018-02-10T02:32:43Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8423&quot; title=&quot;OperatorChain#pushToOperator catch block may fail with NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8423&quot;&gt;&lt;del&gt;FLINK-8423&lt;/del&gt;&lt;/a&gt; OperatorChain#pushToOperator catch block may fail with NPE&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16359327" author="githubbot" created="Sat, 10 Feb 2018 08:27:45 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167392891&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167392891&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,18 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				if (outputTag != null) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    you are now completely swallowing the exception if the outputtag is null which is unacceptable.&lt;/p&gt;</comment>
                            <comment id="16359336" author="githubbot" created="Sat, 10 Feb 2018 08:56:29 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167393568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167393568&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,18 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				if (outputTag != null) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Okay. So, should we try catch NPE or just output the null id ?&lt;/p&gt;</comment>
                            <comment id="16359363" author="githubbot" created="Sat, 10 Feb 2018 10:34:13 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167395295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167395295&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,18 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				if (outputTag != null) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Neither. just add an else block that re-throws the original exception.&lt;/p&gt;</comment>
                            <comment id="16359369" author="githubbot" created="Sat, 10 Feb 2018 10:56:59 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167395827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167395827&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,18 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				if (outputTag != null) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Thanks @zentol A good method!&lt;/p&gt;</comment>
                            <comment id="16359714" author="githubbot" created="Sun, 11 Feb 2018 02:13:31 +0000"  >&lt;p&gt;Github user zhangminglei commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol I have corrected the code, please helps to review. Thank you very much!&lt;/p&gt;</comment>
                            <comment id="16361156" author="githubbot" created="Mon, 12 Feb 2018 17:47:56 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167633643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167633643&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,28 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				ClassCastException replace;&lt;br/&gt;
    +				if (outputTag != null) 
{
    +					// Enrich error message
    +					replace = new ClassCastException(
    +						String.format(
    +							&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +
    +								&quot;This can occur when multiple OutputTags with different types &quot; +
    +								&quot;but identical names are being used.&quot;,
    +							e.getMessage(),
    +							outputTag.getId()));
    +
    +					throw new ExceptionInChainedOperatorException(replace);
    +				}
&lt;p&gt; else {&lt;br/&gt;
    +					replace = new ClassCastException(&lt;br/&gt;
    +						String.format(&lt;br/&gt;
    +							&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Please properly read my comments. Jut replace the else block with `throw e`.&lt;/p&gt;

&lt;p&gt;    If the OutputTag is null there&apos;s no point in modifying the error message.&lt;/p&gt;</comment>
                            <comment id="16361733" author="githubbot" created="Tue, 13 Feb 2018 02:31:07 +0000"  >&lt;p&gt;Github user zhangminglei commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447#discussion_r167746607&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447#discussion_r167746607&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OperatorChain.java &amp;#8212;&lt;br/&gt;
    @@ -591,16 +591,28 @@ public void collect(StreamRecord&amp;lt;T&amp;gt; record) &lt;/p&gt;
{
     				operator.setKeyContextElement1(copy);
     				operator.processElement(copy);
     			}
&lt;p&gt; catch (ClassCastException e) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Enrich error message&lt;/li&gt;
	&lt;li&gt;ClassCastException replace = new ClassCastException(&lt;/li&gt;
	&lt;li&gt;String.format(&lt;/li&gt;
	&lt;li&gt;&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;This can occur when multiple OutputTags with different types &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;but identical names are being used.&quot;,&lt;/li&gt;
	&lt;li&gt;e.getMessage(),&lt;/li&gt;
	&lt;li&gt;outputTag.getId()));&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;throw new ExceptionInChainedOperatorException(replace);&lt;br/&gt;
    +				ClassCastException replace;&lt;br/&gt;
    +				if (outputTag != null) 
{
    +					// Enrich error message
    +					replace = new ClassCastException(
    +						String.format(
    +							&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +
    +								&quot;This can occur when multiple OutputTags with different types &quot; +
    +								&quot;but identical names are being used.&quot;,
    +							e.getMessage(),
    +							outputTag.getId()));
    +
    +					throw new ExceptionInChainedOperatorException(replace);
    +				}
&lt;p&gt; else {&lt;br/&gt;
    +					replace = new ClassCastException(&lt;br/&gt;
    +						String.format(&lt;br/&gt;
    +							&quot;%s. Failed to push OutputTag with id &apos;%s&apos; to operator. &quot; +&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Sorry for my misunderstanding. I&apos;m unfamiliar with flink&apos;s business now. Thanks~&lt;/p&gt;</comment>
                            <comment id="16362004" author="githubbot" created="Tue, 13 Feb 2018 08:50:12 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging.&lt;/p&gt;</comment>
                            <comment id="16362007" author="zentol" created="Tue, 13 Feb 2018 08:54:05 +0000"  >&lt;p&gt;master: 9e139a72ba45f2dd820bd3b9ecdf8428588666fd&lt;br/&gt;
1.4: bafb91eeb50a2821771a852919b2358fb43622f2&lt;/p&gt;</comment>
                            <comment id="16362009" author="githubbot" created="Tue, 13 Feb 2018 08:54:24 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5447&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13137316">FLINK-8616</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13155056">FLINK-9252</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ov2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>