<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:30:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7426] Table API does not support null values in keys</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7426</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The Table API uses &lt;tt&gt;keyBy&lt;/tt&gt; internally, however, the generated &lt;tt&gt;KeySelector&lt;/tt&gt; uses instances of &lt;tt&gt;Tuple&lt;/tt&gt;. The &lt;tt&gt;TupleSerializer&lt;/tt&gt; is not able to serialize null values. This causes issues during checkpointing or when using the RocksDB state backend. We need to replace all &lt;tt&gt;keyBy&lt;/tt&gt; calls with a custom &lt;tt&gt;RowKeySelector&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AggregateITCase &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; StreamingWithStateTestBase {
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; val queryConfig = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamQueryConfig()
  queryConfig.withIdleStateRetentionTime(Time.hours(1), Time.hours(2))


  @Test
  def testDistinct(): Unit = {
    val env = StreamExecutionEnvironment.getExecutionEnvironment
    env.setStateBackend(getStateBackend)
    val tEnv = TableEnvironment.getTableEnvironment(env)
    StreamITCase.clear

    val t = StreamTestData.get3TupleDataStream(env).toTable(tEnv, &lt;span class=&quot;code-quote&quot;&gt;&apos;a, &apos;&lt;/span&gt;b, &apos;c)
      .select(&apos;b, Null(Types.LONG)).distinct()

    val results = t.toRetractStream[Row](queryConfig)
    results.addSink(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamITCase.RetractingSink).setParallelism(1)
    env.execute()

    val expected = mutable.MutableList(&lt;span class=&quot;code-quote&quot;&gt;&quot;1,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;3,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;4,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;5,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;6,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;)
    assertEquals(expected.sorted, StreamITCase.retractedResults.sorted)
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13094048">FLINK-7426</key>
            <summary>Table API does not support null values in keys</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="twalthr">Timo Walther</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Aug 2017 08:51:07 +0000</created>
                <updated>Tue, 17 Oct 2017 08:47:48 +0000</updated>
                            <resolved>Tue, 17 Oct 2017 08:47:47 +0000</resolved>
                                    <version>1.3.2</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16124525" author="jark" created="Sat, 12 Aug 2017 08:54:42 +0000"  >&lt;p&gt;Shouldn&apos;t this be pushed into DataStream component? I&apos;m just worry about it will come back again when we develop new features.&lt;/p&gt;</comment>
                            <comment id="16125352" author="twalthr" created="Mon, 14 Aug 2017 08:03:49 +0000"  >&lt;p&gt;As far as I know, the DataStream API does not support null values at different locations for performance reasons. Instead of Tuple we would need to use Row or a special null-aware Tuple type. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; what is your opinions here? Should we support null values in keys for the DataStream API? I&apos;m fine with just fixing the Table API. The Table API should at least provide full null support.&lt;/p&gt;</comment>
                            <comment id="16125409" author="aljoscha" created="Mon, 14 Aug 2017 08:52:48 +0000"  >&lt;p&gt;I&apos;m not sure, but implementing proper support for &lt;tt&gt;null&lt;/tt&gt; in the DataStream API sounds like it would take a bit longer.&lt;/p&gt;</comment>
                            <comment id="16182395" author="githubbot" created="Wed, 27 Sep 2017 11:17:38 +0000"  >&lt;p&gt;GitHub user twalthr opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7426&quot; title=&quot;Table API does not support null values in keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7426&quot;&gt;&lt;del&gt;FLINK-7426&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Support null values in keys&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This PR adds support for null values in keys by not relying on the default `KeySelector`.&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;New `CRowKeySelector`&lt;/li&gt;
&lt;/ul&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Two tests have been extended that would fail otherwise.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): yes, for Table programs&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? not applicable&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/twalthr/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twalthr/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7426&quot; title=&quot;Table API does not support null values in keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7426&quot;&gt;&lt;del&gt;FLINK-7426&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4732&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit df3e28e4427ee52986a3b2eaa508ff546a062c6d&lt;br/&gt;
Author: twalthr &amp;lt;twalthr@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-09-27T11:05:44Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7426&quot; title=&quot;Table API does not support null values in keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7426&quot;&gt;&lt;del&gt;FLINK-7426&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Support null values in keys&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16188419" author="githubbot" created="Mon, 2 Oct 2017 16:51:19 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732#discussion_r142164921&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732#discussion_r142164921&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/CRowKeySelector.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.runtime&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.ResultTypeQueryable&lt;br/&gt;
    +import org.apache.flink.table.runtime.types.CRow&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Null-aware key selector.&lt;br/&gt;
    +  */&lt;br/&gt;
    +class CRowKeySelector(&lt;br/&gt;
    +    val keyFields: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +    @transient var returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  extends KeySelector&lt;span class=&quot;error&quot;&gt;&amp;#91;CRow, Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +  with ResultTypeQueryable&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def getKey(value: CRow): Row = {&lt;br/&gt;
    +    val row = value.row&lt;br/&gt;
    +    val fields = keyFields&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Why not use `keyFields` directly?&lt;/p&gt;</comment>
                            <comment id="16188420" author="githubbot" created="Mon, 2 Oct 2017 16:51:20 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732#discussion_r142165496&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732#discussion_r142165496&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/CRowKeySelector.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.runtime&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.ResultTypeQueryable&lt;br/&gt;
    +import org.apache.flink.table.runtime.types.CRow&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Null-aware key selector.&lt;br/&gt;
    +  */&lt;br/&gt;
    +class CRowKeySelector(&lt;br/&gt;
    +    val keyFields: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +    @transient var returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  extends KeySelector&lt;span class=&quot;error&quot;&gt;&amp;#91;CRow, Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +  with ResultTypeQueryable&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def getKey(value: CRow): Row = {&lt;br/&gt;
    +    val row = value.row&lt;br/&gt;
    +    val fields = keyFields&lt;br/&gt;
    +&lt;br/&gt;
    +    val newKey = new Row(fields.length)&lt;br/&gt;
    +    var i = 0&lt;br/&gt;
    +    while (i &amp;lt; fields.length) {&lt;br/&gt;
    +      newKey.setField(i, row.getField(fields&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;))&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    should we add a `project(int[])` method to `Row` similar to `Row.copy()` to reduce the number of method calls?&lt;/p&gt;</comment>
                            <comment id="16188421" author="githubbot" created="Mon, 2 Oct 2017 16:51:20 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732#discussion_r142167389&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732#discussion_r142167389&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/CRowKeySelector.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.runtime&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.ResultTypeQueryable&lt;br/&gt;
    +import org.apache.flink.table.runtime.types.CRow&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Null-aware key selector.&lt;br/&gt;
    +  */&lt;br/&gt;
    +class CRowKeySelector(&lt;br/&gt;
    +    val keyFields: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +    @transient var returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  extends KeySelector&lt;span class=&quot;error&quot;&gt;&amp;#91;CRow, Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +  with ResultTypeQueryable&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def getKey(value: CRow): Row = {&lt;br/&gt;
    +    val row = value.row&lt;br/&gt;
    +    val fields = keyFields&lt;br/&gt;
    +&lt;br/&gt;
    +    val newKey = new Row(fields.length)&lt;br/&gt;
    +    var i = 0&lt;br/&gt;
    +    while (i &amp;lt; fields.length) {&lt;br/&gt;
    +      newKey.setField(i, row.getField(fields&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;))&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    if we do that, we can also make `Row.copy()` more efficient by adding a private constructor that receives an `Object[]` and implementing `copy()` as `return new Row(Arrays.copyOf(row.fields, row.fields.length));`&lt;/p&gt;</comment>
                            <comment id="16206117" author="githubbot" created="Mon, 16 Oct 2017 16:10:50 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732#discussion_r144893205&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732#discussion_r144893205&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/CRowKeySelector.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.runtime&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.ResultTypeQueryable&lt;br/&gt;
    +import org.apache.flink.table.runtime.types.CRow&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Null-aware key selector.&lt;br/&gt;
    +  */&lt;br/&gt;
    +class CRowKeySelector(&lt;br/&gt;
    +    val keyFields: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +    @transient var returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  extends KeySelector&lt;span class=&quot;error&quot;&gt;&amp;#91;CRow, Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +  with ResultTypeQueryable&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def getKey(value: CRow): Row = {&lt;br/&gt;
    +    val row = value.row&lt;br/&gt;
    +    val fields = keyFields&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I did that for micro optimization, but the `project` method approach is even better.&lt;/p&gt;</comment>
                            <comment id="16206118" author="githubbot" created="Mon, 16 Oct 2017 16:11:05 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732#discussion_r144893264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732#discussion_r144893264&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/CRowKeySelector.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.runtime&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.functions.KeySelector&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.ResultTypeQueryable&lt;br/&gt;
    +import org.apache.flink.table.runtime.types.CRow&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Null-aware key selector.&lt;br/&gt;
    +  */&lt;br/&gt;
    +class CRowKeySelector(&lt;br/&gt;
    +    val keyFields: Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +    @transient var returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  extends KeySelector&lt;span class=&quot;error&quot;&gt;&amp;#91;CRow, Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +  with ResultTypeQueryable&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt; {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def getKey(value: CRow): Row = {&lt;br/&gt;
    +    val row = value.row&lt;br/&gt;
    +    val fields = keyFields&lt;br/&gt;
    +&lt;br/&gt;
    +    val newKey = new Row(fields.length)&lt;br/&gt;
    +    var i = 0&lt;br/&gt;
    +    while (i &amp;lt; fields.length) {&lt;br/&gt;
    +      newKey.setField(i, row.getField(fields&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;))&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Good point. I will do that.&lt;/p&gt;</comment>
                            <comment id="16207168" author="githubbot" created="Tue, 17 Oct 2017 08:33:25 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @fhueske. I will merge this now...&lt;/p&gt;</comment>
                            <comment id="16207172" author="githubbot" created="Tue, 17 Oct 2017 08:39:00 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4732&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16207180" author="twalthr" created="Tue, 17 Oct 2017 08:47:48 +0000"  >&lt;p&gt;Fixed in 1.4.0: 14bc62740e90ecefd34f9202f4a37c883c3122e5&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3iopb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>