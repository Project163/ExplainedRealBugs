<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:22:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2115] TableAPI throws ExpressionException for &quot;Dangling GroupBy operation&quot;</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2115</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The following program below throws an ExpressionException due to a &quot;Dangling GroupBy operation&quot;.&lt;br/&gt;
However, I think the program is semantically correct and should execute.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

  ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

  DataSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; data = env.fromElements(1,2,2,3,3,3,4,4,4,4);
  DataSet&amp;lt;Tuple2&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt; tuples = data
      .map(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapFunction&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, Tuple2&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt;() {
        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Tuple2&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; i) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Tuple2&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;(i, i*2);
        }
      });

  TableEnvironment tEnv = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TableEnvironment();
  Table t = tEnv.toTable(tuples).as(&lt;span class=&quot;code-quote&quot;&gt;&quot;i, i2&quot;&lt;/span&gt;)
      .groupBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;i, i2&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;i, i2&quot;&lt;/span&gt;)
      .groupBy(&lt;span class=&quot;code-quote&quot;&gt;&quot;i&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;i, i.count as cnt&quot;&lt;/span&gt;);

  tEnv.toSet(t, Row.class).print();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12833817">FLINK-2115</key>
            <summary>TableAPI throws ExpressionException for &quot;Dangling GroupBy operation&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chengxiang li">Chengxiang Li</assignee>
                                    <reporter username="fhueske">Fabian Hueske</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 May 2015 14:49:52 +0000</created>
                <updated>Thu, 3 Dec 2015 02:35:00 +0000</updated>
                            <resolved>Wed, 2 Dec 2015 11:23:04 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15010977" author="githubbot" created="Wed, 18 Nov 2015 13:35:16 +0000"  >&lt;p&gt;GitHub user ChengXiangLi opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2115&quot; title=&quot;TableAPI throws ExpressionException for &amp;quot;Dangling GroupBy operation&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2115&quot;&gt;&lt;del&gt;FLINK-2115&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Table API&amp;#93;&lt;/span&gt; support no aggregation after groupBy.&lt;/p&gt;

&lt;p&gt;    `JavaBatchTranslator` does not support no aggregation `select` after `groupBy` previously, add the logic in this PR.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ChengXiangLi/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ChengXiangLi/flink&lt;/a&gt; flink-2115&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1377&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 461f60ceb5e07ca192451c07813a405b83470acc&lt;br/&gt;
Author: chengxiang li &amp;lt;chengxiang.li@intel.com&amp;gt;&lt;br/&gt;
Date:   2015-11-18T11:02:11Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2115&quot; title=&quot;TableAPI throws ExpressionException for &amp;quot;Dangling GroupBy operation&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2115&quot;&gt;&lt;del&gt;FLINK-2115&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Table API&amp;#93;&lt;/span&gt; support no aggregation after groupBy.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15011081" author="githubbot" created="Wed, 18 Nov 2015 14:29:28 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-157728542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-157728542&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    What it does now is to only pick one element in the group that has the compound key of the `groupBy` expression. The reason why I did not want to support this initially was that the element that results from this has arbitrary values in the fields that are not key fields since only on arbitrary element of the group of elements is picked.&lt;/p&gt;

&lt;p&gt;    Should we maybe limit this to only allow selecting fields that are also key fields?&lt;/p&gt;</comment>
                            <comment id="15012670" author="githubbot" created="Thu, 19 Nov 2015 02:50:46 +0000"  >&lt;p&gt;Github user ChengXiangLi commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-157932844&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-157932844&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @aljoscha , it&apos;s a very interesting topic, should we add a limitation that only allow key fields to be no aggregated function field in `select` clause?&lt;br/&gt;
    Oracle has this limitation while Mysql does not. Most of the time, select non-aggregation field after groupby has no real meaning, while sometimes, if user is aware that groupby some fielde would lead to  other fields get grouped as well, this feature would help to improve the performance and user convenience, more described here: &lt;a href=&quot;http://dev.mysql.com/doc/refman/5.0/en/group-by-handling.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://dev.mysql.com/doc/refman/5.0/en/group-by-handling.html&lt;/a&gt; . Currently we keep consistent with Mysql on this feature, allow no aggregation field after `groupBy`, with no guarantee of its return value.&lt;br/&gt;
    Actually, i prefer to the Mysql way, more flexible to user, what do you think?  &lt;/p&gt;</comment>
                            <comment id="15013200" author="githubbot" created="Thu, 19 Nov 2015 09:16:36 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-157997049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-157997049&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    OK, I see your point. We can go with the MySQL way then. Thanks for explaining it. :smile: &lt;/p&gt;

&lt;p&gt;    Could you please update the documentation with a small paragraph that explains the behavior?&lt;/p&gt;</comment>
                            <comment id="15013254" author="githubbot" created="Thu, 19 Nov 2015 09:51:21 +0000"  >&lt;p&gt;Github user ChengXiangLi commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-158007073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-158007073&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok, i think it could be added in the `Select` operator description in Table API page, it would depends on  &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2955&quot; title=&quot;Add operations introduction in Table API page.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2955&quot;&gt;&lt;del&gt;FLINK-2955&lt;/del&gt;&lt;/a&gt;. Seems it takes quite long time delay to sync merged commit to github, waiting for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2955&quot; title=&quot;Add operations introduction in Table API page.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2955&quot;&gt;&lt;del&gt;FLINK-2955&lt;/del&gt;&lt;/a&gt; get synced.&lt;/p&gt;</comment>
                            <comment id="15013350" author="githubbot" created="Thu, 19 Nov 2015 11:11:19 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-158025348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-158025348&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @Li Chengxiang, you can always pull changes directly from the ASF git&lt;br/&gt;
    repository: &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf/flink.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf/flink.git&lt;/a&gt;. Then you&lt;br/&gt;
    don&apos;t have to wait for syncing with the github mirror.&lt;/p&gt;

&lt;p&gt;    On Thu, Nov 19, 2015 at 10:51 AM, Li Chengxiang &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
    wrote:&lt;/p&gt;

&lt;p&gt;    &amp;gt; Ok, i think it could be added in the Select operator description in Table&lt;br/&gt;
    &amp;gt; API page, it would depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2955&quot; title=&quot;Add operations introduction in Table API page.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2955&quot;&gt;&lt;del&gt;FLINK-2955&lt;/del&gt;&lt;/a&gt;. Seems it takes quite long time&lt;br/&gt;
    &amp;gt; delay to sync merged commit to github, waiting for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2955&quot; title=&quot;Add operations introduction in Table API page.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2955&quot;&gt;&lt;del&gt;FLINK-2955&lt;/del&gt;&lt;/a&gt; get synced.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &#8212;&lt;br/&gt;
    &amp;gt; Reply to this email directly or view it on GitHub&lt;br/&gt;
    &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-158007073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-158007073&lt;/a&gt;&amp;gt;.&lt;br/&gt;
    &amp;gt;&lt;/p&gt;
</comment>
                            <comment id="15035340" author="githubbot" created="Wed, 2 Dec 2015 06:10:23 +0000"  >&lt;p&gt;Github user ChengXiangLi commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-161190371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-161190371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, @aljoscha , i guess you may forget this PR :smile: , could you help to move this forward? it should be ready yet.&lt;/p&gt;</comment>
                            <comment id="15035544" author="githubbot" created="Wed, 2 Dec 2015 09:34:41 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-161235699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-161235699&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, you are are absolutely right, I&apos;m sorry. Please don&apos;t hesitate to ping me in the future if I&apos;m taking to long but I&apos;ll also try to be more responsive on these.&lt;/p&gt;

&lt;p&gt;    I&apos;m merging it now. :smile: &lt;/p&gt;</comment>
                            <comment id="15035661" author="aljoscha" created="Wed, 2 Dec 2015 11:23:04 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/flink/commit/f8b456b582912f214b606a86664188ae4abf07a3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/f8b456b582912f214b606a86664188ae4abf07a3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15035662" author="githubbot" created="Wed, 2 Dec 2015 11:23:31 +0000"  >&lt;p&gt;Github user aljoscha commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377#issuecomment-161265693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377#issuecomment-161265693&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your efforts. :smile: Could you please close this PR?&lt;/p&gt;</comment>
                            <comment id="15037112" author="githubbot" created="Thu, 3 Dec 2015 02:35:00 +0000"  >&lt;p&gt;Github user ChengXiangLi closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1377&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fdw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>