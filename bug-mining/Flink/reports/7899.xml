<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:22:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-38347] Checkpoint file-merging manager may delete the directory unexpectedly when some RPC messages lost</title>
                <link>https://issues.apache.org/jira/browse/FLINK-38347</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-32086&quot; title=&quot;Cleanup non-reported managed directory on exit of TM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-32086&quot;&gt;&lt;del&gt;FLINK-32086&lt;/del&gt;&lt;/a&gt;, we delete the orphan directories created by file-merging manager. The orphan check depends on the checkpoint notifications. So we should tolerate rpc messages lost, but current implementation using reference counting which does not verify the message completeness using checkpoint id. That may cause unexpected directory deletion, although this is rare.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13628634">FLINK-38347</key>
            <summary>Checkpoint file-merging manager may delete the directory unexpectedly when some RPC messages lost</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zakelly">Zakelly Lan</assignee>
                                    <reporter username="zakelly">Zakelly Lan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 11 Sep 2025 05:00:05 +0000</created>
                <updated>Fri, 12 Sep 2025 02:47:49 +0000</updated>
                            <resolved>Fri, 12 Sep 2025 02:47:49 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>1.20.2</version>
                    <version>2.1.0</version>
                                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>1.20.3</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18019499" author="zakelly" created="Thu, 11 Sep 2025 06:11:49 +0000"  >&lt;p&gt;Problematic steps:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Job start&lt;/li&gt;
	&lt;li&gt;The first checkpoint complete, but the complete notification lost.&lt;/li&gt;
	&lt;li&gt;The second checkpoint triggered, and one subtask did not receive that, but receive the abort notification.&lt;/li&gt;
	&lt;li&gt;Job FO, the directory was deleted by reference counting (checkpoint 1 start &amp;amp; checkpoint 2 abort) &#8212;&#8212; the checkpoint 1 broken&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="18019504" author="gaborgsomogyi" created="Thu, 11 Sep 2025 06:30:06 +0000"  >&lt;p&gt;What is the plan here? I mean complete notification is not guaranteed to be delivered. In the meantime I&apos;ll forge such a malformed app to test it &#128578;&lt;/p&gt;</comment>
                            <comment id="18019505" author="gaborgsomogyi" created="Thu, 11 Sep 2025 06:30:44 +0000"  >&lt;p&gt;Ah, just see the PR opened 4 minutes ago...&lt;/p&gt;</comment>
                            <comment id="18019753" author="zakelly" created="Fri, 12 Sep 2025 02:47:18 +0000"  >&lt;p&gt;Merged into:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master: f3bd4a4962f1bf3310badceccf8f58e4944de099&lt;/li&gt;
	&lt;li&gt;1.20: f54c72fef2966212649e2fe1c69b60f4b5693532&lt;/li&gt;
	&lt;li&gt;2.0: a0ed614e75d033af39eb3c6750ee2af526ff2ff0&lt;/li&gt;
	&lt;li&gt;2.1: 3e7c8eb8518920472317a977b2d59b0dcddd508e&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13536053">FLINK-32086</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13589604">FLINK-36125</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1xn8o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>