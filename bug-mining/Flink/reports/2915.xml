<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:38:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10585] RestServerEndpoint responds with wrong Content-Type in Integration Test.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10585</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Running the test &lt;tt&gt;RestServerEndpointITCase#testRequestInterleaving&lt;/tt&gt; in a loop may trigger the HTTP server to send a response with &lt;tt&gt;Content-Type: application/octet-stream&lt;/tt&gt;, which causes the test to fail. The expected &lt;tt&gt;Content-Type&lt;/tt&gt; is &lt;tt&gt;application/json&lt;/tt&gt;. Note that the REST handler used for testing, can only return json responses. The failure can likely be triggered for other tests inside &lt;tt&gt;RestServerEndpointITCase&lt;/tt&gt; as well. The behavior has not been observed on Linux so far.&lt;/p&gt;

&lt;p&gt;To run the test in a loop, apply the git patch in the attachment, and execute the following command:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean integration-test -pl flink-runtime -am -Dtest=RestServerEndpointITCase -Dfast -DfailIfNoTests=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; -Dsurefire.skipAfterFailureCount=1 -Dlog.dir=/path/to/log-dir -Dlog4j.configuration=file:&lt;span class=&quot;code-comment&quot;&gt;///path/to/flink/tools/log4j-travis.properties&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a while you may see the following stacktrace in the test&apos;s log file:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;================================================================================
15:25:45,619 INFO  org.apache.flink.runtime.rest.RestServerEndpointITCase        -
================================================================================
Test testRequestInterleaving[5253](org.apache.flink.runtime.rest.RestServerEndpointITCase) is running.
--------------------------------------------------------------------------------
15:25:45,620 WARN  org.apache.flink.runtime.rest.RestServerEndpointITCase$TestRestServerEndpoint  - Upload directory /private/var/folders/43/ghpk0br14m99tnl9b86lwfsm0000gn/T/junit7127204190502548819/junit6384422818182277795/flink-web-upload does not exist, or has been deleted externally. Previously uploaded files are no longer available.
15:25:45,620 INFO  org.apache.flink.runtime.rest.RestServerEndpointITCase$TestRestServerEndpoint  - Created directory /private/var/folders/43/ghpk0br14m99tnl9b86lwfsm0000gn/T/junit7127204190502548819/junit6384422818182277795/flink-web-upload for file uploads.
15:25:45,620 INFO  org.apache.flink.runtime.rest.RestClient                      - Rest client endpoint started.
15:25:45,620 INFO  org.apache.flink.runtime.rest.RestServerEndpointITCase$TestRestServerEndpoint  - Starting rest endpoint.
15:25:45,620 INFO  org.apache.flink.runtime.rest.RestServerEndpointITCase$TestRestServerEndpoint  - Rest endpoint listening at localhost:52841
15:25:45,631 ERROR org.apache.flink.runtime.rest.RestClient                      - Response was not valid JSON.
org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.JsonParseException: Illegal character ((CTRL-CHAR, code 0)): only regular white space (\r, \n, \t) is allowed between tokens
 at [Source: org.apache.flink.shaded.netty4.io.netty.buffer.ByteBufInputStream@7823f1cb; line: 1, column: 2]
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:1586)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:521)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.base.ParserMinimalBase._throwInvalidSpace(ParserMinimalBase.java:472)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.json.UTF8StreamJsonParser._skipWSOrEnd(UTF8StreamJsonParser.java:2891)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.json.UTF8StreamJsonParser.nextToken(UTF8StreamJsonParser.java:707)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:3847)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3792)
	at org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper.readTree(ObjectMapper.java:2272)
	at org.apache.flink.runtime.rest.RestClient$ClientHandler.readRawResponse(RestClient.java:505)
	at org.apache.flink.runtime.rest.RestClient$ClientHandler.channelRead0(RestClient.java:453)
	at org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at org.apache.flink.shaded.netty4.io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at org.apache.flink.shaded.netty4.io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:438)
	at org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:253)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at java.lang.Thread.run(Thread.java:748)
15:25:45,633 ERROR org.apache.flink.runtime.rest.RestClient                      - Unexpected plain-text response:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Find below the HTTP response as captured by Wireshark. The paypload is a single 0 byte.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;0000   48 54 54 50 2f 31 2e 30 20 32 30 30 20 4f 4b 0d   HTTP/1.0 200 OK.
0010   0a 43 6f 6e 74 65 6e 74 2d 74 79 70 65 3a 20 61   .Content-type: a
0020   70 70 6c 69 63 61 74 69 6f 6e 2f 6f 63 74 65 74   pplication/octet
0030   2d 73 74 72 65 61 6d 0d 0a 43 6f 6e 74 65 6e 74   -stream..Content
0040   2d 6c 65 6e 67 74 68 3a 20 31 0d 0a 0d 0a         -length: 1....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;&lt;b&gt;Rev:&lt;/b&gt; 3566bb8987872b29aa88b8f7d5b0f122e74bd518&lt;br/&gt;
&lt;b&gt;OS:&lt;/b&gt; macOS High Sierra 10.13.6 (17G65)&lt;br/&gt;
&lt;b&gt;Maven:&lt;/b&gt; 3.2.5&lt;br/&gt;
&lt;b&gt;Java:&lt;/b&gt;&lt;br/&gt;
openjdk version &quot;1.8.0_181&quot;&lt;br/&gt;
OpenJDK Runtime Environment (Zulu 8.31.0.1-macosx) (build 1.8.0_181-b02)&lt;br/&gt;
OpenJDK 64-Bit Server VM (Zulu 8.31.0.1-macosx) (build 25.181-b02, mixed mode)&lt;/p&gt;</environment>
        <key id="13192249">FLINK-10585</key>
            <summary>RestServerEndpoint responds with wrong Content-Type in Integration Test.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gjy">Gary Yao</assignee>
                                    <reporter username="gjy">Gary Yao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 17 Oct 2018 14:01:58 +0000</created>
                <updated>Fri, 1 Mar 2019 06:49:02 +0000</updated>
                            <resolved>Fri, 1 Mar 2019 06:49:02 +0000</resolved>
                                    <version>1.6.1</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.8.0</fixVersion>
                                    <component>Runtime / REST</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16664936" author="zentol" created="Fri, 26 Oct 2018 09:24:45 +0000"  >&lt;p&gt;May be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10690&quot; title=&quot;Tests leak resources via Files.list&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10690&quot;&gt;&lt;del&gt;FLINK-10690&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16777908" author="gjy" created="Tue, 26 Feb 2019 13:26:04 +0000"  >&lt;p&gt;Similar issue as described here &lt;a href=&quot;https://github.com/oracle/helidon/issues/249&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/oracle/helidon/issues/249&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16781347" author="gjy" created="Fri, 1 Mar 2019 06:49:02 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.8:&lt;br/&gt;
&lt;tt&gt;a6902cef6281f06bc54592d9a3bd6e4362dd0dc3&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;cd8857ba20e725a2c1b226488e9c88459674acc8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;eed09094a7d241ecede75034b42a54245027145c&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;6d29ea2e11011596fbe7deaf0727184beb62c5c6&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;master:&lt;br/&gt;
&lt;tt&gt;eb58bf7113267da35b021a3682ca3966b74ddf84&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;33e0ca7d7c052dde404f0cabc4e514a7be284501&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;9b66985fe0589b7b8239f3c3d48eb8719ec6e8b2&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;f8d0855949c24c8c283d1ace6350175d837d9cd2&lt;/tt&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13192337">FLINK-10586</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12944334" name="loop_test.patch" size="10643" author="gjy" created="Wed, 17 Oct 2018 14:01:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3zb7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>