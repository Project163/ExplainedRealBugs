<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:18:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-33313] RexNodeExtractor fails to extract conditions with binary literal</title>
                <link>https://issues.apache.org/jira/browse/FLINK-33313</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;An exception will be thrown when we try to extract conditions with binary literal in RexNodeExtractor. Here is a test I add in `RexNodeExtractorTest` which could reproduce the case(Also add a field &apos;blob&apos; with bytes type in RexNodeTestBase).&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @Test
  def testExtractConditionWithBinaryLiteral(): Unit = {
    &lt;span class=&quot;code-comment&quot;&gt;// blob
&lt;/span&gt;    val t0 = rexBuilder.makeInputRef(allFieldTypes.get(5), 5)

    &lt;span class=&quot;code-comment&quot;&gt;// X&lt;span class=&quot;code-quote&quot;&gt;&apos;616263&apos;&lt;/span&gt;
&lt;/span&gt;    val t1 = rexBuilder.makeBinaryLiteral(ByteString.of(&lt;span class=&quot;code-quote&quot;&gt;&quot;616263&quot;&lt;/span&gt;, 16))

    &lt;span class=&quot;code-comment&quot;&gt;// blob = X&lt;span class=&quot;code-quote&quot;&gt;&apos;616263&apos;&lt;/span&gt;
&lt;/span&gt;    val a = rexBuilder.makeCall(SqlStdOperatorTable.EQUALS, t0, t1)

    val relBuilder: RexBuilder = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FlinkRexBuilder(typeFactory)
    val (convertedExpressions, unconvertedRexNodes) =
      extractConjunctiveConditions(a, -1, allFieldNames, relBuilder, functionCatalog)

    val expected: Array[Expression] = Array($&lt;span class=&quot;code-quote&quot;&gt;&quot;blob&quot;&lt;/span&gt; === Array[&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;](97, 98, 99))
    assertExpressionArrayEquals(expected, convertedExpressions)
    assertEquals(0, unconvertedRexNodes.length)
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And here is the exception stack:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.flink.table.api.ValidationException: Data type &lt;span class=&quot;code-quote&quot;&gt;&apos;BINARY(3) NOT NULL&apos;&lt;/span&gt; with conversion class &lt;span class=&quot;code-quote&quot;&gt;&apos;[B&apos;&lt;/span&gt; does not support a value literal of class &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.calcite.avatica.util.ByteString&apos;&lt;/span&gt;.

	at org.apache.flink.table.expressions.ValueLiteralExpression.validateValueDataType(ValueLiteralExpression.java:294)
	at org.apache.flink.table.expressions.ValueLiteralExpression.&amp;lt;init&amp;gt;(ValueLiteralExpression.java:79)
	at org.apache.flink.table.expressions.ApiExpressionUtils.valueLiteral(ApiExpressionUtils.java:251)
	at org.apache.flink.table.planner.plan.utils.RexNodeToExpressionConverter.visitLiteral(RexNodeExtractor.scala:503)
	at org.apache.flink.table.planner.plan.utils.RexNodeToExpressionConverter.visitLiteral(RexNodeExtractor.scala:393)
	at org.apache.calcite.rex.RexLiteral.accept(RexLiteral.java:1217)
	at org.apache.flink.table.planner.plan.utils.RexNodeToExpressionConverter.$anonfun$visitCall$3(RexNodeExtractor.scala:509)
	at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:233)
	at scala.collection.Iterator.foreach(Iterator.scala:937)
	at scala.collection.Iterator.foreach$(Iterator.scala:937)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1425)
	at scala.collection.IterableLike.foreach(IterableLike.scala:70)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:69)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
	at scala.collection.TraversableLike.map(TraversableLike.scala:233)
	at scala.collection.TraversableLike.map$(TraversableLike.scala:226)
	at scala.collection.AbstractTraversable.map(Traversable.scala:104)
	at org.apache.flink.table.planner.plan.utils.RexNodeToExpressionConverter.visitCall(RexNodeExtractor.scala:509)
	at org.apache.flink.table.planner.plan.utils.RexNodeToExpressionConverter.visitCall(RexNodeExtractor.scala:393)
	at org.apache.calcite.rex.RexCall.accept(RexCall.java:189)
	at org.apache.flink.table.planner.plan.utils.RexNodeExtractor$.$anonfun$extractConjunctiveConditions$2(RexNodeExtractor.scala:158)
	at scala.collection.Iterator.foreach(Iterator.scala:937)
	at scala.collection.Iterator.foreach$(Iterator.scala:937)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1425)
	at scala.collection.IterableLike.foreach(IterableLike.scala:70)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:69)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
	at org.apache.flink.table.planner.plan.utils.RexNodeExtractor$.extractConjunctiveConditions(RexNodeExtractor.scala:157)
	at org.apache.flink.table.planner.plan.utils.RexNodeExtractor$.extractConjunctiveConditions(RexNodeExtractor.scala:119)
	at org.apache.flink.table.planner.plan.utils.RexNodeExtractorTest.extractConjunctiveConditions(RexNodeExtractorTest.scala:785)
	at org.apache.flink.table.planner.plan.utils.RexNodeExtractorTest.testExtractConditionWithBinaryLiteral(RexNodeExtractorTest.scala:160)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;IMO, we should cast `ByteString` to `byte[]` in RexNodeToExpressionConverter#visitLiteral&lt;/p&gt;</description>
                <environment></environment>
        <key id="13554712">FLINK-33313</key>
            <summary>RexNodeExtractor fails to extract conditions with binary literal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="FrankZou">Dan Zou</assignee>
                                    <reporter username="FrankZou">Dan Zou</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 19 Oct 2023 07:49:00 +0000</created>
                <updated>Sat, 9 Dec 2023 15:21:49 +0000</updated>
                            <resolved>Fri, 20 Oct 2023 09:40:14 +0000</resolved>
                                                    <fixVersion>1.19.0</fixVersion>
                    <fixVersion>1.18.1</fixVersion>
                    <fixVersion>1.17.3</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17777667" author="libenchao" created="Fri, 20 Oct 2023 09:39:59 +0000"  >&lt;p&gt;merged: master(1.19.0) : 4d37b8c34ff062b7505ab8c0ca8f2181768aab60&lt;/p&gt;</comment>
                            <comment id="17777676" author="libenchao" created="Fri, 20 Oct 2023 09:53:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=FrankZou&quot; class=&quot;user-hover&quot; rel=&quot;FrankZou&quot;&gt;FrankZou&lt;/a&gt; Do this also affect 1.18 and 1.17, if yes, we also need to fix for these versions, could you help to prepare the corresponding PRs?&lt;/p&gt;</comment>
                            <comment id="17778505" author="frankzou" created="Mon, 23 Oct 2023 02:34:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=libenchao&quot; class=&quot;user-hover&quot; rel=&quot;libenchao&quot;&gt;libenchao&lt;/a&gt; OK, I will do it.&lt;/p&gt;</comment>
                            <comment id="17794593" author="libenchao" created="Fri, 8 Dec 2023 08:58:27 +0000"  >&lt;p&gt;1.18.1&#65306; 265d81741654ff70836485e8e8d31ce33a87e960&lt;/p&gt;</comment>
                            <comment id="17794968" author="libenchao" created="Sat, 9 Dec 2023 15:21:49 +0000"  >&lt;p&gt;1.17.3: cfc7881ab5f1c27d7a9a7781b255fa94989201b9&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1l1sw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>