<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:25:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4555] Explicitly kill TaskManager on YARN when ApplicationMaster is shutting down</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4555</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;It seems that Flink is not explicitly destroying the TaskManager JVM when the ApplicationMaster is shutting down (when the YARN application is stopping).&lt;/p&gt;

&lt;p&gt;Since this was once in Flink (in 1.0.x) we should add a test case to ensure this feature stays in the code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002013">FLINK-4555</key>
            <summary>Explicitly kill TaskManager on YARN when ApplicationMaster is shutting down</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Sep 2016 11:01:34 +0000</created>
                <updated>Mon, 19 Dec 2016 12:46:51 +0000</updated>
                            <resolved>Sat, 24 Sep 2016 11:59:49 +0000</resolved>
                                    <version>1.1.0</version>
                                                    <component>Deployment / YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15503965" author="mxm" created="Mon, 19 Sep 2016 16:47:15 +0000"  >&lt;p&gt;There has been some refactoring previously. However, I couldn&apos;t find that the feature has been removed. The cluster shuts down cleanly in the following order:&lt;/p&gt;

&lt;p&gt;1. Client requests shutdown &lt;br/&gt;
2. JobManager receives StopCluster message &lt;br/&gt;
3. JobManager sends StopCluster message to all connected TaskManager&lt;br/&gt;
  3.1 TaskManagers shut down and start a ProcessShutDownThread which kills after 10 seconds. &lt;br/&gt;
4. JobManager sends StopCluster message to the ResourceManager&lt;br/&gt;
  4.1 ResourceManager unregisters as application master&lt;br/&gt;
5. JobManager shuts down, informs the client, and starts a ProcessShutDownThread which kills after 10 seconds. &lt;/p&gt;

&lt;p&gt;Still, a good idea to back this with a test.&lt;/p&gt;</comment>
                            <comment id="15503985" author="githubbot" created="Mon, 19 Sep 2016 16:53:43 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2514&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2514&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4555&quot; title=&quot;Explicitly kill TaskManager on YARN when ApplicationMaster is shutting down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4555&quot;&gt;&lt;del&gt;FLINK-4555&lt;/del&gt;&lt;/a&gt; add test case to test Yarn cluster shutdown&lt;/p&gt;

&lt;p&gt;    In the first commit, it ensures that the cluster shutdown is working as expected.&lt;/p&gt;

&lt;p&gt;    In a second commit, it gives the ResourceManager more time to unregister the application. This is not important as Yarn also monitors processes but should ensure that everything shuts down cleanly.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4555&quot; title=&quot;Explicitly kill TaskManager on YARN when ApplicationMaster is shutting down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4555&quot;&gt;&lt;del&gt;FLINK-4555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2514.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2514.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2514&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9f22fe8c5967e4ac77feed0f83e36f5daa7ba74c&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-09-19T16:45:05Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4555&quot; title=&quot;Explicitly kill TaskManager on YARN when ApplicationMaster is shutting down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4555&quot;&gt;&lt;del&gt;FLINK-4555&lt;/del&gt;&lt;/a&gt; add test case to test Yarn cluster shutdown&lt;/p&gt;

&lt;p&gt;commit 7989dfa73f23fdb262b5d6f466c05579132d9d27&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-09-19T16:45:37Z&lt;/p&gt;

&lt;p&gt;    wait for ResourceManager to cleanly unregister application&lt;/p&gt;

&lt;p&gt;    This ensures that the ResourceManager has enough time to unregister the&lt;br/&gt;
    application for shutting down.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15506586" author="githubbot" created="Tue, 20 Sep 2016 13:46:31 +0000"  >&lt;p&gt;Github user mxm commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2514&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2514&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Actually, I have written a much better test case for this some time ago, see &lt;a href=&quot;https://github.com/apache/flink/blob/142912b031df42d2abe43b41e98be5596cb3a7f9/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/142912b031df42d2abe43b41e98be5596cb3a7f9/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    So I would only merge the addition to the ResourceManager shutdown.&lt;/p&gt;</comment>
                            <comment id="15518925" author="githubbot" created="Sat, 24 Sep 2016 11:49:39 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2514&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2514&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i334lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>