<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:57:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22692] CheckpointStoreITCase.testRestartOnRecoveryFailure fails with RuntimeException</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22692</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Not sure if it is related to the adaptive scheduler: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18052&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18052&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
May 17 22:29:11 [ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 1.351 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.test.checkpointing.CheckpointStoreITCase
May 17 22:29:11 [ERROR] testRestartOnRecoveryFailure(org.apache.flink.test.checkpointing.CheckpointStoreITCase)  Time elapsed: 1.138 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
May 17 22:29:11 org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
May 17 22:29:11 	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:144)
May 17 22:29:11 	at org.apache.flink.runtime.minicluster.MiniClusterJobClient.lambda$getJobExecutionResult$3(MiniClusterJobClient.java:137)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
May 17 22:29:11 	at org.apache.flink.runtime.rpc.akka.AkkaInvocationHandler.lambda$invokeRpc$0(AkkaInvocationHandler.java:237)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
May 17 22:29:11 	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
May 17 22:29:11 	at org.apache.flink.runtime.concurrent.FutureUtils$1.onComplete(FutureUtils.java:1081)
May 17 22:29:11 	at akka.dispatch.OnComplete.internal(Future.scala:264)
May 17 22:29:11 	at akka.dispatch.OnComplete.internal(Future.scala:261)
May 17 22:29:11 	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:191)
May 17 22:29:11 	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:188)
May 17 22:29:11 	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
May 17 22:29:11 	at org.apache.flink.runtime.concurrent.Executors$DirectExecutionContext.execute(Executors.java:73)
May 17 22:29:11 	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
May 17 22:29:11 	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
May 17 22:29:11 	at akka.pattern.PromiseActorRef.$bang(AskSupport.scala:572)
May 17 22:29:11 	at akka.pattern.PipeToSupport$PipeableFuture$$anonfun$pipeTo$1.applyOrElse(PipeToSupport.scala:22)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13378967">FLINK-22692</key>
            <summary>CheckpointStoreITCase.testRestartOnRecoveryFailure fails with RuntimeException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Tue, 18 May 2021 08:09:55 +0000</created>
                <updated>Thu, 20 May 2021 13:41:19 +0000</updated>
                            <resolved>Thu, 20 May 2021 13:41:19 +0000</resolved>
                                    <version>1.13.0</version>
                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.1</fixVersion>
                                    <component>Runtime / Checkpointing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17346675" author="rmetzger" created="Tue, 18 May 2021 08:10:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt; can you take a look at this failure?&lt;/p&gt;</comment>
                            <comment id="17347278" author="maguowei" created="Wed, 19 May 2021 03:18:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18106&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4516&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18106&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4516&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18108&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18108&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4510&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18151&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4516&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=18151&amp;amp;view=logs&amp;amp;j=8fd9202e-fd17-5b26-353c-ac1ff76c8f28&amp;amp;t=a0a633b8-47ef-5c5a-2806-3c13b9e48228&amp;amp;l=4516&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17347375" author="roman_khachatryan" created="Wed, 19 May 2021 07:44:34 +0000"  >&lt;p&gt;I couldn&apos;t reproduce&#160; the issue with the default scheduler.&lt;/p&gt;

&lt;p&gt;However, it is easily reproducible with the adaptive scheduler (e.g. add&#160;.set(JobManagerOptions.SCHEDULER, JobManagerOptions.SchedulerType.Adaptive) to CheckpointStoreITCase on line 67).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Which shows that the behavior of Adaptive scheduler differs from the Default one: it doesn&apos;t restart the job if a failure occurs during recovery.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is the difference above something intentional&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17347385" author="till.rohrmann" created="Wed, 19 May 2021 07:54:23 +0000"  >&lt;p&gt;Yes, the &lt;tt&gt;AdaptiveScheduler&lt;/tt&gt; fails the job if it cannot create the &lt;tt&gt;ExeuctionGraph&lt;/tt&gt; (see &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21846&quot; title=&quot;Rethink whether failure of ExecutionGraph creation in Adaptive Scheduler should directly fail the job&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21846&quot;&gt;FLINK-21846&lt;/a&gt;). Consequently, it does not restart the process in case of recovery failure. The problem is that we only do the recovery of the checkpoints once we create the &lt;tt&gt;ExecutionGraph&lt;/tt&gt;. Since the &lt;tt&gt;ExecutionGraph&lt;/tt&gt; is not immediately created, it will only be realized later. I think that &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22483&quot; title=&quot;Recover checkpoints when JobMaster gains leadership&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22483&quot;&gt;&lt;del&gt;FLINK-22483&lt;/del&gt;&lt;/a&gt; might actually solve this particular problem because it moves the recovery of checkpoints to the point where we create the &lt;tt&gt;JobMaster&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17347413" author="roman_khachatryan" created="Wed, 19 May 2021 08:35:32 +0000"  >&lt;p&gt;Makes sense, thanks for the clarification.&lt;/p&gt;

&lt;p&gt;So currently a combination of: (&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22502&quot; title=&quot;DefaultCompletedCheckpointStore drops unrecoverable checkpoints silently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22502&quot;&gt;&lt;del&gt;FLINK-22502&lt;/del&gt;&lt;/a&gt; with Adaptive scheduler without &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22483&quot; title=&quot;Recover checkpoints when JobMaster gains leadership&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22483&quot;&gt;&lt;del&gt;FLINK-22483&lt;/del&gt;&lt;/a&gt;) will fail a job in case of a transient failure.&lt;/p&gt;

&lt;p&gt;Which still seems a better behavior than before&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22502&quot; title=&quot;DefaultCompletedCheckpointStore drops unrecoverable checkpoints silently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22502&quot;&gt;&lt;del&gt;FLINK-22502&lt;/del&gt;&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;So I propose to add an assumption to tests that the Default scheduer is used (and drop it once &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22483&quot; title=&quot;Recover checkpoints when JobMaster gains leadership&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22483&quot;&gt;&lt;del&gt;FLINK-22483&lt;/del&gt;&lt;/a&gt; is implemented).&lt;/p&gt;

&lt;p&gt;WDYT?&lt;/p&gt;</comment>
                            <comment id="17347429" author="till.rohrmann" created="Wed, 19 May 2021 09:03:29 +0000"  >&lt;p&gt;Sounds good to me.&lt;/p&gt;</comment>
                            <comment id="17347783" author="roman_khachatryan" created="Wed, 19 May 2021 17:17:54 +0000"  >&lt;p&gt;I&apos;ve created a &lt;a href=&quot;https://github.com/apache/flink/pull/15960&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; to adjust&#160;CheckpointStoreITCase.&lt;/p&gt;

&lt;p&gt;However,&#160;JobMasterStopWithSavepointITCase failed for another reason - I&apos;ve opened&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-22717&quot; title=&quot;JobMasterStopWithSavepointITCase.testRestartCheckpointCoordinatorIfStopWithSavepointFails fails with Adaptive Scheduler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-22717&quot;&gt;&lt;del&gt;FLINK-22717&lt;/del&gt;&lt;/a&gt; to track it.&lt;br/&gt;
 &#160;&lt;/p&gt;</comment>
                            <comment id="17348536" author="roman_khachatryan" created="Thu, 20 May 2021 13:41:19 +0000"  >&lt;p&gt;Merged into master:&#160;b43ffda36917881f29b923e4d58a350423bb8840&lt;/p&gt;

&lt;p&gt;into 1.13: e4c626dc6eee910de31f0ed7aadd1ca25917703d&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13375535">FLINK-22502</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13379331">FLINK-22717</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13375091">FLINK-22483</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0r4ds:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>