<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:51:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-20540] JdbcCatalog throws connection exception when baseUrl doesn&apos;t end with slash</title>
                <link>https://issues.apache.org/jira/browse/FLINK-20540</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.connector.jdbc.catalog.JdbcCatalog
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JdbcCatalog(name, defaultDatabase, username, password, baseUrl)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The baseUrl must be endswith / when instantiate&#160;JdbcCatalog.&lt;/p&gt;

&lt;p&gt;But according to&#160;&lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.11/zh/dev/table/connectors/jdbc.html#usage-of-postgrescatalog&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Flink document&lt;/a&gt;&#160;and code comments, baseUrl should be support&#160;&#160;format&#160;&lt;tt&gt;&quot;jdbc:postgresql://&amp;lt;ip&amp;gt;:&amp;lt;port&amp;gt;&quot;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When i use baseUrl &quot;&lt;tt&gt;jdbc:postgresql://&amp;lt;ip&amp;gt;:&amp;lt;port&amp;gt;&lt;/tt&gt;&quot;, the error stack is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;org.apache.flink.runtime.webmonitor.handlers.JarRunHandler.lambda$handleRequest$1(JarRunHandler.java:103)
java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:836)
java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:811)
java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1609)
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
java.util.concurrent.FutureTask.run(FutureTask.java:266)
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)\\nCaused by: java.util.concurrent.CompletionException: org.apache.flink.util.FlinkRuntimeException: Could not execute application.
java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1606)\\n\\t... 7 more\\nCaused by: org.apache.flink.util.FlinkRuntimeException: Could not execute application.
org.apache.flink.client.deployment.application.DetachedApplicationRunner.tryExecuteJobs(DetachedApplicationRunner.java:81)
org.apache.flink.client.deployment.application.DetachedApplicationRunner.run(DetachedApplicationRunner.java:67)
org.apache.flink.runtime.webmonitor.handlers.JarRunHandler.lambda$handleRequest$0(JarRunHandler.java:100)
java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)\\n\\t... 7 more\\nCaused by: org.apache.flink.client.program.ProgramInvocationException: The main method caused an error: Failed connecting to jdbc:postgresql:&lt;span class=&quot;code-comment&quot;&gt;//flink-postgres.cdn-flink:5432flink via JDBC.
&lt;/span&gt;org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:302)
org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:198)
org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:149)
org.apache.flink.client.deployment.application.DetachedApplicationRunner.tryExecuteJobs(DetachedApplicationRunner.java:78)\\n\\t... 10 more\\nCaused by: org.apache.flink.table.api.ValidationException: Failed connecting to jdbc:postgresql:&lt;span class=&quot;code-comment&quot;&gt;//flink-postgres.cdn-flink:5432flink via JDBC.
&lt;/span&gt;org.apache.flink.connector.jdbc.catalog.AbstractJdbcCatalog.open(AbstractJdbcCatalog.java:100)
org.apache.flink.table.catalog.CatalogManager.registerCatalog(CatalogManager.java:191)
org.apache.flink.table.api.internal.TableEnvImpl.registerCatalog(TableEnvImpl.scala:267)
com.upai.jobs.TableBodySentFields.registerCatalog(TableBodySentFields.scala:25)
com.upai.jobs.FusionGifShow$.run(FusionGifShow.scala:28)
com.upai.jobs.FlinkTask$.delayedEndpoint$com$upai$jobs$FlinkTask$1(FlinkTask.scala:41)
com.upai.jobs.FlinkTask$delayedInit$body.apply(FlinkTask.scala:11)
scala.Function0$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;apply$mcV$sp(Function0.scala:34)
scala.runtime.AbstractFunction0.apply$mcV$sp(AbstractFunction0.scala:12)
scala.App$$anonfun$main$1.apply(App.scala:76)
scala.App$$anonfun$main$1.apply(App.scala:76)
scala.collection.immutable.List.foreach(List.scala:392)
scala.collection.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.TraversableForwarder$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(TraversableForwarder.scala:35)
scala.App$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;main(App.scala:76)
com.upai.jobs.FlinkTask$.main(FlinkTask.scala:11)
com.upai.jobs.FlinkTask.main(FlinkTask.scala)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:498)
org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:288)\\n\\t... 13 more\\nCaused by: java.sql.SQLException: No suitable driver found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; jdbc:postgresql:&lt;span class=&quot;code-comment&quot;&gt;//flink-postgres.cdn-flink:5432flink
&lt;/span&gt;java.sql.DriverManager.getConnection(DriverManager.java:689)
java.sql.DriverManager.getConnection(DriverManager.java:247)
org.apache.flink.connector.jdbc.catalog.AbstractJdbcCatalog.open(AbstractJdbcCatalog.java:97)\\n\\t... 33 more\\n\&lt;span class=&quot;code-quote&quot;&gt;&quot;]}&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#30456;&#20851;&#20195;&#30721;&#20197;&#21450;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13344958">FLINK-20540</key>
            <summary>JdbcCatalog throws connection exception when baseUrl doesn&apos;t end with slash</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kgzhang">zhangzhao</assignee>
                                    <reporter username="kgzhang">zhangzhao</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 9 Dec 2020 01:44:22 +0000</created>
                <updated>Fri, 28 May 2021 06:38:02 +0000</updated>
                            <resolved>Mon, 28 Dec 2020 07:08:17 +0000</resolved>
                                    <version>1.11.1</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.13.0</fixVersion>
                                    <component>Connectors / JDBC</component>
                    <component>Documentation</component>
                    <component>Table SQL / Ecosystem</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="17246236" author="kgzhang" created="Wed, 9 Dec 2020 01:48:29 +0000"  >&lt;p&gt;I think the bug should be fixed by:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.flink.connector.jdbc.catalog;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; AbstractJdbcCatalog(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; catalogName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; defaultDatabase, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; username, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; pwd, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; baseUrl) {
   &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(catalogName, defaultDatabase);

   checkArgument(!StringUtils.isNullOrWhitespaceOnly(username));
   checkArgument(!StringUtils.isNullOrWhitespaceOnly(pwd));
   checkArgument(!StringUtils.isNullOrWhitespaceOnly(baseUrl));

   JdbcCatalogUtils.validateJdbcUrl(baseUrl);

   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.username = username;
   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.pwd = pwd;
   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.baseUrl = baseUrl.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;) ? baseUrl : baseUrl + &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;;

   &lt;span class=&quot;code-comment&quot;&gt;// old code: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.defaultUrl = baseUrl + defaultDatabase;
&lt;/span&gt;   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.defaultUrl = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.baseUrl + defaultDatabase;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17246277" author="leonard xu" created="Wed, 9 Dec 2020 03:48:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgzhang&quot; class=&quot;user-hover&quot; rel=&quot;kgzhang&quot;&gt;kgzhang&lt;/a&gt;&#160;Thanks for your report.&lt;/p&gt;

&lt;p&gt;&#160;The default dabase name is necessary, so I think the document is wrong, the base url used in catalog should be&#160;&quot;jdbc:postgresql://&amp;lt;ip&amp;gt;:&amp;lt;port&amp;gt;/&quot;, and the &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogTestBase.java#L70&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;tests&lt;/a&gt;&#160;in project also use these parameters in this way.&lt;/p&gt;

&lt;p&gt;Do you want to help fix this issue?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17247042" author="kgzhang" created="Thu, 10 Dec 2020 06:31:03 +0000"  >&lt;p&gt;Ok, i will submit 2 pull requests to fix document and the tests this week.&lt;/p&gt;</comment>
                            <comment id="17247045" author="leonard xu" created="Thu, 10 Dec 2020 06:51:51 +0000"  >&lt;p&gt;Happy to hear you&apos;re willing to contribute, I think we can fix the doc and tests in one PR, please ping me if you need a reviewer.&#160;&lt;/p&gt;</comment>
                            <comment id="17248317" author="kgzhang" created="Sat, 12 Dec 2020 09:14:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt;, I have updated the PR. This is PR &lt;a href=&quot;https://github.com/apache/flink/pull/14362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;address&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17249514" author="kgzhang" created="Tue, 15 Dec 2020 06:38:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt;, Can Merge the PR?&#160; This is PR&#160;&lt;a href=&quot;https://github.com/apache/flink/pull/14362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;address.&#160;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17255432" author="jark" created="Mon, 28 Dec 2020 07:08:18 +0000"  >&lt;p&gt;Fixed in master: 8da64d7982de7287766de658f6d6f03037be94e6&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0lbyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>