<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19436] TPC-DS end-to-end test (Blink planner) failed during shutdown</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19436</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7009&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=2b7514ee-e706-5046-657b-3430666e7bd9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7009&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=2b7514ee-e706-5046-657b-3430666e7bd9&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-09-27T22:37:53.2236467Z Stopping taskexecutor daemon (pid: 2992) on host fv-az655.
2020-09-27T22:37:53.4450715Z Stopping standalonesession daemon (pid: 2699) on host fv-az655.
2020-09-27T22:37:53.8014537Z Skipping taskexecutor daemon (pid: 11173), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8019740Z Skipping taskexecutor daemon (pid: 11561), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8022857Z Skipping taskexecutor daemon (pid: 11849), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8023616Z Skipping taskexecutor daemon (pid: 12180), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8024327Z Skipping taskexecutor daemon (pid: 12950), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8025027Z Skipping taskexecutor daemon (pid: 13472), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8025727Z Skipping taskexecutor daemon (pid: 16577), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8026417Z Skipping taskexecutor daemon (pid: 16959), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8027086Z Skipping taskexecutor daemon (pid: 17250), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8027770Z Skipping taskexecutor daemon (pid: 17601), because it is not running anymore on fv-az655.
2020-09-27T22:37:53.8028400Z Stopping taskexecutor daemon (pid: 18438) on host fv-az655.
2020-09-27T22:37:53.8029314Z /home/vsts/work/1/s/flink-dist/target/flink-1.11-SNAPSHOT-bin/flink-1.11-SNAPSHOT/bin/taskmanager.sh: line 99: 18438 Terminated              &lt;span class=&quot;code-quote&quot;&gt;&quot;${FLINK_BIN_DIR}&quot;&lt;/span&gt;/flink-daemon.sh $STARTSTOP $ENTRYPOINT &lt;span class=&quot;code-quote&quot;&gt;&quot;${ARGS[@]}&quot;&lt;/span&gt;
2020-09-27T22:37:53.8029895Z [FAIL] Test script contains errors.
2020-09-27T22:37:53.8032092Z Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; errors...
2020-09-27T22:37:55.3713368Z No errors in log files.
2020-09-27T22:37:55.3713935Z Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; exceptions...
2020-09-27T22:37:56.9046391Z No exceptions in log files.
2020-09-27T22:37:56.9047333Z Checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; non-empty .out files...
2020-09-27T22:37:56.9064402Z No non-empty .out files.
2020-09-27T22:37:56.9064859Z 
2020-09-27T22:37:56.9065588Z [FAIL] &lt;span class=&quot;code-quote&quot;&gt;&apos;TPC-DS end-to-end test (Blink planner)&apos;&lt;/span&gt; failed after 16 minutes and 54 seconds! Test exited with exit code 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13329664">FLINK-19436</key>
            <summary>TPC-DS end-to-end test (Blink planner) failed during shutdown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leonard">Leonard Xu</assignee>
                                    <reporter username="dian.fu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 28 Sep 2020 00:59:43 +0000</created>
                <updated>Fri, 28 May 2021 07:13:44 +0000</updated>
                            <resolved>Mon, 25 Jan 2021 14:00:41 +0000</resolved>
                                    <version>1.11.0</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.11.4</fixVersion>
                    <fixVersion>1.12.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17216390" author="dian.fu" created="Mon, 19 Oct 2020 01:17:29 +0000"  >&lt;p&gt;Another instance on master:&#160;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7814&amp;amp;view=logs&amp;amp;j=739e6eac-8312-5d31-d437-294c4d26fced&amp;amp;t=a68b8d89-50e9-5977-4500-f4fde4f57f9b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7814&amp;amp;view=logs&amp;amp;j=739e6eac-8312-5d31-d437-294c4d26fced&amp;amp;t=a68b8d89-50e9-5977-4500-f4fde4f57f9b&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17217322" author="dian.fu" created="Tue, 20 Oct 2020 06:26:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7884&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7884&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17217346" author="rmetzger" created="Tue, 20 Oct 2020 06:53:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Leonard+Xu&quot; class=&quot;user-hover&quot; rel=&quot;Leonard Xu&quot;&gt;Leonard Xu&lt;/a&gt; can you take a look at this failure?&lt;/p&gt;</comment>
                            <comment id="17217368" author="leonard xu" created="Tue, 20 Oct 2020 07:08:26 +0000"  >&lt;p&gt;Sure, I&apos;ll have a look&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17220431" author="dian.fu" created="Mon, 26 Oct 2020 01:43:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=8232&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=2b7514ee-e706-5046-657b-3430666e7bd9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=8232&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=2b7514ee-e706-5046-657b-3430666e7bd9&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17228596" author="rmetzger" created="Mon, 9 Nov 2020 13:52:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=9345&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=9345&amp;amp;view=logs&amp;amp;j=c88eea3b-64a0-564d-0031-9fdcd7b8abee&amp;amp;t=ff888d9b-cd34-53cc-d90f-3e446d355529&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17228598" author="leonard xu" created="Mon, 9 Nov 2020 13:53:50 +0000"  >&lt;p&gt;I think the reason is the previous e2e tests didn&apos;t close flink cluster properly, which lead the e2e test call taskmanager.sh stop-all failed&#160;&lt;/p&gt;</comment>
                            <comment id="17228604" author="rmetzger" created="Mon, 9 Nov 2020 13:57:31 +0000"  >&lt;p&gt;Are you sure there was a previous TaskManager running?&lt;/p&gt;

&lt;p&gt;From the logs, you can see that no port was allocated by a JVM before the Blink planner test started:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Nov 09 12:53:55 Allocated ports
Nov 09 12:53:55 Active Internet connections (only servers)
Nov 09 12:53:55 Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
Nov 09 12:53:55 tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1637/sshd       
Nov 09 12:53:55 tcp        0      0 127.0.0.1:44381         0.0.0.0:*               LISTEN      1588/containerd 
Nov 09 12:53:55 tcp6       0      0 :::22                   :::*                    LISTEN      1637/sshd       
Nov 09 12:53:55 udp        0      0 0.0.0.0:68              0.0.0.0:*                           1142/dhclient   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17228947" author="leonard xu" created="Tue, 10 Nov 2020 03:24:20 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt; I&apos;m pretty sure that, all failed log showed there&apos;re more than one TMS, but the TPC-DS test only starts 1 TM.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014938/13014938_image-2020-11-10-11-08-53-199.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;And from my PR, you can see the only one TM is closing.&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014939/13014939_image-2020-11-10-11-09-20-534.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If e2e bash script doesn&apos;t `call clean_up()` the JM and TMs it started, the running JM and TMs will be closed in `test-runner-common.sh#shutdown_all()`,&#160; `test-runner-common.sh#shutdown_all()` using `kill -9 ` to stop the process without any check which may fail, I think this is why the test is unstable.&lt;/p&gt;</comment>
                            <comment id="17228960" author="leonard xu" created="Tue, 10 Nov 2020 04:10:26 +0000"  >&lt;p&gt;And in these failed tests, all failed TM pid(e.g. &lt;b&gt;4267&lt;/b&gt;) can be found in previous e2e log,&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;PASS&amp;#93;&lt;/span&gt; &apos;Netty shuffle direct memory consumption end-to-end test&apos; passed after 2 minutes and 23 seconds! Test exited with exit code 0.&lt;br/&gt;
2020-10-18T22:26:05.8214649Z Stopping taskexecutor daemon (pid: 5306) on host fv-az679.&lt;br/&gt;
2020-10-18T22:26:06.0204996Z Stopping standalonesession daemon (pid: 3673) on host fv-az679.&lt;br/&gt;
.... &lt;br/&gt;
2020-10-18T22:26:06.6608513Z Jps&lt;br/&gt;
2020-10-18T22:26:06.7766551Z &lt;b&gt;&lt;font color=&quot;#de350b&quot;&gt;4627&lt;/font&gt;&lt;/b&gt; TaskManagerRunner&lt;br/&gt;
2020-10-18T22:26:06.7911919Z 3962 TaskManagerRunner&lt;br/&gt;
2020-10-18T22:26:06.8175144Z 6875 Jps&lt;br/&gt;
2020-10-18T22:26:06.8219362Z Disk information&lt;br/&gt;
....&lt;br/&gt;
2020-10-18T22:58:21.1330389Z &lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Validation succeeded for file: 99.ans (103/103)&lt;br/&gt;
2020-10-18T22:58:21.4205488Z Stopping taskexecutor daemon (pid: 5407) on host fv-az679.&lt;br/&gt;
2020-10-18T22:58:21.6132761Z Stopping standalonesession daemon (pid: 5120) on host fv-az679.&lt;br/&gt;
....&lt;br/&gt;
2020-10-18T22:58:21.9654801Z Stopping taskexecutor daemon (pid: 4627) on host fv-az679.&lt;br/&gt;
2020-10-18T22:58:21.9670548Z /home/vsts/work/1/s/flink-end-to-end-tests/test-scripts/test-runner-common.sh: line 47: &lt;b&gt;&lt;font color=&quot;#de350b&quot;&gt;4627&lt;/font&gt;&lt;/b&gt; Terminated ${command}&lt;br/&gt;
2020-10-18T22:58:21.9671129Z &lt;span class=&quot;error&quot;&gt;&amp;#91;FAIL&amp;#93;&lt;/span&gt; Test script contains errors.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I tend&#160; to stop all TMs in common.shutdown_all before `kill -9` them, How do you think? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17229004" author="rmetzger" created="Tue, 10 Nov 2020 06:15:54 +0000"  >&lt;p&gt;I see. Thanks a lot for the detailed explanation. It seems that the TPC-DS tests are &quot;stopping&quot; all the leftover pids from previous tests.&lt;br/&gt;
I wonder why this error is occurring now. Maybe some other change has broken a cleanup mechanism.&lt;/p&gt;

&lt;p&gt;Thanks a lot for this good analysis. I&apos;ll take a look at the PR.&lt;/p&gt;</comment>
                            <comment id="17229223" author="rmetzger" created="Tue, 10 Nov 2020 13:44:53 +0000"  >&lt;p&gt;Resolved in &lt;a href=&quot;https://github.com/apache/flink/commit/9b12c1553de7a896d2d80600fab8366e70d6747e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/9b12c1553de7a896d2d80600fab8366e70d6747e&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17271105" author="dawidwys" created="Mon, 25 Jan 2021 07:34:37 +0000"  >&lt;p&gt;This reappeared on 1.11: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=12397&amp;amp;view=logs&amp;amp;j=91bf6583-3fb2-592f-e4d4-d79d79c3230a&amp;amp;t=03dbd840-5430-533d-d1a7-05d0ebe03873&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=12397&amp;amp;view=logs&amp;amp;j=91bf6583-3fb2-592f-e4d4-d79d79c3230a&amp;amp;t=03dbd840-5430-533d-d1a7-05d0ebe03873&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17271109" author="rmetzger" created="Mon, 25 Jan 2021 07:39:09 +0000"  >&lt;p&gt;I&apos;ll backport the fix to 1.11.&lt;/p&gt;</comment>
                            <comment id="17271111" author="leonard xu" created="Mon, 25 Jan 2021 07:43:41 +0000"  >&lt;p&gt;Thanks for the report &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;br/&gt;
IIRC, we didn&apos;t pick the PR to 1.11&#65292; let me open a PR for 1.11 branch.&#160;&lt;/p&gt;</comment>
                            <comment id="17271326" author="jark" created="Mon, 25 Jan 2021 14:00:41 +0000"  >&lt;p&gt;Fixed in release-1.11: cece43b93b94d5e424583d69717c7ab55f8d45b7&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13014938" name="image-2020-11-10-11-08-53-199.png" size="332174" author="leonard" created="Tue, 10 Nov 2020 03:08:55 +0000"/>
                            <attachment id="13014939" name="image-2020-11-10-11-09-20-534.png" size="193414" author="leonard" created="Tue, 10 Nov 2020 03:09:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0iymo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>