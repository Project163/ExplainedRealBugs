<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:10:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-26695] Fabric8FlinkKubeClient.deleteConfigMap and deleteConfigMapsByLabels don&apos;t necessarily fail if the deletion didn&apos;t succeed</title>
                <link>https://issues.apache.org/jira/browse/FLINK-26695</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;tt&gt;Fabric8FlinkKubeClient.deleteConfigMap&lt;/tt&gt; and &lt;tt&gt;deleteConfigMapsByLabels&lt;/tt&gt; do not evaluate the return value and, therefore, might miss an error during deletion.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13434269">FLINK-26695</key>
            <summary>Fabric8FlinkKubeClient.deleteConfigMap and deleteConfigMapsByLabels don&apos;t necessarily fail if the deletion didn&apos;t succeed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mapohl">Matthias Pohl</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 17 Mar 2022 05:48:43 +0000</created>
                <updated>Thu, 24 Mar 2022 08:44:10 +0000</updated>
                            <resolved>Thu, 24 Mar 2022 08:44:10 +0000</resolved>
                                    <version>1.16.0</version>
                                    <fixVersion>1.16.0</fixVersion>
                                    <component>Deployment / Kubernetes</component>
                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17508002" author="nicholasjiang" created="Thu, 17 Mar 2022 06:59:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt;, does the Fabric8FlinkKubeClient.deleteConfigMapsByLabels have the same problem?&lt;/p&gt;</comment>
                            <comment id="17508006" author="fly_in_gis" created="Thu, 17 Mar 2022 07:05:24 +0000"  >&lt;p&gt;If the ConfigMap deletion failed, I think the k8s client will throw an exception. So why could we miss an error?&lt;/p&gt;</comment>
                            <comment id="17508029" author="mapohl" created="Thu, 17 Mar 2022 07:55:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wangyang0918&quot; class=&quot;user-hover&quot; rel=&quot;wangyang0918&quot;&gt;wangyang0918&lt;/a&gt; you might be right. The fabric8 JavaDoc stays kind of vague on the return value, though. See &lt;a href=&quot;https://github.com/fabric8io/kubernetes-client/blob/master/kubernetes-client-api/src/main/java/io/fabric8/kubernetes/client/dsl/Deletable.java#L25&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Deletable.java:25&lt;/a&gt;. We might want to harden our implementation in that regard to be sure that the ConfigMap is actually non-existent anymore. WDYT?&lt;/p&gt;</comment>
                            <comment id="17508030" author="mapohl" created="Thu, 17 Mar 2022 07:58:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;Matthias Pohl, does the Fabric8FlinkKubeClient.deleteConfigMapsByLabels have the same problem?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, the same applies to the deleteConfigMapsByLabels. Thanks for the pointer. I&apos;m gonna update the issue description&lt;/p&gt;</comment>
                            <comment id="17508031" author="fly_in_gis" created="Thu, 17 Mar 2022 07:59:25 +0000"  >&lt;p&gt;Yes. We could harden the current implementation by checking the existence of deleted ConfigMaps. And maybe we also need to retry the deletion.&lt;/p&gt;</comment>
                            <comment id="17508035" author="mapohl" created="Thu, 17 Mar 2022 08:03:16 +0000"  >&lt;p&gt;The exception will be propagated to the calling methods, which would be the Job-related cleanup and the cluster cleanup in HaServices. The former one will be covered by the retry logic implemented in the Dispatcher. The latter one will cause a fatal error in the shutdown of the cluster which is still desired, I guess.&lt;/p&gt;</comment>
                            <comment id="17508042" author="nicholasjiang" created="Thu, 17 Mar 2022 08:10:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wangyang0918&quot; class=&quot;user-hover&quot; rel=&quot;wangyang0918&quot;&gt;wangyang0918&lt;/a&gt;, if the retries of the deletion ConfigMaps have still exception, what&apos;s the behavior for shutdown of the cluster?&lt;/p&gt;</comment>
                            <comment id="17508053" author="fly_in_gis" created="Thu, 17 Mar 2022 08:35:38 +0000"  >&lt;p&gt;Just like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt; said, we already have the retry logic in the Dispatcher for job related cleanup. As for the cluster cleanup, maybe FLIP-194&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; has also covered.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. &lt;a href=&quot;https://cwiki.apache.org/confluence/display/FLINK/FLIP-194%3A+Introduce+the+JobResultStore&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/FLINK/FLIP-194%3A+Introduce+the+JobResultStore&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17508061" author="mapohl" created="Thu, 17 Mar 2022 09:00:10 +0000"  >&lt;p&gt;No, FLIP-194 does not cover the retry during the cluster cleanup. But we want to fail in that case actually in the same way we do if the k8s cleanup failed due to an exception to make the user aware of it.&lt;/p&gt;</comment>
                            <comment id="17508079" author="fly_in_gis" created="Thu, 17 Mar 2022 09:24:35 +0000"  >&lt;p&gt;We will have a DIRTY file job result store if the cleanup failed. Users could re-submit the application to finish the cleanup. Right?&lt;/p&gt;</comment>
                            <comment id="17508159" author="mapohl" created="Thu, 17 Mar 2022 12:12:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;We will have a DIRTY file job result store if the cleanup failed. Users could re-submit the application to finish the cleanup. Right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correct. ...in case of the job-related cleanup&lt;/p&gt;</comment>
                            <comment id="17511697" author="mapohl" created="Thu, 24 Mar 2022 08:44:10 +0000"  >&lt;p&gt;master: e6dbeffc6f9797a7c14e3751a721698d421460e6&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10kbc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>