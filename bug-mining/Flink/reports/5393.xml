<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:56:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22406] Unstable test ReactiveModeITCase.testScaleDownOnTaskManagerLoss()</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22406</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The test is stalling on Azure CI.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/sewen0794/Flink/_build/results?buildId=292&amp;amp;view=logs&amp;amp;j=0a15d512-44ac-5ba5-97ab-13a5d066c22c&amp;amp;t=634cd701-c189-5dff-24cb-606ed884db87&amp;amp;l=4865&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/sewen0794/Flink/_build/results?buildId=292&amp;amp;view=logs&amp;amp;j=0a15d512-44ac-5ba5-97ab-13a5d066c22c&amp;amp;t=634cd701-c189-5dff-24cb-606ed884db87&amp;amp;l=4865&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13374328">FLINK-22406</key>
            <summary>Unstable test ReactiveModeITCase.testScaleDownOnTaskManagerLoss()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="sewen">Stephan Ewen</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Thu, 22 Apr 2021 08:22:52 +0000</created>
                <updated>Sat, 28 Aug 2021 11:18:00 +0000</updated>
                            <resolved>Fri, 7 May 2021 07:58:27 +0000</resolved>
                                    <version>1.13.0</version>
                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.1</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17327344" author="zentol" created="Thu, 22 Apr 2021 10:51:12 +0000"  >&lt;p&gt;There are a few odd things in the logs. It seems like the JM is prematurely moving tasks into a canceled state.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
23:47:20,274 INFO  o.a.f.r.executiongraph.ExecutionGraph       [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2) (0d91787b2ba65cd0f259be619b293b96) switched from CREATED to DEPLOYING.
23:47:20,274 INFO  o.a.f.r.executiongraph.ExecutionGraph       [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2) (0d91787b2ba65cd0f259be619b293b96) switched from DEPLOYING to CANCELING.
23:47:20,277 INFO  o.a.f.r.executiongraph.ExecutionGraph       [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2) (0d91787b2ba65cd0f259be619b293b96) switched from CANCELING to CANCELED.
23:47:20,282 INFO  o.a.f.r.taskexecutor.TaskExecutor           [] - Received task Source: Custom Source -&amp;gt; Sink: Unnamed (2/2)#0 (0d91787b2ba65cd0f259be619b293b96), deploy into slot with allocation id 
23:47:20,287 INFO  o.a.f.r.taskmanager.Task                    [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2)#0 (0d91787b2ba65cd0f259be619b293b96) switched from CREATED to DEPLOYING.48a192cd6be4f34599cac87ad5d8caba.
23:47:20,296 INFO  o.a.f.r.taskmanager.Task                    [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2)#0 (0d91787b2ba65cd0f259be619b293b96) switched from DEPLOYING to INITIALIZING.
23:47:20,327 WARN  o.a.f.r.taskmanager.Task                    [] - Source: Custom Source -&amp;gt; Sink: Unnamed (2/2)#0 (0d91787b2ba65cd0f259be619b293b96) switched from INITIALIZING to FAILED with failure cause: org.apache.flink.runtime.jobmaster.ExecutionGraphException: The execution attempt 0d91787b2ba65cd0f259be619b293b96 was not found. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This doesn&apos;t necessarily explain the issue, but with a stray task hanging around for longer than we expect it to there is now the possibility that, after the downscaling has concluded, the number of active instances is 3. If the test thread enters the waiting loop at this time it will never exit, because we don&apos;t notify the thread if instances are shutting down. This is entirely theoretical though, but it is the only explanation I can come up with that could cause the test to get stuck.&lt;/p&gt;</comment>
                            <comment id="17330479" author="zentol" created="Fri, 23 Apr 2021 13:51:46 +0000"  >&lt;p&gt;I managed to get the debug logs for a failed run, confirming my theory. The test starts out with 2 TMs, each with 2 slots. The test then in total runs 3 jobs; after the first 2 slots arrive with p=2, then with p=4 after the next 2 slots arrive, and one final with with p=2 again after we shutdown a TM.&lt;/p&gt;

&lt;p&gt;The problem is caused by the first job, coupled with how test counts active subtasks.&lt;/p&gt;

&lt;p&gt;The first job effectively is immediately canceled after having been deployed, which can cause the cancellation message to be processed before the task deployment, which fails because nothing is deployed (yet), and the JM marks the task is canceled and proceeds with a restart. The task deployment later arrives, and is processed as usual. This task sticks around until the task initialization is complete and the task transitions into a running state, with the corresponding state update being rejected by the JM.&lt;/p&gt;

&lt;p&gt;After an offline discussion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;, we concluded that we could fix this by not checking what is actually being deployed, but instead poll the JM for the current parallelism.&lt;/p&gt;</comment>
                            <comment id="17334439" author="maguowei" created="Wed, 28 Apr 2021 04:13:00 +0000"  >&lt;p&gt;another case&lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17316&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17316&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10889&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339436" author="roman_khachatryan" created="Wed, 5 May 2021 06:14:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17544&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17544&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339452" author="dawidwys" created="Wed, 5 May 2021 06:56:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17539&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5316&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17539&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5316&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339454" author="dawidwys" created="Wed, 5 May 2021 06:57:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17538&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17538&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10541&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339455" author="dawidwys" created="Wed, 5 May 2021 06:58:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17543&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5667&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17543&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5667&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339462" author="dawidwys" created="Wed, 5 May 2021 07:09:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17558&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17558&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5673&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339466" author="dawidwys" created="Wed, 5 May 2021 07:11:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17552&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5327&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17552&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&amp;amp;l=5327&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339467" author="dawidwys" created="Wed, 5 May 2021 07:11:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17552&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17552&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&amp;amp;l=10983&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17339543" author="till.rohrmann" created="Wed, 5 May 2021 09:12:47 +0000"  >&lt;p&gt;Another instance: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17540&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17540&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=5360d54c-8d94-5d85-304e-a89267eb785a&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17340608" author="rmetzger" created="Fri, 7 May 2021 06:39:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17625&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=17625&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=f508e270-48d6-5f1e-3138-42a17e0714f0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17340650" author="zentol" created="Fri, 7 May 2021 07:58:27 +0000"  >&lt;p&gt;master: 271ac1b8bac100b613c313e11773109db15015e5&lt;/p&gt;

&lt;p&gt;1.13: 5b7e87f7c4c39bbc13c459be97b7d7b4102d0f45&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13392257">FLINK-23524</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qbsw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>