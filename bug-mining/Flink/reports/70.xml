<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:17:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1170] Localization of InputSplits is not working properly</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1170</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;While running some benchmarks, I found that Flink is not properly assigning the InputSplits.&lt;/p&gt;

&lt;p&gt;On my testing cluster, ALL splits were assigned to remote HDFS DataNodes, which causes a lot of network I/O.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12748855">FLINK-1170</key>
            <summary>Localization of InputSplits is not working properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Oct 2014 09:25:00 +0000</created>
                <updated>Sat, 18 Oct 2014 15:14:39 +0000</updated>
                            <resolved>Sat, 18 Oct 2014 15:14:29 +0000</resolved>
                                                    <fixVersion>0.7.0-incubating</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14175061" author="githubbot" created="Fri, 17 Oct 2014 13:52:53 +0000"  >&lt;p&gt;GitHub user rmetzger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1170&quot; title=&quot;Localization of InputSplits is not working properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1170&quot;&gt;&lt;del&gt;FLINK-1170&lt;/del&gt;&lt;/a&gt; Fix faulty input split localization&lt;/p&gt;

&lt;p&gt;    Pass hostname to split assigner&lt;br/&gt;
    Avoid clashes by only using the first component of the fully qualified hostname&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rmetzger/incubator-flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rmetzger/incubator-flink&lt;/a&gt; localizableInputSplitAssignment&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #158&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 8896b091c2c707f4df331f7f40a89375e2f6f02d&lt;br/&gt;
Author: Robert Metzger &amp;lt;rmetzger@apache.org&amp;gt;&lt;br/&gt;
Date:   2014-10-17T08:58:15Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-1170&quot; title=&quot;Localization of InputSplits is not working properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-1170&quot;&gt;&lt;del&gt;FLINK-1170&lt;/del&gt;&lt;/a&gt; Fix faulty input split localization&lt;br/&gt;
    Pass hostname to split assigner&lt;br/&gt;
    Avoid clashes by only using the first component of the fully qualified hostname&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14175272" author="hsaputra" created="Fri, 17 Oct 2014 17:25:43 +0000"  >&lt;p&gt;HI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;, could you share details on how to reproduce this issue?&lt;/p&gt;</comment>
                            <comment id="14175285" author="rmetzger" created="Fri, 17 Oct 2014 17:38:27 +0000"  >&lt;p&gt;I found the issue while running a very simple &quot;distributed grep&quot; job that is just reading a lot of data, filtering it for a certain string.&lt;br/&gt;
I had 1 TB of input data on a 24 nodes cluster. &lt;br/&gt;
The runtime was very bad with the issue (~1 hour), after the fix, I&apos;ve got it down to less than 4 minutes.&lt;br/&gt;
Flink and HDFS seem to use different hostname-representations. While hdfs was just using &quot;worker1&quot;, Flink was using the full hostname (&quot;worker1.hdcluster.company.com&quot;). This caused the input splits to be assigned randomly, not local to the actual data.&lt;/p&gt;

&lt;p&gt;After the fix, the data has been read locally most of the time (without costy network IO).&lt;/p&gt;</comment>
                            <comment id="14175296" author="githubbot" created="Fri, 17 Oct 2014 17:48:54 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158#discussion_r19032254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158#discussion_r19032254&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/api/common/io/LocatableInputSplitAssigner.java &amp;#8212;&lt;br/&gt;
    @@ -173,13 +175,13 @@ public LocatableInputSplit getNextInputSplit(String host) {&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final boolean isLocal(String host, String[] hosts) {&lt;/li&gt;
	&lt;li&gt;if (host == null || hosts == null) {&lt;br/&gt;
    +	private static final boolean isLocal(String flinkHost, String[] hosts) {&lt;br/&gt;
    +		if (flinkHost == null || hosts == null) 
{
     			return false;
     		}&lt;/li&gt;
	&lt;li&gt;&lt;br/&gt;
     		for (String h : hosts) {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I would add some null checks here. Input Splits are user generated an can contained arbitrary nonsense in general&lt;/p&gt;</comment>
                            <comment id="14175297" author="githubbot" created="Fri, 17 Oct 2014 17:49:11 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158#discussion_r19032266&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158#discussion_r19032266&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/util/NetUtils.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,36 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +package org.apache.flink.util;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +public class NetUtils {&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Turn a fully qualified domain name (fqdn) into a hostname.&lt;br/&gt;
    +	 * &lt;br/&gt;
    +	 * @param fqdn&lt;br/&gt;
    +	 * @return&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static String getHostnameFromFQDN(String fqdn) {&lt;br/&gt;
    +		int dotPos = fqdn.indexOf(&apos;.&apos;);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Would add a null check here.&lt;/p&gt;</comment>
                            <comment id="14175300" author="githubbot" created="Fri, 17 Oct 2014 17:50:24 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158#discussion_r19032342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158#discussion_r19032342&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/instance/InstanceConnectionInfo.java &amp;#8212;&lt;br/&gt;
    @@ -154,7 +176,7 @@ public void read(DataInputView in) throws IOException {&lt;br/&gt;
     		this.ipcPort = in.readInt();&lt;br/&gt;
     		this.dataPort = in.readInt();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.hostName = StringUtils.readNullableString(in);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Would either serialize/deserialize the hostname as well, or at least set it to null.&lt;/p&gt;</comment>
                            <comment id="14175316" author="githubbot" created="Fri, 17 Oct 2014 17:59:14 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158#discussion_r19032889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158#discussion_r19032889&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/instance/InstanceConnectionInfo.java &amp;#8212;&lt;br/&gt;
    @@ -25,7 +25,10 @@&lt;br/&gt;
     import org.apache.flink.core.io.IOReadableWritable;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Eager computation of the FQDN (in the constructor) on the taskmanager would be a good idea. Otherwise, in corner cases, reverse name lookup falls to the jobmanager (which might get overloaded doing too many reverse lookups).&lt;/p&gt;</comment>
                            <comment id="14175324" author="githubbot" created="Fri, 17 Oct 2014 18:06:10 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158#issuecomment-59552098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158#issuecomment-59552098&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Other than the comments, I think this is good.&lt;/p&gt;</comment>
                            <comment id="14176036" author="rmetzger" created="Sat, 18 Oct 2014 15:14:29 +0000"  >&lt;p&gt;Resolved in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/incubator-flink/commit/23e30f09&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/incubator-flink/commit/23e30f09&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14176037" author="githubbot" created="Sat, 18 Oct 2014 15:14:39 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-flink/pull/158&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-flink/pull/158&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21agn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>