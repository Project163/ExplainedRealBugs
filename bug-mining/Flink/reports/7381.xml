<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:19:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-34271] Fix the potential failure test about GroupAggregateRestoreTest#AGG_WITH_STATE_TTL_HINT</title>
                <link>https://issues.apache.org/jira/browse/FLINK-34271</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The underlying reason is that a previous PR introduced a test with state TTL as follows in the SQL:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.runSql(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO sink_t SELECT &lt;span class=&quot;code-comment&quot;&gt;/*+ STATE_TTL(&lt;span class=&quot;code-quote&quot;&gt;&apos;source_t&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;4d&apos;&lt;/span&gt;) */&lt;/span&gt;&quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;b, &quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;COUNT(*) AS cnt, &quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;AVG(a) FILTER (WHERE a &amp;gt; 1) AS avg_a, &quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;MIN(c) AS min_c &quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;FROM source_t GROUP BY b&quot;&lt;/span&gt;)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When the savepoint metadata was generated for the first time, the metadata recorded the time when a certain key was accessed. If the test is rerun after the TTL has expired, the state of this key in the metadata will be cleared, resulting in an incorrect test outcome.&lt;/p&gt;

&lt;p&gt;To rectify this issue, I think the current tests in RestoreTestBase could be modified to regenerate a new savepoint metadata as needed every time. However, this seems to deviate from the original design purpose of RestoreTestBase.&lt;/p&gt;

&lt;p&gt;For my test, I will work around this by removing the data &quot;consumedBeforeRestore&quot;, as I am only interested in testing the generation of an expected JSON plan.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13566625">FLINK-34271</key>
            <summary>Fix the potential failure test about GroupAggregateRestoreTest#AGG_WITH_STATE_TTL_HINT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xuyangzhong">Xuyang Zhong</assignee>
                                    <reporter username="xuyangzhong">Xuyang Zhong</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 30 Jan 2024 05:58:03 +0000</created>
                <updated>Wed, 31 Jan 2024 13:33:12 +0000</updated>
                            <resolved>Wed, 31 Jan 2024 13:33:12 +0000</resolved>
                                                    <fixVersion>1.19.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17812197" author="xuyangzhong" created="Tue, 30 Jan 2024 08:43:35 +0000"  >&lt;p&gt;BTW, I&apos;ve noticed that the old tests for json plan changes (diff the json plan on a PR) are about to be completely removed due to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-33421&quot; title=&quot;Implement ExecNode Restore Tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-33421&quot;&gt;FLINK-33421&lt;/a&gt;, but it seems that testing to check if the json plan has been affected by modifications from a PR is still necessary. This is because the new RestoreTestBase testing framework does not assess the risk of json plan modifications.&lt;/p&gt;

&lt;p&gt;In the meantime, if some of the tests in RestoreTestBase fail due to explicit json plan incompatibility changes, is it possible to directly modify the failing tests in RestoreTestBase (by regenerating json plans and recreating savepoint metadata)?&lt;/p&gt;</comment>
                            <comment id="17812204" author="xuyangzhong" created="Tue, 30 Jan 2024 08:44:49 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qingyue&quot; class=&quot;user-hover&quot; rel=&quot;qingyue&quot;&gt;qingyue&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bvarghese&quot; class=&quot;user-hover&quot; rel=&quot;bvarghese&quot;&gt;bvarghese&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17812442" author="JIRAUSER300319" created="Tue, 30 Jan 2024 18:34:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuyangzhong&quot; class=&quot;user-hover&quot; rel=&quot;xuyangzhong&quot;&gt;xuyangzhong&lt;/a&gt; I think we may need to manually update the plan and savepoint in such cases.&lt;/p&gt;</comment>
                            <comment id="17812550" author="xuyangzhong" created="Wed, 31 Jan 2024 05:33:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bvarghese&quot; class=&quot;user-hover&quot; rel=&quot;bvarghese&quot;&gt;bvarghese&lt;/a&gt; Okay. But we don&#8217;t have tests to cover potential changes about json plan , right?&lt;/p&gt;</comment>
                            <comment id="17812608" author="dawidwys" created="Wed, 31 Jan 2024 09:58:58 +0000"  >&lt;p&gt;&amp;gt; But we don&#8217;t have tests to cover potential changes about json plan , right?&lt;/p&gt;

&lt;p&gt;I&apos;ll need to double check if we need that check. After all we don&apos;t necessarily need to maintain exactly the same plan, but we want to make sure the job can be restored.&lt;/p&gt;

&lt;p&gt;&amp;gt; I think the current tests in RestoreTestBase could be modified to regenerate a new savepoint metadata as needed every time&lt;/p&gt;

&lt;p&gt;That&apos;s not an option. We must test with a savepoint from an older version. That&apos;s the entire idea of backwards compatibility.&lt;/p&gt;</comment>
                            <comment id="17812664" author="xuyangzhong" created="Wed, 31 Jan 2024 10:58:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwysakowicz&quot; class=&quot;user-hover&quot; rel=&quot;dwysakowicz&quot;&gt;dwysakowicz&lt;/a&gt; I understand and agree with you. That&apos;s why I just work around my test.&lt;/p&gt;</comment>
                            <comment id="17812703" author="qingyue" created="Wed, 31 Jan 2024 13:32:59 +0000"  >&lt;p&gt;Fixed in master cb9e220c2291088459f0281aa8e8e8584436a9b2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13564273">FLINK-34053</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1n2yg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>