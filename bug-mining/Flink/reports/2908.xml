<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:38:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10342] Kafka duplicate topic consumption when topic name is changed</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10342</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In case of topic name is simply renamed&#160;for a KafkaConsumer Flink starts to consume from old and a new topic in the same time which can lead to unexpected behavior.&lt;/p&gt;

&lt;p&gt;Here is the&#160;PR&#160;with reproduce: &lt;a href=&quot;https://github.com/apache/flink/pull/6691&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6691&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13184927">FLINK-10342</key>
            <summary>Kafka duplicate topic consumption when topic name is changed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="f.li">Feng LI</assignee>
                                    <reporter username="Oleksandr Nitavskyi">Oleksandr Nitavskyi</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 13 Sep 2018 14:50:46 +0000</created>
                <updated>Thu, 28 Feb 2019 11:20:31 +0000</updated>
                            <resolved>Thu, 28 Feb 2019 11:20:31 +0000</resolved>
                                                    <fixVersion>1.8.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="16614978" author="aljoscha" created="Fri, 14 Sep 2018 15:22:36 +0000"  >&lt;p&gt;I think this is working as intended. The discoverer is responsible for discovering new topics according to the topic pattern. It&apos;s not used to filter out topics that the consumer is already consuming. When restoring, the already discovered topics are in state and the consumer is expected to read from them.&lt;/p&gt;

&lt;p&gt;If you want to change the topic name and have the consumer only consume from the new topic you can change the uid of the Kafka Source using &lt;tt&gt;uid(String)&lt;/tt&gt; on the source. That way it will be considered as a new source that will not restore the state of the previous consumer.&lt;/p&gt;

&lt;p&gt;Please reopen this issue if you disagree.&lt;/p&gt;</comment>
                            <comment id="16617172" author="oleksandr nitavskyi" created="Mon, 17 Sep 2018 07:33:30 +0000"  >&lt;p&gt;Thanks for the comment. I agree that it works as expected from the Flink developer point of view, loading old TopicPartitions consumptions from the state and discovering newly requested TopicPartitions. In case there are not intersections we consume from both sets of TopicPartitions, since state in KafkaSource operator can never expire.&lt;/p&gt;

&lt;p&gt;In the same time, this behavior is counterintuitive for the Flink users. When KafkaSource is created consuming &quot;topic 1&quot; it expected that &quot;topic 1&quot; will be consumed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KafkaSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;topic 1&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If after the refactoring KafkaSource is starting to consume another &quot;topic 2&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KafkaSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;topic 2&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And for us it sounds intuitive that data will come from the &quot;topic 2&quot; and only from the &quot;topic 2&quot; and current behavior has the hole in the abstraction.&lt;/p&gt;

&lt;p&gt;I believe that it worth to make some action points at least on of:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Make a small check in the state restoring method where we skip topics which are not passed via class constructor.&lt;/li&gt;
	&lt;li&gt;Log some warning if topics in the state and in the constructors are different&lt;/li&gt;
	&lt;li&gt;Document such behavior, also can be a good exercise which clarifies how does state managed and help to start thinking in a little bit different paradigm&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you think it worth to make some action point let me know and I will contribute.&lt;br/&gt;
Thank you&lt;/p&gt;</comment>
                            <comment id="16776823" author="dawidwys" created="Mon, 25 Feb 2019 12:33:11 +0000"  >&lt;p&gt;I think in respect to the consensus in this thread: &lt;a href=&quot;https://lists.apache.org/thread.html/7e2a2b6fb40c4d1cd83b1e4bd63ad8ebbbc26e2d5c74b1d6fd44cdee@%3Cdev.flink.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/7e2a2b6fb40c4d1cd83b1e4bd63ad8ebbbc26e2d5c74b1d6fd44cdee@%3Cdev.flink.apache.org%3E&lt;/a&gt; we should reopen this issue.&lt;/p&gt;</comment>
                            <comment id="16780402" author="tzulitai" created="Thu, 28 Feb 2019 11:20:31 +0000"  >&lt;p&gt;Thanks for the contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=f.li&quot; class=&quot;user-hover&quot; rel=&quot;f.li&quot;&gt;f.li&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Merged:&lt;/p&gt;

&lt;p&gt;1.8.0 - 572a57c62e6d78b371605e3731e48a1dd18d38d4&lt;br/&gt;
1.9.0 - 6a4f0124512a424510f1dcdbe7855c92617e78c6&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13196756">FLINK-10807</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3y293:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Starting from 1.8.0, the {{FlinkKafkaConsumer}} now always filter out restored partitions that are no longer associated with a specified topic to subscribe to in the restored execution. This behaviour did not exist in previous versions of the {{FlinkKafkaConsumer}}. If you wish to retain the previous behaviour, please use the {{disableFilterRestoredPartitionsWithSubscribedTopics}} configuration method on the {{FlinkKafkaConsumer}}.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>