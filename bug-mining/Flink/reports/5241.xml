<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:55:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-22081] Entropy key not resolved if flink-s3-fs-hadoop is added as a plugin</title>
                <link>https://issues.apache.org/jira/browse/FLINK-22081</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Using flink 1.11.2&lt;/p&gt;

&lt;p&gt;I added the&#160;flink-s3-fs-hadoop jar in plugins dir but I am seeing the checkpoints paths like &lt;tt&gt;s3://my_app/_&lt;em&gt;ENTROPY&lt;/em&gt;_/app_name-staging/flink/checkpoints/e10f47968ae74934bd833108d2272419/chk-3071&lt;/tt&gt; which means the entropy injection key is not being resolved. After some debugging I found that in the &lt;a href=&quot;https://github.com/apache/flink/blob/release-1.10.0/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java#L97&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;EntropyInjector&lt;/a&gt; we check if the given fileSystem is of type &lt;tt&gt;ClassLoaderFixingFileSystem&lt;/tt&gt; and if so we check if the filesysystem is of type &lt;tt&gt;SafetyNetWrapperFileSystem as well as it&apos;s delegate&#160;}}but don&apos;t check for {{&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.10.0/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java#L65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ClassLoaderFixingFileSystem&lt;/a&gt;&lt;/tt&gt;&#160;directly in getEntorpyFs method which would be the type if S3 file system dependencies are added as a plugin.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Repro steps:&#160;&lt;/p&gt;

&lt;p&gt;Flink 1.11.2 with flink-s3-fs-hadoop as plugin and turn on entropy injection key &lt;em&gt;entropy&lt;/em&gt;&lt;br/&gt;
observe checkpoint dir with entropy marker not removed.&lt;br/&gt;
s3a://xxx/dev/checkpoints/&lt;em&gt;entropy&lt;/em&gt;/xenon/event-stream-splitter/jobid/chk-5/ &#160;&lt;br/&gt;
compare to removed when running Flink 1.9.1&lt;br/&gt;
s3a://xxx/dev/checkpoints/xenon/event-stream-splitter/jobid/chk-5/ &#160;&lt;/p&gt;

&lt;p&gt;Add some logging to&#160;getEntropyFs, observe it return null because passed in parameter is not &lt;tt&gt;SafetyNetWrapperFileSystem&lt;/tt&gt; but&#160;&lt;tt&gt;ClassLoaderFixingFileSystem&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Apply patch, build release and run same job, resolved issue as attachment shows&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13369013">FLINK-22081</key>
            <summary>Entropy key not resolved if flink-s3-fs-hadoop is added as a plugin</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="foxss">Chen Qin</assignee>
                                    <reporter username="foxss">Chen Qin</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 1 Apr 2021 04:48:59 +0000</created>
                <updated>Tue, 22 Jun 2021 13:55:42 +0000</updated>
                            <resolved>Thu, 8 Apr 2021 07:33:12 +0000</resolved>
                                    <version>1.10.3</version>
                    <version>1.11.3</version>
                    <version>1.12.2</version>
                    <version>1.13.0</version>
                                    <fixVersion>1.11.4</fixVersion>
                    <fixVersion>1.13.0</fixVersion>
                    <fixVersion>1.12.3</fixVersion>
                                    <component>FileSystems</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17312867" author="foxss" created="Thu, 1 Apr 2021 05:25:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=AHeise&quot; class=&quot;user-hover&quot; rel=&quot;AHeise&quot;&gt;AHeise&lt;/a&gt;&#160;could you assign this Jira to me and help review pr?&lt;/p&gt;</comment>
                            <comment id="17316922" author="arvid" created="Thu, 8 Apr 2021 07:29:02 +0000"  >&lt;p&gt;Merged into master as 2d3559e66db, into 1.12 as a9b34a3db23, and into 1.11 as 3bd44e083c8.&lt;/p&gt;</comment>
                            <comment id="17316924" author="arvid" created="Thu, 8 Apr 2021 07:33:05 +0000"  >&lt;p&gt;Merging into 1.10 is quite an effort and the version is officially not maintained anymore. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="13300662">FLINK-17359</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13023282" name="image (13).png" size="199150" author="foxss" created="Thu, 1 Apr 2021 05:20:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0pfow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>