<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:30:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7643] Configure FileSystems only once</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7643</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;HadoopFileSystem always reloads GlobalConfiguration, which potentially leads to a lot of noise in the logs, because this happens on each checkpoint.&lt;/p&gt;

&lt;p&gt;Instead, file systems should be configured once upon process startup, when the configuration is loaded.&lt;/p&gt;

&lt;p&gt;This will also increase efficiency of checkpoints, as it avoids redundant parsing for each data chunk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13103245">FLINK-7643</key>
            <summary>Configure FileSystems only once</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="uce">Ufuk Celebi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Sep 2017 13:59:26 +0000</created>
                <updated>Wed, 8 Nov 2017 13:18:30 +0000</updated>
                            <resolved>Wed, 8 Nov 2017 13:15:01 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16172361" author="phoenixjiangnan" created="Tue, 19 Sep 2017 21:28:53 +0000"  >&lt;p&gt;Looks like it&apos;s related to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7365&quot; title=&quot;excessive warning logs of attempt to override final parameter: fs.s3.buffer.dir&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7365&quot;&gt;&lt;del&gt;FLINK-7365&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16191887" author="githubbot" created="Wed, 4 Oct 2017 19:28:33 +0000"  >&lt;p&gt;GitHub user StephanEwen opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7643&quot; title=&quot;Configure FileSystems only once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7643&quot;&gt;&lt;del&gt;FLINK-7643&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Rework FileSystem loading to use factories&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change reworks the loading and instantiation of File System objects (including file systems supported via Hadoop) to use factories. &lt;/p&gt;

&lt;p&gt;    This makes sure that configurations (Flink and possibly Hadoop) are loaded once (on TaskManager / JobManager startup) and file system instances are properly reused by scheme and authority. That way, this change &lt;/p&gt;

&lt;p&gt;    This change is also a prerequisite for an extensible file system loading mechanism via a service framework.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The special-case configuration of the `FileSystem` class to set the &quot;default file system scheme&quot; is extended to a generic configuration call.&lt;/li&gt;
	&lt;li&gt;The directory of directly supported file systems is changed from classes (instantiated via reflection) to factories.&lt;/li&gt;
	&lt;li&gt;These factories are also configured when the `FileSystem` is configured.&lt;/li&gt;
	&lt;li&gt;The Hadoop file system factory loads the Hadoop configuration once when being configured and applies it to all subsequently instantiated file systems.&lt;/li&gt;
	&lt;li&gt;File systems supported via Hadoop are now properly cached and not reloaded, reinstantiated, and reconfigured on each access.&lt;/li&gt;
	&lt;li&gt;This also throws out a lot of legacy code for how to find Hadoop file system implementations&lt;/li&gt;
	&lt;li&gt;The `FileSystem` class is much cleaner now because a lot of the Hadoop FS&lt;/li&gt;
	&lt;li&gt;All file systems now eagerly initialize their settings, rather than dividing that between the constructor and the `initialize()` method.&lt;/li&gt;
	&lt;li&gt;This also factors out a lot of the special treatment of Hadoop file systems and simply makes the Hadoop File System factory the default fallback factory.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Reworked some tests to cover the behavior of this change:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;`flink-core/src/test/java/org/apache/flink/configuration/FilesystemSchemeConfigTest.java`&lt;/li&gt;
	&lt;li&gt;`flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskManagerConfigurationTest.java`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (*&lt;b&gt;yes&lt;/b&gt;* / no)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &lt;b&gt;Note:&lt;/b&gt; The breaking changes made on `@Public` class `FileSystem` do not include methods that are meant for users, but only the setup configuration.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (*&lt;b&gt;not applicable&lt;/b&gt;* / docs / JavaDocs / not documented)&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/StephanEwen/incubator-flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/StephanEwen/incubator-flink&lt;/a&gt; fs_fix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4776&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit ba312e137c7af1d2c331c5231b5b0ae3e0401549&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-10-02T12:34:27Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7643&quot; title=&quot;Configure FileSystems only once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7643&quot;&gt;&lt;del&gt;FLINK-7643&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Misc. cleanups in FileSystem&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Simplify access to local file system&lt;/li&gt;
	&lt;li&gt;Use a fair lock for all FileSystem.get() operations&lt;/li&gt;
	&lt;li&gt;Robust falback to local fs for default scheme (avoids URI parsing error on Windows)&lt;/li&gt;
	&lt;li&gt;Deprecate &apos;getDefaultBlockSize()&apos;&lt;/li&gt;
	&lt;li&gt;Deprecate create(...) with block sizes and replication factor, which is not applicable to many FS&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;commit 8130d874b8b823f22964f435bf1a1d1bd39774d6&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-10-02T14:25:18Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7643&quot; title=&quot;Configure FileSystems only once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7643&quot;&gt;&lt;del&gt;FLINK-7643&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Rework FileSystem loading to use factories&lt;/p&gt;

&lt;p&gt;    This makes sure that configurations are loaded once and file system instances are&lt;br/&gt;
    properly reused by scheme and authority.&lt;/p&gt;

&lt;p&gt;    This also factors out a lot of the special treatment of Hadoop file systems and simply&lt;br/&gt;
    makes the Hadoop File System factory the default fallback factory.&lt;/p&gt;

&lt;p&gt;commit c652f1322044f9715a0d94fa21ec853769be9a78&lt;br/&gt;
Author: Stephan Ewen &amp;lt;sewen@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-10-02T14:30:07Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7643&quot; title=&quot;Configure FileSystems only once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7643&quot;&gt;&lt;del&gt;FLINK-7643&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;core&amp;#93;&lt;/span&gt; Drop eager checks for file system support.&lt;/p&gt;

&lt;p&gt;    Some places validate if the file URIs are resolvable on the client. This leads to&lt;br/&gt;
    problems when file systems are not accessible from the client, when the full libraries for&lt;br/&gt;
    the file systems are not present on the client (for example often the case in cloud setups),&lt;br/&gt;
    or when the configuration on the client is different from the nodes/containers that will&lt;br/&gt;
    execute the application.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16192018" author="githubbot" created="Wed, 4 Oct 2017 20:56:37 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142788553&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142788553&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_CONFIG_CLASS = &quot;org.apache.hadoop.conf.Configuration&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_FS_CLASS = &quot;org.apache.hadoop.fs.FileSystem&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	public static FileSystemFactory loadFactory() {&lt;br/&gt;
    +		final ClassLoader cl = HadoopFileSystemFactoryLoader.class.getClassLoader();&lt;br/&gt;
    +&lt;br/&gt;
    +		// first, see if the Flink runtime classes are available&lt;br/&gt;
    +		final Class&amp;lt;? extends FileSystemFactory&amp;gt; factoryClass;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			factoryClass = Class.forName(FACTORY_CLASS, false, cl).asSubclass(FileSystemFactory.class);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) {&lt;br/&gt;
    +			return new UnsupportedSchemeFactory(&quot;Flink runtime classes missing in classpath/dependencies.&quot;);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    why return an unsupported factory which will fail later, rather than fail early here in class loader?&lt;/p&gt;</comment>
                            <comment id="16192019" author="githubbot" created="Wed, 4 Oct 2017 20:56:37 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142787414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142787414&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    A?&lt;/p&gt;</comment>
                            <comment id="16192020" author="githubbot" created="Wed, 4 Oct 2017 20:56:37 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142788766&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142788766&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/MapRFsFactory.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,75 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.lang.reflect.Constructor;&lt;br/&gt;
    +import java.lang.reflect.InvocationTargetException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A factory for the MapR file system.&lt;br/&gt;
    + * &lt;br/&gt;
    + * &amp;lt;p&amp;gt;This factory tries to reflectively instantiate the MapR file system. It can only be&lt;br/&gt;
    + * used when the MapR FS libraries are in the classpath.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class MapRFsFactory implements FileSystemFactory {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String MAPR_FILESYSTEM_CLASS = &quot;org.apache.flink.runtime.fs.maprfs.MapRFileSystem&quot;;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    ditto&lt;/p&gt;</comment>
                            <comment id="16192021" author="githubbot" created="Wed, 4 Oct 2017 20:56:37 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142789177&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142789177&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/UnsupportedSchemeFactory.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,65 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +import org.apache.flink.core.fs.UnsupportedFileSystemSchemeException;&lt;br/&gt;
    +&lt;br/&gt;
    +import javax.annotation.Nullable;&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.util.Preconditions.checkNotNull;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A file system factory to throw an UnsupportedFileSystemSchemeException when called.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class UnsupportedSchemeFactory implements FileSystemFactory {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I feel this is unnecessary. We can fail Flink faster and earlier, instead of having a wait until `create()` is called&lt;/p&gt;</comment>
                            <comment id="16192022" author="githubbot" created="Wed, 4 Oct 2017 20:56:37 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142787795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142787795&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    why not using `HadoopFsFactory.class.getCanonicalName()`?&lt;/p&gt;

</comment>
                            <comment id="16192617" author="githubbot" created="Thu, 5 Oct 2017 08:45:05 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142880460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142880460&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/FileSystem.java &amp;#8212;&lt;br/&gt;
    @@ -328,116 +360,54 @@ public static FileSystem getUnguardedFileSystem(URI uri) throws IOException {&lt;br/&gt;
     			final FSKey key = new FSKey(uri.getScheme(), uri.getAuthority());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Stephan: Add port here as well if possible, to support multiple separate HDFS installations.&lt;/p&gt;</comment>
                            <comment id="16192618" author="githubbot" created="Thu, 5 Oct 2017 08:45:39 +0000"  >&lt;p&gt;Github user aljoscha commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142880553&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142880553&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/FileSystemFactory.java &amp;#8212;&lt;br/&gt;
    @@ -15,18 +15,19 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;See the License for the specific language governing permissions and&lt;/li&gt;
	&lt;li&gt;limitations under the License.&lt;br/&gt;
      */&lt;br/&gt;
    +&lt;br/&gt;
     package org.apache.flink.core.fs;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     import org.apache.flink.annotation.PublicEvolving;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.io.IOException;&lt;br/&gt;
    +import java.net.URI;&lt;/p&gt;

&lt;p&gt;     @PublicEvolving&lt;br/&gt;
    -public interface HadoopFileSystemWrapper {&lt;br/&gt;
    +public interface FileSystemFactory {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Missing comments&lt;/p&gt;</comment>
                            <comment id="16192623" author="githubbot" created="Thu, 5 Oct 2017 08:50:38 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142881593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142881593&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    yes, the comment needs extension...&lt;/p&gt;</comment>
                            <comment id="16192630" author="githubbot" created="Thu, 5 Oct 2017 08:55:55 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bowenli86 We need to fail lazily, because Flink should be able to always work without MapR FS or HDFS being in the classpath.&lt;/p&gt;

&lt;p&gt;    With the change currently, you can start Flink without any Hadoop dependencies and it works fine. It only fails then if you try to use HDFS. Failing everything eager means it always fails when MapR or Hadoop classes are not in the classpath.&lt;/p&gt;

&lt;p&gt;    BTW: That behavior is the same as right now - I did not change it, just &lt;/p&gt;</comment>
                            <comment id="16193138" author="githubbot" created="Thu, 5 Oct 2017 16:30:18 +0000"  >&lt;p&gt;Github user bowenli86 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    ok, sounds good. That also explains some questions I commented, so I removed them.&lt;/p&gt;</comment>
                            <comment id="16193174" author="githubbot" created="Thu, 5 Oct 2017 16:47:36 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142989725&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142989725&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_CONFIG_CLASS = &quot;org.apache.hadoop.conf.Configuration&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_FS_CLASS = &quot;org.apache.hadoop.fs.FileSystem&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	public static FileSystemFactory loadFactory() {&lt;br/&gt;
    +		final ClassLoader cl = HadoopFileSystemFactoryLoader.class.getClassLoader();&lt;br/&gt;
    +&lt;br/&gt;
    +		// first, see if the Flink runtime classes are available&lt;br/&gt;
    +		final Class&amp;lt;? extends FileSystemFactory&amp;gt; factoryClass;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			factoryClass = Class.forName(FACTORY_CLASS, false, cl).asSubclass(FileSystemFactory.class);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Flink runtime classes missing in classpath/dependencies.&quot;);
    +		}
&lt;p&gt;    +		catch (Exception | LinkageError e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Flink&apos;s Hadoop file system factory could not be loaded&quot;, e);
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		// check (for eager and better exception messages) if the Hadoop classes are available here&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			Class.forName(HADOOP_CONFIG_CLASS, false, cl);
    +			Class.forName(HADOOP_FS_CLASS, false, cl);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    ditto&lt;/p&gt;</comment>
                            <comment id="16193175" author="githubbot" created="Thu, 5 Oct 2017 16:47:36 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142989415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142989415&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_CONFIG_CLASS = &quot;org.apache.hadoop.conf.Configuration&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_FS_CLASS = &quot;org.apache.hadoop.fs.FileSystem&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	public static FileSystemFactory loadFactory() {&lt;br/&gt;
    +		final ClassLoader cl = HadoopFileSystemFactoryLoader.class.getClassLoader();&lt;br/&gt;
    +&lt;br/&gt;
    +		// first, see if the Flink runtime classes are available&lt;br/&gt;
    +		final Class&amp;lt;? extends FileSystemFactory&amp;gt; factoryClass;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			factoryClass = Class.forName(FACTORY_CLASS, false, cl).asSubclass(FileSystemFactory.class);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Flink runtime classes missing in classpath/dependencies.&quot;);
    +		}
&lt;p&gt;    +		catch (Exception | LinkageError e) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    ditto&lt;/p&gt;</comment>
                            <comment id="16193176" author="githubbot" created="Thu, 5 Oct 2017 16:47:36 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142989384&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142989384&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_CONFIG_CLASS = &quot;org.apache.hadoop.conf.Configuration&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_FS_CLASS = &quot;org.apache.hadoop.fs.FileSystem&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	public static FileSystemFactory loadFactory() {&lt;br/&gt;
    +		final ClassLoader cl = HadoopFileSystemFactoryLoader.class.getClassLoader();&lt;br/&gt;
    +&lt;br/&gt;
    +		// first, see if the Flink runtime classes are available&lt;br/&gt;
    +		final Class&amp;lt;? extends FileSystemFactory&amp;gt; factoryClass;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			factoryClass = Class.forName(FACTORY_CLASS, false, cl).asSubclass(FileSystemFactory.class);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shall we log a warning for this exception? I&apos;d prefer to have a log entry at the very top of log file to be easily discovered&lt;/p&gt;</comment>
                            <comment id="16193177" author="githubbot" created="Thu, 5 Oct 2017 16:47:36 +0000"  >&lt;p&gt;Github user bowenli86 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r142989807&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r142989807&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/factories/HadoopFileSystemFactoryLoader.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,67 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.core.fs.factories;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystemFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * A&lt;br/&gt;
    + */&lt;br/&gt;
    +public class HadoopFileSystemFactoryLoader {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String FACTORY_CLASS = &quot;org.apache.flink.runtime.fs.hdfs.HadoopFsFactory&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_CONFIG_CLASS = &quot;org.apache.hadoop.conf.Configuration&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final String HADOOP_FS_CLASS = &quot;org.apache.hadoop.fs.FileSystem&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +	public static FileSystemFactory loadFactory() {&lt;br/&gt;
    +		final ClassLoader cl = HadoopFileSystemFactoryLoader.class.getClassLoader();&lt;br/&gt;
    +&lt;br/&gt;
    +		// first, see if the Flink runtime classes are available&lt;br/&gt;
    +		final Class&amp;lt;? extends FileSystemFactory&amp;gt; factoryClass;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			factoryClass = Class.forName(FACTORY_CLASS, false, cl).asSubclass(FileSystemFactory.class);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Flink runtime classes missing in classpath/dependencies.&quot;);
    +		}
&lt;p&gt;    +		catch (Exception | LinkageError e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Flink&apos;s Hadoop file system factory could not be loaded&quot;, e);
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		// check (for eager and better exception messages) if the Hadoop classes are available here&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			Class.forName(HADOOP_CONFIG_CLASS, false, cl);
    +			Class.forName(HADOOP_FS_CLASS, false, cl);
    +		}
&lt;p&gt;    +		catch (ClassNotFoundException e) &lt;/p&gt;
{
    +			return new UnsupportedSchemeFactory(&quot;Hadoop is not in the classpath/dependencies.&quot;);
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		// Create the factory.&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			return factoryClass.newInstance();
    +		}
&lt;p&gt;    +		catch (Exception | LinkageError e) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    ditto&lt;/p&gt;</comment>
                            <comment id="16194323" author="githubbot" created="Fri, 6 Oct 2017 09:07:49 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bowenli86 I can add a log statement.&lt;/p&gt;</comment>
                            <comment id="16194324" author="githubbot" created="Fri, 6 Oct 2017 09:08:13 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776#discussion_r143142386&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776#discussion_r143142386&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/src/main/java/org/apache/flink/core/fs/FileSystem.java &amp;#8212;&lt;br/&gt;
    @@ -328,116 +360,54 @@ public static FileSystem getUnguardedFileSystem(URI uri) throws IOException {&lt;br/&gt;
     			final FSKey key = new FSKey(uri.getScheme(), uri.getAuthority());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Actually. `authority` already includes the port (authority = host + port).&lt;/p&gt;</comment>
                            <comment id="16194349" author="githubbot" created="Fri, 6 Oct 2017 09:27:15 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the comments. Addressing them and merging them...&lt;/p&gt;</comment>
                            <comment id="16194394" author="githubbot" created="Fri, 6 Oct 2017 10:07:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4776&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16243895" author="aljoscha" created="Wed, 8 Nov 2017 13:14:53 +0000"  >&lt;p&gt;Reopen to fix release note.&lt;/p&gt;</comment>
                            <comment id="16243896" author="aljoscha" created="Wed, 8 Nov 2017 13:15:01 +0000"  >&lt;p&gt;Fixed via 536675b03a5050fda9c3e1fd403818cb50dcc6ff&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13092307">FLINK-7365</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k8jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>