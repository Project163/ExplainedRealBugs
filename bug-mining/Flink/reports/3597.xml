<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:43:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15437] Start session with property of &quot;-Dtaskmanager.memory.process.size&quot; not work</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15437</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;b&gt;The environment:&lt;/b&gt;&lt;br/&gt;
Yarn session cmd is as below, and the flink-conf.yaml has not the property of &quot;taskmanager.memory.process.size&quot;:&lt;/p&gt;

&lt;p&gt;export HADOOP_CLASSPATH=`hadoop classpath`;export HADOOP_CONF_DIR=/dump/1/jenkins/workspace/Stream-Spark-3.4/env/hadoop_conf_dirs/blinktest2; export BLINK_HOME=/dump/1/jenkins/workspace/test/blink_daily; $BLINK_HOME/bin/yarn-session.sh -d -qu root.default -nm &apos;Session Cluster of daily_regression_stream_spark_1.10&apos; -jm 1024 -n 20 -s 10 -Dtaskmanager.memory.process.size=1024m&lt;/p&gt;


&lt;p&gt;&lt;b&gt;After execute the cmd above, there is a exception like this:&lt;/b&gt;&lt;br/&gt;
2019-12-30 17:54:57,992 INFO  org.apache.hadoop.yarn.client.RMProxy                         - Connecting to ResourceManager at z05c07224.sqa.zth.tbsite.net/11.163.188.36:8050&lt;br/&gt;
2019-12-30 17:54:58,182 ERROR org.apache.flink.yarn.cli.FlinkYarnSessionCli                 - Error while running the Flink session.&lt;br/&gt;
org.apache.flink.configuration.IllegalConfigurationException: Either Task Heap Memory size (taskmanager.memory.task.heap.size) and Managed Memory size (taskmanager.memory.managed.size), or Total Flink Memory size (taskmanager.memory.flink.size), or Total Process Memory size (taskmanager.memory.process.size) need to be configured explicitly.&lt;br/&gt;
	at org.apache.flink.runtime.clusterframework.TaskExecutorResourceUtils.resourceSpecFromConfig(TaskExecutorResourceUtils.java:145)&lt;br/&gt;
	at org.apache.flink.client.deployment.AbstractClusterClientFactory.getClusterSpecification(AbstractClusterClientFactory.java:44)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.run(FlinkYarnSessionCli.java:557)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.lambda$main$5(FlinkYarnSessionCli.java:803)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:422)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1804)&lt;br/&gt;
	at org.apache.flink.runtime.security.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.main(FlinkYarnSessionCli.java:803)&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------&lt;br/&gt;
 The program finished with the following exception:&lt;/p&gt;

&lt;p&gt;org.apache.flink.configuration.IllegalConfigurationException: Either Task Heap Memory size (taskmanager.memory.task.heap.size) and Managed Memory size (taskmanager.memory.managed.size), or Total Flink Memory size (taskmanager.memory.flink.size), or Total Process Memory size (taskmanager.memory.process.size) need to be configured explicitly.&lt;br/&gt;
	at org.apache.flink.runtime.clusterframework.TaskExecutorResourceUtils.resourceSpecFromConfig(TaskExecutorResourceUtils.java:145)&lt;br/&gt;
	at org.apache.flink.client.deployment.AbstractClusterClientFactory.getClusterSpecification(AbstractClusterClientFactory.java:44)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.run(FlinkYarnSessionCli.java:557)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.lambda$main$5(FlinkYarnSessionCli.java:803)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:422)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1804)&lt;br/&gt;
	at org.apache.flink.runtime.security.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)&lt;br/&gt;
	at org.apache.flink.yarn.cli.FlinkYarnSessionCli.main(FlinkYarnSessionCli.java:803)&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The flink-conf.yaml is :&lt;/b&gt;&lt;br/&gt;
jobmanager.rpc.address: localhost&lt;br/&gt;
jobmanager.rpc.port: 6123&lt;br/&gt;
jobmanager.heap.size: 1024m&lt;br/&gt;
taskmanager.memory.total-process.size: 1024m&lt;br/&gt;
taskmanager.numberOfTaskSlots: 1&lt;br/&gt;
parallelism.default: 1&lt;br/&gt;
jobmanager.execution.failover-strategy: region&lt;/p&gt;


</description>
                <environment></environment>
        <key id="13276850">FLINK-15437</key>
            <summary>Start session with property of &quot;-Dtaskmanager.memory.process.size&quot; not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xtsong">Xintong Song</assignee>
                                    <reporter username="xiaojin.wy">xiaojin.wy</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 30 Dec 2019 10:06:09 +0000</created>
                <updated>Mon, 6 Jan 2020 16:06:32 +0000</updated>
                            <resolved>Fri, 3 Jan 2020 03:10:27 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.10.0</fixVersion>
                                    <component>Command Line Client</component>
                    <component>Deployment / YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17005234" author="xiaojin.wy" created="Mon, 30 Dec 2019 10:08:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wuzang&quot; class=&quot;user-hover&quot; rel=&quot;wuzang&quot;&gt;wuzang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17005248" author="xintongsong" created="Mon, 30 Dec 2019 10:35:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiaojin.wy&quot; class=&quot;user-hover&quot; rel=&quot;xiaojin.wy&quot;&gt;xiaojin.wy&lt;/a&gt;&lt;br/&gt;
I think the problem is that you have &apos;-n 20&apos; in your command, which does not exist anymore.&lt;br/&gt;
Once the client see an unknown option, it will stop parsing the remaining options. Thus the &apos;-D&apos; memory option is not applied.&lt;br/&gt;
Could you verify whether removing &apos;-n 20&apos; fixes the problem?&lt;/p&gt;</comment>
                            <comment id="17005267" author="xiaojin.wy" created="Mon, 30 Dec 2019 11:39:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xintongsong&quot; class=&quot;user-hover&quot; rel=&quot;xintongsong&quot;&gt;xintongsong&lt;/a&gt; I delete &apos;-n 20&apos;, the same exception appears.&lt;/p&gt;</comment>
                            <comment id="17005906" author="xintongsong" created="Tue, 31 Dec 2019 02:57:05 +0000"  >&lt;p&gt;I&apos;ve checked the codes. The problem is that &apos;-D&apos; properties are applied only to the cluster (JM) configuration but not the to client configuration, while the client is using the memory size configuration before deploying the cluster.&lt;/p&gt;

&lt;p&gt;I&apos;ll try to provide a fix soon.&lt;/p&gt;</comment>
                            <comment id="17005909" author="fly_in_gis" created="Tue, 31 Dec 2019 03:12:00 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xintongsong&quot; class=&quot;user-hover&quot; rel=&quot;xintongsong&quot;&gt;xintongsong&lt;/a&gt;&#160;is right. The dynamic properties need to be applied&#160;earlier in &lt;tt&gt;FlinkYarnSessionCli#applyCommandLineOptionsToConfiguration&lt;/tt&gt;. Hence, we will not need to pass the &lt;tt&gt;$internal.yarn.dynamic-properties&lt;/tt&gt; to &lt;tt&gt;YarnClusterDescriptor&lt;/tt&gt;. Also the clusterSpecification will be calculated correctly.&lt;/p&gt;

&lt;p&gt;For the magic yarn properties file, we should keep the same behavior currently. And it will be removed in the next release. I will create a ticket to track this.&lt;/p&gt;</comment>
                            <comment id="17007194" author="tison" created="Fri, 3 Jan 2020 03:10:27 +0000"  >&lt;p&gt;master via &lt;br/&gt;
367765be025a325da52256bb05c773383975114e&lt;br/&gt;
267f59017bf14a30bf5f70a94d85f800def92109&lt;br/&gt;
d82828d8c8fffcc5afd3a7c79bfdb7e018908546&lt;br/&gt;
671f18ba165e60a0f1da0639c51446ef838f18cf&lt;/p&gt;

&lt;p&gt;1.10 via&lt;br/&gt;
0a89b9a40ffd13595702851909c6bcdfbc8affc1&lt;br/&gt;
30717aa04ced1be2024543f8907290ff9bf4b488&lt;br/&gt;
ed4e2de24847d3b84168afaa35db7e3ba4102654&lt;br/&gt;
02873cba8b2e2cbc29365a063192a8adf2182a6f&lt;/p&gt;</comment>
                            <comment id="17007251" author="tison" created="Fri, 3 Jan 2020 06:21:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt; is there a ticket tracking the removal of magic yarn properties file? If so, please link it to this ticket.&lt;/p&gt;</comment>
                            <comment id="17007419" author="fly_in_gis" created="Fri, 3 Jan 2020 11:19:04 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tison&quot; class=&quot;user-hover&quot; rel=&quot;tison&quot;&gt;tison&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have created a ticket to tracking removing magic properties file. Let&apos;s keep discussion there.&lt;/p&gt;</comment>
                            <comment id="17008210" author="tison" created="Sun, 5 Jan 2020 01:01:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fly_in_gis&quot; class=&quot;user-hover&quot; rel=&quot;fly_in_gis&quot;&gt;fly_in_gis&lt;/a&gt; I mean if you have created one, link it here(you can click &quot;more&quot; bottom above and add a related issue) and discuss there. So far you said &quot;I have created one&quot; but where it is &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17008211" author="tison" created="Sun, 5 Jan 2020 01:03:43 +0000"  >&lt;p&gt;OK I found &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15470&quot; title=&quot;Remove YARN magic properties file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15470&quot;&gt;FLINK-15470&lt;/a&gt; and will link it here.&lt;/p&gt;</comment>
                            <comment id="17008511" author="fly_in_gis" created="Mon, 6 Jan 2020 03:12:10 +0000"  >&lt;p&gt;Aha, i forget to link it here.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tison&quot; class=&quot;user-hover&quot; rel=&quot;tison&quot;&gt;tison&lt;/a&gt;&#160;You have found it.&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_up.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13277352">FLINK-15470</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0a2qg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>