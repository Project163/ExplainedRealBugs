<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:15:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-30133] HadoopModuleFactory creates error if the security module cannot be loaded</title>
                <link>https://issues.apache.org/jira/browse/FLINK-30133</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/blob/26aa543b3bbe2b606bbc6d332a2ef7c5b46d25eb/flink-runtime/src/main/java/org/apache/flink/runtime/security/modules/HadoopModuleFactory.java#L51&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HadoopModuleFactory&lt;/a&gt; tries to load the &lt;tt&gt;HadoopModule&lt;/tt&gt;. If it fails to load the module, it will log an error an return &lt;tt&gt;null&lt;/tt&gt; which is going to be handled properly. The resulting error log is, therefore, confusing. We might want to lower the log level to warning since the error doesn&apos;t affect the Flink cluster in a fatal way.&lt;/p&gt;

&lt;p&gt;We might want to make the cluster fail fatally if we consider this a sever usability problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13505229">FLINK-30133</key>
            <summary>HadoopModuleFactory creates error if the security module cannot be loaded</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mapohl">Matthias Pohl</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>starter</label>
                    </labels>
                <created>Tue, 22 Nov 2022 07:35:23 +0000</created>
                <updated>Fri, 25 Nov 2022 02:57:50 +0000</updated>
                            <resolved>Fri, 25 Nov 2022 02:57:50 +0000</resolved>
                                    <version>1.16.0</version>
                    <version>1.17.0</version>
                    <version>1.15.2</version>
                                    <fixVersion>1.17.0</fixVersion>
                    <fixVersion>1.16.1</fixVersion>
                    <fixVersion>1.15.4</fixVersion>
                                    <component>Connectors / Hadoop Compatibility</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17637045" author="mapohl" created="Tue, 22 Nov 2022 07:38:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gsomogyi&quot; class=&quot;user-hover&quot; rel=&quot;gsomogyi&quot;&gt;gsomogyi&lt;/a&gt; I&apos;m curious what you think of that. Do you agree that warning the user through a log message is good enough or should we fail fatally if the hadoop security module failed to be loaded because the user might assume certain security measures being in place if he/she misses this log warning.&lt;/p&gt;</comment>
                            <comment id="17637116" author="gaborgsomogyi" created="Tue, 22 Nov 2022 09:40:55 +0000"  >&lt;p&gt;I think this area is just conceptually not consistent so not sure what we can do about it w/o breaking change.&lt;/p&gt;

&lt;p&gt;Here is my understanding:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;All other factory classes make the workload finally fail if something bad happens&lt;/li&gt;
	&lt;li&gt;`security.module.factory.classes` contains `HadoopModuleFactory` by default which is fine&lt;/li&gt;
	&lt;li&gt;When no hadoop-common is on classpath then it silently prints an info and not loading the module. We can consider it &lt;a href=&quot;https://github.com/apache/flink/blob/26aa543b3bbe2b606bbc6d332a2ef7c5b46d25eb/flink-runtime/src/main/java/org/apache/flink/runtime/security/modules/HadoopModuleFactory.java#L41&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;best effort behavior&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;Then it tries to load the hadoop configuration in the &lt;a href=&quot;https://github.com/apache/flink/blob/26aa543b3bbe2b606bbc6d332a2ef7c5b46d25eb/flink-runtime/src/main/java/org/apache/flink/runtime/security/modules/HadoopModuleFactory.java#L51&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;mentioned place&lt;/a&gt;, but this is just bad in general. It uses `flink-hadoop-fs` area code where &lt;a href=&quot;https://github.com/apache/flink/blob/26aa543b3bbe2b606bbc6d332a2ef7c5b46d25eb/flink-filesystems/flink-hadoop-fs/src/main/java/org/apache/flink/runtime/util/HadoopUtils.java#L59&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HdfsConfiguration&lt;/a&gt; is instantiated. This implicitly means one MUST have HDFS jars on classpath to run Flink securely. I&apos;m constantly thinking about this to refactor but this is definitely a breaking change ( though I would support full rewrite of hadoop config loading since Flink has at least 6-7 different Hadoop config loading implementations which makes this area hell &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Considering the actual situation we can decrease the error level to warning since the workload is going forward.&lt;br/&gt;
If you ask me then now/later on I would do the following for the clean solution:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Remove `HdfsConfiguration` from Flink Hadoop config loading since HDFS configs are not needed for Kerberos authentication.&lt;/li&gt;
	&lt;li&gt;Make the workload finally fail if module was not able to be loaded/installed (hadoop-common is on classpath so the user has intention to install the module)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I know that my clean solution would be a drastic change but that would be clear to the users.&lt;/p&gt;</comment>
                            <comment id="17638117" author="mapohl" created="Thu, 24 Nov 2022 06:20:05 +0000"  >&lt;p&gt;Thanks for your thorough analysis, Gabor. I went ahead and created PRs for that minor issue. It would be great if you could create a follow up ticket that covers the cleanup as this sounds like a reasonable refactoring.&lt;/p&gt;</comment>
                            <comment id="17638465" author="mapohl" created="Fri, 25 Nov 2022 02:57:50 +0000"  >&lt;p&gt;master: 5086a33f41058e3a87bae4bf0107032fd0194b67&lt;br/&gt;
1.16: 622ed691c3e7f563d82f3e06273e7d2647dec1c1&lt;br/&gt;
1.15: 17b569f4c75064e4a5e76289bd598d9bc1140953&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 50 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1clw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>