<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:59:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-23806] StackOverflowException can happen if a large scale job failed to acquire enough slots in time</title>
                <link>https://issues.apache.org/jira/browse/FLINK-23806</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When requested slots are not fulfilled in time, task failure will be triggered and all related tasks will be canceled and restarted. However, in this process, if a task is already assigned a slot, the slot will be returned to the slot pool and it will be immediately used to fulfill pending slot requests of the tasks which will soon be canceled. The execution version of those tasks are already bumped in &lt;tt&gt;DefaultScheduler#restartTasksWithDelay(...)&lt;/tt&gt; so that the assignment will fail immediately and the slot will be returned to the slot pool and again used to fulfill pending slot requests. StackOverflow can happen in this way when there are many vertices, and fatal error can happen and lead to JM crash. A sample call stack is attached below.&lt;/p&gt;

&lt;p&gt;To fix the problem, one way is to cancel the pending requests of all the tasks which will be canceled soon(i.e. tasks with version bumped) before canceling these tasks.&lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;...&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.PhysicalSlotProviderImpl.cancelSlotRequest(PhysicalSlotProviderImpl.java:112) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.SlotSharingExecutionSlotAllocator.releaseSharedSlot(SlotSharingExecutionSlotAllocator.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.SharedSlot.releaseExternally(SharedSlot.java:281) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.SharedSlot.removeLogicalSlotRequest(SharedSlot.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.SharedSlot.returnLogicalSlot(SharedSlot.java:234) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot.lambda$returnSlotToOwner$0(SingleLogicalSlot.java:203) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.uniRunStage(CompletableFuture.java:717) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.thenRun(CompletableFuture.java:2010) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot.returnSlotToOwner(SingleLogicalSlot.java:200) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.SingleLogicalSlot.releaseSlot(SingleLogicalSlot.java:130) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.DefaultScheduler.releaseSlotIfPresent(DefaultScheduler.java:542) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.scheduler.DefaultScheduler.lambda$assignResourceOrHandleError$8(DefaultScheduler.java:505) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:822) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:797) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1962) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DeclarativeSlotPoolBridge$PendingRequest.fulfill(DeclarativeSlotPoolBridge.java:552) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DeclarativeSlotPoolBridge$PendingRequestSlotMatching.fulfillPendingRequest(DeclarativeSlotPoolBridge.java:587) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DeclarativeSlotPoolBridge.newSlotsAreAvailable(DeclarativeSlotPoolBridge.java:171) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool.lambda$freeReservedSlot$0(DefaultDeclarativeSlotPool.java:316) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.Optional.ifPresent(Optional.java:159) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_102&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool.freeReservedSlot(DefaultDeclarativeSlotPool.java:313) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.DeclarativeSlotPoolBridge.releaseSlot(DeclarativeSlotPoolBridge.java:335) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.flink.runtime.jobmaster.slotpool.PhysicalSlotProviderImpl.cancelSlotRequest(PhysicalSlotProviderImpl.java:112) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;flink-dist_2.11-1.13-vvr-4.0.7-SNAPSHOT.jar:1.13-vvr-4.0.7-SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
...&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13395438">FLINK-23806</key>
            <summary>StackOverflowException can happen if a large scale job failed to acquire enough slots in time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhuzh">Zhu Zhu</assignee>
                                    <reporter username="zhuzh">Zhu Zhu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 16 Aug 2021 09:20:26 +0000</created>
                <updated>Wed, 15 Dec 2021 01:40:27 +0000</updated>
                            <resolved>Thu, 19 Aug 2021 08:17:32 +0000</resolved>
                                    <version>1.12.5</version>
                    <version>1.13.2</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.3</fixVersion>
                    <fixVersion>1.12.8</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17401532" author="zhuzh" created="Thu, 19 Aug 2021 08:17:32 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
master/release-1.14: f543e9a97e2d2dda340d4d1d54467ffe060666cb&lt;br/&gt;
release-1.13: de16f34193799e7f3aade15b9bc57549f8010621&lt;br/&gt;
release-1.12: 5e83f3e6f3d9bef893a28e68b6ed2534589f1e30&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0txuo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>