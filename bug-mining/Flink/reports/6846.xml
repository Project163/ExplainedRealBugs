<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:15:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-30328] TaskManagerWideRocksDbMemorySharingITCase.testBlockCache failed</title>
                <link>https://issues.apache.org/jira/browse/FLINK-30328</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;tt&gt;TaskManagerWideRocksDbMemorySharingITCase.testBlockCache&lt;/tt&gt; failed in this build: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=43763&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9836&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=43763&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9836&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Dec 06 16:33:59 [ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 12.926 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.test.state.TaskManagerWideRocksDbMemorySharingITCase
Dec 06 16:33:59 [ERROR] org.apache.flink.test.state.TaskManagerWideRocksDbMemorySharingITCase.testBlockCache  Time elapsed: 12.907 s  &amp;lt;&amp;lt;&amp;lt; FAILURE!
Dec 06 16:33:59 java.lang.AssertionError: 
Dec 06 16:33:59 Block cache usage reported by different tasks varies too much: DoubleSummaryStatistics{count=20, sum=3783523840.000000, min=189045056.000000, average=189176192.000000, max=189569600.000000}
Dec 06 16:33:59 That likely mean that they use different cache objects expected:&amp;lt;1.895696E8&amp;gt; but was:&amp;lt;1.89045056E8&amp;gt;
Dec 06 16:33:59 	at org.junit.Assert.fail(Assert.java:89)
Dec 06 16:33:59 	at org.junit.Assert.failNotEquals(Assert.java:835)
Dec 06 16:33:59 	at org.junit.Assert.assertEquals(Assert.java:555)
Dec 06 16:33:59 	at org.apache.flink.test.state.TaskManagerWideRocksDbMemorySharingITCase.testBlockCache(TaskManagerWideRocksDbMemorySharingITCase.java:133)
[...] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13510463">FLINK-30328</key>
            <summary>TaskManagerWideRocksDbMemorySharingITCase.testBlockCache failed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 7 Dec 2022 16:28:38 +0000</created>
                <updated>Sat, 4 Feb 2023 19:07:03 +0000</updated>
                            <resolved>Sat, 4 Feb 2023 19:07:03 +0000</resolved>
                                    <version>1.17.0</version>
                                    <fixVersion>1.17.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17644422" author="mapohl" created="Wed, 7 Dec 2022 16:29:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt; is there anyone else I could ping on these issues besides you to spread the work a bit?&lt;/p&gt;</comment>
                            <comment id="17644423" author="mapohl" created="Wed, 7 Dec 2022 16:31:08 +0000"  >&lt;p&gt;The test failure appeared in a CI run for &lt;a href=&quot;https://github.com/apache/flink/pull/21459&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;hotfix PR #21459&lt;/a&gt;. It&apos;s quite likely that the failure is unrelated to the change because the PR addresses deprecated Calcite APIs.&lt;/p&gt;</comment>
                            <comment id="17645031" author="roman_khachatryan" created="Thu, 8 Dec 2022 23:44:21 +0000"  >&lt;p&gt;The failure is most likely unrelated and I can look into it. Thanks for reporting and pinging me.&lt;/p&gt;</comment>
                            <comment id="17645730" author="leonard xu" created="Sun, 11 Dec 2022 07:04:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=43861&amp;amp;view=logs&amp;amp;j=b0a398c0-685b-599c-eb57-c8c2a771138e&amp;amp;t=747432ad-a576-5911-1e2a-68c6bedc248a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=43861&amp;amp;view=logs&amp;amp;j=b0a398c0-685b-599c-eb57-c8c2a771138e&amp;amp;t=747432ad-a576-5911-1e2a-68c6bedc248a&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17653548" author="mapohl" created="Mon, 2 Jan 2023 09:57:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44309&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9849&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44309&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9849&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17653575" author="mapohl" created="Mon, 2 Jan 2023 11:07:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44373&amp;amp;view=logs&amp;amp;j=b0a398c0-685b-599c-eb57-c8c2a771138e&amp;amp;t=747432ad-a576-5911-1e2a-68c6bedc248a&amp;amp;l=11054&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44373&amp;amp;view=logs&amp;amp;j=b0a398c0-685b-599c-eb57-c8c2a771138e&amp;amp;t=747432ad-a576-5911-1e2a-68c6bedc248a&amp;amp;l=11054&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17654412" author="fsk119" created="Wed, 4 Jan 2023 11:39:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44456&amp;amp;view=logs&amp;amp;s=ae4f8708-9994-57d3-c2d7-b892156e7812&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44456&amp;amp;view=logs&amp;amp;s=ae4f8708-9994-57d3-c2d7-b892156e7812&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17656159" author="mapohl" created="Mon, 9 Jan 2023 15:38:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44613&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=7433&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=44613&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=7433&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17678700" author="mapohl" created="Thu, 19 Jan 2023 13:35:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45036&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10185&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45036&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=10185&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17678702" author="mapohl" created="Thu, 19 Jan 2023 13:36:19 +0000"  >&lt;p&gt;I&apos;m updating the priority to become a blocker since it appears to only happen on master. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt;&#160; Are there any updates on that topic?&lt;/p&gt;</comment>
                            <comment id="17678727" author="roman_khachatryan" created="Thu, 19 Jan 2023 14:09:25 +0000"  >&lt;p&gt;Sorry for the late reply, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mapohl&quot; class=&quot;user-hover&quot; rel=&quot;mapohl&quot;&gt;mapohl&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;ve checked it locally and made sure that it is a test issue, not a production code issue. In particular, I&apos;ve found no issues with:&lt;br/&gt;
&#160;- memory sharing (the feature that&apos;s tested)&lt;br/&gt;
&#160;- concurrency - except metric reading, which is expected&lt;/p&gt;

&lt;p&gt;The problem in test is caused by the timings of metrics collections.&lt;/p&gt;

&lt;p&gt;The interval is hardcoded to 5s in Flink currently, but even if changed it still doesn&apos;t solve the problem completely.&#160;There seems to be no better alternative to testing via metrics either.&lt;/p&gt;

&lt;p&gt;So I opened drafted a PR to check deviation instead of min/max which should eliminate false positives: &lt;a href=&quot;https://github.com/apache/flink/pull/21733&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/21733&lt;/a&gt;&lt;br/&gt;
I&apos;ll try to finalize it this week.&lt;/p&gt;</comment>
                            <comment id="17680373" author="roman_khachatryan" created="Tue, 24 Jan 2023 22:11:22 +0000"  >&lt;p&gt;Merged into master as f8105bb584f8e7b6302a15c1c9270b988ff574cb.&lt;/p&gt;</comment>
                            <comment id="17680910" author="mapohl" created="Thu, 26 Jan 2023 07:33:54 +0000"  >&lt;p&gt;I&apos;m reopening this issue because we still see test failures on &lt;tt&gt;master&lt;/tt&gt;. The following build failed with the fix &lt;a href=&quot;https://github.com/apache/flink/commit/f8105bb584f8e7b6302a15c1c9270b988ff574cb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;f8105bb5&lt;/a&gt; being included:&lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45196&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9881&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45196&amp;amp;view=logs&amp;amp;j=a57e0635-3fad-5b08-57c7-a4142d7d6fa9&amp;amp;t=2ef0effc-1da1-50e5-c2bd-aab434b1c5b7&amp;amp;l=9881&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17681957" author="mapohl" created="Mon, 30 Jan 2023 08:44:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45352&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=8015&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45352&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=0c010d0c-3dec-5bf1-d408-7b18988b1b2b&amp;amp;l=8015&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17682054" author="mapohl" created="Mon, 30 Jan 2023 12:44:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45374&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=8043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45374&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=8043&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17682100" author="mapohl" created="Mon, 30 Jan 2023 14:00:28 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I&apos;ve checked it locally and made sure that it is a test issue, not a production code issue. In particular, I&apos;ve found no issues with:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;memory sharing (the feature that&apos;s tested)&lt;/li&gt;
	&lt;li&gt;concurrency - except metric reading, which is expected&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem in test is caused by the timings of metrics collections.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman&quot; class=&quot;user-hover&quot; rel=&quot;roman&quot;&gt;roman&lt;/a&gt; is there a chance that we can get it fixed before 1.17? Or would you vote for lowering the priority of this issue?&lt;/p&gt;</comment>
                            <comment id="17682149" author="roman_khachatryan" created="Mon, 30 Jan 2023 15:39:44 +0000"  >&lt;p&gt;I think the priority can be lowered because it is a test code issue.&lt;/p&gt;

&lt;p&gt;I&apos;ve opened a &lt;a href=&quot;https://github.com/apache/flink/pull/21791/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; to ignore the test temporarily as a quick solution.&lt;/p&gt;

&lt;p&gt;I&apos;ve also opened a &lt;a href=&quot;https://github.com/apache/flink/pull/21778&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; to fix the test, hope it can get merged soon.&lt;/p&gt;</comment>
                            <comment id="17682151" author="mapohl" created="Mon, 30 Jan 2023 15:42:42 +0000"  >&lt;p&gt;thanks for getting back to me on that one. I&apos;m lowering the priority to Major.&lt;/p&gt;</comment>
                            <comment id="17682157" author="mapohl" created="Mon, 30 Jan 2023 15:51:14 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-30831&quot; title=&quot;Improving e2e test output in case errors/exceptions are found&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-30831&quot;&gt;FLINK-30831&lt;/a&gt; after going through the logs once more.&lt;/p&gt;</comment>
                            <comment id="17682422" author="mapohl" created="Tue, 31 Jan 2023 07:40:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45408&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=8037&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=45408&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=86f654fa-ab48-5c1a-25f4-7e7f6afb9bba&amp;amp;l=8037&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17684209" author="roman_khachatryan" created="Sat, 4 Feb 2023 19:07:03 +0000"  >&lt;p&gt;Fixed by 7b65644161767e90f0834db76ba116d4d92449d5 in master.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13522088">FLINK-30831</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 40 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1di5s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>