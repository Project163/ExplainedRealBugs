<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:51:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19369] BlobClientTest.testGetFailsDuringStreamingForJobPermanentBlob hangs</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19369</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=6803&amp;amp;view=logs&amp;amp;j=f0ac5c25-1168-55a5-07ff-0e88223afed9&amp;amp;t=39a61cac-5c62-532f-d2c1-dea450a66708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=6803&amp;amp;view=logs&amp;amp;j=f0ac5c25-1168-55a5-07ff-0e88223afed9&amp;amp;t=39a61cac-5c62-532f-d2c1-dea450a66708&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-09-22T21:40:57.5304615Z &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; #1 prio=5 os_prio=0 cpu=18407.84ms elapsed=1969.42s tid=0x00007f0730015800 nid=0x79bd waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry  [0x00007f07389fb000]
2020-09-22T21:40:57.5305080Z    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: BLOCKED (on object monitor)
2020-09-22T21:40:57.5305487Z 	at sun.security.ssl.SSLSocketImpl.duplexCloseOutput(java.base@11.0.7/SSLSocketImpl.java:541)
2020-09-22T21:40:57.5306159Z 	- waiting to lock &amp;lt;0x000000008661a560&amp;gt; (a sun.security.ssl.SSLSocketOutputRecord)
2020-09-22T21:40:57.5306545Z 	at sun.security.ssl.SSLSocketImpl.close(java.base@11.0.7/SSLSocketImpl.java:472)
2020-09-22T21:40:57.5307045Z 	at org.apache.flink.runtime.blob.BlobUtils.closeSilently(BlobUtils.java:367)
2020-09-22T21:40:57.5307605Z 	at org.apache.flink.runtime.blob.BlobServerConnection.close(BlobServerConnection.java:141)
2020-09-22T21:40:57.5308337Z 	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreaming(BlobClientTest.java:443)
2020-09-22T21:40:57.5308904Z 	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreamingForJobPermanentBlob(BlobClientTest.java:408)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13328924">FLINK-19369</key>
            <summary>BlobClientTest.testGetFailsDuringStreamingForJobPermanentBlob hangs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="dian.fu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 23 Sep 2020 06:25:38 +0000</created>
                <updated>Mon, 21 Dec 2020 10:09:45 +0000</updated>
                            <resolved>Mon, 21 Dec 2020 10:09:45 +0000</resolved>
                                    <version>1.11.0</version>
                    <version>1.12.0</version>
                                    <fixVersion>1.11.4</fixVersion>
                    <fixVersion>1.12.1</fixVersion>
                    <fixVersion>1.13.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17223003" author="mapohl" created="Thu, 29 Oct 2020 16:26:25 +0000"  >&lt;p&gt;Not sure whether that&apos;s related but &lt;tt&gt;BlobClientTest#testGetFailsDuringStreamingForJobPermanentBlob&lt;/tt&gt; fails (using Java 8 and Java 11) running it for multiple times (e.g. after 2008 tries):&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;java.io.IOException: PUT operation failed: Broken pipe (Write failed)&lt;/p&gt;

&lt;p&gt;at org.apache.flink.runtime.blob.BlobClient.putBuffer(BlobClient.java:345)&lt;br/&gt;
 at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreaming(BlobClientTest.java:431)&lt;br/&gt;
 at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreamingForJobPermanentBlob(BlobClientTest.java:409)&lt;br/&gt;
 at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
 at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
 at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)&lt;br/&gt;
 at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)&lt;br/&gt;
 at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)&lt;br/&gt;
 at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)&lt;br/&gt;
 at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)&lt;br/&gt;
 at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
 at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)&lt;br/&gt;
 at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)&lt;br/&gt;
 at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)&lt;br/&gt;
 at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)&lt;br/&gt;
 at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)&lt;br/&gt;
 at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)&lt;br/&gt;
 at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)&lt;br/&gt;
 at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)&lt;br/&gt;
 at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)&lt;br/&gt;
 at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)&lt;br/&gt;
 at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)&lt;br/&gt;
 at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
 at org.junit.runners.ParentRunner.run(ParentRunner.java:363)&lt;br/&gt;
 at org.junit.runner.JUnitCore.run(JUnitCore.java:137)&lt;br/&gt;
 at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)&lt;br/&gt;
 at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:52)&lt;br/&gt;
 at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)&lt;br/&gt;
 at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)&lt;br/&gt;
 Caused by: java.net.SocketException: Broken pipe (Write failed)&lt;br/&gt;
 at java.net.SocketOutputStream.socketWrite0(Native Method)&lt;br/&gt;
 at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)&lt;br/&gt;
 at java.net.SocketOutputStream.write(SocketOutputStream.java:155)&lt;br/&gt;
 at org.apache.flink.runtime.blob.BlobUtils.writeLength(BlobUtils.java:282)&lt;br/&gt;
 at org.apache.flink.runtime.blob.BlobOutputStream.write(BlobOutputStream.java:86)&lt;br/&gt;
 at org.apache.flink.runtime.blob.BlobClient.putBuffer(BlobClient.java:340)&lt;br/&gt;
 ... 29 more&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This can be also reproduced with &lt;tt&gt;BlobClientTest#testGetFailsDuringStreaming&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17223008" author="mapohl" created="Thu, 29 Oct 2020 16:28:53 +0000"  >&lt;p&gt;One time I ran into&#160;the following error:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Scala Compile Server&lt;br/&gt;
 java.lang.NegativeArraySizeException&lt;br/&gt;
 at com.martiansoftware.nailgun.NGSession.run(NGSession.java:204)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It caused the test to run infinitely.&lt;br/&gt;
 This ran on a AdoptOpenJDK 1.8u265 Hotspot VM (8.0.265.hs-adpt).&lt;/p&gt;</comment>
                            <comment id="17223039" author="mapohl" created="Thu, 29 Oct 2020 16:57:04 +0000"  >&lt;p&gt;And a different probably infinitely running test having the following Thread stack:&lt;/p&gt;

&lt;p&gt;&#160;&lt;blockquote&gt;
&lt;p&gt;2020-10-29 17:54:30&lt;br/&gt;
Full thread dump OpenJDK 64-Bit Server VM (11.0.8+10 mixed mode):&lt;/p&gt;

&lt;p&gt;Threads class SMR info:&lt;br/&gt;
_java_thread_list=0x00007fc0af74b890, length=13, elements=&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
0x00007fc0b000b800, 0x00007fc0b5808800, 0x00007fc0b580d800, 0x00007fc0b581e000,
0x00007fc0b5811800, 0x00007fc0b581f000, 0x00007fc0b3008800, 0x00007fc0b00f0800,
0x00007fc0b580a000, 0x00007fc0b58cd000, 0x00007fc0b0264000, 0x00007fc0b0a16800,
0x00007fc0b0a75000
}&lt;/span&gt; &lt;/div&gt;

&lt;p&gt;&quot;main&quot; #1 prio=5 os_prio=31 cpu=3402.11ms elapsed=124.79s tid=0x00007fc0b000b800 nid=0x1803 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000070000763f000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.net.SocketInputStream.socketRead0(java.base@11.0.8/Native Method)&lt;br/&gt;
	at java.net.SocketInputStream.socketRead(java.base@11.0.8/SocketInputStream.java:115)&lt;br/&gt;
	at java.net.SocketInputStream.read(java.base@11.0.8/SocketInputStream.java:168)&lt;br/&gt;
	at java.net.SocketInputStream.read(java.base@11.0.8/SocketInputStream.java:140)&lt;br/&gt;
	at java.net.SocketInputStream.read(java.base@11.0.8/SocketInputStream.java:200)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobOutputStream.receiveAndCheckPutResponse(BlobOutputStream.java:151)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobOutputStream.finish(BlobOutputStream.java:104)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClient.putBuffer(BlobClient.java:342)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreaming(BlobClientTest.java:431)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreamingForJobTransientBlob(BlobClientTest.java:404)&lt;br/&gt;
	at jdk.internal.reflect.GeneratedMethodAccessor2.invoke(Unknown Source)&lt;br/&gt;
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(java.base@11.0.8/DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(java.base@11.0.8/Method.java:566)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)&lt;br/&gt;
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)&lt;br/&gt;
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)&lt;br/&gt;
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)&lt;br/&gt;
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)&lt;br/&gt;
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)&lt;br/&gt;
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)&lt;br/&gt;
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)&lt;br/&gt;
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)&lt;br/&gt;
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)&lt;br/&gt;
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)&lt;br/&gt;
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)&lt;br/&gt;
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)&lt;br/&gt;
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:52)&lt;br/&gt;
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)&lt;br/&gt;
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)&lt;/p&gt;

&lt;p&gt;&quot;Reference Handler&quot; #2 daemon prio=10 os_prio=31 cpu=1.13ms elapsed=124.76s tid=0x00007fc0b5808800 nid=0x3b03 waiting on condition  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000700007d55000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.lang.ref.Reference.waitForReferencePendingList(java.base@11.0.8/Native Method)&lt;br/&gt;
	at java.lang.ref.Reference.processPendingReferences(java.base@11.0.8/Reference.java:241)&lt;br/&gt;
	at java.lang.ref.Reference$ReferenceHandler.run(java.base@11.0.8/Reference.java:213)&lt;/p&gt;

&lt;p&gt;&quot;Finalizer&quot; #3 daemon prio=8 os_prio=31 cpu=0.81ms elapsed=124.76s tid=0x00007fc0b580d800 nid=0x3d03 in Object.wait()  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000700007e58000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: WAITING (on object monitor)&lt;br/&gt;
	at java.lang.Object.wait(java.base@11.0.8/Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x000000078084cf08&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at java.lang.ref.ReferenceQueue.remove(java.base@11.0.8/ReferenceQueue.java:155)&lt;/li&gt;
	&lt;li&gt;waiting to re-lock in wait() &amp;lt;0x000000078084cf08&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at java.lang.ref.ReferenceQueue.remove(java.base@11.0.8/ReferenceQueue.java:176)&lt;br/&gt;
	at java.lang.ref.Finalizer$FinalizerThread.run(java.base@11.0.8/Finalizer.java:170)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Signal Dispatcher&quot; #4 daemon prio=9 os_prio=31 cpu=0.26ms elapsed=124.74s tid=0x00007fc0b581e000 nid=0x4203 waiting on condition  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;/p&gt;

&lt;p&gt;&quot;C2 CompilerThread0&quot; #5 daemon prio=9 os_prio=31 cpu=1064.32ms elapsed=124.74s tid=0x00007fc0b5811800 nid=0xa903 waiting on condition  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
   No compile task&lt;/p&gt;

&lt;p&gt;&quot;C1 CompilerThread0&quot; #8 daemon prio=9 os_prio=31 cpu=671.99ms elapsed=124.74s tid=0x00007fc0b581f000 nid=0x5703 waiting on condition  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
   No compile task&lt;/p&gt;

&lt;p&gt;&quot;Sweeper thread&quot; #9 daemon prio=9 os_prio=31 cpu=20.64ms elapsed=124.74s tid=0x00007fc0b3008800 nid=0xa503 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;/p&gt;

&lt;p&gt;&quot;Common-Cleaner&quot; #10 daemon prio=8 os_prio=31 cpu=1.18ms elapsed=124.67s tid=0x00007fc0b00f0800 nid=0xa303 in Object.wait()  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000070000846d000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: TIMED_WAITING (on object monitor)&lt;br/&gt;
	at java.lang.Object.wait(java.base@11.0.8/Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x000000078084daf8&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at java.lang.ref.ReferenceQueue.remove(java.base@11.0.8/ReferenceQueue.java:155)&lt;/li&gt;
	&lt;li&gt;waiting to re-lock in wait() &amp;lt;0x000000078084daf8&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at jdk.internal.ref.CleanerImpl.run(java.base@11.0.8/CleanerImpl.java:148)&lt;br/&gt;
	at java.lang.Thread.run(java.base@11.0.8/Thread.java:834)&lt;br/&gt;
	at jdk.internal.misc.InnocuousThread.run(java.base@11.0.8/InnocuousThread.java:134)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Monitor Ctrl-Break&quot; #11 daemon prio=5 os_prio=31 cpu=16.32ms elapsed=124.62s tid=0x00007fc0b580a000 nid=0x5b03 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000700008570000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.net.SocketInputStream.socketRead0(java.base@11.0.8/Native Method)&lt;br/&gt;
	at java.net.SocketInputStream.socketRead(java.base@11.0.8/SocketInputStream.java:115)&lt;br/&gt;
	at java.net.SocketInputStream.read(java.base@11.0.8/SocketInputStream.java:168)&lt;br/&gt;
	at java.net.SocketInputStream.read(java.base@11.0.8/SocketInputStream.java:140)&lt;br/&gt;
	at sun.nio.cs.StreamDecoder.readBytes(java.base@11.0.8/StreamDecoder.java:284)&lt;br/&gt;
	at sun.nio.cs.StreamDecoder.implRead(java.base@11.0.8/StreamDecoder.java:326)&lt;br/&gt;
	at sun.nio.cs.StreamDecoder.read(java.base@11.0.8/StreamDecoder.java:178)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x000000078084d568&amp;gt; (a java.io.InputStreamReader)&lt;br/&gt;
	at java.io.InputStreamReader.read(java.base@11.0.8/InputStreamReader.java:185)&lt;br/&gt;
	at java.io.BufferedReader.fill(java.base@11.0.8/BufferedReader.java:161)&lt;br/&gt;
	at java.io.BufferedReader.readLine(java.base@11.0.8/BufferedReader.java:326)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x000000078084d568&amp;gt; (a java.io.InputStreamReader)&lt;br/&gt;
	at java.io.BufferedReader.readLine(java.base@11.0.8/BufferedReader.java:392)&lt;br/&gt;
	at com.intellij.rt.execution.application.AppMainV2$1.run(AppMainV2.java:61)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Service Thread&quot; #12 daemon prio=9 os_prio=31 cpu=0.04ms elapsed=124.62s tid=0x00007fc0b58cd000 nid=0x5c03 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;/p&gt;

&lt;p&gt;&quot;Attach Listener&quot; #14 daemon prio=9 os_prio=31 cpu=9.18ms elapsed=123.76s tid=0x00007fc0b0264000 nid=0x6103 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000000000000000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;/p&gt;

&lt;p&gt;&quot;Timer-44&quot; #192 daemon prio=5 os_prio=31 cpu=0.10ms elapsed=120.84s tid=0x00007fc0b0a16800 nid=0x8e77 in Object.wait()  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000700008879000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: TIMED_WAITING (on object monitor)&lt;br/&gt;
	at java.lang.Object.wait(java.base@11.0.8/Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x000000078fe57b50&amp;gt; (a java.util.TaskQueue)&lt;br/&gt;
	at java.util.TimerThread.mainLoop(java.base@11.0.8/Timer.java:553)&lt;/li&gt;
	&lt;li&gt;waiting to re-lock in wait() &amp;lt;0x000000078fe57b50&amp;gt; (a java.util.TaskQueue)&lt;br/&gt;
	at java.util.TimerThread.run(java.base@11.0.8/Timer.java:506)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;BLOB Server listener at 65030&quot; #191 daemon prio=5 os_prio=31 cpu=0.12ms elapsed=120.84s tid=0x00007fc0b0a75000 nid=0x91b3 runnable  &lt;span class=&quot;error&quot;&gt;&amp;#91;0x0000700008f8e000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(java.base@11.0.8/Native Method)&lt;br/&gt;
	at java.net.AbstractPlainSocketImpl.accept(java.base@11.0.8/AbstractPlainSocketImpl.java:458)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(java.base@11.0.8/ServerSocket.java:565)&lt;br/&gt;
	at java.net.ServerSocket.accept(java.base@11.0.8/ServerSocket.java:533)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobServer.run(BlobServer.java:262)&lt;/p&gt;

&lt;p&gt;&quot;VM Thread&quot; os_prio=31 cpu=31.07ms elapsed=124.77s tid=0x00007fc0b080e000 nid=0x3903 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#0&quot; os_prio=31 cpu=24.78ms elapsed=124.79s tid=0x00007fc0b101b800 nid=0x2e03 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#1&quot; os_prio=31 cpu=23.25ms elapsed=124.28s tid=0x00007fc0b2812000 nid=0x9b03 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#2&quot; os_prio=31 cpu=28.46ms elapsed=124.28s tid=0x00007fc0b2813000 nid=0x9903 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#3&quot; os_prio=31 cpu=21.70ms elapsed=124.28s tid=0x00007fc0afb06800 nid=0x5f03 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#4&quot; os_prio=31 cpu=22.83ms elapsed=124.28s tid=0x00007fc0afb07000 nid=0x9603 runnable  &lt;/p&gt;

&lt;p&gt;&quot;GC Thread#5&quot; os_prio=31 cpu=22.38ms elapsed=124.28s tid=0x00007fc0afb08000 nid=0x9503 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Main Marker&quot; os_prio=31 cpu=1.48ms elapsed=124.79s tid=0x00007fc0b0035000 nid=0x3003 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Conc#0&quot; os_prio=31 cpu=17.64ms elapsed=124.79s tid=0x00007fc0b0035800 nid=0x3303 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Conc#1&quot; os_prio=31 cpu=20.39ms elapsed=122.77s tid=0x00007fc0b600b000 nid=0x9c07 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Conc#2&quot; os_prio=31 cpu=18.86ms elapsed=122.77s tid=0x00007fc0b687e800 nid=0x9d07 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Refine#0&quot; os_prio=31 cpu=0.52ms elapsed=124.78s tid=0x00007fc0b00de800 nid=0x3503 runnable  &lt;/p&gt;

&lt;p&gt;&quot;G1 Young RemSet Sampling&quot; os_prio=31 cpu=21.50ms elapsed=124.78s tid=0x00007fc0b00df000 nid=0x5103 runnable  &lt;br/&gt;
&quot;VM Periodic Task Thread&quot; os_prio=31 cpu=86.53ms elapsed=124.62s tid=0x00007fc0b108c800 nid=0x9e03 waiting on condition  &lt;/p&gt;

&lt;p&gt;JNI global refs: 20, weak refs: 0&lt;/p&gt;

&lt;p&gt;Heap&lt;br/&gt;
 garbage-first heap   total 262144K, used 65749K [0x0000000780000000, 0x0000000800000000)&lt;br/&gt;
  region size 1024K, 9 young (9216K), 3 survivors (3072K)&lt;br/&gt;
 Metaspace       used 18385K, capacity 18778K, committed 19072K, reserved 1067008K&lt;br/&gt;
  class space    used 1965K, capacity 2144K, committed 2176K, reserved 1048576K&lt;/p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;p&gt;The single test failed after 5mins:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;java.io.IOException: PUT operation failed: Read timed out&lt;/p&gt;

&lt;p&gt;	at org.apache.flink.runtime.blob.BlobClient.putBuffer(BlobClient.java:345)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreaming(BlobClientTest.java:431)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClientTest.testGetFailsDuringStreamingForJobTransientBlob(BlobClientTest.java:404)&lt;br/&gt;
	at jdk.internal.reflect.GeneratedMethodAccessor2.invoke(Unknown Source)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)&lt;br/&gt;
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)&lt;br/&gt;
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)&lt;br/&gt;
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)&lt;br/&gt;
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)&lt;br/&gt;
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)&lt;br/&gt;
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)&lt;br/&gt;
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)&lt;br/&gt;
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)&lt;br/&gt;
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)&lt;br/&gt;
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)&lt;br/&gt;
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)&lt;br/&gt;
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)&lt;br/&gt;
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)&lt;br/&gt;
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:52)&lt;br/&gt;
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)&lt;br/&gt;
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)&lt;br/&gt;
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)&lt;br/&gt;
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)&lt;br/&gt;
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:200)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobOutputStream.receiveAndCheckPutResponse(BlobOutputStream.java:151)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobOutputStream.finish(BlobOutputStream.java:104)&lt;br/&gt;
	at org.apache.flink.runtime.blob.BlobClient.putBuffer(BlobClient.java:342)&lt;br/&gt;
	... 29 more&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17223710" author="mapohl" created="Fri, 30 Oct 2020 15:43:07 +0000"  >&lt;p&gt;Ok, the stacktraces I mentioned in the comments seem to be unrelated a probably due to heavy load on the Blob storage.&lt;/p&gt;

&lt;p&gt;But I came across &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8241239&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JDK-8241239&lt;/a&gt; which might explain this failure. I&apos;m going to close the issue for now considering that it only appeared once more than 1 month ago. We might have to reopen the issue in case we experience failures like that again.&lt;/p&gt;</comment>
                            <comment id="17239465" author="dian.fu" created="Fri, 27 Nov 2020 01:27:34 +0000"  >&lt;p&gt;Another instance on master: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=10212&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=05b74a19-4ee4-5036-c46f-ada307df6cf0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=10212&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=05b74a19-4ee4-5036-c46f-ada307df6cf0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17251641" author="nicok" created="Fri, 18 Dec 2020 10:06:19 +0000"  >&lt;p&gt;It looks like the following code from &lt;tt&gt;BlobClientTest&lt;/tt&gt; could be problematic:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
			InputStream is = client.getInternal(jobId, key); &lt;span class=&quot;code-comment&quot;&gt;// (1)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;			BlobUtils.readFully(is, receiveBuffer, 0, firstChunkLen, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
			BlobUtils.readFully(is, receiveBuffer, firstChunkLen, firstChunkLen, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// (2)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;			&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (BlobServerConnection conn : getBlobServer().getCurrentActiveConnections()) {
				conn.close(); &lt;span class=&quot;code-comment&quot;&gt;// (3)
&lt;/span&gt;			}
&lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;				BlobUtils.readFully(is, receiveBuffer, 2 * firstChunkLen, data.length - 2 * firstChunkLen, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// (4)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// ...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m not 100% sure, but from the latest instance at &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=10212&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=05b74a19-4ee4-5036-c46f-ada307df6cf0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=10212&amp;amp;view=logs&amp;amp;j=0da23115-68bb-5dcd-192c-bd4c8adebde1&amp;amp;t=05b74a19-4ee4-5036-c46f-ada307df6cf0&lt;/a&gt;, the &lt;tt&gt;BlobServer&lt;/tt&gt;&apos;s connection thread seems to have acquired &quot;locked &amp;lt;0x000000008d873170&amp;gt; (a sun.security.ssl.SSLSocketOutputRecord)&quot; while writing data out to the socket that was created from the client (1). The client only read a few bytes in (2) and then didn&apos;t continue (yet) but the socket is still open. Now, the test wants to introduce a connection failure and tries to close the connection in (3) by letting the &lt;tt&gt;BlobServer&lt;/tt&gt; close it. However, this cannot be done because that requires the same lock inside the JDK&apos;s SSL stack (0x000000008d873170).&lt;/p&gt;

&lt;p&gt;This may lead to a situation where the &lt;tt&gt;BlobServer&lt;/tt&gt; is blocked and waits to write data to the socket because the socket is already full (not sure this would also result in a RUNNABLE thread, but &lt;tt&gt;BlobServerConnection&lt;/tt&gt; is not interruptable in this code and &lt;tt&gt;outputStream.write&lt;/tt&gt; must be a blocking operation) while at the same time, the client does not continue reading because we want to introduce the failure first and only then continue reading in (4).&lt;/p&gt;

&lt;p&gt;I&apos;m not really sure how to fix this without writing code into the &lt;tt&gt;BlobServerConnection&lt;/tt&gt; to introduce the failure there (not really the right way for code used only during testing), or rewriting it to use some non-blocking IO. If this is just happening with SSL (due to this additional lock), then maybe we should just disable these tests ( &lt;tt&gt;testGetFailsDuringStreamingNoJobTransientBlob&lt;/tt&gt;, &lt;tt&gt;testGetFailsDuringStreamingForJobTransientBlob&lt;/tt&gt;, &lt;tt&gt;testGetFailsDuringStreamingForJobPermanentBlob&lt;/tt&gt; ) for &lt;tt&gt;BlobClientSslTest&lt;/tt&gt; and trust that this isn&apos;t different with SSL and covered by &lt;tt&gt;BlobClientTest&lt;/tt&gt; already.&lt;/p&gt;</comment>
                            <comment id="17251700" author="till.rohrmann" created="Fri, 18 Dec 2020 10:58:51 +0000"  >&lt;p&gt;I think you are right with your analysis that this is a problem of the test setup &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=NicoK&quot; class=&quot;user-hover&quot; rel=&quot;NicoK&quot;&gt;NicoK&lt;/a&gt;. I will disable the tests for &lt;tt&gt;BlobClientSslTest&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17252744" author="till.rohrmann" created="Mon, 21 Dec 2020 10:09:45 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.13.0: 912539b67f0d11589684c5846e7f457fa8018299&lt;br/&gt;
1.12.1: c35cdbc1e31573b664e6343bb29df98970dd92c1&lt;br/&gt;
1.11.4: 6154610efd99f7506588c854f4abc07eab017fd7&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0iu2o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>