<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:34:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9935] Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9935</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&#160;Grouping by window AND some other attribute(s) seems broken. Test case attached:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BatchStatisticsIntegrationTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; FlatSpec with Matchers {

  trait BatchContext {
    implicit lazy val env: ExecutionEnvironment = ExecutionEnvironment.getExecutionEnvironment
    implicit val tableEnv: BatchTableEnvironment = TableEnvironment.getTableEnvironment(env)

    val data = Seq(
      (1532424567000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;id1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;location1&quot;&lt;/span&gt;),
      (1532424567000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;id2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;location1&quot;&lt;/span&gt;),
      (1532424567000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;id3&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;location1&quot;&lt;/span&gt;),
      (1532424568000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;id1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;location2&quot;&lt;/span&gt;),
      (1532424568000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;id2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;location3&quot;&lt;/span&gt;)
    )

    val rawDataSet: DataSet[(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)] = env.fromCollection(data)

    val table: Table = tableEnv.fromDataSet(rawDataSet, &lt;span class=&quot;code-quote&quot;&gt;&apos;rowtime, &apos;&lt;/span&gt;id, &apos;location)
  }

  it should &lt;span class=&quot;code-quote&quot;&gt;&quot;be possible to run Table API queries with grouping by tumble window and column(s) on batch data&quot;&lt;/span&gt; in &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BatchContext {
    val results = table
      .window(Tumble over 1.second on &lt;span class=&quot;code-quote&quot;&gt;&apos;rowtime as &apos;&lt;/span&gt;w)
      .groupBy(&lt;span class=&quot;code-quote&quot;&gt;&apos;w, &apos;&lt;/span&gt;location)
      .select(
        &apos;w.start.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Types.LONG),
        &apos;w.end.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(Types.LONG),
        &apos;location,
        &apos;id.count
      )
      .toDataSet[(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;)]
      .collect()

    results should contain theSameElementsAs Seq(
      (1532424567000L, 1532424568000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;location1&quot;&lt;/span&gt;, 3L),
      (1532424568000L, 1532424569000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;location2&quot;&lt;/span&gt;, 1L),
      (1532424568000L, 1532424569000L, &lt;span class=&quot;code-quote&quot;&gt;&quot;location3&quot;&lt;/span&gt;, 1L)
    )
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It seems like during execution time, the &apos;rowtime attribute replaces &apos;location and that causes ClassCastException.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[info]   Cause: java.lang.ClassCastException: java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
[info]   at org.apache.flink.api.common.typeutils.base.StringSerializer.serialize(StringSerializer.java:28)
[info]   at org.apache.flink.api.java.typeutils.runtime.RowSerializer.serialize(RowSerializer.java:160)
[info]   at org.apache.flink.api.java.typeutils.runtime.RowSerializer.serialize(RowSerializer.java:46)
[info]   at org.apache.flink.runtime.plugable.SerializationDelegate.write(SerializationDelegate.java:54)
[info]   at org.apache.flink.runtime.io.network.api.serialization.SpanningRecordSerializer.addRecord(SpanningRecordSerializer.java:88)
[info]   at org.apache.flink.runtime.io.network.api.writer.RecordWriter.sendToTarget(RecordWriter.java:129)
[info]   at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:105)
[info]   at org.apache.flink.runtime.operators.shipping.OutputCollector.collect(OutputCollector.java:65)
[info]   at org.apache.flink.runtime.operators.util.metrics.CountingCollector.collect(CountingCollector.java:35)
[info]   at org.apache.flink.api.java.operators.translation.RichCombineToGroupCombineWrapper.combine(RichCombineToGroupCombineWrapper.java:52)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is some debug information that I was able to get. So, field serializers don&apos;t match the type of Row fields:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.instance = {Row@68451} &lt;span class=&quot;code-quote&quot;&gt;&quot;1532424567000,(3),1532424567000&quot;&lt;/span&gt;
 fields = {&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[3]@68461} 
  0 = {&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;@68462} 1532424567000
  1 = {CountAccumulator@68463} &lt;span class=&quot;code-quote&quot;&gt;&quot;(3)&quot;&lt;/span&gt;
  2 = {&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;@68462} 1532424567000
&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serializer = {RowSerializer@68452} 
 fieldSerializers = {TypeSerializer[3]@68455} 
  0 = {StringSerializer@68458} 
  1 = {TupleSerializer@68459} 
  2 = {LongSerializer@68460} 
 arity = 3
 nullMask = {&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;[3]@68457} 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13174057">FLINK-9935</key>
            <summary>Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fhueske">Fabian Hueske</assignee>
                                    <reporter username="roman.wozniak">Roman Wozniak</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 24 Jul 2018 10:22:34 +0000</created>
                <updated>Thu, 26 Jul 2018 16:25:43 +0000</updated>
                            <resolved>Thu, 26 Jul 2018 16:25:29 +0000</resolved>
                                    <version>1.4.2</version>
                    <version>1.5.1</version>
                    <version>1.6.0</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.4.3</fixVersion>
                    <fixVersion>1.5.3</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                    <fixVersion>1.7.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16555717" author="fhueske" created="Wed, 25 Jul 2018 13:59:18 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman.wozniak&quot; class=&quot;user-hover&quot; rel=&quot;roman.wozniak&quot;&gt;roman.wozniak&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I was able to reproduce and identify the bug thanks to the provided a test case and will prepare a fix.&lt;/p&gt;

&lt;p&gt;Thank you very much!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16555812" author="githubbot" created="Wed, 25 Jul 2018 15:09:05 +0000"  >&lt;p&gt;fhueske opened a new pull request #6423: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9935&quot; title=&quot;Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9935&quot;&gt;&lt;del&gt;FLINK-9935&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix incorrect group field access in batch window combiner.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6423&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   Fixes an incorrect field access (on a grouping field) in the combiner for a TUMBLE or HOP group window in a batch query. The incorrect field access would typically result in a ClassCastException or lead to incorrect results.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul&gt;
	&lt;li&gt;fix the field access in the generated aggregation code.&lt;/li&gt;
	&lt;li&gt;modify tests to fail if the field access is invalid&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul&gt;
	&lt;li&gt;the modified tests validate the correct access.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The serializers: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? *&lt;b&gt;no&lt;/b&gt;*&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? *&lt;b&gt;n/a&lt;/b&gt;*&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16555888" author="githubbot" created="Wed, 25 Jul 2018 16:07:48 +0000"  >&lt;p&gt;yanghua commented on issue #6423: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9935&quot; title=&quot;Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9935&quot;&gt;&lt;del&gt;FLINK-9935&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix incorrect group field access in batch window combiner.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6423#issuecomment-407808877&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6423#issuecomment-407808877&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   +1&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16558348" author="githubbot" created="Thu, 26 Jul 2018 14:05:31 +0000"  >&lt;p&gt;fhueske commented on issue #6423: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9935&quot; title=&quot;Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9935&quot;&gt;&lt;del&gt;FLINK-9935&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix incorrect group field access in batch window combiner.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6423#issuecomment-408109019&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6423#issuecomment-408109019&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks @yanghua.&lt;br/&gt;
   I&apos;ll merge this.&lt;br/&gt;
   Fabian&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16558518" author="fhueske" created="Thu, 26 Jul 2018 16:25:29 +0000"  >&lt;p&gt;Fixed for 1.7.0 with 63e84ad6532aff561d3abbd0dbadd420f836b28f&lt;br/&gt;
Fixed for 1.6.0 with 80964d27ad3518c1df02c8f8aa8be5bee22490b4&lt;br/&gt;
Fixed for 1.5.3 with 9dee15b780470eb4e60e07ddd82f0b280faa875e&lt;br/&gt;
Fixed for 1.4.3 with c5223fdecdc8ef5889609bebfd7e259600a2179a&lt;/p&gt;</comment>
                            <comment id="16558519" author="githubbot" created="Thu, 26 Jul 2018 16:25:42 +0000"  >&lt;p&gt;fhueske commented on issue #6423: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9935&quot; title=&quot;Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9935&quot;&gt;&lt;del&gt;FLINK-9935&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix incorrect group field access in batch window combiner.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6423#issuecomment-408155116&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6423#issuecomment-408155116&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Merged&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16558520" author="githubbot" created="Thu, 26 Jul 2018 16:25:43 +0000"  >&lt;p&gt;fhueske closed pull request #6423: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9935&quot; title=&quot;Batch Table API: grouping by window and attribute causes java.lang.ClassCastException:&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9935&quot;&gt;&lt;del&gt;FLINK-9935&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix incorrect group field access in batch window combiner.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6423&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/AggregateUtil.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/AggregateUtil.scala&lt;br/&gt;
index 7ce44a6c834..a3c9c1e3f6a 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/AggregateUtil.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/AggregateUtil.scala&lt;br/&gt;
@@ -586,7 +586,7 @@ object AggregateUtil {&lt;br/&gt;
       isDistinctAggs,&lt;br/&gt;
       isStateBackedDataViews = false,&lt;br/&gt;
       partialResults = true,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;groupings,&lt;br/&gt;
+      groupings.indices.toArray,&lt;br/&gt;
       Some(aggregates.indices.map(_ + groupings.length).toArray),&lt;br/&gt;
       outputType.getFieldCount,&lt;br/&gt;
       needRetract,&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/GroupWindowITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/GroupWindowITCase.scala&lt;br/&gt;
index 3d9223e0953..2c984c16070 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/GroupWindowITCase.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/GroupWindowITCase.scala&lt;br/&gt;
@@ -97,6 +97,7 @@ class GroupWindowITCase(&lt;br/&gt;
     val table = env&lt;br/&gt;
       .fromCollection(data)&lt;br/&gt;
       .toTable(tEnv, &apos;long, &apos;int, &apos;double, &apos;float, &apos;bigdec, &apos;string)&lt;br/&gt;
+      .select(&apos;int, &apos;long, &apos;string) // keep this select to enforce that the &apos;string key comes last&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     val windowedTable = table&lt;br/&gt;
       .window(Tumble over 5.milli on &apos;long as &apos;w)&lt;br/&gt;
@@ -271,6 +272,7 @@ class GroupWindowITCase(&lt;br/&gt;
     val table = env&lt;br/&gt;
       .fromCollection(data)&lt;br/&gt;
       .toTable(tEnv, &apos;long, &apos;int, &apos;double, &apos;float, &apos;bigdec, &apos;string)&lt;br/&gt;
+      .select(&apos;int, &apos;long, &apos;string) // keep this select to enforce that the &apos;string key comes last&lt;/p&gt;

&lt;p&gt;     val windowedTable = table&lt;br/&gt;
       .window(Slide over 10.milli every 5.milli on &apos;long as &apos;w)&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3w7tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>