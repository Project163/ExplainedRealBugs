<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9028] flip6 should check config before starting cluster</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9028</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In flip6, we should perform parameters checking before starting cluster.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13146481">FLINK-9028</key>
            <summary>flip6 should check config before starting cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sihuazhou">Sihua Zhou</assignee>
                                    <reporter username="sihuazhou">Sihua Zhou</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Mar 2018 08:04:05 +0000</created>
                <updated>Wed, 21 Mar 2018 10:00:12 +0000</updated>
                            <resolved>Wed, 21 Mar 2018 10:00:12 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16405979" author="githubbot" created="Tue, 20 Mar 2018 09:06:40 +0000"  >&lt;p&gt;GitHub user sihuazhou opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;FLINK-FLINK-9028&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;flip6&amp;#93;&lt;/span&gt; perform parameters checking before starting cluster&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    Perform parameters checking before starting cluster to prevent to setup a problematic cluster.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;perform parameters checking before starting cluster&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is a trivial rework / code cleanup without any test coverage.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    no&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/sihuazhou/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/sihuazhou/flink&lt;/a&gt; flip6_check_parameter_before_start_cluster&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5726&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f65351b8b4530c37686fa8dcaae01df7accf66cc&lt;br/&gt;
Author: sihuazhou &amp;lt;summerleafs@...&amp;gt;&lt;br/&gt;
Date:   2018-03-20T07:59:33Z&lt;/p&gt;

&lt;p&gt;    perform parameters checking before starting cluster.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16405981" author="githubbot" created="Tue, 20 Mar 2018 09:07:20 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    CC: @tillrohrmann&lt;/p&gt;</comment>
                            <comment id="16406021" author="githubbot" created="Tue, 20 Mar 2018 09:38:16 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175701852&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175701852&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/cli/FlinkYarnSessionCli.java &amp;#8212;&lt;br/&gt;
    @@ -476,6 +477,11 @@ public ApplicationId getClusterId(CommandLine commandLine) {&lt;br/&gt;
     	public ClusterSpecification getClusterSpecification(CommandLine commandLine) throws FlinkException {&lt;br/&gt;
     		final Configuration effectiveConfiguration = applyCommandLineOptionsToConfiguration(commandLine);&lt;/p&gt;

&lt;p&gt;    +		// aim to check the parameters&lt;br/&gt;
    +		ContaineredTaskManagerParameters.create(&lt;br/&gt;
    +			effectiveConfiguration,&lt;br/&gt;
    +			effectiveConfiguration.getInteger(TaskManagerOptions.TASK_MANAGER_HEAP_MEMORY), 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think we should pull the verification logic out of the `ContaineredTaskManagerParameters#create` method and place it somewhere else. I would also suggest to move this check to `AbstractYarnClusterDescriptor#deployInternal` and use the provided `ClusterSpecification#getTaskManagerMemory` for the memory.&lt;/p&gt;</comment>
                            <comment id="16406078" author="githubbot" created="Tue, 20 Mar 2018 10:24:14 +0000"  >&lt;p&gt;Github user sihuazhou commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175715354&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175715354&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/cli/FlinkYarnSessionCli.java &amp;#8212;&lt;br/&gt;
    @@ -476,6 +477,11 @@ public ApplicationId getClusterId(CommandLine commandLine) {&lt;br/&gt;
     	public ClusterSpecification getClusterSpecification(CommandLine commandLine) throws FlinkException {&lt;br/&gt;
     		final Configuration effectiveConfiguration = applyCommandLineOptionsToConfiguration(commandLine);&lt;/p&gt;

&lt;p&gt;    +		// aim to check the parameters&lt;br/&gt;
    +		ContaineredTaskManagerParameters.create(&lt;br/&gt;
    +			effectiveConfiguration,&lt;br/&gt;
    +			effectiveConfiguration.getInteger(TaskManagerOptions.TASK_MANAGER_HEAP_MEMORY), 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    &#128077; I will pull it out and add a test to guard it.&lt;/p&gt;</comment>
                            <comment id="16406142" author="githubbot" created="Tue, 20 Mar 2018 11:06:14 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann I made a fixup according to your comments, could you please have a look again?&lt;/p&gt;</comment>
                            <comment id="16406274" author="githubbot" created="Tue, 20 Mar 2018 12:54:07 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175750782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175750782&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/AbstractYarnClusterDescriptor.java &amp;#8212;&lt;br/&gt;
    @@ -423,6 +431,9 @@ public void terminateCluster(ApplicationId applicationId) throws FlinkException&lt;br/&gt;
     			@Nullable JobGraph jobGraph,&lt;br/&gt;
     			boolean detached) throws Exception {&lt;/p&gt;

&lt;p&gt;    +		// ------------------ Check if configuration is valid --------------------&lt;br/&gt;
    +		checkConfig(clusterSpecification);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    let&apos;s not abbreviate and name it `validateClusterSpecification`&lt;/p&gt;</comment>
                            <comment id="16406275" author="githubbot" created="Tue, 20 Mar 2018 12:54:07 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175752251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175752251&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/AbstractYarnClusterDescriptor.java &amp;#8212;&lt;br/&gt;
    @@ -409,6 +411,12 @@ public void terminateCluster(ApplicationId applicationId) throws FlinkException&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	private void checkConfig(ClusterSpecification clusterSpecification) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This should throw a checked exception. Something like `InvalidConfigurationException` or so. But not just fail with an `IllegalStateException`.&lt;/p&gt;</comment>
                            <comment id="16406276" author="githubbot" created="Tue, 20 Mar 2018 12:54:07 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175753301&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175753301&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/ContaineredTaskManagerParameters.java &amp;#8212;&lt;br/&gt;
    @@ -112,35 +113,11 @@ public String toString() {&lt;br/&gt;
     	public static ContaineredTaskManagerParameters create(&lt;br/&gt;
     		Configuration config, long containerMemoryMB, int numSlots)&lt;br/&gt;
     	{&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// (1) compute how much memory we subtract from the total memory, to get the Java memory&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final float memoryCutoffRatio = config.getFloat(&lt;/li&gt;
	&lt;li&gt;ResourceManagerOptions.CONTAINERIZED_HEAP_CUTOFF_RATIO);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;final int minCutoff = config.getInteger(&lt;/li&gt;
	&lt;li&gt;ResourceManagerOptions.CONTAINERIZED_HEAP_CUTOFF_MIN);&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;if (memoryCutoffRatio &amp;gt;= 1 || memoryCutoffRatio &amp;lt;= 0) 
{
    -			throw new IllegalArgumentException(&quot;The configuration value &apos;&quot;
    -				+ ResourceManagerOptions.CONTAINERIZED_HEAP_CUTOFF_RATIO.key() + &quot;&apos; must be between 0 and 1. Value given=&quot;
    -				+ memoryCutoffRatio);
    -		}
&lt;p&gt;    -&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;if (minCutoff &amp;gt;= containerMemoryMB) 
{
    -			throw new IllegalArgumentException(&quot;The configuration value &apos;&quot;
    -				+ ResourceManagerOptions.CONTAINERIZED_HEAP_CUTOFF_MIN.key() + &quot;&apos;=&apos;&quot; + minCutoff
    -				+ &quot;&apos; is larger than the total container memory &quot; + containerMemoryMB);
    -		}
&lt;p&gt;    -&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;long cutoff = (long) (containerMemoryMB * memoryCutoffRatio);&lt;/li&gt;
	&lt;li&gt;if (cutoff &amp;lt; minCutoff) 
{
    -			cutoff = minCutoff;
    -		}
&lt;p&gt;    -&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;final long javaMemorySizeMB = containerMemoryMB - cutoff;&lt;br/&gt;
    +		// (1) try to compute how much memory used by container&lt;br/&gt;
    +		final long cutoffMB = ResourceManagerRuntimeServices.calculateCutoffMB(config, containerMemoryMB);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I would keep this method in the `ContaineredTaskManagerParameters` class.&lt;/p&gt;</comment>
                            <comment id="16406277" author="githubbot" created="Tue, 20 Mar 2018 12:54:07 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175752794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175752794&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/AbstractYarnClusterDescriptor.java &amp;#8212;&lt;br/&gt;
    @@ -409,6 +411,12 @@ public void terminateCluster(ApplicationId applicationId) throws FlinkException&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	private void checkConfig(ClusterSpecification clusterSpecification) {&lt;br/&gt;
    +		long taskManagerMemorySize = clusterSpecification.getTaskManagerMemoryMB();&lt;br/&gt;
    +		long cutoff = ResourceManagerRuntimeServices.calculateCutoffMB(flinkConfiguration, taskManagerMemorySize);&lt;br/&gt;
    +		TaskManagerServices.calculateHeapSizeMB(taskManagerMemorySize - cutoff, flinkConfiguration);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I somehow don&apos;t like that we calculate some value just in order to check whether an unchecked exception is thrown. This should be imo more explicit. Or at least it should get a comment explaining what&apos;s going on here.&lt;/p&gt;</comment>
                            <comment id="16406278" author="githubbot" created="Tue, 20 Mar 2018 12:54:07 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175750636&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175750636&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ResourceManagerRuntimeServicesTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,58 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.runtime.resourcemanager;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.configuration.ResourceManagerOptions;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests to guard &lt;/p&gt;
{@link ResourceManagerRuntimeServices}
&lt;p&gt;.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class ResourceManagerRuntimeServicesTest {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    missing `extends TestLogger`&lt;/p&gt;</comment>
                            <comment id="16406353" author="githubbot" created="Tue, 20 Mar 2018 13:53:45 +0000"  >&lt;p&gt;Github user sihuazhou commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726#discussion_r175772251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726#discussion_r175772251&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/AbstractYarnClusterDescriptor.java &amp;#8212;&lt;br/&gt;
    @@ -409,6 +411,12 @@ public void terminateCluster(ApplicationId applicationId) throws FlinkException&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	private void checkConfig(ClusterSpecification clusterSpecification) {&lt;br/&gt;
    +		long taskManagerMemorySize = clusterSpecification.getTaskManagerMemoryMB();&lt;br/&gt;
    +		long cutoff = ResourceManagerRuntimeServices.calculateCutoffMB(flinkConfiguration, taskManagerMemorySize);&lt;br/&gt;
    +		TaskManagerServices.calculateHeapSizeMB(taskManagerMemorySize - cutoff, flinkConfiguration);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Hmm...This is a bit tricky, the `calculation logic` is a bit hard to be separated from the `check logical` so clearly, because when we perform the checking we also need to do the calculation by the way. So pull the `check logical` from the `calculateFunction` to be a separated function means we will have some &lt;br/&gt;
    code duplication. So I&apos;d like to add a comment here, if you still think we should pull out a new function I would just do it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="16406388" author="githubbot" created="Tue, 20 Mar 2018 14:13:37 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann I have addressed your comments, could you please review it again.&lt;/p&gt;</comment>
                            <comment id="16406402" author="githubbot" created="Tue, 20 Mar 2018 14:26:13 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your contribution @sihuazhou. Changes look good to me. Merging this PR once Travis gave green light.&lt;/p&gt;</comment>
                            <comment id="16406465" author="githubbot" created="Tue, 20 Mar 2018 15:09:02 +0000"  >&lt;p&gt;Github user sihuazhou commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    ...found a checkstyle bug in my local built, I made a fixup.&lt;/p&gt;</comment>
                            <comment id="16406490" author="githubbot" created="Tue, 20 Mar 2018 15:19:30 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Have seen it as well and fixed it. So no worries.&lt;/p&gt;</comment>
                            <comment id="16407698" author="githubbot" created="Wed, 21 Mar 2018 09:59:10 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5726&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16407701" author="till.rohrmann" created="Wed, 21 Mar 2018 10:00:12 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
master:&lt;br/&gt;
38aa863d5a710b283b5c9b2eb9225d6fb9cc0c70&lt;br/&gt;
7c952dd3a75bc64d10bf9be12e405bbc349422b1&lt;/p&gt;

&lt;p&gt;1.5.0:&lt;br/&gt;
fecc19088b36fc4c8bca5ff39ba756f8fd111171&lt;br/&gt;
c6f91334b67d589f0c17ed75c9dbcbaedaf8ba51&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rj9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>