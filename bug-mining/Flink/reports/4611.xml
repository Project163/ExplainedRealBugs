<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:49:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19486] expected: class org.apache.flink.runtime.state.KeyGroupsStateHandle, but found: class org.apache.flink.runtime.state.IncrementalRemoteKeyedStateHandle</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19486</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;b&gt;The reason why I reopen it is that:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;I can &lt;font color=&quot;#de350b&quot;&gt;not&lt;/font&gt; &lt;font color=&quot;#de350b&quot;&gt;resume from incremental checkpoint manually&lt;/font&gt; when I stop the following program by force(maybe&#160; NOT supported officially?).&lt;/b&gt;&lt;/p&gt;



&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;My Experience&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;StateBackEnd&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;result&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Normal Checkpoint&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;FsStateBackend&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;succeed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Incremental Checkpoint&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;RocksDBStateBackend&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;failed&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;






&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;My Other Effort&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Content&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Result&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9312;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;b&gt;I &lt;font color=&quot;#de350b&quot;&gt;hava subscribed to mailing list&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;b&gt;David Anderson has answered this several days ago. But he did not tell me how I can fix it.&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;I guess he&apos;s very busy.&lt;/b&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9313;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;font color=&quot;#de350b&quot;&gt;stackoverflow account&lt;/font&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;my account is forbidden to ask questions.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9314;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;alibaba &lt;font color=&quot;#de350b&quot;&gt;Flink dingtalk group&lt;/font&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;no one can answer this question&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9315;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;I have read &lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-stable/ops/state/checkpoints.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;document&lt;/a&gt; carefully&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;I can NOT succeed in it&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9316;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;apologise for post it here&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;how can I make sure this question is a support instead of a bug or due to my own mistake?&lt;br/&gt;
no successful example in Google/Baidu,am I right?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9317;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;about less than 1000&#160; people visit my &lt;a href=&quot;https://yuchi.blog.csdn.net/article/details/108896441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;failure record&lt;/a&gt; about this experiment.&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;in vain&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;




&lt;p&gt;&#160;&lt;b&gt;Please help,thanks~&lt;/b&gt;&lt;/p&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;--------------------------------&lt;del&gt;original posting content&lt;/del&gt;--------------------------------&lt;/p&gt;

&lt;p&gt;&lt;b&gt;I want to do an experiment of&quot;incremental checkpoint&quot;&lt;/b&gt;&lt;/p&gt;




&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;information&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;content&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;pom.xml&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;[ is in the attachment]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;code&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://paste.ubuntu.com/p/DpTyQKq6Vk/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://paste.ubuntu.com/p/DpTyQKq6Vk/&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;error&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://paste.ubuntu.com/p/49HRYXFzR2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://paste.ubuntu.com/p/49HRYXFzR2/&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;




&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;some of the above error is:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Caused by: java.lang.IllegalStateException: Unexpected state handle type, expected: class org.apache.flink.runtime.state.KeyGroupsStateHandle, but found: class org.apache.flink.runtime.state.IncrementalRemoteKeyedStateHandle&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;



&lt;p&gt;The steps for incremental experiment are:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;step&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;content&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9312;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;mvn clean scala:compile compile package&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9313;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;nc -lk 9999&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9314;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;flink run -c wordcount_increstate&#160; datastream_api-1.0-SNAPSHOT.jar&lt;br/&gt;
Job has been submitted with JobID df6d62a43620f258155b8538ef0ddf1b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9315;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;input the following conents in nc -lk 9999&lt;br/&gt;
before&lt;br/&gt;
 error&lt;br/&gt;
 error&lt;br/&gt;
 error&lt;br/&gt;
 error&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#9316;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;flink run -s hdfs://Desktop:9000/tmp/flinkck/df6d62a43620f258155b8538ef0ddf1b/chk-22 -c StateWordCount datastream_api-1.0-SNAPSHOT.jar&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Then the above error happens.&lt;/p&gt;

&lt;p&gt;Please help,Thanks~!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13330374">FLINK-19486</key>
            <summary>expected: class org.apache.flink.runtime.state.KeyGroupsStateHandle, but found: class org.apache.flink.runtime.state.IncrementalRemoteKeyedStateHandle</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="appleyuchi">appleyuchi</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 1 Oct 2020 13:48:32 +0000</created>
                <updated>Wed, 7 Oct 2020 14:45:21 +0000</updated>
                            <resolved>Tue, 6 Oct 2020 09:22:22 +0000</resolved>
                                    <version>1.11.1</version>
                                                    <component>Runtime / Checkpointing</component>
                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17206026" author="aljoscha" created="Fri, 2 Oct 2020 08:14:00 +0000"  >&lt;p&gt;This issue tracking system is for tracking bugs or new developments. Please use the Mailing lists to ask questions: &lt;a href=&quot;https://flink.apache.org/community.html#mailing-lists&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://flink.apache.org/community.html#mailing-lists&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17208545" author="aljoscha" created="Tue, 6 Oct 2020 07:53:11 +0000"  >&lt;p&gt;Ah, could it be that you&apos;re trying to restore a savepoint that was taken using RocksDB in the &lt;tt&gt;FsStateBackend&lt;/tt&gt;. It looks like it from the stacktrace that you posted. That is not expected to work.&lt;/p&gt;</comment>
                            <comment id="17208569" author="appleyuchi" created="Tue, 6 Oct 2020 08:37:06 +0000"  >&lt;p&gt;Thanks for your replies.&lt;br/&gt;
There are two possibilities that I&apos;m wrong:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;the step I&apos;m Wrong&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;what I have done&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Wrong in the code&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;set RocksDBStateBackend in code as the official document said&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;wrong in command&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;the command I use is almost the same as Resuming from savepoint&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I have pushed the whole wordcount experiment to my github.&lt;br/&gt;
&lt;a href=&quot;https://github.com/appleyuchi/wrongcheckpoint&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/appleyuchi/wrongcheckpoint&lt;/a&gt;&lt;/p&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;my experiment&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;my status&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Normal checkpoint&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Success&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Incremental checkpoint&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Failure&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I really don&apos;t know where I did set two different statebackends which caused this error.&lt;br/&gt;
I only set it in my code.&lt;/p&gt;




&lt;p&gt;*I have just got email from Mr Anderson&lt;br/&gt;
If I solve it,I&apos;ll close this issue here.&lt;/p&gt;

&lt;p&gt;If I did got from Mr.Anderson for days,I may trouble you again.*&lt;/p&gt;


&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17208591" author="aljoscha" created="Tue, 6 Oct 2020 09:10:46 +0000"  >&lt;p&gt;Setting the RocksDB backend in code will override anything you specify in the command.&lt;/p&gt;

&lt;p&gt;It seems that you took the savepoint using RocksDB and are then restoring with the &lt;tt&gt;FsStateBackend&lt;/tt&gt;. That will not work.&lt;/p&gt;</comment>
                            <comment id="17208594" author="appleyuchi" created="Tue, 6 Oct 2020 09:13:16 +0000"  >&lt;p&gt;I think the  meaning of &quot;restoring with the FsStateBackend&quot; is:&lt;br/&gt;
My Command is wrong.&lt;br/&gt;
um...what&apos;s the right command?&lt;br/&gt;
or I copied the wrong checkpoint from WEB UI?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17208596" author="aljoscha" created="Tue, 6 Oct 2020 09:15:37 +0000"  >&lt;p&gt;In &lt;a href=&quot;https://github.com/appleyuchi/wrongcheckpoint/blob/master/src/main/scala/wordcount_increstate.scala&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/appleyuchi/wrongcheckpoint/blob/master/src/main/scala/wordcount_increstate.scala&lt;/a&gt; you set the &lt;tt&gt;RocksDBStateBackend&lt;/tt&gt;, in &lt;a href=&quot;https://github.com/appleyuchi/wrongcheckpoint/blob/master/src/main/scala/StateWordCount.scala&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/appleyuchi/wrongcheckpoint/blob/master/src/main/scala/StateWordCount.scala&lt;/a&gt; you set the &lt;tt&gt;FsStateBackend&lt;/tt&gt;. This will not work because the RocksDB savepoint is not compatible.&lt;/p&gt;</comment>
                            <comment id="17208601" author="appleyuchi" created="Tue, 6 Oct 2020 09:21:48 +0000"  >&lt;p&gt;My mistake,&lt;br/&gt;
I write checkpoint from experiment 1&lt;br/&gt;
and resume checkpoint from experiment 2.&lt;/p&gt;

&lt;p&gt;Thanks for your help.~&lt;/p&gt;</comment>
                            <comment id="17208641" author="aljoscha" created="Tue, 6 Oct 2020 10:28:38 +0000"  >&lt;p&gt;I&apos;ve created a PR that makes the exception message more helpful.&lt;/p&gt;</comment>
                            <comment id="17209593" author="aljoscha" created="Wed, 7 Oct 2020 14:45:21 +0000"  >&lt;p&gt;Exception message improved:&lt;br/&gt;
master: ab230345322a09669d54333cc9fa07af99492f21&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13013024" name="pom.xml" size="2731" author="appleyuchi" created="Tue, 6 Oct 2020 02:59:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0j308:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>