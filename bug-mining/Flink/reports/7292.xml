<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:18:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-33610] CoGroupTaskTest.testCancelCoGroupTaskWhileCoGrouping failed with an AssertionError</title>
                <link>https://issues.apache.org/jira/browse/FLINK-33610</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=54741&amp;amp;view=logs&amp;amp;j=675bf62c-8558-587e-2555-dcad13acefb5&amp;amp;t=5878eed3-cc1e-5b12-1ed0-9e7139ce0992&amp;amp;l=7690&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=54741&amp;amp;view=logs&amp;amp;j=675bf62c-8558-587e-2555-dcad13acefb5&amp;amp;t=5878eed3-cc1e-5b12-1ed0-9e7139ce0992&amp;amp;l=7690&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 Nov 21 01:07:49 01:07:49.733 [ERROR] Tests run: 18, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 6.204 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.runtime.operators.CoGroupTaskTest
Nov 21 01:07:49 01:07:49.733 [ERROR] org.apache.flink.runtime.operators.CoGroupTaskTest.testCancelCoGroupTaskWhileCoGrouping  Time elapsed: 1.01 s  &amp;lt;&amp;lt;&amp;lt; FAILURE!
Nov 21 01:07:49 java.lang.AssertionError: Test threw an exception even though it was properly canceled.
Nov 21 01:07:49 	at org.apache.flink.runtime.operators.CoGroupTaskTest.testCancelCoGroupTaskWhileCoGrouping(CoGroupTaskTest.java:448)
Nov 21 01:07:49 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
Nov 21 01:07:49 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
Nov 21 01:07:49 	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
Nov 21 01:07:49 	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
[...]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13558887">FLINK-33610</key>
            <summary>CoGroupTaskTest.testCancelCoGroupTaskWhileCoGrouping failed with an AssertionError</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jiabao.sun">jiabao.sun</assignee>
                                    <reporter username="mapohl">Matthias Pohl</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Tue, 21 Nov 2023 15:02:40 +0000</created>
                <updated>Thu, 23 Nov 2023 13:06:08 +0000</updated>
                            <resolved>Thu, 23 Nov 2023 13:06:08 +0000</resolved>
                                    <version>1.19.0</version>
                                    <fixVersion>1.19.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17788459" author="mapohl" created="Tue, 21 Nov 2023 15:32:25 +0000"  >&lt;p&gt;It&apos;s hard to grasp what the actual error is. The tests in this class should be improved: The exception that&apos;s caught should be stored in an &lt;tt&gt;AtomicReference&lt;/tt&gt; instead of only storing the fact that an exception was caught. The &lt;tt&gt;printStacktrace&lt;/tt&gt; is not provided anywhere in the logs.&lt;/p&gt;</comment>
                            <comment id="17788613" author="jiabao.sun" created="Wed, 22 Nov 2023 03:45:06 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.NullPointerException: Cannot invoke &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.flink.runtime.operators.util.CoGroupTaskIterator.close()&quot;&lt;/span&gt; because &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.coGroupIterator&quot;&lt;/span&gt; is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
at org.apache.flink.runtime.operators.CoGroupDriver.cleanup(CoGroupDriver.java:185)
at org.apache.flink.runtime.operators.testutils.DriverTestBase.testDriverInternal(DriverTestBase.java:270)
at org.apache.flink.runtime.operators.testutils.DriverTestBase.testDriver(DriverTestBase.java:195)
at org.apache.flink.runtime.operators.CoGroupTaskTest.access$200(CoGroupTaskTest.java:45)
at org.apache.flink.runtime.operators.CoGroupTaskTest$3.run(CoGroupTaskTest.java:427)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CoGroupDriver.cleanup() methods will run out of NPE in the case of concurrent calling:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TaskCancelThread -&amp;gt; cleanup()&lt;/li&gt;
	&lt;li&gt;taskRunner -&amp;gt; testDriver() -&amp;gt; testDriverInternal() -&amp;gt; finally cleanup();&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void cleanup() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.coGroupIterator != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.coGroupIterator.close();
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.coGroupIterator = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&#160; &#160; }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m willing to fix this problem.&lt;/p&gt;</comment>
                            <comment id="17788682" author="mapohl" created="Wed, 22 Nov 2023 09:32:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The printStacktrace is not provided anywhere in the logs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ah, thanks for having another look. Indeed, the &lt;tt&gt;printStacktrace&lt;/tt&gt; isn&apos;t swallowed.&lt;/p&gt;</comment>
                            <comment id="17789123" author="mapohl" created="Thu, 23 Nov 2023 13:06:08 +0000"  >&lt;p&gt;master: &lt;a href=&quot;https://github.com/apache/flink/commit/fa93d4fac9fd53f5fdf5a54fdfe7dfa7832f6262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fa93d4fac9fd53f5fdf5a54fdfe7dfa7832f6262&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1lr8g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>