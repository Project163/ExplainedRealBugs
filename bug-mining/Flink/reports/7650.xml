<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:21:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-36124] S3RecoverableFsDataOutputStream.sync closes the stream and further write operations throw exception</title>
                <link>https://issues.apache.org/jira/browse/FLINK-36124</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;This behaviour is introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-28513&quot; title=&quot;Flink Table API CSV streaming sink throws SerializedThrowable exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-28513&quot;&gt;&lt;del&gt;FLINK-28513&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Rationale why I think it&apos;s a bug:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;`sync` method is defined in `FSDataOutputStream` with the following definition:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**
     * Flushes the data all the way to the persistent non-&lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; storage (&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; example disks). The
     * method behaves similar to the &amp;lt;i&amp;gt;fsync&amp;lt;/i&amp;gt; function, forcing all data to be persistent on the
     * devices.
     *
     * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException Thrown &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; an I/O error occurs
     */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;In case `sync` method call user of the writer instance is expected to call further `write` methods&lt;/li&gt;
	&lt;li&gt;What is actually happening it&apos;s blowing up the next write with the following exception:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.io.IOException: Stream closed.

	at org.apache.flink.core.fs.RefCountedFileWithStream.requireOpened(RefCountedFileWithStream.java:72)
	at org.apache.flink.core.fs.RefCountedFileWithStream.write(RefCountedFileWithStream.java:52)
	at org.apache.flink.core.fs.RefCountedBufferingFileStream.flush(RefCountedBufferingFileStream.java:104)
	at org.apache.flink.core.fs.RefCountedBufferingFileStream.write(RefCountedBufferingFileStream.java:87)
	at org.apache.flink.fs.s3.common.writer.S3RecoverableFsDataOutputStream.write(S3RecoverableFsDataOutputStream.java:112)
	at java.base/java.io.OutputStream.write(OutputStream.java:122)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;This can be super easily tested with `S3RecoverableFsDataOutputStreamTest.testSync`. Please remove the `expected = Exception.class` from the beginning of the test.&lt;/li&gt;
	&lt;li&gt;The following line in the test is testing nothing because never ever called: &lt;a href=&quot;https://github.com/apache/flink/blob/56c81995d3b34ed9066b6771755407b93438f5ab/flink-filesystems/flink-s3-fs-base/src/test/java/org/apache/flink/fs/s3/common/writer/S3RecoverableFsDataOutputStreamTest.java#L264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/56c81995d3b34ed9066b6771755407b93438f5ab/flink-filesystems/flink-s3-fs-base/src/test/java/org/apache/flink/fs/s3/common/writer/S3RecoverableFsDataOutputStreamTest.java#L264&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13589598">FLINK-36124</key>
            <summary>S3RecoverableFsDataOutputStream.sync closes the stream and further write operations throw exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gaborgsomogyi">Gabor Somogyi</assignee>
                                    <reporter username="gaborgsomogyi">Gabor Somogyi</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 21 Aug 2024 11:59:01 +0000</created>
                <updated>Sat, 12 Oct 2024 09:04:34 +0000</updated>
                            <resolved>Sat, 12 Oct 2024 09:04:24 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Connectors / AWS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17888844" author="gaborgsomogyi" created="Sat, 12 Oct 2024 09:04:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/commit/025a5039ac197380d131ca409cfc7cb5a682b584&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;025a503&lt;/tt&gt;&lt;/a&gt; on master&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qzn4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>