<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:21:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2861] Fields grouping on split streams fails</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2861</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Using split streams works for shuffle grouping, but not for Fields grouping.&lt;/p&gt;

&lt;p&gt;The reason is that the KeySelector expects an array, and the given type is the &lt;tt&gt;SplitStreamType&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12905523">FLINK-2861</key>
            <summary>Fields grouping on split streams fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mjsax">Matthias J. Sax</assignee>
                                    <reporter username="sewen">Stephan Ewen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Oct 2015 13:17:20 +0000</created>
                <updated>Tue, 24 Nov 2015 12:34:34 +0000</updated>
                            <resolved>Tue, 24 Nov 2015 12:34:34 +0000</resolved>
                                    <version>0.10.0</version>
                                                    <component>Legacy Components / Storm Compatibility</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15013950" author="githubbot" created="Thu, 19 Nov 2015 17:19:15 +0000"  >&lt;p&gt;GitHub user mjsax opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2861&quot; title=&quot;Fields grouping on split streams fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2861&quot;&gt;&lt;del&gt;FLINK-2861&lt;/del&gt;&lt;/a&gt; Fields grouping on split streams fails&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mjsax/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mjsax/flink&lt;/a&gt; flink-2861-fieldsGrouping-SplitStream&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1387&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f31c895f38678a5b393d74fc52064d3c4844f5de&lt;br/&gt;
Author: mjsax &amp;lt;mjsax@informatik.hu-berlin.de&amp;gt;&lt;br/&gt;
Date:   2015-11-06T10:51:31Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2861&quot; title=&quot;Fields grouping on split streams fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2861&quot;&gt;&lt;del&gt;FLINK-2861&lt;/del&gt;&lt;/a&gt; Fields grouping on split streams fails&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15013956" author="githubbot" created="Thu, 19 Nov 2015 17:21:45 +0000"  >&lt;p&gt;Github user mjsax commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158126101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158126101&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    In `FlinkTopologyBuilder` I had to introduce a &lt;b&gt;token&lt;/b&gt; for operator names which is used in `WrapperSetupHelper` to get the original name of an operator (Flink changes operator names when chaining happens). This is quite hacky. If anybody has a better idea how to solve this, please let me know.&lt;/p&gt;</comment>
                            <comment id="15018087" author="githubbot" created="Fri, 20 Nov 2015 14:31:07 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158416101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158416101&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I ran into that issue a while back. The problem was that you emit elements that have the name/tag of the split stream (to use the split selector) and over that, you run the regular partitioner.&lt;/p&gt;

&lt;p&gt;    Splitting this into two steps should work: Splitting, having a mapper that removes the &quot;split tag&quot; and then doing the field partitioning.&lt;/p&gt;

&lt;p&gt;    Would be nice to make this nice in Flink, but it is tricky. Not all functions go though a collector, and not all collectors can split.&lt;/p&gt;</comment>
                            <comment id="15018885" author="githubbot" created="Fri, 20 Nov 2015 22:02:43 +0000"  >&lt;p&gt;Github user mjsax commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158538063&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158538063&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I don&apos;t understand you comment? What you describe is exactly how it works (even before this PR). The problem was actually just a missing `TypeInformation` I added here... However, I introduced this `token` into the name of an operator here, because the `.select(...).map(...)` get chained which alters the operator name and I need the original name later on in `WrapperSetupHelper` &amp;#8211; this part is &quot;hacky&quot;. But I am not sure if there is a better solution to it. Look for the new variable `FlinkTopologyBuilder.token`.&lt;/p&gt;</comment>
                            <comment id="15018888" author="githubbot" created="Fri, 20 Nov 2015 22:03:50 +0000"  >&lt;p&gt;Github user mjsax commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158538344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158538344&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Btw: Travis fails due to a instable test &amp;#8211; I already create a JIRA for it.&lt;/p&gt;</comment>
                            <comment id="15021013" author="githubbot" created="Sun, 22 Nov 2015 14:14:22 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#discussion_r45559371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#discussion_r45559371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-contrib/flink-storm/src/main/java/org/apache/flink/storm/wrappers/BoltWrapper.java &amp;#8212;&lt;br/&gt;
    @@ -209,12 +209,8 @@ public void open() throws Exception {&lt;br/&gt;
     		super.open();&lt;/p&gt;

&lt;p&gt;     		this.flinkCollector = new TimestampedCollector&amp;lt;OUT&amp;gt;(output);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;OutputCollector stormCollector = null;&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;if (this.numberOfAttributes.size() &amp;gt; 0) 
{
    -			stormCollector = new OutputCollector(new BoltCollector&amp;lt;OUT&amp;gt;(
    -					this.numberOfAttributes, flinkCollector));
    -		}
&lt;p&gt;    +		final OutputCollector stormCollector = new OutputCollector(new BoltCollector&amp;lt;OUT&amp;gt;(&lt;br/&gt;
    +				this.numberOfAttributes, flinkCollector));&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes, I fixed that in my code base as well...&lt;/p&gt;</comment>
                            <comment id="15021034" author="githubbot" created="Sun, 22 Nov 2015 15:07:00 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#discussion_r45559955&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#discussion_r45559955&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-contrib/flink-storm/src/main/java/org/apache/flink/storm/wrappers/WrapperSetupHelper.java &amp;#8212;&lt;br/&gt;
    @@ -118,6 +119,11 @@ static synchronized TopologyContext createTopologyContext(&lt;br/&gt;
     			// prefix &quot;Source: &quot; is inserted by Flink sources by default &amp;#8211; need to get rid of it here&lt;br/&gt;
     			operatorName = operatorName.substring(8);&lt;br/&gt;
     		}&lt;br/&gt;
    +		final int idx = operatorName.indexOf(FlinkTopologyBuilder.token);&lt;br/&gt;
    +		if (idx != -1) {&lt;br/&gt;
    +			// in case of operator chaining Flink alters the name &amp;#8211; need to get rir of it here&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Typo: &quot;rid&quot;&lt;/p&gt;</comment>
                            <comment id="15021037" author="githubbot" created="Sun, 22 Nov 2015 15:10:43 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158765658&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158765658&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Maybe a stupid question but why don&apos;t you send the operator name along with the BoltWrapper? Then there is no need to extract it from the Flink task name.&lt;/p&gt;</comment>
                            <comment id="15022157" author="githubbot" created="Mon, 23 Nov 2015 14:33:24 +0000"  >&lt;p&gt;Github user mjsax commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-158952162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-158952162&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    That&apos;s  actually not a stupid question. I did not do it in the first place to avoid &quot;redundant&quot; code (I was not aware that Flink changes names). I just changed it to your suggestion. If Travis passed, I would merge this. Or are there any objections?&lt;/p&gt;</comment>
                            <comment id="15024220" author="githubbot" created="Tue, 24 Nov 2015 10:33:33 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-159224189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-159224189&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @mjsax Okay, I probably misread the original code. I thought the `map()` that drops the tag was not there...&lt;/p&gt;</comment>
                            <comment id="15024235" author="githubbot" created="Tue, 24 Nov 2015 10:44:41 +0000"  >&lt;p&gt;Github user mjsax commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-159226912&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-159226912&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen In the original code that was actually the case. The `BoltWrapper` receiving the data was able to extract the tuples by itself. This got changed as I introduces proper generic types in `FlinkTopologyBuilder`.&lt;/p&gt;

&lt;p&gt;    Merging this now...&lt;/p&gt;</comment>
                            <comment id="15024246" author="githubbot" created="Tue, 24 Nov 2015 10:49:20 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387#issuecomment-159227726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387#issuecomment-159227726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ah, okay, so I skipped a version by accident &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I think that original change could not quite have worked, as it would have propagated the wrong TypeInfos to the ArrayKeySelector and OutputSerializer. The one with `map()` looks good...&lt;/p&gt;</comment>
                            <comment id="15024417" author="githubbot" created="Tue, 24 Nov 2015 12:33:28 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1387&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1387&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15024419" author="mjsax" created="Tue, 24 Nov 2015 12:34:21 +0000"  >&lt;p&gt;Fixed via 4c46b2feee2c1ecda21e5ba62d02dfd7df73e256&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2n48v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>