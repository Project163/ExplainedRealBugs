<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:42:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15093] StreamExecutionEnvironment does not clear transformations when executing</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15093</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>

&lt;p&gt;Use the following code in scala shell to reproduce this issue.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

val data = senv.fromElements(&lt;span class=&quot;code-quote&quot;&gt;&quot;hello world&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;hello flink&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;hello hadoop&quot;&lt;/span&gt;)
data.flatMap(line =&amp;gt; line.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\s&quot;&lt;/span&gt;)).
    map(w =&amp;gt; (w, 1)).
    keyBy(0).
    sum(1).
    print

senv.execute()

data.flatMap(line =&amp;gt; line.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\s&quot;&lt;/span&gt;)).
    map(w =&amp;gt; (w, 1)).
    keyBy(0).
    sum(1).
    print

senv.execute()

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13272691">FLINK-15093</key>
            <summary>StreamExecutionEnvironment does not clear transformations when executing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="danny0405">Danny Chen</assignee>
                                    <reporter username="zjffdu">Jeff Zhang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 6 Dec 2019 08:50:57 +0000</created>
                <updated>Tue, 10 Dec 2019 14:41:17 +0000</updated>
                            <resolved>Tue, 10 Dec 2019 14:39:53 +0000</resolved>
                                    <version>1.10.0</version>
                                    <fixVersion>1.10.0</fixVersion>
                                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16989535" author="zjffdu" created="Fri, 6 Dec 2019 08:52:04 +0000"  >&lt;p&gt;\cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ykt836&quot; class=&quot;user-hover&quot; rel=&quot;ykt836&quot;&gt;ykt836&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16989540" author="ykt836" created="Fri, 6 Dec 2019 08:56:25 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkloudas&quot; class=&quot;user-hover&quot; rel=&quot;kkloudas&quot;&gt;kkloudas&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16989543" author="ykt836" created="Fri, 6 Dec 2019 09:00:21 +0000"  >&lt;p&gt;It&apos;s similar with&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13708&quot; title=&quot;Transformations should be cleared because a table environment could execute multiple job&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13708&quot;&gt;&lt;del&gt;FLINK-13708&lt;/del&gt;&lt;/a&gt;, but I don&apos;t think it&apos;s the same problem. You don&apos;t even use table API in this example.&#160;&lt;/p&gt;</comment>
                            <comment id="16989586" author="jark" created="Fri, 6 Dec 2019 09:45:54 +0000"  >&lt;p&gt;I changed the component to DataStream, as it is not a problem of Table API.&lt;/p&gt;</comment>
                            <comment id="16989609" author="ykt836" created="Fri, 6 Dec 2019 10:18:51 +0000"  >&lt;p&gt;We also met similar problem in sql client:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-15052&quot; title=&quot;Test transformation.clear() in sqlClient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-15052&quot;&gt;&lt;del&gt;FLINK-15052&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think the reason is we didn&apos;t clear the buffered transformation in `StreamExecutionEnvironment`. Currently, both sql client and `StreamExecutionEnvironment#execute()` will get `StreamGraph` first and try to execute the `StreamGraph`.&#160;&lt;/p&gt;

&lt;p&gt;Does it make sense to have an extra boolean flag to indicate whether we want to also clear transformations when getting `StreamGraph`? Just like `ExecutionEnvironment#createProgramPlan(String jobName, boolean clearSinks)` did.&#160;&lt;/p&gt;</comment>
                            <comment id="16989745" author="aljoscha" created="Fri, 6 Dec 2019 13:16:22 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ykt836&quot; class=&quot;user-hover&quot; rel=&quot;ykt836&quot;&gt;ykt836&lt;/a&gt; is right, we can add a &lt;tt&gt;clearTransforms&lt;/tt&gt; parameter.&lt;/p&gt;</comment>
                            <comment id="16989750" author="aljoscha" created="Fri, 6 Dec 2019 13:22:16 +0000"  >&lt;p&gt;Anyone wanna cut a PR?&lt;/p&gt;</comment>
                            <comment id="16989782" author="danny0405" created="Fri, 6 Dec 2019 13:54:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; I can do that ~&lt;/p&gt;</comment>
                            <comment id="16992609" author="kkl0u" created="Tue, 10 Dec 2019 14:39:53 +0000"  >&lt;p&gt;Merged on master with&#160;9c44413a805d6d0d809fe2d497c84a3f653f4337&lt;/p&gt;

&lt;p&gt;and on 1.10 with&#160;9a15733e22fc4c88e6563e9f96f78f88dc0aafca&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12987682" name="screenshot-1.png" size="70947" author="zjffdu" created="Fri, 6 Dec 2019 08:57:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09d20:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>