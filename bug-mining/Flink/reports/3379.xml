<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:41:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-14074] MesosResourceManager can&apos;t create new taskmanagers in Session Cluster Mode.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-14074</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hi, I&apos;m trying to launch multiple jobs in Flink Session Cluster, deployed on mesos.&lt;br/&gt;
 Flink&apos;s version is 1.9.0.&lt;/p&gt;

&lt;p&gt;The very first resource allocation completes successfully, and first submitted job launches, but submitting any amount of jobs afterwords doesn&apos;t affect the cluster in any way and no additional TaskManagers are allocated.&lt;/p&gt;

&lt;p&gt;From the logs I see that MesosResourceManager is requesting Slots for the newly submitted jobs:&#160;&#160;&quot;&lt;tt&gt;o.a.f.m.r.c.MesosResourceManager - Request slot with profile ResourceProfile...&quot;&lt;/tt&gt; but line&#160;&lt;tt&gt;&quot;Starting a new worker.&lt;/tt&gt;&quot;&#160;appears in log only the same amount of times as taskmanagers count, allocated for the first job.&lt;/p&gt;

&lt;p&gt;I&apos;m a complete noob in flink internals, but took a wild guess about a reason. I think that the problem is in this check:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It might be that RM is lazily allocated at the first call by a factory, and then a private final field &lt;tt&gt;slotsPerWorker&lt;/tt&gt; is set. So this check will prevent&#160;creation of any new worker after iterator traverses the entire collection. My main assumption is that&#160;&lt;tt&gt;slotsPerWorker&lt;/tt&gt; is never modified again.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m sorry that I didn&apos;t do much of investigation before reporting, but I&apos;ll try to do some&#160;after a weekend. I plan to build flink without this check and see if it helps. Also I&apos;ll play around with tests for this RM. Since it&apos;s my time running time flink internals, I&apos;ll be back after a few days.&lt;/p&gt;

&lt;p&gt;Any help will much appreciated.&lt;/p&gt;

&lt;p&gt;Thanks in advance.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Flink HA Session cluster 1.9.0 on mesos.&lt;/p&gt;</environment>
        <key id="13256478">FLINK-14074</key>
            <summary>MesosResourceManager can&apos;t create new taskmanagers in Session Cluster Mode.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="Atlaster">Alexander Kasyanenko</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 13 Sep 2019 08:46:38 +0000</created>
                <updated>Thu, 31 Oct 2019 13:01:43 +0000</updated>
                            <resolved>Thu, 31 Oct 2019 13:01:43 +0000</resolved>
                                    <version>1.9.0</version>
                    <version>1.10.0</version>
                                    <fixVersion>1.9.2</fixVersion>
                    <fixVersion>1.10.0</fixVersion>
                                    <component>Deployment / Mesos</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16929092" author="till.rohrmann" created="Fri, 13 Sep 2019 10:28:58 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Atlaster&quot; class=&quot;user-hover&quot; rel=&quot;Atlaster&quot;&gt;Atlaster&lt;/a&gt;, this sounds indeed like a bug. The strange thing is that the check should only fail if the request &lt;tt&gt;resourceProfile&lt;/tt&gt; does not match the &lt;tt&gt;ResourceProfile&lt;/tt&gt; in &lt;tt&gt;slotsPerWorker&lt;/tt&gt;. At the moment all workers are being started with the same &lt;tt&gt;ResourceProfile&lt;/tt&gt; based on the configured number of slots and the total &lt;tt&gt;TaskManager&lt;/tt&gt; memory. Moreover, the slot request should always set the required &lt;tt&gt;ResourceProfile&lt;/tt&gt; to &lt;tt&gt;ResourceProfile.UNKNOWN&lt;/tt&gt; which should match any other &lt;tt&gt;ResourceProfile&lt;/tt&gt; instance.&lt;/p&gt;

&lt;p&gt;Hence my question would be what kind of &lt;tt&gt;ResourceProfiles&lt;/tt&gt; are the slot requests asking for? It should be visible in the &lt;tt&gt;jobmanager.log&lt;/tt&gt; file on INFO level. The statement looks like &lt;tt&gt;&quot;Requesting new slot &lt;span class=&quot;error&quot;&gt;&amp;#91;{}&amp;#93;&lt;/span&gt; and profile {} from resource manager&quot;&lt;/tt&gt;. Maybe you could also share the logs with us so that I could take a look as well.&lt;/p&gt;

&lt;p&gt;You are right that &lt;tt&gt;slotsPerWorker&lt;/tt&gt; should never be modified after its creation. It acts as a template for every &lt;tt&gt;TaskManager&apos;s&lt;/tt&gt; set of slots with which it is started.&lt;/p&gt;</comment>
                            <comment id="16929193" author="atlaster" created="Fri, 13 Sep 2019 13:31:23 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, thanks for replying.&lt;br/&gt;
All &lt;tt&gt;ResourceProfiles&lt;/tt&gt;&#160;for requested slots are of &lt;tt&gt;UNKNOWN&lt;/tt&gt; type:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;ResourceProfile{cpuCores=-1.0, heapMemoryInMB=-1, directMemoryInMB=-1, nativeMemoryInMB=-1, networkMemoryInMB=-1, managedMemoryInMB=-1&lt;/tt&gt;}&lt;/p&gt;

&lt;p&gt;Sorry, can&apos;t share log at the moment, but if you want, I can prepare an example log next week.&lt;/p&gt;</comment>
                            <comment id="16929494" author="till.rohrmann" created="Fri, 13 Sep 2019 19:51:52 +0000"  >&lt;p&gt;This is strange, because &lt;tt&gt;UNKNOWN&lt;/tt&gt; should match with every slot. Hence one should never return &lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L437&lt;/a&gt;. Really curious what the problem here is.&lt;/p&gt;

&lt;p&gt;If you manage to produce an example log, then this would help a lot with understanding the problem better.&lt;/p&gt;</comment>
                            <comment id="16932426" author="atlaster" created="Wed, 18 Sep 2019 13:07:27 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, I&apos;m sorry for the delay on my end. I was able to look into this issue only today.&lt;/p&gt;

&lt;p&gt;Firstly, I&apos;ve prepared example logs, but I need this log to be validated (still in progress), so I can share it outside of company.&lt;/p&gt;

&lt;p&gt;But anyway, I&apos;ve built flink with extended logging and found out some interesting things.&lt;br/&gt;
 1. This check:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L436&lt;/a&gt; has nothing to do with the problem, it isn&apos;t even called after the first job is cancelled/completed.&lt;/p&gt;

&lt;p&gt;2. Last thing which happens during new slot allocation is this slot request submitted here:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java#L437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java#L437&lt;/a&gt;, which I traced to method&#160;&lt;tt&gt;internalRequestSlot&lt;/tt&gt;&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L750&lt;/a&gt;&#160;but method&#160;&lt;tt&gt;allocateResource&lt;/tt&gt; was never called:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L795&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Right now I&apos;m adding even more logging to see what is blocking slot allocation. I&apos;ll keep you posted, but as an update, I&apos;m leaning towards some&#160;problems with pending slots.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;UPD. I&apos;ve rerun my test-case one more time and been able to locate possible problem even further. For some reason when first job is completed or cancelled, it still leaves pending slots behind, even if UI shows 0 total task slots. So when the next job is submitted, it is successfully getting a slot here:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L779&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L779&lt;/a&gt;&#160;(because &lt;tt&gt;pendingSlots&lt;/tt&gt;&#160;map is not empty) and&#160;acquiring it here:&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L814&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L814&lt;/a&gt;&#160;. But since mesos worker are already stopped this slot acquiring freezes job execution and every task ends up in SCHEDULED state. &lt;br/&gt;
Since I haven&apos;t been able to find a place where&#160;&lt;tt&gt;pendingSlots&lt;/tt&gt; map is cleaned after a worker shutdown,&#160;&#160;I think that might be a reason for such behaviour.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;&#160;, any ideas here?&lt;/p&gt;</comment>
                            <comment id="16932634" author="till.rohrmann" created="Wed, 18 Sep 2019 16:38:06 +0000"  >&lt;p&gt;Thanks a lot for looking into the problem in more depth &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Atlaster&quot; class=&quot;user-hover&quot; rel=&quot;Atlaster&quot;&gt;Atlaster&lt;/a&gt;. In the &lt;tt&gt;YarnResourceManager&lt;/tt&gt; we always check whether a new container needs to be started if a container/task stops or cannot get started via: &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java#L510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java#L510&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Since we restart failed Mesos tasks in &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/MesosResourceManager.java#L668&lt;/a&gt; the only way I can think of how we could &quot;lose&quot; Mesos tasks is at start up which is not reported or maybe there is a problem with the matching of pending slots &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L594&lt;/a&gt;. For the latter problem it would be interesting to see with which slot profile the &lt;tt&gt;TaskManagers&lt;/tt&gt; are being started and which profile the slots report when they register.&lt;/p&gt;</comment>
                            <comment id="16933121" author="till.rohrmann" created="Thu, 19 Sep 2019 07:14:29 +0000"  >&lt;p&gt;So maybe it is the same problem as with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13241&quot; title=&quot;YarnResourceManager does not handle slot allocations in certain cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13241&quot;&gt;&lt;del&gt;FLINK-13241&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16933284" author="atlaster" created="Thu, 19 Sep 2019 11:13:45 +0000"  >&lt;p&gt;Yeah, looks suspiciously similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13241&quot; title=&quot;YarnResourceManager does not handle slot allocations in certain cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13241&quot;&gt;&lt;del&gt;FLINK-13241&lt;/del&gt;&lt;/a&gt;. I&apos;ll try to look into this similarity.&lt;/p&gt;

&lt;p&gt;I&apos;ll add a little bit of info about my test-case: &lt;br/&gt;
I deploy a simple word-count job, then wait for its completion, which results in something like this:&#160;&lt;a href=&quot;https://gist.github.com/Atlaster/c4ebc39e02006c2fe4daf6fedcb22481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/Atlaster/c4ebc39e02006c2fe4daf6fedcb22481&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m logging method names and a little bit extra like this:&#160;&lt;a href=&quot;https://gist.github.com/Atlaster/1a50229e62cc710ebcac2734b98e0f32&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/Atlaster/1a50229e62cc710ebcac2734b98e0f32&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;, can you please correct me if I&apos;m wrong?&lt;br/&gt;
When taskmanager is removed (I assumed that it was removed based by logs I have) internalUnregisterTaskManager method&#160;&lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L1146&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L1146&lt;/a&gt; is called. When it supposed to remove all slots ac cancel all pending slots here &lt;a href=&quot;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L937&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/release-1.9.0/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L937&lt;/a&gt;. But when new job is started there&apos;re still 4 pending slots (1 taskmanager has 4 slots in my configuration).&lt;br/&gt;
Isn&apos;t flink supposed to remove all pending slots when taskmanager is removed?&lt;/p&gt;</comment>
                            <comment id="16958931" author="till.rohrmann" created="Thu, 24 Oct 2019 14:24:59 +0000"  >&lt;p&gt;I think the problem is the following: Flink thinks that it starts a &lt;tt&gt;TaskExecutor&lt;/tt&gt; with 1 GB of memory. However, for some reason, the &lt;tt&gt;TaskExecutor&lt;/tt&gt; is started with more memory. Due to this, the reported slots will have more resources than Flink expects. Internally, Flink registers pending slots in the &lt;tt&gt;SlotManager#pendingSlots&lt;/tt&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. The contract is that a pending slot gets removed if Flink receives an slot report which exactly matches the pending slot&apos;s profile &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;. If this is not the case (e.g. if the &lt;tt&gt;TaskExecutor&lt;/tt&gt; is started with more memory than asked for), then Flink still accepts the reported slot but it does not remove the pending slot. As a consequence, Flink still thinks that there will be a slot coming which will exactly match the pending slot. Hence, when you submit the second job and if the first &lt;tt&gt;TaskExecutor&lt;/tt&gt; has been released, then Flink thinks that it does not need to start a new &lt;tt&gt;TaskExecutor&lt;/tt&gt; because there is still a pending slot in &lt;tt&gt;SlotManagerImpl#pendingSlots&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;A similar problem has been reported here &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;A quick solution would be to figure out why the &lt;tt&gt;MesosResourceManager&lt;/tt&gt; starts &lt;tt&gt;TaskExecutors&lt;/tt&gt; with more memory. A cleaner and more robust solution would probably be to not rely on exact &lt;tt&gt;ResourceProfile&lt;/tt&gt; matchings in order to remove pending slots. It would be better if one could set the &lt;tt&gt;TaskExecutor&apos;s&lt;/tt&gt; &lt;tt&gt;ResourceID&lt;/tt&gt; and match against this instead of the &lt;tt&gt;ResourceProfile&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L801&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L801&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/slotmanager/SlotManagerImpl.java#L594&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://stackoverflow.com/questions/58537199/apache-flink-resource-manager-app-master-fails-allocating-new-task-managers-af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/58537199/apache-flink-resource-manager-app-master-fails-allocating-new-task-managers-af&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16959201" author="till.rohrmann" created="Thu, 24 Oct 2019 20:33:10 +0000"  >&lt;p&gt;I believe the problem is that we don&apos;t set &lt;tt&gt;TaskManagerOptions#MANAGED_MEMORY_SIZE&lt;/tt&gt; in the case of Mesos. Due to this, the &lt;tt&gt;TaskExecutor&lt;/tt&gt; uses &lt;tt&gt;EnvironmentInformation.getSizeOfFreeHeapMemoryWithDefrag()&lt;/tt&gt; to calculate the free memory and based on that the managed memory size. Since this is not predictable, it is very likely that the reported slot won&apos;t match the expected slot profile.&lt;/p&gt;

&lt;p&gt;As a quick fix, I propose to set this configuration option when starting a Mesos &lt;tt&gt;TaskExecutor&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16959658" author="atlaster" created="Fri, 25 Oct 2019 11:10:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt;&#160;thanks a lot for explanation and for finding the root case.&lt;br/&gt;
Sorry for absence of any actions/research from my side. I was sidetracked with other things.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested setting&#160;&lt;a href=&quot;#taskmanager-memory-size]&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;taskmanager.memory.size&lt;/a&gt; and it worked like a charm for me (Version: 1.9.0 Commit: 9c32ed9).&lt;/p&gt;</comment>
                            <comment id="16960345" author="till.rohrmann" created="Sat, 26 Oct 2019 12:48:39 +0000"  >&lt;p&gt;The same happened to me &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Atlaster&quot; class=&quot;user-hover&quot; rel=&quot;Atlaster&quot;&gt;Atlaster&lt;/a&gt;. Great to hear that setting &lt;tt&gt;taskmanager.memory.size&lt;/tt&gt; resolves the problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16963971" author="till.rohrmann" created="Thu, 31 Oct 2019 13:01:43 +0000"  >&lt;p&gt;Fixed via&lt;/p&gt;

&lt;p&gt;1.10.0: c0f3c8044a319c3630c390f8b1603a7edf076181&lt;br/&gt;
1.9.2: 97ff5a06931c4c5af44f36b8812cfbbc62966747&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13238951">FLINK-12812</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13244565">FLINK-13241</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06lwo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>