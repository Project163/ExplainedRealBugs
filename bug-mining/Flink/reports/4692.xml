<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19552] JobManager dies with IllegalStateException SharedSlot (physical request SlotRequestId{%}) has been released</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19552</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;While running some benchmarks that involve a lot of failures, I experienced fatal JobManager crashes, with the following log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-10-09 09:01:45,001 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - CHAIN Filter (Filter at main(TPCHQuery3.java:157)) -&amp;gt; Map (Map at appendMapper(KillerClientMapper.java:38)) (2/8) (cf993790aa641a2287b42939b3037f75_f25e1269f08c88185d8a3b9caad8d0c0_1_2) switched from CREATED to SCHEDULED.
2020-10-09 09:01:45,004 ERROR org.apache.flink.runtime.util.FatalExitExceptionHandler      [] - FATAL: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;flink-akka.actor.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-dispatcher-17&apos;&lt;/span&gt; produced an uncaught exception. Stopping the process...
java.util.concurrent.CompletionException: java.lang.IllegalStateException: SharedSlot (physical request SlotRequestId{214e8e202b9b087388a6a17c6ba9bccf}) has been released
        at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273) ~[?:1.8.0_222]
        at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280) ~[?:1.8.0_222]
        at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:708) ~[?:1.8.0_222]
        at java.util.concurrent.CompletableFuture$UniRun.tryFire(CompletableFuture.java:687) ~[?:1.8.0_222]
        at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442) ~[?:1.8.0_222]
        at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRunAsync(AkkaRpcActor.java:402) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:195) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.actor.ActorCell.invoke(ActorCell.scala:561) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.Mailbox.run(Mailbox.scala:225) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.Mailbox.exec(Mailbox.scala:235) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
Caused by: java.lang.IllegalStateException: SharedSlot (physical request SlotRequestId{214e8e202b9b087388a6a17c6ba9bccf}) has been released
        at org.apache.flink.util.Preconditions.checkState(Preconditions.java:217) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.SharedSlot.allocateLogicalSlot(SharedSlot.java:126) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.SlotSharingExecutionSlotAllocator.allocateLogicalSlotsFromSharedSlots(SlotSharingExecutionSlotAllocator.java:165) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.SlotSharingExecutionSlotAllocator.allocateSlotsFor(SlotSharingExecutionSlotAllocator.java:127) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.DefaultScheduler.allocateSlots(DefaultScheduler.java:364) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.DefaultScheduler.allocateSlotsAndDeploy(DefaultScheduler.java:337) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy.maybeScheduleRegion(PipelinedRegionSchedulingStrategy.java:143) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy.maybeScheduleRegions(PipelinedRegionSchedulingStrategy.java:128) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy.restartTasks(PipelinedRegionSchedulingStrategy.java:100) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at org.apache.flink.runtime.scheduler.DefaultScheduler.lambda$restartTasks$2(DefaultScheduler.java:290) ~[flip1-bench-jobs-1.0-SNAPSHOT.jar:?]
        at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705) ~[?:1.8.0_222]
        ... 24 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13334575">FLINK-19552</key>
            <summary>JobManager dies with IllegalStateException SharedSlot (physical request SlotRequestId{%}) has been released</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="azagrebin">Andrey Zagrebin</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 9 Oct 2020 07:13:42 +0000</created>
                <updated>Tue, 3 Nov 2020 14:21:00 +0000</updated>
                            <resolved>Tue, 27 Oct 2020 12:00:07 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17210701" author="zhuzh" created="Fri, 9 Oct 2020 08:01:50 +0000"  >&lt;p&gt;Thanks for reporting this issue! &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;&lt;br/&gt;
We will take a look. &lt;br/&gt;
cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azagrebin&quot; class=&quot;user-hover&quot; rel=&quot;azagrebin&quot;&gt;azagrebin&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17210706" author="zentol" created="Fri, 9 Oct 2020 08:05:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt; can you give us the jobmanager logs (preferably on debug)?&lt;/p&gt;</comment>
                            <comment id="17210710" author="rmetzger" created="Fri, 9 Oct 2020 08:07:42 +0000"  >&lt;p&gt;I shared them with Andrey already, but I&apos;ve now uploaded them to the ticket as well.&lt;/p&gt;</comment>
                            <comment id="17213685" author="zhuzh" created="Wed, 14 Oct 2020 07:24:38 +0000"  >&lt;p&gt;The root cause is that `MergingSharedSlotProfileRetrieverFactory` incorrectly retrieves preferred locations for vertices which are not scheduled yet, while some of their producer vertex are canceled and so are their location futures.&lt;/p&gt;</comment>
                            <comment id="17221352" author="azagrebin" created="Tue, 27 Oct 2020 12:00:07 +0000"  >&lt;p&gt;merged into master by&#160;4b3150d7209f8efe97ff1c44f71cac13079cbcf2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13337419">FLINK-19832</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13013288" name="flink-robert-standalonesession-0-RobertsibabaMac.localdomain.log-debug" size="4968835" author="rmetzger" created="Fri, 9 Oct 2020 08:07:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jjz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>