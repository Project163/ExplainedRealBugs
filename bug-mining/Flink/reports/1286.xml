<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:25:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4743] The sqrt/power function not accept the real data types.</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4743</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;At time calculate the sequences sql aggregate functions for real type column, got exception: No applicable constructor/method found for actual parameters &quot;float, java.math.BigDecimal&quot;&lt;br/&gt;
And for column of integer type the problem does not occur.&lt;/p&gt;

&lt;p&gt;Code reproduce:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Test
  def test():Unit={
    val env = ExecutionEnvironment.getExecutionEnvironment
    val tEnv = TableEnvironment.getTableEnvironment(env, config)
    val ds = env.fromElements(
      (1.0f, 1),
      (2.0f, 2)).toTable(tEnv)
    tEnv.registerTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;MyTable&quot;&lt;/span&gt;, ds)
    val sqlQuery = &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT &quot;&lt;/span&gt; +
      &lt;span class=&quot;code-quote&quot;&gt;&quot;SQRT((SUM(a*a) - SUM(a)*SUM(a)/COUNT(a))/COUNT(a)) &quot;&lt;/span&gt;+
      &lt;span class=&quot;code-quote&quot;&gt;&quot;from (select _1 as a from MyTable)&quot;&lt;/span&gt;
    tEnv.sql(sqlQuery).toDataSet[Row].collect().foreach(x=&amp;gt;print(s&lt;span class=&quot;code-quote&quot;&gt;&quot;$x &quot;&lt;/span&gt;))
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;got exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.flink.api.common.InvalidProgramException: Table program cannot be compiled. This is a bug. Please file an issue.

	at org.apache.flink.api.table.runtime.FunctionCompiler$class.compile(FunctionCompiler.scala:37)
	at org.apache.flink.api.table.runtime.FlatMapRunner.compile(FlatMapRunner.scala:28)
	at org.apache.flink.api.table.runtime.FlatMapRunner.open(FlatMapRunner.scala:42)
	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:38)
	at org.apache.flink.api.common.operators.base.FlatMapOperatorBase.executeOnCollections(FlatMapOperatorBase.java:62)
	at org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:249)
	at org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:147)
	at org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:129)
	at org.apache.flink.api.common.operators.CollectionExecutor.executeDataSink(CollectionExecutor.java:180)
	at org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:156)
	at org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:129)
	at org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:113)
	at org.apache.flink.api.java.CollectionEnvironment.execute(CollectionEnvironment.java:35)
	at org.apache.flink.test.util.CollectionTestEnvironment.execute(CollectionTestEnvironment.java:47)
	at org.apache.flink.test.util.CollectionTestEnvironment.execute(CollectionTestEnvironment.java:42)
	at org.apache.flink.api.scala.ExecutionEnvironment.execute(ExecutionEnvironment.scala:637)
	at org.apache.flink.api.scala.DataSet.collect(DataSet.scala:547)
	at org.apache.flink.api.scala.batch.sql.AggregationsITCase.test(AggregationsITCase.scala:307)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:160)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.codehaus.commons.compiler.CompileException: Line 118, Column 57: No applicable constructor/method found for actual parameters &quot;float, java.math.BigDecimal&quot;; candidates are: &quot;public static double org.apache.calcite.runtime.SqlFunctions.power(double, double)&quot;, &quot;public static double org.apache.calcite.runtime.SqlFunctions.power(long, java.math.BigDecimal)&quot;, &quot;public static double org.apache.calcite.runtime.SqlFunctions.power(long, long)&quot;
	at org.codehaus.janino.UnitCompiler.compileError(UnitCompiler.java:10062)
	at org.codehaus.janino.UnitCompiler.findMostSpecificIInvocable(UnitCompiler.java:7476)
	at org.codehaus.janino.UnitCompiler.findIMethod(UnitCompiler.java:7346)
	at org.codehaus.janino.UnitCompiler.findIMethod(UnitCompiler.java:7250)
	at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:3862)
	at org.codehaus.janino.UnitCompiler.access$6900(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$10.visitMethodInvocation(UnitCompiler.java:3263)
	at org.codehaus.janino.Java$MethodInvocation.accept(Java.java:3971)
	at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:3290)
	at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:4356)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:2669)
	at org.codehaus.janino.UnitCompiler.access$4500(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$7.visitAssignment(UnitCompiler.java:2619)
	at org.codehaus.janino.Java$Assignment.accept(Java.java:3402)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2654)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1635)
	at org.codehaus.janino.UnitCompiler.access$1100(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$4.visitExpressionStatement(UnitCompiler.java:936)
	at org.codehaus.janino.Java$ExpressionStatement.accept(Java.java:2094)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:999)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:985)
	at org.codehaus.janino.UnitCompiler.access$1000(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$4.visitBlock(UnitCompiler.java:935)
	at org.codehaus.janino.Java$Block.accept(Java.java:2009)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1737)
	at org.codehaus.janino.UnitCompiler.access$1200(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$4.visitIfStatement(UnitCompiler.java:937)
	at org.codehaus.janino.Java$IfStatement.accept(Java.java:2154)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:958)
	at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:999)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:2284)
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:822)
	at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:794)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:504)
	at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:390)
	at org.codehaus.janino.UnitCompiler.access$400(UnitCompiler.java:182)
	at org.codehaus.janino.UnitCompiler$2.visitPackageMemberClassDeclaration(UnitCompiler.java:344)
	at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:1136)
	at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:351)
	at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:319)
	at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:358)
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:201)
	at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:192)
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:84)
	at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:77)
	at org.apache.flink.api.table.runtime.FunctionCompiler$class.compile(FunctionCompiler.scala:34)
	... 55 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13009834">FLINK-4743</key>
            <summary>The sqrt/power function not accept the real data types.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tonycox">Anton Solovev</assignee>
                                    <reporter username="anmu">Anton Mushin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Oct 2016 10:37:55 +0000</created>
                <updated>Wed, 2 Nov 2016 20:54:00 +0000</updated>
                            <resolved>Wed, 2 Nov 2016 20:54:00 +0000</resolved>
                                    <version>1.1.1</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15554774" author="twalthr" created="Fri, 7 Oct 2016 10:40:57 +0000"  >&lt;p&gt;Just a small hint on this: It seems that &lt;tt&gt;org.apache.calcite.runtime.SqlFunctions&lt;/tt&gt; does not provide the method we need. It might make sense to create a &lt;tt&gt;CallGenerator&lt;/tt&gt; for power instead of using Calcites built-in function.&lt;/p&gt;</comment>
                            <comment id="15562191" author="tonycox" created="Mon, 10 Oct 2016 12:39:05 +0000"  >&lt;p&gt;Should a new function provide various types like sqrt(bigdecimal) or power(bigdecimal, double) ?&lt;/p&gt;</comment>
                            <comment id="15565447" author="twalthr" created="Tue, 11 Oct 2016 13:47:48 +0000"  >&lt;p&gt;Power can basically express both. I would just implement power but with various types.&lt;/p&gt;</comment>
                            <comment id="15594368" author="tonycox" created="Fri, 21 Oct 2016 07:42:48 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt;&lt;br/&gt;
I solved the issue through creating CastTypeUtil. &lt;a href=&quot;https://github.com/apache/flink/compare/master...tonycox:bugfix-flink-4743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/compare/master...tonycox:bugfix-flink-4743&lt;/a&gt;&lt;br/&gt;
but i have feeling that class shouldnt be there. &lt;br/&gt;
Maybe &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4621&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-4621&lt;/a&gt; somehow correlated with the issue ?&lt;/p&gt;</comment>
                            <comment id="15595029" author="fhueske" created="Fri, 21 Oct 2016 13:15:04 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tonycox&quot; class=&quot;user-hover&quot; rel=&quot;tonycox&quot;&gt;tonycox&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks for looking into this issue. Timo is currently on vacation and will return in about a month.&lt;/p&gt;

&lt;p&gt;I have a few comments on the branch you posted:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I think you can use &lt;tt&gt;ScalarOperators.generateCast()&lt;/tt&gt; for the casting&lt;/li&gt;
	&lt;li&gt;You register in &lt;tt&gt;ScalarFunctions&lt;/tt&gt; you register &lt;tt&gt;POWER, Seq(DOUBLE_TYPE_INFO, BIG_DEC_TYPE_INFO)&lt;/tt&gt; twice&lt;/li&gt;
	&lt;li&gt;We try to keep the number of time consuming ITCases low. Please convert your tests to extend &lt;tt&gt;ExpressionTestBase&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;After that you should be good to open a PR.&lt;/p&gt;

&lt;p&gt;Thanks, Fabian&lt;/p&gt;</comment>
                            <comment id="15601283" author="tonycox" created="Mon, 24 Oct 2016 07:59:43 +0000"  >&lt;p&gt;I reported bug in calcite &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CALCITE-1467&lt;/a&gt;&lt;br/&gt;
and solve flink issue through native pow method that in java.lang.Math&lt;/p&gt;</comment>
                            <comment id="15601470" author="githubbot" created="Mon, 24 Oct 2016 09:39:55 +0000"  >&lt;p&gt;GitHub user tonycox opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt; The sqrt/power function not accept the real data types.&lt;/p&gt;

&lt;p&gt;    Add supporting of variety types on &quot;power&quot; function. Add casting for Float and BigDecimal.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tonycox/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tonycox/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2686&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e5cfd1106b3c69f599149b56eee2ede7936e1e63&lt;br/&gt;
Author: Anton_Solovev@epam.com &amp;lt;root@quickstart.cloudera&amp;gt;&lt;br/&gt;
Date:   2016-10-17T07:44:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt; Add supporting of variety types on &quot;power&quot; function. Add casting for Float and BigDecimal.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15609646" author="githubbot" created="Wed, 26 Oct 2016 20:58:33 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85217190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85217190&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/scala/batch/sql/AggregationsITCase.scala &amp;#8212;&lt;br/&gt;
    @@ -258,4 +258,22 @@ class AggregationsITCase(&lt;br/&gt;
         // must fail. grouping sets are not supported&lt;br/&gt;
         tEnv.sql(sqlQuery).toDataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;&lt;br/&gt;
       }&lt;br/&gt;
    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testSqrtOfAggregatedSet(): Unit = {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think we do not need this ITCase. &lt;br/&gt;
    The `PowerExpressionTest` should cover all cases.&lt;/p&gt;</comment>
                            <comment id="15609647" author="githubbot" created="Wed, 26 Oct 2016 20:58:33 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85218584&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85218584&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/PowerExpressionTest.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,149 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.expressions&lt;br/&gt;
    +&lt;br/&gt;
    +import java.lang.&lt;/p&gt;
{Double =&amp;gt; JDouble, Float =&amp;gt; JFloat, Long =&amp;gt; JLong, Integer =&amp;gt; JInteger}
&lt;p&gt;    +import java.math.&lt;/p&gt;
{BigDecimal =&amp;gt; JBigDecimal}
&lt;p&gt;    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.table.expressions.utils.ExpressionTestBase&lt;br/&gt;
    +import org.apache.flink.api.table.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.api.table.&lt;/p&gt;
{Row, Types}
&lt;p&gt;    +import org.junit.Test&lt;br/&gt;
    +&lt;br/&gt;
    +class PowerExpressionTest extends ExpressionTestBase {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def testData = &lt;/p&gt;
{
    +    val testData = new Row(5)
    +    testData.setField(0, 100.0f: JFloat)
    +    testData.setField(1, 100.0: JDouble)
    +    testData.setField(2, 100L: JLong)
    +    testData.setField(3, 100: JInteger)
    +    testData.setField(4, new JBigDecimal(100): JBigDecimal)
    +    testData
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  override def typeInfo = &lt;/p&gt;
{
    +    new RowTypeInfo(Seq(
    +      Types.FLOAT,
    +      Types.DOUBLE,
    +      Types.LONG,
    +      Types.INT,
    +      Types.DECIMAL)
    +    ).asInstanceOf[TypeInformation[Any]]
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testSqrtFloat(): Unit = &lt;/p&gt;
{
    +    testSqlApi(
    +      &quot;SQRT(f0)&quot;,
    +      &quot;10.0&quot;)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testSqrtDouble(): Unit = {&lt;br/&gt;
    +    testSqlApi(&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Can you extend the tests to all APIs (Table Scala, Table Java, SQL)?&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    testAllApis(&lt;br/&gt;
          &apos;f1.sqrt(),&lt;br/&gt;
          &quot;f1.sqrt&quot;,&lt;br/&gt;
          &quot;SQRT(f1)&quot;,&lt;br/&gt;
          &quot;10.0&quot;)&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    You need to add this import for the Scala Table API to work:&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    import org.apache.flink.api.scala.table._&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="15615156" author="githubbot" created="Fri, 28 Oct 2016 11:36:50 +0000"  >&lt;p&gt;Github user tonycox commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85514611&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85514611&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/PowerExpressionTest.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,149 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.expressions&lt;br/&gt;
    +&lt;br/&gt;
    +import java.lang.&lt;/p&gt;
{Double =&amp;gt; JDouble, Float =&amp;gt; JFloat, Long =&amp;gt; JLong, Integer =&amp;gt; JInteger}
&lt;p&gt;    +import java.math.&lt;/p&gt;
{BigDecimal =&amp;gt; JBigDecimal}
&lt;p&gt;    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.table.expressions.utils.ExpressionTestBase&lt;br/&gt;
    +import org.apache.flink.api.table.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.api.table.&lt;/p&gt;
{Row, Types}
&lt;p&gt;    +import org.junit.Test&lt;br/&gt;
    +&lt;br/&gt;
    +class PowerExpressionTest extends ExpressionTestBase {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def testData = &lt;/p&gt;
{
    +    val testData = new Row(5)
    +    testData.setField(0, 100.0f: JFloat)
    +    testData.setField(1, 100.0: JDouble)
    +    testData.setField(2, 100L: JLong)
    +    testData.setField(3, 100: JInteger)
    +    testData.setField(4, new JBigDecimal(100): JBigDecimal)
    +    testData
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  override def typeInfo = &lt;/p&gt;
{
    +    new RowTypeInfo(Seq(
    +      Types.FLOAT,
    +      Types.DOUBLE,
    +      Types.LONG,
    +      Types.INT,
    +      Types.DECIMAL)
    +    ).asInstanceOf[TypeInformation[Any]]
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testSqrtFloat(): Unit = &lt;/p&gt;
{
    +    testSqlApi(
    +      &quot;SQRT(f0)&quot;,
    +      &quot;10.0&quot;)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  @Test&lt;br/&gt;
    +  def testSqrtDouble(): Unit = {&lt;br/&gt;
    +    testSqlApi(&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes, but i found out another bug. with this api &apos;f1.sqrt() and f1 is bigDecimal so test throws ValidationException. I wrote about it in dev mailing&lt;/p&gt;</comment>
                            <comment id="15615807" author="githubbot" created="Fri, 28 Oct 2016 16:06:38 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @fhueske @tonycox , the PR is really good.&lt;/p&gt;

&lt;p&gt;    But I think the true reason of this issue is because the `BuiltInMethods.POWER_DEC` is bound to a wrong method, which should be  `power(double, BigDecimal)`.&lt;/p&gt;

&lt;p&gt;    So what we need to do is just create a  `power(double, BigDecimal)` instead of `SqlFunctions.power(long, BigDecimal)`. And all the additional `addSqlFunction` are not necessary.&lt;/p&gt;

&lt;p&gt;    In addition , this can fix `SQRT(double)` too, which is not executable now. &lt;/p&gt;</comment>
                            <comment id="15615842" author="githubbot" created="Fri, 28 Oct 2016 16:17:29 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    According to the question mentioned in the dev mailing. I prefer to approach 2).  POWER only works on double. And `power(double, BigDecimal)` is only used to support `SQRT(double)` which is actually `power(double, 0.5)`.  That means `power(BigDecimal, double)` will go fail.&lt;/p&gt;

&lt;p&gt;    So IMO, `power` in Table API do not need to support BigDecimal. Users can cast it manually.&lt;/p&gt;
</comment>
                            <comment id="15615980" author="githubbot" created="Fri, 28 Oct 2016 17:12:25 +0000"  >&lt;p&gt;Github user tonycox commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @wuchong &lt;/p&gt;

&lt;p&gt;    I agree that  users can cast types manually. And that BuiltInMethods.POWER_DEC should be bound power(double, BigDecimal), but it&apos;s trouble of Calcite &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1467?filter=-2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CALCITE-1467?filter=-2&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15616097" author="githubbot" created="Fri, 28 Oct 2016 17:58:24 +0000"  >&lt;p&gt;Github user tonycox closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15616101" author="githubbot" created="Fri, 28 Oct 2016 17:59:39 +0000"  >&lt;p&gt;GitHub user tonycox reopened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt; The sqrt/power function not accept the real data types.&lt;/p&gt;

&lt;p&gt;    Add supporting of variety types on &quot;power&quot; function. Add casting for Float and BigDecimal.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tonycox/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tonycox/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2686&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e5cfd1106b3c69f599149b56eee2ede7936e1e63&lt;br/&gt;
Author: Anton_Solovev@epam.com &amp;lt;root@quickstart.cloudera&amp;gt;&lt;br/&gt;
Date:   2016-10-17T07:44:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4743&quot; title=&quot;The sqrt/power function not accept the real data types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4743&quot;&gt;&lt;del&gt;FLINK-4743&lt;/del&gt;&lt;/a&gt; Add supporting of variety types on &quot;power&quot; function. Add casting for Float and BigDecimal.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15617351" author="githubbot" created="Sat, 29 Oct 2016 03:45:26 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @tonycox , I think the POWER_DEC could be fixed in Flink side. That&apos;s  why I said we need to implement a  `power(double, BigDecimal)` method in Flink. And bind BuiltInMethods.POWER_DEC to the new method. &lt;/p&gt;</comment>
                            <comment id="15621616" author="githubbot" created="Mon, 31 Oct 2016 08:36:32 +0000"  >&lt;p&gt;Github user tonycox commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @wuchong , native java implementation of &quot;power&quot; function suits to most cases. So i deleted POWER_DEC from flink, because it has no proper types. Actually we don&apos;t make user&apos;s life harder. Instead of this I think the best way to solve this issue is to do what Fabian said &lt;a href=&quot;https://goo.gl/hjtlOd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://goo.gl/hjtlOd&lt;/a&gt;, just cast bigDecimal in table api manually. And tell in exception message that they should cast. Tests of sqrt and power with all types are good&lt;/p&gt;</comment>
                            <comment id="15622086" author="githubbot" created="Mon, 31 Oct 2016 13:00:22 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85732909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85732909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/ScalarFunctions.scala &amp;#8212;&lt;br/&gt;
    @@ -153,17 +153,42 @@ object ScalarFunctions {&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.EXP)&lt;/p&gt;

&lt;p&gt;    +  // POWER&lt;br/&gt;
       addSqlFunctionMethod(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, DOUBLE_TYPE_INFO),&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.POWER)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;addSqlFunctionMethod(&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;/li&gt;
	&lt;li&gt;DOUBLE_TYPE_INFO,&lt;/li&gt;
	&lt;li&gt;BuiltInMethods.POWER_DEC)&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(FLOAT_TYPE_INFO, FLOAT_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(FLOAT_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The same as above. Can be removed.&lt;/p&gt;
</comment>
                            <comment id="15622087" author="githubbot" created="Mon, 31 Oct 2016 13:00:22 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85732685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85732685&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/ScalarFunctions.scala &amp;#8212;&lt;br/&gt;
    @@ -153,17 +153,42 @@ object ScalarFunctions {&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.EXP)&lt;/p&gt;

&lt;p&gt;    +  // POWER&lt;br/&gt;
       addSqlFunctionMethod(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, DOUBLE_TYPE_INFO),&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.POWER)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;addSqlFunctionMethod(&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;/li&gt;
	&lt;li&gt;DOUBLE_TYPE_INFO,&lt;/li&gt;
	&lt;li&gt;BuiltInMethods.POWER_DEC)&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(FLOAT_TYPE_INFO, FLOAT_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(FLOAT_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(BIG_DEC_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(BIG_DEC_TYPE_INFO, FLOAT_TYPE_INFO),&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The same as above. Can be removed.&lt;/p&gt;
</comment>
                            <comment id="15622088" author="githubbot" created="Mon, 31 Oct 2016 13:00:22 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85732582&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85732582&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/ScalarFunctions.scala &amp;#8212;&lt;br/&gt;
    @@ -153,17 +153,42 @@ object ScalarFunctions {&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.EXP)&lt;/p&gt;

&lt;p&gt;    +  // POWER&lt;br/&gt;
       addSqlFunctionMethod(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, DOUBLE_TYPE_INFO),&lt;br/&gt;
         DOUBLE_TYPE_INFO,&lt;br/&gt;
         BuiltInMethods.POWER)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;addSqlFunctionMethod(&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
         POWER,&lt;br/&gt;
         Seq(DOUBLE_TYPE_INFO, BIG_DEC_TYPE_INFO),&lt;/li&gt;
	&lt;li&gt;DOUBLE_TYPE_INFO,&lt;/li&gt;
	&lt;li&gt;BuiltInMethods.POWER_DEC)&lt;br/&gt;
    +    new PowerCallGen(DOUBLE_TYPE_INFO, BuiltInMethods.POWER))&lt;br/&gt;
    +&lt;br/&gt;
    +  addSqlFunction(&lt;br/&gt;
    +    POWER,&lt;br/&gt;
    +    Seq(FLOAT_TYPE_INFO, FLOAT_TYPE_INFO),
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Parameters  `(float, float)` will automatic choose `power(double, double)` to call. So there is no need to add this one.&lt;/p&gt;</comment>
                            <comment id="15622089" author="githubbot" created="Mon, 31 Oct 2016 13:00:22 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r85732797&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r85732797&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/PowerCallGen.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,51 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.codegen.calls&lt;br/&gt;
    +&lt;br/&gt;
    +import java.lang.reflect.Method&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.BasicTypeInfo._&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.table.codegen.CodeGenUtils._&lt;br/&gt;
    +import org.apache.flink.api.table.codegen.calls.CallGenerator._&lt;br/&gt;
    +import org.apache.flink.api.table.codegen.&lt;/p&gt;
{CodeGenerator, GeneratedExpression}
&lt;p&gt;    +&lt;br/&gt;
    +class PowerCallGen(returnType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt;, method: Method) extends CallGenerator {&lt;br/&gt;
    +&lt;br/&gt;
    +  override def generate(&lt;br/&gt;
    +    codeGenerator: CodeGenerator,&lt;br/&gt;
    +    operands: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;GeneratedExpression&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +  : GeneratedExpression = {&lt;br/&gt;
    +&lt;br/&gt;
    +    val castedOperands = operands.map { x =&amp;gt;&lt;br/&gt;
    +      x.resultType match {&lt;br/&gt;
    +        case FLOAT_TYPE_INFO | BIG_DEC_TYPE_INFO =&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Unnecessary to cast Float, we only need to cast BigDecimal here. &lt;/p&gt;</comment>
                            <comment id="15622095" author="githubbot" created="Mon, 31 Oct 2016 13:02:40 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @tonycox ,  I agree with what Fabian said, it&apos;s the same as I mean in this &lt;span class=&quot;error&quot;&gt;&amp;#91;comment&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/apache/flink/pull/2686#issuecomment-256963469&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#issuecomment-256963469&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;    What I&apos;m talking about POWER_DEC is another problem. Using `ScalarOperators.generateCast()` for casting BigDecimal to double can fix this problem. It can support BigDecimal for `power` in SQL. But if we support for `power`, we should also support BigDecimal for `log10`, `ln`, `exp`, etc. &lt;/p&gt;

&lt;p&gt;    So I there are 2 approaches:&lt;/p&gt;

&lt;p&gt;    (1). Bind BuiltInMethods.POWER_DEC to the new created `power(double, BigDecimal)`, no other code involved. This will lose BigDecimal support for power and sqrt in SQL. Users can call an explicit cast.&lt;br/&gt;
    (2). Support BigDecimal for  `log`,`ln`,`exp` too. This can be done in a separate JIRA.&lt;/p&gt;

&lt;p&gt;    I prefer approach (2). What do you think ? &lt;br/&gt;
    cc @fhueske &lt;/p&gt;





</comment>
                            <comment id="15622516" author="githubbot" created="Mon, 31 Oct 2016 15:46:28 +0000"  >&lt;p&gt;Github user tonycox commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @wuchong if choosing second option, why not to solve this issue &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CALCITE-1468&lt;/a&gt; instead of solve on flink side ?&lt;/p&gt;</comment>
                            <comment id="15622668" author="githubbot" created="Mon, 31 Oct 2016 16:39:13 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I got a bit lost in the discussion, but if I understood @wuchong&apos;s options right, I prefer the first option. Automatically converting `DECIMAL` to `DOUBLE` can result in rounding errors. However, the whole purpose of `DECIMAL` is to provide exact results. So I would rather request an explicit cast than computing unexpected imprecise results.&lt;/p&gt;

</comment>
                            <comment id="15624701" author="githubbot" created="Tue, 1 Nov 2016 08:06:23 +0000"  >&lt;p&gt;Github user tonycox commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I agree with @wuchong that we need create a new issue in JIRA for supporting `BigDecimal` in functions (`log`,`ln`,`exp` etc), but I suppose that if problem in calcite with `DECIMAL` is done we will not repeat calcit&apos;s work in flink&lt;/p&gt;</comment>
                            <comment id="15625157" author="githubbot" created="Tue, 1 Nov 2016 11:15:23 +0000"  >&lt;p&gt;Github user tonycox commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @wuchong, second option supports only in SQL. in table api we still cast manually.&lt;br/&gt;
    in first option where should I create power(double, BigDecimal) function, which package or util class?&lt;br/&gt;
    @fhueske, explicit cast of bigDecimal should be everywhere, and we don&apos;t need `PowerCallGen` anymore ?&lt;/p&gt;</comment>
                            <comment id="15625226" author="githubbot" created="Tue, 1 Nov 2016 11:51:39 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tonycox   Yes, the second option support BigDecimal only in SQL.  I think we could put the new `power` function in `BuiltInMethods`. Or create a util class in  `org.apache.flink.api.table.functions.utils`  package.&lt;/p&gt;</comment>
                            <comment id="15627353" author="githubbot" created="Wed, 2 Nov 2016 01:55:40 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86061549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86061549&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I would like to translate this class into Scala object to keep `flink-table` module pure Scala. &lt;/p&gt;</comment>
                            <comment id="15627964" author="githubbot" created="Wed, 2 Nov 2016 06:45:11 +0000"  >&lt;p&gt;Github user tonycox commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86081029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86081029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    We can&apos;t call Scala from generated Java code because of Calcit&apos;s compilation&lt;/p&gt;</comment>
                            <comment id="15628156" author="githubbot" created="Wed, 2 Nov 2016 08:10:01 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86089087&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86089087&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Scala handles `static` methods a bit differently than Java. Did you try to implement `MathFunctions` as a Scala object? See the paragraph on &quot;Scala&#8217;s Sort-of Statics&quot;  in this tutorial: &lt;a href=&quot;http://www.codecommit.com/blog/scala/scala-for-java-refugees-part-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.codecommit.com/blog/scala/scala-for-java-refugees-part-3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15628180" author="githubbot" created="Wed, 2 Nov 2016 08:21:48 +0000"  >&lt;p&gt;Github user tonycox commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86090398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86090398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    i just implemented it into BuiltInMethods to see &lt;a href=&quot;https://github.com/tonycox/flink/blob/4ebfd81e04d94161827f7bd55ee1146eedafeeb0/flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/BuiltInMethods.scala&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tonycox/flink/blob/4ebfd81e04d94161827f7bd55ee1146eedafeeb0/flink-libraries/flink-table/src/main/scala/org/apache/flink/api/table/codegen/calls/BuiltInMethods.scala&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="15628465" author="githubbot" created="Wed, 2 Nov 2016 10:14:32 +0000"  >&lt;p&gt;Github user tonycox commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86108721&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86108721&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Why I didn&apos;t write `power` function in scala class.&lt;/p&gt;

&lt;p&gt;    I plunged into a problem with static access to method. I tried rewrite `MathFunctions.java` into Scala object &lt;a href=&quot;https://goo.gl/rmLy8f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://goo.gl/rmLy8f&lt;/a&gt; . &lt;br/&gt;
    In BuiltInMethods we cannot to use `classOf[]` with scala `object`. So I used `getClass()`&lt;br/&gt;
    Test throws &lt;span class=&quot;error&quot;&gt;&amp;#91;exception&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://pastebin.com/fLNr4CfX&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pastebin.com/fLNr4CfX&lt;/a&gt;) &lt;br/&gt;
    because `getClass()` doesn&apos;t return `MathFunctions` itself, it returns `MathFunctions$` &lt;a href=&quot;http://pastebin.com/LiZk45Fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pastebin.com/LiZk45Fe&lt;/a&gt; &lt;br/&gt;
    *&lt;b&gt;But&lt;/b&gt;* there is a solving &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    ```&lt;br/&gt;
    val POWER_DEC =&lt;br/&gt;
    Types.lookupMethod(Class.forName(MathFunctions.getClass.getCanonicalName.dropRight(1)),&lt;br/&gt;
        &quot;power&quot;, classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Double&amp;#93;&lt;/span&gt;, classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;JBigDecimal&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    ```&lt;br/&gt;
    I prefer java approach, what do you think @wuchong @fhueske ?&lt;/p&gt;</comment>
                            <comment id="15628519" author="githubbot" created="Wed, 2 Nov 2016 10:34:06 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86111954&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86111954&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/java/org/apache/flink/api/table/functions/utils/MathFunctions.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,29 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.api.table.functions.utils;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.math.BigDecimal;&lt;br/&gt;
    +&lt;br/&gt;
    +public class MathFunctions {&lt;br/&gt;
    +&lt;br/&gt;
    +	public static double power(double a, BigDecimal b) &lt;/p&gt;
{
    +		return Math.pow(a, b.doubleValue());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +}&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    What if we define a `MathFunctions` class and a companion object?&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    class MathFunctions { }&lt;/p&gt;

&lt;p&gt;    object MathFunctions &lt;/p&gt;
{
      def power(...) 
    }
&lt;p&gt;    ```&lt;/p&gt;</comment>
                            <comment id="15628770" author="githubbot" created="Wed, 2 Nov 2016 12:13:52 +0000"  >&lt;p&gt;Github user wuchong commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86127428&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86127428&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/ScalarFunctionsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -377,11 +378,79 @@ class ScalarFunctionsTest extends ExpressionTestBase {&lt;br/&gt;
           &quot;f4.power(f5)&quot;,&lt;br/&gt;
           &quot;POWER(f4, f5)&quot;,&lt;br/&gt;
           math.pow(44.toLong, 4.5.toFloat).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f5: float&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f5), &quot;f5.power(f5)&quot;, &quot;power(f5, f5)&quot;, math.pow(4.5F, 4.5F).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f6), &quot;f5.power(f6)&quot;, &quot;power(f5, f6)&quot;, math.pow(4.5F, 4.6D).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f7), &quot;f5.power(f7)&quot;, &quot;power(f5, f7)&quot;, math.pow(4.5F, 3).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f4), &quot;f5.power(f4)&quot;, &quot;power(f5, f4)&quot;, math.pow(4.5F, 44L).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f15: bigDecimal&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    minor     f15-&amp;gt;f22?&lt;/p&gt;</comment>
                            <comment id="15628774" author="githubbot" created="Wed, 2 Nov 2016 12:16:02 +0000"  >&lt;p&gt;Github user wuchong commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The final code looks pretty good. &lt;br/&gt;
    I&apos;m +1 &lt;/p&gt;</comment>
                            <comment id="15628958" author="githubbot" created="Wed, 2 Nov 2016 13:22:34 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86138204&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86138204&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/ScalarFunctionsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -377,11 +378,79 @@ class ScalarFunctionsTest extends ExpressionTestBase {&lt;br/&gt;
           &quot;f4.power(f5)&quot;,&lt;br/&gt;
           &quot;POWER(f4, f5)&quot;,&lt;br/&gt;
           math.pow(44.toLong, 4.5.toFloat).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f5: float&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f5), &quot;f5.power(f5)&quot;, &quot;power(f5, f5)&quot;, math.pow(4.5F, 4.5F).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f6), &quot;f5.power(f6)&quot;, &quot;power(f5, f6)&quot;, math.pow(4.5F, 4.6D).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f7), &quot;f5.power(f7)&quot;, &quot;power(f5, f7)&quot;, math.pow(4.5F, 3).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f4), &quot;f5.power(f4)&quot;, &quot;power(f5, f4)&quot;, math.pow(4.5F, 44L).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f22: bigDecimal&lt;br/&gt;
    +    // TODO delete casting in SQL when &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1467&quot; title=&quot;SqlFunctions power&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-1467&quot;&gt;CALCITE-1467&lt;/a&gt; is fixed&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f4),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f5)&quot;,&lt;br/&gt;
    +      &quot;power(CAST(f22 AS DOUBLE), f5)&quot;,&lt;br/&gt;
    +      &quot;1.0&quot;)&lt;br/&gt;
    +&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f5),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f6)&quot;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shouldn&apos;t this be `&quot;f22.cast(DOUBLE).power(f5)&quot;`&lt;br/&gt;
    Same for SQL expression.&lt;/p&gt;</comment>
                            <comment id="15628960" author="githubbot" created="Wed, 2 Nov 2016 13:22:34 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86138263&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86138263&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/ScalarFunctionsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -377,11 +378,79 @@ class ScalarFunctionsTest extends ExpressionTestBase {&lt;br/&gt;
           &quot;f4.power(f5)&quot;,&lt;br/&gt;
           &quot;POWER(f4, f5)&quot;,&lt;br/&gt;
           math.pow(44.toLong, 4.5.toFloat).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f5: float&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f5), &quot;f5.power(f5)&quot;, &quot;power(f5, f5)&quot;, math.pow(4.5F, 4.5F).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f6), &quot;f5.power(f6)&quot;, &quot;power(f5, f6)&quot;, math.pow(4.5F, 4.6D).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f7), &quot;f5.power(f7)&quot;, &quot;power(f5, f7)&quot;, math.pow(4.5F, 3).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f4), &quot;f5.power(f4)&quot;, &quot;power(f5, f4)&quot;, math.pow(4.5F, 44L).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f22: bigDecimal&lt;br/&gt;
    +    // TODO delete casting in SQL when &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1467&quot; title=&quot;SqlFunctions power&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-1467&quot;&gt;CALCITE-1467&lt;/a&gt; is fixed&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f4),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f5)&quot;,&lt;br/&gt;
    +      &quot;power(CAST(f22 AS DOUBLE), f5)&quot;,&lt;br/&gt;
    +      &quot;1.0&quot;)&lt;br/&gt;
    +&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f5),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f6)&quot;,&lt;br/&gt;
    +      &quot;power(CAST(f22 AS DOUBLE), f6)&quot;,&lt;br/&gt;
    +      &quot;1.0&quot;)&lt;br/&gt;
    +&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f7),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f7)&quot;,&lt;br/&gt;
    +      &quot;power(CAST(f22 AS DOUBLE), f7)&quot;,&lt;br/&gt;
    +      &quot;1.0&quot;)&lt;br/&gt;
    +&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f4),&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Same as above?&lt;/p&gt;</comment>
                            <comment id="15628959" author="githubbot" created="Wed, 2 Nov 2016 13:22:34 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86138100&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86138100&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/ScalarFunctionsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -377,11 +378,79 @@ class ScalarFunctionsTest extends ExpressionTestBase {&lt;br/&gt;
           &quot;f4.power(f5)&quot;,&lt;br/&gt;
           &quot;POWER(f4, f5)&quot;,&lt;br/&gt;
           math.pow(44.toLong, 4.5.toFloat).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f5: float&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f5), &quot;f5.power(f5)&quot;, &quot;power(f5, f5)&quot;, math.pow(4.5F, 4.5F).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f6), &quot;f5.power(f6)&quot;, &quot;power(f5, f6)&quot;, math.pow(4.5F, 4.6D).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f7), &quot;f5.power(f7)&quot;, &quot;power(f5, f7)&quot;, math.pow(4.5F, 3).toString)&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f4), &quot;f5.power(f4)&quot;, &quot;power(f5, f4)&quot;, math.pow(4.5F, 44L).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f22: bigDecimal&lt;br/&gt;
    +    // TODO delete casting in SQL when &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-1467&quot; title=&quot;SqlFunctions power&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-1467&quot;&gt;CALCITE-1467&lt;/a&gt; is fixed&lt;br/&gt;
    +    testAllApis(&lt;br/&gt;
    +      &apos;f22.cast(Types.DOUBLE).power(&apos;f4),&lt;br/&gt;
    +      &quot;f22.cast(DOUBLE).power(f5)&quot;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shouldn&apos;t this be `&quot;f22.cast(DOUBLE).power(f4)&quot;`?&lt;br/&gt;
    Same for SQL expression.&lt;/p&gt;</comment>
                            <comment id="15628961" author="githubbot" created="Wed, 2 Nov 2016 13:22:34 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686#discussion_r86138673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686#discussion_r86138673&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/test/scala/org/apache/flink/api/table/expressions/ScalarFunctionsTest.scala &amp;#8212;&lt;br/&gt;
    @@ -377,11 +378,79 @@ class ScalarFunctionsTest extends ExpressionTestBase {&lt;br/&gt;
           &quot;f4.power(f5)&quot;,&lt;br/&gt;
           &quot;POWER(f4, f5)&quot;,&lt;br/&gt;
           math.pow(44.toLong, 4.5.toFloat).toString)&lt;br/&gt;
    +&lt;br/&gt;
    +    // f5: float&lt;br/&gt;
    +    testAllApis(&apos;f5.power(&apos;f5), &quot;f5.power(f5)&quot;, &quot;power(f5, f5)&quot;, math.pow(4.5F, 4.5F).toString)&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Please break statements to be consistent with other tests in this file.&lt;/p&gt;</comment>
                            <comment id="15629126" author="githubbot" created="Wed, 2 Nov 2016 14:27:20 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Great! +1 to merge &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15629680" author="githubbot" created="Wed, 2 Nov 2016 17:16:49 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging&lt;/p&gt;</comment>
                            <comment id="15630431" author="githubbot" created="Wed, 2 Nov 2016 20:47:42 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2686&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15630460" author="fhueske" created="Wed, 2 Nov 2016 20:54:00 +0000"  >&lt;p&gt;Fixed for 1.2.0 with 4565170088595838ec53f3ca9b898126c62abbbc&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="13003842">FLINK-4604</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34gs7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>