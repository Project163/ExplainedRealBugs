<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5345] IOManager failed to properly clean up temp file directory</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5345</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;While testing 1.1.3 RC3, I have the following message in my log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2016-12-15 14:46:05,450 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask           - Timer service is shutting down.
2016-12-15 14:46:05,452 INFO  org.apache.flink.runtime.taskmanager.Task                     - Source: control events generator (29/40) (73915a232ba09e642f9dff92f8c8773a) switched from CANCELING to CANCELED.
2016-12-15 14:46:05,452 INFO  org.apache.flink.runtime.taskmanager.Task                     - Freeing task resources &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Source: control events generator (29/40) (73915a232ba09e642f9dff92f8c8773a).
2016-12-15 14:46:05,454 INFO  org.apache.flink.yarn.YarnTaskManager                         - Un-registering task and sending &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; execution state CANCELED to JobManager &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; task Source: control events genera
tor (73915a232ba09e642f9dff92f8c8773a)
2016-12-15 14:46:40,609 INFO  org.apache.flink.yarn.YarnTaskManagerRunner                   - RECEIVED SIGNAL 15: SIGTERM. Shutting down as requested.
2016-12-15 14:46:40,611 INFO  org.apache.flink.runtime.blob.BlobCache                       - Shutting down BlobCache
2016-12-15 14:46:40,724 WARN  akka.remote.ReliableDeliverySupervisor                        - Association with remote system [akka.tcp:&lt;span class=&quot;code-comment&quot;&gt;//flink@10.240.0.34:33635] has failed, address is now gated &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; [5000] ms.
&lt;/span&gt; Reason is: [Disassociated].
2016-12-15 14:46:40,808 ERROR org.apache.flink.runtime.io.disk.iomanager.IOManager          - IOManager failed to properly clean up temp file directory: /yarn/nm/usercache/robert/appcache/application_148129128
9979_0024/flink-io-f0ff3f66-b9e2-4560-881f-2ab43bc448b5
java.lang.IllegalArgumentException: /yarn/nm/usercache/robert/appcache/application_1481291289979_0024/flink-io-f0ff3f66-b9e2-4560-881f-2ab43bc448b5/62e14e1891fe1e334c921dfd19a32a84/StreamMap_11_24/dummy_state does not exist
        at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1637)
        at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:1535)
        at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:2270)
        at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1653)
        at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:1535)
        at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:2270)
        at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1653)
        at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:1535)
        at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:2270)
        at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1653)
        at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:1535)
        at org.apache.flink.runtime.io.disk.iomanager.IOManager.shutdown(IOManager.java:109)
        at org.apache.flink.runtime.io.disk.iomanager.IOManagerAsync.shutdown(IOManagerAsync.java:185)
        at org.apache.flink.runtime.io.disk.iomanager.IOManagerAsync$1.run(IOManagerAsync.java:105)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This was the last message logged from that machine. I suspect two threads are trying to clean up the directories during shutdown?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13028410">FLINK-5345</key>
            <summary>IOManager failed to properly clean up temp file directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>simplex</label>
                            <label>starter</label>
                    </labels>
                <created>Thu, 15 Dec 2016 15:20:45 +0000</created>
                <updated>Wed, 2 Oct 2019 17:43:47 +0000</updated>
                            <resolved>Mon, 16 Jan 2017 20:23:13 +0000</resolved>
                                    <version>1.1.3</version>
                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15751722" author="stephanewen" created="Thu, 15 Dec 2016 15:56:03 +0000"  >&lt;p&gt;I think that is a problem of &lt;tt&gt;org.apache.commons.io.FileUtils&lt;/tt&gt;: When someone concurrently works on the directory, the delete fails.&lt;/p&gt;

&lt;p&gt;We should have our own utility method for recursive directory that retries listing and deleting contained files to be safe against concurrent deletes by other services.&lt;/p&gt;</comment>
                            <comment id="15785037" author="tonycox" created="Thu, 29 Dec 2016 10:20:15 +0000"  >&lt;p&gt;1.1.3 RC3 ? I only see 1.1.3 RC2 on github branches&lt;/p&gt;</comment>
                            <comment id="15787827" author="stephanewen" created="Fri, 30 Dec 2016 15:04:55 +0000"  >&lt;p&gt;I think Robert was referring to 1.1.4 RC3.&lt;br/&gt;
The issue also applies to the 1.2 release branch and the master.&lt;/p&gt;</comment>
                            <comment id="15823974" author="rmetzger" created="Mon, 16 Jan 2017 13:41:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tonycox&quot; class=&quot;user-hover&quot; rel=&quot;tonycox&quot;&gt;tonycox&lt;/a&gt; What&apos;s the progress on fixing this issue?&lt;/p&gt;</comment>
                            <comment id="15824002" author="stephanewen" created="Mon, 16 Jan 2017 14:03:03 +0000"  >&lt;p&gt;I have a &quot;concurrency-safe&quot; deletion function in a different branch.Will merge that as a base for this..&lt;/p&gt;</comment>
                            <comment id="15824013" author="tonycox" created="Mon, 16 Jan 2017 14:13:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt; How about using &lt;tt&gt;#deleteQuietly&lt;/tt&gt; and if a folder can&apos;t be deleted - log a warn. Because it&apos;s a temporary file so theoretically the directory sooner or later will be deleted by one of the another thread.&lt;/p&gt;</comment>
                            <comment id="15824064" author="stephanewen" created="Mon, 16 Jan 2017 14:34:24 +0000"  >&lt;p&gt;The utility I did is a bit nicer. deleteQuietly aborts the deletion on first error (file not found), simply swallowing the exception.&lt;br/&gt;
The new utility continues to remove the other files, which is what I think we want.&lt;/p&gt;</comment>
                            <comment id="15824116" author="tonycox" created="Mon, 16 Jan 2017 14:59:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt; I see, will assign the issue on you&lt;/p&gt;</comment>
                            <comment id="15824550" author="stephanewen" created="Mon, 16 Jan 2017 20:23:13 +0000"  >&lt;p&gt;Fixed in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.2.0 via d1b86aab09061627d8b8c8f99b4277cc60e3dc28&lt;/li&gt;
	&lt;li&gt;1.3.0 via c4626cbae074ba288e54308c40f93258e14c9667&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15824552" author="stephanewen" created="Mon, 16 Jan 2017 20:23:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tonycox&quot; class=&quot;user-hover&quot; rel=&quot;tonycox&quot;&gt;tonycox&lt;/a&gt; Sorry for the confusion in this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37n9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>