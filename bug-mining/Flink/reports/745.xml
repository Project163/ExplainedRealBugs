<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:22:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2622] Scala DataStream API does not have writeAsText method which supports WriteMode</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2622</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The Scala DataStream API, unlike the Java DataStream API, does not support a &lt;tt&gt;writeAsText&lt;/tt&gt; method which takes the &lt;tt&gt;WriteMode&lt;/tt&gt; as a parameter. In order to make the two APIs consistent, it should be added to the Scala DataStream API.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12861826">FLINK-2622</key>
            <summary>Scala DataStream API does not have writeAsText method which supports WriteMode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Sep 2015 12:22:27 +0000</created>
                <updated>Thu, 28 Feb 2019 10:52:28 +0000</updated>
                            <resolved>Mon, 21 Dec 2015 17:46:33 +0000</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                    <component>API / Scala</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14733236" author="githubbot" created="Mon, 7 Sep 2015 04:18:10 +0000"  >&lt;p&gt;GitHub user HuangWHWHW opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt;add WriteMode for writeAsText in DataStream.scala&lt;/p&gt;

&lt;p&gt;    Add a parameter writeMode in writeAsText with default setting &quot;null&quot;.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/HuangWHWHW/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/HuangWHWHW/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt;-new&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1098&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9d260190f016d39b2e7e24afb908b9af6fc1fa6f&lt;br/&gt;
Author: HuangWHWHW &amp;lt;404823056@qq.com&amp;gt;&lt;br/&gt;
Date:   2015-09-07T04:15:18Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt;add WriteMode for writeAsText in DataStream.scala&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14733380" author="githubbot" created="Mon, 7 Sep 2015 08:24:25 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138230399&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138230399&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your contribution @HuangWHWHW. However, your changes are not compatible to the Java DataStream API. Both APIs should support the same functionality with the same order of parameters. Furthermore, this PR is lacking tests.&lt;/p&gt;</comment>
                            <comment id="14733398" author="githubbot" created="Mon, 7 Sep 2015 08:37:19 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138236351&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138236351&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Hi,&lt;br/&gt;
    I see. &lt;br/&gt;
    The issue about order is just in the scala-example SocketTextStreamWordCount.scala as following:&lt;/p&gt;

&lt;p&gt;    {&lt;br/&gt;
    if (fileOutput) &lt;/p&gt;
{
          counts.writeAsText(outputPath, 1)
        }
&lt;p&gt; else &lt;/p&gt;
{
          counts print
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;    So I changed the order for compile access.&lt;br/&gt;
    As for the tests, I`ll try since I`m not good at scala programming.&lt;br/&gt;
    BTW:Can you tell me why the CI is failed? It is still blocked in China.&lt;/p&gt;
</comment>
                            <comment id="14733434" author="githubbot" created="Mon, 7 Sep 2015 09:01:32 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138243780&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138243780&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It&apos;s not only about the order but also about the support signatures. Best you take a look at the Java `DataStream` implementation to see what&apos;s supported.&lt;/p&gt;

&lt;p&gt;    The error is `error file=/home/travis/build/apache/flink/flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala message=File line length exceeds 100 characters line=721`. If you run `mvn clean verify` locally, you will spot these issues without Travis.&lt;/p&gt;</comment>
                            <comment id="14733449" author="githubbot" created="Mon, 7 Sep 2015 09:18:52 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138247906&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138247906&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Hi,&lt;br/&gt;
    Thank you for the CI info!&lt;br/&gt;
    As I see, the writeAsText in scala DataStream calls the same method in Java DataStream(any misunderstanding?).&lt;br/&gt;
    So the scala DataStream just pack the Java DataStream api.&lt;br/&gt;
    Do you mean that there are some issues in other APIs(.e.g writeAsCsv())?&lt;/p&gt;</comment>
                            <comment id="14733452" author="githubbot" created="Mon, 7 Sep 2015 09:25:06 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138249409&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138249409&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I mean that the APIs are not consistent.&lt;/p&gt;</comment>
                            <comment id="14733456" author="githubbot" created="Mon, 7 Sep 2015 09:27:05 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138249745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138249745&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    In the Java DataStream API you can call the `writeAsText` method with:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;path&lt;/li&gt;
	&lt;li&gt;path, write frequency&lt;/li&gt;
	&lt;li&gt;path, writemode&lt;/li&gt;
	&lt;li&gt;path. writemode, write frequency&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    In Scala this should also be supported.&lt;/p&gt;</comment>
                            <comment id="14733461" author="githubbot" created="Mon, 7 Sep 2015 09:32:46 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138250808&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138250808&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ah, I get you.&lt;br/&gt;
    Maybe one writeAsText  method is not enough.&lt;br/&gt;
    Add more writeAsText methods as JAVA DataStream?&lt;br/&gt;
    And is there the same issue in writeAsCsv()?&lt;/p&gt;</comment>
                            <comment id="14733465" author="githubbot" created="Mon, 7 Sep 2015 09:37:41 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138251605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138251605&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    1. Yes&lt;br/&gt;
    2. You should check&lt;/p&gt;</comment>
                            <comment id="14733528" author="githubbot" created="Mon, 7 Sep 2015 10:43:44 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138267803&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138267803&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Thank you for the comments!&lt;br/&gt;
    I will take the fix and add tests for this.&lt;br/&gt;
    BTW:Can you take a look about this PR:&lt;a href=&quot;https://github.com/apache/flink/pull/1030?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1030?&lt;/a&gt;&lt;br/&gt;
    I got the CI passed and is there any new comment or could that be merged?&lt;br/&gt;
    Very sorry for spending your time. &lt;/p&gt;</comment>
                            <comment id="14734311" author="githubbot" created="Tue, 8 Sep 2015 06:36:39 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-138449988&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-138449988&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I take a fix for the consistent to JAVA and SCALA APIs.&lt;br/&gt;
    As a result, we can call `writeAsText` and `writeAsCsv` method with:&lt;br/&gt;
    *path&lt;br/&gt;
    *path, write frequency&lt;br/&gt;
    *path, writemode&lt;br/&gt;
    *path. writemode, write frequency&lt;/p&gt;

&lt;p&gt;    And I add tests for these APIs.&lt;br/&gt;
    And I noticed that in JAVA API, `writeAsCsv` cannot be configured the `Delimiter` for a row or a filed while the SCALA API is able.&lt;br/&gt;
    I&apos;m not sure neither to remove the feature in Scala API nor add it to the Java API.&lt;br/&gt;
    So I added a new `writeAsCsv` method in Java DataStream for that we can configure the `Delimiter`.&lt;/p&gt;</comment>
                            <comment id="14738733" author="githubbot" created="Thu, 10 Sep 2015 13:26:01 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139233867&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139233867&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Hi, I got a problem in this failed CI.&lt;br/&gt;
    It is just a scala programming issue.&lt;br/&gt;
    I found both in `DataStream.scala` and `DataSet.scala` had the same method now:&lt;br/&gt;
    `def writeAsText(&lt;br/&gt;
          filePath: String,&lt;br/&gt;
          writeMode: FileSystem.WriteMode = null): DataSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;`&lt;br/&gt;
    So in some failed tests(.e.g `org.apache.flink.api.scala.table.test.AsITCase`), `ds.writeAsText(resultPath, WriteMode.OVERWRITE)` cannot find the correct `writeAsText` method.&lt;br/&gt;
    Could you tell me how to fix it?&lt;/p&gt;</comment>
                            <comment id="14738777" author="githubbot" created="Thu, 10 Sep 2015 13:57:30 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139242079&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139242079&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I added the `javaSet` to the end of the table APIs.&lt;br/&gt;
    I am not sure if it is suitable.&lt;/p&gt;</comment>
                            <comment id="14738929" author="githubbot" created="Thu, 10 Sep 2015 15:33:00 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39174305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39174305&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java &amp;#8212;&lt;br/&gt;
    @@ -1004,10 +989,38 @@ public ExecutionConfig getExecutionConfig() {&lt;br/&gt;
     	@SuppressWarnings(&quot;unchecked&quot;)&lt;br/&gt;
     	public &amp;lt;X extends Tuple&amp;gt; DataStreamSink&amp;lt;T&amp;gt; writeAsCsv(String path, WriteMode writeMode,&lt;br/&gt;
     			long millis) &lt;/p&gt;
{
    +		return writeAsCsv(path, writeMode, millis, CsvOutputFormat.DEFAULT_LINE_DELIMITER, CsvOutputFormat.DEFAULT_FIELD_DELIMITER);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Writes a DataStream to the file specified by path in csv format. The&lt;br/&gt;
    +	 * writing is performed periodically, in every millis milliseconds.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * For every field of an element of the DataStream the result of &lt;/p&gt;
{@link Object#toString()}
&lt;p&gt;    +	 * is written. This method can only be used on data streams of tuples.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param path&lt;br/&gt;
    +	 *            the path pointing to the location the text file is written to&lt;br/&gt;
    +	 * @param writeMode&lt;br/&gt;
    +	 *            Controls the behavior for existing files. Options are&lt;br/&gt;
    +	 *            NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +	 * @param millis&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Please add both delimiter parameters to the JavaDocs.&lt;/p&gt;</comment>
                            <comment id="14738944" author="githubbot" created="Thu, 10 Sep 2015 15:41:31 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39175337&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39175337&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala &amp;#8212;&lt;br/&gt;
    @@ -727,13 +727,118 @@ class DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(javaStream: JavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;) {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Control the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This method does not have a `millis` parameter. Please fix the documentation.&lt;/p&gt;</comment>
                            <comment id="14738949" author="githubbot" created="Thu, 10 Sep 2015 15:45:15 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39175801&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39175801&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala &amp;#8212;&lt;br/&gt;
    @@ -727,13 +727,118 @@ class DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(javaStream: JavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;) {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param writeMode
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    please add the `path` parameter as well.&lt;/p&gt;</comment>
                            <comment id="14738951" author="githubbot" created="Thu, 10 Sep 2015 15:46:08 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39175887&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39175887&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala &amp;#8212;&lt;br/&gt;
    @@ -727,13 +727,118 @@ class DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(javaStream: JavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;) {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Control the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +      path: String,&lt;br/&gt;
    +      writeMode: FileSystem.WriteMode): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +    if (writeMode != null) {
    +      javaStream.writeAsText(path, writeMode)
    +    } else {
    +      javaStream.writeAsText(path)
    +    }    +  }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in text format. The&lt;br/&gt;
    +   * writing is performed periodically, in every millis milliseconds. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Control the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +      path: String,&lt;br/&gt;
    +      writeMode: FileSystem.WriteMode,&lt;br/&gt;
    +      millis: Long): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +    if (writeMode != null) {
    +      javaStream.writeAsText(path, writeMode, millis)
    +    } else {
    +      javaStream.writeAsText(path, millis)
    +    }    +  }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in text format. The&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    `writeToCsv` does not write `in text format` and does also not use the `.toString` method.&lt;br/&gt;
    Please fix the documentation.&lt;/p&gt;</comment>
                            <comment id="14738976" author="githubbot" created="Thu, 10 Sep 2015 15:56:31 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39177248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39177248&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -36,6 +37,10 @@ protected void preSubmit() throws Exception {&lt;br/&gt;
     	@Override&lt;br/&gt;
     	protected void testProgram() throws Exception {&lt;br/&gt;
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Is this actually working? &lt;br/&gt;
    I thought by default files are not overwritten. So writing to the same file again, should not work and the second job should fail.&lt;/p&gt;</comment>
                            <comment id="14739039" author="githubbot" created="Thu, 10 Sep 2015 16:20:00 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139299973&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139299973&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Please check the documentation of the newly added functions.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The text corresponds to the function (CSV and text output, not mentioning parameters which are not offered by the method, ...)&lt;/li&gt;
	&lt;li&gt;All method parameters are described&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Can you also double check that the test which overwrites files is working and if it is, why the write mode is set to OVERWRITE (should be NO_OVERWRITE)?&lt;br/&gt;
    Thanks&lt;/p&gt;</comment>
                            <comment id="14740054" author="githubbot" created="Fri, 11 Sep 2015 02:42:17 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39237069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39237069&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -36,6 +37,10 @@ protected void preSubmit() throws Exception {&lt;br/&gt;
     	@Override&lt;br/&gt;
     	protected void testProgram() throws Exception {&lt;br/&gt;
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    The `writeMode` by setting default is already exist.&lt;br/&gt;
    It will check whether the file can be overwrite or not in `FileOutputFormat.java`:&lt;br/&gt;
    `private static final void initDefaultsFromConfiguration(Configuration configuration) &lt;/p&gt;
{
    		final boolean overwrite = configuration.getBoolean(ConfigConstants
    						.FILESYSTEM_DEFAULT_OVERWRITE_KEY,
    				ConfigConstants.DEFAULT_FILESYSTEM_OVERWRITE);
    	
    		DEFAULT_WRITE_MODE = overwrite ? WriteMode.OVERWRITE : WriteMode.NO_OVERWRITE;
    		
    		final boolean alwaysCreateDirectory = configuration.getBoolean(ConfigConstants
    						.FILESYSTEM_OUTPUT_ALWAYS_CREATE_DIRECTORY_KEY,
    			ConfigConstants.DEFAULT_FILESYSTEM_ALWAYS_CREATE_DIRECTORY);
    	
    		DEFAULT_OUTPUT_DIRECTORY_MODE = alwaysCreateDirectory ? OutputDirectoryMode.ALWAYS : OutputDirectoryMode.PARONLY;
    	}
&lt;p&gt;`&lt;/p&gt;</comment>
                            <comment id="14740061" author="githubbot" created="Fri, 11 Sep 2015 02:55:17 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139436457&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139436457&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @fhueske &lt;br/&gt;
    Hi, if I change to the NO_OVERWRITE in the `CsvOutputFormatITCase.java`, tests will fail with errors following:&lt;br/&gt;
    `Caused by: java.io.IOException: File already exists:&lt;a href=&quot;file:/C:/Users/H00292~1/AppData/Local/Temp/org.apache.flink.streaming.scala.api.CsvOutputFormatITCase-result/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/Users/H00292~1/AppData/Local/Temp/org.apache.flink.streaming.scala.api.CsvOutputFormatITCase-result/1&lt;/a&gt;&lt;br/&gt;
    	at org.apache.flink.core.fs.local.LocalFileSystem.create(LocalFileSystem.java:247)&lt;br/&gt;
    	at org.apache.flink.core.fs.local.LocalFileSystem.create(LocalFileSystem.java:263)&lt;br/&gt;
    	at org.apache.flink.api.common.io.FileOutputFormat.open(FileOutputFormat.java:247)&lt;br/&gt;
    	at org.apache.flink.api.scala.operators.ScalaCsvOutputFormat.open(ScalaCsvOutputFormat.java:161)&lt;br/&gt;
    	at org.apache.flink.streaming.api.functions.sink.FileSinkFunction.open(FileSinkFunction.java:58)&lt;br/&gt;
    	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:33)&lt;br/&gt;
    	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:69)&lt;br/&gt;
    	at org.apache.flink.streaming.runtime.tasks.StreamTask.openAllOperators(StreamTask.java:232)&lt;br/&gt;
    	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:167)&lt;br/&gt;
    	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:581)&lt;br/&gt;
    	at java.lang.Thread.run(Thread.java:722)`&lt;/p&gt;

&lt;p&gt;    This is due to the exist file check in `LocalFileSystem.java`.&lt;br/&gt;
    See the code following:&lt;br/&gt;
    `if (exists(f) &amp;amp;&amp;amp; !overwrite) &lt;/p&gt;
{
    			throw new IOException(&quot;File already exists:&quot; + f);
    		}
&lt;p&gt;`&lt;/p&gt;</comment>
                            <comment id="14740098" author="githubbot" created="Fri, 11 Sep 2015 03:25:19 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139443340&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139443340&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, I think there is a issue that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;if you want to no overwrite in a exist file, you will get the error &quot;File already exists&quot;&lt;/li&gt;
	&lt;li&gt;if you want to no overwrite and the file is not exist, the `NO_OVERWRITE` is just the same as `OVERWRITE`&lt;br/&gt;
    So I think currently the `NO_OVERWRITE` is not make sense.&lt;br/&gt;
    Maybe we need discuss and fix on it through a new JIRA?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14740454" author="githubbot" created="Fri, 11 Sep 2015 09:08:59 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39253553&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39253553&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -36,6 +37,10 @@ protected void preSubmit() throws Exception {&lt;br/&gt;
     	@Override&lt;br/&gt;
     	protected void testProgram() throws Exception {&lt;br/&gt;
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    It is expected that the test fails if you set the overwrite mode to `NO_OVERWRITE` because you start multiple programs that all write to the same location.&lt;/p&gt;

&lt;p&gt;    I debugged the issue and found that the `ForkableFlinkMiniCluster` sets the overwrite mode to OVERWRITE. That explains the behavior. However, this also means that you cannot test the correctness of your methods by setting the overwrite mode to OVERWRITE because this is the default behavior.&lt;/p&gt;

&lt;p&gt;    I would change the `CsvOuputFormatITCase` to extend `StreamingMultipleProgramsTestBase` and run each program in a dedicated test method. &lt;/p&gt;</comment>
                            <comment id="14740456" author="githubbot" created="Fri, 11 Sep 2015 09:11:29 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139494655&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139494655&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The semantics of `NO_OVERWRITE` are correct and pretty clear, IMO. &lt;br/&gt;
    If we would change `NO_OVERWRITE` to even fail if there is no file, it&apos;s semantics would change to `NO_WRITE` and always fail. &lt;/p&gt;</comment>
                            <comment id="14740460" author="githubbot" created="Fri, 11 Sep 2015 09:16:18 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139496123&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139496123&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Doesn&apos;t `NO_OVERWRITE` mean &quot;append&quot;?&lt;/p&gt;</comment>
                            <comment id="14740463" author="githubbot" created="Fri, 11 Sep 2015 09:21:10 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r39254440&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r39254440&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -36,6 +37,10 @@ protected void preSubmit() throws Exception {&lt;br/&gt;
     	@Override&lt;br/&gt;
     	protected void testProgram() throws Exception {&lt;br/&gt;
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    If it is expected to fail, could you tell me how to pass the test?&lt;br/&gt;
    Just I have no idea about this.&lt;/p&gt;</comment>
                            <comment id="14740473" author="githubbot" created="Fri, 11 Sep 2015 09:31:15 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139499368&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139499368&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    There is no append. `OVERWRITE` simply overwrites existing files and `NO_OVERWRITE` fails if the output file exists.&lt;/p&gt;</comment>
                            <comment id="14740475" author="githubbot" created="Fri, 11 Sep 2015 09:32:32 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139499573&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139499573&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    What&apos;s the purpose of adding `javaSet` to the Table API? &lt;br/&gt;
    This looks like a separate issue to me and should not be part of this PR if that is the case.&lt;/p&gt;</comment>
                            <comment id="14740489" author="githubbot" created="Fri, 11 Sep 2015 09:40:20 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139500923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139500923&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    `What&apos;s the purpose of adding javaSet to the Table API? &lt;br/&gt;
    This looks like a separate issue to me and should not be part of this PR if that is the case.`&lt;/p&gt;

&lt;p&gt;    It is because of this following:&lt;br/&gt;
    !&lt;span class=&quot;error&quot;&gt;&amp;#91;image&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://cloud.githubusercontent.com/assets/13193847/9811803/11922a28-58ac-11e5-9f3f-4451f7db3b02.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cloud.githubusercontent.com/assets/13193847/9811803/11922a28-58ac-11e5-9f3f-4451f7db3b02.png&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="14740525" author="githubbot" created="Fri, 11 Sep 2015 10:13:51 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139507227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139507227&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I still cannot understand what is the purpose of adding `javaSet` to the Table API. We can get the `DataSet` by using `toDataSet` method.&lt;/p&gt;</comment>
                            <comment id="14740527" author="githubbot" created="Fri, 11 Sep 2015 10:16:01 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139507621&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139507621&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Basically, we should prevent modifying the current Table API tests. This PR covers about streaming API only.&lt;/p&gt;</comment>
                            <comment id="14740551" author="githubbot" created="Fri, 11 Sep 2015 10:39:08 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139513146&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139513146&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    As you know, It seems because of ambiguousness between `Table` from `DataSet` and that from `DataStream`. We need refactor for Table API.&lt;/p&gt;</comment>
                            <comment id="14742768" author="githubbot" created="Mon, 14 Sep 2015 00:55:12 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-139933029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-139933029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    `I still cannot understand what is the purpose of adding javaSet to the Table API. We can get the DataSet by using toDataSet method.`&lt;/p&gt;

&lt;p&gt;    @fhueske &lt;br/&gt;
    @chiwanpark &lt;br/&gt;
    Hi, don&apos;t think too complicated.&lt;br/&gt;
    This is just about the compile error for the Table API tests since I added the `def writeAsText( filePath: String, writeMode: FileSystem.WriteMode = null): DataSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;` method in `DataStream.scala`.&lt;br/&gt;
    For easy understanding, you can also take a experiment that add the method and you will get some errors in these Table API tests.&lt;br/&gt;
    To add the `javaSet` just a way that I can pass these tests and I&apos;m not sure this change is suitable.&lt;br/&gt;
    If not, how can I do?&lt;br/&gt;
    Refactor Table API in a new JIRA or here?&lt;/p&gt;</comment>
                            <comment id="14745463" author="githubbot" created="Tue, 15 Sep 2015 13:40:50 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-140396374&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-140396374&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @fhueske &lt;br/&gt;
    @chiwanpark &lt;br/&gt;
    Hello!&lt;br/&gt;
    I opened a new PR:&lt;a href=&quot;https://github.com/apache/flink/pull/1131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1131&lt;/a&gt; to fix the problem of Table API tests.&lt;br/&gt;
    Is it valid?&lt;br/&gt;
    I just want to pass the tests while fixing this PR.&lt;/p&gt;</comment>
                            <comment id="14791072" author="githubbot" created="Wed, 16 Sep 2015 20:24:21 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-140877442&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-140877442&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @HuangWHWHW, your PR #1131 has been merged.&lt;br/&gt;
    Can you update this PR and remove those changes?&lt;br/&gt;
    Thanks!&lt;/p&gt;</comment>
                            <comment id="14791372" author="githubbot" created="Thu, 17 Sep 2015 00:41:00 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-140934136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-140934136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yes, I will take a fix for the comments&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14805142" author="githubbot" created="Fri, 18 Sep 2015 07:38:40 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141371306&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141371306&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I updated the PR:&lt;br/&gt;
    1.Update the class and method documentation.&lt;br/&gt;
    2.Change the test to `extends StreamingMultipleProgramsTestBase` and split the tests.&lt;br/&gt;
    3.Add the fail tests for `NO_OVERWRITE`.&lt;/p&gt;</comment>
                            <comment id="14876915" author="githubbot" created="Sat, 19 Sep 2015 06:10:42 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141629775&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141629775&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi, could anyone tell me why the last CI failed?&lt;br/&gt;
    Thanks&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14876916" author="githubbot" created="Sat, 19 Sep 2015 06:13:28 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141629844&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141629844&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    There is a checkstyle error:&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; There is 1 error reported by Checkstyle 6.2 with /tools/maven/checkstyle.xml ruleset.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java&lt;span class=&quot;error&quot;&gt;&amp;#91;992&amp;#93;&lt;/span&gt; (regexp) RegexpSinglelineJava: Line has leading space characters; indentation should be performed with tabs only.&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="14876941" author="githubbot" created="Sat, 19 Sep 2015 07:03:55 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141631769&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141631769&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Many thanks!&lt;br/&gt;
    Fixed it.&lt;/p&gt;</comment>
                            <comment id="14900315" author="githubbot" created="Mon, 21 Sep 2015 07:28:28 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141897668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141897668&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    All checkstyle errors can also be found by simply executiong `mvn verify`&lt;br/&gt;
    on your local machine. That way you can directly see what&apos;s going wrong.&lt;/p&gt;

&lt;p&gt;    On Sat, Sep 19, 2015 at 9:03 AM, HuangWHWHW &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
    wrote:&lt;/p&gt;

&lt;p&gt;    &amp;gt; Many thanks!&lt;br/&gt;
    &amp;gt; Fixed it.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &#8212;&lt;br/&gt;
    &amp;gt; Reply to this email directly or view it on GitHub&lt;br/&gt;
    &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141631769&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141631769&lt;/a&gt;&amp;gt;.&lt;br/&gt;
    &amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14900324" author="githubbot" created="Mon, 21 Sep 2015 07:35:05 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141898429&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141898429&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Thanks!&lt;br/&gt;
    For saving the time, I usually `run mvn` verify in the sub-module where I changed.&lt;br/&gt;
    So, I forgot the DataStream.java in the other module before.&lt;/p&gt;

&lt;p&gt;    And I can see the CI detail now, and is the CI error following related to me?&lt;br/&gt;
    `Tests in error: &lt;br/&gt;
    org.apache.flink.yarn.YARNSessionFIFOITCase.testJavaAPI(org.apache.flink.yarn.YARNSessionFIFOITCase)&lt;br/&gt;
      Run 1: YARNSessionFIFOITCase.testJavaAPI:642 &#187; Runtime Unable to get Cluster status f...&lt;br/&gt;
      Run 2: YARNSessionFIFOITCase.checkForProhibitedLogContents:94-&amp;gt;YarnTestBase.ensureNoProhibitedStringInLogFiles:294 Found a file /home/travis/build/apache/flink/flink-yarn-tests/target/flink-yarn-tests-fifo/flink-yarn-tests-fifo-logDir-nm-1_0/application_1442651724242_0009/container_1442651724242_0009_01_000001/jobmanager-main.log with a prohibited string: &lt;span class=&quot;error&quot;&gt;&amp;#91;Exception, Started SelectChannelConnector@0.0.0.0:8081&amp;#93;&lt;/span&gt;&lt;br/&gt;
    `&lt;br/&gt;
    I&apos;ll try to rerun the CI and may report this error if this is not due to my PR.&lt;/p&gt;</comment>
                            <comment id="14900344" author="githubbot" created="Mon, 21 Sep 2015 07:56:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141902080&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141902080&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This test shouldn&apos;t be related to your changes. Currently, our yarn tests&lt;br/&gt;
    are a bit instable. But Robert is working on it.&lt;/p&gt;

&lt;p&gt;    On Mon, Sep 21, 2015 at 9:35 AM, HuangWHWHW &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
    wrote:&lt;/p&gt;

&lt;p&gt;    &amp;gt; @tillrohrmann &amp;lt;&lt;a href=&quot;https://github.com/tillrohrmann&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann&lt;/a&gt;&amp;gt;&lt;br/&gt;
    &amp;gt; Thanks!&lt;br/&gt;
    &amp;gt; For saving the time, I usually run mvn verify in the sub-module where I&lt;br/&gt;
    &amp;gt; changed.&lt;br/&gt;
    &amp;gt; So, I forgot the DataStream.java in the other module before.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; And I can see the CI detail now, and is the CI error following related to&lt;br/&gt;
    &amp;gt; me?&lt;br/&gt;
    &amp;gt; Tests in error:&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; org.apache.flink.yarn.YARNSessionFIFOITCase.testJavaAPI(org.apache.flink.yarn.YARNSessionFIFOITCase)&lt;br/&gt;
    &amp;gt; Run 1: YARNSessionFIFOITCase.testJavaAPI:642 &#187; Runtime Unable to get&lt;br/&gt;
    &amp;gt; Cluster status f...&lt;br/&gt;
    &amp;gt; Run 2:&lt;br/&gt;
    &amp;gt; YARNSessionFIFOITCase.checkForProhibitedLogContents:94-&amp;gt;YarnTestBase.ensureNoProhibitedStringInLogFiles:294&lt;br/&gt;
    &amp;gt; Found a file&lt;br/&gt;
    &amp;gt; /home/travis/build/apache/flink/flink-yarn-tests/target/flink-yarn-tests-fifo/flink-yarn-tests-fifo-logDir-nm-1_0/application_1442651724242_0009/container_1442651724242_0009_01_000001/jobmanager-main.log&lt;br/&gt;
    &amp;gt; with a prohibited string: [Exception, Started&lt;br/&gt;
    &amp;gt; SelectChannelConnector@0.0.0.0:8081]&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; I&apos;ll try to rerun the CI and may report this error if this is not due to&lt;br/&gt;
    &amp;gt; my PR.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &#8212;&lt;br/&gt;
    &amp;gt; Reply to this email directly or view it on GitHub&lt;br/&gt;
    &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141898429&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141898429&lt;/a&gt;&amp;gt;.&lt;br/&gt;
    &amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14900492" author="githubbot" created="Mon, 21 Sep 2015 10:43:03 +0000"  >&lt;p&gt;Github user HuangWHWHW commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-141938601&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-141938601&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann &lt;br/&gt;
    Thanks for the info.Passed the CI now.&lt;br/&gt;
    Could anyone take a full review?&lt;br/&gt;
    &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15024677" author="githubbot" created="Tue, 24 Nov 2015 15:30:53 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r45749750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r45749750&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala &amp;#8212;&lt;br/&gt;
    @@ -717,23 +717,188 @@ class DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(javaStream: JavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;) {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
        */&lt;br/&gt;
       def writeAsText(path: String, millis: Long = 0): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; =&lt;br/&gt;
         javaStream.writeAsText(path, millis)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in text format. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Controls the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +       path: String,&lt;br/&gt;
    +       writeMode: FileSystem.WriteMode): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +    if (writeMode != null) &lt;/p&gt;
{
    +      javaStream.writeAsText(path, writeMode)
    +    }
&lt;p&gt; else &lt;/p&gt;
{
    +      javaStream.writeAsText(path)
    +    }
&lt;p&gt;    +  }&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Writes a DataStream to the file specified by path in text format. The&lt;/li&gt;
	&lt;li&gt;writing is performed periodically, in every millis milliseconds. For&lt;/li&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Controls the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +       path: String,&lt;br/&gt;
    +       writeMode: FileSystem.WriteMode,&lt;br/&gt;
    +       millis: Long): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +    if (writeMode != null) {
    +      javaStream.writeAsText(path, writeMode, millis)
    +    } else {
    +      javaStream.writeAsText(path, millis)
    +    }    +  }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in csv format. The&lt;br/&gt;
    +   * writing is performed periodically, in every millis milliseconds. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsCsv(&lt;br/&gt;
    +      path: String,&lt;br/&gt;
    +      millis: Long = 0): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +    require(javaStream.getType.isTupleType, &quot;CSV output can only be used with Tuple DataSets.&quot;)&lt;br/&gt;
    +    val of = new ScalaCsvOutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;Product&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      new Path(path),&lt;br/&gt;
    +      ScalaCsvOutputFormat.DEFAULT_LINE_DELIMITER,&lt;br/&gt;
    +      ScalaCsvOutputFormat.DEFAULT_FIELD_DELIMITER)&lt;br/&gt;
    +    javaStream.write(of.asInstanceOf[OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;], millis)&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Could you call `writeAsCsv(String, WriteMode, Long, String, String)` here with the respective parameter values instead? That way we have only one place where we have to apply changes.&lt;/p&gt;</comment>
                            <comment id="15024680" author="githubbot" created="Tue, 24 Nov 2015 15:31:10 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r45749794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r45749794&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/main/scala/org/apache/flink/streaming/api/scala/DataStream.scala &amp;#8212;&lt;br/&gt;
    @@ -717,23 +717,188 @@ class DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(javaStream: JavaStream&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;) {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
        */&lt;br/&gt;
       def writeAsText(path: String, millis: Long = 0): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; =&lt;br/&gt;
         javaStream.writeAsText(path, millis)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in text format. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Controls the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +       path: String,&lt;br/&gt;
    +       writeMode: FileSystem.WriteMode): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +    if (writeMode != null) &lt;/p&gt;
{
    +      javaStream.writeAsText(path, writeMode)
    +    }
&lt;p&gt; else &lt;/p&gt;
{
    +      javaStream.writeAsText(path)
    +    }
&lt;p&gt;    +  }&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Writes a DataStream to the file specified by path in text format. The&lt;/li&gt;
	&lt;li&gt;writing is performed periodically, in every millis milliseconds. For&lt;/li&gt;
	&lt;li&gt;every element of the DataStream the result of .toString&lt;/li&gt;
	&lt;li&gt;is written.&lt;br/&gt;
        *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Controls the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   *&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsText(&lt;br/&gt;
    +       path: String,&lt;br/&gt;
    +       writeMode: FileSystem.WriteMode,&lt;br/&gt;
    +       millis: Long): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +    if (writeMode != null) {
    +      javaStream.writeAsText(path, writeMode, millis)
    +    } else {
    +      javaStream.writeAsText(path, millis)
    +    }    +  }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in csv format. The&lt;br/&gt;
    +   * writing is performed periodically, in every millis milliseconds. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param millis&lt;br/&gt;
    +   * the file update frequency&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsCsv(&lt;br/&gt;
    +      path: String,&lt;br/&gt;
    +      millis: Long = 0): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = &lt;/p&gt;
{
    +    require(javaStream.getType.isTupleType, &quot;CSV output can only be used with Tuple DataSets.&quot;)
    +    val of = new ScalaCsvOutputFormat[Product](
    +      new Path(path),
    +      ScalaCsvOutputFormat.DEFAULT_LINE_DELIMITER,
    +      ScalaCsvOutputFormat.DEFAULT_FIELD_DELIMITER)
    +    javaStream.write(of.asInstanceOf[OutputFormat[T]], millis)
    +  }
&lt;p&gt;    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +   * Writes a DataStream to the file specified by path in csv format. For&lt;br/&gt;
    +   * every element of the DataStream the result of .toString&lt;br/&gt;
    +   * is written.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param path&lt;br/&gt;
    +   * the path pointing to the location the text file is written to&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @param writeMode&lt;br/&gt;
    +   * Controls the behavior for existing files. Options are&lt;br/&gt;
    +   * NO_OVERWRITE and OVERWRITE.&lt;br/&gt;
    +   *&lt;br/&gt;
    +   * @return the closed DataStream&lt;br/&gt;
    +   */&lt;br/&gt;
    +  def writeAsCsv(&lt;br/&gt;
    +      path: String,&lt;br/&gt;
    +      writeMode: FileSystem.WriteMode): DataStreamSink&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +    require(javaStream.getType.isTupleType, &quot;CSV output can only be used with Tuple DataSets.&quot;)&lt;br/&gt;
    +    val of = new ScalaCsvOutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;Product&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      new Path(path),&lt;br/&gt;
    +      ScalaCsvOutputFormat.DEFAULT_LINE_DELIMITER,&lt;br/&gt;
    +      ScalaCsvOutputFormat.DEFAULT_FIELD_DELIMITER)&lt;br/&gt;
    +    if (writeMode != null) &lt;/p&gt;
{
    +      of.setWriteMode(writeMode)
    +    }
&lt;p&gt;    +    javaStream.write(of.asInstanceOf[OutputFormat&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;], 0L)&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Same here: Call the most generic method here.&lt;/p&gt;</comment>
                            <comment id="15024686" author="githubbot" created="Tue, 24 Nov 2015 15:35:20 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r45750373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r45750373&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/TextOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -17,27 +17,86 @@&lt;/p&gt;

&lt;p&gt;     package org.apache.flink.streaming.scala.api;&lt;/p&gt;

&lt;p&gt;    +import junit.framework.Assert;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
     import org.apache.flink.streaming.api.scala.OutputFormatTestPrograms;&lt;br/&gt;
    -import org.apache.flink.streaming.util.StreamingProgramTestBase;&lt;br/&gt;
    +import org.apache.flink.streaming.util.StreamingMultipleProgramsTestBase;&lt;br/&gt;
     import org.apache.flink.test.testdata.WordCountData;&lt;br/&gt;
    +import org.apache.flink.test.util.AbstractTestBase;&lt;br/&gt;
    +import org.junit.After;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;/p&gt;

&lt;p&gt;    -public class TextOutputFormatITCase extends StreamingProgramTestBase {&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +public class TextOutputFormatITCase extends StreamingMultipleProgramsTestBase {&lt;/p&gt;

&lt;p&gt;     	protected String resultPath;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void preSubmit() throws Exception {&lt;/li&gt;
	&lt;li&gt;resultPath = getTempDirPath(&quot;result&quot;);&lt;br/&gt;
    +	public AbstractTestBase fileInfo = new AbstractTestBase(new Configuration()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		@Override    +		public void startCluster() throws Exception {
    +			super.startCluster();
    +		}    +	}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void createFile() throws Exception &lt;/p&gt;
{
    +		File f = fileInfo.createAndRegisterTempFile(&quot;result&quot;);
    +		resultPath = f.toURI().toString();
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPath() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathMillis() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteMode() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteModeMillis() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteMode() throws Exception &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath);    +		try {
    +			OutputFormatTestPrograms.wordCountToText(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +		} catch (Exception e) {
    +			assertTrue(e.getCause().getMessage().indexOf(&quot;File already exists&quot;) != -1);
    +			return;
    +		}    +		Assert.fail();     	}&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void testProgram() throws Exception {&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteModeMillis() throws Exception {
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    camel case&lt;/p&gt;</comment>
                            <comment id="15024693" author="githubbot" created="Tue, 24 Nov 2015 15:40:29 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r45751049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r45751049&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -17,32 +17,107 @@&lt;/p&gt;

&lt;p&gt;     package org.apache.flink.streaming.scala.api;&lt;/p&gt;

&lt;p&gt;    +import junit.framework.Assert;&lt;br/&gt;
     import org.apache.flink.api.common.functions.FlatMapFunction;&lt;br/&gt;
     import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
     import org.apache.flink.streaming.api.scala.OutputFormatTestPrograms;&lt;br/&gt;
    -import org.apache.flink.streaming.util.StreamingProgramTestBase;&lt;br/&gt;
    +import org.apache.flink.streaming.util.StreamingMultipleProgramsTestBase;&lt;br/&gt;
     import org.apache.flink.test.testdata.WordCountData;&lt;br/&gt;
    +import org.apache.flink.test.util.AbstractTestBase;&lt;br/&gt;
     import org.apache.flink.util.Collector;&lt;br/&gt;
    +import org.junit.After;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;/p&gt;

&lt;p&gt;    -public class CsvOutputFormatITCase extends StreamingProgramTestBase {&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +public class CsvOutputFormatITCase extends StreamingMultipleProgramsTestBase  {&lt;/p&gt;

&lt;p&gt;     	protected String resultPath;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void preSubmit() throws Exception {&lt;/li&gt;
	&lt;li&gt;resultPath = getTempDirPath(&quot;result&quot;);&lt;br/&gt;
    +	public AbstractTestBase fileInfo = new AbstractTestBase(new Configuration()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		@Override    +		public void startCluster() throws Exception {
    +			super.startCluster();
    +		}    +	}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void createFile() throws Exception &lt;/p&gt;
{
    +		File f = fileInfo.createAndRegisterTempFile(&quot;result&quot;);
    +		resultPath = f.toURI().toString();
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void testProgram() throws Exception {&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPath() throws Exception 
{
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void postSubmit() throws Exception {&lt;/li&gt;
	&lt;li&gt;//Strip the parentheses from the expected text like output&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathMillis() throws Exception 
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteMode() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteModeMillis() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteModeMillisDelimiter() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1, &quot;\n&quot;, &quot;,&quot;);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteMode() throws Exception &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);    +		try {
    +			OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +		} catch (Exception e) {
    +			assertTrue(e.getCause().getMessage().indexOf(&quot;File already exists&quot;) != -1);
    +			return;
    +		}&lt;br/&gt;
    +		Assert.fail();&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteModeMillis() throws Exception {&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		try {
    +			OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1);
    +		} catch (Exception e) {    +			assertTrue(e.getCause().getMessage().indexOf(&quot;File already exists&quot;) != -1);    +			return;    +		}    +		Assert.fail();    +	}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteModeMillisDelimiter() throws Exception {&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1, &quot;\n&quot;, &quot;,&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Would be good to test the method with some other values than the default parameter values. That way you see that these values are correctly forwarded.&lt;/p&gt;</comment>
                            <comment id="15024695" author="githubbot" created="Tue, 24 Nov 2015 15:40:55 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#discussion_r45751119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#discussion_r45751119&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-staging/flink-streaming/flink-streaming-scala/src/test/java/org/apache/flink/streaming/scala/api/CsvOutputFormatITCase.java &amp;#8212;&lt;br/&gt;
    @@ -17,32 +17,107 @@&lt;/p&gt;

&lt;p&gt;     package org.apache.flink.streaming.scala.api;&lt;/p&gt;

&lt;p&gt;    +import junit.framework.Assert;&lt;br/&gt;
     import org.apache.flink.api.common.functions.FlatMapFunction;&lt;br/&gt;
     import org.apache.flink.api.java.tuple.Tuple2;&lt;br/&gt;
    +import org.apache.flink.configuration.Configuration;&lt;br/&gt;
    +import org.apache.flink.core.fs.FileSystem;&lt;br/&gt;
     import org.apache.flink.streaming.api.scala.OutputFormatTestPrograms;&lt;br/&gt;
    -import org.apache.flink.streaming.util.StreamingProgramTestBase;&lt;br/&gt;
    +import org.apache.flink.streaming.util.StreamingMultipleProgramsTestBase;&lt;br/&gt;
     import org.apache.flink.test.testdata.WordCountData;&lt;br/&gt;
    +import org.apache.flink.test.util.AbstractTestBase;&lt;br/&gt;
     import org.apache.flink.util.Collector;&lt;br/&gt;
    +import org.junit.After;&lt;br/&gt;
    +import org.junit.Before;&lt;br/&gt;
    +import org.junit.Test;&lt;/p&gt;

&lt;p&gt;    -public class CsvOutputFormatITCase extends StreamingProgramTestBase {&lt;br/&gt;
    +import java.io.File;&lt;br/&gt;
    +import static org.junit.Assert.assertTrue;&lt;br/&gt;
    +&lt;br/&gt;
    +&lt;br/&gt;
    +public class CsvOutputFormatITCase extends StreamingMultipleProgramsTestBase  {&lt;/p&gt;

&lt;p&gt;     	protected String resultPath;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void preSubmit() throws Exception {&lt;/li&gt;
	&lt;li&gt;resultPath = getTempDirPath(&quot;result&quot;);&lt;br/&gt;
    +	public AbstractTestBase fileInfo = new AbstractTestBase(new Configuration()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		@Override    +		public void startCluster() throws Exception {
    +			super.startCluster();
    +		}    +	}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +	@Before&lt;br/&gt;
    +	public void createFile() throws Exception &lt;/p&gt;
{
    +		File f = fileInfo.createAndRegisterTempFile(&quot;result&quot;);
    +		resultPath = f.toURI().toString();
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void testProgram() throws Exception {&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPath() throws Exception 
{
     		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);
     	}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;protected void postSubmit() throws Exception {&lt;/li&gt;
	&lt;li&gt;//Strip the parentheses from the expected text like output&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathMillis() throws Exception 
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteMode() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteModeMillis() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testPathWriteModeMillisDelimiter() throws Exception &lt;/p&gt;
{
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1, &quot;\n&quot;, &quot;,&quot;);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteMode() throws Exception &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);    +		try {
    +			OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE);
    +		} catch (Exception e) {
    +			assertTrue(e.getCause().getMessage().indexOf(&quot;File already exists&quot;) != -1);
    +			return;
    +		}    +		Assert.fail();    +	}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    +&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void failtestPathWriteModeMillis() throws Exception {&lt;br/&gt;
    +		OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath);&lt;br/&gt;
    +		try {&lt;br/&gt;
    +			OutputFormatTestPrograms.wordCountToCsv(WordCountData.TEXT, resultPath, FileSystem.WriteMode.NO_OVERWRITE, 1);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    How do you test that the `millis` parameter is respected?&lt;/p&gt;</comment>
                            <comment id="15024698" author="githubbot" created="Tue, 24 Nov 2015 15:42:27 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-159308288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-159308288&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @HuangWHWHW, sorry for the late review. Things piled up in the last weeks. Do you wan to finish this PR?&lt;/p&gt;

&lt;p&gt;    I had some comments. I think that the PR is in a good shape right now. After addressing my comments it should be good to be merged.&lt;/p&gt;</comment>
                            <comment id="15041559" author="githubbot" created="Fri, 4 Dec 2015 13:36:10 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-161969662&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-161969662&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Apparently, you&apos;re no longer up for the task. I&apos;ll take over then.&lt;/p&gt;</comment>
                            <comment id="15066332" author="githubbot" created="Mon, 21 Dec 2015 11:10:30 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Align Scala streaming writeAsCsv API call with Java API&lt;/p&gt;

&lt;p&gt;    Allows the Scala API to call `writeAsCsv` with the same parameters as the Java API does.&lt;/p&gt;

&lt;p&gt;    This PR is a take over of PR #1098, which does not show activity anymore.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1473&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c936e8bfa8a7fff12028606ff32b3054e63ee7a8&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-09-18T07:31:29Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2622&quot; title=&quot;Scala DataStream API does not have writeAsText method which supports WriteMode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2622&quot;&gt;&lt;del&gt;FLINK-2622&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;streaming&amp;#93;&lt;/span&gt; Align Scala streaming writeAsCsv API call with Java API&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15066546" author="githubbot" created="Mon, 21 Dec 2015 15:15:35 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473#discussion_r48154545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473#discussion_r48154545&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java &amp;#8212;&lt;br/&gt;
    @@ -937,26 +941,40 @@ public ExecutionConfig getExecutionConfig() {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;NO_OVERWRITE and OVERWRITE.&lt;/li&gt;
	&lt;li&gt;@param millis&lt;/li&gt;
	&lt;li&gt;the file update frequency&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*&lt;br/&gt;
    +	 * @param rowDelimiter&lt;br/&gt;
    +	 *            the delimiter for two rows&lt;br/&gt;
    +	 * @param fieldDelimiter&lt;br/&gt;
    +	 *            the delimiter for two fields&lt;br/&gt;
    +	 *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@return the closed DataStream&lt;br/&gt;
     	 */&lt;br/&gt;
     	@SuppressWarnings(&quot;unchecked&quot;)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public &amp;lt;X extends Tuple&amp;gt; DataStreamSink&amp;lt;T&amp;gt; writeAsCsv(String path, WriteMode writeMode,&lt;/li&gt;
	&lt;li&gt;long millis) {&lt;/li&gt;
	&lt;li&gt;Preconditions.checkArgument(getType().isTupleType(),&lt;/li&gt;
	&lt;li&gt;&quot;The writeAsCsv() method can only be used on data sets of tuples.&quot;);&lt;/li&gt;
	&lt;li&gt;CsvOutputFormat&amp;lt;X&amp;gt; of = new CsvOutputFormat&amp;lt;X&amp;gt;(new Path(path),&lt;/li&gt;
	&lt;li&gt;CsvOutputFormat.DEFAULT_LINE_DELIMITER, CsvOutputFormat.DEFAULT_FIELD_DELIMITER);&lt;br/&gt;
    +	public &amp;lt;X extends Tuple&amp;gt; DataStreamSink&amp;lt;T&amp;gt; writeAsCsv(&lt;br/&gt;
    +			String path,&lt;br/&gt;
    +			WriteMode writeMode,&lt;br/&gt;
    +			long millis,&lt;br/&gt;
    +			String rowDelimiter,&lt;br/&gt;
    +			String fieldDelimiter) {&lt;br/&gt;
    +		Preconditions.checkArgument(&lt;br/&gt;
    +			getType().isTupleType(),&lt;br/&gt;
    +			&quot;The writeAsCsv() method can only be used on data sets of tuples.&quot;);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    &quot;data sets&quot; should be &quot;data streams&quot;&lt;/p&gt;</comment>
                            <comment id="15066559" author="githubbot" created="Mon, 21 Dec 2015 15:21:49 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473#discussion_r48155123&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473#discussion_r48155123&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/datastream/DataStream.java &amp;#8212;&lt;br/&gt;
    @@ -937,26 +941,40 @@ public ExecutionConfig getExecutionConfig() {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;NO_OVERWRITE and OVERWRITE.&lt;/li&gt;
	&lt;li&gt;@param millis&lt;/li&gt;
	&lt;li&gt;the file update frequency&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*&lt;br/&gt;
    +	 * @param rowDelimiter&lt;br/&gt;
    +	 *            the delimiter for two rows&lt;br/&gt;
    +	 * @param fieldDelimiter&lt;br/&gt;
    +	 *            the delimiter for two fields&lt;br/&gt;
    +	 *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@return the closed DataStream&lt;br/&gt;
     	 */&lt;br/&gt;
     	@SuppressWarnings(&quot;unchecked&quot;)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public &amp;lt;X extends Tuple&amp;gt; DataStreamSink&amp;lt;T&amp;gt; writeAsCsv(String path, WriteMode writeMode,&lt;/li&gt;
	&lt;li&gt;long millis) {&lt;/li&gt;
	&lt;li&gt;Preconditions.checkArgument(getType().isTupleType(),&lt;/li&gt;
	&lt;li&gt;&quot;The writeAsCsv() method can only be used on data sets of tuples.&quot;);&lt;/li&gt;
	&lt;li&gt;CsvOutputFormat&amp;lt;X&amp;gt; of = new CsvOutputFormat&amp;lt;X&amp;gt;(new Path(path),&lt;/li&gt;
	&lt;li&gt;CsvOutputFormat.DEFAULT_LINE_DELIMITER, CsvOutputFormat.DEFAULT_FIELD_DELIMITER);&lt;br/&gt;
    +	public &amp;lt;X extends Tuple&amp;gt; DataStreamSink&amp;lt;T&amp;gt; writeAsCsv(&lt;br/&gt;
    +			String path,&lt;br/&gt;
    +			WriteMode writeMode,&lt;br/&gt;
    +			long millis,&lt;br/&gt;
    +			String rowDelimiter,&lt;br/&gt;
    +			String fieldDelimiter) {&lt;br/&gt;
    +		Preconditions.checkArgument(&lt;br/&gt;
    +			getType().isTupleType(),&lt;br/&gt;
    +			&quot;The writeAsCsv() method can only be used on data sets of tuples.&quot;);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Good catch. Will change it. Thx.&lt;/p&gt;</comment>
                            <comment id="15066562" author="githubbot" created="Mon, 21 Dec 2015 15:23:58 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473#issuecomment-166329040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473#issuecomment-166329040&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM. Will merge&lt;/p&gt;</comment>
                            <comment id="15066602" author="githubbot" created="Mon, 21 Dec 2015 15:52:54 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098#issuecomment-166338012&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098#issuecomment-166338012&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for working on this issue!&lt;br/&gt;
    I&apos;ll close this PR due to inactivity and PR #1473.&lt;/p&gt;</comment>
                            <comment id="15066770" author="githubbot" created="Mon, 21 Dec 2015 17:44:30 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1473&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1473&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15066771" author="githubbot" created="Mon, 21 Dec 2015 17:44:30 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1098&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1098&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15066775" author="fhueske" created="Mon, 21 Dec 2015 17:46:33 +0000"  >&lt;p&gt;Fixed with c08bcf1e008397bfe22353e3ba3d9d9656e7d3c1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 48 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jsfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>