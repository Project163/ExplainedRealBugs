<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:21:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-36240] Incorrect Port display in the PrometheusReporter constructor</title>
                <link>https://issues.apache.org/jira/browse/FLINK-36240</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In Flink v1.17 I found a problem with the PrometheusReporter constructor that is still there. When the &lt;tt&gt;PrometheusReporter&lt;/tt&gt;&#160;fails to start on any configured port, the error message does not correctly display the configured ports. Instead of printing the actual port numbers, the error message outputs the&#160;&lt;tt&gt;Iterator&lt;/tt&gt;&apos;s toString representation, which is not helpful for debugging.&lt;/p&gt;

&lt;p&gt;The relevant code snippet is as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &#160; PrometheusReporter(Iterator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; ports) {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (ports.hasNext()) {
&#160; &#160; &#160; &#160; &#160; &#160; port = ports.next();
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; httpServer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTTPServer(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InetSocketAddress(port), &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.registry);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Started PrometheusReporter HTTP server on port {}.&quot;&lt;/span&gt;, port);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ioe) { &lt;span class=&quot;code-comment&quot;&gt;// assume port conflict
&lt;/span&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; log.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Could not start PrometheusReporter HTTP server on port {}.&quot;&lt;/span&gt;, port, ioe);
&#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; }

&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (httpServer == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;Could not start PrometheusReporter HTTP server on any configured port. Ports: &quot;&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; + ports);
&#160; &#160; &#160; &#160; }
&#160; &#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The RuntimeException logs the Iterator object reference instead of the actual list of port numbers:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Could not start PrometheusReporter HTTP server on any configured port. Ports: org.apache.flink.util.UnionIterator@67065fd3&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To make the error message more informative, it would be better to log the actual port numbers by collecting them into a list or converting the&#160;&lt;tt&gt;Iterator&lt;/tt&gt; to a string representation of the configured ports. This change will significantly improve the debugging process for port-related issues in the PrometheusReporter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13591495">FLINK-36240</key>
            <summary>Incorrect Port display in the PrometheusReporter constructor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eon2208">Arkadiusz Dankiewicz</assignee>
                                    <reporter username="eon2208">Arkadiusz Dankiewicz</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 9 Sep 2024 11:42:05 +0000</created>
                <updated>Thu, 19 Sep 2024 17:44:26 +0000</updated>
                            <resolved>Thu, 19 Sep 2024 17:44:26 +0000</resolved>
                                    <version>1.17.2</version>
                    <version>1.18.1</version>
                    <version>1.20.0</version>
                    <version>1.19.1</version>
                                    <fixVersion>2.0-preview</fixVersion>
                                    <component>Runtime / Metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17880280" author="JIRAUSER301246" created="Mon, 9 Sep 2024 11:42:43 +0000"  >&lt;p&gt;As this is my first contribution to the ASF, I would appreciate any guidance on the next steps in the contribution process. Specifically, I would like to know what the chances are that I could implement the fix myself.&lt;/p&gt;</comment>
                            <comment id="17881769" author="JIRAUSER306586" created="Sat, 14 Sep 2024 10:52:04 +0000"  >&lt;p&gt;Thank you for reporting the problem and the volunteering to fix it! &lt;/p&gt;

&lt;p&gt;Regarding necessary steps, for any information when you are unsure about a step feel free to ask or go through the info here:&lt;br/&gt;
&lt;a href=&quot;https://flink.apache.org/how-to-contribute/contribute-code/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://flink.apache.org/how-to-contribute/contribute-code/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Since this is fairly small and easy fix, feel free to open a PR against &lt;tt&gt;master&lt;/tt&gt; (that means it will be fixed in 2.0, if you feel like it would be important to backport, we can talk about that as well), make sure your code is formatted correctly (calling &lt;tt&gt;mvn spotless:apply&lt;/tt&gt; does that for you), and then I volunteer to take a look at your changes.&lt;/p&gt;</comment>
                            <comment id="17881865" author="JIRAUSER301246" created="Sun, 15 Sep 2024 18:08:27 +0000"  >&lt;p&gt;Thanks for the assignment. I have just created the pull request with an additional section for discussion as I am curious about alternative solutions. Looking forward to your response.&#160;&lt;/p&gt;</comment>
                            <comment id="17883081" author="JIRAUSER306586" created="Thu, 19 Sep 2024 17:44:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/flink/commit/20e9826f7701f91eedfbf599afb33822128145e6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;20e9826&lt;/a&gt; in master&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13592470">FLINK-36316</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rbc0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>