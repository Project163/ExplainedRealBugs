<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:59:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-23420] sql stream mode lag function java.lang.NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/FLINK-23420</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;flink 1.13.1&#160; BlinkPlanner&#160; StreamingMode&#160; EXACTLY_ONCE&lt;/p&gt;

&lt;p&gt;log&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-07-15 21:07:46,328 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 1 (type=CHECKPOINT) @ 1626354466304 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; job fd3c2294afe74778cb6ce3bd5d42f0c0.
2021-07-15 21:07:46,774 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - OverAggregate(partitionBy=[targetId], orderBy=[lastDt ASC], window=[ RANG BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], select=[displayId, mmsi, latitude, longitude, course, heading, speed, len, minLen, maxLen, wid, id, province, nationality, lastTm, status, vesselName, sClass, targetId, lastDt, $20, LAG(displayId) AS w0$o0, LAG(mmsi) AS w0$o1, LAG($20) AS w0$o2, LAG(latitude) AS w0$o3, LAG(longitude) AS w0$o4, LAG(course) AS w0$o5, LAG(heading) AS w0$o6, LAG(speed) AS w0$o7, LAG(len) AS w0$o8, LAG(minLen) AS w0$o9, LAG(maxLen) AS w0$o10, LAG(wid) AS w0$o11, LAG(id) AS w0$o12, LAG(province) AS w0$o13, LAG(nationality) AS w0$o14, LAG(lastTm) AS w0$o15, LAG(status) AS w0$o16, LAG(vesselName) AS w0$o17, LAG(sClass) AS w0$o18, LAG(targetId) AS w0$o19, LAG(lastDt) AS w0$o20]) -&amp;gt; Calc(select=[displayId, mmsi, $20 AS state, latitude, longitude, course, heading, speed, len, minLen, maxLen, wid, id, province, nationality, lastTm, status, vesselName, sClass, targetId, lastDt, w0$o0 AS previous_displayId, w0$o1 AS previous_mmsi, w0$o2 AS previous_state, w0$o3 AS previous_latitude, w0$o4 AS previous_longitude, w0$o5 AS previous_course, w0$o6 AS previous_heading, w0$o7 AS previous_speed, w0$o8 AS previous_len, w0$o9 AS previous_minLen, w0$o10 AS previous_maxLen, w0$o11 AS previous_wid, w0$o12 AS previous_id, w0$o13 AS previous_province, w0$o14 AS previous_nationality, w0$o15 AS previous_lastTm, w0$o16 AS previous_status, w0$o17 AS previous_vesselName, w0$o18 AS previous_sClass, w0$o19 AS previous_targetId, CAST(w0$o20) AS previous_lastDt], where=[(w0$o1 &amp;lt;&amp;gt; mmsi)]) -&amp;gt; TableToDataSteam(type=ROW&amp;lt;`displayId` INT, `mmsi` INT, `state` TINYINT, `latitude` DOUBLE, `longitude` DOUBLE, `course` FLOAT, `heading` FLOAT, `speed` FLOAT, `len` INT, `minLen` INT, `maxLen` INT, `wid` INT, `id` STRING, `province` STRING, `nationality` STRING, `lastTm` BIGINT, `status` STRING, `vesselName` STRING, `sClass` STRING, `targetId` STRING, `lastDt` TIMESTAMP(3), `previous_displayId` INT, `previous_mmsi` INT, `previous_state` TINYINT, `previous_latitude` DOUBLE, `previous_longitude` DOUBLE, `previous_course` FLOAT, `previous_heading` FLOAT, `previous_speed` FLOAT, `previous_len` INT, `previous_minLen` INT, `previous_maxLen` INT, `previous_wid` INT, `previous_id` STRING, `previous_province` STRING, `previous_nationality` STRING, `previous_lastTm` BIGINT, `previous_status` STRING, `previous_vesselName` STRING, `previous_sClass` STRING, `previous_targetId` STRING, `previous_lastDt` TIMESTAMP(3)&amp;gt; NOT NULL, rowtime=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) (3/3) (34f17a50932ba7852cff00dabecae88e) switched from RUNNING to FAILED on container_1625646226467_0291_01_000005 @ hadoop-15 (dataPort=38082).
java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at org.apache.flink.api.common.typeutils.base.IntSerializer.serialize(IntSerializer.java:67) ~[hlx_bigdata_flink.jar:?]
	at org.apache.flink.api.common.typeutils.base.IntSerializer.serialize(IntSerializer.java:30) ~[hlx_bigdata_flink.jar:?]
	at org.apache.flink.table.runtime.typeutils.LinkedListSerializer.serialize(LinkedListSerializer.java:114) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.LinkedListSerializer.serialize(LinkedListSerializer.java:39) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.util.InstantiationUtil.serializeToByteArray(InstantiationUtil.java:558) ~[hlx_bigdata_flink.jar:?]
	at org.apache.flink.table.data.binary.BinaryRawValueData.materialize(BinaryRawValueData.java:113) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.data.binary.LazyBinaryFormat.ensureMaterialized(LazyBinaryFormat.java:126) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RawValueDataSerializer.copy(RawValueDataSerializer.java:60) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RawValueDataSerializer.copy(RawValueDataSerializer.java:36) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copyRowData(RowDataSerializer.java:170) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:131) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:48) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copyRowData(RowDataSerializer.java:170) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:131) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:48) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.state.heap.CopyOnWriteStateMap.get(CopyOnWriteStateMap.java:287) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.state.heap.StateTable.get(StateTable.java:267) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.state.heap.StateTable.get(StateTable.java:141) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.state.heap.HeapValueState.value(HeapValueState.java:72) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.table.runtime.operators.over.AbstractRowTimeUnboundedPrecedingOver.onTimer(AbstractRowTimeUnboundedPrecedingOver.java:213) ~[flink-table-blink_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.api.operators.KeyedProcessOperator.invokeUserFunction(KeyedProcessOperator.java:91) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.api.operators.KeyedProcessOperator.onEventTime(KeyedProcessOperator.java:70) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.api.operators.InternalTimerServiceImpl.advanceWatermark(InternalTimerServiceImpl.java:302) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.api.operators.InternalTimeServiceManagerImpl.advanceWatermark(InternalTimeServiceManagerImpl.java:180) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.processWatermark(AbstractStreamOperator.java:626) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask$StreamTaskNetworkOutput.emitWatermark(OneInputStreamTask.java:211) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.streamstatus.StatusWatermarkValve.findAndOutputNewMinWatermarkAcrossAlignedChannels(StatusWatermarkValve.java:196) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.streamstatus.StatusWatermarkValve.inputWatermark(StatusWatermarkValve.java:105) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.processElement(AbstractStreamTaskNetworkInput.java:136) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.emitNext(AbstractStreamTaskNetworkInput.java:105) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:66) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:423) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:204) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:681) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.executeInvoke(StreamTask.java:636) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:620) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:779) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:566) ~[flink-dist_2.11-1.13.1.jar:1.13.1]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748) ~[?:1.8.0_251]
2021-07-15 21:07:46,804 INFO  org.apache.flink.runtime.executiongraph.failover.flip1.RestartPipelinedRegionFailoverStrategy [] - Calculating tasks to restart to recover the failed task 244ba2b64f33b53ee2f9b4b8d233e03c_2.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;table sql&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
|CREATE TABLE unionTargetJs (
|  `displayId` INT,
|  `mmsi` INT,
|  `state` TINYINT,
|  `latitude` DOUBLE,
|  `longitude` DOUBLE,
|  `course` FLOAT,
|  `heading` FLOAT,
|  `speed` FLOAT,
|  `len` INT,
|  `minLen` INT,
|  `maxLen` INT,
|  `wid` INT,
|  `id` STRING,
|  `province` STRING,
|  `nationality` STRING,
|  `lastTm` BIGINT,
|  `status` STRING,
|  `vesselName` STRING,
|  `sClass` STRING,
|  `targetId` AS TargetIdFunction(`displayId`, `province`, `id`),
|  `lastDt` AS TO_TIMESTAMP(FROM_UNIXTIME(lastTm / 1000, &lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy-MM-dd HH:mm:ss&apos;&lt;/span&gt;)),
|  WATERMARK FOR `lastDt` AS `lastDt` - INTERVAL &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt; SECOND
|) WITH (
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;kafka&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;topic&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;unionTargetJs&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.bootstrap.servers&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;$kafkaAddress&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.group.id&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;aisChangeOrClose&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;scan.startup.mode&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;group-offsets&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;json&apos;&lt;/span&gt;,
|  &lt;span class=&quot;code-quote&quot;&gt;&apos;properties.auto.offset.reset&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;latest&apos;&lt;/span&gt;
|)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;select sql&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
|SELECT
|  `displayId`,
|  `mmsi`,
|  `state`,
|  `latitude`,
|  `longitude`,
|  `course`,
|  `heading`,
|  `speed`,
|  `len`,
|  `minLen`,
|  `maxLen`,
|  `wid`,
|  `id`,
|  `province`,
|  `nationality`,
|  `lastTm`,
|  `status`,
|  `vesselName`,
|  `sClass`,
|  `targetId`,
|  `lastDt`,
| lag( displayId ) OVER w AS `previous_displayId`,
|  lag( mmsi ) OVER w AS `previous_mmsi`,
|  lag( state ) OVER w AS `previous_state`,
|  lag( latitude ) OVER w AS `previous_latitude`,
|  lag( longitude ) OVER w AS `previous_longitude`,
|  lag( course ) OVER w AS `previous_course`,
|  lag( heading ) OVER w AS `previous_heading`,
|  lag( speed ) OVER w AS `previous_speed`,
|  lag( len ) OVER w AS `previous_len`,
|  lag( minLen ) OVER w AS `previous_minLen`,
|  lag( maxLen ) OVER w AS `previous_maxLen`,
|  lag( wid ) OVER w AS `previous_wid`,
|  lag( id ) OVER w AS `previous_id`,
|  lag( province ) OVER w AS `previous_province`,
|  lag( nationality ) OVER w AS `previous_nationality`,
|  lag( lastTm ) OVER w AS `previous_lastTm`,
|  lag( status ) OVER w AS `previous_status`,
|  lag( vesselName ) OVER w AS `previous_vesselName`,
|  lag( sClass ) OVER w AS `previous_sClass`,
|  lag( targetId ) OVER w AS `previous_targetId`,
| CAST(lag( lastDt ) OVER w AS TIMESTAMP(3)) AS `previous_lastDt`
|FROM
|  unionTargetJs
|WHERE
|  province &amp;lt;&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;CeShi&apos;&lt;/span&gt;
|  AND state = 1
| AND status &amp;lt;&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;DELETED&apos;&lt;/span&gt;
|WINDOW w AS (
|   PARTITION BY targetId
|   ORDER BY lastDt)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;udf&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TargetIdFunction &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ScalarFunction {
  def eval(displayId: &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, province: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, id: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;): &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; = {
    displayId + ProvinceUtil.getProvinceEnumValue(province) + id
  }
}



&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ProvinceUtil {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; PROVINCE_MAP = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; {
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;CeShi&quot;&lt;/span&gt;, ProvinceEnum.CS.getValue());

        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;HaiNan&quot;&lt;/span&gt;, ProvinceEnum.HI.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;ShanDong&quot;&lt;/span&gt;, ProvinceEnum.SD.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;FuJian&quot;&lt;/span&gt;, ProvinceEnum.FJ.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;HeBei&quot;&lt;/span&gt;, ProvinceEnum.HE.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;GuangDong&quot;&lt;/span&gt;, ProvinceEnum.GD.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;GuangXi&quot;&lt;/span&gt;, ProvinceEnum.GX.getValue());
        PROVINCE_MAP.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;ZheJiang&quot;&lt;/span&gt;, ProvinceEnum.ZJ.getValue());
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getProvinceEnumValue(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; key) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; PROVINCE_MAP.get(key);
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
 &#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13390589">FLINK-23420</key>
            <summary>sql stream mode lag function java.lang.NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="TsReaper">Caizhi Weng</assignee>
                                    <reporter username="xiechenling">xiechenling</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 19 Jul 2021 02:28:15 +0000</created>
                <updated>Fri, 20 Aug 2021 03:29:09 +0000</updated>
                            <resolved>Fri, 20 Aug 2021 03:29:09 +0000</resolved>
                                    <version>1.13.1</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.3</fixVersion>
                                    <component>Table SQL / Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17382967" author="jark" created="Mon, 19 Jul 2021 03:12:25 +0000"  >&lt;p&gt;It seems you hard-code to use the internal &lt;tt&gt;LinkedListSerializer&lt;/tt&gt; in your UDF &lt;tt&gt;TargetIdFunction&lt;/tt&gt;. The &lt;tt&gt;LinkedListSerializer&lt;/tt&gt; looks like have a bug when serializing nullable elements.  cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17382976" author="lzljs3620320" created="Mon, 19 Jul 2021 03:55:23 +0000"  >&lt;p&gt;LinkedListSerializer is OK, the problem is in LagAggFunction.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedListSerializer&amp;lt;&amp;gt;(serializer)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We should wrap serializer by NullableSerializer to deal with nullable values.&lt;/p&gt;</comment>
                            <comment id="17382986" author="jark" created="Mon, 19 Jul 2021 04:22:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;, usually, it&apos;s the responsibility of collection serializer to handle nullable elements, see &lt;tt&gt;MapSerializer&lt;/tt&gt; and &lt;tt&gt;RowSerializer&lt;/tt&gt;.&lt;br/&gt;
However, we should be careful with the state-compatibility when fixing this problem. &lt;/p&gt;</comment>
                            <comment id="17383004" author="lzljs3620320" created="Mon, 19 Jul 2021 05:17:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; Thanks for the reminding about state-compatibility. Yes, maybe this is why ListSerializer and LinkedListSerializer not handle nullable elements.&lt;/p&gt;</comment>
                            <comment id="17388695" author="tsreaper" created="Wed, 28 Jul 2021 11:21:36 +0000"  >&lt;p&gt;Hi all!&lt;/p&gt;

&lt;p&gt;Actually &lt;tt&gt;LinkedListSerializer&lt;/tt&gt; is a serializer in the table module, while other serializers in table module (such as &lt;tt&gt;MapDataSerializer&lt;/tt&gt; and &lt;tt&gt;ArrayDataSerializer&lt;/tt&gt;) are all aware of null values. So I think we just need to let&#160;&lt;tt&gt;LinkedListSerializer&lt;/tt&gt; support null values.&lt;/p&gt;

&lt;p&gt;I&apos;d like to take this issue. Please assign it to me.&lt;/p&gt;</comment>
                            <comment id="17388700" author="lzljs3620320" created="Wed, 28 Jul 2021 11:29:17 +0000"  >&lt;p&gt;We can use TypeSerializerSnapshot to deal with state-compatibility.&lt;/p&gt;</comment>
                            <comment id="17400241" author="lzljs3620320" created="Tue, 17 Aug 2021 08:25:02 +0000"  >&lt;p&gt;master: d5f7b959599d1e8a4df594bcd014010bda27339f&lt;br/&gt;
release-1.13: dd80a1a5b2cddb3ceab6a01a2ef1a4924e6d4178&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13392326">FLINK-23529</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t3xk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>