<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:34:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10281] Fix string literal escaping throughout Table &amp; SQL API</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10281</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;for example,&#160; regular expression&#160;matches text (&quot;\w&quot;) or number (&quot;\d&quot;) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
testAllApis(
  &lt;span class=&quot;code-quote&quot;&gt;&quot;foothebar&quot;&lt;/span&gt;.regexExtract(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo([\\w]+)&quot;&lt;/span&gt;, 1),       &lt;span class=&quot;code-comment&quot;&gt;//OK, the method got &lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\w]+)&apos;&lt;/span&gt;
&lt;/span&gt;  &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;foothebar&apos;&lt;/span&gt;.regexExtract(&lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\\\\w]+)&apos;&lt;/span&gt;, 1)&quot;&lt;/span&gt;,   &lt;span class=&quot;code-comment&quot;&gt;//failed, the method got &lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\\w]+)&apos;&lt;/span&gt; returns &quot;&quot;, but &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; pass &lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\\w]+)&apos;&lt;/span&gt; would get compile error.
&lt;/span&gt;  &lt;span class=&quot;code-quote&quot;&gt;&quot;REGEX_EXTRACT(&lt;span class=&quot;code-quote&quot;&gt;&apos;foothebar&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\\\\w]+)&apos;&lt;/span&gt;, 1)&quot;&lt;/span&gt;, &lt;span class=&quot;code-comment&quot;&gt;//OK, the method got &lt;span class=&quot;code-quote&quot;&gt;&apos;foo([\w]+)&apos;&lt;/span&gt; but must pass four &lt;span class=&quot;code-quote&quot;&gt;&apos;\&apos;&lt;/span&gt;
&lt;/span&gt;  &lt;span class=&quot;code-quote&quot;&gt;&quot;thebar&quot;&lt;/span&gt;
)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the &quot;similar to&quot; function has the same issue.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Update:&lt;/p&gt;

&lt;p&gt;Proper escaping of quotes was not possible in the past for Table API. SQL and SQL Client&lt;br/&gt;
 were not standard compliant.&lt;/p&gt;

&lt;p&gt;Due to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8301&quot; title=&quot;Support Unicode in codegen for SQL &amp;amp;&amp;amp; TableAPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8301&quot;&gt;&lt;del&gt;FLINK-8301&lt;/del&gt;&lt;/a&gt; backslashes were considered in SQL literals, however, they&lt;br/&gt;
 should only be used in SQL `U&amp;amp;&apos;\1234&apos;` literals. For the Table API, the new&lt;br/&gt;
 logic relies on the Java/Scala escaping and uses duplicate quotes for escaping&lt;br/&gt;
 the quotes in expression strings. For SQL, we rely on unicode string literals&lt;br/&gt;
 with or without the UESCAPE clause. The SQL Client was using backslashes for&lt;br/&gt;
 escaping new lines. For the SQL Client, we allow unescaped new lines and&lt;br/&gt;
 use &apos;;&apos; for statement finalization; similar to other SQL clients.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13183027">FLINK-10281</key>
            <summary>Fix string literal escaping throughout Table &amp; SQL API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="yanghua">vinoyang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Wed, 5 Sep 2018 03:30:12 +0000</created>
                <updated>Wed, 12 Sep 2018 14:20:05 +0000</updated>
                            <resolved>Wed, 12 Sep 2018 14:19:54 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16604103" author="githubbot" created="Wed, 5 Sep 2018 08:21:10 +0000"  >&lt;p&gt;yanghua opened a new pull request #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659&lt;/a&gt;&lt;/p&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   &lt;b&gt;This pull request fixes Table function parse regular expression contains backslash failed&lt;/b&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;Changed `singleQuoteStringLiteral` in `ExpressionParser`&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;



&lt;p&gt;   This change is already covered by existing tests, such as &lt;b&gt;LiteralTest#testParseRegularExpression&lt;/b&gt;.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable / docs / JavaDocs / *&lt;b&gt;not documented&lt;/b&gt;*)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16604274" author="githubbot" created="Wed, 5 Sep 2018 10:56:16 +0000"  >&lt;p&gt;yanghua commented on issue #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#issuecomment-418688875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#issuecomment-418688875&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @twalthr @fhueske &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16605703" author="githubbot" created="Thu, 6 Sep 2018 12:21:09 +0000"  >&lt;p&gt;yanghua commented on issue #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#issuecomment-419073183&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#issuecomment-419073183&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @hequn8128 can you review this?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16605936" author="githubbot" created="Thu, 6 Sep 2018 15:34:11 +0000"  >&lt;p&gt;twalthr commented on a change in pull request #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#discussion_r215673314&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#discussion_r215673314&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -186,7 +186,7 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
       }&lt;/p&gt;

&lt;p&gt;   lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;{4})*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ {&lt;br/&gt;
+    (&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p{Cntrl}
&lt;p&gt;]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I&apos;m not 100% sure if this is the correct fix. The regular expression has been adapted from Scala&apos;s `JavaTokenParsers`. Maybe we just need to update it as done &lt;span class=&quot;error&quot;&gt;&amp;#91;here&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://github.com/scala/scala-parser-combinators/blob/1.1.x/shared/src/main/scala/scala/util/parsing/combinator/JavaTokenParsers.scala)?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/scala/scala-parser-combinators/blob/1.1.x/shared/src/main/scala/scala/util/parsing/combinator/JavaTokenParsers.scala)?&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16605960" author="githubbot" created="Thu, 6 Sep 2018 15:50:09 +0000"  >&lt;p&gt;yanghua commented on a change in pull request #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#discussion_r215679341&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#discussion_r215679341&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -186,7 +186,7 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
       }&lt;/p&gt;

&lt;p&gt;   lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;{4})*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ {&lt;br/&gt;
+    (&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p{Cntrl}
&lt;p&gt;]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I don&apos;t know if modifying the scala library will have a bigger impact. In fact, looking at this line, we are already customizing (expanding) this regular expression. My personal suggestion is that we only modify this regular expression for single quotes. (At the moment we only found problems in the single quotes scenario), and other forms have not been found, and it has passed all test cases, so it can be said that this change has no effect on other current parsing cases. But if we don&apos;t modify it, then all parsing of `\d`, &apos;\w&apos; and other regulars beginning with a backslash are wrong.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16607052" author="githubbot" created="Fri, 7 Sep 2018 12:26:23 +0000"  >&lt;p&gt;twalthr opened a new pull request #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table API&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   This PR fixes the string literal parsing of the Table API. Proper escaping of the quotes was not possible in the past. The logic was overly complicated and was not handling escaping correctly. The new logic relies on the Java/Scala programs escaping and uses duplicate quotes for escaping the quotes (see the docs).&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Rework of the string literals for `ExpressionParser`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   This change added tests and can be verified as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;`org.apache.flink.table.expressions.LiteralTest#testStringLiterals`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? docs&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16607061" author="githubbot" created="Fri, 7 Sep 2018 12:33:06 +0000"  >&lt;p&gt;twalthr commented on issue #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#issuecomment-419425099&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#issuecomment-419425099&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @yanghua I found more issues related to this topic when testing your code. I fixed it in #6671. What do you think about this changes?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16607069" author="githubbot" created="Fri, 7 Sep 2018 12:42:39 +0000"  >&lt;p&gt;yanghua commented on issue #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#issuecomment-419427295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#issuecomment-419427295&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @twalthr It looks good, in fact I only saw the problem of parsing backslashes in single quotes, because we were having trouble using regular expressions. And you have found and solved more problems for special symbols.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16607122" author="githubbot" created="Fri, 7 Sep 2018 13:27:39 +0000"  >&lt;p&gt;dawidwys commented on issue #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table API&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#issuecomment-419438925&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#issuecomment-419438925&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   +1, Looks good from my side.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16608767" author="githubbot" created="Mon, 10 Sep 2018 06:09:53 +0000"  >&lt;p&gt;hequn8128 commented on a change in pull request #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table API&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#discussion_r216206820&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#discussion_r216206820&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -185,13 +185,18 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
           }&lt;br/&gt;
       }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/li&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}
&lt;p&gt;\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ &lt;/p&gt;
{
-      str =&amp;gt; Literal(str.substring(1, str.length - 1))
-    }
&lt;p&gt;+  // string with single quotes such as &apos;It&apos;&apos;s me.&apos;&lt;br/&gt;
+  lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = &quot;&apos;((?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)*)&apos;&quot;.r ^^ {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Should we also add `?:` in the outer matches? Same for `doubleQuoteStringLiteral `.&lt;br/&gt;
   ((?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)&lt;b&gt;)-&amp;gt; (?&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)&lt;/b&gt;)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16608769" author="githubbot" created="Mon, 10 Sep 2018 06:11:28 +0000"  >&lt;p&gt;hequn8128 commented on a change in pull request #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table API&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#discussion_r216206820&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#discussion_r216206820&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -185,13 +185,18 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
           }&lt;br/&gt;
       }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/li&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}
&lt;p&gt;\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ &lt;/p&gt;
{
-      str =&amp;gt; Literal(str.substring(1, str.length - 1))
-    }
&lt;p&gt;+  // string with single quotes such as &apos;It&apos;&apos;s me.&apos;&lt;br/&gt;
+  lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = &quot;&apos;((?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)*)&apos;&quot;.r ^^ {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Should we also add `?:` in the outer matches? Same for `doubleQuoteStringLiteral `.&lt;br/&gt;
   ((?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)&lt;b&gt;)-&amp;gt; (?&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)&lt;/b&gt;)&lt;br/&gt;
   Add `?:` in order to match expressions but does not remember the match.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16610744" author="githubbot" created="Tue, 11 Sep 2018 14:53:59 +0000"  >&lt;p&gt;twalthr commented on issue #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table API&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#issuecomment-420303028&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#issuecomment-420303028&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thank you @hequn8128 and @dawidwys. I found severe problems how escaping was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8301&quot; title=&quot;Support Unicode in codegen for SQL &amp;amp;&amp;amp; TableAPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8301&quot;&gt;&lt;del&gt;FLINK-8301&lt;/del&gt;&lt;/a&gt;. This should not have been merged without an additional committer looking at it. With my new commits I hope that I could address all problems with escaping in Table API, SQL API, and SQL Client. Please take another look.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16610803" author="githubbot" created="Tue, 11 Sep 2018 15:34:06 +0000"  >&lt;p&gt;yanghua commented on issue #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659#issuecomment-420317010&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659#issuecomment-420317010&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   PR #6671 fixed it more graciously, so closing this PR. thanks @twalthr &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16610804" author="githubbot" created="Tue, 11 Sep 2018 15:34:06 +0000"  >&lt;p&gt;yanghua closed pull request #6659: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Table function parse regular expression contains backslash failed&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6659&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
index c0a577dccfd..3ed627a3e03 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
@@ -186,7 +186,7 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
       }&lt;/p&gt;

&lt;p&gt;   lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;{4})*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ {&lt;br/&gt;
+    (&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p{Cntrl}
&lt;p&gt;]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ &lt;/p&gt;
{
       str =&amp;gt; Literal(str.substring(1, str.length - 1))
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
index 0a60eae0e5f..8a839c0799c 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
@@ -25,6 +25,8 @@ import org.apache.flink.table.api.Types&lt;br/&gt;
 import org.apache.flink.table.expressions.utils.&lt;/p&gt;
{ExpressionTestBase, Func3}
&lt;p&gt; import org.apache.flink.table.functions.ScalarFunction&lt;br/&gt;
 import org.apache.flink.types.Row&lt;br/&gt;
+&lt;br/&gt;
+import org.junit.Assert.assertEquals&lt;br/&gt;
 import org.junit.Test&lt;/p&gt;

&lt;p&gt; class LiteralTest extends ExpressionTestBase {&lt;br/&gt;
@@ -88,6 +90,19 @@ class LiteralTest extends ExpressionTestBase &lt;/p&gt;
{
       s&quot;42 and $hello&quot;)
   }

&lt;p&gt;+  @Test&lt;br/&gt;
+  def testParseRegularExpression(): Unit = {&lt;br/&gt;
+    assertEquals(&lt;br/&gt;
+      &quot;foo(&lt;a href=&quot;file://w&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;\\w&lt;/a&gt;+)&quot;,&lt;br/&gt;
+      (ExpressionParser.parseExpression(&quot;&apos;foothebar&apos;.regexExtract(&apos;foo(&lt;a href=&quot;file://w&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;\\w&lt;/a&gt;+)&apos;, 1)&quot;))&lt;br/&gt;
+        .asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Call&amp;#93;&lt;/span&gt;.args(1).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Literal&amp;#93;&lt;/span&gt;.value)&lt;br/&gt;
+&lt;br/&gt;
+    assertEquals(&lt;br/&gt;
+      &quot;&lt;br class=&quot;atl-forced-newline&quot; /&gt;d&lt;/p&gt;
{3}&quot;,&lt;br/&gt;
+      (ExpressionParser.parseExpression(&quot;&apos;123&apos;.similar(&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;d{3}
&lt;p&gt;&apos;)&quot;))&lt;br/&gt;
+        .asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Call&amp;#93;&lt;/span&gt;.args(1).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Literal&amp;#93;&lt;/span&gt;.value)&lt;br/&gt;
+  }&lt;br/&gt;
+&lt;br/&gt;
   def testData: Any = {&lt;br/&gt;
     val testData = new Row(4)&lt;br/&gt;
     testData.setField(0, &quot;trUeX_value&quot;)&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611902" author="githubbot" created="Wed, 12 Sep 2018 10:42:39 +0000"  >&lt;p&gt;dawidwys commented on issue #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table &amp;amp; SQL API and SQL Client&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#issuecomment-420601057&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#issuecomment-420601057&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   I&apos;ve had another look after the new changes and I am ok with them as well. One slight comment if it is not a big effort maybe split it into two commits in that order:&lt;/p&gt;

&lt;p&gt;   1. Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8301&quot; title=&quot;Support Unicode in codegen for SQL &amp;amp;&amp;amp; TableAPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8301&quot;&gt;&lt;del&gt;FLINK-8301&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
   2. &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611965" author="githubbot" created="Wed, 12 Sep 2018 11:38:35 +0000"  >&lt;p&gt;twalthr commented on issue #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table &amp;amp; SQL API and SQL Client&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671#issuecomment-420616795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671#issuecomment-420616795&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thank you @dawidwys. I will improve the commits and merge this.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16612204" author="githubbot" created="Wed, 12 Sep 2018 14:18:57 +0000"  >&lt;p&gt;asfgit closed pull request #6671: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10281&quot; title=&quot;Fix string literal escaping throughout Table &amp;amp; SQL API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10281&quot;&gt;&lt;del&gt;FLINK-10281&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Fix string literal parsing in Table &amp;amp; SQL API and SQL Client&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6671&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/docs/dev/table/sql.md b/docs/dev/table/sql.md&lt;br/&gt;
index 604e9890708..a9fd94f10d5 100644&lt;br/&gt;
&amp;#8212; a/docs/dev/table/sql.md&lt;br/&gt;
+++ b/docs/dev/table/sql.md&lt;br/&gt;
@@ -204,6 +204,11 @@ Flink SQL uses a lexical policy for identifier (table, attribute, function names&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;After which, identifiers are matched case-sensitively.&lt;/li&gt;
	&lt;li&gt;Unlike Java, back-ticks allow identifiers to contain non-alphanumeric characters (e.g. &amp;lt;code&amp;gt;&quot;SELECT a AS `my field` FROM t&quot;&amp;lt;/code&amp;gt;).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+String literals must be enclosed in single quotes (e.g., `SELECT &apos;Hello World&apos;`). Duplicate a single quote for escaping (e.g., `SELECT &apos;It&apos;&apos;s me.&apos;`). Unicode characters are supported in string literals. If explicit unicode code points are required, use the following syntax:&lt;br/&gt;
+&lt;br/&gt;
+- Use the backslash (`\`) as escaping character (default): `SELECT U&amp;amp;&apos;\263A&apos;`&lt;br/&gt;
+- Use a custom escaping character: `SELECT U&amp;amp;&apos;#263A&apos; UESCAPE &apos;#&apos;`&lt;br/&gt;
+&lt;/p&gt;
 {% top %}

&lt;p&gt; Operations&lt;br/&gt;
diff --git a/docs/dev/table/sqlClient.md b/docs/dev/table/sqlClient.md&lt;br/&gt;
index 8c4ba83c6dc..8462202572d 100644&lt;br/&gt;
&amp;#8212; a/docs/dev/table/sqlClient.md&lt;br/&gt;
+++ b/docs/dev/table/sqlClient.md&lt;br/&gt;
@@ -61,7 +61,7 @@ By default, the SQL Client will read its configuration from the environment file&lt;br/&gt;
 Once the CLI has been started, you can use the `HELP` command to list all available SQL statements. For validating your setup and cluster connection, you can enter your first SQL query and press the `Enter` key to execute it:&lt;/p&gt;

 {% highlight sql %}&lt;br/&gt;
-SELECT &apos;Hello World&apos;&lt;br/&gt;
+SELECT &apos;Hello World&apos;;&lt;br/&gt;
 {% endhighlight %}&lt;br/&gt;
 &lt;br/&gt;
 This query requires no table source and produces a single row result. The CLI will retrieve results from the cluster and visualize them. You can close the result view by pressing the `Q` key.&lt;br/&gt;
@@ -71,19 +71,19 @@ The CLI supports *&lt;b&gt;two modes&lt;/b&gt;* for maintaining and visualizing results.&lt;br/&gt;
 The *&lt;b&gt;table mode&lt;/b&gt;* materializes results in memory and visualizes them in a regular, paginated table representation. It can be enabled by executing the following command in the CLI:&lt;br/&gt;
 &lt;br/&gt;
 {% highlight text %}&lt;br/&gt;
-SET execution.result-mode=table&lt;br/&gt;
+SET execution.result-mode=table;&lt;br/&gt;
 {% endhighlight %}&lt;br/&gt;
 &lt;br/&gt;
 The *&lt;b&gt;changelog mode&lt;/b&gt;* does not materialize results and visualizes the result stream that is produced by a &lt;span class=&quot;error&quot;&gt;&amp;#91;continuous query&amp;#93;&lt;/span&gt;(streaming.html#dynamic-tables-&lt;del&gt;continuous-queries) consisting of insertions (`+`) and retractions (`&lt;/del&gt;`).&lt;br/&gt;
 &lt;br/&gt;
 {% highlight text %}&lt;br/&gt;
-SET execution.result-mode=changelog&lt;br/&gt;
+SET execution.result-mode=changelog;&lt;br/&gt;
 {% endhighlight %}&lt;br/&gt;
 &lt;br/&gt;
 You can use the following query to see both result modes in action:&lt;br/&gt;
 &lt;br/&gt;
 {% highlight sql %}
&lt;p&gt;-SELECT name, COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; AS cnt FROM (VALUES (&apos;Bob&apos;), (&apos;Alice&apos;), (&apos;Greg&apos;), (&apos;Bob&apos;)) AS NameTable(name) GROUP BY name &lt;br/&gt;
+SELECT name, COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; AS cnt FROM (VALUES (&apos;Bob&apos;), (&apos;Alice&apos;), (&apos;Greg&apos;), (&apos;Bob&apos;)) AS NameTable(name) GROUP BY name;&lt;/p&gt;
 {% endhighlight %}&lt;br/&gt;
 &lt;br/&gt;
 This query performs a bounded word count example.&lt;br/&gt;
@@ -494,13 +494,13 @@ Similar to table sources and sinks, views defined in a session environment file&lt;br/&gt;
 Views can also be created within a CLI session using the `CREATE VIEW` statement:&lt;br/&gt;
 &lt;br/&gt;
 {% highlight text %}&lt;br/&gt;
-CREATE VIEW MyNewView AS SELECT MyField2 FROM MyTableSource&lt;br/&gt;
+CREATE VIEW MyNewView AS SELECT MyField2 FROM MyTableSource;&lt;br/&gt;
 {% endhighlight %}

&lt;p&gt; Views created within a CLI session can also be removed again using the `DROP VIEW` statement:&lt;/p&gt;

 {% highlight text %}
&lt;p&gt;-DROP VIEW MyNewView&lt;br/&gt;
+DROP VIEW MyNewView;&lt;/p&gt;
 {% endhighlight %}&lt;br/&gt;
 &lt;br/&gt;
 &amp;lt;span class=&quot;label label-danger&quot;&amp;gt;Attention&amp;lt;/span&amp;gt; The definition of views is limited to the mentioned syntax above. Defining a schema for views or escape whitespaces in table names will be supported in future versions.&lt;br/&gt;
diff --git a/docs/dev/table/tableApi.md b/docs/dev/table/tableApi.md&lt;br/&gt;
index f8bcd3da1af..1a21a578570 100644&lt;br/&gt;
&amp;#8212; a/docs/dev/table/tableApi.md&lt;br/&gt;
+++ b/docs/dev/table/tableApi.md&lt;br/&gt;
@@ -1650,8 +1650,11 @@ timeIndicator = fieldReference , &quot;.&quot; , ( &quot;proctime&quot; | &quot;rowtime&quot; ) ;&lt;br/&gt;
 &lt;br/&gt;
 {% endhighlight %}

&lt;p&gt;-Here, `literal` is a valid Java literal, `fieldReference` specifies a column in the data (or all columns if `*` is used), and `functionIdentifier` specifies a supported scalar function. The&lt;br/&gt;
-column names and function names follow Java identifier syntax. Expressions specified as Strings can also use prefix notation instead of suffix notation to call operators and functions.&lt;br/&gt;
+Here, `literal` is a valid Java literal. String literals can be specified using single or double quotes. Duplicate the quote for escaping (e.g. `&apos;It&apos;&apos;s me.&apos;` or `&quot;I &quot;&quot;like&quot;&quot; dogs.&quot;`).&lt;br/&gt;
+&lt;br/&gt;
+The `fieldReference` specifies a column in the data (or all columns if `*` is used), and `functionIdentifier` specifies a supported scalar function. The column names and function names follow Java identifier syntax.&lt;br/&gt;
+&lt;br/&gt;
+Expressions specified as strings can also use prefix notation instead of suffix notation to call operators and functions.&lt;/p&gt;

&lt;p&gt; If working with exact numeric values or large decimals is required, the Table API also supports Java&apos;s BigDecimal type. In the Scala Table API decimals can be defined by `BigDecimal(&quot;123456&quot;)` and in Java by appending a &quot;p&quot; for precise e.g. `123456p`.&lt;/p&gt;

&lt;p&gt;diff --git a/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java&lt;br/&gt;
index 8030c7c75da..7867532e546 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java&lt;br/&gt;
+++ b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java&lt;br/&gt;
@@ -32,7 +32,6 @@&lt;br/&gt;
 import org.jline.reader.LineReaderBuilder;&lt;br/&gt;
 import org.jline.reader.MaskingCallback;&lt;br/&gt;
 import org.jline.reader.UserInterruptException;&lt;br/&gt;
-import org.jline.reader.impl.DefaultParser;&lt;br/&gt;
 import org.jline.terminal.Terminal;&lt;br/&gt;
 import org.jline.terminal.TerminalBuilder;&lt;br/&gt;
 import org.jline.utils.AttributedString;&lt;br/&gt;
@@ -94,13 +93,14 @@ public CliClient(SessionContext context, Executor executor) {&lt;br/&gt;
 		}&lt;/p&gt;

&lt;p&gt; 		// initialize line lineReader&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final DefaultParser parser = new DefaultParser();&lt;/li&gt;
	&lt;li&gt;parser.setEofOnEscapedNewLine(true); // allows for multi-line commands&lt;br/&gt;
 		lineReader = LineReaderBuilder.builder()&lt;br/&gt;
 			.terminal(terminal)&lt;br/&gt;
 			.appName(CliStrings.CLI_NAME)&lt;/li&gt;
	&lt;li&gt;.parser(parser)&lt;br/&gt;
+			.parser(new SqlMultiLineParser())&lt;br/&gt;
 			.build();&lt;br/&gt;
+		// this option is disabled for now for correct backslash escaping&lt;br/&gt;
+		// a &quot;SELECT &apos;\&apos;&quot; query should return a string with a backslash&lt;br/&gt;
+		lineReader.option(LineReader.Option.DISABLE_EVENT_EXPANSION, true);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; 		// create prompt&lt;br/&gt;
 		prompt = new AttributedStringBuilder()&lt;br/&gt;
@@ -168,16 +168,19 @@ public void open() {&lt;br/&gt;
 			terminal.writer().append(&quot;\n&quot;);&lt;br/&gt;
 			terminal.flush();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String line;&lt;br/&gt;
+			final String line;&lt;br/&gt;
 			try 
{
 				line = lineReader.readLine(prompt, null, (MaskingCallback) null, null);
-			}
&lt;p&gt; catch (UserInterruptException | EndOfFileException | IOError e) &lt;/p&gt;
{
-				// user cancelled application with Ctrl+C or kill
+			}
&lt;p&gt; catch (UserInterruptException e) &lt;/p&gt;
{
+				// user cancelled line with Ctrl+C
+				continue;
+			}
&lt;p&gt; catch (EndOfFileException | IOError e) &lt;/p&gt;
{
+				// user cancelled application with Ctrl+D or kill
 				break;
 			}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
 				throw new SqlClientException(&quot;Could not read from command line.&quot;, t);
 			}&lt;/li&gt;
	&lt;li&gt;if (line == null || line.equals(&quot;&quot;)) {&lt;br/&gt;
+			if (line == null) 
{
 				continue;
 			}
&lt;p&gt; 			final Optional&amp;lt;SqlCommandCall&amp;gt; cmdCall = parseCommand(line);&lt;br/&gt;
diff --git a/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliStrings.java b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliStrings.java&lt;br/&gt;
index baa78986b11..d68f56b4fce 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliStrings.java&lt;br/&gt;
+++ b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliStrings.java&lt;br/&gt;
@@ -50,15 +50,15 @@ private CliStrings() {&lt;br/&gt;
 		.append(formatCommand(SqlCommand.EXPLAIN, &quot;Describes the execution plan of a query or table with the given name.&quot;))&lt;br/&gt;
 		.append(formatCommand(SqlCommand.SELECT, &quot;Executes a SQL SELECT query on the Flink cluster.&quot;))&lt;br/&gt;
 		.append(formatCommand(SqlCommand.INSERT_INTO, &quot;Inserts the results of a SQL SELECT query into a declared table sink.&quot;))&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;.append(formatCommand(SqlCommand.CREATE_VIEW, &quot;Creates a virtual table from a SQL query. Syntax: &apos;CREATE VIEW &amp;lt;name&amp;gt; AS &amp;lt;query&amp;gt;&apos;&quot;))&lt;/li&gt;
	&lt;li&gt;.append(formatCommand(SqlCommand.DROP_VIEW, &quot;Deletes a previously created virtual table. Syntax: &apos;DROP VIEW &amp;lt;name&amp;gt;&apos;&quot;))&lt;br/&gt;
+		.append(formatCommand(SqlCommand.CREATE_VIEW, &quot;Creates a virtual table from a SQL query. Syntax: &apos;CREATE VIEW &amp;lt;name&amp;gt; AS &amp;lt;query&amp;gt;;&apos;&quot;))&lt;br/&gt;
+		.append(formatCommand(SqlCommand.DROP_VIEW, &quot;Deletes a previously created virtual table. Syntax: &apos;DROP VIEW &amp;lt;name&amp;gt;;&apos;&quot;))&lt;br/&gt;
 		.append(formatCommand(SqlCommand.SOURCE, &quot;Reads a SQL SELECT query from a file and executes it on the Flink cluster.&quot;))&lt;/li&gt;
	&lt;li&gt;.append(formatCommand(SqlCommand.SET, &quot;Sets a session configuration property. Syntax: &apos;SET &amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;&apos;. Use &apos;SET&apos; for listing all properties.&quot;))&lt;br/&gt;
+		.append(formatCommand(SqlCommand.SET, &quot;Sets a session configuration property. Syntax: &apos;SET &amp;lt;key&amp;gt;=&amp;lt;value&amp;gt;;&apos;. Use &apos;SET;&apos; for listing all properties.&quot;))&lt;br/&gt;
 		.append(formatCommand(SqlCommand.RESET, &quot;Resets all session configuration properties.&quot;))&lt;br/&gt;
 		.style(AttributedStyle.DEFAULT.underline())&lt;br/&gt;
 		.append(&quot;\nHint&quot;)&lt;br/&gt;
 		.style(AttributedStyle.DEFAULT)&lt;/li&gt;
	&lt;li&gt;.append(&quot;: Use &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos; for multi-line commands.&quot;)&lt;br/&gt;
+		.append(&quot;: Make sure that a statement ends with &apos;;&apos; for finalizing (multi-line) statements.&quot;)&lt;br/&gt;
 		.toAttributedString();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; 	public static final String MESSAGE_WELCOME;&lt;br/&gt;
@@ -104,7 +104,7 @@ private CliStrings() &lt;/p&gt;
{
 			&quot;   | |    | | | | | |   &amp;lt;   ____) | |__| | |____  | |____| | |  __/ | | | |_ \n&quot; +
 			&quot;   |_|    |_|_|_| |_|_|\\_\\ |_____/ \\___\\_\\______|  \\_____|_|_|\\___|_| |_|\\__|\n&quot; +
 			&quot;          \n&quot; +
-			&quot;        Welcome! Enter HELP to list all available commands. QUIT to exit.\n\n&quot;;
+			&quot;        Welcome! Enter &apos;HELP;&apos; to list all available commands. &apos;QUIT;&apos; to exit.\n\n&quot;;
 	}

&lt;p&gt; 	public static final String MESSAGE_QUIT = &quot;Exiting &quot; + CliStrings.CLI_NAME + &quot;...&quot;;&lt;br/&gt;
diff --git a/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/SqlMultiLineParser.java b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/SqlMultiLineParser.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..fb44a1e2ced&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/flink-libraries/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/SqlMultiLineParser.java&lt;br/&gt;
@@ -0,0 +1,52 @@&lt;br/&gt;
+/*&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License.  You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+ * See the License for the specific language governing permissions and&lt;br/&gt;
+ * limitations under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.flink.table.client.cli;&lt;br/&gt;
+&lt;br/&gt;
+import org.jline.reader.EOFError;&lt;br/&gt;
+import org.jline.reader.ParsedLine;&lt;br/&gt;
+import org.jline.reader.Parser;&lt;br/&gt;
+import org.jline.reader.impl.DefaultParser;&lt;br/&gt;
+&lt;br/&gt;
+import java.util.Collections;&lt;br/&gt;
+&lt;br/&gt;
+/**&lt;br/&gt;
+ * Multi-line parser for parsing an arbitrary number of SQL lines until a line ends with &apos;;&apos;.&lt;br/&gt;
+ */&lt;br/&gt;
+public class SqlMultiLineParser implements Parser {&lt;br/&gt;
+&lt;br/&gt;
+	private static final String EOF_CHARACTER = &quot;;&quot;;&lt;br/&gt;
+	private static final String NEW_LINE_PROMPT = &quot;&quot;; // results in simple &apos;&amp;gt;&apos; output&lt;br/&gt;
+&lt;br/&gt;
+	@Override&lt;br/&gt;
+	public ParsedLine parse(String line, int cursor, ParseContext context) {&lt;br/&gt;
+		if (!line.trim().endsWith(EOF_CHARACTER)) &lt;/p&gt;
{
+			throw new EOFError(
+				-1,
+				-1,
+				&quot;New line without EOF character.&quot;,
+				NEW_LINE_PROMPT);
+		}
&lt;p&gt;+		return new DefaultParser.ArgumentList(&lt;br/&gt;
+			line,&lt;br/&gt;
+			Collections.singletonList(line),&lt;br/&gt;
+			0,&lt;br/&gt;
+			0,&lt;br/&gt;
+			cursor);&lt;br/&gt;
+	}&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala&lt;br/&gt;
index 195812d1d1c..7d3478cb50c 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala&lt;br/&gt;
@@ -34,6 +34,7 @@ import org.apache.calcite.schema.impl.AbstractTable&lt;br/&gt;
 import org.apache.calcite.sql._&lt;br/&gt;
 import org.apache.calcite.sql.parser.SqlParser&lt;br/&gt;
 import org.apache.calcite.sql.util.ChainedSqlOperatorTable&lt;br/&gt;
+import org.apache.calcite.sql.validate.SqlConformanceEnum&lt;br/&gt;
 import org.apache.calcite.tools._&lt;br/&gt;
 import org.apache.flink.api.common.functions.MapFunction&lt;br/&gt;
 import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
index 6cabe212213..0fdd8859cf4 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
@@ -681,9 +681,7 @@ abstract class CodeGenerator(&lt;br/&gt;
         generateNonNullLiteral(resultType, decimalField)&lt;/p&gt;

&lt;p&gt;       case VARCHAR | CHAR =&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val escapedValue = StringEscapeUtils.escapeJava(&lt;/li&gt;
	&lt;li&gt;StringEscapeUtils.unescapeJava(value.toString)&lt;/li&gt;
	&lt;li&gt;)&lt;br/&gt;
+        val escapedValue = StringEscapeUtils.ESCAPE_JAVA.translate(value.toString)&lt;br/&gt;
         generateNonNullLiteral(resultType, &quot;\&quot;&quot; + escapedValue + &quot;\&quot;&quot;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       case SYMBOL =&amp;gt;&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/ExpressionReducer.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/ExpressionReducer.scala&lt;br/&gt;
index a9dbf19e425..f58e12cfea2 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/ExpressionReducer.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/ExpressionReducer.scala&lt;br/&gt;
@@ -120,12 +120,7 @@ class ExpressionReducer(config: TableConfig)&lt;br/&gt;
              SqlTypeName.MAP |&lt;br/&gt;
              SqlTypeName.MULTISET =&amp;gt;&lt;br/&gt;
           reducedValues.add(unreduced)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// after expression reduce, the literal string has to be escaped&lt;/li&gt;
	&lt;li&gt;case SqlTypeName.VARCHAR | SqlTypeName.CHAR =&amp;gt;&lt;/li&gt;
	&lt;li&gt;val escapeVarchar = StringEscapeUtils&lt;/li&gt;
	&lt;li&gt;.escapeJava(reduced.getField(reducedIdx).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;)&lt;/li&gt;
	&lt;li&gt;reducedValues.add(rexBuilder.makeLiteral(escapeVarchar, unreduced.getType, true))&lt;/li&gt;
	&lt;li&gt;reducedIdx += 1&lt;br/&gt;
+&lt;br/&gt;
         case _ =&amp;gt;&lt;br/&gt;
           val reducedValue = reduced.getField(reducedIdx)&lt;br/&gt;
           // RexBuilder handle double literal incorrectly, convert it into BigDecimal manually&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
index c0a577dccfd..633afb1020d 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/ExpressionParser.scala&lt;br/&gt;
@@ -185,13 +185,18 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
           }&lt;br/&gt;
       }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/li&gt;
	&lt;li&gt;(&quot;&apos;&quot; + &quot;&quot;&quot;([^&apos;\p
{Cntrl}
&lt;p&gt;\\]|\\[\\&apos;&quot;bfnrt]|&lt;br class=&quot;atl-forced-newline&quot; /&gt;u&lt;span class=&quot;error&quot;&gt;&amp;#91;a-fA-F0-9&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;)*&quot;&quot;&quot; + &quot;&apos;&quot;).r ^^ &lt;/p&gt;
{
-      str =&amp;gt; Literal(str.substring(1, str.length - 1))
-    }
&lt;p&gt;+  // string with single quotes such as &apos;It&apos;&apos;s me.&apos;&lt;br/&gt;
+  lazy val singleQuoteStringLiteral: Parser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = &quot;&apos;(?:&apos;&apos;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;)*&apos;&quot;.r ^^ &lt;/p&gt;
{
+    str =&amp;gt;
+      val escaped = str.substring(1, str.length - 1).replace(&quot;&apos;&apos;&quot;, &quot;&apos;&quot;)
+      Literal(escaped)
+  }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lazy val stringLiteralFlink: PackratParser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = super.stringLiteral ^^ {&lt;/li&gt;
	&lt;li&gt;str =&amp;gt; Literal(str.substring(1, str.length - 1))&lt;br/&gt;
+  // string with double quotes such as &quot;I &quot;&quot;like&quot;&quot; dogs.&quot;&lt;br/&gt;
+  lazy val doubleQuoteStringLiteral: PackratParser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = &quot;\&quot;(?:\&quot;\&quot;|&lt;span class=&quot;error&quot;&gt;&amp;#91;^\&amp;quot;&amp;#93;&lt;/span&gt;)*\&quot;&quot;.r ^^ 
{
+    str =&amp;gt;
+      val escaped = str.substring(1, str.length - 1).replace(&quot;\&quot;\&quot;&quot;, &quot;\&quot;&quot;)
+      Literal(escaped)
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   lazy val boolLiteral: PackratParser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; = (TRUE | FALSE) ^^ {&lt;br/&gt;
@@ -203,7 +208,7 @@ object ExpressionParser extends JavaTokenParsers with PackratParsers {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   lazy val literalExpr: PackratParser&lt;span class=&quot;error&quot;&gt;&amp;#91;Expression&amp;#93;&lt;/span&gt; =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;numberLiteral | stringLiteralFlink | singleQuoteStringLiteral | boolLiteral&lt;br/&gt;
+    numberLiteral | doubleQuoteStringLiteral | singleQuoteStringLiteral | boolLiteral&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   lazy val fieldReference: PackratParser&lt;span class=&quot;error&quot;&gt;&amp;#91;NamedExpression&amp;#93;&lt;/span&gt; = (STAR | ident) ^^ &lt;/p&gt;
{
     sym =&amp;gt; UnresolvedFieldReference(sym)
diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/literals.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/literals.scala
index 863dfc1aef2..419c12567f1 100644
--- a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/literals.scala
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/expressions/literals.scala
@@ -104,11 +104,6 @@ case class Literal(value: Any, resultType: TypeInformation[_]) extends LeafExpre
           SqlParserPos.ZERO)
         relBuilder.getRexBuilder.makeIntervalLiteral(interval, intervalQualifier)
 
-      case BasicTypeInfo.STRING_TYPE_INFO =&amp;gt;
-        relBuilder.getRexBuilder.makeLiteral(
-          StringEscapeUtils.escapeJava(value.asInstanceOf[String])
-        )
-
       case _ =&amp;gt; relBuilder.literal(value)
     }
&lt;p&gt;   }&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
index 0a60eae0e5f..bf568c7d33d 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/expressions/LiteralTest.scala&lt;br/&gt;
@@ -20,8 +20,8 @@ package org.apache.flink.table.expressions&lt;/p&gt;

&lt;p&gt; import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
 import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
-import org.apache.flink.table.api.scala._&lt;br/&gt;
 import org.apache.flink.table.api.Types&lt;br/&gt;
+import org.apache.flink.table.api.scala._&lt;br/&gt;
 import org.apache.flink.table.expressions.utils.&lt;/p&gt;
{ExpressionTestBase, Func3}
&lt;p&gt; import org.apache.flink.table.functions.ScalarFunction&lt;br/&gt;
 import org.apache.flink.types.Row&lt;br/&gt;
@@ -88,6 +88,91 @@ class LiteralTest extends ExpressionTestBase &lt;/p&gt;
{
       s&quot;42 and $hello&quot;)
   }

&lt;p&gt;+  @Test&lt;br/&gt;
+  def testStringLiterals(): Unit = &lt;/p&gt;
{
+
+    // these tests use Java/Scala escaping for non-quoting unicode characters
+
+    testAllApis(
+      &quot;&amp;gt;\n&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;\n&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;\n&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;\n&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;\u263A&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;\u263A&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;\u263A&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;\u263A&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;\u263A&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;\u263A&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;\u263A&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;\u263A&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;\\&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;\\&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;\\&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;\\&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;&apos;&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;&apos;&apos;&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;&apos;&apos;&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;&apos;&amp;lt;&quot;)
+
+    testAllApis(
+      &quot; &quot;,
+      &quot;&apos; &apos;&quot;,
+      &quot;&apos; &apos;&quot;,
+      &quot; &quot;)
+
+    testAllApis(
+      &quot;&quot;,
+      &quot;&apos;&apos;&quot;,
+      &quot;&apos;&apos;&quot;,
+      &quot;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;foo([\\w]+)&amp;lt;&quot;,
+      &quot;&apos;&amp;gt;foo([\\w]+)&amp;lt;&apos;&quot;,
+      &quot;&apos;&amp;gt;foo([\\w]+)&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;foo([\\w]+)&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;&amp;gt;\\&apos;\n&amp;lt;&quot;,
+      &quot;\&quot;&amp;gt;\\&apos;\n&amp;lt;\&quot;&quot;,
+      &quot;&apos;&amp;gt;\\&apos;&apos;\n&amp;lt;&apos;&quot;,
+      &quot;&amp;gt;\\&apos;\n&amp;lt;&quot;)
+
+    testAllApis(
+      &quot;It&apos;s me.&quot;,
+      &quot;&apos;It&apos;&apos;s me.&apos;&quot;,
+      &quot;&apos;It&apos;&apos;s me.&apos;&quot;,
+      &quot;It&apos;s me.&quot;)
+
+    testTableApi(
+      &quot;&quot;&quot;I &quot;like&quot; dogs.&quot;&quot;&quot;,
+      &quot;&quot;&quot;&quot;I &quot;&quot;like&quot;&quot; dogs.&quot;&quot;&quot;&quot;,
+      &quot;&quot;&quot;I &quot;like&quot; dogs.&quot;&quot;&quot;)
+
+    // these test use SQL for describing unicode characters
+
+    testSqlApi(
+      &quot;U&amp;amp;&apos;&amp;gt;\\263A&amp;lt;&apos;&quot;, // default escape backslash
+      &quot;&amp;gt;\u263A&amp;lt;&quot;)
+
+    testSqlApi(
+      &quot;U&amp;amp;&apos;&amp;gt;#263A&amp;lt;&apos; UESCAPE &apos;#&apos;&quot;, // custom escape &apos;#&apos;
+      &quot;&amp;gt;\u263A&amp;lt;&quot;)
+
+    testSqlApi(
+      &quot;&quot;&quot;&apos;&amp;gt;\\&amp;lt;&apos;&quot;&quot;&quot;,
+      &quot;&amp;gt;\\\\&amp;lt;&quot;)
+  }
&lt;p&gt;+&lt;br/&gt;
   def testData: Any = &lt;/p&gt;
{
     val testData = new Row(4)
     testData.setField(0, &quot;trUeX_value&quot;)
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/sql/CalcITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/sql/CalcITCase.scala
index 6aed9a83c1b..4f1eb6863af 100644
--- a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/sql/CalcITCase.scala
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/sql/CalcITCase.scala
@@ -355,9 +355,9 @@ class CalcITCase(
   }

&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def testUdfWithUnicodeParameter(): Unit = {&lt;br/&gt;
+  def testFunctionWithUnicodeParameters(): Unit = {&lt;br/&gt;
     val data = List(&lt;/li&gt;
	&lt;li&gt;(&quot;a\u0001b&quot;, &quot;c\&quot;d&quot;, &quot;e\\\&quot;\u0004f&quot;),&lt;br/&gt;
+      (&quot;a\u0001b&quot;, &quot;c\&quot;d&quot;, &quot;e\\\&quot;\u0004f&quot;), // uses Java/Scala escaping&lt;br/&gt;
       (&quot;x\u0001y&quot;, &quot;y\&quot;z&quot;, &quot;z\\\&quot;\u0004z&quot;)&lt;br/&gt;
     )&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -371,20 +371,23 @@ class CalcITCase(&lt;br/&gt;
     tEnv.registerFunction(&quot;splitUDF0&quot;, splitUDF0)&lt;br/&gt;
     tEnv.registerFunction(&quot;splitUDF1&quot;, splitUDF1)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// user have to specify &apos;\&apos; with &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos; in SQL&lt;/li&gt;
	&lt;li&gt;val sqlQuery = &quot;SELECT &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF0(a, &apos;\u0001&apos;, 0) as a0, &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF1(a, &apos;\u0001&apos;, 0) as a1, &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF0(b, &apos;\&quot;&apos;, 1) as b0, &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF1(b, &apos;\&quot;&apos;, 1) as b1, &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF0(c, &apos;\\\\\&quot;\u0004&apos;, 0) as c0, &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;splitUDF1(c, &apos;\\\\\&quot;\u0004&apos;, 0) as c1 from T1&quot;&lt;br/&gt;
+    // uses SQL escaping (be aware that even Scala multi-line strings parse backslash!)&lt;br/&gt;
+    val sqlQuery = s&quot;&quot;&quot;&lt;br/&gt;
+      |SELECT&lt;br/&gt;
+      |  splitUDF0(a, U&amp;amp;&apos;${&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;}0001&apos;, 0) AS a0,&lt;br/&gt;
+      |  splitUDF1(a, U&amp;amp;&apos;${&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;}0001&apos;, 0) AS a1,&lt;br/&gt;
+      |  splitUDF0(b, U&amp;amp;&apos;&quot;&apos;, 1) AS b0,&lt;br/&gt;
+      |  splitUDF1(b, U&amp;amp;&apos;&quot;&apos;, 1) AS b1,&lt;br/&gt;
+      |  splitUDF0(c, U&amp;amp;&apos;${&apos;\\&apos;}${&apos;\\&apos;}&quot;${&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;}0004&apos;, 0) AS c0,&lt;br/&gt;
+      |  splitUDF1(c, U&amp;amp;&apos;${&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;}&quot;#0004&apos; UESCAPE &apos;#&apos;, 0) AS c1&lt;br/&gt;
+      |FROM T1&lt;br/&gt;
+      |&quot;&quot;&quot;.stripMargin&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     val t1 = env.fromCollection(data).toTable(tEnv, &apos;a, &apos;b, &apos;c)&lt;/p&gt;

&lt;p&gt;     tEnv.registerTable(&quot;T1&quot;, t1)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val results = tEnv.sql(sqlQuery).toDataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;.collect()&lt;br/&gt;
+    val results = tEnv.sqlQuery(sqlQuery).toDataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;.collect()&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     val expected = List(&quot;a,a,d,d,e,e&quot;, &quot;x,x,z,z,z,z&quot;).mkString(&quot;\n&quot;)&lt;br/&gt;
     TestBaseUtils.compareResultAsText(results.asJava, expected)&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
index 71a87d2c1ed..b161eeda43c 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
@@ -550,30 +550,34 @@ class CalcITCase(&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;def testUDFWithUnicodeParameter(): Unit = 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+  def testFunctionWithUnicodeParameters()}&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; object CalcITCase {&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/sql/SqlITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/sql/SqlITCase.scala&lt;br/&gt;
index a2d9bb26c4c..f18705568b1 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/sql/SqlITCase.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/sql/SqlITCase.scala&lt;br/&gt;
@@ -781,45 +781,6 @@ class SqlITCase extends StreamingWithStateTestBase &lt;/p&gt;
{
     assertEquals(expected.sorted, StreamITCase.testResults.sorted)
   }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;def testUdfWithUnicodeParameter(): Unit = 
{
-    val data = List(
-      (&quot;a\u0001b&quot;, &quot;c\&quot;d&quot;, &quot;e\\\&quot;\u0004f&quot;),
-      (&quot;x\u0001y&quot;, &quot;y\&quot;z&quot;, &quot;z\\\&quot;\u0004z&quot;)
-    )
-
-    val env = StreamExecutionEnvironment.getExecutionEnvironment
-
-    val tEnv = TableEnvironment.getTableEnvironment(env)
-    StreamITCase.clear
-
-    val splitUDF0 = new SplitUDF(deterministic = true)
-    val splitUDF1 = new SplitUDF(deterministic = false)
-
-    tEnv.registerFunction(&quot;splitUDF0&quot;, splitUDF0)
-    tEnv.registerFunction(&quot;splitUDF1&quot;, splitUDF1)
-
-    // user have to specify &apos;\&apos; with &apos;\\&apos; in SQL
-    val sqlQuery = &quot;SELECT &quot; +
-      &quot;splitUDF0(a, &apos;\u0001&apos;, 0) as a0, &quot; +
-      &quot;splitUDF1(a, &apos;\u0001&apos;, 0) as a1, &quot; +
-      &quot;splitUDF0(b, &apos;\&quot;&apos;, 1) as b0, &quot; +
-      &quot;splitUDF1(b, &apos;\&quot;&apos;, 1) as b1, &quot; +
-      &quot;splitUDF0(c, &apos;\\\\\&quot;\u0004&apos;, 0) as c0, &quot; +
-      &quot;splitUDF1(c, &apos;\\\\\&quot;\u0004&apos;, 0) as c1 from T1&quot;
-
-    val t1 = env.fromCollection(data).toTable(tEnv, &apos;a, &apos;b, &apos;c)
-
-    tEnv.registerTable(&quot;T1&quot;, t1)
-
-    val result = tEnv.sqlQuery(sqlQuery).toAppendStream[Row]
-    result.addSink(new StreamITCase.StringSink[Row])
-    env.execute()
-
-    val expected = List(&quot;a,a,d,d,e,e&quot;, &quot;x,x,z,z,z,z&quot;)
-    assertEquals(expected.sorted, StreamITCase.testResults.sorted)
-  }
&lt;p&gt;-&lt;br/&gt;
   @Test&lt;br/&gt;
   def testUDFWithLongVarargs(): Unit = {&lt;br/&gt;
     val env = StreamExecutionEnvironment.getExecutionEnvironment&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/table/CalcITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/table/CalcITCase.scala&lt;br/&gt;
index a20b6263448..6407ebdce22 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/table/CalcITCase.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/stream/table/CalcITCase.scala&lt;br/&gt;
@@ -351,32 +351,4 @@ class CalcITCase extends AbstractTestBase 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {       &amp;quot;{9=Comment#3}&amp;quot;)     assertEquals(expected.sorted, StreamITCase.testResults.sorted)   }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;def testUDFWithUnicodeParameter(): Unit = 
{
-    val data = List(
-      (&quot;a\u0001b&quot;, &quot;c\&quot;d&quot;, &quot;e\\\&quot;\u0004f&quot;),
-      (&quot;x\u0001y&quot;, &quot;y\&quot;z&quot;, &quot;z\\\&quot;\u0004z&quot;)
-    )
-    val env = StreamExecutionEnvironment.getExecutionEnvironment
-    val tEnv = TableEnvironment.getTableEnvironment(env)
-    StreamITCase.testResults = mutable.MutableList()
-    val splitUDF0 = new SplitUDF(deterministic = true)
-    val splitUDF1 = new SplitUDF(deterministic = false)
-    val ds = env.fromCollection(data).toTable(tEnv, &apos;a, &apos;b, &apos;c)
-      .select(splitUDF0(&apos;a, &quot;\u0001&quot;, 0) as &apos;a0,
-              splitUDF1(&apos;a, &quot;\u0001&quot;, 0) as &apos;a1,
-              splitUDF0(&apos;b, &quot;\&quot;&quot;, 1) as &apos;b0,
-              splitUDF1(&apos;b, &quot;\&quot;&quot;, 1) as &apos;b1,
-              splitUDF0(&apos;c, &quot;\\\&quot;\u0004&quot;, 0) as &apos;c0,
-              splitUDF1(&apos;c, &quot;\\\&quot;\u0004&quot;, 0) as &apos;c1
-      )
-    val results = ds.toAppendStream[Row]
-    results.addSink(new StreamITCase.StringSink[Row])
-    env.execute()
-    val expected = mutable.MutableList(
-      &quot;a,a,d,d,e,e&quot;, &quot;x,x,z,z,z,z&quot;
-    )
-    assertEquals(expected.sorted, StreamITCase.testResults.sorted)
-  }
&lt;p&gt; }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16612206" author="twalthr" created="Wed, 12 Sep 2018 14:19:54 +0000"  >&lt;p&gt;Fixed in 1.7.0:&#160;c87b9433e3225602e56497f782a610668eac8bf9&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 9 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xqn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>