<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:30:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-7732] Invalid offset to commit in Kafka</title>
                <link>https://issues.apache.org/jira/browse/FLINK-7732</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;In a test run with unrelated changes in the network stack, the Kafa end-to-end test was failing with an invalid offset:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2017-09-28 06:34:10,736 INFO  org.apache.kafka.common.utils.AppInfoParser                   - Kafka version : 0.10.2.1
2017-09-28 06:34:10,744 INFO  org.apache.kafka.common.utils.AppInfoParser                   - Kafka commitId : e89bffd6b2eff799
2017-09-28 06:34:14,549 INFO  org.apache.kafka.clients.consumer.internals.AbstractCoordinator  - Discovered coordinator testing-gce-f67551b8-8867-41c5-b36e-4196d0f11e30:9092 (id: 2147483647 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group myconsumer.
2017-09-28 06:34:14,573 INFO  org.apache.kafka.clients.consumer.internals.AbstractCoordinator  - Marking the coordinator testing-gce-f67551b8-8867-41c5-b36e-4196d0f11e30:9092 (id: 2147483647 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) dead &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group myconsumer
2017-09-28 06:34:14,686 INFO  org.apache.kafka.clients.consumer.internals.AbstractCoordinator  - Discovered coordinator testing-gce-f67551b8-8867-41c5-b36e-4196d0f11e30:9092 (id: 2147483647 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group myconsumer.
2017-09-28 06:34:14,687 INFO  org.apache.kafka.clients.consumer.internals.AbstractCoordinator  - Marking the coordinator testing-gce-f67551b8-8867-41c5-b36e-4196d0f11e30:9092 (id: 2147483647 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) dead &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group myconsumer
2017-09-28 06:34:14,792 INFO  org.apache.kafka.clients.consumer.internals.AbstractCoordinator  - Discovered coordinator testing-gce-f67551b8-8867-41c5-b36e-4196d0f11e30:9092 (id: 2147483647 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; group myconsumer.
2017-09-28 06:34:15,068 INFO  org.apache.flink.runtime.state.DefaultOperatorStateBackend    - DefaultOperatorStateBackend snapshot (In-Memory Stream Factory, synchronous part) in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[Async calls on Source: Custom Source -&amp;gt; Map -&amp;gt; Sink: Unnamed (1/1),5,Flink Task Threads] took 948 ms.
2017-09-28 06:34:15,164 WARN  org.apache.flink.streaming.connectors.kafka.internal.Kafka09Fetcher  - Committing offsets to Kafka failed. This does not compromise Flink&apos;s checkpoints.
java.lang.IllegalArgumentException: Invalid offset: -915623761772
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.sendOffsetCommitRequest(ConsumerCoordinator.java:687)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.doCommitOffsetsAsync(ConsumerCoordinator.java:531)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.commitOffsetsAsync(ConsumerCoordinator.java:499)
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitAsync(KafkaConsumer.java:1181)
	at org.apache.flink.streaming.connectors.kafka.internal.KafkaConsumerThread.run(KafkaConsumerThread.java:217)
2017-09-28 06:34:15,171 ERROR org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumerBase  - Async Kafka commit failed.
java.lang.IllegalArgumentException: Invalid offset: -915623761772
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.sendOffsetCommitRequest(ConsumerCoordinator.java:687)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.doCommitOffsetsAsync(ConsumerCoordinator.java:531)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.commitOffsetsAsync(ConsumerCoordinator.java:499)
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitAsync(KafkaConsumer.java:1181)
	at org.apache.flink.streaming.connectors.kafka.internal.KafkaConsumerThread.run(KafkaConsumerThread.java:217)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/apache/flink/jobs/280722829&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/flink/jobs/280722829&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; did a first analysis that revealed this:&lt;br/&gt;
In org/apache/flink/streaming/connectors/kafka/internal/Kafka09Fetcher.java:229 this is being sent:&lt;br/&gt;
&lt;tt&gt;long offsetToCommit = lastProcessedOffset + 1;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;lastProcessedOffset&lt;/tt&gt; comes from:&lt;br/&gt;
&lt;tt&gt;org.apache.flink.streaming.connectors.kafka.FlinkKafkaConsumerBase#snapshotState&lt;/tt&gt; either lines 741 or 749&lt;/p&gt;

&lt;p&gt;The value that we see is strangely similiar to &lt;tt&gt;org.apache.flink.streaming.connectors.kafka.internals.KafkaTopicPartitionStateSentinel#GROUP_OFFSET&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
     * Magic number that defines the partition should start from its committed group offset in Kafka.
     *
     * &amp;lt;p&amp;gt;This is used as a placeholder so that the actual committed group offset can be evaluated lazily
     * when the partition will actually start to be read by the consumer.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; GROUP_OFFSET = -915623761773L;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This &lt;tt&gt;GROUP_OFFSET&lt;/tt&gt; clearly was not intended to be committed, however probably there is some race between this &quot;lazy evaluation&quot; and checkpoints (which trigger committing offsets to kafka).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13105779">FLINK-7732</key>
            <summary>Invalid offset to commit in Kafka</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pnowojski">Piotr Nowojski</assignee>
                                    <reporter username="nkruber">Nico Kruber</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Thu, 28 Sep 2017 15:22:09 +0000</created>
                <updated>Thu, 2 Nov 2017 11:06:37 +0000</updated>
                            <resolved>Thu, 2 Nov 2017 11:06:30 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16198400" author="aljoscha" created="Tue, 10 Oct 2017 09:14:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; So this might not be a test instability but an actual bug in Kafka?&lt;/p&gt;</comment>
                            <comment id="16212639" author="pmishra01" created="Fri, 20 Oct 2017 13:18:14 +0000"  >&lt;p&gt;Hi All, We also faced same issue when using flink with Kafka Consumer. Please find error traces. Do we have any fix available ?&lt;/p&gt;

&lt;p&gt;java.lang.IllegalArgumentException: Invalid offset: -9156... &lt;br/&gt;
java.lang.IllegalArgumentException: Invalid offset: -915623761772  &lt;br/&gt;
at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.sendOffsetCommitRequest(ConsumerCoordinator.java:687) ~[kafka-clients-.........................................................&lt;/p&gt;

&lt;p&gt;. &lt;/p&gt;</comment>
                            <comment id="16215258" author="pnowojski" created="Mon, 23 Oct 2017 15:00:58 +0000"  >&lt;p&gt;Yes, this definitely looks like a bug in our code. Sorry &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aljoscha&quot; class=&quot;user-hover&quot; rel=&quot;aljoscha&quot;&gt;aljoscha&lt;/a&gt; for missing your comment.&lt;/p&gt;</comment>
                            <comment id="16226907" author="githubbot" created="Tue, 31 Oct 2017 14:44:14 +0000"  >&lt;p&gt;GitHub user pnowojski opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7732&quot; title=&quot;Invalid offset to commit in Kafka&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7732&quot;&gt;&lt;del&gt;FLINK-7732&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;kafka-consumer&amp;#93;&lt;/span&gt; Do not commit to kafka Flink&apos;s sentinel offsets&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This pull request fixes a bug in all versions of `KafkaConsumer`s, that resulted in application crash, if snapshot before `KafkaConsumer` was able to asynchronously properly initialize.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change adds additional unit test in `AbstractFetcherTest` and a check state to ensure/enforce contract that internal sentinel offsets will not be committed to Kafka. &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (*&lt;b&gt;not applicable&lt;/b&gt;* / docs / JavaDocs / not documented)&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/pnowojski/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/pnowojski/flink&lt;/a&gt; f7732&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4928&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9baea16ca69c27e5153808ce01592a47091c3131&lt;br/&gt;
Author: Piotr Nowojski &amp;lt;piotr.nowojski@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-10-31T14:38:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7732&quot; title=&quot;Invalid offset to commit in Kafka&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7732&quot;&gt;&lt;del&gt;FLINK-7732&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;kafka-consumer&amp;#93;&lt;/span&gt; Do not commit to kafka Flink&apos;s sentinel offsets&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16226910" author="githubbot" created="Tue, 31 Oct 2017 14:45:14 +0000"  >&lt;p&gt;Github user pnowojski commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tzulitai @aljoscha could you take a look?&lt;/p&gt;</comment>
                            <comment id="16233777" author="githubbot" created="Wed, 1 Nov 2017 08:36:30 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928#discussion_r148204398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928#discussion_r148204398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/internals/KafkaTopicPartitionState.java &amp;#8212;&lt;br/&gt;
    @@ -95,6 +95,10 @@ public final boolean isOffsetDefined() &lt;/p&gt;
{
     		return offset != KafkaTopicPartitionStateSentinel.OFFSET_NOT_SET;
     	}

&lt;p&gt;    +	public final boolean isSentinel() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    nit: would `hasSentinelOffset` be a better name here?&lt;/p&gt;</comment>
                            <comment id="16233778" author="githubbot" created="Wed, 1 Nov 2017 08:36:30 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928#discussion_r148204574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928#discussion_r148204574&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/internals/KafkaTopicPartitionStateSentinel.java &amp;#8212;&lt;br/&gt;
    @@ -52,4 +52,7 @@&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static final long GROUP_OFFSET = -915623761773L;&lt;/p&gt;

&lt;p&gt;    +	public static boolean isSentinel(long offset) {&lt;br/&gt;
    +		return offset &amp;lt; 0;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    nit: this implementation could be a bit too broad. Could be a bit more specific by matching the static values in `KafkaTopicPartitionStateSentinel`.&lt;/p&gt;</comment>
                            <comment id="16233780" author="githubbot" created="Wed, 1 Nov 2017 08:39:47 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    By the way, what exactly was the error that caused the application crash in the described case?&lt;/p&gt;</comment>
                            <comment id="16233870" author="githubbot" created="Wed, 1 Nov 2017 10:01:44 +0000"  >&lt;p&gt;Github user pnowojski commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928#discussion_r148220943&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928#discussion_r148220943&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/internals/KafkaTopicPartitionState.java &amp;#8212;&lt;br/&gt;
    @@ -95,6 +95,10 @@ public final boolean isOffsetDefined() &lt;/p&gt;
{
     		return offset != KafkaTopicPartitionStateSentinel.OFFSET_NOT_SET;
     	}

&lt;p&gt;    +	public final boolean isSentinel() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    In new approach method was dropped&lt;/p&gt;</comment>
                            <comment id="16233871" author="githubbot" created="Wed, 1 Nov 2017 10:03:25 +0000"  >&lt;p&gt;Github user pnowojski commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928#discussion_r148221257&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928#discussion_r148221257&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/internals/KafkaTopicPartitionStateSentinel.java &amp;#8212;&lt;br/&gt;
    @@ -52,4 +52,7 @@&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static final long GROUP_OFFSET = -915623761773L;&lt;/p&gt;

&lt;p&gt;    +	public static boolean isSentinel(long offset) {&lt;br/&gt;
    +		return offset &amp;lt; 0;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Kafka doesn&apos;t allow to commit any negative values &lt;/p&gt;</comment>
                            <comment id="16233872" author="githubbot" created="Wed, 1 Nov 2017 10:04:39 +0000"  >&lt;p&gt;Github user pnowojski commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tzulitai please check the details in the ticket: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7732&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-7732&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I have changed the approach as we discussed and now we filtering out happens just before committing offsets.&lt;/p&gt;</comment>
                            <comment id="16233896" author="githubbot" created="Wed, 1 Nov 2017 10:31:01 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928#discussion_r148226195&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928#discussion_r148226195&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/internals/AbstractFetcher.java &amp;#8212;&lt;br/&gt;
    @@ -242,10 +243,25 @@ public void addDiscoveredPartitions(List&amp;lt;KafkaTopicPartition&amp;gt; newPartitions) thr&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@param commitCallback The callback that the user should trigger when a commit request completes or fails.&lt;/li&gt;
	&lt;li&gt;@throws Exception This method forwards exceptions.&lt;br/&gt;
     	 */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public abstract void commitInternalOffsetsToKafka(&lt;br/&gt;
    +	public final void commitInternalOffsetsToKafka(&lt;br/&gt;
    +			Map&amp;lt;KafkaTopicPartition, Long&amp;gt; offsets,&lt;br/&gt;
    +			@Nonnull KafkaCommitCallback commitCallback) throws Exception 
{
    +		// Ignore sentinels. They might appear here if snapshot has started before actual offsets values
    +		// replaced sentinels
    +		doCommitInternalOffsetsToKafka(filerOutSentinels(offsets), commitCallback);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	protected abstract void doCommitInternalOffsetsToKafka(&lt;br/&gt;
     			Map&amp;lt;KafkaTopicPartition, Long&amp;gt; offsets,&lt;br/&gt;
     			@Nonnull KafkaCommitCallback commitCallback) throws Exception;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    +	private Map&amp;lt;KafkaTopicPartition, Long&amp;gt; filerOutSentinels(Map&amp;lt;KafkaTopicPartition, Long&amp;gt; offsets) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    typo: `filterOutSentinels`, missing `t`.&lt;/p&gt;</comment>
                            <comment id="16235154" author="githubbot" created="Thu, 2 Nov 2017 04:24:13 +0000"  >&lt;p&gt;Github user tzulitai commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Travis passes, merging ...&lt;/p&gt;</comment>
                            <comment id="16235480" author="githubbot" created="Thu, 2 Nov 2017 10:01:40 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16235554" author="githubbot" created="Thu, 2 Nov 2017 11:06:14 +0000"  >&lt;p&gt;Github user pnowojski commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13113313">FLINK-7953</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3152v:i</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>