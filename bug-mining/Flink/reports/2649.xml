<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:35:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10065] InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10065</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Now, the implementation of InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) is&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T deserializeObject(InputStream in, &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt; cl, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isFailureTolerant)
&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ClassNotFoundException {
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt; old = &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().getContextClassLoader();
&lt;span class=&quot;code-comment&quot;&gt;// not using resource &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to avoid AutoClosable&apos;s close() on the given stream
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (ObjectInputStream oois = isFailureTolerant
? &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InstantiationUtil.FailureTolerantObjectInputStream(in, cl)
: &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InstantiationUtil.ClassLoaderObjectInputStream(in, cl)) {
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().setContextClassLoader(cl);
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (T) oois.readObject();
}
&lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().setContextClassLoader(old);
}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;InputStream is closable, so the parameter will be closed after call this method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13177042">FLINK-10065</key>
            <summary>InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="klion26">Congxian Qiu</assignee>
                                    <reporter username="klion26">Congxian Qiu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 6 Aug 2018 07:38:14 +0000</created>
                <updated>Fri, 28 Sep 2018 16:41:05 +0000</updated>
                            <resolved>Fri, 28 Sep 2018 16:41:05 +0000</resolved>
                                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16569842" author="githubbot" created="Mon, 6 Aug 2018 07:49:02 +0000"  >&lt;p&gt;klion26 opened a new pull request #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   fix auto close InputStram in InstantiationUtil.deserializeObject&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;br/&gt;
   This change is already covered by existing tests.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature?  no&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16569845" author="githubbot" created="Mon, 6 Aug 2018 07:51:12 +0000"  >&lt;p&gt;klion26 commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-410619461&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-410619461&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   cc @tillrohrmann @fhueske @tzulitai &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16569922" author="githubbot" created="Mon, 6 Aug 2018 09:15:19 +0000"  >&lt;p&gt;StephanEwen commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-410642878&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-410642878&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Interesting. This looks correct. The comment in the code even says the stream should not be closed.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16569924" author="githubbot" created="Mon, 6 Aug 2018 09:18:16 +0000"  >&lt;p&gt;StephanEwen commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-410643692&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-410643692&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Seems correct, especially because the comment above that part indicates that the stream should not be closed.&lt;/p&gt;

&lt;p&gt;   @tzulitai can you share why this was changes in 9659ffd9b3ecafb3ca3a71868cdcde301b5e0b9a ?&lt;/p&gt;

&lt;p&gt;   Are there other places that call this functions where we now need to close the stream explicitly?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16571746" author="githubbot" created="Tue, 7 Aug 2018 14:25:00 +0000"  >&lt;p&gt;klion26 commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-411075093&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-411075093&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @StephanEwen I tracked all the routes, except the following one place may be need close explicity,all the other cals are in try-with-resource or use finally to close the stream explicitly. &lt;/p&gt;

&lt;p&gt;   `InternalTimersSnapshotReaderWriters.InternalTimersSnapshotReaderPreVersioned#restoreKeyAndNamespaceSerializers`&lt;/p&gt;

&lt;p&gt;    Could you please help checking this, If this should close explicitly, I will add it.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582164" author="githubbot" created="Thu, 16 Aug 2018 08:23:21 +0000"  >&lt;p&gt;StefanRRichter commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-413465964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-413465964&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @klion26 The mentioned method is a legacy code path that will be removed eventually. I would not worry to much about that case.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582165" author="githubbot" created="Thu, 16 Aug 2018 08:23:34 +0000"  >&lt;p&gt;StefanRRichter edited a comment on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-413465964&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-413465964&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @klion26 The mentioned method is a legacy code path that will be removed eventually. I would not worry too much about that case.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16583694" author="githubbot" created="Fri, 17 Aug 2018 09:29:05 +0000"  >&lt;p&gt;klion26 commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-413810934&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-413810934&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   ping @StephanEwen @tzulitai @tillrohrmann &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16611683" author="githubbot" created="Wed, 12 Sep 2018 06:59:03 +0000"  >&lt;p&gt;klion26 commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-420534659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-420534659&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Hi, @StephanEwen @tzulitai @tillrohrmann Could you help to review this pr please?&lt;/p&gt;

&lt;p&gt;   I encountered this problem while refactor snapshot/restore in my owner branch, in the restore function, I opened the file and called `InstantiationUtil#deserializeObject` from the previous opened InputStream, then the InputStream will closed by `InstantiationUtil#deserializeObject`.&lt;/p&gt;

&lt;p&gt;   I think others may encounter this problem too, so please help to review this pr, thank you&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16621731" author="githubbot" created="Thu, 20 Sep 2018 09:37:15 +0000"  >&lt;p&gt;tillrohrmann commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-423113951&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-423113951&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @StefanRRichter it seems to me that this method is still being used by the current code. &lt;/p&gt;

&lt;p&gt;   Before continuing with this PR I&apos;d like to hear @tzulitai whether this was changed deliberately or not.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16621738" author="githubbot" created="Thu, 20 Sep 2018 09:39:20 +0000"  >&lt;p&gt;StefanRRichter commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-423114671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-423114671&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @tillrohrmann that is possible, my comment was just about `InternalTimersSnapshotReaderPreVersioned#restoreKeyAndNamespaceSerializers`&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16621747" author="githubbot" created="Thu, 20 Sep 2018 09:42:29 +0000"  >&lt;p&gt;tzulitai commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-423115753&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-423115753&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @tillrohrmann I don&apos;t think this was done deliberately, and the changes here looks correct.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16626673" author="githubbot" created="Tue, 25 Sep 2018 02:10:00 +0000"  >&lt;p&gt;klion26 commented on issue #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498#issuecomment-424183722&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498#issuecomment-424183722&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @tillrohrmann , @StefanRRichter , @tzulitai thank you all for replying, is there anything I need to do before continuing?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16632110" author="githubbot" created="Fri, 28 Sep 2018 16:40:43 +0000"  >&lt;p&gt;tillrohrmann closed pull request #6498: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10065&quot; title=&quot;InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10065&quot;&gt;&lt;del&gt;FLINK-10065&lt;/del&gt;&lt;/a&gt; InstantiationUtil.deserializeObject(InputStream in, ClassLoader cl, boolean isFailureTolerant) will close the inputStream&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6498&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6498&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-core/src/main/java/org/apache/flink/util/InstantiationUtil.java b/flink-core/src/main/java/org/apache/flink/util/InstantiationUtil.java&lt;br/&gt;
index 2370c7c5437..802bbace060 100644&lt;br/&gt;
&amp;#8212; a/flink-core/src/main/java/org/apache/flink/util/InstantiationUtil.java&lt;br/&gt;
+++ b/flink-core/src/main/java/org/apache/flink/util/InstantiationUtil.java&lt;br/&gt;
@@ -495,9 +495,10 @@ public static void writeObjectToConfig(Object o, Configuration config, String ke&lt;/p&gt;

&lt;p&gt; 		final ClassLoader old = Thread.currentThread().getContextClassLoader();&lt;br/&gt;
 		// not using resource try to avoid AutoClosable&apos;s close() on the given stream&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;try (ObjectInputStream oois = isFailureTolerant&lt;br/&gt;
+		try {&lt;br/&gt;
+			ObjectInputStream oois = isFailureTolerant&lt;br/&gt;
 				? new InstantiationUtil.FailureTolerantObjectInputStream(in, cl)&lt;/li&gt;
	&lt;li&gt;: new InstantiationUtil.ClassLoaderObjectInputStream(in, cl)) 
{
+				: new InstantiationUtil.ClassLoaderObjectInputStream(in, cl);
 			Thread.currentThread().setContextClassLoader(cl);
 			return (T) oois.readObject();
 		}&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16632111" author="till.rohrmann" created="Fri, 28 Sep 2018 16:41:05 +0000"  >&lt;p&gt;Fixed via &lt;a href=&quot;https://github.com/apache/flink/commit/c17c87147dae4487c873702e0a2cb2f94ee25ec6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/c17c87147dae4487c873702e0a2cb2f94ee25ec6&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wpxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>