<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:15:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-29992] Hive lookupJoin execution plan parsing error</title>
                <link>https://issues.apache.org/jira/browse/FLINK-29992</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;tableEnv.executeSql(&lt;span class=&quot;code-quote&quot;&gt;&quot; CREATE CATALOG hive WITH (\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;hive&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-database&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;flinkdebug&apos;&lt;/span&gt;,\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-quote&quot;&gt;&apos;hive-conf-dir&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;/programe/hadoop/hive-3.1.2/conf&apos;&lt;/span&gt;\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; )&quot;&lt;/span&gt;);
tableEnv.executeSql(&lt;span class=&quot;code-quote&quot;&gt;&quot;create table datagen_tbl (\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;id STRING\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,name STRING\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,age bigint\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,ts bigint\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,`par` STRING\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,pro_time as PROCTIME()\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;) with (\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;datagen&apos;&lt;/span&gt;\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;,&lt;span class=&quot;code-quote&quot;&gt;&apos;rows-per-second&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;\n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; \n&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; dml1 = &lt;span class=&quot;code-quote&quot;&gt;&quot;select * &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; from datagen_tbl as p &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; join hive.flinkdebug.default_hive_src_tbl &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; FOR SYSTEM_TIME AS OF p.pro_time AS c&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; ON p.id = c.id&quot;&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;// Execution succeeded
&lt;/span&gt; &#160;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(tableEnv.explainSql(dml1));
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; dml2 = &lt;span class=&quot;code-quote&quot;&gt;&quot;select p.id &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; from datagen_tbl as p &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; join hive.flinkdebug.default_hive_src_tbl &quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; FOR SYSTEM_TIME AS OF p.pro_time AS c&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; ON p.id = c.id&quot;&lt;/span&gt;;
&lt;span class=&quot;code-comment&quot;&gt;// Throw an exception
&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(tableEnv.explainSql(dml2)); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.flink.table.api.TableException: Cannot generate a valid execution plan &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the given query:&#160;FlinkLogicalCalc(select=[id]) +- FlinkLogicalJoin(condition=[=($0, $1)], joinType=[&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;]) &#160; &#160;:- FlinkLogicalCalc(select=[id]) &#160; &#160;: &#160;+- FlinkLogicalTableSourceScan(table=[[default_catalog, default_database, datagen_tbl]], fields=[id, name, age, ts, par]) &#160; &#160;+- FlinkLogicalSnapshot(period=[$cor1.pro_time]) &#160; &#160; &#160; +- FlinkLogicalTableSourceScan(table=[[hive, flinkdebug, default_hive_src_tbl, project=[id]]], fields=[id])This exception indicates that the query uses an unsupported SQL feature. Please check the documentation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the set of currently supported SQL features.&#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkVolcanoProgram.optimize(FlinkVolcanoProgram.scala:70) &#160; &#160; at org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram.$anonfun$optimize$1(FlinkChainedProgram.scala:59)
 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13501073">FLINK-29992</key>
            <summary>Hive lookupJoin execution plan parsing error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luoyuxia">luoyuxia</assignee>
                                    <reporter username="HunterHunter">HunterXHunter</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 11 Nov 2022 09:39:04 +0000</created>
                <updated>Wed, 16 Nov 2022 08:00:19 +0000</updated>
                            <resolved>Wed, 16 Nov 2022 07:59:44 +0000</resolved>
                                    <version>1.16.0</version>
                    <version>1.17.0</version>
                    <version>1.14.7</version>
                    <version>1.15.4</version>
                                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17632217" author="hunterhunter" created="Fri, 11 Nov 2022 09:45:06 +0000"  >&lt;p&gt;This use case is normal in 1.15.&lt;/p&gt;</comment>
                            <comment id="17632335" author="luoyuxia" created="Fri, 11 Nov 2022 13:00:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=HunterHunter&quot; class=&quot;user-hover&quot; rel=&quot;HunterHunter&quot;&gt;HunterHunter&lt;/a&gt; Thanks for raising it. I&apos;ll fix it asap&lt;/p&gt;</comment>
                            <comment id="17632594" author="luoyuxia" created="Sat, 12 Nov 2022 03:14:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-29138&quot; title=&quot;Project pushdown not work for lookup source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-29138&quot;&gt;&lt;del&gt;FLINK-29138&lt;/del&gt;&lt;/a&gt; introduce project push down for lookup source, then the `PushProjectIntoTableSourceScanRule` will work which will then&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sourceTable.tableSource().copy(); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;But the HiveLookupTableSource doesn&apos;t implement copy method which will delegate to it&apos;s parent method, and then copy a `HiveTableSource` which is not a lookup source.&lt;/p&gt;</comment>
                            <comment id="17633438" author="leonard xu" created="Mon, 14 Nov 2022 02:05:42 +0000"  >&lt;p&gt;master:a4f9bfd1483ef64b0ed167bd29c98596e3bd5f49&lt;br/&gt;
release-1.16: c946b0b95b7b8396eac7f03019eb279becddd301&lt;br/&gt;
release-1.15: c257f98bf38668f5bd9d48ccd307f9f76e2463b2&lt;br/&gt;
release-1.14: 9cb7b338c90b8183aa7ab4c9e094e47221d182cb&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1bwa8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>