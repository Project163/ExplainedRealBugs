<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:31:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8174] Mesos RM unable to accept offers for unreserved resources</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8174</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Flink has suffered a regression due to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7294&quot; title=&quot;mesos.resourcemanager.framework.role not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7294&quot;&gt;&lt;del&gt;FLINK-7294&lt;/del&gt;&lt;/a&gt;.   Any attempt to accept a resource offer that is based on unreserved resources will fail, because Flink (as of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-7294&quot; title=&quot;mesos.resourcemanager.framework.role not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-7294&quot;&gt;&lt;del&gt;FLINK-7294&lt;/del&gt;&lt;/a&gt;) erroneously insists that the resource come from a prior reservation.&lt;/p&gt;

&lt;p&gt;Looking at the original issue, the problem may have been misdiagnosed.  Ideally Flink should work with both reserved and unreserved resources, but the latter is a more common situation that is now broken.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13121810">FLINK-8174</key>
            <summary>Mesos RM unable to accept offers for unreserved resources</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eronwright">Eron Wright</assignee>
                                    <reporter username="eronwright">Eron Wright</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Nov 2017 03:32:07 +0000</created>
                <updated>Thu, 7 Dec 2017 11:55:13 +0000</updated>
                            <resolved>Wed, 6 Dec 2017 10:56:24 +0000</resolved>
                                    <version>1.3.3</version>
                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>Deployment / Mesos</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16273185" author="aljoscha" created="Thu, 30 Nov 2017 19:03:29 +0000"  >&lt;p&gt;Are there any updates on this?&lt;/p&gt;</comment>
                            <comment id="16273345" author="eronwright" created="Thu, 30 Nov 2017 20:22:02 +0000"  >&lt;p&gt;We&apos;re working on a fix that will allow Flink to use both unreserved and reserved resources.   If we cannot solve it soon, I would suggest reverting the earlier fix so that unreserved resources work as they did before.  I&apos;ll send another update to the dev list later.&lt;/p&gt;</comment>
                            <comment id="16273365" author="aljoscha" created="Thu, 30 Nov 2017 20:32:11 +0000"  >&lt;p&gt;thanks!&lt;/p&gt;</comment>
                            <comment id="16275886" author="githubbot" created="Sun, 3 Dec 2017 11:30:47 +0000"  >&lt;p&gt;GitHub user EronWright opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8174&quot; title=&quot;Mesos RM unable to accept offers for unreserved resources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8174&quot;&gt;&lt;del&gt;FLINK-8174&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;mesos&amp;#93;&lt;/span&gt; Mesos RM unable to accept offers for unreserved resources&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;br/&gt;
    This PR improves the Mesos RM to work correctly with both reserved and unreserved resources.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Introduce `MesosResourceAllocation` to allocate offered resources to task resources.&lt;/li&gt;
	&lt;li&gt;Introduce `Offer` to replace Fenzo&apos;s `VMLeaseObject` with proper accumulation across reserved and unreserved resources.&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change added tests and can be verified as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Unit tests:&lt;/li&gt;
	&lt;li&gt;`MesosResourceAllocationTest`&lt;/li&gt;
	&lt;li&gt;Manual tests:&lt;/li&gt;
	&lt;li&gt;Launch with unreserved resources&lt;/li&gt;
	&lt;li&gt;Launch with a static reservation&lt;/li&gt;
	&lt;li&gt;Launch with a dynamic reservation&lt;/li&gt;
	&lt;li&gt;Launch with a mix of reserved and unreserved resources&lt;/li&gt;
	&lt;li&gt;Launch numerous tasks from a single offer&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): no&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: no&lt;/li&gt;
	&lt;li&gt;The serializers: no&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): no&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: no&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: no&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? no&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? not applicable&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/EronWright/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/EronWright/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8174&quot; title=&quot;Mesos RM unable to accept offers for unreserved resources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8174&quot;&gt;&lt;del&gt;FLINK-8174&lt;/del&gt;&lt;/a&gt;-2&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5114&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 66d885b14ba9cd823489e6f61665459b6af45fbd&lt;br/&gt;
Author: Eron Wright &amp;lt;eronwright@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-12-03T11:14:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8174&quot; title=&quot;Mesos RM unable to accept offers for unreserved resources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8174&quot;&gt;&lt;del&gt;FLINK-8174&lt;/del&gt;&lt;/a&gt; Mesos RM unable to accept offers for unreserved resources&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16275895" author="githubbot" created="Sun, 3 Dec 2017 11:49:35 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Log output showing a &apos;mixed&apos; scenario, involving two tasks, combining resources across the reserved and unreserved resources in a single offer.&lt;br/&gt;
    ```&lt;br/&gt;
    Assigning resources: [cpus(myrole):2.0; mem(myrole):4096.0; ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1025-2180&amp;#93;&lt;/span&gt;; ports&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;2182-3887,3889-5049,5052-8079,8082-8180,8182-32000&amp;#93;&lt;/span&gt;; disk&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:28829.0; cpus&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:2.0; mem&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:10766.0]   &lt;/p&gt;

&lt;p&gt;    Processing task taskmanager-00002                                                                                         &lt;br/&gt;
    Allocating 1.5 cpus                                                                                                       &lt;br/&gt;
    Taking 1.5 from cpus(myrole):2.0                                             &lt;br/&gt;
    Allocated: &lt;span class=&quot;error&quot;&gt;&amp;#91;cpus(myrole):1.5&amp;#93;&lt;/span&gt;, unsatisfied: 0.0                              &lt;br/&gt;
    Allocating 4096.0 mem                                                                                                     &lt;br/&gt;
    Taking 4096.0 from mem(myrole):4096.0                                        &lt;br/&gt;
    Allocated: &lt;span class=&quot;error&quot;&gt;&amp;#91;mem(myrole):4096.0&amp;#93;&lt;/span&gt;, unsatisfied: 0.0                            &lt;br/&gt;
    Allocating 2 ports                                                                                                        &lt;br/&gt;
    Taking &lt;span class=&quot;error&quot;&gt;&amp;#91;1025-1026&amp;#93;&lt;/span&gt; from ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1025-2180&amp;#93;&lt;/span&gt;                            &lt;br/&gt;
    Allocated: [ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1025-1026&amp;#93;&lt;/span&gt;], unsatisfied: 0                       &lt;/p&gt;

&lt;p&gt;    Processing task taskmanager-00001                                                                                         &lt;br/&gt;
    Allocating 1.5 cpus                                                                                                       &lt;br/&gt;
    Taking 0.5 from cpus(myrole):0.5                                             &lt;br/&gt;
    Taking 1.0 from cpus&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:2.0                                                                                               &lt;br/&gt;
    Allocated: &lt;span class=&quot;error&quot;&gt;&amp;#91;cpus(myrole):0.5; cpus(*):1.0&amp;#93;&lt;/span&gt;, unsatisfied: 0.0                 &lt;br/&gt;
    Allocating 4096.0 mem                                                                                                     &lt;br/&gt;
    Taking 4096.0 from mem&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:10766.0                                                                                         &lt;br/&gt;
    Allocated: &lt;span class=&quot;error&quot;&gt;&amp;#91;mem(*):4096.0&amp;#93;&lt;/span&gt;, unsatisfied: 0.0                                                                              &lt;br/&gt;
    Allocating 2 ports                                                                                                        &lt;br/&gt;
    Taking &lt;span class=&quot;error&quot;&gt;&amp;#91;1027-1028&amp;#93;&lt;/span&gt; from ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1027-2180&amp;#93;&lt;/span&gt;                            &lt;br/&gt;
    Allocated: [ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1027-1028&amp;#93;&lt;/span&gt;], unsatisfied: 0                       &lt;/p&gt;

&lt;p&gt;    Remaining resources: [ports(myrole):&lt;span class=&quot;error&quot;&gt;&amp;#91;1029-2180&amp;#93;&lt;/span&gt;; ports&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;2182-3887,3889-5049,5052-8079,8082-8180,8182-32000&amp;#93;&lt;/span&gt;; disk&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:28829.0; cpus&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:1.0; mem&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;:6670.0]&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="16277150" author="githubbot" created="Mon, 4 Dec 2017 17:47:34 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for your fast contribution @EronWright. I will take a closer look at the fix but from a first glance it seems that the `LaunchCoordinatorTest` fails. Could you fix this test case while I look at the code? Thanks a lot.&lt;/p&gt;</comment>
                            <comment id="16278567" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154723123&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154723123&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/Utils.java &amp;#8212;&lt;br/&gt;
    @@ -101,4 +106,59 @@&lt;br/&gt;
     			.setRole(role)&lt;br/&gt;
     			.build();&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a stream of values from a collection of range resources.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static LongStream rangeValues(Collection&amp;lt;Protos.Resource&amp;gt; resources) {&lt;br/&gt;
    +		return resources.stream()&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Maybe we could add a null check for `resources`.&lt;/p&gt;</comment>
                            <comment id="16278568" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154723216&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154723216&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/Utils.java &amp;#8212;&lt;br/&gt;
    @@ -101,4 +106,59 @@&lt;br/&gt;
     			.setRole(role)&lt;br/&gt;
     			.build();&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a stream of values from a collection of range resources.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static LongStream rangeValues(Collection&amp;lt;Protos.Resource&amp;gt; resources) &lt;/p&gt;
{
    +		return resources.stream()
    +			.filter(Protos.Resource::hasRanges)
    +			.flatMap(r -&amp;gt; r.getRanges().getRangeList().stream())
    +			.flatMapToLong(Utils::rangeValues);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a stream of values from a range.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static LongStream rangeValues(Protos.Value.Range range) {&lt;br/&gt;
    +		return LongStream.rangeClosed(range.getBegin(), range.getEnd());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Null check for `range` missing.&lt;/p&gt;</comment>
                            <comment id="16278569" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154870701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154870701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/util/MesosResourceAllocation.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,197 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.util;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.Comparator;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.ListIterator;&lt;br/&gt;
    +import java.util.Set;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.print;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * An allocation of resources on a particular host from one or more Mesos offers, to be portioned out to tasks.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;This class assumes that the resources were offered &amp;lt;b&amp;gt;without&amp;lt;/b&amp;gt; the &lt;/p&gt;
{@code RESERVATION_REFINEMENT}
&lt;p&gt; capability,&lt;br/&gt;
    + * as detailed in the &quot;Resource Format&quot; section of the Mesos protocol definition.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;This class is not thread-safe.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class MesosResourceAllocation {&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final Logger LOG = LoggerFactory.getLogger(MesosResourceAllocation.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	static final double EPSILON = 1e-5;&lt;br/&gt;
    +	static final String UNRESERVED_ROLE = &quot;*&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private final List&amp;lt;Protos.Resource&amp;gt; resources;&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Creates an allocation of resources for tasks to take.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param resources the resources to add to the allocation.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public MesosResourceAllocation(Collection&amp;lt;Protos.Resource&amp;gt; resources) {&lt;br/&gt;
    +		this.resources = new ArrayList&amp;lt;&amp;gt;(resources);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    null check is missing.&lt;/p&gt;</comment>
                            <comment id="16278570" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154723628&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154723628&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/Utils.java &amp;#8212;&lt;br/&gt;
    @@ -101,4 +106,59 @@&lt;br/&gt;
     			.setRole(role)&lt;br/&gt;
     			.build();&lt;br/&gt;
     	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a stream of values from a collection of range resources.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static LongStream rangeValues(Collection&amp;lt;Protos.Resource&amp;gt; resources) &lt;/p&gt;
{
    +		return resources.stream()
    +			.filter(Protos.Resource::hasRanges)
    +			.flatMap(r -&amp;gt; r.getRanges().getRangeList().stream())
    +			.flatMapToLong(Utils::rangeValues);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a stream of values from a range.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static LongStream rangeValues(Protos.Value.Range range) &lt;/p&gt;
{
    +		return LongStream.rangeClosed(range.getBegin(), range.getEnd());
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets a string representation of a collection of resources.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public static String print(Collection&amp;lt;Protos.Resource&amp;gt; resources) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shall we rename this method to `toString` or something similar, because `print` does not really print the string value.&lt;/p&gt;</comment>
                            <comment id="16278571" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154910275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154910275&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/scheduler/Offer.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,173 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.scheduler;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.netflix.fenzo.VirtualMachineLease;&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.stream.Collectors;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.print;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * An adapter class to transform a Mesos resource offer to a Fenzo &lt;/p&gt;
{@link VirtualMachineLease}
&lt;p&gt;.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;The default implementation provided by Fenzo isn&apos;t compatible with reserved resources.&lt;br/&gt;
    + * This implementation properly combines resources, e.g. a combination of reserved and unreserved cpus.&lt;br/&gt;
    + *&lt;br/&gt;
    + */&lt;br/&gt;
    +public class Offer implements VirtualMachineLease {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger logger = LoggerFactory.getLogger(Offer.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	private final Protos.Offer offer;&lt;br/&gt;
    +	private final String hostname;&lt;br/&gt;
    +	private final String vmID;&lt;br/&gt;
    +	private final long offeredTime;&lt;br/&gt;
    +&lt;br/&gt;
    +	private final List&amp;lt;Protos.Resource&amp;gt; resources;&lt;br/&gt;
    +	private final Map&amp;lt;String, List&amp;lt;Protos.Resource&amp;gt;&amp;gt; resourceMap;&lt;br/&gt;
    +	private final Map&amp;lt;String, Protos.Attribute&amp;gt; attributeMap;&lt;br/&gt;
    +&lt;br/&gt;
    +	public Offer(Protos.Offer offer) {&lt;br/&gt;
    +		this.offer = offer;&lt;br/&gt;
    +		this.hostname = offer.getHostname();&lt;br/&gt;
    +		this.vmID = offer.getSlaveId().getValue();&lt;br/&gt;
    +		this.offeredTime = System.currentTimeMillis();&lt;br/&gt;
    +&lt;br/&gt;
    +		this.resources = new ArrayList&amp;lt;&amp;gt;(offer.getResourcesList().size());&lt;br/&gt;
    +		this.resourceMap = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
    +		for (Protos.Resource resource : offer.getResourcesList()) {&lt;br/&gt;
    +			switch (resource.getType()) &lt;/p&gt;
{
    +				case SCALAR:
    +				case RANGES:
    +					resources.add(resource);
    +					resourceMap.computeIfAbsent(resource.getName(), k -&amp;gt; new ArrayList&amp;lt;&amp;gt;(2)).add(resource);
    +					break;
    +				default:
    +					logger.debug(&quot;Unknown resource type &quot; + resource.getType() + &quot; for resource &quot; + resource.getName() +
    +						&quot; in offer, hostname=&quot; + hostname + &quot;, offerId=&quot; + offer.getId());
    +			}
&lt;p&gt;    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		if (offer.getAttributesCount() &amp;gt; 0) {&lt;br/&gt;
    +			Map&amp;lt;String, Protos.Attribute&amp;gt; attributeMap = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
    +			for (Protos.Attribute attribute: offer.getAttributesList()) &lt;/p&gt;
{
    +				attributeMap.put(attribute.getName(), attribute);
    +			}
&lt;p&gt;    +			this.attributeMap = Collections.unmodifiableMap(attributeMap);&lt;br/&gt;
    +		} else &lt;/p&gt;
{
    +			this.attributeMap = Collections.emptyMap();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	public List&amp;lt;Protos.Resource&amp;gt; getResources() &lt;/p&gt;
{
    +		return Collections.unmodifiableList(resources);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Override&lt;br/&gt;
    +	public String hostname() &lt;/p&gt;
{
    +		return hostname;
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Override&lt;br/&gt;
    +	public String getVMID() &lt;/p&gt;
{
    +		return vmID;
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	@Override&lt;br/&gt;
    +	public double cpuCores() {&lt;br/&gt;
    +		return aggregateScalarResource(&quot;cpus&quot;);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Do we have to calculate these values lazily? If not, then I would like to precompute these values.&lt;/p&gt;</comment>
                            <comment id="16278572" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154874365&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154874365&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -322,12 +326,19 @@ object LaunchCoordinator {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return the operations to perform.&lt;br/&gt;
         */&lt;br/&gt;
       private def processAssignments(&lt;br/&gt;
    +      LOG: Logger,
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    same here with the parameter name.&lt;/p&gt;</comment>
                            <comment id="16278573" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154873317&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154873317&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/util/MesosResourceAllocation.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,197 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.util;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +import java.util.Collection;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.Comparator;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.ListIterator;&lt;br/&gt;
    +import java.util.Set;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.print;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * An allocation of resources on a particular host from one or more Mesos offers, to be portioned out to tasks.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;This class assumes that the resources were offered &amp;lt;b&amp;gt;without&amp;lt;/b&amp;gt; the &lt;/p&gt;
{@code RESERVATION_REFINEMENT}
&lt;p&gt; capability,&lt;br/&gt;
    + * as detailed in the &quot;Resource Format&quot; section of the Mesos protocol definition.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;This class is not thread-safe.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class MesosResourceAllocation {&lt;br/&gt;
    +&lt;br/&gt;
    +	protected static final Logger LOG = LoggerFactory.getLogger(MesosResourceAllocation.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	static final double EPSILON = 1e-5;&lt;br/&gt;
    +	static final String UNRESERVED_ROLE = &quot;*&quot;;&lt;br/&gt;
    +&lt;br/&gt;
    +	private final List&amp;lt;Protos.Resource&amp;gt; resources;&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Creates an allocation of resources for tasks to take.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param resources the resources to add to the allocation.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public MesosResourceAllocation(Collection&amp;lt;Protos.Resource&amp;gt; resources) &lt;/p&gt;
{
    +		this.resources = new ArrayList&amp;lt;&amp;gt;(resources);
    +
    +		// sort the resources to prefer reserved resources
    +		this.resources.sort(Comparator.comparing(r -&amp;gt; UNRESERVED_ROLE.equals(r.getRole())));
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Gets the remaining resources.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public List&amp;lt;Protos.Resource&amp;gt; getRemaining() &lt;/p&gt;
{
    +		return Collections.unmodifiableList(resources);
    +	}
&lt;p&gt;    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Takes some amount of scalar resources (e.g. cpus, mem).&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param amount the (approximate) amount to take from the available quantity.&lt;br/&gt;
    +	 * @param roles the roles to accept&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public List&amp;lt;Protos.Resource&amp;gt; takeScalar(String resourceName, double amount, Set&amp;lt;String&amp;gt; roles) {&lt;br/&gt;
    +		if (LOG.isDebugEnabled()) {&lt;br/&gt;
    +			LOG.debug(&quot;Allocating {} {}&quot;, amount, resourceName);&lt;br/&gt;
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		List&amp;lt;Protos.Resource&amp;gt; result = new ArrayList&amp;lt;&amp;gt;(1);&lt;br/&gt;
    +		for (ListIterator&amp;lt;Protos.Resource&amp;gt; i = resources.listIterator(); i.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; {&lt;br/&gt;
    +			if (amount &amp;lt;= EPSILON) &lt;/p&gt;
{
    +				break;
    +			}&lt;br/&gt;
    +&lt;br/&gt;
    +			// take from next available scalar resource that is unreserved or reserved for an applicable role&lt;br/&gt;
    +			Protos.Resource available = i.next();&lt;br/&gt;
    +			if (!resourceName.equals(available.getName()) || !available.hasScalar()) {
    +				continue;
    +			}&lt;br/&gt;
    +			if (!UNRESERVED_ROLE.equals(available.getRole()) &amp;amp;&amp;amp; !roles.contains(available.getRole())) {    +				continue;    +			}&lt;br/&gt;
    +&lt;br/&gt;
    +			double amountToTake = Math.min(available.getScalar().getValue(), amount);&lt;br/&gt;
    +			Protos.Resource taken = available.toBuilder().setScalar(Protos.Value.Scalar.newBuilder().setValue(amountToTake)).build();&lt;br/&gt;
    +			amount -= amountToTake;&lt;br/&gt;
    +			result.add(taken);&lt;br/&gt;
    +			if (LOG.isDebugEnabled()) {&lt;br/&gt;
    +				LOG.debug(&quot;Taking {} from {}&quot;, amountToTake, print(available));&lt;br/&gt;
    +			}&lt;br/&gt;
    +&lt;br/&gt;
    +			// keep remaining amount (if any)&lt;br/&gt;
    +			double remaining = available.getScalar().getValue() - taken.getScalar().getValue();&lt;br/&gt;
    +			if (remaining &amp;gt; EPSILON) {
    +				i.set(available.toBuilder().setScalar(Protos.Value.Scalar.newBuilder().setValue(remaining)).build());
    +			}&lt;br/&gt;
    +			else {
    +				i.remove();
    +			}&lt;br/&gt;
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		if (LOG.isDebugEnabled()) {&lt;br/&gt;
    +			LOG.debug(&quot;Allocated: {}, unsatisfied: {}&quot;, print(result), amount);&lt;br/&gt;
    +		}&lt;br/&gt;
    +		return result;&lt;br/&gt;
    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Takes some amount of range resources (e.g. ports).&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param amount the number of values to take from the available range(s).&lt;br/&gt;
    +	 * @param roles the roles to accept&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	public List&amp;lt;Protos.Resource&amp;gt; takeRanges(String resourceName, int amount, Set&amp;lt;String&amp;gt; roles) {&lt;br/&gt;
    +		if (LOG.isDebugEnabled()) {&lt;br/&gt;
    +			LOG.debug(&quot;Allocating {} {}&quot;, amount, resourceName);&lt;br/&gt;
    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		List&amp;lt;Protos.Resource&amp;gt; result = new ArrayList&amp;lt;&amp;gt;(1);&lt;br/&gt;
    +		for (ListIterator&amp;lt;Protos.Resource&amp;gt; i = resources.listIterator(); i.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; {&lt;br/&gt;
    +			if (amount &amp;lt;= 0) {    +				break;    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			// take from next available range resource that is unreserved or reserved for an applicable role&lt;br/&gt;
    +			Protos.Resource available = i.next();&lt;br/&gt;
    +			if (!resourceName.equals(available.getName()) || !available.hasRanges()) &lt;/p&gt;
{
    +				continue;
    +			}&lt;br/&gt;
    +			if (!UNRESERVED_ROLE.equals(available.getRole()) &amp;amp;&amp;amp; !roles.contains(available.getRole())) {    +				continue;    +			}
&lt;p&gt;    +&lt;br/&gt;
    +			List&amp;lt;Protos.Value.Range&amp;gt; takenRanges = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
    +			List&amp;lt;Protos.Value.Range&amp;gt; remainingRanges = new ArrayList&amp;lt;&amp;gt;(available.getRanges().getRangeList());&lt;br/&gt;
    +			for (ListIterator&amp;lt;Protos.Value.Range&amp;gt; j = remainingRanges.listIterator(); j.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; {&lt;br/&gt;
    +				if (amount &amp;lt;= 0) &lt;/p&gt;
{
    +					break;
    +				}
&lt;p&gt;    +&lt;br/&gt;
    +				// take from next available range (note: ranges are inclusive)&lt;br/&gt;
    +				Protos.Value.Range availableRange = j.next();&lt;br/&gt;
    +				long amountToTake = Math.min(availableRange.getEnd() - availableRange.getBegin() + 1, amount);&lt;br/&gt;
    +				Protos.Value.Range takenRange = availableRange.toBuilder().setEnd(availableRange.getBegin() + amountToTake - 1).build();&lt;br/&gt;
    +				amount -= amountToTake;&lt;br/&gt;
    +				takenRanges.add(takenRange);&lt;br/&gt;
    +&lt;br/&gt;
    +				// keep remaining range (if any)&lt;br/&gt;
    +				long remaining = availableRange.getEnd() - takenRange.getEnd();&lt;br/&gt;
    +				if (remaining &amp;gt; 0) {&lt;br/&gt;
    +					j.set(availableRange.toBuilder().setBegin(availableRange.getEnd() - remaining + 1).build());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think this expression could be simplified to `takenRange.getEnd() + 1`.&lt;/p&gt;</comment>
                            <comment id="16278574" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154869018&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154869018&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/scheduler/Offer.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,173 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.scheduler;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.netflix.fenzo.VirtualMachineLease;&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.stream.Collectors;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.print;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * An adapter class to transform a Mesos resource offer to a Fenzo &lt;/p&gt;
{@link VirtualMachineLease}
&lt;p&gt;.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;The default implementation provided by Fenzo isn&apos;t compatible with reserved resources.&lt;br/&gt;
    + * This implementation properly combines resources, e.g. a combination of reserved and unreserved cpus.&lt;br/&gt;
    + *&lt;br/&gt;
    + */&lt;br/&gt;
    +public class Offer implements VirtualMachineLease {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger logger = LoggerFactory.getLogger(Offer.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	private final Protos.Offer offer;&lt;br/&gt;
    +	private final String hostname;&lt;br/&gt;
    +	private final String vmID;&lt;br/&gt;
    +	private final long offeredTime;&lt;br/&gt;
    +&lt;br/&gt;
    +	private final List&amp;lt;Protos.Resource&amp;gt; resources;&lt;br/&gt;
    +	private final Map&amp;lt;String, List&amp;lt;Protos.Resource&amp;gt;&amp;gt; resourceMap;&lt;br/&gt;
    +	private final Map&amp;lt;String, Protos.Attribute&amp;gt; attributeMap;&lt;br/&gt;
    +&lt;br/&gt;
    +	public Offer(Protos.Offer offer) {&lt;br/&gt;
    +		this.offer = offer;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    check not null missing&lt;/p&gt;</comment>
                            <comment id="16278575" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154870143&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154870143&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/scheduler/Offer.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,173 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.scheduler;&lt;br/&gt;
    +&lt;br/&gt;
    +import com.netflix.fenzo.VirtualMachineLease;&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.slf4j.Logger;&lt;br/&gt;
    +import org.slf4j.LoggerFactory;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.ArrayList;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.HashMap;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.Map;&lt;br/&gt;
    +import java.util.stream.Collectors;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.print;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * An adapter class to transform a Mesos resource offer to a Fenzo &lt;/p&gt;
{@link VirtualMachineLease}
&lt;p&gt;.&lt;br/&gt;
    + *&lt;br/&gt;
    + * &amp;lt;p&amp;gt;The default implementation provided by Fenzo isn&apos;t compatible with reserved resources.&lt;br/&gt;
    + * This implementation properly combines resources, e.g. a combination of reserved and unreserved cpus.&lt;br/&gt;
    + *&lt;br/&gt;
    + */&lt;br/&gt;
    +public class Offer implements VirtualMachineLease {&lt;br/&gt;
    +&lt;br/&gt;
    +	private static final Logger logger = LoggerFactory.getLogger(Offer.class);&lt;br/&gt;
    +&lt;br/&gt;
    +	private final Protos.Offer offer;&lt;br/&gt;
    +	private final String hostname;&lt;br/&gt;
    +	private final String vmID;&lt;br/&gt;
    +	private final long offeredTime;&lt;br/&gt;
    +&lt;br/&gt;
    +	private final List&amp;lt;Protos.Resource&amp;gt; resources;&lt;br/&gt;
    +	private final Map&amp;lt;String, List&amp;lt;Protos.Resource&amp;gt;&amp;gt; resourceMap;&lt;br/&gt;
    +	private final Map&amp;lt;String, Protos.Attribute&amp;gt; attributeMap;&lt;br/&gt;
    +&lt;br/&gt;
    +	public Offer(Protos.Offer offer) {&lt;br/&gt;
    +		this.offer = offer;&lt;br/&gt;
    +		this.hostname = offer.getHostname();&lt;br/&gt;
    +		this.vmID = offer.getSlaveId().getValue();&lt;br/&gt;
    +		this.offeredTime = System.currentTimeMillis();&lt;br/&gt;
    +&lt;br/&gt;
    +		this.resources = new ArrayList&amp;lt;&amp;gt;(offer.getResourcesList().size());&lt;br/&gt;
    +		this.resourceMap = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
    +		for (Protos.Resource resource : offer.getResourcesList()) {&lt;br/&gt;
    +			switch (resource.getType()) &lt;/p&gt;
{
    +				case SCALAR:
    +				case RANGES:
    +					resources.add(resource);
    +					resourceMap.computeIfAbsent(resource.getName(), k -&amp;gt; new ArrayList&amp;lt;&amp;gt;(2)).add(resource);
    +					break;
    +				default:
    +					logger.debug(&quot;Unknown resource type &quot; + resource.getType() + &quot; for resource &quot; + resource.getName() +
    +						&quot; in offer, hostname=&quot; + hostname + &quot;, offerId=&quot; + offer.getId());
    +			}
&lt;p&gt;    +		}&lt;br/&gt;
    +&lt;br/&gt;
    +		if (offer.getAttributesCount() &amp;gt; 0) {&lt;br/&gt;
    +			Map&amp;lt;String, Protos.Attribute&amp;gt; attributeMap = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
    +			for (Protos.Attribute attribute: offer.getAttributesList()) &lt;/p&gt;
{
    +				attributeMap.put(attribute.getName(), attribute);
    +			}
&lt;p&gt;    +			this.attributeMap = Collections.unmodifiableMap(attributeMap);&lt;br/&gt;
    +		} else &lt;/p&gt;
{
    +			this.attributeMap = Collections.emptyMap();
    +		}
&lt;p&gt;    +	}&lt;br/&gt;
    +&lt;br/&gt;
    +	public List&amp;lt;Protos.Resource&amp;gt; getResources() {&lt;br/&gt;
    +		return Collections.unmodifiableList(resources);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Can we make `this.resources` an unmodifiable list instead?&lt;/p&gt;</comment>
                            <comment id="16278576" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154873853&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154873853&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -148,14 +149,17 @@ class LaunchCoordinator(&lt;/p&gt;

&lt;p&gt;         case Event(offers: ResourceOffers, data: GatherData) =&amp;gt;&lt;br/&gt;
           val leases = offers.offers().asScala.map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new VMLeaseObject(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +        new Offer(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think we can remove the `asInstanceOf`.&lt;/p&gt;</comment>
                            <comment id="16278577" author="githubbot" created="Tue, 5 Dec 2017 13:50:47 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154873911&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154873911&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -148,14 +149,17 @@ class LaunchCoordinator(&lt;/p&gt;

&lt;p&gt;         case Event(offers: ResourceOffers, data: GatherData) =&amp;gt;&lt;br/&gt;
           val leases = offers.offers().asScala.map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new VMLeaseObject(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +        new Offer(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
           if(LOG.isInfoEnabled) {&lt;br/&gt;
             val (cpus, mem) = leases.foldLeft((0.0,0.0)) 
{
               (z,o) =&amp;gt; (z._1 + o.cpuCores(), z._2 + o.memoryMB())
             }
&lt;p&gt;             LOG.info(s&quot;Received offer(s) of $mem MB, $cpus cpus:&quot;)&lt;br/&gt;
             for(l &amp;lt;- leases) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;LOG.info(s&quot;  ${l.getId} from ${l.hostname()} of ${l.memoryMB()} MB, ${l.cpuCores()} cpus&quot;)&lt;br/&gt;
    +          val reservations = l.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Offer&amp;#93;&lt;/span&gt;.getResources.asScala.map(_.getRole).toSet
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    `asInstanceOf` should not be needed if we remove it above as well.&lt;/p&gt;</comment>
                            <comment id="16278578" author="githubbot" created="Tue, 5 Dec 2017 13:50:48 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154874795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154874795&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/test/java/org/apache/flink/mesos/util/MesosResourceAllocationTest.java &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,297 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.mesos.util;&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.mesos.Protos;&lt;br/&gt;
    +import org.junit.Assert;&lt;br/&gt;
    +import org.junit.Test;&lt;br/&gt;
    +&lt;br/&gt;
    +import java.util.Arrays;&lt;br/&gt;
    +import java.util.Collections;&lt;br/&gt;
    +import java.util.List;&lt;br/&gt;
    +import java.util.Set;&lt;br/&gt;
    +&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.range;&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.ranges;&lt;br/&gt;
    +import static org.apache.flink.mesos.Utils.scalar;&lt;br/&gt;
    +import static org.apache.flink.mesos.util.MesosResourceAllocation.UNRESERVED_ROLE;&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    + * Tests &lt;/p&gt;
{@link MesosResourceAllocation}
&lt;p&gt;.&lt;br/&gt;
    + */&lt;br/&gt;
    +public class MesosResourceAllocationTest {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    extends `TestLogger`&lt;/p&gt;</comment>
                            <comment id="16278579" author="githubbot" created="Tue, 5 Dec 2017 13:50:48 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154725875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154725875&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/LaunchableMesosWorker.java &amp;#8212;&lt;br/&gt;
    @@ -217,15 +222,13 @@ public String toString() &lt;/p&gt;
{
     			dynamicProperties.setString(ConfigConstants.TASK_MANAGER_HOSTNAME_KEY, taskManagerHostname);
     		}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// use the assigned ports for the TM&lt;/li&gt;
	&lt;li&gt;if (assignment.getAssignedPorts().size() &amp;lt; TM_PORT_KEYS.length) 
{
    -			throw new IllegalArgumentException(&quot;unsufficient # of ports assigned&quot;);
    -		}&lt;/li&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; TM_PORT_KEYS.length; i++) {&lt;/li&gt;
	&lt;li&gt;int port = assignment.getAssignedPorts().get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;String key = TM_PORT_KEYS&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;/li&gt;
	&lt;li&gt;taskInfo.addResources(ranges(&quot;ports&quot;, mesosConfiguration.frameworkInfo().getRole(), range(port, port)));&lt;/li&gt;
	&lt;li&gt;dynamicProperties.setInteger(key, port);&lt;br/&gt;
    +		// take needed ports for the TM&lt;br/&gt;
    +		List&amp;lt;Protos.Resource&amp;gt; portResources = allocation.takeRanges(&quot;ports&quot;, TM_PORT_KEYS.length, roles);&lt;br/&gt;
    +		taskInfo.addAllResources(portResources);&lt;br/&gt;
    +		Iterator&amp;lt;String&amp;gt; portsToAssign = Iterators.forArray(TM_PORT_KEYS);&lt;br/&gt;
    +		rangeValues(portResources).forEach(port -&amp;gt; dynamicProperties.setLong(portsToAssign.next(), port));
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This might fail with a `NoSuchElementException` if `portsToAssign.size &amp;lt; rangeValues(portResources).size`. I assume that we don&apos;t have to fail in this scenario.&lt;/p&gt;</comment>
                            <comment id="16278580" author="githubbot" created="Tue, 5 Dec 2017 13:50:48 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154874339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154874339&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -185,7 +189,7 @@ class LaunchCoordinator(&lt;br/&gt;
             // process the assignments into a set of operations (reserve and/or launch)&lt;br/&gt;
             val slaveId = assignments.getLeasesUsed.get(0).getOffer.getSlaveId&lt;br/&gt;
             val offerIds = assignments.getLeasesUsed.asScala.map(_.getOffer.getId)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val operations = processAssignments(slaveId, assignments, remaining.toMap)&lt;br/&gt;
    +        val operations = processAssignments(LOG, slaveId, assignments, remaining.toMap)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think we shouldn&apos;t use capital letters for `log`.&lt;/p&gt;</comment>
                            <comment id="16278806" author="githubbot" created="Tue, 5 Dec 2017 16:21:25 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154998531&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154998531&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -148,14 +149,17 @@ class LaunchCoordinator(&lt;/p&gt;

&lt;p&gt;         case Event(offers: ResourceOffers, data: GatherData) =&amp;gt;&lt;br/&gt;
           val leases = offers.offers().asScala.map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new VMLeaseObject(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +        new Offer(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If I recall correctly, The collection must be of a certain type.&lt;/p&gt;</comment>
                            <comment id="16278814" author="githubbot" created="Tue, 5 Dec 2017 16:23:24 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r154999162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r154999162&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -148,14 +149,17 @@ class LaunchCoordinator(&lt;/p&gt;

&lt;p&gt;         case Event(offers: ResourceOffers, data: GatherData) =&amp;gt;&lt;br/&gt;
           val leases = offers.offers().asScala.map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new VMLeaseObject(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +        new Offer(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
           if(LOG.isInfoEnabled) {&lt;br/&gt;
             val (cpus, mem) = leases.foldLeft((0.0,0.0)) 
{
               (z,o) =&amp;gt; (z._1 + o.cpuCores(), z._2 + o.memoryMB())
             }
&lt;p&gt;             LOG.info(s&quot;Received offer(s) of $mem MB, $cpus cpus:&quot;)&lt;br/&gt;
             for(l &amp;lt;- leases) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;LOG.info(s&quot;  ${l.getId} from ${l.hostname()} of ${l.memoryMB()} MB, ${l.cpuCores()} cpus&quot;)&lt;br/&gt;
    +          val reservations = l.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Offer&amp;#93;&lt;/span&gt;.getResources.asScala.map(_.getRole).toSet
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    (see above)&lt;/p&gt;</comment>
                            <comment id="16278817" author="githubbot" created="Tue, 5 Dec 2017 16:27:13 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r155000484&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r155000484&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/LaunchableMesosWorker.java &amp;#8212;&lt;br/&gt;
    @@ -217,15 +222,13 @@ public String toString() &lt;/p&gt;
{
     			dynamicProperties.setString(ConfigConstants.TASK_MANAGER_HOSTNAME_KEY, taskManagerHostname);
     		}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// use the assigned ports for the TM&lt;/li&gt;
	&lt;li&gt;if (assignment.getAssignedPorts().size() &amp;lt; TM_PORT_KEYS.length) 
{
    -			throw new IllegalArgumentException(&quot;unsufficient # of ports assigned&quot;);
    -		}&lt;/li&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; TM_PORT_KEYS.length; i++) {&lt;/li&gt;
	&lt;li&gt;int port = assignment.getAssignedPorts().get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;String key = TM_PORT_KEYS&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;/li&gt;
	&lt;li&gt;taskInfo.addResources(ranges(&quot;ports&quot;, mesosConfiguration.frameworkInfo().getRole(), range(port, port)));&lt;/li&gt;
	&lt;li&gt;dynamicProperties.setInteger(key, port);&lt;br/&gt;
    +		// take needed ports for the TM&lt;br/&gt;
    +		List&amp;lt;Protos.Resource&amp;gt; portResources = allocation.takeRanges(&quot;ports&quot;, TM_PORT_KEYS.length, roles);&lt;br/&gt;
    +		taskInfo.addAllResources(portResources);&lt;br/&gt;
    +		Iterator&amp;lt;String&amp;gt; portsToAssign = Iterators.forArray(TM_PORT_KEYS);&lt;br/&gt;
    +		rangeValues(portResources).forEach(port -&amp;gt; dynamicProperties.setLong(portsToAssign.next(), port));
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    A call to `takeRanges` won&apos;t give more than requested so it won&apos;t happen.&lt;/p&gt;</comment>
                            <comment id="16278956" author="githubbot" created="Tue, 5 Dec 2017 17:56:33 +0000"  >&lt;p&gt;Github user EronWright commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r155026726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r155026726&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -185,7 +189,7 @@ class LaunchCoordinator(&lt;br/&gt;
             // process the assignments into a set of operations (reserve and/or launch)&lt;br/&gt;
             val slaveId = assignments.getLeasesUsed.get(0).getOffer.getSlaveId&lt;br/&gt;
             val offerIds = assignments.getLeasesUsed.asScala.map(_.getOffer.getId)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val operations = processAssignments(slaveId, assignments, remaining.toMap)&lt;br/&gt;
    +        val operations = processAssignments(LOG, slaveId, assignments, remaining.toMap)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    The issue is that the class extends `Actor` which has a `log` field that we don&apos;t intend to use.  I will use `log` in `processAssignments`.&lt;/p&gt;</comment>
                            <comment id="16279100" author="githubbot" created="Tue, 5 Dec 2017 19:32:49 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann I believe your feedback has been addressed, please take a look thanks.&lt;/p&gt;</comment>
                            <comment id="16279970" author="githubbot" created="Wed, 6 Dec 2017 10:20:02 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r155195871&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r155195871&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/java/org/apache/flink/mesos/runtime/clusterframework/LaunchableMesosWorker.java &amp;#8212;&lt;br/&gt;
    @@ -217,15 +222,13 @@ public String toString() &lt;/p&gt;
{
     			dynamicProperties.setString(ConfigConstants.TASK_MANAGER_HOSTNAME_KEY, taskManagerHostname);
     		}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// use the assigned ports for the TM&lt;/li&gt;
	&lt;li&gt;if (assignment.getAssignedPorts().size() &amp;lt; TM_PORT_KEYS.length) 
{
    -			throw new IllegalArgumentException(&quot;unsufficient # of ports assigned&quot;);
    -		}&lt;/li&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; TM_PORT_KEYS.length; i++) {&lt;/li&gt;
	&lt;li&gt;int port = assignment.getAssignedPorts().get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;String key = TM_PORT_KEYS&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;/li&gt;
	&lt;li&gt;taskInfo.addResources(ranges(&quot;ports&quot;, mesosConfiguration.frameworkInfo().getRole(), range(port, port)));&lt;/li&gt;
	&lt;li&gt;dynamicProperties.setInteger(key, port);&lt;br/&gt;
    +		// take needed ports for the TM&lt;br/&gt;
    +		List&amp;lt;Protos.Resource&amp;gt; portResources = allocation.takeRanges(&quot;ports&quot;, TM_PORT_KEYS.length, roles);&lt;br/&gt;
    +		taskInfo.addAllResources(portResources);&lt;br/&gt;
    +		Iterator&amp;lt;String&amp;gt; portsToAssign = Iterators.forArray(TM_PORT_KEYS);&lt;br/&gt;
    +		rangeValues(portResources).forEach(port -&amp;gt; dynamicProperties.setLong(portsToAssign.next(), port));
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Alright, thanks for the clarification.&lt;/p&gt;</comment>
                            <comment id="16279996" author="githubbot" created="Wed, 6 Dec 2017 10:41:26 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r155200829&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r155200829&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -148,14 +149,17 @@ class LaunchCoordinator(&lt;/p&gt;

&lt;p&gt;         case Event(offers: ResourceOffers, data: GatherData) =&amp;gt;&lt;br/&gt;
           val leases = offers.offers().asScala.map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new VMLeaseObject(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +        new Offer(_).asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;VirtualMachineLease&amp;#93;&lt;/span&gt;)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    If I&apos;m not mistaken, then the Scala `Buffer` implements `GenTraversableOnce` which is co-variant in its generic type and thus, there is no need for downcasting. I&apos;ll try it out and if it&apos;s possible, then I&apos;ll apply the changes while merging.&lt;/p&gt;</comment>
                            <comment id="16280002" author="githubbot" created="Wed, 6 Dec 2017 10:44:52 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114#discussion_r155201727&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114#discussion_r155201727&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-mesos/src/main/scala/org/apache/flink/mesos/scheduler/LaunchCoordinator.scala &amp;#8212;&lt;br/&gt;
    @@ -185,7 +189,7 @@ class LaunchCoordinator(&lt;br/&gt;
             // process the assignments into a set of operations (reserve and/or launch)&lt;br/&gt;
             val slaveId = assignments.getLeasesUsed.get(0).getOffer.getSlaveId&lt;br/&gt;
             val offerIds = assignments.getLeasesUsed.asScala.map(_.getOffer.getId)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val operations = processAssignments(slaveId, assignments, remaining.toMap)&lt;br/&gt;
    +        val operations = processAssignments(LOG, slaveId, assignments, remaining.toMap)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    alright.&lt;/p&gt;</comment>
                            <comment id="16280004" author="githubbot" created="Wed, 6 Dec 2017 10:45:13 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for addressing this issue so quick @EronWright. Travis passed. Merging this PR.&lt;/p&gt;</comment>
                            <comment id="16280016" author="till.rohrmann" created="Wed, 6 Dec 2017 10:56:24 +0000"  >&lt;p&gt;1.5.0 d6f5ea30ece3495894b0e6d2847b810040b37658&lt;br/&gt;
1.4.0 4bc4f326580bbea290630999273d9d90711b44c3&lt;/p&gt;</comment>
                            <comment id="16280017" author="githubbot" created="Wed, 6 Dec 2017 10:56:36 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16280547" author="githubbot" created="Wed, 6 Dec 2017 17:29:11 +0000"  >&lt;p&gt;Github user EronWright commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @tillrohrmann should we patch the 1.3 release too?   Or is 1.3.2 the last release there?&lt;/p&gt;</comment>
                            <comment id="16281752" author="githubbot" created="Thu, 7 Dec 2017 11:55:13 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It depends a little bit on 1.4. We have serious build stability issues in the `release-1.3` branch and it would take a serious effort to stabilize it again. If I could choose, then we wouldn&apos;t have to release 1.3.3 because users switch directly to 1.4.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ndb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>