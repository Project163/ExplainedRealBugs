<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6567] ExecutionGraphMetricsTest fails on Windows CI</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6567</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The &lt;tt&gt;testExecutionGraphRestartTimeMetric&lt;/tt&gt; fails every time i run it on AppVeyor. It also very rarely failed for me locally.&lt;/p&gt;

&lt;p&gt;The test fails at Line 235 if the RUNNING timestamp is equal to the RESTARTING timestamp, which may happen when combining a fast test with a low resolution clock.&lt;/p&gt;

&lt;p&gt;A simple fix would be to increase the timestamp between RUNNING and RESTARTING by adding a 50ms sleep timeout into the &lt;tt&gt;TestingRestartStrategy#canRestart()&lt;/tt&gt; method, as this one is called before transitioning to the RESTARTING state.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13071525">FLINK-6567</key>
            <summary>ExecutionGraphMetricsTest fails on Windows CI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Fri, 12 May 2017 12:43:12 +0000</created>
                <updated>Tue, 3 Apr 2018 14:37:14 +0000</updated>
                            <resolved>Tue, 3 Apr 2018 14:37:14 +0000</resolved>
                                    <version>1.3.0</version>
                    <version>1.4.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16417332" author="githubbot" created="Wed, 28 Mar 2018 13:37:45 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6567&quot; title=&quot;ExecutionGraphMetricsTest fails on Windows CI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6567&quot;&gt;&lt;del&gt;FLINK-6567&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Harden ExecutionGraphMetricsTest&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    The problem was that in some cases the currentRestartingTime would not increase&lt;br/&gt;
    because the iteration in the loop were too fast.&lt;/p&gt;

&lt;p&gt;    cc @zentol &lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; hardenExecutionGraphMetricsTest&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5782&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 91b5db420f7e9079e9da364529fe125f157b9533&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@...&amp;gt;&lt;br/&gt;
Date:   2018-03-28T13:35:11Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6567&quot; title=&quot;ExecutionGraphMetricsTest fails on Windows CI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6567&quot;&gt;&lt;del&gt;FLINK-6567&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;tests&amp;#93;&lt;/span&gt; Harden ExecutionGraphMetricsTest&lt;/p&gt;

&lt;p&gt;    The problem was that in some cases the currentRestartingTime would not increase&lt;br/&gt;
    because the iteration in the loop were too fast.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16417652" author="githubbot" created="Wed, 28 Mar 2018 16:09:23 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782#discussion_r177804309&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782#discussion_r177804309&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphMetricsTest.java &amp;#8212;&lt;br/&gt;
    @@ -193,6 +197,8 @@ public void testExecutionGraphRestartTimeMetric() throws JobException, IOExcepti&lt;/p&gt;

&lt;p&gt;     				assertTrue(currentRestartingTime &amp;gt;= previousRestartingTime);&lt;br/&gt;
     				previousRestartingTime = currentRestartingTime;&lt;br/&gt;
    +				// add some pause to the let currentRestartingTime increase&lt;br/&gt;
    +				Thread.sleep(1L);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    same as above&lt;/p&gt;</comment>
                            <comment id="16417653" author="githubbot" created="Wed, 28 Mar 2018 16:09:23 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782#discussion_r177803798&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782#discussion_r177803798&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphMetricsTest.java &amp;#8212;&lt;br/&gt;
    @@ -140,6 +140,9 @@ public void testExecutionGraphRestartTimeMetric() throws JobException, IOExcepti&lt;/p&gt;

&lt;p&gt;     				assertTrue(currentRestartingTime &amp;gt;= previousRestartingTime);&lt;br/&gt;
     				previousRestartingTime = currentRestartingTime;&lt;br/&gt;
    +&lt;br/&gt;
    +				// add some pause to let the currentRestartingTime increase&lt;br/&gt;
    +				Thread.sleep(1L);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    move this to the start of the loop instead? (since you call `restartingTime.getValue()` right before the loop and at the start of the loop)&lt;/p&gt;</comment>
                            <comment id="16418717" author="githubbot" created="Thu, 29 Mar 2018 10:35:27 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782#discussion_r178017114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782#discussion_r178017114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphMetricsTest.java &amp;#8212;&lt;br/&gt;
    @@ -140,6 +140,9 @@ public void testExecutionGraphRestartTimeMetric() throws JobException, IOExcepti&lt;/p&gt;

&lt;p&gt;     				assertTrue(currentRestartingTime &amp;gt;= previousRestartingTime);&lt;br/&gt;
     				previousRestartingTime = currentRestartingTime;&lt;br/&gt;
    +&lt;br/&gt;
    +				// add some pause to let the currentRestartingTime increase&lt;br/&gt;
    +				Thread.sleep(1L);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think we have to keep it here, because otherwise the loop might finish so fast that we don&apos;t see an increase in `previousRestartingTime` because this value is effectively `System.currentTimeMillis - timestamps&lt;span class=&quot;error&quot;&gt;&amp;#91;RESTARTING&amp;#93;&lt;/span&gt;`.&lt;/p&gt;</comment>
                            <comment id="16418720" author="githubbot" created="Thu, 29 Mar 2018 10:36:01 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @zentol. Let me know once you&apos;ve run the test on your machine so that I can merge this PR.&lt;/p&gt;</comment>
                            <comment id="16418724" author="githubbot" created="Thu, 29 Mar 2018 10:36:36 +0000"  >&lt;p&gt;Github user tillrohrmann commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782#discussion_r178017403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782#discussion_r178017403&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphMetricsTest.java &amp;#8212;&lt;br/&gt;
    @@ -140,6 +140,9 @@ public void testExecutionGraphRestartTimeMetric() throws JobException, IOExcepti&lt;/p&gt;

&lt;p&gt;     				assertTrue(currentRestartingTime &amp;gt;= previousRestartingTime);&lt;br/&gt;
     				previousRestartingTime = currentRestartingTime;&lt;br/&gt;
    +&lt;br/&gt;
    +				// add some pause to let the currentRestartingTime increase&lt;br/&gt;
    +				Thread.sleep(1L);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes can do.&lt;/p&gt;</comment>
                            <comment id="16423758" author="githubbot" created="Tue, 3 Apr 2018 09:44:07 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;ve run the test 10k+ times on my machine without a failure, +1 from my side.&lt;/p&gt;</comment>
                            <comment id="16423962" author="githubbot" created="Tue, 3 Apr 2018 12:42:34 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @zentol. Merging this PR.&lt;/p&gt;</comment>
                            <comment id="16424105" author="githubbot" created="Tue, 3 Apr 2018 14:36:47 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5782&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16424107" author="till.rohrmann" created="Tue, 3 Apr 2018 14:37:14 +0000"  >&lt;p&gt;Fixed via&lt;br/&gt;
master: db366cd3d02a823f93185f29ca7ae93da9e2a04b&lt;br/&gt;
1.5.0: 515069e14f770ebfb86df27dc27b858ded51c6d5&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ewav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>