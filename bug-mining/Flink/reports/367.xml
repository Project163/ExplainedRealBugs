<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:19:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-1959] Accumulators BROKEN after Partitioning</title>
                <link>https://issues.apache.org/jira/browse/FLINK-1959</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;while running the Accumulator example in &lt;a href=&quot;https://github.com/Elbehery/flink/blob/master/flink-examples/flink-java-examples/src/main/java/org/apache/flink/examples/java/relational/EmptyFieldsCountAccumulator.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Elbehery/flink/blob/master/flink-examples/flink-java-examples/src/main/java/org/apache/flink/examples/java/relational/EmptyFieldsCountAccumulator.java&lt;/a&gt;, &lt;/p&gt;

&lt;p&gt;I tried to alter the data flow with &quot;PartitionByHash&quot; function before applying &quot;Filter&quot;, and the resulted accumulator was NULL. &lt;/p&gt;

&lt;p&gt;By Debugging, I could see the accumulator in the RunTime Map. However, by retrieving the accumulator from the JobExecutionResult object, it was NULL. &lt;/p&gt;


&lt;p&gt;The line caused the problem is &quot;file.partitionByHash(1).filter(new EmptyFieldFilter())&quot; instead of &quot;file.filter(new EmptyFieldFilter())&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12825953">FLINK-1959</key>
            <summary>Accumulators BROKEN after Partitioning</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10001">Pending Closed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="elbehery">mustafa elbehery</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Apr 2015 13:50:04 +0000</created>
                <updated>Wed, 2 Oct 2019 17:45:23 +0000</updated>
                            <resolved>Tue, 12 May 2015 23:16:56 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>Examples</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14519494" author="elbehery" created="Wed, 29 Apr 2015 14:54:38 +0000"  >&lt;p&gt;BTW, the version of Flink is 0.9 but it was not in the drop-down list.&lt;/p&gt;</comment>
                            <comment id="14519542" author="stephanewen" created="Wed, 29 Apr 2015 15:21:25 +0000"  >&lt;p&gt;Can you try if this only happens with a parallelism greater than one, or also with parallelism one?&lt;/p&gt;</comment>
                            <comment id="14521195" author="elbehery" created="Thu, 30 Apr 2015 09:13:44 +0000"  >&lt;p&gt;I just tried with DOP 1,2 and 5 .. All return NULL &lt;/p&gt;

&lt;p&gt;&quot;Number of detected empty fields per column: null&quot;&lt;/p&gt;</comment>
                            <comment id="14537312" author="elbehery" created="Sun, 10 May 2015 18:54:24 +0000"  >&lt;p&gt;Any updates for this bug ?!!    This is kind of critical to me &lt;/p&gt;</comment>
                            <comment id="14537845" author="aalexandrov" created="Mon, 11 May 2015 11:42:37 +0000"  >&lt;p&gt;I think that some communication / traversal chain gets broken in the ParitionByHash node.&lt;/p&gt;

&lt;p&gt;You can either &lt;/p&gt;

&lt;p&gt;(1) try to dig through the code and see where this happens, or&lt;br/&gt;
(2) use an alternative to the accumulator until the issue is resolved (e.g. write the information to a pre-defined HDFS path); &lt;/p&gt;</comment>
                            <comment id="14538540" author="stephanewen" created="Mon, 11 May 2015 19:54:27 +0000"  >&lt;p&gt;I will try and look into this very soon...&lt;/p&gt;</comment>
                            <comment id="14539987" author="elbehery" created="Tue, 12 May 2015 15:09:10 +0000"  >&lt;p&gt;I have tried debugging to check the problem .. What I can see is that re-partitioning is working find and the data is re-distributed as expected. Moreover, the accumulators from each sub-task if created and filled with the required information. However, the merge method is never called in case of Re-Partitioning !!! &lt;/p&gt;

&lt;p&gt;I could see in debug mode that the accumulator in RunTime is empty.&lt;/p&gt;

&lt;p&gt;Any suggestion to solve the problem ?!!&lt;/p&gt;</comment>
                            <comment id="14540146" author="aalexandrov" created="Tue, 12 May 2015 16:22:01 +0000"  >&lt;p&gt;After some more debugging with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elbehery&quot; class=&quot;user-hover&quot; rel=&quot;elbehery&quot;&gt;elbehery&lt;/a&gt; we managed to identify the issue.&lt;/p&gt;

&lt;p&gt;Adding &lt;tt&gt;partitionByHash&lt;/tt&gt; into the pipeline breaks the local chain two and creates two tasks. The second task (the receiver of the partition) starts with a RegularPactTask which runs a NoOpDriver and does not have a UDF stub. Because of that, the test at &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/operators/RegularPactTask.java#L511&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;line 511&lt;/a&gt; and the accumulators are never called. &lt;/p&gt;

&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt;: Unless you see a problem with that solution, I suggest to remove the &lt;tt&gt;stub != null&lt;/tt&gt; check at &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/operators/RegularPactTask.java#L511&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;line 511&lt;/a&gt; and report accumulators always.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Alexander&lt;/p&gt;</comment>
                            <comment id="14540610" author="stephanewen" created="Tue, 12 May 2015 20:02:14 +0000"  >&lt;p&gt;Great debugging, this is perfect!&lt;/p&gt;

&lt;p&gt;I will prepare a fix based on that...&lt;/p&gt;</comment>
                            <comment id="14540982" author="stephanewen" created="Tue, 12 May 2015 23:16:56 +0000"  >&lt;p&gt;Fixed in 73493335f4dbecbb4f1f9f954b08534a5e35ca90.&lt;/p&gt;

&lt;p&gt;Thank you for the debugging help!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e2xz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>