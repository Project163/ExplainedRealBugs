<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:36:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-10642] CodeGen split fields errors when maxGeneratedCodeLength equals 1</title>
                <link>https://issues.apache.org/jira/browse/FLINK-10642</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Several tests error in special config when setting maxGeneratedCodeLength 1. e.g.&lt;br/&gt;
  CalcITCase.testFilterOnCustomType:260 ? InvalidProgram Table program cannot be...&lt;br/&gt;
  JavaTableEnvironmentITCase.testAsFromAndToPojo:394 ? InvalidProgram Table prog...&lt;br/&gt;
  JavaTableEnvironmentITCase.testAsFromAndToPrivateFieldPojo:421 ? InvalidProgram&lt;br/&gt;
  JavaTableEnvironmentITCase.testAsFromPojo:288 ? InvalidProgram Table program c...&lt;br/&gt;
  JavaTableEnvironmentITCase.testAsFromPrivateFieldsPojo:366 ? InvalidProgram Ta...&lt;br/&gt;
  JavaTableEnvironmentITCase.testAsWithPojoAndGenericTypes:453 ? InvalidProgram ...&lt;br/&gt;
  TimeAttributesITCase.testPojoSupport:566 ? JobExecution Job execution failed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13193297">FLINK-10642</key>
            <summary>CodeGen split fields errors when maxGeneratedCodeLength equals 1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xueyu">xueyu</assignee>
                                    <reporter username="xueyu">xueyu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 22 Oct 2018 16:39:04 +0000</created>
                <updated>Fri, 16 Nov 2018 14:29:26 +0000</updated>
                            <resolved>Fri, 16 Nov 2018 14:29:26 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.5.6</fixVersion>
                    <fixVersion>1.6.3</fixVersion>
                    <fixVersion>1.7.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16659561" author="githubbot" created="Mon, 22 Oct 2018 19:40:32 +0000"  >&lt;p&gt;xueyumusic opened a new pull request #6900: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10642&quot; title=&quot;CodeGen split fields errors when maxGeneratedCodeLength equals 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10642&quot;&gt;&lt;del&gt;FLINK-10642&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; fix CodeGen split fields errors in special config&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6900&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6900&lt;/a&gt;&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;br/&gt;
   This PR tries to fix several tests errors when setting maxGeneratedCodeLength  1 to force split fields. e.g.&lt;br/&gt;
   `&lt;br/&gt;
     CalcITCase.testFilterOnCustomType:260 ? InvalidProgram Table program cannot be...&lt;br/&gt;
     JavaTableEnvironmentITCase.testAsFromAndToPojo:394 ? InvalidProgram Table prog...&lt;br/&gt;
     JavaTableEnvironmentITCase.testAsFromAndToPrivateFieldPojo:421 ? InvalidProgram&lt;br/&gt;
     JavaTableEnvironmentITCase.testAsFromPojo:288 ? InvalidProgram Table program c...&lt;br/&gt;
     JavaTableEnvironmentITCase.testAsFromPrivateFieldsPojo:366 ? InvalidProgram Ta...&lt;br/&gt;
     JavaTableEnvironmentITCase.testAsWithPojoAndGenericTypes:453 ? InvalidProgram ...&lt;br/&gt;
     TimeAttributesITCase.testPojoSupport:566 ? JobExecution Job execution failed.&lt;br/&gt;
   `&lt;/li&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;CodeGenerator&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;br/&gt;
   This change is already covered by existing tests&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not documented)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16660004" author="githubbot" created="Tue, 23 Oct 2018 03:13:29 +0000"  >&lt;p&gt;hequn8128 commented on issue #6900: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10642&quot; title=&quot;CodeGen split fields errors when maxGeneratedCodeLength equals 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10642&quot;&gt;&lt;del&gt;FLINK-10642&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; fix CodeGen split fields errors in special config&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6900#issuecomment-432073424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6900#issuecomment-432073424&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @xueyumusic  &lt;br/&gt;
   Thanks for fixing the bug. The bug is caused by `private boolean false;` which is generated from the `reusableMemberStatements`. Looks good about the fix. I think it would be better to add a test to cover this case. &lt;/p&gt;

&lt;p&gt;   LGTM, I think we should ask for advice from @twalthr  before merge this change.&lt;br/&gt;
   Best, Hequn&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16689453" author="githubbot" created="Fri, 16 Nov 2018 14:11:21 +0000"  >&lt;p&gt;asfgit closed pull request #6900: &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-10642&quot; title=&quot;CodeGen split fields errors when maxGeneratedCodeLength equals 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-10642&quot;&gt;&lt;del&gt;FLINK-10642&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; fix CodeGen split fields errors in special config&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/flink/pull/6900&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6900&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
index 19e030b4c0a..8f9913bdfaa 100644&lt;br/&gt;
&amp;#8212; a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/codegen/CodeGenerator.scala&lt;br/&gt;
@@ -1057,13 +1057,13 @@ abstract class CodeGenerator(&lt;/p&gt;

&lt;p&gt;         // declaration&lt;br/&gt;
         val resultTypeTerm = primitiveTypeTermForTypeInfo(expr.resultType)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (nullCheck) {&lt;br/&gt;
+        if (nullCheck &amp;amp;&amp;amp; !expr.nullTerm.equals(NEVER_NULL) &amp;amp;&amp;amp; !expr.nullTerm.equals(ALWAYS_NULL)) {&lt;br/&gt;
           reusableMemberStatements.add(s&quot;private boolean ${expr.nullTerm};&quot;)&lt;br/&gt;
         }&lt;br/&gt;
         reusableMemberStatements.add(s&quot;private $resultTypeTerm ${expr.resultTerm};&quot;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         // assignment&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (nullCheck) {&lt;br/&gt;
+        if (nullCheck &amp;amp;&amp;amp; !expr.nullTerm.equals(NEVER_NULL) &amp;amp;&amp;amp; !expr.nullTerm.equals(ALWAYS_NULL)) {&lt;br/&gt;
           reusablePerRecordStatements.add(s&quot;this.${expr.nullTerm} = ${expr.nullTerm};&quot;)&lt;br/&gt;
         }&lt;br/&gt;
         reusablePerRecordStatements.add(s&quot;this.${expr.resultTerm} = ${expr.resultTerm};&quot;)&lt;br/&gt;
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
index b161eeda43c..4e880eeaf3b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/batch/table/CalcITCase.scala&lt;br/&gt;
@@ -578,6 +578,22 @@ class CalcITCase(&lt;br/&gt;
     val expected = List(&quot;a,a,d,d,e,e&quot;, &quot;x,x,z,z,z,z&quot;).mkString(&quot;\n&quot;)&lt;br/&gt;
     TestBaseUtils.compareResultAsText(results.asJava, expected)&lt;br/&gt;
   }&lt;br/&gt;
+&lt;br/&gt;
+  @Test&lt;br/&gt;
+  def testSplitFeildsOnCustomType(): Unit = 
{
+    val env = ExecutionEnvironment.getExecutionEnvironment
+    val tEnv = TableEnvironment.getTableEnvironment(env, config)
+    tEnv.getConfig.setMaxGeneratedCodeLength(1)  // splits fields
+
+    val ds = CollectionDataSets.getCustomTypeDataSet(env)
+    val filterDs = ds.toTable(tEnv, &apos;myInt as &apos;i, &apos;myLong as &apos;l, &apos;myString as &apos;s)
+      .filter( &apos;s.like(&quot;%a%&quot;) &amp;amp;&amp;amp; &apos;s.charLength &amp;gt; 12)
+      .select(&apos;i, &apos;l, &apos;s.charLength)
+
+    val expected = &quot;3,3,25\n&quot; + &quot;3,5,14\n&quot;
+    val results = filterDs.toDataSet[Row].collect()
+    TestBaseUtils.compareResultAsText(results.asJava, expected)
+  }
&lt;p&gt; }&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; object CalcITCase {&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16689480" author="twalthr" created="Fri, 16 Nov 2018 14:29:26 +0000"  >&lt;p&gt;Fixed in master: a7ae4253e4463ff6242f69d8fdb1c4a76af0f14c&lt;br/&gt;
Fixed in 1.7.0: 146f4340ed02cd2337c42b1480fd9c8b070997ad&lt;br/&gt;
Fixed in 1.6.3: e8fc37e8aab27b5ee468f444d4c9f13927552166&lt;br/&gt;
FIxed in 1.5.6: 1d8bc86d152cde2941750c99f6cfd2507c96afdb&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3zhnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>