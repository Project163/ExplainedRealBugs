<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4297] Yarn client can&apos;t determine fat jar location if path contains spaces</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4297</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The code that automatically determines the fat jar path through the ProtectionDomain of the Yarn class, receives a possibly URL encoded path string. We need to decode using the system locale encoding, otherwise we can receive errors of the following when spaces are in the file path: &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.io.FileNotFoundException: File file:/Users/max/Downloads/release-testing/flink-1.1.0-rc1/flink-1.1.0/build%20target/lib/flink-dist_2.11-1.1.0.jar does not exist
        at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:511)
        at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:724)
        at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:501)
        at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:397)
        at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:337)
        at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:289)
        at org.apache.hadoop.fs.LocalFileSystem.copyFromLocalFile(LocalFileSystem.java:82)
        at org.apache.hadoop.fs.FileSystem.copyFromLocalFile(FileSystem.java:1836)
        at org.apache.flink.yarn.Utils.setupLocalResource(Utils.java:129)
        at org.apache.flink.yarn.AbstractYarnClusterDescriptor.deployInternal(AbstractYarnClusterDescriptor.java:616)
        at org.apache.flink.yarn.AbstractYarnClusterDescriptor.deploy(AbstractYarnClusterDescriptor.java:365)
        ... 6 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12993961">FLINK-4297</key>
            <summary>Yarn client can&apos;t determine fat jar location if path contains spaces</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="mxm">Maximilian Michels</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Aug 2016 13:36:08 +0000</created>
                <updated>Mon, 19 Dec 2016 12:46:53 +0000</updated>
                            <resolved>Fri, 5 Aug 2016 18:04:25 +0000</resolved>
                                                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>Deployment / YARN</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15402040" author="githubbot" created="Mon, 1 Aug 2016 13:39:40 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4297&quot; title=&quot;Yarn client can&amp;#39;t determine fat jar location if path contains spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4297&quot;&gt;&lt;del&gt;FLINK-4297&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;yarn&amp;#93;&lt;/span&gt; decode URL encoded fat jar path&lt;/p&gt;

&lt;p&gt;    This solves problems with spaces and special characters in the&lt;br/&gt;
    automatically determined fat jar path which is returned URL encoded.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4297&quot; title=&quot;Yarn client can&amp;#39;t determine fat jar location if path contains spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4297&quot;&gt;&lt;del&gt;FLINK-4297&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2320&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 76dc43ac69e374482894fa15d67f001fc5030be0&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-08-01T13:19:15Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4297&quot; title=&quot;Yarn client can&amp;#39;t determine fat jar location if path contains spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4297&quot;&gt;&lt;del&gt;FLINK-4297&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;yarn&amp;#93;&lt;/span&gt; decode URL encoded fat jar path&lt;/p&gt;

&lt;p&gt;    This solves problems with spaces and special characters in the&lt;br/&gt;
    automatically determined fat jar path which is returned URL encoded.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15402373" author="githubbot" created="Mon, 1 Aug 2016 16:37:59 +0000"  >&lt;p&gt;Github user uce commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Tested this with Hadoop 2.4.1 and it works as expected with `bin/flink run -m yarn-cluster`:&lt;br/&gt;
    ```&lt;br/&gt;
    2016-08-01 16:32:06,214 INFO  org.apache.flink.yarn.Utils - Copying from 2016-08-01 16:32:06,214 INFO  org.apache.flink.yarn.Utils - Copying from &lt;a href=&quot;file:/home/hadoop/mxm/flink/flink-dist/target/flink-1.1-SNAPSHOT-bin/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/hadoop/mxm/flink/flink-dist/target/flink-1.1-SNAPSHOT-bin/flink&lt;/a&gt; with spaces/conf/log4j.properties to gs://.../user/hadoop/.flink/application_1470041666362_0007/log4j.properties&lt;br/&gt;
    ...&lt;br/&gt;
    08/01/2016 16:33:24	Job execution switched to status FINISHED.&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    But YARN sessions don&apos;t work. I get:&lt;br/&gt;
    ```&lt;br/&gt;
    $ bin/yarn-session.sh&lt;br/&gt;
    Error: Could not find or load main class with&lt;br/&gt;
    ```&lt;/p&gt;
</comment>
                            <comment id="15402402" author="githubbot" created="Mon, 1 Aug 2016 16:57:01 +0000"  >&lt;p&gt;Github user mxm commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for trying it out @uce! There was an unrelated quoting issue in `yarn-session.sh`. I pushed another fix.&lt;/p&gt;</comment>
                            <comment id="15402439" author="githubbot" created="Mon, 1 Aug 2016 17:12:38 +0000"  >&lt;p&gt;Github user uce commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It didn&apos;t fix it unfortunately.&lt;/p&gt;</comment>
                            <comment id="15403590" author="githubbot" created="Tue, 2 Aug 2016 08:17:47 +0000"  >&lt;p&gt;Github user mxm commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Should be good to go now.&lt;/p&gt;</comment>
                            <comment id="15405886" author="githubbot" created="Wed, 3 Aug 2016 13:02:48 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320#discussion_r73333859&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320#discussion_r73333859&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-yarn/src/main/java/org/apache/flink/yarn/cli/FlinkYarnSessionCli.java &amp;#8212;&lt;br/&gt;
    @@ -260,8 +263,15 @@ public AbstractYarnClusterDescriptor createDescriptor(String defaultApplicationN&lt;br/&gt;
     		} else {&lt;br/&gt;
     			LOG.info(&quot;No path for the flink jar passed. Using the location of &quot;&lt;br/&gt;
     				+ yarnClusterDescriptor.getClass() + &quot; to locate the jar&quot;);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;localJarPath = new Path(&quot;file://&quot; +&lt;/li&gt;
	&lt;li&gt;yarnClusterDescriptor.getClass().getProtectionDomain().getCodeSource().getLocation().getPath());&lt;br/&gt;
    +			String encodedJarPath =&lt;br/&gt;
    +				yarnClusterDescriptor.getClass().getProtectionDomain().getCodeSource().getLocation().getPath();&lt;br/&gt;
    +			try {&lt;br/&gt;
    +				// we have to decode the url encoded parts of the path&lt;br/&gt;
    +				localJarPath = new Path(&quot;file://&quot; + URLDecoder.decode(encodedJarPath, Charset.defaultCharset().name()));
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think manually coding the `&lt;a href=&quot;file://&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file://&lt;/a&gt; + path` URIs have cross-platform issues.&lt;/p&gt;

&lt;p&gt;    For File URIs, I found it to be best to go with &lt;br/&gt;
    ```java&lt;br/&gt;
    new File(string).toURI()&lt;br/&gt;
    ```&lt;br/&gt;
    or in that specific case:&lt;br/&gt;
    ```java&lt;br/&gt;
    localJarPath = new Path(new File(URLDecoder.decode(encodedJarPath, Charset.defaultCharset().name())).toURI());&lt;br/&gt;
    or&lt;br/&gt;
    localJarPath = new Path(new URI(&quot;file&quot;, null, URLDecoder.decode(encodedJarPath, Charset.defaultCharset().name()), null));&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="15405888" author="githubbot" created="Wed, 3 Aug 2016 13:03:45 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    One comment inline, otherwise looks good.&lt;/p&gt;</comment>
                            <comment id="15409466" author="githubbot" created="Fri, 5 Aug 2016 13:47:24 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Will address the comment and merge this...&lt;/p&gt;</comment>
                            <comment id="15409807" author="githubbot" created="Fri, 5 Aug 2016 17:58:36 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2320&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2320&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15409819" author="stephanewen" created="Fri, 5 Aug 2016 18:04:25 +0000"  >&lt;p&gt;Fixed for&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.2.0 via c7a85545ba73e93e4a55ef8886362badaa2e2147&lt;/li&gt;
	&lt;li&gt;1.1.1 via e4f62d3b38ccb93e45c50ee97dae9157a0493e47&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31qxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>