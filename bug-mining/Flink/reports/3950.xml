<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:45:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-16823] The functioin TIMESTAMPDIFF doesn&apos;t perform expected result</title>
                <link>https://issues.apache.org/jira/browse/FLINK-16823</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;For example,&lt;/p&gt;

&lt;p&gt;In mysql bellow sql get result 6, but in flink the output is 5&lt;/p&gt;

&lt;p&gt;SELECT timestampdiff (MONTH, TIMESTAMP &apos;2019-09-01 00:00:00&apos;,TIMESTAMP &apos;2020-03-01 00:00:00&apos; )&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12997957/12997957_image-2020-03-27-13-50-51-955.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13294360">FLINK-16823</key>
            <summary>The functioin TIMESTAMPDIFF doesn&apos;t perform expected result</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="docete">Zhenghua Gao</assignee>
                                    <reporter username="adam_deng">Adam N D DENG</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 27 Mar 2020 05:56:04 +0000</created>
                <updated>Sat, 18 Apr 2020 13:03:49 +0000</updated>
                            <resolved>Sat, 18 Apr 2020 13:03:49 +0000</resolved>
                                    <version>1.9.1</version>
                    <version>1.10.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17068358" author="ykt836" created="Fri, 27 Mar 2020 07:07:02 +0000"  >&lt;p&gt;Yes, this is a bug. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=docete&quot; class=&quot;user-hover&quot; rel=&quot;docete&quot;&gt;docete&lt;/a&gt;&#160;could you take a look at this?&lt;/p&gt;</comment>
                            <comment id="17068396" author="docete" created="Fri, 27 Mar 2020 08:02:07 +0000"  >&lt;p&gt;OK, i will take a look at it.&lt;/p&gt;</comment>
                            <comment id="17068426" author="docete" created="Fri, 27 Mar 2020 08:46:33 +0000"  >&lt;p&gt;Flink use Calcite&apos;s SqlFunctions#subtractMonths to find the number of month between two dates/timestamps.&lt;/p&gt;

&lt;p&gt;There may be a bug in the algorithm of&#160;SqlFunctions#subtractMonths.&#160;&lt;/p&gt;

&lt;p&gt;Will&#160;dig deeper to find the root cause and fix.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17068610" author="docete" created="Fri, 27 Mar 2020 12:10:49 +0000"  >&lt;p&gt;The root cause is &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-3881&quot; title=&quot;SqlFunctions#addMonths yields incorrect results in some corner case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-3881&quot;&gt;&lt;del&gt;CALCITE-3881&lt;/del&gt;&lt;/a&gt;, will fix on calcite side.&lt;/p&gt;</comment>
                            <comment id="17068618" author="docete" created="Fri, 27 Mar 2020 12:23:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=danny0405&quot; class=&quot;user-hover&quot; rel=&quot;danny0405&quot;&gt;danny0405&lt;/a&gt; What the plan of the upgrading of Calcite? Should we also upgrade calcite-avatica?&lt;/p&gt;</comment>
                            <comment id="17071511" author="docete" created="Tue, 31 Mar 2020 07:18:25 +0000"  >&lt;p&gt;After talk with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=danny0405&quot; class=&quot;user-hover&quot; rel=&quot;danny0405&quot;&gt;danny0405&lt;/a&gt;, we decide to introduce addMonths/subtractMonths as a temporary solution on Flink side to fix this corner case before &lt;a href=&quot;https://issues.apache.org/jira/browse/CALCITE-3881&quot; title=&quot;SqlFunctions#addMonths yields incorrect results in some corner case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CALCITE-3881&quot;&gt;&lt;del&gt;CALCITE-3881&lt;/del&gt;&lt;/a&gt; is fixed.&lt;/p&gt;</comment>
                            <comment id="17086447" author="ykt836" created="Sat, 18 Apr 2020 13:03:49 +0000"  >&lt;p&gt;master:&#160;591527798bf0d7f2a3884934b6260af9b84f3bf2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13294447">CALCITE-3881</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12997957" name="image-2020-03-27-13-50-51-955.png" size="10085" author="adam_deng" created="Fri, 27 Mar 2020 05:50:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 30 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0cys8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>