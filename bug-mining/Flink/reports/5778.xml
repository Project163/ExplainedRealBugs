<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:00:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-23875]  ReducingUpsertSink can loose records during failover</title>
                <link>https://issues.apache.org/jira/browse/FLINK-23875</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When trying to rework the Table API Kafka connector to make it compatible with the new KafkaSink I noticed that currently the buffer which is used to reduce the update-before and update-after calls is not snapshotted which can result in data loss if the job fails while the buffer is not empty.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Before 1.14 the equivalent class was called BufferedUpsertSinkFunction&lt;/p&gt;</description>
                <environment></environment>
        <key id="13396102">FLINK-23875</key>
            <summary> ReducingUpsertSink can loose records during failover</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fpaul">Fabian Paul</assignee>
                                    <reporter username="fpaul">Fabian Paul</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 19 Aug 2021 11:48:36 +0000</created>
                <updated>Wed, 17 Nov 2021 15:21:36 +0000</updated>
                            <resolved>Tue, 31 Aug 2021 11:29:48 +0000</resolved>
                                    <version>1.14.0</version>
                                    <fixVersion>1.14.0</fixVersion>
                                    <component>Connectors / Kafka</component>
                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17407259" author="arvid" created="Tue, 31 Aug 2021 11:26:11 +0000"  >&lt;p&gt;Merged into master as 31e5fa196de6d695e062d942e9d952e300439840.&lt;/p&gt;</comment>
                            <comment id="17407260" author="fabian.paul" created="Tue, 31 Aug 2021 11:29:15 +0000"  >&lt;p&gt;I created a separate ticket to fix it for Flink 1.13&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-24079&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-24079&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17407268" author="jark" created="Tue, 31 Aug 2021 11:44:24 +0000"  >&lt;p&gt;Sorry &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpaul&quot; class=&quot;user-hover&quot; rel=&quot;fpaul&quot;&gt;fpaul&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpaul&quot; class=&quot;user-hover&quot; rel=&quot;fpaul&quot;&gt;fpaul&lt;/a&gt;, but I don&apos;t understand why we need to snapshot the buffer. In the original design, the buffer is not needed to be snapshotted, because we will flush buffer before checkpoint current operator. If the flushing fails, the current checkpoint is failed as well. If the checkpoint is successful, the buffer is already written to external system successfully, and no need to snapshot the buffer. &lt;/p&gt;

&lt;p&gt;The buffer can be very large and impact the checkpoint. It&apos;s also very complex to re-distribute the buffer data (may result in out-of-order updating) when sink parallelism rescales.&lt;/p&gt;</comment>
                            <comment id="17407277" author="fabian.paul" created="Tue, 31 Aug 2021 11:57:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; Thanks for your fast reply you are right we missed that the buffer is cleared on every flush. We&apos;ll revert this commit and I close the backport ticket.&lt;/p&gt;</comment>
                            <comment id="17407376" author="arvid" created="Tue, 31 Aug 2021 14:10:53 +0000"  >&lt;p&gt;Reverted in e45c72d1bc6f8c81ba8bb3659fd1cd58e56652d9. Thanks Jark for pointing it out. The commit was a no-op because of the flush (no data has been savepointed because of the flush).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0u1y8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>