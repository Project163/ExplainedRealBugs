<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5672] Job fails with java.lang.IllegalArgumentException: port out of range:-1</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5672</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I started the JobManager with &lt;tt&gt;start-local.sh&lt;/tt&gt; and started another TaskManager with &lt;tt&gt;taskmanager.sh start&lt;/tt&gt;. My job is a Table API job with a &lt;tt&gt;orderBy&lt;/tt&gt; (range partitioning with parallelism 2).&lt;/p&gt;

&lt;p&gt;The job fails with the following exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.IllegalArgumentException: port out of range:-1
	at java.net.InetSocketAddress.checkPort(InetSocketAddress.java:143)
	at java.net.InetSocketAddress.&amp;lt;init&amp;gt;(InetSocketAddress.java:188)
	at org.apache.flink.runtime.io.network.ConnectionID.&amp;lt;init&amp;gt;(ConnectionID.java:47)
	at org.apache.flink.runtime.deployment.InputChannelDeploymentDescriptor.fromEdges(InputChannelDeploymentDescriptor.java:124)
	at org.apache.flink.runtime.executiongraph.ExecutionVertex.createDeploymentDescriptor(ExecutionVertex.java:627)
	at org.apache.flink.runtime.executiongraph.Execution.deployToSlot(Execution.java:358)
	at org.apache.flink.runtime.executiongraph.Execution$1.apply(Execution.java:284)
	at org.apache.flink.runtime.executiongraph.Execution$1.apply(Execution.java:279)
	at org.apache.flink.runtime.concurrent.impl.FlinkFuture$5.onComplete(FlinkFuture.java:259)
	at akka.dispatch.OnComplete.internal(Future.scala:248)
	at akka.dispatch.OnComplete.internal(Future.scala:245)
	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:175)
	at akka.dispatch.japi$CallbackBridge.apply(Future.scala:172)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)
	at org.apache.flink.runtime.concurrent.Executors$DirectExecutor.execute(Executors.java:56)
	at scala.concurrent.impl.ExecutionContextImpl.execute(ExecutionContextImpl.scala:122)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40)
	at scala.concurrent.impl.Promise$KeptPromise.onComplete(Promise.scala:333)
	at org.apache.flink.runtime.concurrent.impl.FlinkFuture.handleAsync(FlinkFuture.java:256)
	at org.apache.flink.runtime.concurrent.impl.FlinkFuture.handle(FlinkFuture.java:270)
	at org.apache.flink.runtime.executiongraph.Execution.scheduleForExecution(Execution.java:279)
	at org.apache.flink.runtime.executiongraph.ExecutionVertex.scheduleForExecution(ExecutionVertex.java:479)
	at org.apache.flink.runtime.executiongraph.Execution$5.call(Execution.java:525)
	at org.apache.flink.runtime.executiongraph.Execution$5.call(Execution.java:521)
	at akka.dispatch.Futures$$anonfun$&lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;$1.apply(Future.scala:95)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13038406">FLINK-5672</key>
            <summary>Job fails with java.lang.IllegalArgumentException: port out of range:-1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="twalthr">Timo Walther</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jan 2017 10:38:56 +0000</created>
                <updated>Thu, 28 Feb 2019 13:20:51 +0000</updated>
                            <resolved>Mon, 8 May 2017 13:54:14 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15842530" author="uce" created="Fri, 27 Jan 2017 10:42:22 +0000"  >&lt;p&gt;Do you have the logs of the TMs? They log their data ports on startup.&lt;/p&gt;</comment>
                            <comment id="15842541" author="twalthr" created="Fri, 27 Jan 2017 10:46:37 +0000"  >&lt;p&gt;I think the problem is the &lt;tt&gt;start-local.sh&lt;/tt&gt;. The task manager has port -1, which can also be seen in the web interface.&lt;/p&gt;</comment>
                            <comment id="15842549" author="twalthr" created="Fri, 27 Jan 2017 10:48:33 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2017-01-27 11:45:17,778 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Starting TaskManager actor at akka:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/taskmanager#-1424206904.
&lt;/span&gt;2017-01-27 11:45:17,778 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager data connection information: ResourceID{resourceId=&lt;span class=&quot;code-quote&quot;&gt;&apos;ecf31fb0ed03ddfae457a1b0697e7ebd&apos;&lt;/span&gt;} @ localhost (dataPort=-1)
2017-01-27 11:45:17,779 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - TaskManager has 1 task slot(s).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15846924" author="stephanewen" created="Tue, 31 Jan 2017 14:55:34 +0000"  >&lt;p&gt;Does this also occur if you only do the &lt;tt&gt;start-local.sh&lt;/tt&gt; ?&lt;/p&gt;</comment>
                            <comment id="15846926" author="stephanewen" created="Tue, 31 Jan 2017 14:57:08 +0000"  >&lt;p&gt;I think we should actually drop the local mode. There is no point for that.&lt;/p&gt;

&lt;p&gt;Local (embedded) execution is different anyways, and a local cluster (with two processes) works out of the box with &lt;tt&gt;start-cluster.sh&lt;/tt&gt;.&lt;br/&gt;
The local special case is just confusing and does not fit well with the rest.&lt;/p&gt;</comment>
                            <comment id="15846928" author="stephanewen" created="Tue, 31 Jan 2017 14:58:40 +0000"  >&lt;p&gt;Addendum: In pure local mode, this never happens because no remote channels are ever deployed. When one TaskManager is remote to the other, then there can be remote channels, and the local taskmanager&apos;s port (which is -1) is actually attempted to be used.&lt;/p&gt;

&lt;p&gt;I vote to not fix this but to drop the local mode altogether, like suggested above.&lt;/p&gt;</comment>
                            <comment id="15847013" author="uce" created="Tue, 31 Jan 2017 16:04:36 +0000"  >&lt;p&gt;+1 to drop it.&lt;/p&gt;</comment>
                            <comment id="15851245" author="twalthr" created="Fri, 3 Feb 2017 09:04:19 +0000"  >&lt;p&gt;I agree. +1 for dropping it.&lt;/p&gt;</comment>
                            <comment id="15863683" author="nicok" created="Mon, 13 Feb 2017 13:40:35 +0000"  >&lt;p&gt;a local cluster does not quite work out of the box via &lt;tt&gt;start-cluster.sh&lt;/tt&gt;! With default values, i.e. &lt;tt&gt;localhost&lt;/tt&gt; in conf/slaves, it requires that it can connect to localhost via ssh.&lt;/p&gt;

&lt;p&gt;If &lt;tt&gt;start-local.sh&lt;/tt&gt; is removed, we should add a special case for &lt;tt&gt;localhost&lt;/tt&gt; that does not require ssh.&lt;/p&gt;

&lt;p&gt;Also we need to decide what to do with &lt;tt&gt;start-local.bat&lt;/tt&gt; since there is no &lt;tt&gt;start-cluster.bat&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15863777" author="githubbot" created="Mon, 13 Feb 2017 14:47:38 +0000"  >&lt;p&gt;GitHub user NicoK opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5672&quot; title=&quot;Job fails with java.lang.IllegalArgumentException: port out of range:-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5672&quot;&gt;&lt;del&gt;FLINK-5672&lt;/del&gt;&lt;/a&gt; add special cases for a local setup in cluster start/stop scripts&lt;/p&gt;

&lt;p&gt;    With this PR, if all slaves refer to `&quot;localhost&quot;` we run the daemons from the script itself instead of using ssh which may not be available. This can be seen as a first step in removing the local mode alltogether.&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/NicoK/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/NicoK/flink&lt;/a&gt; flink-5672&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3298&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 73ba199f9c19a5f6a38dbd6e401d372df7bffd4b&lt;br/&gt;
Author: Nico Kruber &amp;lt;nico@data-artisans.com&amp;gt;&lt;br/&gt;
Date:   2017-02-13T14:33:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5672&quot; title=&quot;Job fails with java.lang.IllegalArgumentException: port out of range:-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5672&quot;&gt;&lt;del&gt;FLINK-5672&lt;/del&gt;&lt;/a&gt; add special cases for a local setup in cluster start/stop scripts&lt;/p&gt;

&lt;p&gt;    This way, if all slaves refer to &quot;localhost&quot;, we do not require ssh at all.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15865340" author="githubbot" created="Tue, 14 Feb 2017 08:18:03 +0000"  >&lt;p&gt;Github user rmetzger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298#discussion_r100978305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298#discussion_r100978305&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-dist/src/main/flink-bin/bin/stop-cluster.sh &amp;#8212;&lt;br/&gt;
    @@ -25,14 +25,30 @@ bin=`cd &quot;$bin&quot;; pwd`&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Stop TaskManager instance(s) using pdsh (Parallel Distributed Shell) when available&lt;br/&gt;
     readSlaves&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    -command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    -if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +# all-local setup?&lt;br/&gt;
    +all_localhost=1&lt;br/&gt;
    +for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +    if [[ &quot;$slave&quot; != &quot;localhost&quot; ]]; then&lt;br/&gt;
    +        all_localhost=0&lt;br/&gt;
    +        break&lt;br/&gt;
    +    fi&lt;br/&gt;
    +done&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think we should put the all localhost check into a method (maybe into the config.sh) to avoid duplicate code&lt;/p&gt;</comment>
                            <comment id="15865342" author="githubbot" created="Tue, 14 Feb 2017 08:19:02 +0000"  >&lt;p&gt;Github user rmetzger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298#discussion_r100978413&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298#discussion_r100978413&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-dist/src/main/flink-bin/bin/stop-cluster.sh &amp;#8212;&lt;br/&gt;
    @@ -25,14 +25,30 @@ bin=`cd &quot;$bin&quot;; pwd`&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Stop TaskManager instance(s) using pdsh (Parallel Distributed Shell) when available&lt;br/&gt;
     readSlaves&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    -command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    -if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +# all-local setup?&lt;br/&gt;
    +all_localhost=1&lt;br/&gt;
    +for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +    if [[ &quot;$slave&quot; != &quot;localhost&quot; ]]; then&lt;br/&gt;
    +        all_localhost=0&lt;br/&gt;
    +        break&lt;br/&gt;
    +    fi&lt;br/&gt;
    +done&lt;br/&gt;
    +&lt;br/&gt;
    +if [[ ${all_localhost} -eq 1 ]]; then&lt;br/&gt;
    +    # all-local setup&lt;br/&gt;
         for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ssh -n $FLINK_SSH_OPTS $slave &amp;#8211; &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop &amp;amp;&quot;&lt;br/&gt;
    +        &quot;${FLINK_BIN_DIR}&quot;/taskmanager.sh stop&lt;br/&gt;
         done&lt;br/&gt;
     else&lt;/li&gt;
	&lt;li&gt;PDSH_SSH_ARGS=&quot;&quot; PDSH_SSH_ARGS_APPEND=$FLINK_SSH_OPTS pdsh -w $(IFS=, ; echo &quot;${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;}&quot;) \&lt;/li&gt;
	&lt;li&gt;&quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop&quot;&lt;br/&gt;
    +    command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    +    if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +        for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +            ssh -n $FLINK_SSH_OPTS $slave &amp;#8211; &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop &amp;amp;&quot;&lt;br/&gt;
    +        done&lt;br/&gt;
    +    else&lt;br/&gt;
    +        PDSH_SSH_ARGS=&quot;&quot; PDSH_SSH_ARGS_APPEND=$FLINK_SSH_OPTS pdsh -w $(IFS=, ; echo &quot;${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;}&quot;) \&lt;br/&gt;
    +            &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop&quot;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Correct me if I&apos;m wrong, but maybe this part of the code only differs in the &quot;start&quot; or &quot;stop&quot; string.&lt;/p&gt;</comment>
                            <comment id="15865581" author="githubbot" created="Tue, 14 Feb 2017 10:56:57 +0000"  >&lt;p&gt;Github user NicoK commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298#discussion_r101008195&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298#discussion_r101008195&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-dist/src/main/flink-bin/bin/stop-cluster.sh &amp;#8212;&lt;br/&gt;
    @@ -25,14 +25,30 @@ bin=`cd &quot;$bin&quot;; pwd`&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Stop TaskManager instance(s) using pdsh (Parallel Distributed Shell) when available&lt;br/&gt;
     readSlaves&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    -command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    -if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +# all-local setup?&lt;br/&gt;
    +all_localhost=1&lt;br/&gt;
    +for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +    if [[ &quot;$slave&quot; != &quot;localhost&quot; ]]; then&lt;br/&gt;
    +        all_localhost=0&lt;br/&gt;
    +        break&lt;br/&gt;
    +    fi&lt;br/&gt;
    +done&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    makes sense - also since there we already go through the slaves once so we can do this check on the fly&lt;/p&gt;</comment>
                            <comment id="15865583" author="githubbot" created="Tue, 14 Feb 2017 10:57:39 +0000"  >&lt;p&gt;Github user NicoK commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298#discussion_r101008339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298#discussion_r101008339&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-dist/src/main/flink-bin/bin/stop-cluster.sh &amp;#8212;&lt;br/&gt;
    @@ -25,14 +25,30 @@ bin=`cd &quot;$bin&quot;; pwd`&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Stop TaskManager instance(s) using pdsh (Parallel Distributed Shell) when available&lt;br/&gt;
     readSlaves&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    -command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    -if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +# all-local setup?&lt;br/&gt;
    +all_localhost=1&lt;br/&gt;
    +for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +    if [[ &quot;$slave&quot; != &quot;localhost&quot; ]]; then&lt;br/&gt;
    +        all_localhost=0&lt;br/&gt;
    +        break&lt;br/&gt;
    +    fi&lt;br/&gt;
    +done&lt;br/&gt;
    +&lt;br/&gt;
    +if [[ ${all_localhost} -eq 1 ]]; then&lt;br/&gt;
    +    # all-local setup&lt;br/&gt;
         for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ssh -n $FLINK_SSH_OPTS $slave &amp;#8211; &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop &amp;amp;&quot;&lt;br/&gt;
    +        &quot;${FLINK_BIN_DIR}&quot;/taskmanager.sh stop&lt;br/&gt;
         done&lt;br/&gt;
     else&lt;/li&gt;
	&lt;li&gt;PDSH_SSH_ARGS=&quot;&quot; PDSH_SSH_ARGS_APPEND=$FLINK_SSH_OPTS pdsh -w $(IFS=, ; echo &quot;${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;}&quot;) \&lt;/li&gt;
	&lt;li&gt;&quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop&quot;&lt;br/&gt;
    +    command -v pdsh &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;br/&gt;
    +    if [[ $? -ne 0 ]]; then&lt;br/&gt;
    +        for slave in ${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}; do&lt;br/&gt;
    +            ssh -n $FLINK_SSH_OPTS $slave &amp;#8211; &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop &amp;amp;&quot;&lt;br/&gt;
    +        done&lt;br/&gt;
    +    else&lt;br/&gt;
    +        PDSH_SSH_ARGS=&quot;&quot; PDSH_SSH_ARGS_APPEND=$FLINK_SSH_OPTS pdsh -w $(IFS=, ; echo &quot;${SLAVES&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;}&quot;) \&lt;br/&gt;
    +            &quot;nohup /bin/bash -l \&quot;${FLINK_BIN_DIR}/taskmanager.sh\&quot; stop&quot;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    you&apos;re right but it&apos;s probably more readable to keep the commands in there instead of sharing them, also it has been that way before &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15978547" author="githubbot" created="Fri, 21 Apr 2017 11:29:31 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good, nice step to get away from the `start-local.sh` script.&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="15978619" author="stephanewen" created="Fri, 21 Apr 2017 12:25:10 +0000"  >&lt;p&gt;Improved &lt;tt&gt;start-cluster.sh&lt;/tt&gt; script merged in 83061ad0f34ab158b6aa7924bba1aa35695817f4&lt;/p&gt;</comment>
                            <comment id="15978629" author="githubbot" created="Fri, 21 Apr 2017 12:25:27 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3298&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16000756" author="stephanewen" created="Mon, 8 May 2017 13:54:14 +0000"  >&lt;p&gt;Now a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6487&quot; title=&quot;Remove JobManager local mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6487&quot;&gt;&lt;del&gt;FLINK-6487&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39alj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>