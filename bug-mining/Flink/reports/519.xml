<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2527] If a VertexUpdateFunction calls setNewVertexValue more than once, the MessagingFunction will only see the first value set</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2527</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The problem is that if setNewVertexValue is called more than once, it sends each new value to the out Collector, and these all end up in the workset, but then the coGroups in the two descendants of MessagingUdfWithEdgeValues use only the first value in the state Iterable. I see three ways to resolve this:&lt;/p&gt;

&lt;p&gt;1. Add it to the documentation that setNewVertexValue should only be called once, and optionally add a check for this.&lt;br/&gt;
2. In setNewVertexValue, do not send the newValue to the out Collector at once, but only record it in outVal, and send the last recorded value after updateVertex returns.&lt;br/&gt;
3. Iterate over the entire Iterable in MessagingUdfWithEVsSimpleVV.coGroup and MessagingUdfWithEVsVVWithDegrees.coGroup. (This would probably still need some documentation addition.)&lt;/p&gt;

&lt;p&gt;I like 2. the best. What are your opinions?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12856351">FLINK-2527</key>
            <summary>If a VertexUpdateFunction calls setNewVertexValue more than once, the MessagingFunction will only see the first value set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggevay">G&#225;bor G&#233;vay</assignee>
                                    <reporter username="ggevay">G&#225;bor G&#233;vay</reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Aug 2015 10:21:50 +0000</created>
                <updated>Mon, 17 Aug 2015 12:19:39 +0000</updated>
                            <resolved>Mon, 17 Aug 2015 12:19:30 +0000</resolved>
                                                    <fixVersion>0.9.1</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                    <component>Library / Graph Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14698305" author="stephanewen" created="Sat, 15 Aug 2015 15:02:06 +0000"  >&lt;p&gt;My first intuition is to allow &lt;tt&gt;setVertexValue&lt;/tt&gt; to be called only once. After all, in this Vertex-Centric model, a vertex has only one value and the solution set should will not consider duplicates, but take only the latest values.&lt;/p&gt;
</comment>
                            <comment id="14698399" author="vkalavri" created="Sat, 15 Aug 2015 18:49:27 +0000"  >&lt;p&gt;I think (3) would break the model semantics. I&apos;m leaning towards (1). &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggevay&quot; class=&quot;user-hover&quot; rel=&quot;ggevay&quot;&gt;ggevay&lt;/a&gt; do you have any case in mind that (2) would allow to implement but (1) wouldn&apos;t?&lt;/p&gt;</comment>
                            <comment id="14698423" author="ggevay" created="Sat, 15 Aug 2015 19:57:15 +0000"  >&lt;p&gt;I&apos;m also leaning towards (1) now. I have actually implemented (2) in the meantime, but then I realized that it sets a subtle trap for the user, that I immediately fell into &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;In my user function, I have a loop over the msgs, and for each msg I decide to set some new vertex value or not. This loop might set a new value multiple times, and the last one should be retained.&lt;/p&gt;

&lt;p&gt;At first, I liked (2) better, because if we have (1), then I essentially have to implement (2) inside my user function anyway. I thought that this situation is probably a common one, so why have everyone reimplement (2) inside their user functions, if we can do it in Gelly? However, the trap is that my code inside the loop implicitly assumed that the setNewVertexValue function updates the vertex variable (the first parameter of the UDF), but it does not. Of course, we could make the setNewVertexValue do this update, but this is getting complicated. So it is probably just best to go with (1), to keep the API nice and simple.&lt;/p&gt;</comment>
                            <comment id="14698670" author="githubbot" created="Sun, 16 Aug 2015 13:49:16 +0000"  >&lt;p&gt;GitHub user ggevay opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2527&quot; title=&quot;If a VertexUpdateFunction calls setNewVertexValue more than once, the MessagingFunction will only see the first value set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2527&quot;&gt;&lt;del&gt;FLINK-2527&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Ensure that VertexUpdateFunction.setNewVertexValue is called at most once&lt;/p&gt;

&lt;p&gt;    I implemented (1), with the check to enforce that it is called at most once. Unfortunately, I had to add exception specification to a number of methods, and users might also have to do this with already existing code. If you think this does not worth it, then I can remove the check.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ggevay/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ggevay/flink&lt;/a&gt; setNewVertexValueFix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1027&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9b514633d868b28d628785a0d099115134599cee&lt;br/&gt;
Author: Gabor Gevay &amp;lt;ggab90@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-08-16T13:26:59Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2527&quot; title=&quot;If a VertexUpdateFunction calls setNewVertexValue more than once, the MessagingFunction will only see the first value set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2527&quot;&gt;&lt;del&gt;FLINK-2527&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;gelly&amp;#93;&lt;/span&gt; Ensure that VertexUpdateFunction.setNewVertexValue is called at most once per updateVertex&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14698738" author="githubbot" created="Sun, 16 Aug 2015 16:02:44 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027#issuecomment-131576936&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027#issuecomment-131576936&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think you can make this non-API-breaking by simply throwing an `IllegalStateException`, which is a `RuntimeException` and therefore needs no part in the signature.&lt;/p&gt;</comment>
                            <comment id="14698834" author="githubbot" created="Sun, 16 Aug 2015 19:43:23 +0000"  >&lt;p&gt;Github user ggevay commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027#issuecomment-131612652&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027#issuecomment-131612652&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Done.&lt;/p&gt;</comment>
                            <comment id="14699283" author="githubbot" created="Mon, 17 Aug 2015 09:45:51 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027#issuecomment-131753704&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027#issuecomment-131753704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good, will merge this...&lt;/p&gt;</comment>
                            <comment id="14699441" author="githubbot" created="Mon, 17 Aug 2015 12:15:14 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1027&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1027&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14699450" author="stephanewen" created="Mon, 17 Aug 2015 12:19:30 +0000"  >&lt;p&gt;Fixed&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;0.10 in 0ea0bc12b3f8a8a82b6fca563340af547c0a02ab&lt;/li&gt;
	&lt;li&gt;0.9.1 in e8802f90a4d38dbd4f3fc12b973639dbf50b61bb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2iylb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>