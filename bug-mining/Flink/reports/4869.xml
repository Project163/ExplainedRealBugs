<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:51:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-20267] JaasModule prevents Flink from starting if working directory is a symbolic link</title>
                <link>https://issues.apache.org/jira/browse/FLINK-20267</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=AHeise&quot; class=&quot;user-hover&quot; rel=&quot;AHeise&quot;&gt;AHeise&lt;/a&gt; reported that starting Flink on EMR fails with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.RuntimeException: unable to generate a JAAS configuration file
        at org.apache.flink.runtime.security.modules.JaasModule.generateDefaultConfigFile(JaasModule.java:170)
        at org.apache.flink.runtime.security.modules.JaasModule.install(JaasModule.java:94)
        at org.apache.flink.runtime.security.SecurityUtils.installModules(SecurityUtils.java:78)
        at org.apache.flink.runtime.security.SecurityUtils.install(SecurityUtils.java:59)
        at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1045)
Caused by: java.nio.file.FileAlreadyExistsException: /tmp
        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88)
        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)
        at sun.nio.fs.UnixFileSystemProvider.createDirectory(UnixFileSystemProvider.java:384)
        at java.nio.file.Files.createDirectory(Files.java:674)
        at java.nio.file.Files.createAndCheckIsDirectory(Files.java:781)
        at java.nio.file.Files.createDirectories(Files.java:727)
        at org.apache.flink.runtime.security.modules.JaasModule.generateDefaultConfigFile(JaasModule.java:162)
        ... 4 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is that on EMR &lt;tt&gt;/tmp&lt;/tt&gt; is a symbolic link. Due to &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-19252&quot; title=&quot;Jaas file created under io.tmp.dirs - folder not created if not exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-19252&quot;&gt;&lt;del&gt;FLINK-19252&lt;/del&gt;&lt;/a&gt; where we introduced the &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/security/modules/JaasModule.java#L162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;creation of the working directory&lt;/a&gt; in order to create the default Jaas config file, the start up process fails if the path for the working directory is not a directory (apparently &lt;tt&gt;Files.createDirectories&lt;/tt&gt; cannot deal with symbolic links).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13341829">FLINK-20267</key>
            <summary>JaasModule prevents Flink from starting if working directory is a symbolic link</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mapohl">Matthias Pohl</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 20 Nov 2020 17:47:45 +0000</created>
                <updated>Thu, 20 Oct 2022 04:30:18 +0000</updated>
                            <resolved>Tue, 24 Nov 2020 15:02:54 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17236355" author="arvid" created="Fri, 20 Nov 2020 18:21:10 +0000"  >&lt;p&gt;There is a workaround for my setting by disabling Jaas with&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;security.module.factory.classes: &quot;org.apache.flink.runtime.security.modules.HadoopModuleFactory&quot;;&quot;org.apache.flink.runtime.security.modules.ZookeeperModuleFactory&quot; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But of course, if you need Jaas, it&apos;s not an option.&lt;/p&gt;</comment>
                            <comment id="17237163" author="dian.fu" created="Mon, 23 Nov 2020 07:26:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guoyangze&quot; class=&quot;user-hover&quot; rel=&quot;guoyangze&quot;&gt;guoyangze&lt;/a&gt; Could you help to take a look at this issue?&lt;/p&gt;</comment>
                            <comment id="17237218" author="dian.fu" created="Mon, 23 Nov 2020 08:31:24 +0000"  >&lt;p&gt;Confirmed with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=guoyangze&quot; class=&quot;user-hover&quot; rel=&quot;guoyangze&quot;&gt;guoyangze&lt;/a&gt; that he is out of office today and so could not take this issue. Here is analysis from him (Hope it could help on fixing this issue):&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;IIUC, check if the dir already exist before creating it could solve this issue, just like TaskManagerServices#checkTempDirs. Right?&lt;/p&gt;

&lt;p&gt;The tmp dir will be created if not exist in TaskManagerServices#checkTempDirs . &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-19252&quot; title=&quot;Jaas file created under io.tmp.dirs - folder not created if not exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-19252&quot;&gt;&lt;del&gt;FLINK-19252&lt;/del&gt;&lt;/a&gt; just move this logic forward to the installation progress of JaasModule.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17238105" author="mapohl" created="Tue, 24 Nov 2020 12:58:50 +0000"  >&lt;p&gt;The fix of PR #14171 was tested on an AWS EMR:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Pre-fix version:&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[hadoop@ip-172-31-36-74 ~]$ ./flink-1.12-pre/bin/flink run -m yarn-cluster -p 4 -yjm 1024m -ytm 4096m flink-1.12-pre/examples/streaming/StateMachineExample.jar 
Setting HBASE_CONF_DIR=/etc/hbase/conf because no HBASE_CONF_DIR was set. 
SLF4J: &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; path contains multiple SLF4J bindings. 
SLF4J: Found binding in [jar:file:/home/hadoop/flink-1.12-pre/lib/log4j-slf4j-impl-2.12.1.jar!/org/slf4j/impl/StaticLoggerBinder.class] 
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class] 
SLF4J: See http:&lt;span class=&quot;code-comment&quot;&gt;//www.slf4j.org/codes.html#multiple_bindings &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an explanation.
&lt;/span&gt;SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory] java.lang.RuntimeException: unable to generate a JAAS configuration file at org.apache.flink.runtime.security.modules.JaasModule.generateDefaultConfigFile(JaasModule.java:170) 
  at org.apache.flink.runtime.security.modules.JaasModule.install(JaasModule.java:94) 
  at org.apache.flink.runtime.security.SecurityUtils.installModules(SecurityUtils.java:78) 
  at org.apache.flink.runtime.security.SecurityUtils.install(SecurityUtils.java:59) 
  at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1045) Caused by: java.nio.file.FileAlreadyExistsException: /tmp 
  at sun.nio.fs.UnixException.translateToIOException(UnixException.java:88) 
  at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) 
  at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) 
  at sun.nio.fs.UnixFileSystemProvider.createDirectory(UnixFileSystemProvider.java:384) 
  at java.nio.file.Files.createDirectory(Files.java:674) 
  at java.nio.file.Files.createAndCheckIsDirectory(Files.java:781) 
  at java.nio.file.Files.createDirectories(Files.java:727) 
  at org.apache.flink.runtime.security.modules.JaasModule.generateDefaultConfigFile(JaasModule.java:162) ... 4 more&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
	&lt;li&gt;Post-fix version:&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[hadoop@ip-172-31-36-74 ~]$ ./flink-1.12-SNAPSHOT/bin/flink run -m yarn-cluster -p 4 -yjm 1024m -ytm 4096m flink-1.12-SNAPSHOT/examples/streaming /StateMachineExample.jar 
Setting HBASE_CONF_DIR=/etc/hbase/conf because no HBASE_CONF_DIR was set. SLF4J: &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; path contains multiple SLF4J bindings. 
SLF4J: Found binding in [jar:file:/home/hadoop/flink-1.12-SNAPSHOT/lib/log4j-slf4j-impl-2.12.1.jar!/org/slf4j/impl/StaticLoggerBinder.class] 
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class] 
SLF4J: See http:&lt;span class=&quot;code-comment&quot;&gt;//www.slf4j.org/codes.html#multiple_bindings &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an explanation. 
&lt;/span&gt;SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory] 
Usage with built-in data generator: StateMachineExample [--error-rate &amp;lt;probability-of-invalid-transition&amp;gt;] [--sleep &amp;lt;sleep-per-record-in-ms&amp;gt;] Usage with Kafka: StateMachineExample --kafka-topic &amp;lt;topic&amp;gt; [--brokers &amp;lt;brokers&amp;gt;] Options &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; both the above setups: [--backend &amp;lt;file|rocks&amp;gt;] [--checkpoint-dir &amp;lt;filepath&amp;gt;] [--async-checkpoints &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;] [--incremental-checkpoints &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;] [--output &amp;lt;filepath&amp;gt; OR &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; stdout]Using standalone source with error rate 0.000000 and sleep delay 1 millis
2020-11-24 12:53:38,616 WARN org.apache.flink.yarn.configuration.YarnLogConfigUtil [] - The configuration directory (&lt;span class=&quot;code-quote&quot;&gt;&apos;/home/hadoop/flink-1.12-SNAPSHOT/conf&apos;&lt;/span&gt;) already contains a LOG4J config file.If you want to use logback, then please delete or rename the log configuration file. 
2020-11-24 12:53:38,767 INFO org.apache.hadoop.yarn.client.RMProxy [] - Connecting to ResourceManager at ip-172-31-36-74.eu-central-1.compute.internal/172.31.36.74:8032 
2020-11-24 12:53:38,892 INFO org.apache.hadoop.yarn.client.AHSProxy [] - Connecting to Application History server at ip-172-31-36-74.eu-central-1.compute.internal/172.31.36.74:10200 
2020-11-24 12:53:38,902 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - No path &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the flink jar passed. Using the location of &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.flink.yarn.YarnClusterDescriptor to locate the jar 
2020-11-24 12:53:39,044 INFO org.apache.hadoop.conf.Configuration [] - resource-types.xml not found 
2020-11-24 12:53:39,045 INFO org.apache.hadoop.yarn.util.resource.ResourceUtils [] - Unable to find &lt;span class=&quot;code-quote&quot;&gt;&apos;resource-types.xml&apos;&lt;/span&gt;. 
2020-11-24 12:53:39,050 INFO org.apache.hadoop.yarn.util.resource.ResourceUtils [] - Adding resource type - name = memory-mb, units = Mi, type = COUNTABLE 
2020-11-24 12:53:39,050 INFO org.apache.hadoop.yarn.util.resource.ResourceUtils [] - Adding resource type - name = vcores, units = , type = COUNTABLE 
2020-11-24 12:53:39,052 WARN org.apache.flink.yarn.YarnClusterDescriptor [] - Neither the HADOOP_CONF_DIR nor the YARN_CONF_DIR environment variable is set. The Flink YARN Client needs one of these to be set to properly load the Hadoop configuration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; accessing YARN. 
2020-11-24 12:53:39,107 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - Cluster specification: ClusterSpecification{masterMemoryMB=1024, taskManagerMemoryMB=4096, slotsPerTaskManager=1} 
2020-11-24 12:53:40,475 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - Submitting application master application_1606220091660_0001 
2020-11-24 12:53:40,806 INFO org.apache.hadoop.yarn.client.api.impl.YarnClientImpl [] - Submitted application application_1606220091660_0001 
2020-11-24 12:53:40,806 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the cluster to be allocated 
2020-11-24 12:53:40,809 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - Deploying cluster, current state ACCEPTED 
2020-11-24 12:53:46,104 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - YARN application has been deployed successfully. 
2020-11-24 12:53:46,105 INFO org.apache.flink.yarn.YarnClusterDescriptor [] - Found Web Interface ip-172-31-38-181.eu-central-1.compute.internal:43067 of application &lt;span class=&quot;code-quote&quot;&gt;&apos;application_1606220091660_0001&apos;&lt;/span&gt;. 
Job has been submitted with JobID 41d1df99e30414d581183c58aed615d9&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17238199" author="till.rohrmann" created="Tue, 24 Nov 2020 15:02:54 +0000"  >&lt;p&gt;Fixed via cdcc57c6541a1511822a69714daba823986f9ed7&lt;/p&gt;</comment>
                            <comment id="17294040" author="gvauvert" created="Tue, 2 Mar 2021 23:17:43 +0000"  >&lt;p&gt;This issue occurs also in Flink 1.11.3.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As a workaround, the temp directory can be configured to use the linked directory directly.&lt;/p&gt;

&lt;p&gt;In flink-conf.yaml, add:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;io.tmp.dirs: /mnt/tmp&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Used to upgrade EMR 6.2.0 Flink 1.11.2 to Flink 1.11.3 using an EMR Step.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13327751">FLINK-19252</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13487198">FLINK-29698</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ksp4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>