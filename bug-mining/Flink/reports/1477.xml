<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:26:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5670] Local RocksDB directories not cleaned up</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5670</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;After cancelling a job with a RocksDB backend all files are properly cleaned up, but the parent directories still exist and are empty:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;859546fec3dac36bb9fcc8cbdd4e291e
+- StreamFlatMap_3_0
+- StreamFlatMap_3_3
+- StreamFlatMap_3_4
+- StreamFlatMap_3_5
+- StreamFlatMap_3_6
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The number of empty folders varies between runs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13038396">FLINK-5670</key>
            <summary>Local RocksDB directories not cleaned up</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aljoscha">Aljoscha Krettek</assignee>
                                    <reporter username="uce">Ufuk Celebi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jan 2017 09:21:23 +0000</created>
                <updated>Fri, 27 Jan 2017 17:16:45 +0000</updated>
                            <resolved>Fri, 27 Jan 2017 17:16:45 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15842584" author="aljoscha" created="Fri, 27 Jan 2017 11:21:26 +0000"  >&lt;p&gt;The problem is that we create to many subdirectories and &lt;tt&gt;RocksDBKeyedStateBackend.dispose&lt;/tt&gt; will only clean up the last part of this. I recently fixed that for 1.1 here: &lt;a href=&quot;https://github.com/apache/flink/commit/e1861db7f71d8583c40b358ee474c77210c761f9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/e1861db7f71d8583c40b358ee474c77210c761f9&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I think we should also get this into Flink 1.2. What do you think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmetzger&quot; class=&quot;user-hover&quot; rel=&quot;rmetzger&quot;&gt;rmetzger&lt;/a&gt;? I know of at least one big user of Flink for which this was a potential problem.&lt;/p&gt;</comment>
                            <comment id="15842588" author="uce" created="Fri, 27 Jan 2017 11:29:16 +0000"  >&lt;p&gt;Looks like an easy fix. Big +1 to fix it for 1.2 as well.&lt;/p&gt;</comment>
                            <comment id="15842597" author="githubbot" created="Fri, 27 Jan 2017 11:34:12 +0000"  >&lt;p&gt;GitHub user aljoscha opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5670&quot; title=&quot;Local RocksDB directories not cleaned up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5670&quot;&gt;&lt;del&gt;FLINK-5670&lt;/del&gt;&lt;/a&gt; Properly clean up local RocksDB directories&lt;/p&gt;

&lt;p&gt;    We have to change the instance path to not include too many nested&lt;br/&gt;
    directories, otherwise the Keyed backend cannot properly clean up the&lt;br/&gt;
    whole directory hierachy.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/aljoscha/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/aljoscha/flink&lt;/a&gt; fix-rocksdb-cleanup&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3225&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 8d0b3ed5437ddb09f4cef376d8d7433b7b4e27b6&lt;br/&gt;
Author: Aljoscha Krettek &amp;lt;aljoscha.krettek@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-01-27T11:32:21Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5670&quot; title=&quot;Local RocksDB directories not cleaned up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5670&quot;&gt;&lt;del&gt;FLINK-5670&lt;/del&gt;&lt;/a&gt; Properly clean up local RocksDB directories&lt;/p&gt;

&lt;p&gt;    We have to change the instance path to not include too many nested&lt;br/&gt;
    directories, otherwise the Keyed backend cannot properly clean up the&lt;br/&gt;
    whole directory hierachy.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15842609" author="rmetzger" created="Fri, 27 Jan 2017 11:45:42 +0000"  >&lt;p&gt;I think this should go into 1.2.0 (Since the merge window is open again for a few hours right now &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;</comment>
                            <comment id="15842693" author="githubbot" created="Fri, 27 Jan 2017 12:24:44 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @uce, @StefanRRichter  Could you please have a look, I think it would be good to have that in Flink 1.2.&lt;/p&gt;</comment>
                            <comment id="15843017" author="githubbot" created="Fri, 27 Jan 2017 15:41:27 +0000"  >&lt;p&gt;Github user StefanRRichter commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1 LGTM&lt;/p&gt;</comment>
                            <comment id="15843038" author="githubbot" created="Fri, 27 Jan 2017 15:57:37 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @uce are you checking this with the Job where you initially discovered it?&lt;/p&gt;</comment>
                            <comment id="15843101" author="githubbot" created="Fri, 27 Jan 2017 16:45:11 +0000"  >&lt;p&gt;Github user uce commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Just verified it with the job. Works fine now! All directories were cleaned up properly.&lt;/p&gt;</comment>
                            <comment id="15843102" author="githubbot" created="Fri, 27 Jan 2017 16:46:50 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks &#128077; &#128515; &lt;/p&gt;</comment>
                            <comment id="15843120" author="githubbot" created="Fri, 27 Jan 2017 17:00:15 +0000"  >&lt;p&gt;Github user aljoscha closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3225&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15843139" author="aljoscha" created="Fri, 27 Jan 2017 17:16:45 +0000"  >&lt;p&gt;Implemented on release-1.2:&lt;br/&gt;
78f090212bab6355919cf03dca3ef672911e987a&lt;/p&gt;

&lt;p&gt;Implemented on master:&lt;br/&gt;
54b70927575d22520b12fb8111324b8f77187822&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39ajb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>