<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:46:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-17946] The config option &quot;pipeline.jars&quot; doesn&apos;t work if the job was executed via TableEnvironment.execute_sql and StatementSet.execute</title>
                <link>https://issues.apache.org/jira/browse/FLINK-17946</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;For the following job:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; logging
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; sys
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; tempfile

from pyflink.table &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; BatchTableEnvironment, EnvironmentSettings


def word_count():
    content = &lt;span class=&quot;code-quote&quot;&gt;&quot;line Licensed to the Apache Software Foundation ASF under one &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;line or more contributor license agreements See the NOTICE file &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;line distributed with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; work &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; additional information &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;line regarding copyright ownership The ASF licenses &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; file &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;to you under the Apache License Version the &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;License you may not use &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; file except in compliance &quot;&lt;/span&gt; \
              &lt;span class=&quot;code-quote&quot;&gt;&quot;with the License&quot;&lt;/span&gt;

    environment_settings = EnvironmentSettings.new_instance().in_batch_mode().\
        use_blink_planner().build()
    t_env = BatchTableEnvironment.create(environment_settings=environment_settings)
    t_env.get_config().get_configuration().set_string(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;pipeline.jars&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;///Users/dianfu/workspace/wordcount_python/flink-csv-1.11.0-sql-jar.jar&quot;&lt;/span&gt;)
&lt;/span&gt;
    # register Results table in table environment
    tmp_dir = tempfile.gettempdir()
    result_path = tmp_dir + &lt;span class=&quot;code-quote&quot;&gt;&apos;/result&apos;&lt;/span&gt;

    logging.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Results directory: %s&quot;&lt;/span&gt;, result_path)

    sink_ddl = &quot;&quot;&quot;
        create table Results(
            word VARCHAR,
            `count` BIGINT
        ) with (
            &lt;span class=&quot;code-quote&quot;&gt;&apos;connector&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;filesystem&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;format&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;csv&apos;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&apos;path&apos;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&apos;{}&apos;&lt;/span&gt;
        )
        &quot;&quot;&quot;.format(result_path)
    t_env.execute_sql(sink_ddl)

    elements = [(word, 1) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; word in content.split(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;)]
    table = t_env.from_elements(elements, [&lt;span class=&quot;code-quote&quot;&gt;&quot;word&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;count&quot;&lt;/span&gt;]) \
        .group_by(&lt;span class=&quot;code-quote&quot;&gt;&quot;word&quot;&lt;/span&gt;) \
        .select(&lt;span class=&quot;code-quote&quot;&gt;&quot;word, count(1) as count&quot;&lt;/span&gt;)

    statement_set = t_env.create_statement_set()
    statement_set.add_insert(&lt;span class=&quot;code-quote&quot;&gt;&quot;Results&quot;&lt;/span&gt;, table, overwrite=True)
    statement_set.execute()


&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;code-quote&quot;&gt;&apos;__main__&apos;&lt;/span&gt;:
    logging.basicConfig(stream=sys.stdout, level=logging.INFO, format=&lt;span class=&quot;code-quote&quot;&gt;&quot;%(message)s&quot;&lt;/span&gt;)

    word_count()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will throw exceptions as following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.ClassCastException: cannot assign instance of java.lang.invoke.SerializedLambda to field org.apache.flink.table.filesystem.FileSystemOutputFormat.formatFactory of type org.apache.flink.table.filesystem.OutputFormatFactory in instance of org.apache.flink.table.filesystem.FileSystemOutputFormat
	at java.io.ObjectStreamClass$FieldReflector.setObjFieldValues(ObjectStreamClass.java:2133)
	at java.io.ObjectStreamClass.setObjFieldValues(ObjectStreamClass.java:1305)
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2237)
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2155)
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2013)
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1535)
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2231)
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2155)
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2013)
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1535)
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:422)
	at java.util.HashMap.readObject(HashMap.java:1404)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1058)
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2122)
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2013)
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1535)
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2231)
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2155)
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2013)
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1535)
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2231)
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:2155)
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2013)
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1535)
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:422)
	at org.apache.flink.util.InstantiationUtil.deserializeObject(InstantiationUtil.java:576)
	at org.apache.flink.util.InstantiationUtil.deserializeObject(InstantiationUtil.java:562)
	at org.apache.flink.util.InstantiationUtil.deserializeObject(InstantiationUtil.java:550)
	at org.apache.flink.util.InstantiationUtil.readObjectFromConfig(InstantiationUtil.java:511)
	at org.apache.flink.runtime.operators.util.TaskConfig.getStubWrapper(TaskConfig.java:288)
	at org.apache.flink.runtime.jobgraph.InputOutputFormatContainer.&amp;lt;init&amp;gt;(InputOutputFormatContainer.java:66)
	... 23 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The reason is that the &quot;pipeline.jars&quot; option is not handled properly in StatementSet.execute and so it cannot find the jar specified via &quot;pipeline.jars&quot;. This issue also exists in TableEnvironment.execute_sql&lt;/p&gt;</description>
                <environment></environment>
        <key id="13307458">FLINK-17946</key>
            <summary>The config option &quot;pipeline.jars&quot; doesn&apos;t work if the job was executed via TableEnvironment.execute_sql and StatementSet.execute</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhongwei">Wei Zhong</assignee>
                                    <reporter username="dian.fu">Dian Fu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 26 May 2020 14:42:11 +0000</created>
                <updated>Fri, 29 May 2020 09:53:15 +0000</updated>
                            <resolved>Fri, 29 May 2020 09:53:15 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>API / Python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17116793" author="dian.fu" created="Tue, 26 May 2020 14:42:29 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhongwei&quot; class=&quot;user-hover&quot; rel=&quot;zhongwei&quot;&gt;zhongwei&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17119455" author="dian.fu" created="Fri, 29 May 2020 09:53:15 +0000"  >&lt;p&gt;Merged to&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master via cda25e5d185cf04c778ed4d173f9db6dfe3522ad&lt;/li&gt;
	&lt;li&gt;release-1.11 via 33b4b4cd8b3d031f6d49196e2517c5deb0150fee&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0f65k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>