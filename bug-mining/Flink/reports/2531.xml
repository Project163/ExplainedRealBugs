<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:34:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9380] Failing end-to-end tests should not clean up logs</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9380</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Some of the end-to-end tests clean up their logs also in the failure case. This makes debugging and understanding the problem extremely difficult. Ideally, the scripts says where it stored the respective logs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13159704">FLINK-9380</key>
            <summary>Failing end-to-end tests should not clean up logs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepaks4077">Deepak Sharma</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 16 May 2018 12:06:12 +0000</created>
                <updated>Wed, 18 Jul 2018 08:47:53 +0000</updated>
                            <resolved>Mon, 16 Jul 2018 18:03:30 +0000</resolved>
                                    <version>1.5.0</version>
                    <version>1.6.0</version>
                                    <fixVersion>1.5.2</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16512898" author="deepaks4077" created="Thu, 14 Jun 2018 19:18:22 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, would mind giving examples? I might be able to take a look.&lt;/p&gt;</comment>
                            <comment id="16513633" author="till.rohrmann" created="Fri, 15 Jun 2018 10:09:37 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=deepaks4077&quot; class=&quot;user-hover&quot; rel=&quot;deepaks4077&quot;&gt;deepaks4077&lt;/a&gt;, the problem is in the &lt;tt&gt;test-runner-common.sh&lt;/tt&gt; where we delete the logs also in the failure case. See &lt;a href=&quot;https://github.com/apache/flink/blob/master/flink-end-to-end-tests/test-scripts/test-runner-common.sh#L73&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/master/flink-end-to-end-tests/test-scripts/test-runner-common.sh#L73&lt;/a&gt; for the exact line.&lt;/p&gt;

&lt;p&gt;For debugging purposes it would be great if we could keep the logs of the failed test run.&lt;/p&gt;</comment>
                            <comment id="16514884" author="deepaks4077" created="Sat, 16 Jun 2018 19:26:16 +0000"  >&lt;p&gt;Hi&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, are we saying that we want the failed test logs to not be deleted at all i.e.&#160;developers will delete them on their own (e.g. if they run the pre-commit tests locally) ?&#160;Should we also&#160;update the documentation to make this clear?&lt;/p&gt;</comment>
                            <comment id="16517718" author="deepaks4077" created="Wed, 20 Jun 2018 02:27:18 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, just a friendly reminder&#160;of this Jira &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16521570" author="deepaks4077" created="Sun, 24 Jun 2018 18:34:12 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, would you still like me to work on this? If so, please let me know what you think about the question above.&lt;/p&gt;</comment>
                            <comment id="16523312" author="till.rohrmann" created="Tue, 26 Jun 2018 06:56:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=deepaks4077&quot; class=&quot;user-hover&quot; rel=&quot;deepaks4077&quot;&gt;deepaks4077&lt;/a&gt;, sorry for my late answer. I would say yes. If a test fails we should keep the logs and the developer is responsible for deleting them. You can also update the docs accordingly.&lt;/p&gt;</comment>
                            <comment id="16536801" author="florianschmidt" created="Mon, 9 Jul 2018 11:20:45 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=deepaks4077&quot; class=&quot;user-hover&quot; rel=&quot;deepaks4077&quot;&gt;deepaks4077&lt;/a&gt;, have you had the chance to make progress on this?&lt;/p&gt;</comment>
                            <comment id="16537482" author="githubbot" created="Mon, 9 Jul 2018 19:57:27 +0000"  >&lt;p&gt;GitHub user deepaks4077 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6289&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9380&quot; title=&quot;Failing end-to-end tests should not clean up logs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9380&quot;&gt;&lt;del&gt;FLINK-9380&lt;/del&gt;&lt;/a&gt;: Modified end to end test runner script to stop deleting logs if tests fail&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This pull request modifies a couple of end to end test runner scripts to save logs of failed tests. Currently, logs are deleted irrespective of a test&apos;s result, making it difficult to debug failed tests. &lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;b&gt;Modified EXIT trap to only cleanup the process instead of cleaning up logs as well&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Added SIGINT trap to clean up everything on test process interrupt&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Export TEST_DATA_DIR inside test-runner-common.sh &lt;em&gt;instead of common.sh&lt;/em&gt;. This allows all test scripts to inherit this variable instead of generating it again on their own via common.sh&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Split operations inside cleanup() into cleanup_proc() and cleanup_files()&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    This change is a trivial rework / code cleanup without any test coverage.&lt;/p&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;The serializers: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (yes / *&lt;b&gt;no&lt;/b&gt;* / don&apos;t know)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (yes / *&lt;b&gt;no&lt;/b&gt;*)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (*&lt;b&gt;not applicable&lt;/b&gt;* / docs / JavaDocs / not documented)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/deepaks4077/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/deepaks4077/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9380&quot; title=&quot;Failing end-to-end tests should not clean up logs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9380&quot;&gt;&lt;del&gt;FLINK-9380&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6289.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6289.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6289&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 81d5757c1036d1a9172dc56963a4169003fa74e8&lt;br/&gt;
Author: Deepak Sharnma &amp;lt;deepaks4077@...&amp;gt;&lt;br/&gt;
Date:   2018-07-09T19:37:58Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9380&quot; title=&quot;Failing end-to-end tests should not clean up logs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9380&quot;&gt;&lt;del&gt;FLINK-9380&lt;/del&gt;&lt;/a&gt;: Modified test runner script to stop deleting logs if tests fail&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16537507" author="deepaks4077" created="Mon, 9 Jul 2018 20:15:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=florianschmidt&quot; class=&quot;user-hover&quot; rel=&quot;florianschmidt&quot;&gt;florianschmidt&lt;/a&gt;: I made some changes today but the ci build is failing. I&apos;ll take a look tonight.&lt;/p&gt;</comment>
                            <comment id="16537880" author="deepaks4077" created="Tue, 10 Jul 2018 01:56:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=florianschmidt&quot; class=&quot;user-hover&quot; rel=&quot;florianschmidt&quot;&gt;florianschmidt&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=till.rohrmann&quot; class=&quot;user-hover&quot; rel=&quot;till.rohrmann&quot;&gt;till.rohrmann&lt;/a&gt;, the CI build is successful. Please take a look.&lt;/p&gt;</comment>
                            <comment id="16545034" author="githubbot" created="Mon, 16 Jul 2018 10:17:29 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6289#discussion_r202631900&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6289#discussion_r202631900&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-end-to-end-tests/test-scripts/test-runner-common.sh &amp;#8212;&lt;br/&gt;
    @@ -58,20 +63,32 @@ function run_test {&lt;br/&gt;
             fi&lt;br/&gt;
         fi&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if [[ ${exit_code} != 0 ]]; then&lt;br/&gt;
    +    if [[ ${exit_code} == 0 ]]; then&lt;br/&gt;
    +        cleanup&lt;br/&gt;
    +    else&lt;br/&gt;
             exit &quot;${exit_code}&quot;&lt;br/&gt;
         fi&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Shuts down the cluster and cleans up all temporary folders and files. Make sure to clean up even in case of failures.&lt;br/&gt;
    +# Shuts down cluster and reverts changes to cluster configs&lt;br/&gt;
    +function cleanup_proc 
{
    +    shutdown_all
    +    revert_default_config
    +}
&lt;p&gt;    +&lt;br/&gt;
    +# Cleans up all temporary folders and files&lt;br/&gt;
    +function cleanup_files {&lt;/p&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    function name is too generic, rename to `cleanup_temp_files`&lt;/p&gt;</comment>
                            <comment id="16545035" author="githubbot" created="Mon, 16 Jul 2018 10:17:46 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6289&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;ll just fix the name while merging.&lt;/p&gt;</comment>
                            <comment id="16545278" author="githubbot" created="Mon, 16 Jul 2018 14:51:07 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/6289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/6289&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16545561" author="zentol" created="Mon, 16 Jul 2018 18:03:30 +0000"  >&lt;p&gt;master: 0777753614ff2fad2847ba7e7c801a706eb06bed&lt;br/&gt;
1.5: dfc8d15841a86ec7d3b9c3b0788043a77fd6179a&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="13168100">FLINK-9658</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ts0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>