<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19994] All vertices in an DataSet iteration job will be eagerly scheduled</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19994</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;After switching to pipelined region scheduling, all vertices in an DataSet iteration job will be eagerly scheduled, which means BLOCKING result consumers can be deployed even before the result finishes and resource waste happens. This is because all vertices will be put into one pipelined region if the job contains &lt;tt&gt;ColocationConstraint&lt;/tt&gt;, see &lt;a href=&quot;https://github.com/apache/flink/blob/c0f382f5f0072441ef8933f6993f1c34168004d6/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/failover/flip1/PipelinedRegionComputeUtil.java#L52&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PipelinedRegionComputeUtil&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;IIUC, this &lt;tt&gt;makeAllOneRegion()&lt;/tt&gt; behavior was introduced to ensure co-located iteration head and tail to be restarted together in pipelined region failover. However, given that edges within an iteration will always be PIPELINED (&lt;a href=&quot;https://github.com/apache/flink/blob/0523ef6451a93da450c6bdf5dd4757c3702f3962/flink-optimizer/src/main/java/org/apache/flink/optimizer/plantranslate/JobGraphGenerator.java#L1188&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ref&lt;/a&gt;), co-located iteration head and tail will always be in the same region. So I think we can drop the &lt;tt&gt;PipelinedRegionComputeUtil#makeAllOneRegion()&lt;/tt&gt; code path and build regions in the the same way no matter if there is co-location constraints or not.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13338973">FLINK-19994</key>
            <summary>All vertices in an DataSet iteration job will be eagerly scheduled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhuzh">Zhu Zhu</assignee>
                                    <reporter username="zhuzh">Zhu Zhu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 5 Nov 2020 09:29:13 +0000</created>
                <updated>Tue, 10 Nov 2020 19:09:33 +0000</updated>
                            <resolved>Tue, 10 Nov 2020 19:09:33 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17226604" author="zhuzh" created="Thu, 5 Nov 2020 09:32:50 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azagrebin&quot; class=&quot;user-hover&quot; rel=&quot;azagrebin&quot;&gt;azagrebin&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WDYT?&lt;br/&gt;
Correct me if I missed anything about why we need to make all vertices in one region for an iteration job.&lt;/p&gt;</comment>
                            <comment id="17226698" author="azagrebin" created="Thu, 5 Nov 2020 12:39:13 +0000"  >&lt;p&gt;This makes sense to me. We already have&#160;computeStronglyConnectedComponents to put vertexes of one iteration into one region. I am running &lt;a href=&quot;https://dev.azure.com/azagrebin/azagrebin/_build/results?buildId=341&amp;amp;view=results&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt; to see if there are any failures for existing iteration tests. We probably also need some test with failover for iterations if there is none yet.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhuzh&quot; class=&quot;user-hover&quot; rel=&quot;zhuzh&quot;&gt;zhuzh&lt;/a&gt;&#160;was&#160;buildOneRegionForAllVertices done because it was not clear whether&#160;one iteration can contain blocking edges or not? or what was the possible reason for head/tail being not in the same pipelined failover region?&lt;/p&gt;</comment>
                            <comment id="17226776" author="till.rohrmann" created="Thu, 5 Nov 2020 15:41:51 +0000"  >&lt;p&gt;Is it somewhere enforced that the iteration step can only use pipelined data exchanges?&lt;/p&gt;</comment>
                            <comment id="17226799" author="zhuzh" created="Thu, 5 Nov 2020 16:14:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azagrebin&quot; class=&quot;user-hover&quot; rel=&quot;azagrebin&quot;&gt;azagrebin&lt;/a&gt; &lt;tt&gt;computeStronglyConnectedComponents&lt;/tt&gt; does not see iteration feedback edges so it does not help here. However, iteration edges will always be PIPELINED so that head and tail task will be pipelined connected and then will be in one region.&lt;br/&gt;
I have also run a &lt;a href=&quot;https://dev.azure.com/zhuzh/flink-zz/_build/results?buildId=268&amp;amp;view=results&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt; for the proposed change and it has passed.&lt;br/&gt;
The behavior to &lt;tt&gt;buildOneRegionForAllVertices&lt;/tt&gt; has been there for quite some time since the legacy RestartPipelinedRegionStrategy which was already removed. I am not quite sure about the initial purpose. But from what I see, it is not needed now. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=trohrmann&quot; class=&quot;user-hover&quot; rel=&quot;trohrmann&quot;&gt;trohrmann&lt;/a&gt; &lt;a href=&quot;https://github.com/apache/flink/blob/0523ef6451a93da450c6bdf5dd4757c3702f3962/flink-optimizer/src/main/java/org/apache/flink/optimizer/plantranslate/JobGraphGenerator.java#L1188&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This&lt;/a&gt; is where edges within an iteration will be set to PIPELINED for DataSet jobs. And for streaming jobs, edges are always PIPELINED.&lt;/p&gt;</comment>
                            <comment id="17226816" author="till.rohrmann" created="Thu, 5 Nov 2020 16:43:37 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhuzh&quot; class=&quot;user-hover&quot; rel=&quot;zhuzh&quot;&gt;zhuzh&lt;/a&gt; for the pointer. I think it should then be fine to remove &lt;tt&gt;makeAllOneRegion()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17229451" author="zhuzh" created="Tue, 10 Nov 2020 19:09:33 +0000"  >&lt;p&gt;Fixed via:&lt;br/&gt;
0b0a6d90c7819be3b31e64e8aba83ee8ae2d757c&lt;br/&gt;
a9d859b36b47cb433d2bb159d4a8848b769c8710&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0kb2w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>