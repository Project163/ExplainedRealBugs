<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2556] Fix/Refactor pre-flight Key validation</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2556</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The pre-flight key validation checks are inconsistent, at times don&apos;t actually check anything and in at least 1 case are done redundantly.&lt;/p&gt;

&lt;p&gt;For example,&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;you can group on a tuple containing a non-Atomic-/CompositeType using String[] KeyExpressions (see &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2541&quot; title=&quot;TypeComparator creation fails for T2&amp;lt;T1&amp;lt;byte[]&amp;gt;, byte[]&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2541&quot;&gt;&lt;del&gt;FLINK-2541&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;you can group on an AtomicType even though isKeyType() returns false, if it is contained in a tuple&lt;/li&gt;
	&lt;li&gt;for distinct(String[]...) the above fails in the DistinctOperator constructor, as it validates the key again for some reason.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12857677">FLINK-2556</key>
            <summary>Fix/Refactor pre-flight Key validation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2015 22:42:44 +0000</created>
                <updated>Thu, 28 Feb 2019 14:29:14 +0000</updated>
                            <resolved>Thu, 27 Aug 2015 21:43:11 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14708412" author="githubbot" created="Sun, 23 Aug 2015 15:55:38 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2556&quot; title=&quot;Fix/Refactor pre-flight Key validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2556&quot;&gt;&lt;del&gt;FLINK-2556&lt;/del&gt;&lt;/a&gt; Refactor/Fix pre-flight Key validation&lt;/p&gt;

&lt;p&gt;    Removed redundant key validation in DistinctOperator&lt;br/&gt;
    Keys constructors now make sure the type of every key is an instance of AtomicType/CompositeType, and that type.isKeyType() is true.&lt;br/&gt;
    Additionally, the ExpressionKeys int[] constructor explicitly rejects Tuple0&lt;br/&gt;
    Changes one test that actually tried something that shouldn&apos;t work in the first place.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; isKeyType_check&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1044&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7a57b6ef2ecdc7adaf770f8585cf8f974c684705&lt;br/&gt;
Author: zentol &amp;lt;s.motsu@web.de&amp;gt;&lt;br/&gt;
Date:   2015-08-23T13:57:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2556&quot; title=&quot;Fix/Refactor pre-flight Key validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2556&quot;&gt;&lt;del&gt;FLINK-2556&lt;/del&gt;&lt;/a&gt; Refactor/Fix pre-flight Key validation&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14709061" author="githubbot" created="Mon, 24 Aug 2015 10:12:39 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#issuecomment-134129988&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#issuecomment-134129988&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM, +1&lt;/p&gt;</comment>
                            <comment id="14709469" author="githubbot" created="Mon, 24 Aug 2015 15:38:56 +0000"  >&lt;p&gt;Github user StephanEwen commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#discussion_r37765150&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#discussion_r37765150&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/Keys.java &amp;#8212;&lt;br/&gt;
    @@ -209,6 +209,9 @@ public ExpressionKeys(int[] groupingFields, TypeInformation&amp;lt;T&amp;gt; type, boolean all&lt;br/&gt;
     				throw new InvalidProgramException(&quot;Specifying keys via field positions is only valid &quot; +&lt;br/&gt;
     						&quot;for tuple data types. Type: &quot; + type);&lt;br/&gt;
     			}&lt;br/&gt;
    +			if (type.getArity() == 0) {&lt;br/&gt;
    +				throw new InvalidProgramException(&quot;Tuple size must be greater than 0. Size: &quot; + type.getArity());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    There is a Tuple 0 now. Can a Tuple0 be a key?&lt;/p&gt;</comment>
                            <comment id="14709490" author="githubbot" created="Mon, 24 Aug 2015 15:49:26 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#discussion_r37766287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#discussion_r37766287&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/Keys.java &amp;#8212;&lt;br/&gt;
    @@ -209,6 +209,9 @@ public ExpressionKeys(int[] groupingFields, TypeInformation&amp;lt;T&amp;gt; type, boolean all&lt;br/&gt;
     				throw new InvalidProgramException(&quot;Specifying keys via field positions is only valid &quot; +&lt;br/&gt;
     						&quot;for tuple data types. Type: &quot; + type);&lt;br/&gt;
     			}&lt;br/&gt;
    +			if (type.getArity() == 0) {&lt;br/&gt;
    +				throw new InvalidProgramException(&quot;Tuple size must be greater than 0. Size: &quot; + type.getArity());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    ahh..it can be a key, but you can&apos;t group on a DataSet&amp;lt;Tuple0&amp;gt;.&lt;/p&gt;</comment>
                            <comment id="14709492" author="githubbot" created="Mon, 24 Aug 2015 15:51:20 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#discussion_r37766532&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#discussion_r37766532&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/operators/Keys.java &amp;#8212;&lt;br/&gt;
    @@ -209,6 +209,9 @@ public ExpressionKeys(int[] groupingFields, TypeInformation&amp;lt;T&amp;gt; type, boolean all&lt;br/&gt;
     				throw new InvalidProgramException(&quot;Specifying keys via field positions is only valid &quot; +&lt;br/&gt;
     						&quot;for tuple data types. Type: &quot; + type);&lt;br/&gt;
     			}&lt;br/&gt;
    +			if (type.getArity() == 0) {&lt;br/&gt;
    +				throw new InvalidProgramException(&quot;Tuple size must be greater than 0. Size: &quot; + type.getArity());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    this check was added specifically for Tuple0, as in the current code you&apos;d get weird exceptions when grouping on a Tuple0.&lt;/p&gt;</comment>
                            <comment id="14710905" author="githubbot" created="Tue, 25 Aug 2015 08:46:03 +0000"  >&lt;p&gt;Github user fhueske commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#issuecomment-134525712&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#issuecomment-134525712&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    LGTM&lt;/p&gt;</comment>
                            <comment id="14717190" author="githubbot" created="Thu, 27 Aug 2015 18:04:17 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044#issuecomment-135508810&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044#issuecomment-135508810&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="14717579" author="githubbot" created="Thu, 27 Aug 2015 21:37:57 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1044&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14717589" author="stephanewen" created="Thu, 27 Aug 2015 21:43:11 +0000"  >&lt;p&gt;Fixed via 1e38d6fad410c0a0ef82fa73617f6feda86cd0e0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j6kf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>