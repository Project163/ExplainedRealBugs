<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:47:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-18157] Jobstore size check compares against offHeapMemory</title>
                <link>https://issues.apache.org/jira/browse/FLINK-18157</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Setting &lt;tt&gt;jobmanager.memory.off-heap.size&lt;/tt&gt; to 0 results in this confusing error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[] - Loading configuration property: jobmanager.memory.process.size, 2000m
[] - Loading configuration property: jobmanager.memory.heap.size, 1500m
[] - Loading configuration property: jobmanager.memory.jvm-overhead.min, 100m
[] - Loading configuration property: jobmanager.memory.jvm-overhead.max, 350m
[] - Loading configuration property: jobmanager.memory.off-heap.size, 0m
[] - The configured or derived JVM heap memory size (jobstore.cache-size: 0 bytes) is less than the configured or &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; size of the job store cache (jobmanager.memory.heap.size: 50.000mb (52428800 bytes))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to the documentation the jobstore uses the heap though.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; JobManagerFlinkMemory createJobManagerFlinkMemory(
		Configuration config,
		MemorySize jvmHeap,
		MemorySize offHeapMemory) {
	verifyJvmHeapSize(jvmHeap);
	verifyJobStoreCacheSize(config, offHeapMemory);
	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JobManagerFlinkMemory(jvmHeap, offHeapMemory);
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void verifyJvmHeapSize(MemorySize jvmHeapSize) {
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (jvmHeapSize.compareTo(JobManagerOptions.MIN_JVM_HEAP_SIZE) &amp;lt; 1) {
		LOG.warn(
			&lt;span class=&quot;code-quote&quot;&gt;&quot;The configured or derived JVM heap memory size ({}) is less than its recommended minimum value ({})&quot;&lt;/span&gt;,
			jvmHeapSize.toHumanReadableString(),
			JobManagerOptions.MIN_JVM_HEAP_SIZE);
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13309706">FLINK-18157</key>
            <summary>Jobstore size check compares against offHeapMemory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nicholasjiang">Nicholas Jiang</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 5 Jun 2020 11:47:45 +0000</created>
                <updated>Tue, 9 Jun 2020 16:42:04 +0000</updated>
                            <resolved>Tue, 9 Jun 2020 13:51:28 +0000</resolved>
                                    <version>1.11.0</version>
                                    <fixVersion>1.11.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17126756" author="nicholasjiang" created="Fri, 5 Jun 2020 13:07:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; Just the log of method verifyJobStoreCacheSize is incorrect. This log should use offheap.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; JobManagerFlinkMemory createJobManagerFlinkMemory(
			Configuration config,
			MemorySize jvmHeap,
			MemorySize offHeapMemory) {
		verifyJvmHeapSize(jvmHeap);
		verifyJobStoreCacheSize(config, offHeapMemory);
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JobManagerFlinkMemory(jvmHeap, offHeapMemory);
}
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void verifyJobStoreCacheSize(Configuration config, MemorySize jvmHeapSize) {
		MemorySize jobStoreCacheHeapSize =
			MemorySize.parse(config.getLong(JobManagerOptions.JOB_STORE_CACHE_SIZE) + &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;);
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (jvmHeapSize.compareTo(jobStoreCacheHeapSize) &amp;lt; 1) {
			LOG.warn(
				&lt;span class=&quot;code-quote&quot;&gt;&quot;The configured or derived JVM heap memory size ({}: {}) is less than the configured or &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; size &quot;&lt;/span&gt; +
					&lt;span class=&quot;code-quote&quot;&gt;&quot;of the job store cache ({}: {})&quot;&lt;/span&gt;,
				JobManagerOptions.JOB_STORE_CACHE_SIZE.key(),
				jvmHeapSize.toHumanReadableString(),
				JobManagerOptions.JVM_HEAP_MEMORY.key(),
				jobStoreCacheHeapSize.toHumanReadableString());
		}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could you please assign to me for fixing?&lt;/p&gt;</comment>
                            <comment id="17126803" author="azagrebin" created="Fri, 5 Jun 2020 14:14:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nicholasjiang&quot; class=&quot;user-hover&quot; rel=&quot;nicholasjiang&quot;&gt;nicholasjiang&lt;/a&gt; good point, I believe we also miss a test for this. I am assigning you. We need to fix asap before the release. Please, move the issue to progress to work on this&lt;/p&gt;</comment>
                            <comment id="17129292" author="azagrebin" created="Tue, 9 Jun 2020 13:51:28 +0000"  >&lt;p&gt;merged into master by&#160;040ce4be4c37652bebd28a75d97d903fca64616d&lt;/p&gt;

&lt;p&gt;merged into 1.11 by 823720de4e75faf31f181722bdaaedc781f22d58&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                                                <inwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="13310371">FLINK-18214</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310460">
                    <name>Child-Issue</name>
                                                                <inwardlinks description="is a child of">
                                        <issuelink>
            <issuekey id="13307733">FLINK-17973</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0fjy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>