<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:54:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-21896] GroupAggregateJsonPlanTest.testDistinctAggCalls fail</title>
                <link>https://issues.apache.org/jira/browse/FLINK-21896</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15083&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6364&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15083&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6364&lt;/a&gt;&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

	at org.apache.flink.table.planner.plan.nodes.exec.stream.GroupAggregateJsonPlanTest.testDistinctAggCalls(GroupAggregateJsonPlanTest.java:148)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:239)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13366614">FLINK-21896</key>
            <summary>GroupAggregateJsonPlanTest.testDistinctAggCalls fail</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="godfreyhe">godfrey he</assignee>
                                    <reporter username="maguowei">Guowei Ma</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Mon, 22 Mar 2021 02:19:02 +0000</created>
                <updated>Fri, 14 Jan 2022 09:03:29 +0000</updated>
                            <resolved>Wed, 24 Mar 2021 13:14:24 +0000</resolved>
                                    <version>1.13.0</version>
                                    <fixVersion>1.13.0</fixVersion>
                                    <component>Table SQL / Planner</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17305863" author="maguowei" created="Mon, 22 Mar 2021 03:21:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15115&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6791&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15115&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6791&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17305908" author="maguowei" created="Mon, 22 Mar 2021 06:14:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15137&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6791&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15137&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6791&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17306751" author="maguowei" created="Tue, 23 Mar 2021 04:09:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15215&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6543&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15215&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6543&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17306826" author="dawidwys" created="Tue, 23 Mar 2021 07:09:01 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt; could you take a look?&lt;/p&gt;</comment>
                            <comment id="17306847" author="godfreyhe" created="Tue, 23 Mar 2021 07:33:02 +0000"  >&lt;p&gt;Thanks for reporting this, I will take this issue. &lt;/p&gt;</comment>
                            <comment id="17306860" author="dawidwys" created="Tue, 23 Mar 2021 07:49:53 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17307129" author="godfreyhe" created="Tue, 23 Mar 2021 14:35:29 +0000"  >&lt;p&gt;The reason is the serialization results for an object without &lt;tt&gt;serialVersionUID&lt;/tt&gt; are different between jdk8 and jdk11. The following code can reproduce the difference:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      StructuredType structuredType =
                StructuredType.newBuilder(MapView.class)
                        .attributes(
                                Collections.singletonList(
                                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StructuredType.StructuredAttribute(
                                                &lt;span class=&quot;code-quote&quot;&gt;&quot;map&quot;&lt;/span&gt;,
                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapType(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IntType(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigIntType(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)))))
                        .build();
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(EncodingUtils.encodeObjectToString(structuredType));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the result of jdk8 is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
rO0ABXNyADNvcmcuYXBhY2hlLmZsaW5rLnRhYmxlLnR5cGVzLmxvZ2ljYWwuU3RydWN0dXJlZFR5cGUt-WvI46_69wIABVoADmlzSW5zdGFudGlhYmxlTAAKYXR0cmlidXRlc3QAEExqYXZhL3V0aWwvTGlzdDtMAAtjb21
......

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the result of jdk11 is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
rO0ABXNyADNvcmcuYXBhY2hlLmZsaW5rLnRhYmxlLnR5cGVzLmxvZ2ljYWwuU3RydWN0dXJlZFR5cGWW-4qkzgeWwgIABVoADmlzSW5zdGFudGlhYmxlTAAKYXR0cmlidXRlc3QAEExqYXZhL3V0aWwvTGlzdDtMAAtjb21......
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because StructuredType has no serialVersionUID.&lt;/p&gt;

&lt;p&gt;Why there are only two cases will occur such errors? because the two cases have distinct aggregate with local aggregate, which will produce RawType (RawType will encode the inner serializer object (which contains StructuredType) into string as the value of &lt;tt&gt;getSerializerString&lt;/tt&gt;, see RawType#getSerializerString), the full structure of RawType in failed cases is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
StructuredType structuredType =
                StructuredType.newBuilder(MapView.class)
                        .attributes(
                                Collections.singletonList(
                                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StructuredType.StructuredAttribute(
                                                &lt;span class=&quot;code-quote&quot;&gt;&quot;map&quot;&lt;/span&gt;,
                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapType(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IntType(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigIntType(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)))))
                        .build();

 &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RawType&amp;lt;&amp;gt;(
                        MapView.class,
                        ExternalSerializer.of(
                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FieldsDataType(
                                        structuredType,
                                        Collections.singletonList(
                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KeyValueDataType(
                                                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapType(
                                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IntType(),
                                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigIntType(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)),
                                                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AtomicDataType(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IntType()),
                                                        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AtomicDataType(
                                                                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigIntType(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)))))))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The solution is we add serialVersionUID for StructuredType.&lt;br/&gt;
And I suggest we should add serialVersionUID for all logical types.&lt;/p&gt;



</comment>
                            <comment id="17307544" author="maguowei" created="Wed, 24 Mar 2021 04:03:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15316&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=15316&amp;amp;view=logs&amp;amp;j=f66801b3-5d8b-58b4-03aa-cc67e0663d23&amp;amp;t=1abe556e-1530-599d-b2c7-b8c00d549e53&amp;amp;l=6795&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17307816" author="godfreyhe" created="Wed, 24 Mar 2021 13:14:24 +0000"  >&lt;p&gt;Fixed in 1.13.0: d3d320be60b07fb4be1b133a5fae507183bd694f&lt;/p&gt;</comment>
                            <comment id="17475743" author="soumyajitsahu" created="Thu, 13 Jan 2022 21:04:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=godfreyhe&quot; class=&quot;user-hover&quot; rel=&quot;godfreyhe&quot;&gt;godfreyhe&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=twalthr&quot; class=&quot;user-hover&quot; rel=&quot;twalthr&quot;&gt;twalthr&lt;/a&gt; This would break upgrade from Flink 12 to 13, right?&lt;br/&gt;
If serialization was done using Flink 12, and then app was redeployed using Flink 13, then the deserialization throws this error.&lt;/p&gt;

&lt;p&gt;To mitigate, we had to delete our app&apos;s state and start the flink app afresh.&lt;/p&gt;


&lt;p&gt;java.io.InvalidClassException: org.apache.flink.table.types.logical.LogicalType; local class incompatible: stream classdesc serialVersionUID = -7381419642101800907, local class serialVersionUID = 1&lt;br/&gt;
	at java.io.ObjectStreamClass.initNonProxy(ObjectStreamClass.java:699)&lt;br/&gt;
	at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:2003)&lt;br/&gt;
	at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1850)&lt;br/&gt;
	at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:2003)&lt;br/&gt;
	at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1850)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2160)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1667)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:503)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:461)&lt;br/&gt;
	at org.apache.flink.util.InstantiationUtil.deserializeObject(InstantiationUtil.java:615)&lt;br/&gt;
	at org.apache.flink.util.InstantiationUtil.deserializeObject(InstantiationUtil.java:593)&lt;/p&gt;</comment>
                            <comment id="17476034" author="twalthr" created="Fri, 14 Jan 2022 09:03:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=soumyajitsahu&quot; class=&quot;user-hover&quot; rel=&quot;soumyajitsahu&quot;&gt;soumyajitsahu&lt;/a&gt; We currently don&apos;t support upgrades for Table API &amp;amp; SQL:&lt;br/&gt;
&lt;a href=&quot;https://nightlies.apache.org/flink/flink-docs-release-1.14/docs/dev/table/concepts/overview/#stateful-upgrades-and-evolution&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://nightlies.apache.org/flink/flink-docs-release-1.14/docs/dev/table/concepts/overview/#stateful-upgrades-and-evolution&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But we are actively working on it. See:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=191336489&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=191336489&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0p0xs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>