<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4169] CEP Does Not Work with RocksDB StateBackend</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4169</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;A job will never match any patterns because &lt;tt&gt;ValueState.update()&lt;/tt&gt; is not called in the keyed CEP operators for updating the &lt;tt&gt;NFA&lt;/tt&gt; state and the priority queue state.&lt;/p&gt;

&lt;p&gt;The reason why it works for other state backends is that they are very lax in their handling of state: if the object returned from &lt;tt&gt;ValueState.value())&lt;/tt&gt; is mutable changes to this will be reflected in checkpoints even if &lt;tt&gt;ValueState.update()&lt;/tt&gt; is not called. RocksDB, on the other hand, does always deserialize/serialize state values when accessing/updating them, so changes to the returned object will not be reflected in the state unless &lt;tt&gt;update()&lt;/tt&gt; is called.&lt;/p&gt;

&lt;p&gt;We should fix this and also add a test for it. This might be tricky because we have to pull together RocksDB and CEP.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12987469">FLINK-4169</key>
            <summary>CEP Does Not Work with RocksDB StateBackend</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aljoscha">Aljoscha Krettek</assignee>
                                    <reporter username="aljoscha">Aljoscha Krettek</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Jul 2016 12:43:36 +0000</created>
                <updated>Tue, 18 Apr 2017 12:39:22 +0000</updated>
                            <resolved>Mon, 18 Jul 2016 12:12:46 +0000</resolved>
                                    <version>1.0.0</version>
                    <version>1.0.1</version>
                    <version>1.0.2</version>
                    <version>1.0.3</version>
                    <version>1.1.0</version>
                                                    <component>Library / CEP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15366088" author="rmetzger" created="Thu, 7 Jul 2016 13:27:16 +0000"  >&lt;p&gt;Adding rocksdb as test-scoped dependency to the CEP library should not be an issue.&lt;/p&gt;</comment>
                            <comment id="15366224" author="aljoscha" created="Thu, 7 Jul 2016 14:48:53 +0000"  >&lt;p&gt;I added a fix for this to my CEP PR: &lt;a href=&quot;https://github.com/apache/flink/pull/2202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2202&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15382181" author="aljoscha" created="Mon, 18 Jul 2016 12:12:46 +0000"  >&lt;p&gt;Done in &lt;a href=&quot;https://github.com/apache/flink/commit/a710fc3d58014a7191de61fd5d6370de97c9e75e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/a710fc3d58014a7191de61fd5d6370de97c9e75e&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15966258" author="shashank734" created="Wed, 12 Apr 2017 17:38:54 +0000"  >&lt;p&gt;Again getting this error in flink 1.2, Running on yarn cluster. After changing state backend from Rocksdb it&apos;s working fine.&lt;/p&gt;

&lt;p&gt;```&lt;br/&gt;
04/12/2017 10:05:04	Job execution switched to status FAILING.&lt;br/&gt;
java.lang.RuntimeException: Could not deserialize NFA.&lt;br/&gt;
	at org.apache.flink.cep.nfa.NFA$Serializer.deserialize(NFA.java:538)&lt;br/&gt;
	at org.apache.flink.cep.nfa.NFA$Serializer.deserialize(NFA.java:469)&lt;br/&gt;
	at org.apache.flink.contrib.streaming.state.RocksDBValueState.value(RocksDBValueState.java:81)&lt;br/&gt;
	at org.apache.flink.cep.operator.AbstractKeyedCEPPatternOperator.getNFA(AbstractKeyedCEPPatternOperator.java:124)&lt;br/&gt;
	at org.apache.flink.cep.operator.AbstractCEPBasePatternOperator.processElement(AbstractCEPBasePatternOperator.java:72)&lt;br/&gt;
	at org.apache.flink.cep.operator.AbstractKeyedCEPPatternOperator.processElement(AbstractKeyedCEPPatternOperator.java:162)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.io.StreamInputProcessor.processInput(StreamInputProcessor.java:185)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask.run(OneInputStreamTask.java:63)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:272)&lt;br/&gt;
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:655)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: co.ronak.nto.Job$$anon$18$$anon$21$$anon$3&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)&lt;br/&gt;
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Class.java:348)&lt;br/&gt;
	at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:626)&lt;br/&gt;
	at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1613)&lt;br/&gt;
	at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1518)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1774)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:501)&lt;br/&gt;
	at org.apache.flink.api.scala.typeutils.TraversableSerializer.readObject(TraversableSerializer.scala:53)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:497)&lt;br/&gt;
	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1900)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1707)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1345)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1924)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:501)&lt;br/&gt;
	at org.apache.flink.cep.NonDuplicatingTypeSerializer.readObject(NonDuplicatingTypeSerializer.java:190)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:497)&lt;br/&gt;
	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1900)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:2000)&lt;br/&gt;
	at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:501)&lt;br/&gt;
	at org.apache.flink.cep.nfa.NFA.readObject(NFA.java:394)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:497)&lt;br/&gt;
	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1900)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1801)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)&lt;br/&gt;
	at org.apache.flink.cep.nfa.NFA$Serializer.deserialize(NFA.java:535)&lt;br/&gt;
	... 10 more&lt;br/&gt;
```&lt;/p&gt;</comment>
                            <comment id="15972589" author="aljoscha" created="Tue, 18 Apr 2017 12:39:22 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6318&quot; title=&quot;NFA serialisation doesn&amp;#39;t work with TypeSerializers that load classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6318&quot;&gt;&lt;del&gt;FLINK-6318&lt;/del&gt;&lt;/a&gt; for this new issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30nev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>