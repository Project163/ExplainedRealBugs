<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:24:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4261] Setup atomic deployment of snapshots</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4261</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Users have reported that our nightly snapshots become inconsistent from time to time. This happens when the upload to the snapshot repository fails during the deployment process. Maven doesn&apos;t support atomic deployment but deploys artifacts one after another, directly after installing them in the local repository. If the build fails at any time, no changes are rolled back. &lt;/p&gt;

&lt;p&gt;This problem has been solved for Nexus repositories. For releases, we already take advantage of atomic deployments using staging repositories. Nexus repositories support this even without using a special Maven plugin. &lt;/p&gt;

&lt;p&gt;For releases, we have to use the Web UI to close and release staging repositories. For snapshots this should be automated. Most importantly, the changes shouldn&apos;t alter anything for our release process.&lt;/p&gt;

&lt;p&gt;I suggest to use the &lt;tt&gt;nexus-staging-maven-plugin&lt;/tt&gt; which essentially replaces the standard maven deploy plugin. It can be setup to auto-close and auto-release snapshots staging repositories. For releases, it will be setup to never auto-close nor auto-release which keeps our existing release process.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12992287">FLINK-4261</key>
            <summary>Setup atomic deployment of snapshots</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="mxm">Maximilian Michels</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Jul 2016 14:10:42 +0000</created>
                <updated>Sun, 29 Jan 2017 14:43:11 +0000</updated>
                            <resolved>Tue, 26 Jul 2016 14:50:25 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Build System</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15393836" author="githubbot" created="Tue, 26 Jul 2016 14:05:09 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2296&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4261&quot; title=&quot;Setup atomic deployment of snapshots&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4261&quot;&gt;&lt;del&gt;FLINK-4261&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tools&amp;#93;&lt;/span&gt; retry in case of failed snapshot deployment&lt;/p&gt;

&lt;p&gt;    Unfortunately, we can&apos;t deploy snapshots atomically using the Nexus&lt;br/&gt;
    repository. The staged process which leads to an atomic deployment is&lt;br/&gt;
    only designed to work for releases. Best we can do is to retry&lt;br/&gt;
    deploying artifacts in case of failures.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;introduce retry in case of failure of snapshot deployment&lt;/li&gt;
	&lt;li&gt;simplify deployment script&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4261&quot; title=&quot;Setup atomic deployment of snapshots&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4261&quot;&gt;&lt;del&gt;FLINK-4261&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2296.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2296.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2296&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit ee91c12fc0d1d0ba9c7ad29c205dc41ec9f94264&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-07-21T15:06:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4261&quot; title=&quot;Setup atomic deployment of snapshots&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4261&quot;&gt;&lt;del&gt;FLINK-4261&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tools&amp;#93;&lt;/span&gt; retry in case of failed snapshot deployment&lt;/p&gt;

&lt;p&gt;    Unfortunately, we can&apos;t deploy snapshots atomically using the Nexus&lt;br/&gt;
    repository. The staged process which leads to an atomic deployment is&lt;br/&gt;
    only designed to work for releases. Best we can do is to retry&lt;br/&gt;
    deploying artifacts in case of failures.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;introduce retry in case of failure of snapshot deployment&lt;/li&gt;
	&lt;li&gt;simplify deployment script&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="15393892" author="githubbot" created="Tue, 26 Jul 2016 14:49:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2296&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15393893" author="mxm" created="Tue, 26 Jul 2016 14:50:25 +0000"  >&lt;p&gt;Unfortunately, we can&apos;t deploy snapshots atomically using the Nexus repository. The staged process which leads to an atomic deployment is only designed to work for releases. Best we can do is to retry deploying artifacts in case of failures.&lt;/p&gt;</comment>
                            <comment id="15393894" author="mxm" created="Tue, 26 Jul 2016 14:50:46 +0000"  >&lt;p&gt;Retry via cd232e683f7aa6d7660ca2d545ba1534435e1ab1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                                        </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31glz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>