<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5836] Race condition between slot offering and task deployment</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5836</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The Flip-6 code has a race condition when offering slots to a &lt;tt&gt;JobManager&lt;/tt&gt; which directly deploys tasks to the offered slots. In such a situation it is possible that the deploy call overtakes the acknowledge message for the slot offering. As a result, the slots are not marked yet as active and the deployment will fail.&lt;/p&gt;

&lt;p&gt;I propose to fix this problem by first activating all offered slots before sending the slot offer message to the &lt;tt&gt;JobManager&lt;/tt&gt;. Consequently, we&apos;ll deactivate and free slots which haven&apos;t been accepted by the &lt;tt&gt;JobManager&lt;/tt&gt; once we&apos;ve received the offering acknowledge message.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13043996">FLINK-5836</key>
            <summary>Race condition between slot offering and task deployment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wenlong.lwl">Wenlong Lyu</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                            <label>flip-6</label>
                    </labels>
                <created>Fri, 17 Feb 2017 13:39:14 +0000</created>
                <updated>Wed, 22 Feb 2017 14:46:58 +0000</updated>
                            <resolved>Wed, 22 Feb 2017 14:46:32 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15873399" author="sleepy" created="Sun, 19 Feb 2017 01:49:53 +0000"  >&lt;p&gt;+1&lt;br/&gt;
I think we have encountered this problem.&lt;br/&gt;
If nobody is working on this, I&apos;ll take it.&lt;/p&gt;</comment>
                            <comment id="15874613" author="till.rohrmann" created="Mon, 20 Feb 2017 14:38:57 +0000"  >&lt;p&gt;Great to hear &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=SleePy&quot; class=&quot;user-hover&quot; rel=&quot;SleePy&quot;&gt;SleePy&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15875234" author="sleepy" created="Tue, 21 Feb 2017 02:07:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wenlong.lwl&quot; class=&quot;user-hover&quot; rel=&quot;wenlong.lwl&quot;&gt;wenlong.lwl&lt;/a&gt; has already been working on it, reassign to him.&lt;/p&gt;</comment>
                            <comment id="15875280" author="githubbot" created="Tue, 21 Feb 2017 02:59:00 +0000"  >&lt;p&gt;GitHub user wenlong88 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5836&quot; title=&quot;Race condition between slot offering and task deployment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5836&quot;&gt;&lt;del&gt;FLINK-5836&lt;/del&gt;&lt;/a&gt; Fix race condition between offer slot and submit task&lt;/p&gt;

&lt;p&gt;    The solution is the same as what till described in jira: activating the slots when reserving them on `TaskExecutor` before offering to `JobManager`&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/wenlong88/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/wenlong88/flink&lt;/a&gt; jira-5836&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3371.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3371.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3371&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 35042f29e055a7f83b7c4d79e4c72673711dfd78&lt;br/&gt;
Author: wenlong.lwl &amp;lt;wenlong.lwl@alibaba-inc.com&amp;gt;&lt;br/&gt;
Date:   2017-01-06T08:32:08Z&lt;/p&gt;

&lt;p&gt;    Fix race condition between offer slot and submit task&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15875560" author="githubbot" created="Tue, 21 Feb 2017 08:02:52 +0000"  >&lt;p&gt;Github user wenlong88 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    hi @tillrohrmann, the CI is failing because of my changes, could you help take a look it. &lt;/p&gt;</comment>
                            <comment id="15878195" author="githubbot" created="Wed, 22 Feb 2017 13:24:49 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Btw: The failing travis build is due to exceeding the build time.&lt;/p&gt;</comment>
                            <comment id="15878358" author="till.rohrmann" created="Wed, 22 Feb 2017 14:46:32 +0000"  >&lt;p&gt;Fixed via d6aed38b3a15946d383d762030b5f5c1418388de&lt;/p&gt;</comment>
                            <comment id="15878359" author="githubbot" created="Wed, 22 Feb 2017 14:46:58 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3371&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3a8nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>