<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:33:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-9156] CLI does not respect -m,--jobmanager option</title>
                <link>https://issues.apache.org/jira/browse/FLINK-9156</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;b&gt;Description&lt;/b&gt;&lt;br/&gt;
The CLI does not respect the &lt;tt&gt;-m, --jobmanager&lt;/tt&gt; option. For example submitting a job using &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;bin/flink run -m 172.31.35.68:6123 [...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;results in the client trying to connect to what is specified in &lt;tt&gt;flink-conf.yaml&lt;/tt&gt; (&lt;tt&gt;jobmanager.rpc.address, jobmanager.rpc.port&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Stacktrace&lt;/b&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;------------------------------------------------------------
 The program finished with the following exception:

org.apache.flink.client.program.ProgramInvocationException: Could not submit job 99b0a48ec5cb4086740b1ffd38efd1af.
	at org.apache.flink.client.program.rest.RestClusterClient.submitJob(RestClusterClient.java:244)
	at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:464)
	at org.apache.flink.client.program.DetachedEnvironment.finalizeExecute(DetachedEnvironment.java:77)
	at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:410)
	at org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:780)
	at org.apache.flink.client.cli.CliFrontend.runProgram(CliFrontend.java:274)
	at org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:209)
	at org.apache.flink.client.cli.CliFrontend.parseParameters(CliFrontend.java:1019)
	at org.apache.flink.client.cli.CliFrontend.lambda$main$9(CliFrontend.java:1095)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1836)
	at org.apache.flink.runtime.security.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)
	at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1095)
Caused by: org.apache.flink.runtime.client.JobSubmissionException: Failed to submit JobGraph.
	at org.apache.flink.client.program.rest.RestClusterClient.lambda$submitJob$4(RestClusterClient.java:351)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:870)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:852)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474)
	at java.util.concurrent.CompletableFuture.postFire(CompletableFuture.java:561)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:929)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.CompletionException: org.apache.flink.util.FlinkException: Could not upload job jar files.
	at org.apache.flink.client.program.rest.RestClusterClient.lambda$submitJob$2(RestClusterClient.java:326)
	at java.util.concurrent.CompletableFuture.biApply(CompletableFuture.java:1105)
	at java.util.concurrent.CompletableFuture$BiApply.tryFire(CompletableFuture.java:1070)
	... 7 more
Caused by: org.apache.flink.util.FlinkException: Could not upload job jar files.
	... 10 more
Caused by: java.io.IOException: Could not connect to BlobServer at address /127.0.0.1:41909
	at org.apache.flink.runtime.blob.BlobClient.&amp;lt;init&amp;gt;(BlobClient.java:124)
	at org.apache.flink.runtime.blob.BlobClient.uploadJarFiles(BlobClient.java:547)
	at org.apache.flink.client.program.rest.RestClusterClient.lambda$submitJob$2(RestClusterClient.java:324)
	... 9 more
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at java.net.Socket.connect(Socket.java:538)
	at org.apache.flink.runtime.blob.BlobClient.&amp;lt;init&amp;gt;(BlobClient.java:118)
	... 11 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;1.5 RC1&lt;/p&gt;</environment>
        <key id="13151607">FLINK-9156</key>
            <summary>CLI does not respect -m,--jobmanager option</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="gjy">Gary Yao</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Apr 2018 10:01:08 +0000</created>
                <updated>Mon, 16 Apr 2018 19:21:49 +0000</updated>
                            <resolved>Mon, 16 Apr 2018 19:21:49 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>Command Line Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16433690" author="mingleizhang" created="Wed, 11 Apr 2018 10:20:12 +0000"  >&lt;p&gt;Yes. We should make the CLI as the first choose, can not use the &lt;tt&gt;jobmanager.rpc.address&lt;/tt&gt; in &lt;tt&gt;flink-conf.yaml&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16433736" author="githubbot" created="Wed, 11 Apr 2018 11:03:43 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9156&quot; title=&quot;CLI does not respect -m,--jobmanager option&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9156&quot;&gt;&lt;del&gt;FLINK-9156&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;CLI&amp;#93;&lt;/span&gt; Update --jobmanager option logic for REST client&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;What is the purpose of the change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;    With this PR the `--jobmanager` option is properly respected by the `RestClusterClient`. The problem was that the existing code was only setting `JobManagerOptions.ADDRESS` and `JobManagerOptions.PORT`, but not the corresponding `RestOptions` that are used for all REST API calls. The `RestOptions` are accessed in`HighAvailabilityServicesUtils#createHighAvailabilityServices` to create the webmonitor URL that is used by the client.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Brief change log&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul&gt;
	&lt;li&gt;set appropriate RestOptions in `CliFrontend#setJobManagerAddressInConfig`&lt;/li&gt;
	&lt;li&gt;add test&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Verifying this change&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul&gt;
	&lt;li&gt;run `RestClusterClientTest#testRESTManualConfigurationOverride`&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Does this pull request potentially affect one of the following parts:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Dependencies (does it add or upgrade a dependency): (no)&lt;/li&gt;
	&lt;li&gt;The public API, i.e., is any changed class annotated with `@Public(Evolving)`: (no)&lt;/li&gt;
	&lt;li&gt;The serializers: (no)&lt;/li&gt;
	&lt;li&gt;The runtime per-record code paths (performance sensitive): (no)&lt;/li&gt;
	&lt;li&gt;Anything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)&lt;/li&gt;
	&lt;li&gt;The S3 file system connector: (no)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;Documentation&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does this pull request introduce a new feature? (no)&lt;/li&gt;
	&lt;li&gt;If yes, how is the feature documented? (not applicable)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 9156&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5838&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 661c313fcb4b5f4b4d5b31d52b4d9637a081035e&lt;br/&gt;
Author: zentol &amp;lt;chesnay@...&amp;gt;&lt;br/&gt;
Date:   2018-04-11T10:48:51Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-9156&quot; title=&quot;CLI does not respect -m,--jobmanager option&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-9156&quot;&gt;&lt;del&gt;FLINK-9156&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;CLI&amp;#93;&lt;/span&gt; Update --jobmanager option logic for REST client&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16435870" author="githubbot" created="Thu, 12 Apr 2018 16:26:19 +0000"  >&lt;p&gt;Github user GJL commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838#discussion_r181140084&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838#discussion_r181140084&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-clients/src/test/java/org/apache/flink/client/program/rest/RestClusterClientTest.java &amp;#8212;&lt;br/&gt;
    @@ -677,6 +682,37 @@ public void testGetAccumulators() throws Exception {&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Tests that command line options override the configuration settings.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testRESTManualConfigurationOverride() throws Exception {&lt;br/&gt;
    +		final String localhost = &quot;localhost&quot;;&lt;br/&gt;
    +		final int port = 1234;&lt;br/&gt;
    +		final Configuration configuration = new Configuration();&lt;br/&gt;
    +&lt;br/&gt;
    +		configuration.setString(JobManagerOptions.ADDRESS, localhost);&lt;br/&gt;
    +		configuration.setInteger(JobManagerOptions.PORT, port);&lt;br/&gt;
    +		configuration.setString(RestOptions.REST_ADDRESS, localhost);&lt;br/&gt;
    +		configuration.setInteger(RestOptions.REST_PORT, port);&lt;br/&gt;
    +&lt;br/&gt;
    +		final DefaultCLI defaultCLI = new DefaultCLI(configuration);&lt;br/&gt;
    +&lt;br/&gt;
    +		final String manualHostname = &quot;123.123.123.123&quot;;&lt;br/&gt;
    +		final int manualPort = 4321;&lt;br/&gt;
    +		final String[] args = &lt;/p&gt;
{&quot;-m&quot;, manualHostname + &apos;:&apos; + manualPort}
&lt;p&gt;;&lt;br/&gt;
    +&lt;br/&gt;
    +		CommandLine commandLine = defaultCLI.parseCommandLineOptions(args, false);&lt;br/&gt;
    +&lt;br/&gt;
    +		final StandaloneClusterDescriptor clusterDescriptor = defaultCLI.createClusterDescriptor(commandLine);&lt;br/&gt;
    +&lt;br/&gt;
    +		final RestClusterClient&amp;lt;?&amp;gt; clusterClient = clusterDescriptor.retrieve(defaultCLI.getClusterId(commandLine));&lt;br/&gt;
    +&lt;br/&gt;
    +		URL webMonitorBaseUrl = clusterClient.getWebMonitorBaseUrl().get();&lt;br/&gt;
    +		assertThat(webMonitorBaseUrl.getHost(), Matchers.equalTo(manualHostname));&lt;br/&gt;
    +		assertThat(webMonitorBaseUrl.getPort(), Matchers.equalTo(manualPort));&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    There is already a static import for `equalTo` in this file. I think it should be used, i.e.,&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    assertThat(webMonitorBaseUrl.getHost(), equalTo(manualHostname));&lt;br/&gt;
    assertThat(webMonitorBaseUrl.getPort(), equalTo(manualPort));&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="16435871" author="githubbot" created="Thu, 12 Apr 2018 16:26:20 +0000"  >&lt;p&gt;Github user GJL commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838#discussion_r181141707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838#discussion_r181141707&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-clients/src/test/java/org/apache/flink/client/program/rest/RestClusterClientTest.java &amp;#8212;&lt;br/&gt;
    @@ -677,6 +682,37 @@ public void testGetAccumulators() throws Exception {&lt;br/&gt;
     		}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Tests that command line options override the configuration settings.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@Test&lt;br/&gt;
    +	public void testRESTManualConfigurationOverride() throws Exception {&lt;br/&gt;
    +		final String localhost = &quot;localhost&quot;;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Maybe `configuredHostname`, to be consistent with `manualHostname`. `localhost` is an arbitrary value, and should not be the name of the variable.&lt;/p&gt;</comment>
                            <comment id="16439126" author="githubbot" created="Mon, 16 Apr 2018 08:34:44 +0000"  >&lt;p&gt;Github user zentol commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merging.&lt;/p&gt;</comment>
                            <comment id="16439898" author="githubbot" created="Mon, 16 Apr 2018 19:20:06 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5838&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5838&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16439906" author="zentol" created="Mon, 16 Apr 2018 19:21:49 +0000"  >&lt;p&gt;master: 4f0fa0b3f992da4474e2703a54a8445cf1e29856&lt;br/&gt;
1.5: 47909f466b9c9ee1f4caf94e9f6862a21b628817&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ser3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>