<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:09:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-26018] Unnecessary late events when using the new KafkaSource</title>
                <link>https://issues.apache.org/jira/browse/FLINK-26018</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;There is an issue with the new KafkaSource connector in Flink 1.14: when one task consumes messages from multiple topic partitions (statically created, timestamp are in order), it may start with one partition and advances watermarks before the data from other partitions come. In this case, the early messages in other partitions may unnecessarily be considered &#160;as late ones.&lt;/p&gt;

&lt;p&gt;I discussed with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=renqs&quot; class=&quot;user-hover&quot; rel=&quot;renqs&quot;&gt;renqs&lt;/a&gt;, it seems that the new KafkaSource only adds a partition into &lt;tt&gt;WatermarkMultiplexer&lt;/tt&gt; when it receives data from that partition. In contrast, FlinkKafkaConsumer adds all known partition before it fetch any data.&#160;&lt;/p&gt;

&lt;p&gt;Attached two files:&#160;the messages in Kafka and the corresponding TM logs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13427277">FLINK-26018</key>
            <summary>Unnecessary late events when using the new KafkaSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="qinjunjerry">Jun Qin</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 8 Feb 2022 20:37:16 +0000</created>
                <updated>Thu, 31 Mar 2022 07:02:06 +0000</updated>
                            <resolved>Thu, 31 Mar 2022 06:56:47 +0000</resolved>
                                    <version>1.14.3</version>
                    <version>1.14.4</version>
                                    <fixVersion>1.14.5</fixVersion>
                    <fixVersion>1.15.0</fixVersion>
                                    <component>Connectors / Common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="17489333" author="martijnvisser" created="Wed, 9 Feb 2022 08:04:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qinjunjerry&quot; class=&quot;user-hover&quot; rel=&quot;qinjunjerry&quot;&gt;qinjunjerry&lt;/a&gt; Just to double check, is this only a problem in Flink 1.14 or also in earlier version like 1.13?&#160;&lt;/p&gt;</comment>
                            <comment id="17489358" author="qinjunjerry" created="Wed, 9 Feb 2022 08:39:19 +0000"  >&lt;p&gt;I haven&apos;t tried with 1.13.&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=renqs&quot; class=&quot;user-hover&quot; rel=&quot;renqs&quot;&gt;renqs&lt;/a&gt;&#160;could you comment?&lt;/p&gt;</comment>
                            <comment id="17490823" author="renqs" created="Fri, 11 Feb 2022 10:27:36 +0000"  >&lt;p&gt;This issue exists for all sources extending SourceReaderBase, so I think KafkaSource in 1.13 also has this problem.&lt;/p&gt;

&lt;p&gt;A solution in my mind is that we can create per-split output for a split once it&apos;s assigned to the source operator. For splits assigned before the main reader output is created (before the first &lt;tt&gt;SourceOperator#emitNext&lt;/tt&gt; invocation), we can use a list to hold them temporarily in SourceOperator and create per-split outputs when the main output is ready.&#160;&lt;/p&gt;</comment>
                            <comment id="17494539" author="pnowojski" created="Fri, 18 Feb 2022 10:48:22 +0000"  >&lt;p&gt;I believe solution to this problem and &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21781&quot; title=&quot;Lookup Table based on rowkey ranges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21781&quot;&gt;&lt;del&gt;FLINK-21781&lt;/del&gt;&lt;/a&gt; (about broadcasting watermarks) might need to be considered together.&lt;/p&gt;</comment>
                            <comment id="17494621" author="danderson" created="Fri, 18 Feb 2022 13:59:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt; Perhaps you meant &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21871&quot; title=&quot;Support watermark for Hive and Filesystem streaming source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21871&quot;&gt;FLINK-21871&lt;/a&gt; rather than &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21781&quot; title=&quot;Lookup Table based on rowkey ranges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21781&quot;&gt;&lt;del&gt;FLINK-21781&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17494672" author="pnowojski" created="Fri, 18 Feb 2022 15:26:21 +0000"  >&lt;p&gt;Yes &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=danderson&quot; class=&quot;user-hover&quot; rel=&quot;danderson&quot;&gt;danderson&lt;/a&gt;, you are right. Thanks for spotting the typo. &lt;/p&gt;</comment>
                            <comment id="17502163" author="pnowojski" created="Mon, 7 Mar 2022 09:16:42 +0000"  >&lt;p&gt;After an offline discussion we agreed for my team to take this over to try to fix it before 1.15.0 release.&lt;/p&gt;</comment>
                            <comment id="17515110" author="renqs" created="Thu, 31 Mar 2022 06:56:47 +0000"  >&lt;p&gt;Fixed on master: b9593715f35640154615df0098ac7459f37911c3&lt;/p&gt;

&lt;p&gt;release-1.15: c71582d5837b067f26f8aec610193bacf6ccb26b&lt;/p&gt;

&lt;p&gt;release-1.14: 65047113eceefd377df7017b6b8d553dda9a8758&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13366300">FLINK-21871</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13039789" name="message in kafka.txt" size="49099" author="qinjunjerry" created="Tue, 8 Feb 2022 20:35:43 +0000"/>
                            <attachment id="13039788" name="taskmanager_10.28.0.131_33249-b3370c_log" size="386091" author="qinjunjerry" created="Tue, 8 Feb 2022 20:35:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zde0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>