<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:25:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-4933] ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph</title>
                <link>https://issues.apache.org/jira/browse/FLINK-4933</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Currently the &lt;tt&gt;ExecutionGraph.scheduleOrUpdateConsumers&lt;/tt&gt; can fail the whole &lt;tt&gt;ExecutionGraph&lt;/tt&gt; if it cannot find the corresponding &lt;tt&gt;Execution&lt;/tt&gt;. This situation can occur in the restarting scenario where we have a late callback trying to update its consumers. In this case, the call should forward the exception back to the caller and not fail the &lt;tt&gt;ExecutionGraph&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13015395">FLINK-4933</key>
            <summary>ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="trohrmann">Till Rohrmann</assignee>
                                    <reporter username="trohrmann">Till Rohrmann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Oct 2016 12:04:59 +0000</created>
                <updated>Tue, 1 Nov 2016 13:08:07 +0000</updated>
                            <resolved>Mon, 31 Oct 2016 18:27:21 +0000</resolved>
                                    <version>1.1.3</version>
                    <version>1.2.0</version>
                                    <fixVersion>1.1.4</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15611364" author="githubbot" created="Thu, 27 Oct 2016 09:46:24 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4933&quot; title=&quot;ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4933&quot;&gt;&lt;del&gt;FLINK-4933&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;exec graph&amp;#93;&lt;/span&gt; Don&apos;t let the EG fail in case of a failing scheduleOrUpdateConsumers call&lt;/p&gt;

&lt;p&gt;    Instead of failing the complete ExecutionGraph, a failing scheduleOrUpdateConsumers call&lt;br/&gt;
    will be reported back to the caller. The caller can then decide what to do. Per default,&lt;br/&gt;
    it will fail the calling task.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; fixScheduleOrUpdateConsumers&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2700&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e51f0a56762c7f12acc215a53ffce2af28d38583&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-10-27T09:41:29Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4933&quot; title=&quot;ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4933&quot;&gt;&lt;del&gt;FLINK-4933&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;exec graph&amp;#93;&lt;/span&gt; Don&apos;t let the EG fail in case of a failing scheduleOrUpdateConsumers call&lt;/p&gt;

&lt;p&gt;    Instead of failing the complete ExecutionGraph, a failing scheduleOrUpdateConsumers call&lt;br/&gt;
    will be reported back to the caller. The caller can then decide what to do. Per default,&lt;br/&gt;
    it will fail the calling task.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15611564" author="githubbot" created="Thu, 27 Oct 2016 11:14:35 +0000"  >&lt;p&gt;GitHub user tillrohrmann opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;backport&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4933&quot; title=&quot;ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4933&quot;&gt;&lt;del&gt;FLINK-4933&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;exec graph&amp;#93;&lt;/span&gt; Don&apos;t let the EG fail in case of a failing scheduleOrUpdateConsumers call&lt;/p&gt;

&lt;p&gt;    This is a backport for the release-1.1 branch. The only thing adapted is the added test case.&lt;/p&gt;

&lt;p&gt;    Instead of failing the complete ExecutionGraph, a failing scheduleOrUpdateConsumers call&lt;br/&gt;
    will be reported back to the caller. The caller can then decide what to do. Per default,&lt;br/&gt;
    it will fail the calling task.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tillrohrmann/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tillrohrmann/flink&lt;/a&gt; backportFixScheduleOrUpdateConsumers&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2701&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b17fada0e60ad9986680c89effa628944973d999&lt;br/&gt;
Author: Till Rohrmann &amp;lt;trohrmann@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-10-27T09:41:29Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-4933&quot; title=&quot;ExecutionGraph.scheduleOrUpdateConsumers can fail the ExecutionGraph&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-4933&quot;&gt;&lt;del&gt;FLINK-4933&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;exec graph&amp;#93;&lt;/span&gt; Don&apos;t let the EG fail in case of a failing scheduleOrUpdateConsumers call&lt;/p&gt;

&lt;p&gt;    Instead of failing the complete ExecutionGraph, a failing scheduleOrUpdateConsumers call&lt;br/&gt;
    will be reported back to the caller. The caller can then decide what to do. Per default,&lt;br/&gt;
    it will fail the calling task.&lt;/p&gt;

&lt;p&gt;    Adapt TaskManagerTest&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15615486" author="githubbot" created="Fri, 28 Oct 2016 13:56:24 +0000"  >&lt;p&gt;Github user uce commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700#discussion_r85533357&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700#discussion_r85533357&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/scala/org/apache/flink/runtime/jobmanager/JobManager.scala &amp;#8212;&lt;br/&gt;
    @@ -917,8 +917,15 @@ class JobManager(&lt;br/&gt;
         case ScheduleOrUpdateConsumers(jobId, partitionId) =&amp;gt;&lt;br/&gt;
           currentJobs.get(jobId) match {&lt;br/&gt;
             case Some((executionGraph, _)) =&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;sender ! decorateMessage(Acknowledge)&lt;/li&gt;
	&lt;li&gt;executionGraph.scheduleOrUpdateConsumers(partitionId)&lt;br/&gt;
    +          try 
{
    +            executionGraph.scheduleOrUpdateConsumers(partitionId)
    +            sender ! decorateMessage(Acknowledge)
    +          }
&lt;p&gt; catch {&lt;br/&gt;
    +            case e: ExecutionGraphException =&amp;gt;&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Does it make sense to catch the more generic `Exception` type here in order to make the sender notice any problems sooner? I see that the method only throws EGExceptions currently but maybe at some point in time someone introduces a runtime exception etc. This would only be logged at the JM and the task&apos;s ask would timeout.&lt;/p&gt;</comment>
                            <comment id="15621570" author="githubbot" created="Mon, 31 Oct 2016 08:10:04 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the review @uce. This is a problem which is relevant for the current master. It could make the `ExecutionGraph` go into state `FAILED` when being in state `RESTARTING` in case that the `scheduleOrUpdateConsumers` call failed. &lt;/p&gt;

&lt;p&gt;    Will rebase the PR because it was based on the failing `SpanningRecordSerializerTest`.&lt;/p&gt;</comment>
                            <comment id="15621577" author="githubbot" created="Mon, 31 Oct 2016 08:13:35 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Will rebase, because this PR is based on the release-1.1 branch which contained the failing `SpanningRecordSerializerTest`.&lt;/p&gt;</comment>
                            <comment id="15622419" author="githubbot" created="Mon, 31 Oct 2016 15:09:33 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good to me, +1&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="15622443" author="githubbot" created="Mon, 31 Oct 2016 15:17:44 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good, +1&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="15622930" author="githubbot" created="Mon, 31 Oct 2016 18:18:27 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2700&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15622952" author="stephanewen" created="Mon, 31 Oct 2016 18:27:22 +0000"  >&lt;p&gt;Fixed in &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.2.0 via 649f9578bce56e118ec973218271262286c534a9&lt;/li&gt;
	&lt;li&gt;1.1.4 via d941b50db4c58c7ea3d5c1d888d34ea8975407e0&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15625387" author="githubbot" created="Tue, 1 Nov 2016 13:08:06 +0000"  >&lt;p&gt;Github user tillrohrmann commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Has been merged to the release branch 1.1.&lt;/p&gt;</comment>
                            <comment id="15625388" author="githubbot" created="Tue, 1 Nov 2016 13:08:07 +0000"  >&lt;p&gt;Github user tillrohrmann closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2701&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35eyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>