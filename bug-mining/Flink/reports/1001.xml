<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3994] Instable KNNITSuite</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3994</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;KNNITSuite fails in Travis-CI with following error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply$mcV$sp(JobManager.scala:806)
  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply(JobManager.scala:752)
  at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$handleMessage$1$$anonfun$applyOrElse$7.apply(JobManager.scala:752)
  at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)
  at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)
  at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:41)
  at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(AbstractDispatcher.scala:401)
  at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
  at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.pollAndExecAll(ForkJoinPool.java:1253)
  at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1346)
  ...
  Cause: java.io.IOException: Insufficient number of network buffers: required 32, but only 4 available. The total number of network buffers is currently set to 2048. You can increase &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; number by setting the configuration key &lt;span class=&quot;code-quote&quot;&gt;&apos;taskmanager.network.numberOfBuffers&apos;&lt;/span&gt;.
  at org.apache.flink.runtime.io.network.buffer.NetworkBufferPool.createBufferPool(NetworkBufferPool.java:196)
  at org.apache.flink.runtime.io.network.NetworkEnvironment.registerTask(NetworkEnvironment.java:327)
  at org.apache.flink.runtime.taskmanager.Task.run(Task.java:497)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
  ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064237/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064237/log.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064236/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064236/log.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064235/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134064235/log.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134052961/log.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s3.amazonaws.com/archive.travis-ci.org/jobs/134052961/log.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12974169">FLINK-3994</key>
            <summary>Instable KNNITSuite</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chiwanpark">Chiwan Park</assignee>
                                    <reporter username="chiwanpark">Chiwan Park</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Tue, 31 May 2016 09:42:01 +0000</created>
                <updated>Wed, 2 Oct 2019 17:44:22 +0000</updated>
                            <resolved>Wed, 1 Jun 2016 01:27:39 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Library / Machine Learning</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15307535" author="uce" created="Tue, 31 May 2016 10:15:47 +0000"  >&lt;p&gt;Thanks for looking into this. Are you working on this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chiwanpark&quot; class=&quot;user-hover&quot; rel=&quot;chiwanpark&quot;&gt;chiwanpark&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mxm&quot; class=&quot;user-hover&quot; rel=&quot;mxm&quot;&gt;mxm&lt;/a&gt;? Both of commented on the mailing list. Would be great if one of you assigns himself so we can fix this soon. If you don&apos;t have time, I can also look into it.&lt;/p&gt;</comment>
                            <comment id="15307537" author="chiwanpark" created="Tue, 31 May 2016 10:17:39 +0000"  >&lt;p&gt;I&apos;m looking into this issue. I&apos;ve assigned myself.&lt;/p&gt;</comment>
                            <comment id="15307607" author="mxm" created="Tue, 31 May 2016 11:44:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chiwanpark&quot; class=&quot;user-hover&quot; rel=&quot;chiwanpark&quot;&gt;chiwanpark&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15307691" author="githubbot" created="Tue, 31 May 2016 13:03:14 +0000"  >&lt;p&gt;GitHub user chiwanpark opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3994&quot; title=&quot;Instable KNNITSuite&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3994&quot;&gt;&lt;del&gt;FLINK-3994&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ml, tests&amp;#93;&lt;/span&gt; Fix flaky KNN integration tests&lt;/p&gt;

&lt;p&gt;    This PR is related to flaky KNN integration tests. The problem is caused by sharing `ExecutionEnvironment` between test cases. I&apos;m not sure about exact reason. This PR makes each test case have own `ExecutionEnvironment`. Tests on my local machine and my Travis-CI &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; is passed with this PR.&lt;/p&gt;

&lt;p&gt;    I have some doubt because this is not essential fix for the problem. AFAIK and @StephanEwen said, sharing `ExecutionEnvironment` should be supported. Addtionally, `mvn clean verify` has passed without this PR on my local machine.&lt;/p&gt;

&lt;p&gt;    If there are any other opinions, please leave comment.&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://travis-ci.org/chiwanpark/flink/builds/134104491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/chiwanpark/flink/builds/134104491&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    p.s. we need to re-write commit message.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/chiwanpark/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/chiwanpark/flink&lt;/a&gt; hotfix-ml-test&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2056&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a47ae8481bcbac2c490386089ee6b1e740f3a1f4&lt;br/&gt;
Author: Chiwan Park &amp;lt;chiwanpark@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-05-31T08:50:05Z&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;hotfix&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ml&amp;#93;&lt;/span&gt; Fix flaky KNN integration tests&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15307721" author="githubbot" created="Tue, 31 May 2016 13:31:43 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m not sure whether the changes fix the problem. I think you were lucky with the build machine on Travis &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; The issue on Travis is that the `ExecutionEnvironment` defaults to using the number of cores reported by `Runtime.getRuntime().availableProcessors()` as task slots. On Travis this can be `32`. We need to adjust the number of network buffers correctly. In addition, setting an upper limit for the parallelism for tests would also make sense.&lt;/p&gt;</comment>
                            <comment id="15307800" author="githubbot" created="Tue, 31 May 2016 14:31:19 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for guide @mxm. I&apos;ll set upper limit for the parallelism to 4.&lt;/p&gt;</comment>
                            <comment id="15307852" author="githubbot" created="Tue, 31 May 2016 14:58:28 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The limit should be set to 4 by the test tools already. I think the issue may be that the Execution Environment was prior to Chiwan&apos;s change acquired before the context was properly set by the test tool superclass.&lt;/p&gt;</comment>
                            <comment id="15307859" author="githubbot" created="Tue, 31 May 2016 15:02:31 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    It is a bit tricky to understand what happens when with these tests using stacked traits...&lt;/p&gt;</comment>
                            <comment id="15307899" author="githubbot" created="Tue, 31 May 2016 15:18:22 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    There is actually a problem with the way the Scala Tests are written:&lt;/p&gt;

&lt;p&gt;    The code in the class that is outside the &quot;it should&quot; clauses is executed before the &quot;before&quot; function. That is why the tests go against a LocalEnvironment, rather than the test context environment.&lt;/p&gt;

&lt;p&gt;    So Chiwan&apos;s patch will actually fix it, only for different reasons than initially expected.&lt;/p&gt;</comment>
                            <comment id="15307904" author="githubbot" created="Tue, 31 May 2016 15:20:50 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for clarifying @StephanEwen! I&apos;ll merge this after Travis succeed.&lt;/p&gt;</comment>
                            <comment id="15309017" author="githubbot" created="Wed, 1 Jun 2016 01:23:09 +0000"  >&lt;p&gt;Github user chiwanpark commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging...&lt;/p&gt;</comment>
                            <comment id="15309020" author="githubbot" created="Wed, 1 Jun 2016 01:26:04 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15309021" author="chiwanpark" created="Wed, 1 Jun 2016 01:27:39 +0000"  >&lt;p&gt;Fixed via aedc0fd481a756ef2b1708f896d5500475715232.&lt;/p&gt;

&lt;p&gt;Thanks for guidance &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sewen&quot; class=&quot;user-hover&quot; rel=&quot;sewen&quot;&gt;sewen&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mxm&quot; class=&quot;user-hover&quot; rel=&quot;mxm&quot;&gt;mxm&lt;/a&gt;! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15309941" author="githubbot" created="Wed, 1 Jun 2016 08:40:01 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/2056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for fixing!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yq9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>