<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:29:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-6965] Avro is missing snappy dependency</title>
                <link>https://issues.apache.org/jira/browse/FLINK-6965</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The shading rework made before 1.3 removed a snappy dependency that was accidentally pulled in through hadoop. This is technically alright, until class-loaders rear their ugly heads.&lt;/p&gt;

&lt;p&gt;Our kafka connector can read avro records, which may or may not require snappy. Usually this &lt;em&gt;should&lt;/em&gt; be solvable by including the snappy dependency in the user-jar if necessary, however since the kafka connector loads classes that it requires using the system class loader this doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;As such we have to add a separate snappy dependency to flink-core.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13081431">FLINK-6965</key>
            <summary>Avro is missing snappy dependency</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chesnay">Chesnay Schepler</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Jun 2017 13:53:00 +0000</created>
                <updated>Wed, 2 Oct 2019 17:49:06 +0000</updated>
                            <resolved>Wed, 12 Jul 2017 15:21:17 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.2</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16057665" author="githubbot" created="Wed, 21 Jun 2017 15:10:35 +0000"  >&lt;p&gt;GitHub user zentol opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    {&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6965&quot; title=&quot;Avro is missing snappy dependency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6965&quot;&gt;&lt;del&gt;FLINK-6965&lt;/del&gt;&lt;/a&gt;] Include snappy-java in flink-dist&lt;/p&gt;

&lt;p&gt;    This PR adds removes the snappy dependency exclusion from flink-core.&lt;/p&gt;

&lt;p&gt;    Without this dependency Flink components that work with avro, and thus potentially snappy, fail when loading snappy. This also happens if snappy is provided in the user-jar since the flink component doesn&apos;t use the user class loader.&lt;/p&gt;

&lt;p&gt;    To prevent this dependency from being removed again in the future by accident i modified `checkShadedArtifacts()` function in the travis scripts to check for the presence of the dependency.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zentol/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zentol/flink&lt;/a&gt; 6965&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4160&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f0e757776c45382cfc28daefe321d819d5a4a75c&lt;br/&gt;
Author: zentol &amp;lt;chesnay@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-06-21T14:18:34Z&lt;/p&gt;

&lt;p&gt;    {&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-6965&quot; title=&quot;Avro is missing snappy dependency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-6965&quot;&gt;&lt;del&gt;FLINK-6965&lt;/del&gt;&lt;/a&gt;] Include snappy-java in flink-dist&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16057789" author="githubbot" created="Wed, 21 Jun 2017 16:26:00 +0000"  >&lt;p&gt;Github user tzulitai commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160#discussion_r123298637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160#discussion_r123298637&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -79,13 +79,12 @@ under the License.&lt;br/&gt;
     		&amp;lt;dependency&amp;gt;&lt;br/&gt;
     			&amp;lt;groupId&amp;gt;org.apache.avro&amp;lt;/groupId&amp;gt;&lt;br/&gt;
     			&amp;lt;artifactId&amp;gt;avro&amp;lt;/artifactId&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;!-- managed version --&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;exclusions&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;exclusion&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;groupId&amp;gt;org.xerial.snappy&amp;lt;/groupId&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;artifactId&amp;gt;snappy-java&amp;lt;/artifactId&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/exclusion&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/exclusions&amp;gt;&lt;br/&gt;
    +		&amp;lt;/dependency&amp;gt;&lt;br/&gt;
    +&lt;br/&gt;
    +		&amp;lt;!-- We explicitly depend on snappy since connectors that require it load it through the system class loader --&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Side question: is a fix also required for connectors to correctly use the user classloader in such cases?&lt;/p&gt;</comment>
                            <comment id="16058056" author="githubbot" created="Wed, 21 Jun 2017 19:17:27 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160#discussion_r123341447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160#discussion_r123341447&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-core/pom.xml &amp;#8212;&lt;br/&gt;
    @@ -79,13 +79,12 @@ under the License.&lt;br/&gt;
     		&amp;lt;dependency&amp;gt;&lt;br/&gt;
     			&amp;lt;groupId&amp;gt;org.apache.avro&amp;lt;/groupId&amp;gt;&lt;br/&gt;
     			&amp;lt;artifactId&amp;gt;avro&amp;lt;/artifactId&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;!-- managed version --&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;exclusions&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;exclusion&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;groupId&amp;gt;org.xerial.snappy&amp;lt;/groupId&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;artifactId&amp;gt;snappy-java&amp;lt;/artifactId&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/exclusion&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/exclusions&amp;gt;&lt;br/&gt;
    +		&amp;lt;/dependency&amp;gt;&lt;br/&gt;
    +&lt;br/&gt;
    +		&amp;lt;!-- We explicitly depend on snappy since connectors that require it load it through the system class loader --&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    for the avro/snappy case, no. This PR should work as is.&lt;/p&gt;</comment>
                            <comment id="16062426" author="githubbot" created="Sun, 25 Jun 2017 21:29:58 +0000"  >&lt;p&gt;Github user packet23 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160#discussion_r123909436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160#discussion_r123909436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: tools/travis_mvn_watchdog.sh &amp;#8212;&lt;br/&gt;
    @@ -182,6 +182,13 @@ check_shaded_artifacts() {&lt;br/&gt;
     		exit 1&lt;br/&gt;
     	fi&lt;/p&gt;

&lt;p&gt;    +	SNAPPY=`cat allClasses | grep &apos;^org/xerial/snappy&apos; | wc -l`&lt;br/&gt;
    +	if [ AVRO == &quot;0&quot; ]; then&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Should it not read&lt;br/&gt;
    ```bash&lt;br/&gt;
    if [ $SNAPPY == &quot;0&quot; ]; then&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;bail out&lt;br/&gt;
    fi&lt;br/&gt;
    ```&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16062865" author="githubbot" created="Mon, 26 Jun 2017 10:01:30 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160#discussion_r123971846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160#discussion_r123971846&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: tools/travis_mvn_watchdog.sh &amp;#8212;&lt;br/&gt;
    @@ -182,6 +182,13 @@ check_shaded_artifacts() {&lt;br/&gt;
     		exit 1&lt;br/&gt;
     	fi&lt;/p&gt;

&lt;p&gt;    +	SNAPPY=`cat allClasses | grep &apos;^org/xerial/snappy&apos; | wc -l`&lt;br/&gt;
    +	if [ AVRO == &quot;0&quot; ]; then&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    yes! nice catch...&lt;/p&gt;</comment>
                            <comment id="16071454" author="packet" created="Sun, 2 Jul 2017 00:24:26 +0000"  >&lt;p&gt;flink-avro connector for DataSet API is also affected: Snappy-encoded avro datasets can neither be read nor written using AvroInputFormat/AvroOutputFormat. Flink runtime built from PR also fixes this.&lt;/p&gt;</comment>
                            <comment id="16081993" author="githubbot" created="Tue, 11 Jul 2017 10:02:34 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1&lt;/p&gt;

&lt;p&gt;    Please merge this for `master` and `release-1.3`.&lt;/p&gt;</comment>
                            <comment id="16082625" author="zentol" created="Tue, 11 Jul 2017 17:46:04 +0000"  >&lt;p&gt;1.4: 021d27d54960bedd58b00e89f7898a34f3991336&lt;/p&gt;</comment>
                            <comment id="16082629" author="githubbot" created="Tue, 11 Jul 2017 17:46:35 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/4160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/4160&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16083738" author="aljoscha" created="Wed, 12 Jul 2017 10:04:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chesnay&quot; class=&quot;user-hover&quot; rel=&quot;chesnay&quot;&gt;chesnay&lt;/a&gt; what&apos;s the plan for merging this to the release-1.3 branch as well and closing this (release blocking) issue?&lt;/p&gt;</comment>
                            <comment id="16083759" author="zentol" created="Wed, 12 Jul 2017 10:15:22 +0000"  >&lt;p&gt;I&apos;ll merge it today.&lt;/p&gt;</comment>
                            <comment id="16084127" author="zentol" created="Wed, 12 Jul 2017 15:21:17 +0000"  >&lt;p&gt;1.3: aaa7df55ceb741ca4dd886e8816ddbab58afb078&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3gjqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>