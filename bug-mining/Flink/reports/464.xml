<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:20:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-2235] Local Flink cluster allocates too much memory</title>
                <link>https://issues.apache.org/jira/browse/FLINK-2235</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;When executing a Flink job locally, the task manager gets initialized with an insane amount of memory. After a quick look in the code it seems that the call to &lt;tt&gt;EnvironmentInformation.getSizeOfFreeHeapMemoryWithDefrag()&lt;/tt&gt; returns a wrong estimate of the heap memory size.&lt;/p&gt;

&lt;p&gt;Moreover, the same user switched to Oracle JDK 1.8 and that made the error disappear. So I&apos;m guessing this is some Java 1.6 quirk.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Oracle JDK: 1.6.0_65-b14-462&lt;br/&gt;
Eclipse&lt;/p&gt;</environment>
        <key id="12838464">FLINK-2235</key>
            <summary>Local Flink cluster allocates too much memory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mxm">Maximilian Michels</assignee>
                                    <reporter username="mxm">Maximilian Michels</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jun 2015 13:00:55 +0000</created>
                <updated>Sun, 29 Jan 2017 14:42:27 +0000</updated>
                            <resolved>Thu, 3 Sep 2015 09:59:35 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9.2</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14589768" author="mxm" created="Wed, 17 Jun 2015 13:37:19 +0000"  >&lt;p&gt;I managed to get my hands on some logs:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;15:21:43,802 INFO  org.apache.flink.api.java.ExecutionEnvironment                - The job has 0 registered types and 0 default Kryo serializers
15:21:44,605 INFO  akka.event.slf4j.Slf4jLogger                                  - Slf4jLogger started
15:21:44,648 INFO  org.apache.flink.runtime.blob.BlobServer                      - Created BLOB server storage directory /var/folders/v7/kbtg426s74x7d45n8t6d9mndcy9g9w/T/blobStore-1c50a0b6-d71d-4f87-a849-c5b4cd88fb97
15:21:44,658 INFO  org.apache.flink.runtime.blob.BlobServer                      - Started BLOB server at 0.0.0.0:51747 - max concurrent requests: 50 - max backlog: 1000
15:21:44,703 INFO  org.apache.flink.runtime.jobmanager.JobManager                - Starting JobManager at akka://flink/user/jobmanager#-557612298.
15:21:44,714 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Messages between TaskManager and JobManager have a max timeout of 100000 milliseconds
15:21:44,725 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Temporary file directory &apos;/var/folders/v7/kbtg426s74x7d45n8t6d9mndcy9g9w/T&apos;: total 232 GB, usable 101 GB (43.53% usable)
15:21:44,824 INFO  org.apache.flink.runtime.io.network.buffer.NetworkBufferPool  - Allocated 64 MB for network buffer pool (number of memory segments: 2048, bytes per segment: 32768).
15:21:44,826 INFO  org.apache.flink.runtime.taskmanager.TaskManager              - Using 17592186044414 MB for Flink managed memory.
Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Size of total memory must be positive.
    at org.apache.flink.runtime.memorymanager.DefaultMemoryManager.&amp;lt;init&amp;gt;(DefaultMemoryManager.java:110)
    at org.apache.flink.runtime.taskmanager.TaskManager$.startTaskManagerComponentsAndActor(TaskManager.scala:1423)
    at org.apache.flink.runtime.minicluster.LocalFlinkMiniCluster.startTaskManager(LocalFlinkMiniCluster.scala:121)
    at org.apache.flink.runtime.minicluster.FlinkMiniCluster$$anonfun$1.apply(FlinkMiniCluster.scala:86)
    at org.apache.flink.runtime.minicluster.FlinkMiniCluster$$anonfun$1.apply(FlinkMiniCluster.scala:79)
    at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)
    at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)
    at scala.collection.immutable.Range.foreach(Range.scala:141)
    at scala.collection.TraversableLike$class.map(TraversableLike.scala:244)
    at scala.collection.AbstractTraversable.map(Traversable.scala:105)
    at org.apache.flink.runtime.minicluster.FlinkMiniCluster.&amp;lt;init&amp;gt;(FlinkMiniCluster.scala:79)
    at org.apache.flink.runtime.minicluster.LocalFlinkMiniCluster.&amp;lt;init&amp;gt;(LocalFlinkMiniCluster.scala:45)
    at org.apache.flink.runtime.minicluster.LocalFlinkMiniCluster.&amp;lt;init&amp;gt;(LocalFlinkMiniCluster.scala:52)
    at org.apache.flink.client.LocalExecutor.start(LocalExecutor.java:112)
    at org.apache.flink.client.LocalExecutor.executePlan(LocalExecutor.java:165)
    at org.apache.flink.api.java.LocalEnvironment.execute(LocalEnvironment.java:54)
    at org.apache.flink.api.java.ExecutionEnvironment.execute(ExecutionEnvironment.java:789)
    at org.apache.flink.api.java.DataSet.collect(DataSet.java:408)
    at org.apache.flink.api.java.DataSet.print(DataSet.java:1346)
    at org.apache.flink.quickstart.WordCount.main(WordCount.java:67)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14590464" author="vkalavri" created="Wed, 17 Jun 2015 20:01:02 +0000"  >&lt;p&gt;We ran into the same issue today at the training.&lt;br/&gt;
Setting the memory manually in Eclipse VM arguments and switching to Java 8 worked as workarounds.&lt;/p&gt;</comment>
                            <comment id="14593008" author="rmetzger" created="Fri, 19 Jun 2015 04:59:06 +0000"  >&lt;p&gt;If I recall correctly, the community decided to drop Java 1.6 support after the 0.9 release.&lt;br/&gt;
Maybe it is time to bring up that discussion again and close this issue as invalid &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14593202" author="mxm" created="Fri, 19 Jun 2015 08:45:23 +0000"  >&lt;p&gt;Yes, that would be smart &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Although not supporting Java 6 after the release still means that it is an issue in 0.9.0 and can be fixed in a minor release.&lt;/p&gt;</comment>
                            <comment id="14594861" author="rmetzger" created="Sat, 20 Jun 2015 23:00:05 +0000"  >&lt;p&gt;I agree. Lets fix this one for OracleJDK 6 (if it is not causing too much trouble)&lt;/p&gt;</comment>
                            <comment id="14596099" author="mxm" created="Mon, 22 Jun 2015 15:42:02 +0000"  >&lt;p&gt;Actually, I think the explanation is simple. The doc string for Runtime.maxMemory():&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     * Returns the maximum amount of memory that the Java virtual machine will
     * attempt to use.  If there is no inherent limit then the value {@link
     * java.lang.Long#MAX_VALUE} will be returned.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it returned &lt;tt&gt;Long.MAX_VALUE&lt;/tt&gt; because it found &quot;no inherent limit&quot;. As a quick fix, I would simply check if the returned value is equal to &lt;tt&gt;Long.MAX_VALUE&lt;/tt&gt; and then simply use &lt;tt&gt;Runtime.freeMemory()&lt;/tt&gt; instead of &lt;tt&gt;Runtime.maxMemory() - Runtime.totalMemory() + Runtime.freeMemory()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14596102" author="stephanewen" created="Mon, 22 Jun 2015 15:45:15 +0000"  >&lt;p&gt;Sounds like a good way to fix this...&lt;/p&gt;</comment>
                            <comment id="14596111" author="githubbot" created="Mon, 22 Jun 2015 15:51:49 +0000"  >&lt;p&gt;GitHub user mxm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2235&quot; title=&quot;Local Flink cluster allocates too much memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2235&quot;&gt;&lt;del&gt;FLINK-2235&lt;/del&gt;&lt;/a&gt; fix calculation of free memory for local execution&lt;/p&gt;

&lt;p&gt;    The Java runtime may return Long.MAX_VALUE for a call to the maxMemory()&lt;br/&gt;
    method of the Runtime class. In these cases, we simply use the value&lt;br/&gt;
    returned by freeMemory().&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mxm/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mxm/flink&lt;/a&gt; too-much-memory&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #859&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 97a1f697ac2270d6b1c6c4b98ef1eadd10b5a815&lt;br/&gt;
Author: Maximilian Michels &amp;lt;mxm@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-06-22T15:47:11Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-2235&quot; title=&quot;Local Flink cluster allocates too much memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-2235&quot;&gt;&lt;del&gt;FLINK-2235&lt;/del&gt;&lt;/a&gt; fix calculation of free memory for local execution&lt;/p&gt;

&lt;p&gt;    The Java runtime may return Long.MAX_VALUE for a call to the maxMemory()&lt;br/&gt;
    method of the Runtime class. In these cases, we simply use the value&lt;br/&gt;
    returned by freeMemory().&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14596228" author="githubbot" created="Mon, 22 Jun 2015 17:00:03 +0000"  >&lt;p&gt;Github user uce commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r32957111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r32957111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I haven&apos;t tested this yet, but I think this &lt;span class=&quot;error&quot;&gt;&amp;#91;will not work&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://stackoverflow.com/questions/12807797/java-get-available-memory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/12807797/java-get-available-memory&lt;/a&gt;), because `freeMemory` returns to the free memory from the currently allocated memory. The JVM allocates memory in chunks. Free memory refers to how much of these allocated chunks is free.&lt;/p&gt;</comment>
                            <comment id="14597339" author="githubbot" created="Tue, 23 Jun 2015 08:29:44 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r33019549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r33019549&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    You&apos;re right. For a simple WordCount it works but for anything advanced, this will fail with &quot;Too few memory segments provided&quot;.&lt;/p&gt;</comment>
                            <comment id="14597349" author="githubbot" created="Tue, 23 Jun 2015 08:40:34 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r33020328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r33020328&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We could fall back to a conservative value and print a warning that the memory has to be set manually. To set the memory manually, the user has to go through the LocalExecutor which is not a nice out of the box experience.&lt;/p&gt;</comment>
                            <comment id="14597602" author="githubbot" created="Tue, 23 Jun 2015 12:49:54 +0000"  >&lt;p&gt;Github user uce commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r33036608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r33036608&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    OK, I think the problem is that Xmx is not set. In this case maxMemory returns Long.MAX_VALUE.&lt;/p&gt;</comment>
                            <comment id="14597603" author="githubbot" created="Tue, 23 Jun 2015 12:51:12 +0000"  >&lt;p&gt;Github user mxm commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r33036711&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r33036711&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yes, exactly. Like discussed in the JIRA issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14597614" author="githubbot" created="Tue, 23 Jun 2015 12:57:55 +0000"  >&lt;p&gt;Github user uce commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#discussion_r33037235&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#discussion_r33037235&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-runtime/src/main/java/org/apache/flink/runtime/util/EnvironmentInformation.java &amp;#8212;&lt;br/&gt;
    @@ -137,7 +137,13 @@ public static long getSizeOfFreeHeapMemoryWithDefrag() {&lt;br/&gt;
     	 */&lt;br/&gt;
     	public static long getSizeOfFreeHeapMemory() {&lt;br/&gt;
     		Runtime r = Runtime.getRuntime();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return r.maxMemory() - r.totalMemory() + r.freeMemory();&lt;br/&gt;
    +		long maxMemory = r.maxMemory();&lt;br/&gt;
    +		if (maxMemory == Long.MAX_VALUE) {&lt;br/&gt;
    +			// workaround for some JVM versions&lt;br/&gt;
    +			return r.freeMemory();
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    OK, didn&apos;t see it yesterday. Maybe we can play around with &lt;span class=&quot;error&quot;&gt;&amp;#91;MemoryUsage&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/lang/management/MemoryUsage.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/7/docs/api/java/lang/management/MemoryUsage.html&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="14602601" author="githubbot" created="Fri, 26 Jun 2015 09:11:56 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-115594116&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-115594116&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I found a fix for the Oracle JVM (the only known JVM with this problem). We call a proprietary method and fail on other JDKs with a nice exception message. @uce What do you think? &lt;/p&gt;</comment>
                            <comment id="14618618" author="githubbot" created="Wed, 8 Jul 2015 13:53:59 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-119586674&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-119586674&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Is this value actually accurate? It assumes that the JVM can grow to occupy the entire available main memory.&lt;br/&gt;
    Is that the case?&lt;/p&gt;</comment>
                            <comment id="14620163" author="githubbot" created="Thu, 9 Jul 2015 09:13:53 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-119883278&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-119883278&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Typically, programs can allocate as much memory as they like. We only take a fraction of the free physical memory for the manged memory. We could also take only half of the physical memory. Or, alternatively, fail with an exception that the maximum memory for the JVM is not set (-Xmx is missing). In my opinion, it is ok to take a fraction of the physical memory for local execution.&lt;/p&gt;</comment>
                            <comment id="14620197" author="githubbot" created="Thu, 9 Jul 2015 09:41:12 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-119891011&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-119891011&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Okay, from skimming over some Oracle docs, it seems the default max heap is 1/4 of the physical memory. Let&apos;s use that.&lt;/p&gt;</comment>
                            <comment id="14620538" author="githubbot" created="Thu, 9 Jul 2015 14:00:52 +0000"  >&lt;p&gt;Github user mxm commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-119987554&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-119987554&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    1/4 of the physical memory seems sensible and indeed returns almost the same memory size as the maximum memory setting on my machine. I&apos;ve adapted the pull request.&lt;/p&gt;</comment>
                            <comment id="14624697" author="githubbot" created="Mon, 13 Jul 2015 14:16:44 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859#issuecomment-120942293&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859#issuecomment-120942293&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Looks good. Merging this with a modification of the tests that they permit the runtime exception in some cases.&lt;/p&gt;</comment>
                            <comment id="14624943" author="stephanewen" created="Mon, 13 Jul 2015 16:57:28 +0000"  >&lt;p&gt;Fixed via 910e8c438477f27c6d20392d00dd0cfbe8496c8b and b0b0cb50d63e2f831196fc9219858467a07d8302&lt;/p&gt;</comment>
                            <comment id="14626514" author="githubbot" created="Tue, 14 Jul 2015 15:45:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/859&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/859&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14728789" author="mxm" created="Thu, 3 Sep 2015 09:59:17 +0000"  >&lt;p&gt;Fix also in 0.9.2. &lt;/p&gt;</comment>
                            <comment id="14728792" author="mxm" created="Thu, 3 Sep 2015 10:01:40 +0000"  >&lt;p&gt;Pushed also to the release 0.9 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g5jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>