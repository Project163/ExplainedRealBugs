<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:48:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-15467] Should wait for the end of the source thread during the Task cancellation</title>
                <link>https://issues.apache.org/jira/browse/FLINK-15467</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&#160; &#160; &#160;In the new mailBox model, SourceStreamTask starts a source thread to run user methods, and the current execution thread will block on mailbox.takeMail (). When a task cancels, the TaskCanceler thread will cancel the task and interrupt the execution thread. Therefore, the execution thread of SourceStreamTask will throw InterruptedException, then cancel the task again, and throw an exception.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;@Override
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void performDefaultAction(ActionContext context) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
   &lt;span class=&quot;code-comment&quot;&gt;// Against the usual contract of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; implementation is not step-wise but blocking instead &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
&lt;/span&gt;   &lt;span class=&quot;code-comment&quot;&gt;// compatibility reasons with the current source &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; (source functions run as a loop, not in steps).
&lt;/span&gt;   sourceThread.start();

   &lt;span class=&quot;code-comment&quot;&gt;// We run an alternative mailbox loop that does not involve &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; actions and synchronizes around actions.
&lt;/span&gt;   &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      runAlternativeMailboxLoop();
   } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception mailboxEx) {
      &lt;span class=&quot;code-comment&quot;&gt;// We cancel the source function &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; some runtime exception escaped the mailbox.
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isCanceled()) {
         cancelTask();
      }
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; mailboxEx;
   }

   sourceThread.join();
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isFinished) {
      sourceThread.checkThrowSourceExecutionException();
   }

   context.allActionsCompleted();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160; &#160;When all tasks of this TaskExecutor are canceled, the blob file will be cleaned up. But the real source thread is not finished at this time, which will cause a ClassNotFoundException when loading a new class. In this case, the source thread may not be able to properly clean up and release resources (such as closing child threads, cleaning up local files, etc.). Therefore, I think we should mark this task canceled or finished after the execution of the source thread is completed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13277326">FLINK-15467</key>
            <summary>Should wait for the end of the source thread during the Task cancellation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="Ming Li">Ming Li</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 3 Jan 2020 08:41:44 +0000</created>
                <updated>Tue, 22 Jun 2021 13:55:44 +0000</updated>
                            <resolved>Wed, 16 Sep 2020 19:22:19 +0000</resolved>
                                    <version>1.9.0</version>
                    <version>1.9.1</version>
                    <version>1.10.1</version>
                                    <fixVersion>1.10.3</fixVersion>
                    <fixVersion>1.11.2</fixVersion>
                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Task</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="17020179" author="pnowojski" created="Tue, 21 Jan 2020 12:18:15 +0000"  >&lt;p&gt;Could you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt; elaborate what&apos;s the problem? Which method invocations? Also this code has changed quite a lot, so is this issue still valid in the current master?&lt;/p&gt;</comment>
                            <comment id="17123726" author="ming li" created="Tue, 2 Jun 2020 12:37:29 +0000"  >&lt;p&gt;Hi&#65292;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;.I try to use the latest release version (1.10.1), and the same problem exists: when the job is canceled, I try to load certain classes, but the jar package file has been cleared. Therefore, I think we still need to wait for the sourceThread to complete before clearing the jar file.&lt;/p&gt;</comment>
                            <comment id="17123730" author="ming li" created="Tue, 2 Jun 2020 12:41:57 +0000"  >&lt;p&gt;Below is my test code&#65306;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//&#20195;&#30721;&#21344;&#20301;&#31526;
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.flink.test;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.streaming.api.functions.sink.DiscardingSink;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.flink.streaming.api.functions.source.ParallelSourceFunction;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.slf4j.Logger;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.slf4j.LoggerFactory;

/**
 * Created by liming on 2020/6/2.
 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestJobClean {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Logger logger = LoggerFactory.getLogger(TestLoad.class);

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
        env.addSource(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CustomSource())
                .addSink(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DiscardingSink&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;());
        env.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;testJobCancel&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomSource &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ParallelSourceFunction&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Logger logger = LoggerFactory.getLogger(CustomSource.class);
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; running = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void run(SourceContext&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; sourceContext) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (running) {
                    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000);
                    sourceContext.collect(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;);
                }
            } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(3000); &lt;span class=&quot;code-comment&quot;&gt;//Simulate preparatory work
&lt;/span&gt;                } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {
                    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(3000); &lt;span class=&quot;code-comment&quot;&gt;//Simulate preparatory work
&lt;/span&gt;                }
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                    logger.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to load clean class&quot;&lt;/span&gt;);
                    &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-quote&quot;&gt;&quot;com.flink.test.TestLoad&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to load some &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; clean
&lt;/span&gt;                    logger.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;load clean &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;success&quot;&lt;/span&gt;);
                } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
                    logger.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;load clean &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;failed&quot;&lt;/span&gt;, e);
                }

            }
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void cancel() {
            running = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The logs are as follows&#65306;&lt;br/&gt;
2020-06-02 20:34:24,368 INFO org.apache.flink.runtime.taskmanager.Task - Attempting to cancel task Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e).&lt;br/&gt;
2020-06-02 20:34:24,369 INFO org.apache.flink.runtime.taskmanager.Task - Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e) switched from RUNNING to CANCELING.&lt;br/&gt;
2020-06-02 20:34:24,369 INFO org.apache.flink.runtime.taskmanager.Task - Triggering cancellation of task code Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e).&lt;br/&gt;
2020-06-02 20:34:24,371 INFO org.apache.flink.runtime.taskmanager.Task - Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e) switched from CANCELING to CANCELED.&lt;br/&gt;
2020-06-02 20:34:24,371 INFO org.apache.flink.runtime.taskmanager.Task - Freeing task resources for Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e).&lt;br/&gt;
2020-06-02 20:34:24,372 INFO org.apache.flink.runtime.taskmanager.Task - Ensuring all FileSystem streams are closed for task Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) (10ee411efd563d83214fd6f947dcad1e) &lt;span class=&quot;error&quot;&gt;&amp;#91;CANCELED&amp;#93;&lt;/span&gt;&lt;br/&gt;
2020-06-02 20:34:24,373 INFO org.apache.flink.runtime.taskexecutor.TaskExecutor - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Custom Source -&amp;gt; Sink: Unnamed (1/1) 10ee411efd563d83214fd6f947dcad1e.&lt;br/&gt;
2020-06-02 20:34:24,383 INFO org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl - Free slot TaskSlot(index:0, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1.0000000000000000, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: e42db2155c2aa58e98c1dce598ecb7f5, jobId: 36242552141952de9bc8f3867f9d6f6d).&lt;br/&gt;
2020-06-02 20:34:24,383 INFO org.apache.flink.runtime.taskexecutor.JobLeaderService - Remove job 36242552141952de9bc8f3867f9d6f6d from job leader monitoring.&lt;br/&gt;
2020-06-02 20:34:24,384 INFO org.apache.flink.runtime.taskexecutor.TaskExecutor - Close JobManager connection for job 36242552141952de9bc8f3867f9d6f6d.&lt;br/&gt;
2020-06-02 20:34:24,386 INFO org.apache.flink.runtime.taskexecutor.TaskExecutor - Close JobManager connection for job 36242552141952de9bc8f3867f9d6f6d.&lt;br/&gt;
2020-06-02 20:34:24,387 INFO org.apache.flink.runtime.taskexecutor.JobLeaderService - Cannot reconnect to job 36242552141952de9bc8f3867f9d6f6d because it is not registered.&lt;br/&gt;
2020-06-02 20:34:27,375 INFO com.flink.test.TestJobClean$CustomSource - try to load clean class&lt;br/&gt;
2020-06-02 20:34:27,376 ERROR com.flink.test.TestJobClean$CustomSource - load clean class failed&lt;br/&gt;
java.lang.ClassNotFoundException: com.flink.test.TestLoad&lt;br/&gt;
&#160;&#160;&#160;&#160;at java.net.URLClassLoader.findClass(URLClassLoader.java:381)&lt;br/&gt;
&#160;&#160;&#160;&#160;at java.lang.ClassLoader.loadClass(ClassLoader.java:424)&lt;br/&gt;
&#160;&#160;&#160;&#160;at org.apache.flink.util.ChildFirstClassLoader.loadClass(ChildFirstClassLoader.java:69)&lt;br/&gt;
&#160;&#160;&#160;&#160;at java.lang.ClassLoader.loadClass(ClassLoader.java:357)&lt;br/&gt;
&#160;&#160;&#160;&#160;at java.lang.Class.forName0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;at java.lang.Class.forName(Class.java:264)&lt;br/&gt;
&#160;&#160;&#160;&#160;at com.flink.test.TestJobClean$CustomSource.run(TestJobClean.java:40)&lt;br/&gt;
&#160;&#160;&#160;&#160;at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:100)&lt;br/&gt;
&#160;&#160;&#160;&#160;at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:63)&lt;br/&gt;
&#160;&#160;&#160;&#160;at org.apache.flink.streaming.runtime.tasks.SourceStreamTask$LegacySourceFunctionThread.run(SourceStreamTask.java:200)&lt;/p&gt;</comment>
                            <comment id="17124822" author="pnowojski" created="Wed, 3 Jun 2020 10:12:51 +0000"  >&lt;p&gt;Thanks for coming back and providing a way to reproduce the problem. I haven&apos;t run your code, but it looks like you are right. I&apos;m not entirely sure how to fix this from the top of my head, someone would have to investigate this further.&lt;/p&gt;

&lt;p&gt;Also the problem might be a bit more profound and solution should take into an account operators spawning custom threads as well.&lt;/p&gt;</comment>
                            <comment id="17138723" author="roman_khachatryan" created="Wed, 17 Jun 2020 18:44:42 +0000"  >&lt;p&gt;I tried to run the program above with some corrections (to stop the job after some elements and load other classes).&lt;/p&gt;

&lt;p&gt;I&#160;&#160;couldn&apos;t reproduce the issue: the class was loaded successfully after stopping all services.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt;, are you running it on a cluster and then stopping via JM?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If yes, I think this is what I think is happening in your case:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Job is canceled in JM&lt;/li&gt;
	&lt;li&gt;JM sends RPC to TM to cancel the task&lt;/li&gt;
	&lt;li&gt;TM calls Task.cancelExecution which starts TaskCanceler and TaskInterrupter&lt;/li&gt;
	&lt;li&gt;Source thread ignores the interrupt&lt;/li&gt;
	&lt;li&gt;Main task thread proceeds to finally block in Task.doRun, where it calls cancelInvokable and notifyFinalState &amp;gt;&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;gt;&amp;gt; TaskExecutor.unregisterTaskAndNotifyFinalState &amp;gt; taskSlotTable.removeTask &amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;gt;&amp;gt; TaskExecutor.closeJobManagerConnectionIfNoAllocatedResources, which called&lt;br/&gt;
closeJob &amp;gt; BlobLibraryCacheManager.release&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;If this is the case, then just joining the&#160;source thread inside cancelInvokable would solve the problem (specifically, in SourceStreamTask.cancelTask).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;SourceStreamTask.cancelTask is called from:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;RPC notification about checkpoint completion - fine, done asynchronously&lt;/li&gt;
	&lt;li&gt;TaskCanceller - can delay subsequent&#160;networkResourcesCloser.run() - which is probably also fine&lt;/li&gt;
	&lt;li&gt;Task.cancelInvokable - what we want&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17138977" author="ming li" created="Thu, 18 Jun 2020 03:14:27 +0000"  >&lt;p&gt;Hi,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt;,In my test, I ran my test code in a standalone cluster. After running, I directly clicked cancel on the webUI to trigger a cancel process. In the test code, simulating soucethread may take a lot of time to clean up, so I try to sleep for 3 seconds and then load a class that has not been loaded by jvm. At this time, the above exception will occur.&lt;/p&gt;

&lt;p&gt;I have tried not to sleep and then load a new class, this problem will not occur, I think this is because the cleaning of BlobLibrary has not been completed.&lt;/p&gt;

&lt;p&gt;I also think we should join the source thread in SourceStreamTask.cancelTask to fix this problem.&lt;/p&gt;</comment>
                            <comment id="17139948" author="roman_khachatryan" created="Thu, 18 Jun 2020 19:49:03 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt;, thanks for the clarification!&lt;/p&gt;

&lt;p&gt;I was able to reproduce the issue and will submit a PR to fix it.&lt;/p&gt;</comment>
                            <comment id="17167259" author="pnowojski" created="Wed, 29 Jul 2020 14:24:33 +0000"  >&lt;p&gt;Merged to master 61d06ace57, to release-1.11 1dee87ae58. Not backporting to release-1.10 due to conflicts and low impact of this bug.&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt; for fixing and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt; for reporting!&lt;/p&gt;</comment>
                            <comment id="17168520" author="ming li" created="Fri, 31 Jul 2020 08:35:40 +0000"  >&lt;p&gt;Thanks for this fix. I want to correct the cause of this problem: it is not that the blob file is deleted, but that the userClassloader will be closed when the task ends. Later, when trying to use this classloader to load a class (when the classloader is not specified, the classloader of the caller class will be used), a ClassNotFoundException will be thrown.&lt;/p&gt;</comment>
                            <comment id="17168528" author="pnowojski" created="Fri, 31 Jul 2020 08:43:21 +0000"  >&lt;p&gt;That was also our understanding &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt;. Either way the problem should be gone as &lt;tt&gt;SourceStreamTask&lt;/tt&gt; wouldn&apos;t finish until &lt;tt&gt;sourceThread&lt;/tt&gt; is done and life cycle of the Task&apos;s class loader is bound to the Task&apos;s life. &lt;/p&gt;</comment>
                            <comment id="17168532" author="roman_khachatryan" created="Fri, 31 Jul 2020 08:47:14 +0000"  >&lt;p&gt;Thanks for the clarification &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Ming+Li&quot; class=&quot;user-hover&quot; rel=&quot;Ming Li&quot;&gt;Ming Li&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I think the fix covers this case too. In fact, I&#160; checked it manually and it fixed the problem.&#160;But of course, a double check from your side would be highly appreciated.&lt;/p&gt;</comment>
                            <comment id="17192936" author="qinjunjerry" created="Wed, 9 Sep 2020 15:14:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pnowojski&quot; class=&quot;user-hover&quot; rel=&quot;pnowojski&quot;&gt;pnowojski&lt;/a&gt;&#160;as discussed, could you please back port this fix to Flink 1.10 as it is impacting Flink 1.10 customers.&lt;/p&gt;</comment>
                            <comment id="17197200" author="arvid" created="Wed, 16 Sep 2020 19:21:39 +0000"  >&lt;p&gt;Merged to release-1.10 a20fb4a796d8df91e4ebbcdc0b35cdd75145c574.&lt;/p&gt;</comment>
                            <comment id="17197216" author="qinjunjerry" created="Wed, 16 Sep 2020 20:07:09 +0000"  >&lt;p&gt;Great! Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=AHeise&quot; class=&quot;user-hover&quot; rel=&quot;AHeise&quot;&gt;AHeise&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0a5ns:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>