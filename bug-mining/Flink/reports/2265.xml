<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:32:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-8807] ZookeeperCompleted checkpoint store can get stuck in infinite loop</title>
                <link>https://issues.apache.org/jira/browse/FLINK-8807</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;This code: &lt;a href=&quot;https://github.com/apache/flink/blob/9071e3befb8c279f73c3094c9f6bddc0e7cce9e5/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCompletedCheckpointStore.java#L201&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/blob/9071e3befb8c279f73c3094c9f6bddc0e7cce9e5/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCompletedCheckpointStore.java#L201&lt;/a&gt; can be stuck forever if at least one checkpoint is not readable because &lt;tt&gt;CompletedCheckpoint&lt;/tt&gt; does not have a proper &lt;tt&gt;equals()&lt;/tt&gt;/&lt;tt&gt;hashCode()&lt;/tt&gt; anymore.&lt;/p&gt;

&lt;p&gt;We have to fix this and also add a unit test that verifies the loop still works if we make one snapshot unreadable.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13141502">FLINK-8807</key>
            <summary>ZookeeperCompleted checkpoint store can get stuck in infinite loop</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aljoscha">Aljoscha Krettek</assignee>
                                    <reporter username="aljoscha">Aljoscha Krettek</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Feb 2018 11:26:33 +0000</created>
                <updated>Mon, 12 Mar 2018 15:55:19 +0000</updated>
                            <resolved>Mon, 12 Mar 2018 15:55:19 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.3.3</fixVersion>
                    <fixVersion>1.4.3</fixVersion>
                    <fixVersion>1.5.0</fixVersion>
                                    <component>Runtime / State Backends</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16383803" author="githubbot" created="Fri, 2 Mar 2018 16:51:21 +0000"  >&lt;p&gt;GitHub user aljoscha opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8807&quot; title=&quot;ZookeeperCompleted checkpoint store can get stuck in infinite loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8807&quot;&gt;&lt;del&gt;FLINK-8807&lt;/del&gt;&lt;/a&gt; Fix ZookeeperCompleted checkpoint store can get stuck in infinite loop&lt;/p&gt;

&lt;p&gt;    Before, CompletedCheckpoint did not have proper equals()/hashCode(),&lt;br/&gt;
    which meant that the fixpoint condition in&lt;br/&gt;
    ZooKeeperCompletedCheckpointStore would never hold if at least on&lt;br/&gt;
    checkpoint became unreadable.&lt;/p&gt;

&lt;p&gt;    This adds proper equals()/hashCode() to CompletedCheckpoint and extends&lt;br/&gt;
    the test to properly create new CompletedCheckpoints. Before, we were&lt;br/&gt;
    reusing the same CompletedCheckpoint instances, meaning that&lt;br/&gt;
    Objects.equals()/hashCode() would make the test succeed.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/aljoscha/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/aljoscha/flink&lt;/a&gt; jira-8807-zookeeper-fix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #5623&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 777ddb57ee72d200d1312dc8e6dfdb52af6b9950&lt;br/&gt;
Author: Aljoscha Krettek &amp;lt;aljoscha.krettek@...&amp;gt;&lt;br/&gt;
Date:   2018-03-02T16:46:56Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-8807&quot; title=&quot;ZookeeperCompleted checkpoint store can get stuck in infinite loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-8807&quot;&gt;&lt;del&gt;FLINK-8807&lt;/del&gt;&lt;/a&gt; Fix ZookeeperCompleted checkpoint store can get stuck in infinite loop&lt;/p&gt;

&lt;p&gt;    Before, CompletedCheckpoint did not have proper equals()/hashCode(),&lt;br/&gt;
    which meant that the fixpoint condition in&lt;br/&gt;
    ZooKeeperCompletedCheckpointStore would never hold if at least on&lt;br/&gt;
    checkpoint became unreadable.&lt;/p&gt;

&lt;p&gt;    This adds proper equals()/hashCode() to CompletedCheckpoint and extends&lt;br/&gt;
    the test to properly create new CompletedCheckpoints. Before, we were&lt;br/&gt;
    reusing the same CompletedCheckpoint instances, meaning that&lt;br/&gt;
    Objects.equals()/hashCode() would make the test succeed.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16385001" author="githubbot" created="Sun, 4 Mar 2018 06:53:12 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @StephanEwen I&apos;ll add a test once we agree on how the comparison should be done.&lt;/p&gt;</comment>
                            <comment id="16385448" author="githubbot" created="Mon, 5 Mar 2018 00:22:07 +0000"  >&lt;p&gt;Github user StephanEwen commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I would suggest to do the comparison by checking that the list have the same checkpoint IDs.&lt;/p&gt;</comment>
                            <comment id="16386197" author="aljoscha" created="Mon, 5 Mar 2018 15:21:28 +0000"  >&lt;p&gt;Fixed on release-1.5 in&lt;br/&gt;
f8681a9d7732f6f36483e26ec68624809f6cd4b1&lt;/p&gt;

&lt;p&gt;Fixed on master in&lt;br/&gt;
4226bf22aab5b4359998422fe53755db19785515&lt;/p&gt;</comment>
                            <comment id="16386252" author="githubbot" created="Mon, 5 Mar 2018 15:52:32 +0000"  >&lt;p&gt;Github user aljoscha commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for the comments! I&apos;ll incorporate them and merge.&lt;/p&gt;</comment>
                            <comment id="16386253" author="githubbot" created="Mon, 5 Mar 2018 15:52:33 +0000"  >&lt;p&gt;Github user aljoscha closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/5623&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/5623&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16386260" author="aljoscha" created="Mon, 5 Mar 2018 15:57:41 +0000"  >&lt;p&gt;Fixed on release-1.4 in&lt;br/&gt;
64adf4bcfa387047036534059cfe361977439cca&lt;/p&gt;</comment>
                            <comment id="16387771" author="aljoscha" created="Tue, 6 Mar 2018 13:33:10 +0000"  >&lt;p&gt;Fixed on release-1.3 in&lt;br/&gt;
0069541d7bb6e5971d909b218052b30b2e718434&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qozj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>