<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3594] StreamTask may fail when checkpoint is concurrent to regular termination</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3594</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Some tests in the KafkaConsumerTestBase rely on throwing a SuccessException to stop the streaming job if the test condition is fulfilled.&lt;/p&gt;

&lt;p&gt;The job then fails, and it is checked whether the cause was a SuccessException. if so, the test is marked as a success, otherwise as a failure.&lt;/p&gt;

&lt;p&gt;However, should this exception be thrown while a checkpoint is being triggered, the exception that stop the job is not the SuccessException, but a CancelTaskException.&lt;/p&gt;

&lt;p&gt;This should affect every test that uses the SuccessException.&lt;/p&gt;

&lt;p&gt;observed here: &lt;a href=&quot;https://travis-ci.org/apache/flink/jobs/114523189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/flink/jobs/114523189&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The problem is that the exception causes the StreamTask to enter the finally block inside invoke(), which sets isRunning to false. Within triggerCheckpoint() isRunning is then checked for being false, and if so a CancelTaskException is thrown.&lt;/p&gt;

&lt;p&gt;This seems like an issue of the runtime; i observed other tests failing, without giving a good cause since the CancelTaskException masks it.&lt;/p&gt;

&lt;p&gt;I was wondering whether triggerCheckpoint() could return false instead of throwing an exception, and simply assume that an exception will be thrown within invoke().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12948374">FLINK-3594</key>
            <summary>StreamTask may fail when checkpoint is concurrent to regular termination</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sewen">Stephan Ewen</assignee>
                                    <reporter username="chesnay">Chesnay Schepler</reporter>
                        <labels>
                            <label>test-stability</label>
                    </labels>
                <created>Wed, 9 Mar 2016 11:07:07 +0000</created>
                <updated>Wed, 12 Oct 2016 17:49:33 +0000</updated>
                            <resolved>Wed, 12 Oct 2016 17:49:24 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15189899" author="stephanewen" created="Thu, 10 Mar 2016 20:33:48 +0000"  >&lt;p&gt;Chesnay almost pinned it down precisely.&lt;/p&gt;

&lt;p&gt;The actual error is that Tasks can enter a checkpoint immediately before they are done, and then set &lt;tt&gt;isRunning&lt;/tt&gt; to false while the checkpoint is in progress.&lt;br/&gt;
That leads the checkpoint method to throw a &lt;tt&gt;CancelTaskException&lt;/tt&gt; which is caught in the asynchronous checkpoint trigger, causing to mark the task as failed.&lt;/p&gt;</comment>
                            <comment id="15189912" author="stephanewen" created="Thu, 10 Mar 2016 20:46:39 +0000"  >&lt;p&gt;I have a fix for that coming up...&lt;/p&gt;</comment>
                            <comment id="15569394" author="stephanewen" created="Wed, 12 Oct 2016 17:49:26 +0000"  >&lt;p&gt;Fixed via 34110fefc6e49bcbe1ae8de090fa43a5f6ef5fec&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ueaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>