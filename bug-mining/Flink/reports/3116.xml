<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:40:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-13117] Serialize Issue when restoring from savepoint</title>
                <link>https://issues.apache.org/jira/browse/FLINK-13117</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Hi, I have one question.&lt;br/&gt;
My application should be maintained without loss of data.&lt;br/&gt;
So I use savepoint to deploy a new application.&lt;br/&gt;
&#160;&lt;br/&gt;
Normally there is no problem in restarting.&lt;br/&gt;
However, when the schema of some case classes is changed, a serialize error occurs at restart.&lt;br/&gt;
&#160;&lt;br/&gt;
How can I resolve this?&lt;br/&gt;
Flink version is 1.8.0&lt;br/&gt;
Here is the error log.&lt;br/&gt;
Thank you.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;org.apache.flink.util.StateMigrationException: The new state serializer cannot be incompatible.&lt;br/&gt;
	at org.apache.flink.contrib.streaming.state.RocksDBKeyedStateBackend.updateRestoredStateMetaInfo(RocksDBKeyedStateBackend.java:527)&lt;br/&gt;
	at org.apache.flink.contrib.streaming.state.RocksDBKeyedStateBackend.tryRegisterKvStateInformation(RocksDBKeyedStateBackend.java:475)&lt;br/&gt;
	at org.apache.flink.contrib.streaming.state.RocksDBKeyedStateBackend.createInternalState(RocksDBKeyedStateBackend.java:613)&lt;br/&gt;
	at org.apache.flink.runtime.state.KeyedStateFactory.createInternalState(KeyedStateFactory.java:47)&lt;br/&gt;
	at org.apache.flink.runtime.state.ttl.TtlStateFactory.createStateAndWrapWithTtlIfEnabled(TtlStateFactory.java:72)&lt;br/&gt;
	at org.apache.flink.runtime.state.AbstractKeyedStateBackend.getOrCreateKeyedState(AbstractKeyedStateBackend.java:286)&lt;br/&gt;
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.getOrCreateKeyedState(AbstractStreamOperator.java:568)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.operators.windowing.WindowOperator.open(WindowOperator.java:240)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.StreamTask.openAllOperators(StreamTask.java:424)&lt;br/&gt;
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:290)&lt;br/&gt;
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:711)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;
&lt;hr /&gt;</description>
                <environment></environment>
        <key id="13243338">FLINK-13117</key>
            <summary>Serialize Issue when restoring from savepoint</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sch.oh">dmgkeke</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 5 Jul 2019 10:54:02 +0000</created>
                <updated>Tue, 23 Jul 2019 09:10:28 +0000</updated>
                            <resolved>Wed, 10 Jul 2019 07:34:58 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16879588" author="yunta" created="Sat, 6 Jul 2019 04:23:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sch.oh&quot; class=&quot;user-hover&quot; rel=&quot;sch.oh&quot;&gt;sch.oh&lt;/a&gt; You could refer to &lt;a href=&quot;https://ci.apache.org/projects/flink/flink-docs-release-1.8/dev/stream/state/schema_evolution.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;state schema_evolution&lt;/a&gt; docs to know how to migrate your state when schema changed. Please note there is no guarantee that any kind of schema change could be migrated well, you&apos;d better follow the instruction in this doc to evolve your classes.&lt;/p&gt;

&lt;p&gt;Last but not least, I don&apos;t think this is a bug with your current provided information. IMO, &lt;a href=&quot;https://flink.apache.org/community.html#mailing-lists&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;user mail list&lt;/a&gt; should be a better place to ask for help.&lt;/p&gt;</comment>
                            <comment id="16881795" author="sch.oh" created="Wed, 10 Jul 2019 07:34:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yunta&quot; class=&quot;user-hover&quot; rel=&quot;yunta&quot;&gt;yunta&lt;/a&gt; Thank you for your reply.&lt;/p&gt;

&lt;p&gt;I had already read the schema evolution document. But I can&apos;t change all kinds of my classes to POJO or Avro.&lt;/p&gt;

&lt;p&gt;So I found another solution.&lt;/p&gt;

&lt;p&gt;I changed the serializer(FieldSerializer =&amp;gt;&#160;CompatibleFieldSerializer) through the ExecutionConfig.addDefaultKryoSerializer function with trait.&lt;/p&gt;

&lt;p&gt;I will end the issue.&lt;/p&gt;

&lt;p&gt;Thank you again.&lt;/p&gt;</comment>
                            <comment id="16890811" author="jark" created="Tue, 23 Jul 2019 09:10:28 +0000"  >&lt;p&gt;Note that the pull request &lt;a href=&quot;https://github.com/apache/flink/pull/9179&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#9179&lt;/a&gt; should be under &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-13337&quot; title=&quot;Do not need to backup and restore streamEnv config in BatchExecutor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-13337&quot;&gt;&lt;del&gt;FLINK-13337&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z04efc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>