<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:10:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-25238] flink iceberg source reading array types fail with Cast Exception</title>
                <link>https://issues.apache.org/jira/browse/FLINK-25238</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;I have a stream with iceberg table as a source. I have few columns of array types in the table.&#160;&lt;/p&gt;

&lt;p&gt;I try to read using iceberg connector.&#160;&lt;/p&gt;

&lt;p&gt;Flink Version : 1.13.2&lt;/p&gt;

&lt;p&gt;Iceberg Flink Version: 0.12.1&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I see the error as below.&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: class org.apache.iceberg.flink.data.FlinkParquetReaders$ReusableArrayData cannot be cast to class org.apache.flink.table.data.ColumnarArrayData (org.apache.iceberg.flink.data.FlinkParquetReaders$ReusableArrayData and org.apache.flink.table.data.ColumnarArrayData are in unnamed module of loader &apos;app&apos;)&lt;br/&gt;
&#160; &#160; at org.apache.flink.table.runtime.typeutils.ArrayDataSerializer.copy(ArrayDataSerializer.java:90)&lt;br/&gt;
&#160; &#160; at org.apache.flink.table.runtime.typeutils.ArrayDataSerializer.copy(ArrayDataSerializer.java:47)&lt;br/&gt;
&#160; &#160; at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copyRowData(RowDataSerializer.java:170)&lt;br/&gt;
&#160; &#160; at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.flink.table.runtime.typeutils.RowDataSerializer.copy(RowDataSerializer.java:48)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.CopyingChainingOutput.pushToOperator(CopyingChainingOutput.java:69)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.CopyingChainingOutput.collect(CopyingChainingOutput.java:46)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.CopyingChainingOutput.collect(CopyingChainingOutput.java:26)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:50)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:28)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.api.operators.StreamSourceContexts$ManualWatermarkContext.processAndCollect(StreamSourceContexts.java:317)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.api.operators.StreamSourceContexts$WatermarkContext.collect(StreamSourceContexts.java:411)&lt;br/&gt;
&#160; &#160; at org.apache.iceberg.flink.source.StreamingReaderOperator.processSplits(StreamingReaderOperator.java:155)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.runThrowing(StreamTaskActionExecutor.java:50)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.Mail.run(Mail.java:90)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.processMailsNonBlocking(MailboxProcessor.java:359)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.processMail(MailboxProcessor.java:323)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:202)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:681)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.executeInvoke(StreamTask.java:636)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647)&lt;br/&gt;
&#160; &#160; at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:620)&lt;br/&gt;
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:779)&lt;br/&gt;
&#160; &#160; at org.apache.flink.runtime.taskmanager.Task.run(Task.java:566)&lt;br/&gt;
&#160; &#160; at java.base/java.lang.Thread.run(Thread.java:834)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Could be same issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-21247&lt;/a&gt; except it happening for another type.&lt;/p&gt;

&lt;p&gt;I see that Iceberg use custom types other than the types from&#160;&lt;/p&gt;

&lt;p&gt;org.apache.flink.table.data like&lt;/p&gt;

&lt;p&gt;org.apache.iceberg.flink.data.FlinkParquetReaders.ReusableArrayData and these types are not handled in org.apache.flink.table.runtime.typeutils.ArrayDataSerializer&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13037223/13037223_Screen+Shot+2021-12-09+at+6.58.56+PM.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;Just to try I changed the above code to handle the iceberg type as a binary Array and built it locally and used in my application and that worked.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13037222/13037222_Screen+Shot+2021-12-09+at+7.04.10+PM.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Not sure if this is already handled in some newer versions.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13416427">FLINK-25238</key>
            <summary>flink iceberg source reading array types fail with Cast Exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gyfora">Gyula Fora</assignee>
                                    <reporter username="sr.praneeth@gmail.com">Praneeth Ramesh</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 10 Dec 2021 03:06:27 +0000</created>
                <updated>Wed, 27 Jul 2022 12:12:20 +0000</updated>
                            <resolved>Wed, 6 Apr 2022 07:21:50 +0000</resolved>
                                    <version>1.13.2</version>
                    <version>1.14.4</version>
                    <version>1.15.0</version>
                                    <fixVersion>1.16.0</fixVersion>
                                    <component>Table SQL / Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17457235" author="sjwiesman" created="Fri, 10 Dec 2021 16:03:45 +0000"  >&lt;p&gt;The Iceberg Sink is maintained by the Apache Iceberg community. I am going to close this ticket and recommend you reach out to them for assistance.&#160;&lt;/p&gt;</comment>
                            <comment id="17515682" author="yittg" created="Fri, 1 Apr 2022 03:05:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sjwiesman&quot; class=&quot;user-hover&quot; rel=&quot;sjwiesman&quot;&gt;sjwiesman&lt;/a&gt; Shall we reopen this issue. The similar issue for MapData is fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21247&quot; title=&quot;flink iceberg table map&amp;lt;string,string&amp;gt; cannot convert to datastream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-21247&quot;&gt;&lt;del&gt;FLINK-21247&lt;/del&gt;&lt;/a&gt;, and the detail is like that been explained in &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-21247?focusedCommentId=17278483&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17278483&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FLINK-21247?focusedCommentId=17278483&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17278483&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=openinx&quot; class=&quot;user-hover&quot; rel=&quot;openinx&quot;&gt;openinx&lt;/a&gt; , &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lzljs3620320&quot; class=&quot;user-hover&quot; rel=&quot;lzljs3620320&quot;&gt;lzljs3620320&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17517370" author="gyfora" created="Tue, 5 Apr 2022 10:47:40 +0000"  >&lt;p&gt;Reopening this. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sjwiesman&quot; class=&quot;user-hover&quot; rel=&quot;sjwiesman&quot;&gt;sjwiesman&lt;/a&gt; this is a bug in Flink, not in iceberg&lt;/p&gt;</comment>
                            <comment id="17517879" author="yittg" created="Wed, 6 Apr 2022 07:00:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gyfora&quot; class=&quot;user-hover&quot; rel=&quot;gyfora&quot;&gt;gyfora&lt;/a&gt; Thanks, would you mind having a look at the &lt;a href=&quot;https://github.com/apache/flink/pull/19316&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fix #19316&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17517897" author="gyfora" created="Wed, 6 Apr 2022 07:20:52 +0000"  >&lt;p&gt;Perfect, thank you&lt;/p&gt;</comment>
                            <comment id="17517899" author="gyfora" created="Wed, 6 Apr 2022 07:21:50 +0000"  >&lt;p&gt;merged to master: 99c0438253efaf0a9626a807ce2b882402a367d1&lt;/p&gt;</comment>
                            <comment id="17517901" author="gyfora" created="Wed, 6 Apr 2022 07:22:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yittg&quot; class=&quot;user-hover&quot; rel=&quot;yittg&quot;&gt;yittg&lt;/a&gt; can you also backport this to the release-1.15 branch and open a PR there too?&lt;/p&gt;</comment>
                            <comment id="17517906" author="yittg" created="Wed, 6 Apr 2022 07:33:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gyfora&quot; class=&quot;user-hover&quot; rel=&quot;gyfora&quot;&gt;gyfora&lt;/a&gt;, glad to do it. I think we should backport it to both release-1.14 and release-1.15?&lt;/p&gt;</comment>
                            <comment id="17517911" author="gyfora" created="Wed, 6 Apr 2022 07:40:12 +0000"  >&lt;p&gt;sounds good!&lt;/p&gt;</comment>
                            <comment id="17518538" author="yittg" created="Thu, 7 Apr 2022 01:47:04 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gyfora&quot; class=&quot;user-hover&quot; rel=&quot;gyfora&quot;&gt;gyfora&lt;/a&gt;, thanks for helping merging these fixes.&lt;/p&gt;

&lt;p&gt;Since release-1.15 is not released officially, I&apos;m not sure whether it is proper to add the fix to 1.13 due to the upgrade policy. What&apos;s your opinion? Will there be another fixing release for version 1.13?&lt;/p&gt;</comment>
                            <comment id="17518607" author="gyfora" created="Thu, 7 Apr 2022 06:32:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yittg&quot; class=&quot;user-hover&quot; rel=&quot;yittg&quot;&gt;yittg&lt;/a&gt; I dont really know for sure &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; If you have time we can always backport it, no harm in that&lt;/p&gt;</comment>
                            <comment id="17518728" author="martijnvisser" created="Thu, 7 Apr 2022 09:24:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yittg&quot; class=&quot;user-hover&quot; rel=&quot;yittg&quot;&gt;yittg&lt;/a&gt; I don&apos;t think there will be another 1.13 release. &lt;/p&gt;</comment>
                            <comment id="17520289" author="yittg" created="Mon, 11 Apr 2022 03:28:32 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=martijnvisser&quot; class=&quot;user-hover&quot; rel=&quot;martijnvisser&quot;&gt;martijnvisser&lt;/a&gt;, i&apos;ll close the PR for 1.13.&lt;/p&gt;</comment>
                            <comment id="17571886" author="chengbing.liu" created="Wed, 27 Jul 2022 12:12:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gyfora&quot; class=&quot;user-hover&quot; rel=&quot;gyfora&quot;&gt;gyfora&lt;/a&gt; This was already fixed in 1.15.0, the following versions could be corrected to prevent confusion, thanks.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Affects Version/s:&lt;/b&gt; 1.13.2, 1.14.4, 1.15.0&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Fix Version/s:&lt;/b&gt; 1.16.0&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="13460173">FLINK-28214</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13037223" name="Screen Shot 2021-12-09 at 6.58.56 PM.png" size="31771" author="sr.praneeth@gmail.com" created="Fri, 10 Dec 2021 03:02:34 +0000"/>
                            <attachment id="13037222" name="Screen Shot 2021-12-09 at 7.04.10 PM.png" size="31532" author="sr.praneeth@gmail.com" created="Fri, 10 Dec 2021 03:04:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xj4w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>