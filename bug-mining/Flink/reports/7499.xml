<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 21:20:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-35215] The performance of serializerKryo and serializerKryoWithoutRegistration are regressed</title>
                <link>https://issues.apache.org/jira/browse/FLINK-35215</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The performance of serializerKryo and serializerKryoWithoutRegistration are regressed&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;, I checked recent commits, and found &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; changed related logic.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://flink-speed.xyz/timeline/#/?exe=1,6,12&amp;amp;ben=serializerKryo&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink-speed.xyz/timeline/#/?exe=1,6,12&amp;amp;ben=serializerKryo&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=200&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://flink-speed.xyz/timeline/#/?exe=1,6,12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink-speed.xyz/timeline/#/?exe=1,6,12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=200&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13576866">FLINK-35215</key>
            <summary>The performance of serializerKryo and serializerKryoWithoutRegistration are regressed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fanrui">Rui Fan</assignee>
                                    <reporter username="fanrui">Rui Fan</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 23 Apr 2024 05:57:02 +0000</created>
                <updated>Fri, 31 May 2024 03:24:17 +0000</updated>
                            <resolved>Fri, 31 May 2024 03:24:17 +0000</resolved>
                                    <version>1.20.0</version>
                                    <fixVersion>1.20.0</fixVersion>
                                    <component>API / Type Serialization System</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17839949" author="fanrui" created="Tue, 23 Apr 2024 06:01:30 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=q.xu&quot; class=&quot;user-hover&quot; rel=&quot;q.xu&quot;&gt;q.xu&lt;/a&gt; , would you mind taking a look this issue in your free time? thank you in advance.&lt;/p&gt;</comment>
                            <comment id="17840230" author="q.xu" created="Tue, 23 Apr 2024 21:06:29 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanrui&quot; class=&quot;user-hover&quot; rel=&quot;fanrui&quot;&gt;fanrui&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have a few questions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I&apos;m trying to understand the numbers. How should I interprete them?
	&lt;ul&gt;
		&lt;li&gt;For &lt;a href=&quot;#/?exe=1,6,12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50]:&quot; title=&quot;http://flink-speed.xyz/timeline/#/?exe=1,6,12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;serializerKryoWithoutRegistration&lt;/a&gt;,] the number for java17 had dropped before my commit was merged, and was a bit better after; the number for default jdk (java8?) dropped as well before my commit, between 04-16 and 04-18, there&apos;s a drop about 5%, and then the drop between 04-18 and 04-20 is less than 2% (I skipped 04-19 because it looks like an outlier).&lt;/li&gt;
		&lt;li&gt;For &lt;a href=&quot;#/?exe=1,6,12&amp;amp;ben=serializerKryo&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50],&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;serializerKryo&lt;/a&gt; the number for java8 seems like normal fluctuation if I compare with the past; for java17 the drop between 04-17 and 04-19 (before my commit) is around 5%, and numbers are not much changed after the merge of my commit comparing to 04-19.&lt;/li&gt;
		&lt;li&gt;For the two dashboards, only java11 seems have dropped in a statistically meaningful way. But in the past, the fluctuation of this trend has always been significantly higher, so I&apos;m not sure if it&apos;s really related to my commit.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;How are the benchmarks done? Do you have a documentation to reproduce that?&#160;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17840259" author="kkrugler" created="Wed, 24 Apr 2024 01:23:10 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanrui&quot; class=&quot;user-hover&quot; rel=&quot;fanrui&quot;&gt;fanrui&lt;/a&gt; - I haven&apos;t been following how Flink determines the severity &amp;amp; nature of performance regressions, but labeling this a Blocker Bug seems...odd to me. The speedtest I looked at showed a delta that was close to normal fluctuations in performance results.&lt;/p&gt;</comment>
                            <comment id="17840678" author="fanrui" created="Thu, 25 Apr 2024 07:08:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=q.xu&quot; class=&quot;user-hover&quot; rel=&quot;q.xu&quot;&gt;q.xu&lt;/a&gt;&#160; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkrugler&quot; class=&quot;user-hover&quot; rel=&quot;kkrugler&quot;&gt;kkrugler&lt;/a&gt; , flink community has a performance regression detector to detect them, and send the result to Slack channel every day. I noticed these regression there. If you are interested in it, you can can more details from here&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;Sometimes the performance regression detector will also send an alert when some benchmarks fluctuate only occasionally.&lt;/p&gt;

&lt;p&gt;But according to my observation, serializerKryo and serializerKryoWithoutRegistration really have performance regression.(it&apos;s not a big regression.) Let us focus on the java 17 and serializerKryoWithoutRegistration(I saw java 8 and java11 are similar).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;After April 19, average performance is lower than before April 19.
	&lt;ul&gt;
		&lt;li&gt;Note: let us focus on the average performance instead of single day.&lt;/li&gt;
		&lt;li&gt;The reason for single-day performance regression may be caused by fluctuation.&lt;/li&gt;
		&lt;li&gt;In general, the performance will be recovered in a few days if the performance regression is caused by fluctuation.&lt;/li&gt;
		&lt;li&gt;All of them (serializerKryoWithoutRegistration and serializerKryo, java 8, java11 and java17) don&apos;t recovered for now.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;And &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; is merged at April 19&lt;/li&gt;
	&lt;li&gt;Also, I reverts the &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; on my flink fork repo, and try to re-run the benchmark 3 times.
	&lt;ul&gt;
		&lt;li&gt;The performance is recovered after reverting, that&apos;s why I&apos;m sure &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; causes it.&lt;/li&gt;
		&lt;li&gt;I will add the result later.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13068422/13068422_image-2024-04-25-14-57-55-231.png&quot; height=&quot;365&quot; width=&quot;968&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13068423/13068423_image-2024-04-25-15-00-32-410.png&quot; height=&quot;363&quot; width=&quot;974&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://github.com/apache/flink-benchmarks/blob/master/regression_report_v2.py&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink-benchmarks/blob/master/regression_report_v2.py&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://docs.google.com/document/d/1Bvzvq79Ll5yxd1UtC0YzczgFbZPAgPcN3cI0MjVkIag&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.google.com/document/d/1Bvzvq79Ll5yxd1UtC0YzczgFbZPAgPcN3cI0MjVkIag&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17840693" author="fanrui" created="Thu, 25 Apr 2024 07:59:35 +0000"  >&lt;p&gt;Here is the benchmark result for my test:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Code&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;serializerKryo&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;serializerKryoWithoutRegistration&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Comment&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Case1: current master branch&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;167.163333333 ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;135.03 &#160;ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Lower about 10% than reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Case2: master branch reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; &#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;190.636025667 ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;147.184592333 &#160;ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Case3: reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; and &lt;br/&gt;
with &lt;a href=&quot;https://github.com/apache/flink/pull/24717&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/24717&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;189.621157333 ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;146.914767 ops/ms&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Lower about 0.5% than reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt;&#160;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Note: I choose 3 samples for each cases.&lt;/p&gt;
&lt;h1&gt;&lt;a name=&quot;Case1%3Acurrentmasterbranch&quot;&gt;&lt;/a&gt;Case1: current master branch&lt;/h1&gt;

&lt;p&gt;data from benchmark result WebUI.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;serializerKryo (avg: 167.163333333 ops/ms)
	&lt;ul&gt;
		&lt;li&gt;&lt;a href=&quot;http://flink-speed.xyz/timeline/#/?exe=6&amp;amp;ben=serializerKryo&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink-speed.xyz/timeline/#/?exe=6&amp;amp;ben=serializerKryo&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;164.68 ops/ms (Apr 22)&lt;/li&gt;
		&lt;li&gt;168.80 ops/ms (Apr 23)&lt;/li&gt;
		&lt;li&gt;168.01 ops/ms (Apr 24)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;serializerKryoWithoutRegistration (avg: 135.03 &#160;ops/ms)
	&lt;ul&gt;
		&lt;li&gt;&#160;&lt;a href=&quot;http://flink-speed.xyz/timeline/#/?exe=12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://flink-speed.xyz/timeline/#/?exe=12&amp;amp;ben=serializerKryoWithoutRegistration&amp;amp;extr=on&amp;amp;quarts=on&amp;amp;equid=off&amp;amp;env=3&amp;amp;revs=50&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;134.93 ops/ms (Apr 22)&lt;/li&gt;
		&lt;li&gt;134.06 ops/ms (Apr 23)&lt;/li&gt;
		&lt;li&gt;136.10 ops/ms (Apr 24)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;h1&gt;&lt;a name=&quot;Case2%3AmasterbranchrevertsFLINK34954%C2%A0&quot;&gt;&lt;/a&gt;Case2: master branch reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; &#160;&lt;/h1&gt;

&lt;p&gt;I trigger it manually, the code branch is : &lt;a href=&quot;https://github.com/1996fanrui/flink/tree/revert-kyro-fix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/1996fanrui/flink/tree/revert-kyro-fix&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Note: the result of case2 and case3 isn&apos;t public, I paste the result from the Flink Community jenkins.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;serializerKryo (avg: 190.636025667 ops/ms)
	&lt;ul&gt;
		&lt;li&gt;194.929708 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/81/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/81/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;186.023176 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/83/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/83/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;190.955193 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/85/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/85/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;serializerKryoWithoutRegistration (avg: 147.184592333 &#160;ops/ms)
	&lt;ul&gt;
		&lt;li&gt;149.782267 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/81/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/81/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;146.312711 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/83/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/83/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;145.458799 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/85/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/85/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;h1&gt;&lt;a name=&quot;Case3%3ArevertsFLINK34954andwithhttps%3A%2F%2Fgithub.com%2Fapache%2Fflink%2Fpull%2F24717&quot;&gt;&lt;/a&gt;Case3: reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; and with &lt;a href=&quot;https://github.com/apache/flink/pull/24717&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/24717&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;I trigger it manually, the code branch is : &lt;a href=&quot;https://github.com/1996fanrui/flink/tree/revert-kyro-fix-and-return-if-0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/1996fanrui/flink/tree/revert-kyro-fix-and-return-if-0&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;serializerKryo &#160;(avg: 189.621157333 ops/ms)
	&lt;ul&gt;
		&lt;li&gt;182.683889 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/82/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/82/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;191.713318 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/84/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/84/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;194.466265 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/86/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/86/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;serializerKryoWithoutRegistration &#160;(avg: 146.914767 ops/ms)
	&lt;ul&gt;
		&lt;li&gt;146.514048 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/82/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/82/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;145.825161 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/84/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/84/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;148.405092 ops/ms &#160; &#160; link: &lt;a href=&quot;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/86/artifact/jmh-result.csv/*view*/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.flink-speed.xyz/job/flink-benchmark-request/86/artifact/jmh-result.csv/*view*/&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Note: I try to use other solution to fix the bug that &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt; mentioned, but I&apos;m not sure whether the logic is right/suitable. If the solution is fine, the benchmark result is better than &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Code change: &lt;a href=&quot;https://github.com/1996fanrui/flink/commit/ebce171a806a579225897a2d29e4cd28e9164c4f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/1996fanrui/flink/commit/ebce171a806a579225897a2d29e4cd28e9164c4f&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The change is pretty easy.&lt;/p&gt;</comment>
                            <comment id="17841547" author="kkrugler" created="Sun, 28 Apr 2024 00:03:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanrui&quot; class=&quot;user-hover&quot; rel=&quot;fanrui&quot;&gt;fanrui&lt;/a&gt; - thanks for the detailed writeup! Two comments...&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;I was surprised that Case2 (above) didn&apos;t cause a test to fail, until I realized that the previous fix hadn&apos;t added a test for failure with 0 serialized bytes. I would recommend adding this, so that your changes don&apos;t accidentally re-introduce this bug.&lt;/li&gt;
	&lt;li&gt;I still am suspicious of the change in performance. The initial fix changes a while(true) loop to one that has a simple comparison, and inside the loop there are calls to methods that are going to be doing significant work. So I really don&apos;t see how that change could have caused a significant performance regression, unless I&apos;m missing something.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17844504" author="fanrui" created="Wed, 8 May 2024 03:05:38 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkrugler&quot; class=&quot;user-hover&quot; rel=&quot;kkrugler&quot;&gt;kkrugler&lt;/a&gt; for the feedback!&lt;/p&gt;
&lt;blockquote&gt;&lt;ul&gt;
	&lt;li&gt;I was surprised that Case2 (above) didn&apos;t cause a test to fail, until I realized that the previous fix hadn&apos;t added a test for failure with 0 serialized bytes. I would recommend adding this, so that your changes don&apos;t accidentally re-introduce this bug.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Good catch, I will add test later. Also, would you mind helping review the new PR in your free time? thanks a lot.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;ul&gt;
	&lt;li&gt;I still am suspicious of the change in performance. The initial fix changes a while(true) loop to one that has a simple comparison, and inside the loop there are calls to methods that are going to be doing significant work. So I really don&apos;t see how that change could have caused a significant performance regression, unless I&apos;m missing something.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;See this comment: &lt;a href=&quot;https://github.com/apache/flink/pull/24717#discussion_r1579063045&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/24717#discussion_r1579063045&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17844662" author="kkrugler" created="Wed, 8 May 2024 13:38:44 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanrui&quot; class=&quot;user-hover&quot; rel=&quot;fanrui&quot;&gt;fanrui&lt;/a&gt; - I added a comment to the PR.&lt;/p&gt;</comment>
                            <comment id="17848416" author="fanrui" created="Wed, 22 May 2024 01:57:33 +0000"  >&lt;p&gt;Merged to master via:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;46db92641602313c4f5c1390807222c344880e2d (Revert the commit of &#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-34954&quot; title=&quot;Kryo input implementation NoFetchingInput fails to handle zero length bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-34954&quot;&gt;&lt;del&gt;FLINK-34954&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;c1baf07d7601a683f42997dc35dfaef4e41bc928&lt;/li&gt;
	&lt;li&gt;5b535e1410782a2d42127e00d77815d6ab7068ed (Add test)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I will follow the benchmark result in the following days, and close this Jira after the performance is recovered.&lt;/p&gt;</comment>
                            <comment id="17850904" author="fanrui" created="Fri, 31 May 2024 03:24:10 +0000"  >&lt;p&gt;The performance seems already recovered, let me close this JIRA.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13069217/13069217_image-2024-05-31-11-22-49-226.png&quot; height=&quot;389&quot; width=&quot;1121&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13573579">FLINK-34954</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13068422" name="image-2024-04-25-14-57-55-231.png" size="196376" author="fanrui" created="Thu, 25 Apr 2024 06:57:56 +0000"/>
                            <attachment id="13068423" name="image-2024-04-25-15-00-32-410.png" size="210854" author="fanrui" created="Thu, 25 Apr 2024 07:00:33 +0000"/>
                            <attachment id="13069217" name="image-2024-05-31-11-22-49-226.png" size="426270" author="fanrui" created="Fri, 31 May 2024 03:22:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ot8o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>