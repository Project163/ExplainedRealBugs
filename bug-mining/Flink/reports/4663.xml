<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:50:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-19458] ZooKeeperLeaderElectionITCase.testJobExecutionOnClusterWithLeaderChange: ZooKeeper unexpectedly modified</title>
                <link>https://issues.apache.org/jira/browse/FLINK-19458</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=8422&amp;amp;view=logs&amp;amp;j=70ad9b63-500e-5dc9-5a3c-b60356162d7e&amp;amp;t=944c7023-8984-5aa2-b5f8-54922bd90d3a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=8422&amp;amp;view=logs&amp;amp;j=70ad9b63-500e-5dc9-5a3c-b60356162d7e&amp;amp;t=944c7023-8984-5aa2-b5f8-54922bd90d3a&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-09-29T13:34:18.1803081Z [ERROR] testJobExecutionOnClusterWithLeaderChange(org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase)  Time elapsed: 23.524 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
2020-09-29T13:34:18.1803707Z java.util.concurrent.ExecutionException: org.apache.flink.runtime.client.JobSubmissionException: Failed to submit job.
2020-09-29T13:34:18.1804343Z 	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
2020-09-29T13:34:18.1804738Z 	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1908)
2020-09-29T13:34:18.1805274Z 	at org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase.testJobExecutionOnClusterWithLeaderChange(ZooKeeperLeaderElectionITCase.java:117)
2020-09-29T13:34:18.1805772Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
2020-09-29T13:34:18.1806136Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
2020-09-29T13:34:18.1806555Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-09-29T13:34:18.1806936Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-09-29T13:34:18.1807313Z 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
2020-09-29T13:34:18.1807731Z 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
2020-09-29T13:34:18.1808341Z 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
2020-09-29T13:34:18.1808973Z 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
2020-09-29T13:34:18.1809376Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-09-29T13:34:18.1809851Z 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
2020-09-29T13:34:18.1810201Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-09-29T13:34:18.1810632Z 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
2020-09-29T13:34:18.1811035Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
2020-09-29T13:34:18.1811700Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
2020-09-29T13:34:18.1812082Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2020-09-29T13:34:18.1812447Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2020-09-29T13:34:18.1812824Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2020-09-29T13:34:18.1813190Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2020-09-29T13:34:18.1813565Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2020-09-29T13:34:18.1813964Z 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
2020-09-29T13:34:18.1814364Z 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
2020-09-29T13:34:18.1814752Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2020-09-29T13:34:18.1815298Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
2020-09-29T13:34:18.1816096Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
2020-09-29T13:34:18.1816552Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
2020-09-29T13:34:18.1816984Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
2020-09-29T13:34:18.1817421Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
2020-09-29T13:34:18.1817894Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
2020-09-29T13:34:18.1818318Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
2020-09-29T13:34:18.1818888Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-09-29T13:34:18.1819294Z 	Suppressed: org.apache.flink.util.FlinkException: Could not close resource.
2020-09-29T13:34:18.1819698Z 		at org.apache.flink.util.AutoCloseableAsync.close(AutoCloseableAsync.java:42)
2020-09-29T13:34:18.1820260Z 		at org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase.testJobExecutionOnClusterWithLeaderChange(ZooKeeperLeaderElectionITCase.java:136)
2020-09-29T13:34:18.1820678Z 		... 30 more
2020-09-29T13:34:18.1821326Z 	Caused by: org.apache.flink.runtime.rpc.exceptions.FencingTokenException: Fencing token not set: Ignoring message LocalFencedMessage(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, LocalRpcInvocation(deregisterApplication(ApplicationStatus, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;))) sent to akka:&lt;span class=&quot;code-comment&quot;&gt;//flink/user/rpc/resourcemanager_4 because the fencing token is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;.
&lt;/span&gt;2020-09-29T13:34:18.1822143Z 		at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:63)
2020-09-29T13:34:18.1822621Z 		at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)
2020-09-29T13:34:18.1823024Z 		at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2020-09-29T13:34:18.1823397Z 		at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2020-09-29T13:34:18.1823776Z 		at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2020-09-29T13:34:18.1824306Z 		at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2020-09-29T13:34:18.1824686Z 		at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2020-09-29T13:34:18.1825066Z 		at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-09-29T13:34:18.1825528Z 		at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-09-29T13:34:18.1825883Z 		at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2020-09-29T13:34:18.1826238Z 		at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2020-09-29T13:34:18.1826579Z 		at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2020-09-29T13:34:18.1826912Z 		at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2020-09-29T13:34:18.1827302Z 		at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2020-09-29T13:34:18.1827609Z 		at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2020-09-29T13:34:18.1827912Z 		at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2020-09-29T13:34:18.1828252Z 		at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2020-09-29T13:34:18.1828629Z 		at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2020-09-29T13:34:18.1829062Z 		at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2020-09-29T13:34:18.1829468Z 		at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2020-09-29T13:34:18.1829871Z Caused by: org.apache.flink.runtime.client.JobSubmissionException: Failed to submit job.
2020-09-29T13:34:18.1830321Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.lambda$internalSubmitJob$2(Dispatcher.java:348)
2020-09-29T13:34:18.1830936Z 	at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:836)
2020-09-29T13:34:18.1831356Z 	at java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:811)
2020-09-29T13:34:18.1831797Z 	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
2020-09-29T13:34:18.1832231Z 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
2020-09-29T13:34:18.1832645Z 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
2020-09-29T13:34:18.1833180Z 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
2020-09-29T13:34:18.1833761Z Caused by: java.util.ConcurrentModificationException: ZooKeeper unexpectedly modified
2020-09-29T13:34:18.1834413Z 	at org.apache.flink.runtime.zookeeper.ZooKeeperStateHandleStore.addAndLock(ZooKeeperStateHandleStore.java:158)
2020-09-29T13:34:18.1834954Z 	at org.apache.flink.runtime.jobmanager.ZooKeeperJobGraphStore.putJobGraph(ZooKeeperJobGraphStore.java:228)
2020-09-29T13:34:18.1835452Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.persistAndRunJob(Dispatcher.java:356)
2020-09-29T13:34:18.1835943Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.lambda$waitForTerminatingJob$28(Dispatcher.java:827)
2020-09-29T13:34:18.1836432Z 	at org.apache.flink.util.function.FunctionUtils.lambda$uncheckedConsumer$3(FunctionUtils.java:94)
2020-09-29T13:34:18.1837422Z 	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:670)
2020-09-29T13:34:18.1837857Z 	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
2020-09-29T13:34:18.1838282Z 	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
2020-09-29T13:34:18.1838730Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRunAsync(AkkaRpcActor.java:402)
2020-09-29T13:34:18.1839184Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:195)
2020-09-29T13:34:18.1839647Z 	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74)
2020-09-29T13:34:18.1840123Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)
2020-09-29T13:34:18.1840531Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2020-09-29T13:34:18.1840895Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2020-09-29T13:34:18.1841272Z 	at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2020-09-29T13:34:18.1841659Z 	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2020-09-29T13:34:18.1842029Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2020-09-29T13:34:18.1842490Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-09-29T13:34:18.1842878Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-09-29T13:34:18.1843223Z 	at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2020-09-29T13:34:18.1843742Z 	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2020-09-29T13:34:18.1844151Z 	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2020-09-29T13:34:18.1844467Z 	at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2020-09-29T13:34:18.1844793Z 	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2020-09-29T13:34:18.1845114Z 	at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2020-09-29T13:34:18.1845399Z 	at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2020-09-29T13:34:18.1845735Z 	at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2020-09-29T13:34:18.1846125Z 	at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2020-09-29T13:34:18.1846508Z 	at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2020-09-29T13:34:18.1846905Z 	at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2020-09-29T13:34:18.1847397Z Caused by: org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists
2020-09-29T13:34:18.1847933Z 	at org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
2020-09-29T13:34:18.1848418Z 	at org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.ZooKeeper.multiInternal(ZooKeeper.java:1015)
2020-09-29T13:34:18.1848889Z 	at org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.ZooKeeper.multi(ZooKeeper.java:919)
2020-09-29T13:34:18.1849421Z 	at org.apache.flink.shaded.curator4.org.apache.curator.framework.imps.CuratorTransactionImpl.doOperation(CuratorTransactionImpl.java:197)
2020-09-29T13:34:18.1850005Z 	at org.apache.flink.shaded.curator4.org.apache.curator.framework.imps.CuratorTransactionImpl.access$000(CuratorTransactionImpl.java:37)
2020-09-29T13:34:18.1850598Z 	at org.apache.flink.shaded.curator4.org.apache.curator.framework.imps.CuratorTransactionImpl$2.call(CuratorTransactionImpl.java:130)
2020-09-29T13:34:18.1851818Z 	at org.apache.flink.shaded.curator4.org.apache.curator.framework.imps.CuratorTransactionImpl$2.call(CuratorTransactionImpl.java:126)
2020-09-29T13:34:18.1865959Z 	at org.apache.flink.shaded.curator4.org.apache.curator.connection.StandardConnectionHandlingPolicy.callWithRetry(StandardConnectionHandlingPolicy.java:64)
2020-09-29T13:34:18.1866608Z 	at org.apache.flink.shaded.curator4.org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:100)
2020-09-29T13:34:18.1867149Z 	at org.apache.flink.shaded.curator4.org.apache.curator.framework.imps.CuratorTransactionImpl.commit(CuratorTransactionImpl.java:123)
2020-09-29T13:34:18.1867700Z 	at org.apache.flink.runtime.zookeeper.ZooKeeperStateHandleStore.addAndLock(ZooKeeperStateHandleStore.java:152)
2020-09-29T13:34:18.1868034Z 	... 29 more
2020-09-29T13:34:18.1868164Z 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13329983">FLINK-19458</key>
            <summary>ZooKeeperLeaderElectionITCase.testJobExecutionOnClusterWithLeaderChange: ZooKeeper unexpectedly modified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmetzger">Robert Metzger</assignee>
                                    <reporter username="rmetzger">Robert Metzger</reporter>
                        <labels>
                            <label>pull-request-available</label>
                            <label>test-stability</label>
                    </labels>
                <created>Tue, 29 Sep 2020 17:09:57 +0000</created>
                <updated>Thu, 15 Apr 2021 06:46:49 +0000</updated>
                            <resolved>Tue, 20 Oct 2020 13:19:39 +0000</resolved>
                                    <version>1.12.0</version>
                                    <fixVersion>1.12.0</fixVersion>
                                    <component>Runtime / Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17207789" author="dian.fu" created="Mon, 5 Oct 2020 00:17:26 +0000"  >&lt;p&gt;Another instance: &lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7184&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=a99e99c7-21cd-5a1f-7274-585e62b72f56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7184&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=a99e99c7-21cd-5a1f-7274-585e62b72f56&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17208029" author="rmetzger" created="Mon, 5 Oct 2020 11:49:35 +0000"  >&lt;p&gt;I&apos;ll have a look at this failure ...&lt;/p&gt;

&lt;p&gt;The test failure seems to occur only on the azure provided VMs.&lt;/p&gt;

</comment>
                            <comment id="17209313" author="rmetzger" created="Wed, 7 Oct 2020 06:05:51 +0000"  >&lt;p&gt;Again, Azure VM: &lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7253&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=a99e99c7-21cd-5a1f-7274-585e62b72f56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=7253&amp;amp;view=logs&amp;amp;j=39d5b1d5-3b41-54dc-6458-1e2ddd1cdcf3&amp;amp;t=a99e99c7-21cd-5a1f-7274-585e62b72f56&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17212978" author="rmetzger" created="Tue, 13 Oct 2020 09:07:57 +0000"  >&lt;p&gt;I was able to reproduce the issue, even though it took me a lot of time to get there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
This time, it failed with &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2020-10-07T09:56:42.2689556Z [ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 80.636 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase
2020-10-07T09:56:42.2690627Z [ERROR] testJobExecutionOnClusterWithLeaderChange(org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase)  Time elapsed: 75.698 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
2020-10-07T09:56:42.2691316Z java.util.concurrent.ExecutionException: org.apache.flink.util.FlinkException: JobMaster has been shut down.
2020-10-07T09:56:42.2691868Z 	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
2020-10-07T09:56:42.2692353Z 	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1908)
2020-10-07T09:56:42.2693091Z 	at org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase.lambda$testJobExecutionOnClusterWithLeaderChange$0(ZooKeeperLeaderElectionITCase.java:136)
2020-10-07T09:56:42.2694004Z 	at org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition(CommonTestUtils.java:126)
2020-10-07T09:56:42.2694749Z 	at org.apache.flink.test.runtime.leaderelection.ZooKeeperLeaderElectionITCase.testJobExecutionOnClusterWithLeaderChange(ZooKeeperLeaderElectionITCase.java:136)
2020-10-07T09:56:42.2695392Z 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
2020-10-07T09:56:42.2695844Z 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
2020-10-07T09:56:42.2696413Z 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
2020-10-07T09:56:42.2696912Z 	at java.lang.reflect.Method.invoke(Method.java:498)
2020-10-07T09:56:42.2697387Z 	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
2020-10-07T09:56:42.2697955Z 	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
2020-10-07T09:56:42.2698513Z 	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
2020-10-07T09:56:42.2699052Z 	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
2020-10-07T09:56:42.2699579Z 	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:48)
2020-10-07T09:56:42.2700064Z 	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
2020-10-07T09:56:42.2700486Z 	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
2020-10-07T09:56:42.2700926Z 	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
2020-10-07T09:56:42.2701431Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
2020-10-07T09:56:42.2701968Z 	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
2020-10-07T09:56:42.2702468Z 	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
2020-10-07T09:56:42.2702934Z 	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
2020-10-07T09:56:42.2703391Z 	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
2020-10-07T09:56:42.2704224Z 	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
2020-10-07T09:56:42.2704701Z 	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
2020-10-07T09:56:42.2705251Z 	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
2020-10-07T09:56:42.2705784Z 	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
2020-10-07T09:56:42.2706269Z 	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
2020-10-07T09:56:42.2706751Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
2020-10-07T09:56:42.2707328Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
2020-10-07T09:56:42.2707915Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
2020-10-07T09:56:42.2708468Z 	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
2020-10-07T09:56:42.2709062Z 	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
2020-10-07T09:56:42.2709679Z 	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
2020-10-07T09:56:42.2710308Z 	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
2020-10-07T09:56:42.2710821Z 	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-10-07T09:56:42.2711329Z Caused by: org.apache.flink.util.FlinkException: JobMaster has been shut down.
2020-10-07T09:56:42.2711885Z 	at org.apache.flink.runtime.jobmaster.JobManagerRunnerImpl.closeAsync(JobManagerRunnerImpl.java:184)
2020-10-07T09:56:42.2712462Z 	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
2020-10-07T09:56:42.2713069Z 	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
2020-10-07T09:56:42.2714022Z 	at org.apache.flink.runtime.dispatcher.DispatcherJob.lambda$closeAsync$7(DispatcherJob.java:243)
2020-10-07T09:56:42.2715078Z 	at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:836)
2020-10-07T09:56:42.2715652Z 	at java.util.concurrent.CompletableFuture.uniHandleStage(CompletableFuture.java:848)
2020-10-07T09:56:42.2716197Z 	at java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:2168)
2020-10-07T09:56:42.2716723Z 	at org.apache.flink.runtime.dispatcher.DispatcherJob.closeAsync(DispatcherJob.java:240)
2020-10-07T09:56:42.2717272Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.removeJob(Dispatcher.java:652)
2020-10-07T09:56:42.2717870Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.removeJobAndRegisterTerminationFuture(Dispatcher.java:624)
2020-10-07T09:56:42.2718467Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.jobNotFinished(Dispatcher.java:758)
2020-10-07T09:56:42.2719037Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.dispatcherJobFailed(Dispatcher.java:397)
2020-10-07T09:56:42.2719601Z 	at org.apache.flink.runtime.dispatcher.Dispatcher.lambda$runJob$3(Dispatcher.java:386)
2020-10-07T09:56:42.2720133Z 	at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:836)
2020-10-07T09:56:42.2720680Z 	at java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:811)
2020-10-07T09:56:42.2721240Z 	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
2020-10-07T09:56:42.2721800Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRunAsync(AkkaRpcActor.java:402)
2020-10-07T09:56:42.2722358Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:195)
2020-10-07T09:56:42.2722965Z 	at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74)
2020-10-07T09:56:42.2723566Z 	at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)
2020-10-07T09:56:42.2724068Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)
2020-10-07T09:56:42.2724534Z 	at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)
2020-10-07T09:56:42.2725013Z 	at scala.PartialFunction$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;applyOrElse(PartialFunction.scala:123)
2020-10-07T09:56:42.2725484Z 	at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)
2020-10-07T09:56:42.2725979Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)
2020-10-07T09:56:42.2726469Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-10-07T09:56:42.2726938Z 	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)
2020-10-07T09:56:42.2727395Z 	at akka.actor.Actor$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;aroundReceive(Actor.scala:517)
2020-10-07T09:56:42.2727853Z 	at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)
2020-10-07T09:56:42.2728297Z 	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)
2020-10-07T09:56:42.2728734Z 	at akka.actor.ActorCell.invoke(ActorCell.scala:561)
2020-10-07T09:56:42.2729160Z 	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)
2020-10-07T09:56:42.2729557Z 	at akka.dispatch.Mailbox.run(Mailbox.scala:225)
2020-10-07T09:56:42.2729949Z 	at akka.dispatch.Mailbox.exec(Mailbox.scala:235)
2020-10-07T09:56:42.2730383Z 	at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
2020-10-07T09:56:42.2730967Z 	at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
2020-10-07T09:56:42.2731480Z 	at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
2020-10-07T09:56:42.2731996Z 	at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
2020-10-07T09:56:42.2732298Z 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=8448&amp;amp;view=logs&amp;amp;j=a1590513-d0ea-59c3-3c7b-aad756c48f25&amp;amp;t=5129dea2-618b-5c74-1b8f-9ec63a37a8a6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/rmetzger/Flink/_build/results?buildId=8448&amp;amp;view=logs&amp;amp;j=a1590513-d0ea-59c3-3c7b-aad756c48f25&amp;amp;t=5129dea2-618b-5c74-1b8f-9ec63a37a8a6&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17216707" author="rmetzger" created="Mon, 19 Oct 2020 13:11:31 +0000"  >&lt;p&gt;I might have found first hint to go after. The logs are pretty full with messages like this&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
09:55:39,565 [        SyncThread:0] WARN  org.apache.zookeeper.server.persistence.FileTxnLog           [] - fsync-ing the write ahead log in SyncThread:0 took 6744ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide
09:55:44,114 [main-SendThread(localhost:45487)] WARN  org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.ClientCnxn [] - Client session timed out, have not heard from server in 4000ms &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; sessionid 0x1000015fcfc0000
09:55:44,114 [main-SendThread(localhost:45487)] INFO  org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.ClientCnxn [] - Client session timed out, have not heard from server in 4000ms &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; sessionid 0x1000015fcfc0000, closing socket connection and attempting reconnect
09:55:44,114 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:45487] WARN  org.apache.zookeeper.server.NIOServerCnxn                    [] - Unable to read additional data from client sessionid 0x1000015fcfc0000, likely client has closed socket
09:55:44,115 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:45487] INFO  org.apache.zookeeper.server.NIOServerCnxn                    [] - Closed socket connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; client /127.0.0.1:59498 which had sessionid 0x1000015fcfc0000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which means: The disk is so slow, that writing the ZK txn log to it took 6744ms. The timeout is configured to 4000ms (2/3 of the session timeout).&lt;br/&gt;
There is a code path that sets the session timeout in a CI environment from 5000 to 30000. This check probably didn&apos;t work since we switched to Azure.&lt;br/&gt;
I will fix the check to set the timeout to 30000 on Azure as well.&lt;/p&gt;
</comment>
                            <comment id="17217604" author="rmetzger" created="Tue, 20 Oct 2020 13:19:33 +0000"  >&lt;p&gt;Most likely resolved on master in &lt;a href=&quot;https://github.com/apache/flink/commit/947b3d34daf01d15e6ad2e693e35e6637336e49f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/commit/947b3d34daf01d15e6ad2e693e35e6637336e49f&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17321948" author="maguowei" created="Thu, 15 Apr 2021 06:46:49 +0000"  >&lt;p&gt;1.11&lt;br/&gt;
&lt;a href=&quot;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16567&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=45cc9205-bdb7-5b54-63cd-89fdc0983323&amp;amp;l=3835&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dev.azure.com/apache-flink/apache-flink/_build/results?buildId=16567&amp;amp;view=logs&amp;amp;j=5c8e7682-d68f-54d1-16a2-a09310218a49&amp;amp;t=45cc9205-bdb7-5b54-63cd-89fdc0983323&amp;amp;l=3835&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13333949">FLINK-19514</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0j0lk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>