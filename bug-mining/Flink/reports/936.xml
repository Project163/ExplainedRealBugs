<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:23:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-3444] env.fromElements relies on the first input element for determining the DataSet/DataStream type</title>
                <link>https://issues.apache.org/jira/browse/FLINK-3444</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;The &lt;tt&gt;fromElements&lt;/tt&gt; method of the &lt;tt&gt;ExecutionEnvironment&lt;/tt&gt; and &lt;tt&gt;StreamExecutionEnvironment&lt;/tt&gt; determines the DataSet/DataStream type by extracting the type of the first input element.&lt;br/&gt;
This is problematic if the first element is a subtype of another element in the collection.&lt;br/&gt;
For example, the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DataStream&amp;lt;Event&amp;gt; input = env.fromElements(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Event(1, &lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubEvent(2, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;succeeds, while the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DataStream&amp;lt;Event&amp;gt; input = env.fromElements(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SubEvent(1, &lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Event(2, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fails with &quot;java.lang.IllegalArgumentException: The elements in the collection are not all subclasses of SubEvent&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12940263">FLINK-3444</key>
            <summary>env.fromElements relies on the first input element for determining the DataSet/DataStream type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vkalavri">Vasia Kalavri</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Feb 2016 19:49:10 +0000</created>
                <updated>Fri, 29 Apr 2016 11:55:38 +0000</updated>
                            <resolved>Wed, 13 Apr 2016 08:46:18 +0000</resolved>
                                    <version>0.10.0</version>
                    <version>1.0.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>API / DataSet</component>
                    <component>API / DataStream</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15185030" author="zentol" created="Tue, 8 Mar 2016 15:06:49 +0000"  >&lt;p&gt;We could add a fromElements method that takes a TypeInformation or Class argument in addition to the values. Should be the easiest and safest way to solve this issue.&lt;/p&gt;</comment>
                            <comment id="15186975" author="mxm" created="Wed, 9 Mar 2016 11:35:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15227923" author="githubbot" created="Wed, 6 Apr 2016 08:10:06 +0000"  >&lt;p&gt;GitHub user gallenvara opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-3444&quot; title=&quot;env.fromElements relies on the first input element for determining the DataSet/DataStream type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-3444&quot;&gt;&lt;del&gt;FLINK-3444&lt;/del&gt;&lt;/a&gt; env.fromElements relies on the first input element for determining the DataSet/DataStream type&lt;/p&gt;

&lt;p&gt;    Add fromElements method with based class type to avoid the exception.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/gallenvara/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gallenvara/flink&lt;/a&gt; flink-3444&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1857&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1eac212afa448984817f36f05ae931d4f0fa4ab9&lt;br/&gt;
Author: gallenvara &amp;lt;gallenvara@126.com&amp;gt;&lt;br/&gt;
Date:   2016-04-06T08:04:32Z&lt;/p&gt;

&lt;p&gt;    Add fromElements method with based class type to avoid the exception.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15227979" author="githubbot" created="Wed, 6 Apr 2016 09:02:23 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58673148&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58673148&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/StreamExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -673,6 +673,43 @@ public TimeCharacteristic getStreamTimeCharacteristic() {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	/**&lt;br/&gt;
    +	 * Creates a new data stream that contains the given elements. The elements must all be of the same type, for&lt;br/&gt;
    +	 * example, all of the &lt;/p&gt;
{@link String}
&lt;p&gt; or &lt;/p&gt;
{@link Integer}
&lt;p&gt;.&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * The framework will try and determine the exact type from the elements. In case of generic elements, it may be&lt;br/&gt;
    +	 * necessary to manually supply the type information via &lt;/p&gt;
{@link #fromCollection(java.util.Collection,
    +	 * org.apache.flink.api.common.typeinfo.TypeInformation)}
&lt;p&gt;.&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * Note that this operation will result in a non-parallel data stream source, i.e. a data stream source with a&lt;br/&gt;
    +	 * degree of parallelism one.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param clazz&lt;br/&gt;
    +	 * 		The base class type in the collection.&lt;br/&gt;
    +	 * @param data&lt;br/&gt;
    +	 * 		The array of elements to create the data stream from.&lt;br/&gt;
    +	 * @param &amp;lt;OUT&amp;gt;&lt;br/&gt;
    +	 * 		The type of the returned data stream&lt;br/&gt;
    +	 * @return The data stream representing the given array of elements&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@SafeVarargs&lt;br/&gt;
    +	public final &amp;lt;OUT&amp;gt; DataStreamSource&amp;lt;OUT&amp;gt; fromElements(Class&amp;lt;OUT&amp;gt; clazz, OUT... data) {&lt;br/&gt;
    +		if (data.length == 0) &lt;/p&gt;
{
    +			throw new IllegalArgumentException(&quot;fromElements needs at least one element as argument&quot;);
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		TypeInformation&amp;lt;OUT&amp;gt; typeInfo;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			typeInfo = TypeExtractor.getForClass(clazz);
    +		}
&lt;p&gt;    +		catch (Exception e) {&lt;br/&gt;
    +			throw new RuntimeException(&quot;Could not create TypeInformation for type &quot; + data&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getClass().getName()&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    shouldn&apos;t this exception contain clazz.getName() instead?&lt;/p&gt;</comment>
                            <comment id="15227983" author="githubbot" created="Wed, 6 Apr 2016 09:03:34 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58673287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58673287&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -780,6 +780,33 @@ public CsvReader readCsvFile(String filePath) &lt;/p&gt;
{
     		return fromCollection(Arrays.asList(data), TypeExtractor.getForObject(data[0]), Utils.getCallLocationName());
     	}

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Creates a new data set that contains the given elements. The elements must all be of the same type,&lt;br/&gt;
    +	 * for example, all of the &lt;/p&gt;
{@link String}
&lt;p&gt; or &lt;/p&gt;
{@link Integer}
&lt;p&gt;. The sequence of elements must not be empty.&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * The framework will try and determine the exact type from the collection elements.&lt;br/&gt;
    +	 * In case of generic elements, it may be necessary to manually supply the type information&lt;br/&gt;
    +	 * via &lt;/p&gt;
{@link #fromCollection(Collection, TypeInformation)}
&lt;p&gt;.&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * Note that this operation will result in a non-parallel data source, i.e. a data source with&lt;br/&gt;
    +	 * a parallelism of one.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param type The base class type for every element in the collection.&lt;br/&gt;
    +	 * @param data The elements to make up the data set.&lt;br/&gt;
    +	 * @return A DataSet representing the given list of elements.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@SafeVarargs&lt;br/&gt;
    +	public final &amp;lt;X&amp;gt; DataSource&amp;lt;X&amp;gt; fromElements(Class&amp;lt;X&amp;gt; type, X... data) {&lt;br/&gt;
    +		if (data == null) &lt;/p&gt;
{
    +			throw new IllegalArgumentException(&quot;The data must not be null.&quot;);
    +		}
&lt;p&gt;    +		if (data.length == 0) &lt;/p&gt;
{
    +			throw new IllegalArgumentException(&quot;The number of elements must not be zero.&quot;);
    +		}
&lt;p&gt;    +		&lt;br/&gt;
    +		return fromCollection(Arrays.asList(data), TypeExtractor.getForClass(type), Utils.getCallLocationName());&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    why does the scala variant throw a specific exception on getForClass() failure but this one doesn&apos;t?&lt;/p&gt;</comment>
                            <comment id="15227984" author="githubbot" created="Wed, 6 Apr 2016 09:04:11 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58673374&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58673374&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -780,6 +780,33 @@ public CsvReader readCsvFile(String filePath) &lt;/p&gt;
{
     		return fromCollection(Arrays.asList(data), TypeExtractor.getForObject(data[0]), Utils.getCallLocationName());
     	}

&lt;p&gt;    +	/**&lt;br/&gt;
    +	 * Creates a new data set that contains the given elements. The elements must all be of the same type,&lt;br/&gt;
    +	 * for example, all of the &lt;/p&gt;
{@link String}
&lt;p&gt; or &lt;/p&gt;
{@link Integer}
&lt;p&gt;. The sequence of elements must not be empty.&lt;br/&gt;
    +	 * &amp;lt;p&amp;gt;&lt;br/&gt;
    +	 * The framework will try and determine the exact type from the collection elements.&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    this line doesn&apos;t some valid for this method.&lt;/p&gt;</comment>
                            <comment id="15227990" author="githubbot" created="Wed, 6 Apr 2016 09:07:55 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58673800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58673800&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-streaming-java/src/test/java/org/apache/flink/streaming/api/SourceFunctionTest.java &amp;#8212;&lt;br/&gt;
    @@ -44,6 +45,18 @@ public void fromElementsTest() throws Exception {&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;     	@Test&lt;br/&gt;
    +	public void fromElementsWithBaseTypeTest1() {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    these tests appear to be in the wrong file;I would put them into the StreamExecutionEnvironment class.&lt;/p&gt;</comment>
                            <comment id="15227999" author="githubbot" created="Wed, 6 Apr 2016 09:15:18 +0000"  >&lt;p&gt;Github user zentol commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-206248345&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-206248345&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Should this method also be added to the scala environment?&lt;/p&gt;</comment>
                            <comment id="15228002" author="githubbot" created="Wed, 6 Apr 2016 09:18:03 +0000"  >&lt;p&gt;Github user gallenvara commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-206250467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-206250467&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol Thanks a lot for review work. I will modify the codes base on your advice!&lt;/p&gt;</comment>
                            <comment id="15228197" author="githubbot" created="Wed, 6 Apr 2016 12:51:20 +0000"  >&lt;p&gt;Github user gallenvara commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-206355988&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-206355988&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol , PR updated. The scala environment determine the type with `implicitly[TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;]` which is always the class `Object`. In the case this issue mentioned, no exception is thrown. IMO, we should not add this method to it. &lt;/p&gt;</comment>
                            <comment id="15228217" author="githubbot" created="Wed, 6 Apr 2016 13:10:19 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58701074&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58701074&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -777,7 +777,50 @@ public CsvReader readCsvFile(String filePath) &lt;/p&gt;
{
     			throw new IllegalArgumentException(&quot;The number of elements must not be zero.&quot;);
     		}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return fromCollection(Arrays.asList(data), TypeExtractor.getForObject(data&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;), Utils.getCallLocationName());&lt;br/&gt;
    +		TypeInformation&amp;lt;X&amp;gt; typeInfo;&lt;br/&gt;
    +		try 
{
    +			typeInfo = TypeExtractor.getForObject(data[0]);
    +		}
&lt;p&gt;    +		catch (Exception e) {&lt;br/&gt;
    +			throw new RuntimeException(&quot;Could not create TypeInformation for type &quot; + data&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getClass().getName()&lt;br/&gt;
    +					+ &quot;; please specify the TypeInformation manually via &quot;&lt;br/&gt;
    +					+ &quot;StreamExecutionEnvironment#fromCollection(Collection, TypeInformation)&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This should be ExecutionEnvironment#fromCollection&lt;/p&gt;</comment>
                            <comment id="15228218" author="githubbot" created="Wed, 6 Apr 2016 13:10:26 +0000"  >&lt;p&gt;Github user zentol commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#discussion_r58701096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#discussion_r58701096&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java &amp;#8212;&lt;br/&gt;
    @@ -777,7 +777,50 @@ public CsvReader readCsvFile(String filePath) &lt;/p&gt;
{
     			throw new IllegalArgumentException(&quot;The number of elements must not be zero.&quot;);
     		}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return fromCollection(Arrays.asList(data), TypeExtractor.getForObject(data&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;), Utils.getCallLocationName());&lt;br/&gt;
    +		TypeInformation&amp;lt;X&amp;gt; typeInfo;&lt;br/&gt;
    +		try 
{
    +			typeInfo = TypeExtractor.getForObject(data[0]);
    +		}
&lt;p&gt;    +		catch (Exception e) &lt;/p&gt;
{
    +			throw new RuntimeException(&quot;Could not create TypeInformation for type &quot; + data[0].getClass().getName()
    +					+ &quot;; please specify the TypeInformation manually via &quot;
    +					+ &quot;StreamExecutionEnvironment#fromCollection(Collection, TypeInformation)&quot;);
    +		}
&lt;p&gt;    +&lt;br/&gt;
    +		return fromCollection(Arrays.asList(data), typeInfo, Utils.getCallLocationName());&lt;br/&gt;
    +	}&lt;br/&gt;
    +	&lt;br/&gt;
    +	/**&lt;br/&gt;
    +	 * Creates a new data set that contains the given elements. The framework will determine the type according to the &lt;br/&gt;
    +	 * based type user supplied. The elements should be the same or be the subclass to the based type. &lt;br/&gt;
    +	 * The sequence of elements must not be empty.&lt;br/&gt;
    +	 * Note that this operation will result in a non-parallel data source, i.e. a data source with&lt;br/&gt;
    +	 * a parallelism of one.&lt;br/&gt;
    +	 *&lt;br/&gt;
    +	 * @param type The base class type for every element in the collection.&lt;br/&gt;
    +	 * @param data The elements to make up the data set.&lt;br/&gt;
    +	 * @return A DataSet representing the given list of elements.&lt;br/&gt;
    +	 */&lt;br/&gt;
    +	@SafeVarargs&lt;br/&gt;
    +	public final &amp;lt;X&amp;gt; DataSource&amp;lt;X&amp;gt; fromElements(Class&amp;lt;X&amp;gt; type, X... data) {&lt;br/&gt;
    +		if (data == null) &lt;/p&gt;
{
    +			throw new IllegalArgumentException(&quot;The data must not be null.&quot;);
    +		}
&lt;p&gt;    +		if (data.length == 0) &lt;/p&gt;
{
    +			throw new IllegalArgumentException(&quot;The number of elements must not be zero.&quot;);
    +		}
&lt;p&gt;    +		&lt;br/&gt;
    +		TypeInformation&amp;lt;X&amp;gt; typeInfo;&lt;br/&gt;
    +		try &lt;/p&gt;
{
    +			typeInfo = TypeExtractor.getForClass(type);
    +		}
&lt;p&gt;    +		catch (Exception e) {&lt;br/&gt;
    +			throw new RuntimeException(&quot;Could not create TypeInformation for type &quot; + type.getName()&lt;br/&gt;
    +					+ &quot;; please specify the TypeInformation manually via &quot;&lt;br/&gt;
    +					+ &quot;StreamExecutionEnvironment#fromCollection(Collection, TypeInformation)&quot;);&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This should be ExecutionEnvironment#fromCollection&lt;/p&gt;</comment>
                            <comment id="15229518" author="githubbot" created="Thu, 7 Apr 2016 01:54:59 +0000"  >&lt;p&gt;Github user gallenvara commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-206656056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-206656056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @zentol codes modified and rebase the new commit with previous one.&lt;/p&gt;</comment>
                            <comment id="15232213" author="githubbot" created="Fri, 8 Apr 2016 13:56:40 +0000"  >&lt;p&gt;Github user zentol commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-207442123&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-207442123&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1&lt;/p&gt;</comment>
                            <comment id="15234970" author="githubbot" created="Mon, 11 Apr 2016 12:20:23 +0000"  >&lt;p&gt;Github user StephanEwen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-208313579&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-208313579&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="15236628" author="githubbot" created="Tue, 12 Apr 2016 05:39:02 +0000"  >&lt;p&gt;Github user gallenvara commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857#issuecomment-208716571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857#issuecomment-208716571&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The error of CI build failure is not relevant with this PR.&lt;/p&gt;</comment>
                            <comment id="15238846" author="githubbot" created="Wed, 13 Apr 2016 08:31:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/1857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/1857&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15238867" author="stephanewen" created="Wed, 13 Apr 2016 08:46:18 +0000"  >&lt;p&gt;Fixed via 6bb085ec6d70e196b7b61bec5f6dc3f924ca7906&lt;/p&gt;

&lt;p&gt;Thank you for the contribution!&lt;/p&gt;</comment>
                            <comment id="15260115" author="till.rohrmann" created="Wed, 27 Apr 2016 13:13:50 +0000"  >&lt;p&gt;I&apos;m wondering why the above described problem was solved by introducing an overloaded method &lt;tt&gt;fromElements&lt;/tt&gt; which takes as the first parameter the &lt;tt&gt;Class&amp;lt;T&amp;gt;&lt;/tt&gt; of the elements? The problem is that if you do something like &lt;tt&gt;env.fromElements(SubClass.class, new ParentClass())&lt;/tt&gt; then the vararg only variant of &lt;tt&gt;fromElements&lt;/tt&gt; will be called with type &lt;tt&gt;Object&lt;/tt&gt; as result (since Object is the super type of &lt;tt&gt;Class&amp;lt;SubClass&amp;gt;&lt;/tt&gt; and &lt;tt&gt;ParentClass&lt;/tt&gt;. The reason is that &lt;tt&gt;ParentClass&lt;/tt&gt; is not a subtype of &lt;tt&gt;SubClass&lt;/tt&gt; and thus the new &lt;tt&gt;fromElements&lt;/tt&gt; method is not applicable.&lt;/p&gt;

&lt;p&gt;Wouldn&apos;t it have been better to automatically infer the super type of all given elements? Usually the &lt;tt&gt;fromElements&lt;/tt&gt; method is only called for very few elements and, thus, it should be feasible to iterate over all elements to extract the common super type. &lt;/p&gt;</comment>
                            <comment id="15260250" author="zentol" created="Wed, 27 Apr 2016 14:35:45 +0000"  >&lt;p&gt;It&apos;s the easiest and safest solution that gets the job done. At the time of the PR i already thought about your suggestion, but came to the conclusion that there probably can be cases where we would find the &quot;wrong&quot; super class. Then we would need the newly introduced method anyway.&lt;/p&gt;</comment>
                            <comment id="15261720" author="till.rohrmann" created="Thu, 28 Apr 2016 08:07:06 +0000"  >&lt;p&gt;What kind of cases would that be? I mean the pure var arg implementation is also capable of finding the common super type for the provided set of elements. Thus, I think we should be able to do the same.&lt;/p&gt;

&lt;p&gt;Moreover, in case that the user provides a wrong &lt;tt&gt;Class&amp;lt;T&amp;gt;&lt;/tt&gt; instance, then the pure var arg method is called where the common super type is &lt;tt&gt;Object&lt;/tt&gt;. This is completely intransparent to the user and thus confusing. I think this should be fixed by not allowing the compiler to compile these kind of programs or by automatically inferring the common super type.&lt;/p&gt;</comment>
                            <comment id="15261762" author="zentol" created="Thu, 28 Apr 2016 08:37:23 +0000"  >&lt;p&gt;oh yes, &quot;someone else can do it, why can&apos;t we?&quot;&lt;/p&gt;

&lt;p&gt;If you assume that one elements exists which is a super type for all other elements then this can be solved easily, no question there.&lt;/p&gt;

&lt;p&gt;But what if that assumption doesn&apos;t hold? Assume 2 elements, both implementing interfaces A and B. Which interface would you choose as the super type?&lt;/p&gt;</comment>
                            <comment id="15261783" author="till.rohrmann" created="Thu, 28 Apr 2016 08:50:09 +0000"  >&lt;p&gt;Since all instances are sub classes of &lt;tt&gt;Object&lt;/tt&gt;, the nearest common super type would be &lt;tt&gt;Object&lt;/tt&gt; in the worst case. That&apos;s exactly what happened if you mixed &lt;tt&gt;Class&amp;lt;T&amp;gt;&lt;/tt&gt; and &lt;tt&gt;ParentClass&lt;/tt&gt; together.&lt;/p&gt;

&lt;p&gt;How would the problem of two different interfaces be solved with an explicit &lt;tt&gt;Class&amp;lt;T&amp;gt;&lt;/tt&gt; parameter?&lt;/p&gt;</comment>
                            <comment id="15261911" author="zentol" created="Thu, 28 Apr 2016 10:08:56 +0000"  >&lt;p&gt;since &lt;b&gt;both&lt;/b&gt; elements implement A and B, wouldn&apos;t both A and B be common super types?&lt;/p&gt;</comment>
                            <comment id="15263952" author="till.rohrmann" created="Fri, 29 Apr 2016 11:55:38 +0000"  >&lt;p&gt;The common nearest super type would be the intersection type &lt;tt&gt;A &amp;amp; B&lt;/tt&gt; to be precise. But I see your point that it would not be possible to decide which of the interface shall be selected as the common super type if it weren&apos;t for the class variant of &lt;tt&gt;fromElements&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 29 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2t0sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>