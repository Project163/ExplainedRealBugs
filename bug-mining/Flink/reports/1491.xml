<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:27:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-5662] Alias in front of output fails</title>
                <link>https://issues.apache.org/jira/browse/FLINK-5662</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Neither of the following snippets works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
	&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

	DataSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; text = ...
	BatchTableEnvironment tEnv = TableEnvironment.getTableEnvironment(env);

&lt;span class=&quot;code-comment&quot;&gt;// 	Table t = tEnv.fromDataSet(text, &lt;span class=&quot;code-quote&quot;&gt;&quot;text&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;text AS line&quot;&lt;/span&gt;);
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// 	Table t = tEnv.fromDataSet(text, &lt;span class=&quot;code-quote&quot;&gt;&quot;text&quot;&lt;/span&gt;).as(&lt;span class=&quot;code-quote&quot;&gt;&quot;line&quot;&lt;/span&gt;);
&lt;/span&gt;	Table t = tEnv.fromDataSet(text, &lt;span class=&quot;code-quote&quot;&gt;&quot;text&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;text AS line&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;line AS line&quot;&lt;/span&gt;);

	tEnv.toDataSet(t, MyPojo.class).print();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyPojo {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; line;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.flink.table.api.TableException: POJO does not define field name: text
	at org.apache.flink.table.typeutils.TypeConverter$$anonfun$2.apply(TypeConverter.scala:85)
	at org.apache.flink.table.typeutils.TypeConverter$$anonfun$2.apply(TypeConverter.scala:81)
	at scala.collection.immutable.List.foreach(List.scala:318)
	at org.apache.flink.table.typeutils.TypeConverter$.determineReturnType(TypeConverter.scala:81)
	at org.apache.flink.table.plan.nodes.dataset.BatchScan.convertToExpectedType(BatchScan.scala:69)
	at org.apache.flink.table.plan.nodes.dataset.DataSetScan.translateToPlan(DataSetScan.scala:61)
	at org.apache.flink.table.api.BatchTableEnvironment.translate(BatchTableEnvironment.scala:305)
	at org.apache.flink.table.api.BatchTableEnvironment.translate(BatchTableEnvironment.scala:289)
	at org.apache.flink.table.api.java.BatchTableEnvironment.toDataSet(BatchTableEnvironment.scala:146)
	at groupId.WordCount.main(WordCount.java:67)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13038175">FLINK-5662</key>
            <summary>Alias in front of output fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="twalthr">Timo Walther</assignee>
                                    <reporter username="twalthr">Timo Walther</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2017 16:20:14 +0000</created>
                <updated>Mon, 13 Feb 2017 16:56:22 +0000</updated>
                            <resolved>Mon, 13 Feb 2017 16:53:00 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>Table SQL / API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15844483" author="jark" created="Sun, 29 Jan 2017 15:43:14 +0000"  >&lt;p&gt;I have looked into this issue. It only occurred when applying a renaming project and the expected type is a POJO.&lt;/p&gt;

&lt;p&gt;The reason is that the `ProjectRemoveRule.INSTANCE` rule removes identity project so that the renaming project doesn&apos;t exist at last. Not sure how to fix this. We can&apos;t remove  `ProjectRemoveRule.INSTANCE`  rule.&lt;/p&gt;</comment>
                            <comment id="15845513" author="twalthr" created="Mon, 30 Jan 2017 17:17:56 +0000"  >&lt;p&gt;You are right. This issue is not trivial. Actually we need a `ProjectRemoveRule` that pushes the field names in the input node, such that the field names are not getting lost. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fhueske&quot; class=&quot;user-hover&quot; rel=&quot;fhueske&quot;&gt;fhueske&lt;/a&gt; and I already discussed about having an easier architecture with conversion mappers at the beginning and end, and only operators handling row types in the middle. Maybe it is time for that now. We could then have a additional rule that merges two conversion mappers if nothing is in between.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Table t = tEnv.fromDataSet(text, &quot;text&quot;).groupBy(&quot;text&quot;).select(&quot;text AS line&quot;);&lt;/tt&gt; even fails with a CodeGen exception.&lt;/p&gt;</comment>
                            <comment id="15853701" author="twalthr" created="Mon, 6 Feb 2017 08:48:52 +0000"  >&lt;p&gt;I will assign this issue to me.&lt;/p&gt;</comment>
                            <comment id="15854313" author="githubbot" created="Mon, 6 Feb 2017 16:37:03 +0000"  >&lt;p&gt;GitHub user twalthr opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5662&quot; title=&quot;Alias in front of output fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5662&quot;&gt;&lt;del&gt;FLINK-5662&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Rework internal type handling of Table API&lt;/p&gt;

&lt;p&gt;    This PR refactors the internal type handling of the Table API. It...&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;converts type to internal Row type immediately in Batch/StreamScan&lt;/li&gt;
	&lt;li&gt;uses only Row type within the operators&lt;/li&gt;
	&lt;li&gt;converts to target type at the very end in Batch/StreamTableEnvironment&lt;/li&gt;
	&lt;li&gt;removes interfaces for `expectedType`&lt;/li&gt;
	&lt;li&gt;removes the config parameter `efficient type usage`&lt;/li&gt;
	&lt;li&gt;fixes the generic types (now `Any` means &quot;any type&quot; and `Row` means a &quot;row type&quot;)&lt;/li&gt;
	&lt;li&gt;fixes IDE warnings and unused imports where I found them&lt;/li&gt;
	&lt;li&gt;fixes the &quot;Alias in front of output fails&quot; issue&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/twalthr/flink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/twalthr/flink&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5662&quot; title=&quot;Alias in front of output fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5662&quot;&gt;&lt;del&gt;FLINK-5662&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3277&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fdca898407a6e70800ff706c37ed58ea4244a9b0&lt;br/&gt;
Author: twalthr &amp;lt;twalthr@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-02-06T16:18:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5662&quot; title=&quot;Alias in front of output fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5662&quot;&gt;&lt;del&gt;FLINK-5662&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;table&amp;#93;&lt;/span&gt; Rework internal type handling of Table API&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15854347" author="githubbot" created="Mon, 6 Feb 2017 16:55:04 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I forgot to test TableSinks. I will do this tomorrow.&lt;/p&gt;</comment>
                            <comment id="15855799" author="githubbot" created="Tue, 7 Feb 2017 11:29:42 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ready to be reviewed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15859278" author="githubbot" created="Thu, 9 Feb 2017 10:00:18 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100269744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100269744&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -170,7 +171,7 @@ abstract class BatchTableEnvironment(&lt;br/&gt;
       private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def explain(table: Table, extended: Boolean): String = {&lt;br/&gt;
         val ast = table.getRelNode&lt;br/&gt;
         val optimizedPlan = optimize(ast)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan) (TypeExtractor.createTypeInfo(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;))&lt;br/&gt;
    +    val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan, ast.getRowType) (new RowTypeInfo())
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Why we should pass in the row type from ast but not from the optimizedPlan. I think optimize does not change the row type of the whole plan. &lt;/p&gt;</comment>
                            <comment id="15859281" author="githubbot" created="Thu, 9 Feb 2017 10:02:57 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100270246&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100270246&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -285,28 +286,37 @@ abstract class BatchTableEnvironment(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;br/&gt;
       protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(table: Table)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = 
{
    -    val dataSetPlan = optimize(table.getRelNode)
    -    translate(dataSetPlan)
    +    val relNode = table.getRelNode
    +    val dataSetPlan = optimize(relNode)
    +    translate(dataSetPlan, relNode.getRowType)
       }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       /**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;br/&gt;
    +    * Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;]. Converts to target type if necessary.&lt;br/&gt;
         *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@param logicalPlan The root node of the relational expression tree.&lt;/li&gt;
	&lt;li&gt;@param tpe         The [&lt;span class=&quot;error&quot;&gt;&amp;#91;TypeInformation&amp;#93;&lt;/span&gt;] of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@tparam A The type of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(logicalPlan: RelNode)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +  protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      logicalPlan: RelNode,&lt;br/&gt;
    +      logicalType: RelDataType)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Can logicalType be directly get from logicalPlan (It&apos;s related to my comment with &quot;explain&quot; method)&lt;/p&gt;</comment>
                            <comment id="15859284" author="githubbot" created="Thu, 9 Feb 2017 10:05:01 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100270646&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100270646&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -285,28 +286,37 @@ abstract class BatchTableEnvironment(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;br/&gt;
       protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(table: Table)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = 
{
    -    val dataSetPlan = optimize(table.getRelNode)
    -    translate(dataSetPlan)
    +    val relNode = table.getRelNode
    +    val dataSetPlan = optimize(relNode)
    +    translate(dataSetPlan, relNode.getRowType)
       }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       /**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;br/&gt;
    +    * Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;]. Converts to target type if necessary.&lt;br/&gt;
         *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@param logicalPlan The root node of the relational expression tree.&lt;/li&gt;
	&lt;li&gt;@param tpe         The [&lt;span class=&quot;error&quot;&gt;&amp;#91;TypeInformation&amp;#93;&lt;/span&gt;] of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@tparam A The type of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(logicalPlan: RelNode)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +  protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      logicalPlan: RelNode,&lt;br/&gt;
    +      logicalType: RelDataType)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    And if it is indeed needed, we should update method comment as well &lt;/p&gt;</comment>
                            <comment id="15859288" author="githubbot" created="Thu, 9 Feb 2017 10:08:58 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100271473&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100271473&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/StreamTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -305,18 +307,25 @@ abstract class StreamTableEnvironment(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@tparam A The type of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataStream&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataStream&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;(logicalPlan: RelNode)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataStream&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +  protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      logicalPlan: RelNode,&lt;br/&gt;
    +      logicalType: RelDataType)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Same comments with BatchTableEnvironment&lt;/p&gt;</comment>
                            <comment id="15859438" author="githubbot" created="Thu, 9 Feb 2017 12:41:18 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100296701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100296701&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/dataset/DataSetRel.scala &amp;#8212;&lt;br/&gt;
    @@ -19,26 +19,19 @@&lt;br/&gt;
     package org.apache.flink.table.plan.nodes.dataset&lt;/p&gt;

&lt;p&gt;     import org.apache.calcite.rel.RelNode&lt;br/&gt;
    +import org.apache.flink.api.java.DataSet&lt;br/&gt;
     import org.apache.flink.table.api.BatchTableEnvironment&lt;br/&gt;
     import org.apache.flink.table.plan.nodes.FlinkRel&lt;br/&gt;
    -import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    -import org.apache.flink.api.java.DataSet&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;/p&gt;

&lt;p&gt;     trait DataSetRel extends RelNode with FlinkRel {&lt;/p&gt;

&lt;p&gt;       /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Translates the [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSetRel&amp;#93;&lt;/span&gt;] node into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] operator.&lt;br/&gt;
         *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* @param tableEnv     [&lt;span class=&quot;error&quot;&gt;&amp;#91;BatchTableEnvironment&amp;#93;&lt;/span&gt;] of the translated Table.&lt;/li&gt;
	&lt;li&gt;* @param expectedType specifies the type the Flink operator should return. The type must&lt;/li&gt;
	&lt;li&gt;*                     have the same arity as the result. For instance, if the&lt;/li&gt;
	&lt;li&gt;*                     expected type is a RowTypeInfo this method will return a DataSet of&lt;/li&gt;
	&lt;li&gt;*                     type Row. If the expected type is Tuple2, the operator will return&lt;/li&gt;
	&lt;li&gt;*                     a Tuple2 if possible. Row otherwise.&lt;br/&gt;
    +    * @param tableEnv The [&lt;span class=&quot;error&quot;&gt;&amp;#91;BatchTableEnvironment&amp;#93;&lt;/span&gt;] of the translated Table.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@return DataSet of type expectedType or RowTypeInfo
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    DataSet of Row is enough&lt;/p&gt;</comment>
                            <comment id="15859445" author="githubbot" created="Thu, 9 Feb 2017 12:44:18 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100297140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100297140&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/datastream/DataStreamRel.scala &amp;#8212;&lt;br/&gt;
    @@ -19,27 +19,20 @@&lt;br/&gt;
     package org.apache.flink.table.plan.nodes.datastream&lt;/p&gt;

&lt;p&gt;     import org.apache.calcite.rel.RelNode&lt;br/&gt;
    -import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    -import org.apache.flink.table.plan.nodes.FlinkRel&lt;br/&gt;
     import org.apache.flink.streaming.api.datastream.DataStream&lt;br/&gt;
     import org.apache.flink.table.api.StreamTableEnvironment&lt;br/&gt;
    +import org.apache.flink.table.plan.nodes.FlinkRel&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;/p&gt;

&lt;p&gt;     trait DataStreamRel extends RelNode with FlinkRel {&lt;/p&gt;

&lt;p&gt;       /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Translates the FlinkRelNode into a Flink operator.&lt;br/&gt;
         *&lt;/li&gt;
	&lt;li&gt;@param tableEnv The [&lt;span class=&quot;error&quot;&gt;&amp;#91;StreamTableEnvironment&amp;#93;&lt;/span&gt;] of the translated Table.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* @param expectedType specifies the type the Flink operator should return. The type must&lt;/li&gt;
	&lt;li&gt;*                     have the same arity as the result. For instance, if the&lt;/li&gt;
	&lt;li&gt;*                     expected type is a RowTypeInfo this method will return a DataSet of&lt;/li&gt;
	&lt;li&gt;*                     type Row. If the expected type is Tuple2, the operator will return&lt;/li&gt;
	&lt;li&gt;*                     a Tuple2 if possible. Row otherwise.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@return DataStream of type expectedType or RowTypeInfo
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    DataStream of Row&lt;/p&gt;</comment>
                            <comment id="15859497" author="githubbot" created="Thu, 9 Feb 2017 13:13:54 +0000"  >&lt;p&gt;Github user fhueske commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @twalthr, the PR looks quite good! +1 to what @KurtYoung said. I have a few minor comments which I will add soon.&lt;/p&gt;

&lt;p&gt;    Thanks, Fabian&lt;/p&gt;</comment>
                            <comment id="15863045" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100708770&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100708770&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonScan.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,98 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.plan.nodes&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.table.api.TableConfig&lt;br/&gt;
    +import org.apache.flink.table.codegen.CodeGenerator&lt;br/&gt;
    +import org.apache.flink.table.runtime.MapRunner&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Common class for batch and stream scans.&lt;br/&gt;
    +  */&lt;br/&gt;
    +trait CommonScan {&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +    * We check if the input type is exactly the same as the internal row type.&lt;br/&gt;
    +    * A conversion is necessary if types differ or object have to be unboxed&lt;br/&gt;
    +    * (i.e. Date, Time, Timestamp need to be converted into their primitive equivalents).&lt;br/&gt;
    +    */&lt;br/&gt;
    +  private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def needsConversion(&lt;br/&gt;
    +      externalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      internalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +    : Boolean = {&lt;br/&gt;
    +&lt;br/&gt;
    +    if (externalTypeInfo == internalTypeInfo) {&lt;br/&gt;
    +      val rowTypeInfo = externalTypeInfo.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;RowTypeInfo&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +      var containsBoxedTypes = false&lt;br/&gt;
    +      // TODO enable these lines for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    +      // for (i &amp;lt;- rowTypeInfo.getArity) {&lt;br/&gt;
    +      //   val field = rowTypeInfo.getTypeAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    +      //   if (field == SqlTimeTypeInfo.DATE ||&lt;br/&gt;
    +      //      field == SqlTimeTypeInfo.TIME ||&lt;br/&gt;
    +      //      field == SqlTimeTypeInfo.TIMESTAMP) &lt;/p&gt;
{
    +      //    containsBoxedTypes = true
    +      //  }
&lt;p&gt;    +      // }&lt;br/&gt;
    +      containsBoxedTypes&lt;br/&gt;
    +    } else &lt;/p&gt;
{
    +      true
    +    }
&lt;p&gt;    +  }&lt;br/&gt;
    +&lt;br/&gt;
    +  private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def getConversionMapper(&lt;br/&gt;
    +      config: TableConfig,&lt;br/&gt;
    +      inputType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      expectedType: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      conversionOperatorName: String,&lt;br/&gt;
    +      fieldNames: Seq&lt;span class=&quot;error&quot;&gt;&amp;#91;String&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      inputPojoFieldMapping: Option[Array&lt;span class=&quot;error&quot;&gt;&amp;#91;Int&amp;#93;&lt;/span&gt;] = None)&lt;br/&gt;
    +    : MapFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;Any, Row&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +&lt;br/&gt;
    +    val generator = new CodeGenerator(&lt;br/&gt;
    +      config,&lt;br/&gt;
    +      false,&lt;br/&gt;
    +      inputType,&lt;br/&gt;
    +      None,&lt;br/&gt;
    +      inputPojoFieldMapping)&lt;br/&gt;
    +    val conversion = generator.generateConverterResultExpression(expectedType, fieldNames)&lt;br/&gt;
    +&lt;br/&gt;
    +    val body =&lt;br/&gt;
    +      s&quot;&quot;&quot;&lt;br/&gt;
    +         |${conversion.code}&lt;br/&gt;
    +         |return ${conversion.resultTerm};&lt;br/&gt;
    +         |&quot;&quot;&quot;.stripMargin&lt;br/&gt;
    +&lt;br/&gt;
    +    val genFunction = generator.generateFunction(&lt;br/&gt;
    +      conversionOperatorName,&lt;br/&gt;
    +      classOf[MapFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;Row, Row&amp;#93;&lt;/span&gt;],&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Shouldn&apos;t the input type of the generated `MapFunction` be `Any` as like the input type of the wrapping `MapRunner`?&lt;/p&gt;</comment>
                            <comment id="15863046" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100708670&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100708670&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonScan.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,98 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.plan.nodes&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.table.api.TableConfig&lt;br/&gt;
    +import org.apache.flink.table.codegen.CodeGenerator&lt;br/&gt;
    +import org.apache.flink.table.runtime.MapRunner&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Common class for batch and stream scans.&lt;br/&gt;
    +  */&lt;br/&gt;
    +trait CommonScan {&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +    * We check if the input type is exactly the same as the internal row type.&lt;br/&gt;
    +    * A conversion is necessary if types differ or object have to be unboxed&lt;br/&gt;
    +    * (i.e. Date, Time, Timestamp need to be converted into their primitive equivalents).&lt;br/&gt;
    +    */&lt;br/&gt;
    +  private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def needsConversion(&lt;br/&gt;
    +      externalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      internalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +    : Boolean = {&lt;br/&gt;
    +&lt;br/&gt;
    +    if (externalTypeInfo == internalTypeInfo) {&lt;br/&gt;
    +      val rowTypeInfo = externalTypeInfo.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;RowTypeInfo&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +      var containsBoxedTypes = false&lt;br/&gt;
    +      // TODO enable these lines for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    We should either address &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt; in this PR or remove the related code.&lt;/p&gt;</comment>
                            <comment id="15863047" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100708516&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100708516&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,113 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      logicalRowType: RelDataType,&lt;br/&gt;
    +      expectedTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      functionName: String)&lt;br/&gt;
    +    : Option[MapFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;Row, T&amp;#93;&lt;/span&gt;] = {&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate that at least the field types of physical and logical type match&lt;br/&gt;
    +    // we do that here to make sure that plan translation was correct&lt;br/&gt;
    +    val logicalRowTypeInfo = FlinkTypeFactory.toInternalRowTypeInfo(logicalRowType)&lt;br/&gt;
    +    if (physicalRowTypeInfo != logicalRowTypeInfo) &lt;/p&gt;
{
    +      throw TableException(&quot;The field types of physical and logical row types do not match.&quot; +
    +        &quot;This is a bug and should not happen. Please file an issue.&quot;)
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // expected type is a row, no conversion needed&lt;br/&gt;
    +    // TODO this logic will change with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    +    if (expectedTypeInfo.getTypeClass == classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;) &lt;/p&gt;
{
    +      return None
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // convert to type information&lt;br/&gt;
    +    val logicalFieldTypes = logicalRowType.getFieldList.asScala map &lt;/p&gt;
{ relDataType =&amp;gt;
    +      FlinkTypeFactory.toTypeInfo(relDataType.getType)
    +    }
&lt;p&gt;    +    // field names&lt;br/&gt;
    +    val logicalFieldNames = logicalRowType.getFieldNames.asScala&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate expected type&lt;br/&gt;
    +    if (expectedTypeInfo.getArity != logicalFieldTypes.length) &lt;/p&gt;
{
    +      throw new TableException(&quot;Arity of result does not match expected type.&quot;)
    +    }
&lt;p&gt;    +    expectedTypeInfo match {&lt;br/&gt;
    +&lt;br/&gt;
    +      // POJO type expected&lt;br/&gt;
    +      case pt: PojoTypeInfo&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        logicalFieldNames.zip(logicalFieldTypes) foreach {&lt;br/&gt;
    +          case (fName, fType) =&amp;gt;&lt;br/&gt;
    +            val pojoIdx = pt.getFieldIndex(fName)&lt;br/&gt;
    +            if (pojoIdx &amp;lt; 0) &lt;/p&gt;
{
    +              throw new TableException(s&quot;POJO does not define field name: $fName&quot;)
    +            }
&lt;p&gt;    +            val expectedTypeInfo = pt.getTypeAt(pojoIdx)&lt;br/&gt;
    +            if (fType != expectedTypeInfo) &lt;/p&gt;
{
    +              throw new TableException(s&quot;Result field does not match expected type. &quot; +
    +                s&quot;Expected: $expectedTypeInfo; Actual: $fType&quot;)
    +            }
&lt;p&gt;    +        }&lt;br/&gt;
    +&lt;br/&gt;
    +      // Tuple/Case class type expected&lt;br/&gt;
    +      case ct: CompositeType&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        logicalFieldTypes.zipWithIndex foreach {&lt;br/&gt;
    +          case (fieldTypeInfo, i) =&amp;gt;&lt;br/&gt;
    +            val expectedTypeInfo = ct.getTypeAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    +            if (fieldTypeInfo != expectedTypeInfo) &lt;/p&gt;
{
    +              throw new TableException(s&quot;Result field does not match expected type. &quot; +
    +                s&quot;Expected: $expectedTypeInfo; Actual: $fieldTypeInfo&quot;)
    +            }
&lt;p&gt;    +        }&lt;br/&gt;
    +&lt;br/&gt;
    +      // Atomic type expected&lt;br/&gt;
    +      case at: AtomicType&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        val fieldTypeInfo = logicalFieldTypes.head&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Add a check that `logicalFieldTypes.size() == 1`&lt;/p&gt;</comment>
                            <comment id="15863048" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100709080&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100709080&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,113 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `physicalRowTypeInfo` is not really needed here, right? It can be generated from the `logicalRowType`.&lt;/p&gt;</comment>
                            <comment id="15863049" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100708947&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100708947&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonScan.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,98 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.plan.nodes&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.table.api.TableConfig&lt;br/&gt;
    +import org.apache.flink.table.codegen.CodeGenerator&lt;br/&gt;
    +import org.apache.flink.table.runtime.MapRunner&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Common class for batch and stream scans.&lt;br/&gt;
    +  */&lt;br/&gt;
    +trait CommonScan {&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +    * We check if the input type is exactly the same as the internal row type.&lt;br/&gt;
    +    * A conversion is necessary if types differ or object have to be unboxed&lt;br/&gt;
    +    * (i.e. Date, Time, Timestamp need to be converted into their primitive equivalents).&lt;br/&gt;
    +    */&lt;br/&gt;
    +  private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def needsConversion(&lt;br/&gt;
    +      externalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      internalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +    : Boolean = {&lt;br/&gt;
    +&lt;br/&gt;
    +    if (externalTypeInfo == internalTypeInfo) {&lt;br/&gt;
    +      val rowTypeInfo = externalTypeInfo.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;RowTypeInfo&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +      var containsBoxedTypes = false&lt;br/&gt;
    +      // TODO enable these lines for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Not sure if this would work as expected. Shouldn&apos;t we rather change `FlinkTypeFactory.toInternalRowType` to use `long`/`int` for date and time fields? If the types are changed, the internalTypeInfo (which is expected to be equal to the externalTypeInfo) would need to change too.&lt;/p&gt;</comment>
                            <comment id="15863050" author="githubbot" created="Sun, 12 Feb 2017 23:59:28 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100708467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100708467&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,113 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      logicalRowType: RelDataType,&lt;br/&gt;
    +      expectedTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      functionName: String)&lt;br/&gt;
    +    : Option[MapFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;Row, T&amp;#93;&lt;/span&gt;] = {&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate that at least the field types of physical and logical type match&lt;br/&gt;
    +    // we do that here to make sure that plan translation was correct&lt;br/&gt;
    +    val logicalRowTypeInfo = FlinkTypeFactory.toInternalRowTypeInfo(logicalRowType)&lt;br/&gt;
    +    if (physicalRowTypeInfo != logicalRowTypeInfo) &lt;/p&gt;
{
    +      throw TableException(&quot;The field types of physical and logical row types do not match.&quot; +
    +        &quot;This is a bug and should not happen. Please file an issue.&quot;)
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // expected type is a row, no conversion needed&lt;br/&gt;
    +    // TODO this logic will change with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    +    if (expectedTypeInfo.getTypeClass == classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;) &lt;/p&gt;
{
    +      return None
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // convert to type information&lt;br/&gt;
    +    val logicalFieldTypes = logicalRowType.getFieldList.asScala map &lt;/p&gt;
{ relDataType =&amp;gt;
    +      FlinkTypeFactory.toTypeInfo(relDataType.getType)
    +    }
&lt;p&gt;    +    // field names&lt;br/&gt;
    +    val logicalFieldNames = logicalRowType.getFieldNames.asScala&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate expected type&lt;br/&gt;
    +    if (expectedTypeInfo.getArity != logicalFieldTypes.length) &lt;/p&gt;
{
    +      throw new TableException(&quot;Arity of result does not match expected type.&quot;)
    +    }
&lt;p&gt;    +    expectedTypeInfo match {&lt;br/&gt;
    +&lt;br/&gt;
    +      // POJO type expected&lt;br/&gt;
    +      case pt: PojoTypeInfo&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        logicalFieldNames.zip(logicalFieldTypes) foreach {&lt;br/&gt;
    +          case (fName, fType) =&amp;gt;&lt;br/&gt;
    +            val pojoIdx = pt.getFieldIndex(fName)&lt;br/&gt;
    +            if (pojoIdx &amp;lt; 0) &lt;/p&gt;
{
    +              throw new TableException(s&quot;POJO does not define field name: $fName&quot;)
    +            }
&lt;p&gt;    +            val expectedTypeInfo = pt.getTypeAt(pojoIdx)&lt;br/&gt;
    +            if (fType != expectedTypeInfo) &lt;/p&gt;
{
    +              throw new TableException(s&quot;Result field does not match expected type. &quot; +
    +                s&quot;Expected: $expectedTypeInfo; Actual: $fType&quot;)
    +            }
&lt;p&gt;    +        }&lt;br/&gt;
    +&lt;br/&gt;
    +      // Tuple/Case class type expected&lt;br/&gt;
    +      case ct: CompositeType&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    `CompositeType` -&amp;gt; `TupleTypeInfoBase`. Covers tuples and case classes and Row.&lt;/p&gt;</comment>
                            <comment id="15863363" author="githubbot" created="Mon, 13 Feb 2017 09:11:33 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100749561&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100749561&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -170,7 +171,7 @@ abstract class BatchTableEnvironment(&lt;br/&gt;
       private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def explain(table: Table, extended: Boolean): String = {&lt;br/&gt;
         val ast = table.getRelNode&lt;br/&gt;
         val optimizedPlan = optimize(ast)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan) (TypeExtractor.createTypeInfo(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;))&lt;br/&gt;
    +    val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan, ast.getRowType) (new RowTypeInfo())
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    This is the problem described in the issue description of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5662&quot; title=&quot;Alias in front of output fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5662&quot;&gt;&lt;del&gt;FLINK-5662&lt;/del&gt;&lt;/a&gt;. The optimize does not change the types of the fields but their names. This might be a Calcite bug but until then we need the logical type for the sink conversion.&lt;/p&gt;</comment>
                            <comment id="15863365" author="githubbot" created="Mon, 13 Feb 2017 09:13:17 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100749841&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100749841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -285,28 +286,37 @@ abstract class BatchTableEnvironment(&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;br/&gt;
       protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(table: Table)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = 
{
    -    val dataSetPlan = optimize(table.getRelNode)
    -    translate(dataSetPlan)
    +    val relNode = table.getRelNode
    +    val dataSetPlan = optimize(relNode)
    +    translate(dataSetPlan, relNode.getRowType)
       }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;       /**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;br/&gt;
    +    * Translates a logical [&lt;span class=&quot;error&quot;&gt;&amp;#91;RelNode&amp;#93;&lt;/span&gt;] into a [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;]. Converts to target type if necessary.&lt;br/&gt;
         *&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@param logicalPlan The root node of the relational expression tree.&lt;/li&gt;
	&lt;li&gt;@param tpe         The [&lt;span class=&quot;error&quot;&gt;&amp;#91;TypeInformation&amp;#93;&lt;/span&gt;] of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@tparam A The type of the resulting [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;].&lt;/li&gt;
	&lt;li&gt;@return The [&lt;span class=&quot;error&quot;&gt;&amp;#91;DataSet&amp;#93;&lt;/span&gt;] that corresponds to the translated [&lt;span class=&quot;error&quot;&gt;&amp;#91;Table&amp;#93;&lt;/span&gt;].&lt;br/&gt;
         */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(logicalPlan: RelNode)(implicit tpe: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;): DataSet&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt; = {&lt;br/&gt;
    +  protected def translate&lt;span class=&quot;error&quot;&gt;&amp;#91;A&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      logicalPlan: RelNode,&lt;br/&gt;
    +      logicalType: RelDataType)
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    See my explanation above. Thanks, I will add some comments.&lt;/p&gt;</comment>
                            <comment id="15863377" author="githubbot" created="Mon, 13 Feb 2017 09:23:09 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100751589&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100751589&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,113 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes, I just thought it make sense to check the two paths of logical types and translation somewhere. I will add more comments to this method.&lt;/p&gt;</comment>
                            <comment id="15863458" author="githubbot" created="Mon, 13 Feb 2017 10:49:20 +0000"  >&lt;p&gt;Github user twalthr commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100767364&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100767364&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonScan.scala &amp;#8212;&lt;br/&gt;
    @@ -0,0 +1,98 @@&lt;br/&gt;
    +/*&lt;br/&gt;
    + * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
    + * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
    + * distributed with this work for additional information&lt;br/&gt;
    + * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
    + * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
    + * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
    + * with the License.  You may obtain a copy of the License at&lt;br/&gt;
    + *&lt;br/&gt;
    + *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
    + *&lt;br/&gt;
    + * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
    + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
    + * See the License for the specific language governing permissions and&lt;br/&gt;
    + * limitations under the License.&lt;br/&gt;
    + */&lt;br/&gt;
    +&lt;br/&gt;
    +package org.apache.flink.table.plan.nodes&lt;br/&gt;
    +&lt;br/&gt;
    +import org.apache.flink.api.common.functions.MapFunction&lt;br/&gt;
    +import org.apache.flink.api.common.typeinfo.TypeInformation&lt;br/&gt;
    +import org.apache.flink.api.java.typeutils.RowTypeInfo&lt;br/&gt;
    +import org.apache.flink.table.api.TableConfig&lt;br/&gt;
    +import org.apache.flink.table.codegen.CodeGenerator&lt;br/&gt;
    +import org.apache.flink.table.runtime.MapRunner&lt;br/&gt;
    +import org.apache.flink.types.Row&lt;br/&gt;
    +&lt;br/&gt;
    +/**&lt;br/&gt;
    +  * Common class for batch and stream scans.&lt;br/&gt;
    +  */&lt;br/&gt;
    +trait CommonScan {&lt;br/&gt;
    +&lt;br/&gt;
    +  /**&lt;br/&gt;
    +    * We check if the input type is exactly the same as the internal row type.&lt;br/&gt;
    +    * A conversion is necessary if types differ or object have to be unboxed&lt;br/&gt;
    +    * (i.e. Date, Time, Timestamp need to be converted into their primitive equivalents).&lt;br/&gt;
    +    */&lt;br/&gt;
    +  private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def needsConversion(&lt;br/&gt;
    +      externalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Any&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      internalTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    +    : Boolean = {&lt;br/&gt;
    +&lt;br/&gt;
    +    if (externalTypeInfo == internalTypeInfo) {&lt;br/&gt;
    +      val rowTypeInfo = externalTypeInfo.asInstanceOf&lt;span class=&quot;error&quot;&gt;&amp;#91;RowTypeInfo&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +      var containsBoxedTypes = false&lt;br/&gt;
    +      // TODO enable these lines for &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I removed the lines for now. Actually, I wanted to change the internal row type to `long/int` in this PR but then I realized the complexity. I think we should do that as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15863473" author="githubbot" created="Mon, 13 Feb 2017 10:59:26 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Thanks for reviewing @KurtYoung and @fhueske. I updated the PR.&lt;/p&gt;</comment>
                            <comment id="15863495" author="githubbot" created="Mon, 13 Feb 2017 11:20:06 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100772114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100772114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,123 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    *&lt;br/&gt;
    +    * @param physicalRowTypeInfo the input of the sink&lt;br/&gt;
    +    * @param logicalRowType the logical type with correct field names (esp. for POJO field mapping)&lt;br/&gt;
    +    * @param expectedTypeInfo the outptu type of the sink&lt;br/&gt;
    +    * @param functionName name of the map function. Must not be unique but has to be a&lt;br/&gt;
    +    *                     valid Java class identifier.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      logicalRowType: RelDataType,&lt;br/&gt;
    +      expectedTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Change `expected` to `requested` in the error messages and variable names of this method?&lt;/p&gt;</comment>
                            <comment id="15863496" author="githubbot" created="Mon, 13 Feb 2017 11:20:06 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100772133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100772133&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,123 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    *&lt;br/&gt;
    +    * @param physicalRowTypeInfo the input of the sink&lt;br/&gt;
    +    * @param logicalRowType the logical type with correct field names (esp. for POJO field mapping)&lt;br/&gt;
    +    * @param expectedTypeInfo the outptu type of the sink&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    typo&lt;/p&gt;</comment>
                            <comment id="15863497" author="githubbot" created="Mon, 13 Feb 2017 11:20:06 +0000"  >&lt;p&gt;Github user fhueske commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100771883&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100771883&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/TableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -428,6 +431,123 @@ abstract class TableEnvironment(val config: TableConfig) &lt;/p&gt;
{
         (fieldNames.toArray, fieldIndexes.toArray)
       }

&lt;p&gt;    +  /**&lt;br/&gt;
    +    * Creates a final converter that maps the internal row type to external type.&lt;br/&gt;
    +    *&lt;br/&gt;
    +    * @param physicalRowTypeInfo the input of the sink&lt;br/&gt;
    +    * @param logicalRowType the logical type with correct field names (esp. for POJO field mapping)&lt;br/&gt;
    +    * @param expectedTypeInfo the outptu type of the sink&lt;br/&gt;
    +    * @param functionName name of the map function. Must not be unique but has to be a&lt;br/&gt;
    +    *                     valid Java class identifier.&lt;br/&gt;
    +    */&lt;br/&gt;
    +  protected def sinkConversion&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;(&lt;br/&gt;
    +      physicalRowTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      logicalRowType: RelDataType,&lt;br/&gt;
    +      expectedTypeInfo: TypeInformation&lt;span class=&quot;error&quot;&gt;&amp;#91;T&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    +      functionName: String)&lt;br/&gt;
    +    : Option[MapFunction&lt;span class=&quot;error&quot;&gt;&amp;#91;Row, T&amp;#93;&lt;/span&gt;] = {&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate that at least the field types of physical and logical type match&lt;br/&gt;
    +    // we do that here to make sure that plan translation was correct&lt;br/&gt;
    +    val logicalRowTypeInfo = FlinkTypeFactory.toInternalRowTypeInfo(logicalRowType)&lt;br/&gt;
    +    if (physicalRowTypeInfo != logicalRowTypeInfo) &lt;/p&gt;
{
    +      throw TableException(&quot;The field types of physical and logical row types do not match.&quot; +
    +        &quot;This is a bug and should not happen. Please file an issue.&quot;)
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // expected type is a row, no conversion needed&lt;br/&gt;
    +    // TODO this logic will change with &lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-5429&quot; title=&quot;Code generate types between operators in Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-5429&quot;&gt;&lt;del&gt;FLINK-5429&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    +    if (expectedTypeInfo.getTypeClass == classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;) &lt;/p&gt;
{
    +      return None
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // convert to type information&lt;br/&gt;
    +    val logicalFieldTypes = logicalRowType.getFieldList.asScala map &lt;/p&gt;
{ relDataType =&amp;gt;
    +      FlinkTypeFactory.toTypeInfo(relDataType.getType)
    +    }
&lt;p&gt;    +    // field names&lt;br/&gt;
    +    val logicalFieldNames = logicalRowType.getFieldNames.asScala&lt;br/&gt;
    +&lt;br/&gt;
    +    // validate expected type&lt;br/&gt;
    +    if (expectedTypeInfo.getArity != logicalFieldTypes.length) &lt;/p&gt;
{
    +      throw new TableException(&quot;Arity of result does not match expected type.&quot;)
    +    }
&lt;p&gt;    +    expectedTypeInfo match {&lt;br/&gt;
    +&lt;br/&gt;
    +      // POJO type expected&lt;br/&gt;
    +      case pt: PojoTypeInfo&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        logicalFieldNames.zip(logicalFieldTypes) foreach {&lt;br/&gt;
    +          case (fName, fType) =&amp;gt;&lt;br/&gt;
    +            val pojoIdx = pt.getFieldIndex(fName)&lt;br/&gt;
    +            if (pojoIdx &amp;lt; 0) &lt;/p&gt;
{
    +              throw new TableException(s&quot;POJO does not define field name: $fName&quot;)
    +            }
&lt;p&gt;    +            val expectedTypeInfo = pt.getTypeAt(pojoIdx)&lt;br/&gt;
    +            if (fType != expectedTypeInfo) &lt;/p&gt;
{
    +              throw new TableException(s&quot;Result field does not match expected type. &quot; +
    +                s&quot;Expected: $expectedTypeInfo; Actual: $fType&quot;)
    +            }
&lt;p&gt;    +        }&lt;br/&gt;
    +&lt;br/&gt;
    +      // Tuple/Case class type expected&lt;br/&gt;
    +      case ct: TupleTypeInfoBase&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        logicalFieldTypes.zipWithIndex foreach {&lt;br/&gt;
    +          case (fieldTypeInfo, i) =&amp;gt;&lt;br/&gt;
    +            val expectedTypeInfo = ct.getTypeAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
    +            if (fieldTypeInfo != expectedTypeInfo) &lt;/p&gt;
{
    +              throw new TableException(s&quot;Result field does not match expected type. &quot; +
    +                s&quot;Expected: $expectedTypeInfo; Actual: $fieldTypeInfo&quot;)
    +            }
&lt;p&gt;    +        }&lt;br/&gt;
    +&lt;br/&gt;
    +      // Atomic type expected&lt;br/&gt;
    +      case at: AtomicType&lt;span class=&quot;error&quot;&gt;&amp;#91;_&amp;#93;&lt;/span&gt; =&amp;gt;&lt;br/&gt;
    +        if (logicalFieldTypes.size != 1) {&lt;br/&gt;
    +          throw new TableException(s&quot;Result does not have a single field, &quot; +&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Improve error message: &quot;Requested result type is an atomic type but result has more than a single field.&quot;&lt;/p&gt;</comment>
                            <comment id="15863762" author="githubbot" created="Mon, 13 Feb 2017 14:42:39 +0000"  >&lt;p&gt;Github user KurtYoung commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277#discussion_r100807305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277#discussion_r100807305&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: flink-libraries/flink-table/src/main/scala/org/apache/flink/table/api/BatchTableEnvironment.scala &amp;#8212;&lt;br/&gt;
    @@ -170,7 +171,7 @@ abstract class BatchTableEnvironment(&lt;br/&gt;
       private&lt;span class=&quot;error&quot;&gt;&amp;#91;flink&amp;#93;&lt;/span&gt; def explain(table: Table, extended: Boolean): String = {&lt;br/&gt;
         val ast = table.getRelNode&lt;br/&gt;
         val optimizedPlan = optimize(ast)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan) (TypeExtractor.createTypeInfo(classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;))&lt;br/&gt;
    +    val dataSet = translate&lt;span class=&quot;error&quot;&gt;&amp;#91;Row&amp;#93;&lt;/span&gt;(optimizedPlan, ast.getRowType) (new RowTypeInfo())
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Ok, make sense to me.&lt;/p&gt;</comment>
                            <comment id="15863822" author="githubbot" created="Mon, 13 Feb 2017 15:26:21 +0000"  >&lt;p&gt;Github user twalthr commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Merging this...&lt;/p&gt;</comment>
                            <comment id="15863966" author="twalthr" created="Mon, 13 Feb 2017 16:53:00 +0000"  >&lt;p&gt;Fixed in 1.3.0: 6bc6b225e55095eb8797db2903b0546410e7fdd9&lt;/p&gt;</comment>
                            <comment id="15863972" author="githubbot" created="Mon, 13 Feb 2017 16:56:22 +0000"  >&lt;p&gt;Github user twalthr closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/flink/pull/3277&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/flink/pull/3277&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39953:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>