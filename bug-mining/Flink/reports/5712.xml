<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 20:59:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FLINK-23813] DeleteExecutor NPE</title>
                <link>https://issues.apache.org/jira/browse/FLINK-23813</link>
                <project id="12315522" key="FLINK">Flink</project>
                    <description>&lt;p&gt;Encountered a situation where I get an NPE from JDBCUpsertOutputFormat.&lt;/p&gt;

&lt;p&gt;This occurs when&#160;jdbc disconnected and try to reconnect.&lt;/p&gt;

&lt;p&gt;I need to write data to mysql in upsert way in sql, So it must group by unique key and the&#160;JdbcBatchingOutputFormat of Jdbc sink would use TableJdbcUpsertOutputFormat.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Jdbc would&#160;disconnected when&#160;The data interval exceeds the set connection time.I see that when jdbc&#160;reconnect , only&#160;JdbcBatchingOutputFormat#jdbcStatementExecutor(insert) would&#160;prepareStatements but&#160;TableJdbcUpsertOutputFormat#deleteExecutor would not&#160;prepareStatements so that come up NPE.&lt;/p&gt;

&lt;p&gt;if in&#160;JdbcBatchingOutputFormat have a protected function to reset&#160;PrepareStatement and&#160;TableJdbcUpsertOutputFormat override this function to reset deleteExecutor, it would work well.&lt;/p&gt;

&lt;p&gt;prepareStatements&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13395473">FLINK-23813</key>
            <summary>DeleteExecutor NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roman">Roman Khachatryan</assignee>
                                    <reporter username="Akihito Liang">Junning Liang</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 16 Aug 2021 12:50:51 +0000</created>
                <updated>Mon, 30 Aug 2021 20:29:35 +0000</updated>
                            <resolved>Fri, 20 Aug 2021 12:21:27 +0000</resolved>
                                    <version>1.14.0</version>
                    <version>1.12.5</version>
                    <version>1.13.2</version>
                                    <fixVersion>1.14.0</fixVersion>
                    <fixVersion>1.13.3</fixVersion>
                                    <component>Connectors / JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17400246" author="xintongsong" created="Tue, 17 Aug 2021 08:28:26 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt;&lt;br/&gt;
Would you please help check on this?&lt;/p&gt;</comment>
                            <comment id="17400471" author="roman_khachatryan" created="Tue, 17 Aug 2021 16:19:38 +0000"  >&lt;p&gt;Sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xtsong&quot; class=&quot;user-hover&quot; rel=&quot;xtsong&quot;&gt;xtsong&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Akihito+Liang&quot; class=&quot;user-hover&quot; rel=&quot;Akihito Liang&quot;&gt;Akihito Liang&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160;if in&#160;JdbcBatchingOutputFormat have a protected function to reset&#160;PrepareStatement&#160;&lt;/p&gt;

&lt;p&gt;I think that function is&#160;JdbcOutputFormat.updateExecutor. It is called if attemptFlush() fails; the latter is already overriden in&#160;TableJdbcUpsertOutputFormat. It can also override&#160;updateExecutor to update its own deleteExecutor.&lt;/p&gt;

&lt;p&gt;WDYT?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;However, could you please provide the stacktrace (or a test case), just to be sure we are fixing the right problem?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jark&quot; class=&quot;user-hover&quot; rel=&quot;jark&quot;&gt;jark&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arvid&quot; class=&quot;user-hover&quot; rel=&quot;arvid&quot;&gt;arvid&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17400727" author="akihito liang" created="Wed, 18 Aug 2021 02:50:39 +0000"  >&lt;p&gt;hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roman_khachatryan&quot; class=&quot;user-hover&quot; rel=&quot;roman_khachatryan&quot;&gt;roman_khachatryan&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;this is the deepest stacktrace.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13032088/13032088_image-2021-08-18-10-49-43-941.png&quot; height=&quot;317&quot; width=&quot;957&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17402180" author="roman_khachatryan" created="Fri, 20 Aug 2021 12:19:42 +0000"  >&lt;p&gt;Thanks for the details &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Akihito+Liang&quot; class=&quot;user-hover&quot; rel=&quot;Akihito Liang&quot;&gt;Akihito Liang&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The fix merged for 1.14 and 1.13 as dfac7629819fad231ea5f0a0a0aa574299dd083b and 669f3b56b4c2999fd76c42504dbfa246684dcf34 accordingly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As for 1.12, it would require backporting qutie some refactoring. As&#160;Flink &lt;a href=&quot;https://flink.apache.org/downloads.html#update-policy-for-old-releases&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;update policy&lt;/a&gt; ony requires backporting to a single release, I&apos;m going to remove 1.12.6 from the Fix versions unless there are any concerns.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13032088" name="image-2021-08-18-10-49-43-941.png" size="221427" author="Akihito Liang" created="Wed, 18 Aug 2021 02:49:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ty2g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>