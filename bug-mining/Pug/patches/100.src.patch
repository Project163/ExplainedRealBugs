diff --git a/lib/compiler.js b/lib/compiler.js
index 82e78d4..3d8573e 100644
--- a/lib/compiler.js
+++ b/lib/compiler.js
@@ -566,15 +566,16 @@ Compiler.prototype = {
     this.buf.push(''
       + '// iterate ' + each.obj + '\n'
       + ';(function(){\n'
-      + '  if (\'number\' == typeof ' + each.obj + '.length) {\n');
+      + '  var $$obj = ' + each.obj + ';\n'
+      + '  if (\'number\' == typeof $$obj.length) {\n');
 
     if (each.alternative) {
-      this.buf.push('  if (' + each.obj + '.length) {');
+      this.buf.push('  if ($$obj.length) {');
     }
 
     this.buf.push(''
-      + '    for (var ' + each.key + ' = 0, $$l = ' + each.obj + '.length; ' + each.key + ' < $$l; ' + each.key + '++) {\n'
-      + '      var ' + each.val + ' = ' + each.obj + '[' + each.key + '];\n');
+      + '    for (var ' + each.key + ' = 0, $$l = $$obj.length; ' + each.key + ' < $$l; ' + each.key + '++) {\n'
+      + '      var ' + each.val + ' = $$obj[' + each.key + '];\n');
 
     this.visit(each.block);
 
@@ -589,18 +590,14 @@ Compiler.prototype = {
     this.buf.push(''
       + '  } else {\n'
       + '    var $$l = 0;\n'
-      + '    for (var ' + each.key + ' in ' + each.obj + ') {\n'
+      + '    for (var ' + each.key + ' in $$obj) {\n'
       + '      $$l++;'
-      // if browser
-      // + '      if (' + each.obj + '.hasOwnProperty(' + each.key + ')){'
-      // end
-      + '      var ' + each.val + ' = ' + each.obj + '[' + each.key + '];\n');
+       + '      if ($$obj.hasOwnProperty(' + each.key + ')){'
+      + '      var ' + each.val + ' = $$obj[' + each.key + '];\n');
 
     this.visit(each.block);
 
-    // if browser
-    // this.buf.push('      }\n');
-    // end
+    this.buf.push('      }\n');
 
     this.buf.push('    }\n');
     if (each.alternative) {
