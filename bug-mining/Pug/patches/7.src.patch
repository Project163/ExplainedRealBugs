diff --git a/lib/jade.js b/lib/jade.js
index cefeea7..7d7525a 100644
--- a/lib/jade.js
+++ b/lib/jade.js
@@ -470,11 +470,10 @@ Parser.prototype = {
                                     codeClass = val;
                                 }
                             } else {
-                                attrs[key] = val
-                                    ? val
-                                    : html5
-                                        ? undefined
-                                        : '"' + key + '"';
+                                attrs[key] = val === undefined
+                                    ? true
+                                    : val;
+                                attrs.html5 = html5;
                             }
                         }
                         continue;
@@ -556,17 +555,27 @@ Parser.prototype = {
 
 function attrs(obj){
     var buf = [],
-        keys = Object.keys(obj),
+        html5 = obj.html5;
+    delete obj.html5;
+    var keys = Object.keys(obj);
         len = keys.length;
     if (len) {
         buf.push('');
         for (var i = 0; i < len; ++i) {
             var key = keys[i],
                 val = obj[key];
-            if (val) {
-                buf.push(key + '="' + escape(val) + '"');
+            if (html5) {
+                if (typeof val === 'boolean') {
+                    if (val) buf.push(key);
+                } else {
+                    buf.push(key + '="' + escape(val) + '"');
+                }
             } else {
-                buf.push(key);
+                if (typeof val === 'boolean') {
+                    if (val) buf.push(key + '="' + key + '"');
+                } else {
+                    buf.push(key + '="' + escape(val) + '"');
+                }
             }
         }
     }
