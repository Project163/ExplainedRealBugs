diff --git a/lib/jade.js b/lib/jade.js
index cfe9e73..13f104a 100644
--- a/lib/jade.js
+++ b/lib/jade.js
@@ -378,8 +378,9 @@ Parser.prototype = {
      */
     
     parseDoctype: function(){
-        var tok = this.expect('doctype');
-        return "buf.push('" + doctypes[tok.val || 'default'] + "');";
+        var name = this.expect('doctype').val;
+        if (name === '5') this.mode = 'html 5';
+        return "buf.push('" + doctypes[name || 'default'] + "');";
     },
     
     /**
@@ -435,6 +436,7 @@ Parser.prototype = {
     
     parseTag: function(){
         var name = this.advance.val,
+            html5 = this.mode === 'html 5',
             hasAttrs = false,
             attrBuf = '',
             codeClass = '',
@@ -468,7 +470,11 @@ Parser.prototype = {
                                     codeClass = val;
                                 }
                             } else {
-                                attrs[key] = val;
+                                attrs[key] = val
+                                    ? val
+                                    : html5
+                                        ? undefined
+                                        : '"' + key + '"';
                             }
                         }
                         continue;
@@ -529,7 +535,7 @@ Parser.prototype = {
         // Build the tag
         if (selfClosing.indexOf(name) >= 0) {
             return [
-                "buf.push('<" + name + attrBuf + " />');",
+                "buf.push('<" + name + attrBuf + (html5 ? '' : ' /' ) + ">');",
                 buf.join('\n')
             ].join('\n');
         } else {
@@ -559,11 +565,11 @@ function attrs(obj){
         for (var i = 0; i < len; ++i) {
             var key = keys[i],
                 val = obj[key];
-            // Boolean
-            if (val === undefined) {
-                val = key;
+            if (val) {
+                buf.push(key + '="' + escape(val) + '"');
+            } else {
+                buf.push(key);
             }
-            buf.push(key + '="' + escape(val) + '"');
         }
     }
     return buf.join(' ');
diff --git a/test/jade.test.js b/test/jade.test.js
index 2dadb8a..112b801 100644
--- a/test/jade.test.js
+++ b/test/jade.test.js
@@ -273,7 +273,7 @@ module.exports = {
     },
     
     'test html 5 mode': function(assert){
-        assert.equal('<!DOCTYPE html>\n<input type="checked" checked>', render('!!! 5\ninput(type="checkbox", checked)'));
+        assert.equal('<!DOCTYPE html><input type="checkbox" checked>', render('!!! 5\ninput(type="checkbox", checked)'));
     },
     
     'test attrs': function(assert){
