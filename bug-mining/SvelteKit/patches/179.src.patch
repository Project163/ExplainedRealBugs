diff --git a/documentation/docs/12-adapters.md b/documentation/docs/12-adapters.md
index fcf7e76e7..aae3baa68 100644
--- a/documentation/docs/12-adapters.md
+++ b/documentation/docs/12-adapters.md
@@ -78,7 +78,7 @@ Adapters packages must implement the following API, which creates an `Adapter`:
 
 ```js
 // @filename: ambient.d.ts
-const AdapterSpecificOptions = any;
+type AdapterSpecificOptions = any;
 
 // @filename: index.js
 // ---cut---
diff --git a/documentation/docs/17-types.md b/documentation/docs/17-types.md
index 1d11c1351..b885fe878 100644
--- a/documentation/docs/17-types.md
+++ b/documentation/docs/17-types.md
@@ -10,7 +10,7 @@ The `RequestHandler` and `Load` types both accept a `Params` argument allowing y
 
 ```js
 /// file: src/routes/[foo]/[bar]/[baz]/+page.server.js
-// @errors: 2355
+// @errors: 2355 2322
 /** @type {import('@sveltejs/kit').RequestHandler<{
  *   foo: string;
  *   bar: string;
@@ -30,7 +30,7 @@ To solve this problem, SvelteKit generates `.d.ts` files for each of your endpoi
 /// link: false
 import type * as Kit from '@sveltejs/kit';
 
-interface RouteParams {
+type RouteParams = {
 	foo: string;
 	bar: string;
 	baz: string;
@@ -47,7 +47,7 @@ These files can be imported into your endpoints and pages as siblings, thanks to
 // @filename: $types.d.ts
 import type * as Kit from '@sveltejs/kit';
 
-interface RouteParams {
+type RouteParams = {
 	foo: string;
 	bar: string;
 	baz: string;
@@ -69,7 +69,7 @@ export async function GET({ params }) {
 // @filename: $types.d.ts
 import type * as Kit from '@sveltejs/kit';
 
-interface RouteParams {
+type RouteParams = {
 	foo: string;
 	bar: string;
 	baz: string;
diff --git a/documentation/docs/20-accessibility.md b/documentation/docs/20-accessibility.md
index b725f320f..231625c37 100644
--- a/documentation/docs/20-accessibility.md
+++ b/documentation/docs/20-accessibility.md
@@ -65,7 +65,6 @@ If your content is available in multiple languages, you should set the `lang` at
 /// file: src/hooks.server.js
 /**
  * @param {import('@sveltejs/kit').RequestEvent} event
- * @returns {string}
  */
 function get_lang(event) {
 	return 'en';
diff --git a/pnpm-lock.yaml b/pnpm-lock.yaml
index 40ed28f28..d6a086a9b 100644
--- a/pnpm-lock.yaml
+++ b/pnpm-lock.yaml
@@ -697,12 +697,14 @@ importers:
       '@sveltejs/site-kit': ^2.1.2
       '@types/node': ^16.11.36
       flexsearch: ^0.7.31
+      magic-string: ^0.26.2
       marked: ^4.1.1
       prism-svelte: ^0.5.0
       prismjs: ^1.29.0
       shiki-twoslash: ^3.1.0
       svelte: ^3.48.0
       typescript: ^4.8.2
+      uvu: ^0.5.3
       vite: ^3.1.1
       vite-imagetools: ^4.0.10
     devDependencies:
@@ -713,12 +715,14 @@ importers:
       '@sveltejs/site-kit': 2.1.2
       '@types/node': 16.11.42
       flexsearch: 0.7.31
+      magic-string: 0.26.3
       marked: 4.1.1
       prism-svelte: 0.5.0
       prismjs: 1.29.0
       shiki-twoslash: 3.1.0
       svelte: 3.48.0
       typescript: 4.8.2
+      uvu: 0.5.6
       vite: 3.1.1
       vite-imagetools: 4.0.10
 
@@ -2929,7 +2933,6 @@ packages:
     engines: {node: '>=12'}
     dependencies:
       sourcemap-codec: 1.4.8
-    dev: false
 
   /magic-string/0.26.6:
     resolution: {integrity: sha512-6d+3bFybzyQFJYSoRsl9ZC0wheze8M1LrQC7tNMRqXR4izUTDOLMd9BtSuExK9iAukFh+s5K0WAhc/dlQ+HKYA==}
diff --git a/sites/kit.svelte.dev/package.json b/sites/kit.svelte.dev/package.json
index 570e311a1..2d3076bea 100644
--- a/sites/kit.svelte.dev/package.json
+++ b/sites/kit.svelte.dev/package.json
@@ -5,7 +5,8 @@
 		"dev": "vite dev",
 		"build": "vite build",
 		"prebuild": "test \"$CI\" = true && npx pnpm install --store=node_modules/.pnpm-store || echo skipping pnpm install",
-		"preview": "vite preview"
+		"preview": "vite preview",
+		"test": "uvu src \"(spec\\.js|test[\\\\/]index\\.js)\""
 	},
 	"devDependencies": {
 		"@sveltejs/adapter-auto": "workspace:*",
@@ -15,12 +16,14 @@
 		"@sveltejs/site-kit": "^2.1.2",
 		"@types/node": "^16.11.36",
 		"flexsearch": "^0.7.31",
+		"magic-string": "^0.26.2",
 		"marked": "^4.1.1",
 		"prism-svelte": "^0.5.0",
 		"prismjs": "^1.29.0",
 		"shiki-twoslash": "^3.1.0",
 		"svelte": "^3.48.0",
 		"typescript": "^4.8.2",
+		"uvu": "^0.5.3",
 		"vite": "^3.1.1",
 		"vite-imagetools": "^4.0.10"
 	},
diff --git a/sites/kit.svelte.dev/src/app.html b/sites/kit.svelte.dev/src/app.html
index ab1550f5e..0f548df3b 100644
--- a/sites/kit.svelte.dev/src/app.html
+++ b/sites/kit.svelte.dev/src/app.html
@@ -1,5 +1,5 @@
 <!DOCTYPE html>
-<html lang="en" class="theme-default typo-default">
+<html lang="en" class="theme-default typo-default no-js">
 	<head>
 		<meta charset="utf-8" />
 		<meta name="viewport" content="width=device-width" />
@@ -14,6 +14,27 @@
 		<meta name="twitter:image" content="/images/twitter-thumbnail.jpg" />
 		<meta name="og:image" content="/images/twitter-thumbnail.jpg" />
 
+		<!-- add inline style and blocking script to prevent content flash/jump -->
+		<style>
+			.code-block.ts-version {
+				display: none;
+			}
+			.prefers-ts .code-block.js-version {
+				display: none;
+			}
+			.prefers-ts .code-block.ts-version {
+				display: block;
+			}
+			.no-js .ts-toggle {
+				display: none;
+			}
+		</style>
+		<script>
+			document.getElementsByTagName('html')[0].classList.remove('no-js');
+			localStorage.getItem('prefers-ts') === 'true' &&
+				document.documentElement.classList.add('prefers-ts');
+		</script>
+
 		%sveltekit.head%
 	</head>
 	<body>
diff --git a/sites/kit.svelte.dev/src/lib/docs/Checkbox.svelte b/sites/kit.svelte.dev/src/lib/docs/Checkbox.svelte
new file mode 100644
index 000000000..caf61211d
--- /dev/null
+++ b/sites/kit.svelte.dev/src/lib/docs/Checkbox.svelte
@@ -0,0 +1,63 @@
+<script>
+	export let checked;
+</script>
+
+<input type="checkbox" bind:checked />
+
+<style>
+	input[type='checkbox'] {
+		--size: 1.2em;
+		--bg: rgba(255, 255, 255, 0.2);
+		--fg: white;
+		--bg-active: var(--bg);
+		--fg-active: var(--fg);
+		position: relative;
+		height: var(--size);
+		width: calc(100% - 0.6em);
+		max-width: calc(2 * var(--size));
+		top: -2px;
+		border-radius: 0.5em;
+		-webkit-appearance: none;
+		appearance: none;
+		outline: none;
+		border: transparent;
+	}
+
+	input[type='checkbox']::before {
+		content: '';
+		position: absolute;
+		display: block;
+		height: 100%;
+		width: 100%;
+		padding: 2px;
+		border-radius: var(--size);
+		top: 0;
+		left: 0;
+		background: var(--bg);
+		box-sizing: border-box;
+	}
+
+	input[type='checkbox']:checked::before {
+		background: var(--bg-active);
+	}
+
+	input[type='checkbox']::after {
+		content: '';
+		position: absolute;
+		display: block;
+		width: calc(var(--size) - 4px);
+		height: calc(var(--size) - 4px);
+		aspect-ratio: 1;
+		top: 2px;
+		left: 2px;
+		border-radius: 50%;
+		background: var(--fg);
+		box-shadow: 0 0px 1px rgba(0, 0, 0, 0.4), 0 4px 2px rgba(0, 0, 0, 0.1);
+		transition: background 0.2s ease-out, left 0.2s ease-out;
+	}
+
+	input[type='checkbox']:checked::after {
+		background: var(--fg-active);
+		left: calc(100% - var(--size) + 2px);
+	}
+</style>
diff --git a/sites/kit.svelte.dev/src/lib/docs/Contents.svelte b/sites/kit.svelte.dev/src/lib/docs/Contents.svelte
index dbed3dfcf..f806e7350 100644
--- a/sites/kit.svelte.dev/src/lib/docs/Contents.svelte
+++ b/sites/kit.svelte.dev/src/lib/docs/Contents.svelte
@@ -2,6 +2,7 @@
 	import { onMount } from 'svelte';
 	import { afterNavigate } from '$app/navigation';
 	import { page } from '$app/stores';
+	import TSToggle from './TSToggle.svelte';
 
 	export let contents = [];
 
@@ -129,6 +130,10 @@
 	</ul>
 </nav>
 
+<div class="ts-toggle">
+	<TSToggle />
+</div>
+
 <style>
 	nav {
 		top: 0;
@@ -211,6 +216,12 @@
 		color: white;
 	}
 
+	.ts-toggle {
+		border-top: 1px solid rgba(255, 255, 255, 0.2);
+		background-color: var(--second);
+		color: white;
+	}
+
 	@media (min-width: 600px) {
 		.sidebar {
 			columns: 2;
@@ -230,11 +241,10 @@
 			content: '';
 			position: fixed;
 			left: 0;
-			bottom: 0;
+			bottom: calc(42px + var(--ukr-footer-height));
 			width: var(--sidebar-w);
 			height: 2em;
 			pointer-events: none;
-			height: var(--top-offset);
 			background: linear-gradient(
 				to bottom,
 				rgba(103, 103, 120, 0) 0%,
@@ -242,5 +252,13 @@
 				rgba(103, 103, 120, 1) 100%
 			);
 		}
+
+		.ts-toggle {
+			position: fixed;
+			width: var(--sidebar-w);
+			bottom: var(--ukr-footer-height);
+			z-index: 1;
+			margin-right: 0;
+		}
 	}
 </style>
diff --git a/sites/kit.svelte.dev/src/lib/docs/TSToggle.svelte b/sites/kit.svelte.dev/src/lib/docs/TSToggle.svelte
new file mode 100644
index 000000000..ff30709ae
--- /dev/null
+++ b/sites/kit.svelte.dev/src/lib/docs/TSToggle.svelte
@@ -0,0 +1,42 @@
+<script>
+	import Checkbox from './Checkbox.svelte';
+
+	let checked = prefers_ts();
+	$: toggle(checked);
+
+	function toggle(checked) {
+		try {
+			document.documentElement.classList.toggle('prefers-ts', checked);
+			localStorage.setItem('prefers-ts', checked);
+		} catch (e) {
+			// localStorage not available or we are on the server
+		}
+	}
+
+	function prefers_ts() {
+		try {
+			return localStorage.getItem('prefers-ts') === 'true' ? true : false;
+		} catch (e) {
+			return false;
+		}
+	}
+</script>
+
+<!-- svelte-ignore a11y-label-has-associated-control -->
+<label class="input-output-toggle">
+	JavaScript <Checkbox bind:checked /> TypeScript
+</label>
+
+<style>
+	.input-output-toggle {
+		position: relative;
+		display: flex;
+		gap: 0.5em;
+		user-select: none;
+		align-items: center;
+		width: 100%;
+		height: 42px;
+		z-index: 2;
+		padding: 0 3.2rem;
+	}
+</style>
diff --git a/sites/kit.svelte.dev/src/lib/docs/server/index.js b/sites/kit.svelte.dev/src/lib/docs/server/index.js
index a3e6f1dce..1c79bc224 100644
--- a/sites/kit.svelte.dev/src/lib/docs/server/index.js
+++ b/sites/kit.svelte.dev/src/lib/docs/server/index.js
@@ -5,11 +5,13 @@ import 'prismjs/components/prism-bash.js';
 import 'prismjs/components/prism-diff.js';
 import 'prismjs/components/prism-typescript.js';
 import 'prism-svelte';
-import { escape, extract_frontmatter, transform } from './markdown';
+import { escape, extract_frontmatter, transform } from './markdown.js';
 import { modules } from '../../../../../../packages/kit/docs/types.js';
-import { render_modules } from './modules';
+import { render_modules } from './modules.js';
 import { error } from '@sveltejs/kit';
 import { parse_route_id } from '../../../../../../packages/kit/src/utils/routing.js';
+import ts from 'typescript';
+import MagicString from 'magic-string';
 
 const languages = {
 	bash: 'bash',
@@ -65,7 +67,7 @@ export async function read_file(dir, file) {
 	const { metadata, body } = extract_frontmatter(markdown);
 
 	const { content } = parse({
-		body,
+		body: generate_ts_from_js(body),
 		file,
 		// gross hack to accommodate FAQ
 		slug: dir === 'faq' ? slug : undefined,
@@ -92,14 +94,30 @@ export async function read_file(dir, file) {
 				})
 				.replace(/\*\\\//g, '*/');
 
-			if (language === 'js') {
+			let version_class = '';
+			if (language === 'generated-ts' || language === 'generated-svelte') {
+				language = language.replace('generated-', '');
+				version_class = ' ts-version';
+			} else if (language === 'original-js' || language === 'original-svelte') {
+				language = language.replace('original-', '');
+				version_class = ' js-version';
+			}
+
+			if (language === 'js' || language === 'ts') {
 				try {
+					const injected = [];
+					if (source.includes('$app/')) {
+						injected.push(
+							`// @filename: ambient-kit.d.ts`,
+							`/// <reference types="@sveltejs/kit" />`
+						);
+					}
 					if (source.includes('./$types') && !source.includes('@filename: $types.d.ts')) {
 						const params = parse_route_id(options.file || `+page.${language}`)
 							.names.map((name) => `${name}: string`)
 							.join(', ');
 
-						let injected = [
+						injected.push(
 							`// @filename: $types.d.ts`,
 							`import type * as Kit from '@sveltejs/kit';`,
 							`export type PageLoad = Kit.Load<{${params}}>;`,
@@ -109,14 +127,21 @@ export async function read_file(dir, file) {
 							`export type RequestHandler = Kit.RequestHandler<{${params}}>;`,
 							`export type Action = Kit.Action<{${params}}>;`,
 							`export type Actions = Kit.Actions<{${params}}>;`
-						].join('\n');
-
+						);
+					}
+					if (!options.file) {
+						// No named file -> assume that the code is not meant to be type checked
+						// If we don't do this, twoslash would throw errors for e.g. some snippets in `types/ambient.d.ts`
+						injected.push('// @noErrors');
+					}
+					if (injected.length) {
+						const injected_str = injected.join('\n');
 						if (source.includes('// @filename:')) {
-							source = source.replace('// @filename:', `${injected}\n\n// @filename:`);
+							source = source.replace('// @filename:', `${injected_str}\n\n// @filename:`);
 						} else {
 							source = source.replace(
 								/^(?!\/\/ @)/m,
-								`${injected}\n\n// @filename: index.${language}\n// ---cut---\n`
+								`${injected_str}\n\n// @filename: index.${language}\n// ---cut---\n`
 							);
 						}
 					}
@@ -184,7 +209,7 @@ export async function read_file(dir, file) {
 				html = `<pre class='language-${plang}'><code>${highlighted}</code></pre>`;
 			}
 
-			html = `<div class="code-block">${
+			html = `<div class="code-block${version_class}">${
 				options.file ? `<h5>${options.file}</h5>` : ''
 			}${html}</div>`;
 
@@ -392,3 +417,184 @@ export function slugify(title) {
 		.replace(/^-/, '')
 		.replace(/-$/, '');
 }
+
+/**
+ * Appends a JS->TS / Svelte->Svelte-TS code block after each JS/Svelte code block.
+ * The language is `generated-js`/`generated-svelte` which can be used to detect this in later steps.
+ * @param {string} markdown
+ */
+export function generate_ts_from_js(markdown) {
+	return markdown
+		.replaceAll(/```js\n([\s\S]+?)\n```/g, (match, code) => {
+			if (!code.includes('/// file:')) {
+				// No named file -> assume that the code is not meant to be shown in two versions
+				return match;
+			}
+
+			const ts = convert_to_ts(code);
+
+			if (!ts) {
+				// No changes -> don't show TS version
+				return match;
+			}
+
+			return match.replace('js', 'original-js') + '\n```generated-ts\n' + ts + '\n```';
+		})
+		.replaceAll(/```svelte\n([\s\S]+?)\n```/g, (match, code) => {
+			if (!code.includes('/// file:')) {
+				// No named file -> assume that the code is not meant to be shown in two versions
+				return match;
+			}
+
+			// Assumption: no context="module" blocks
+			const script = code.match(/<script>([\s\S]+?)<\/script>/);
+			if (!script) return match;
+
+			const [outer, inner] = script;
+			const ts = convert_to_ts(inner, '\t', '\n');
+
+			if (!ts) {
+				// No changes -> don't show TS version
+				return match;
+			}
+
+			return (
+				match.replace('svelte', 'original-svelte') +
+				'\n```generated-svelte\n' +
+				code.replace(outer, `<script lang="ts">${ts}</script>`) +
+				'\n```'
+			);
+		});
+}
+
+/**
+ * Transforms a JS code block into a TS code block by turning JSDoc into type annotations.
+ * Due to pragmatism only the cases currently used in the docs are implemented.
+ * @param {string} js_code
+ * @param {string} [indent]
+ * @param {string} [offset]
+ *  */
+function convert_to_ts(js_code, indent = '', offset = '') {
+	js_code = js_code
+		.replaceAll('// @filename: index.js', '// @filename: index.ts')
+		.replace(/(\/\/\/ .+?\.)js/, '$1ts')
+		// *\/ appears in some JsDoc comments in d.ts files due to the JSDoc-in-JSDoc problem
+		.replace(/\*\\\//g, '*/');
+
+	const ast = ts.createSourceFile(
+		'filename.ts',
+		js_code,
+		ts.ScriptTarget.Latest,
+		true,
+		ts.ScriptKind.TS
+	);
+	const code = new MagicString(js_code);
+	const imports = new Map();
+
+	function walk(node) {
+		// @ts-ignore
+		if (node.jsDoc) {
+			// @ts-ignore
+			for (const comment of node.jsDoc) {
+				let modified = false;
+
+				for (const tag of comment.tags ?? []) {
+					if (ts.isJSDocTypeTag(tag)) {
+						const name = get_type_name(tag);
+
+						if (ts.isFunctionDeclaration(node)) {
+							const is_export = node.modifiers?.some(
+								(modifier) => modifier.kind === ts.SyntaxKind.ExportKeyword
+							)
+								? 'export '
+								: '';
+							const is_async = node.modifiers?.some(
+								(modifier) => modifier.kind === ts.SyntaxKind.AsyncKeyword
+							);
+							code.overwrite(
+								node.getStart(),
+								node.name.getEnd(),
+								`${is_export ? 'export ' : ''}const ${node.name.getText()}: ${name} = ${
+									is_async ? 'async ' : ''
+								}`
+							);
+							code.appendLeft(node.body.getStart(), '=> ');
+
+							modified = true;
+						} else if (
+							ts.isVariableStatement(node) &&
+							node.declarationList.declarations.length === 1
+						) {
+							code.appendLeft(node.declarationList.declarations[0].name.getEnd(), `: ${name}`);
+
+							modified = true;
+						} else {
+							throw new Error('Unhandled @type JsDoc->TS conversion: ' + js_code);
+						}
+					} else if (ts.isJSDocParameterTag(tag) && ts.isFunctionDeclaration(node)) {
+						if (node.parameters.length !== 1) {
+							throw new Error(
+								'Unhandled @type JsDoc->TS conversion; needs more params logic: ' + node.getText()
+							);
+						}
+						const name = get_type_name(tag);
+						code.appendLeft(node.parameters[0].getEnd(), `: ${name}`);
+
+						modified = true;
+					}
+				}
+
+				if (modified) {
+					code.overwrite(comment.getStart(), comment.getEnd(), '');
+				}
+			}
+		}
+
+		ts.forEachChild(node, walk);
+	}
+
+	walk(ast);
+
+	if (imports.size) {
+		const import_statements = Array.from(imports.entries())
+			.map(([from, names]) => {
+				return `${indent}import type { ${Array.from(names).join(', ')} } from '${from}';`;
+			})
+			.join('\n');
+		const idxOfLastImport = [...ast.statements]
+			.reverse()
+			.find((statement) => ts.isImportDeclaration(statement))
+			?.getEnd();
+		const insertion_point = Math.max(
+			idxOfLastImport ? idxOfLastImport + 1 : 0,
+			js_code.includes('---cut---')
+				? js_code.indexOf('\n', js_code.indexOf('---cut---')) + 1
+				: js_code.includes('/// file:')
+				? js_code.indexOf('\n', js_code.indexOf('/// file:')) + 1
+				: 0
+		);
+		code.appendLeft(insertion_point, offset + import_statements + '\n');
+	}
+
+	const transformed = code.toString();
+	return transformed === js_code ? undefined : transformed.replace(/\n\s*\n\s*\n/g, '\n\n');
+
+	/** @param {ts.JSDocTypeTag | ts.JSDocParameterTag} tag */
+	function get_type_name(tag) {
+		const type_text = tag.typeExpression.getText();
+		let name = type_text.slice(1, -1); // remove { }
+
+		const import_match = /import\('(.+?)'\)\.(\w+)/.exec(type_text);
+		if (import_match) {
+			const [, from, _name] = import_match;
+			name = _name;
+			const existing = imports.get(from);
+			if (existing) {
+				existing.add(name);
+			} else {
+				imports.set(from, new Set([name]));
+			}
+		}
+		return name;
+	}
+}
diff --git a/sites/kit.svelte.dev/src/lib/docs/server/index.spec.js b/sites/kit.svelte.dev/src/lib/docs/server/index.spec.js
new file mode 100644
index 000000000..d8684b794
--- /dev/null
+++ b/sites/kit.svelte.dev/src/lib/docs/server/index.spec.js
@@ -0,0 +1,231 @@
+import { test } from 'uvu';
+import * as assert from 'uvu/assert';
+import { generate_ts_from_js } from './index.js';
+
+/**
+ * @param {string} input
+ * @param {string} expected
+ */
+function test_ts_transformation(input, expected) {
+	const output = generate_ts_from_js(input);
+	assert.equal(output, expected);
+}
+
+test('Creates TS from JS', () => {
+	test_ts_transformation(
+		`
+### sub heading
+
+etc
+\`\`\`js
+// @errors: 2461
+/// file: src/routes/what-is-my-user-agent/+server.js
+import { json } from '@sveltejs/kit';
+
+/** @type {import('./$types').RequestHandler} */
+export function GET(event) {
+	// log all headers
+	console.log(...event.request.headers);
+
+	return json({
+		// retrieve a specific header
+		userAgent: event.request.headers.get('user-agent')
+	});
+}
+\`\`\`
+
+etc etc
+`,
+		`
+### sub heading
+
+etc
+\`\`\`original-js
+// @errors: 2461
+/// file: src/routes/what-is-my-user-agent/+server.js
+import { json } from '@sveltejs/kit';
+
+/** @type {import('./$types').RequestHandler} */
+export function GET(event) {
+	// log all headers
+	console.log(...event.request.headers);
+
+	return json({
+		// retrieve a specific header
+		userAgent: event.request.headers.get('user-agent')
+	});
+}
+\`\`\`
+\`\`\`generated-ts
+// @errors: 2461
+/// file: src/routes/what-is-my-user-agent/+server.ts
+import type { RequestHandler } from './$types';
+import { json } from '@sveltejs/kit';
+
+export const GET: RequestHandler = (event) => {
+	// log all headers
+	console.log(...event.request.headers);
+
+	return json({
+		// retrieve a specific header
+		userAgent: event.request.headers.get('user-agent')
+	});
+}
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test('Creates Svelte-TS from Svelte-JS', () => {
+	test_ts_transformation(
+		`
+### sub heading
+
+etc
+\`\`\`svelte
+/// file: src/routes/+page.svelte
+<script>
+	/** @type {import('./$types').PageData} */
+	export let data;
+</script>
+
+<h1>{data.title}</h1>
+<div>{@html data.content}</div>
+\`\`\`
+
+etc etc
+`,
+		`
+### sub heading
+
+etc
+\`\`\`original-svelte
+/// file: src/routes/+page.svelte
+<script>
+	/** @type {import('./$types').PageData} */
+	export let data;
+</script>
+
+<h1>{data.title}</h1>
+<div>{@html data.content}</div>
+\`\`\`
+\`\`\`generated-svelte
+/// file: src/routes/+page.svelte
+<script lang="ts">
+	import type { PageData } from './$types';
+
+	export let data: PageData;
+</script>
+
+<h1>{data.title}</h1>
+<div>{@html data.content}</div>
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test('Leaves JS file as-is if no transformation needed', () => {
+	test_ts_transformation(
+		`
+\`\`\`js
+/// file: src/routes/+server.js
+let foo = true;
+\`\`\`
+
+etc etc
+`,
+		`
+\`\`\`js
+/// file: src/routes/+server.js
+let foo = true;
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test('Leaves Svelte file as-is if no transformation needed', () => {
+	test_ts_transformation(
+		`
+\`\`\`svelte
+/// file: src/routes/+page.svelte
+<script>
+	let foo = true;
+</script>
+
+<p>{foo}</p>
+\`\`\`
+
+etc etc
+`,
+		`
+\`\`\`svelte
+/// file: src/routes/+page.svelte
+<script>
+	let foo = true;
+</script>
+
+<p>{foo}</p>
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test('Leaves JS file as-is if no named file', () => {
+	test_ts_transformation(
+		`
+\`\`\`js
+/** @type {boolean} */
+let foo = true;
+\`\`\`
+
+etc etc
+`,
+		`
+\`\`\`js
+/** @type {boolean} */
+let foo = true;
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test('Leaves Svelte file as-is if no named file', () => {
+	test_ts_transformation(
+		`
+\`\`\`svelte
+<script>
+	/** @type {boolean} */
+	let foo = true;
+</script>
+
+<p>{foo}</p>
+\`\`\`
+
+etc etc
+`,
+		`
+\`\`\`svelte
+<script>
+	/** @type {boolean} */
+	let foo = true;
+</script>
+
+<p>{foo}</p>
+\`\`\`
+
+etc etc
+`
+	);
+});
+
+test.run();
diff --git a/sites/kit.svelte.dev/svelte.config.js b/sites/kit.svelte.dev/svelte.config.js
index 301e785eb..5c5a0c58e 100644
--- a/sites/kit.svelte.dev/svelte.config.js
+++ b/sites/kit.svelte.dev/svelte.config.js
@@ -4,6 +4,14 @@ import adapter from '@sveltejs/adapter-auto';
 const config = {
 	kit: {
 		adapter: adapter()
+	},
+
+	vitePlugin: {
+		experimental: {
+			inspector: {
+				holdMode: true
+			}
+		}
 	}
 };
 
diff --git a/sites/kit.svelte.dev/tsconfig.json b/sites/kit.svelte.dev/tsconfig.json
index b3f17580e..50bed1153 100644
--- a/sites/kit.svelte.dev/tsconfig.json
+++ b/sites/kit.svelte.dev/tsconfig.json
@@ -1,7 +1,8 @@
 {
 	"compilerOptions": {
 		"allowJs": true,
-		"checkJs": true
+		"checkJs": true,
+		"allowSyntheticDefaultImports": true
 	},
 	"extends": "./.svelte-kit/tsconfig.json"
 }
