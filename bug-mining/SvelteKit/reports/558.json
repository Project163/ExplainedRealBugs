{"url":"https://api.github.com/repos/sveltejs/kit/issues/14455","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/14455/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/14455/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/14455/events","html_url":"https://github.com/sveltejs/kit/issues/14455","id":3427073208,"node_id":"I_kwDOEiPr8c7MRPy4","number":14455,"title":"Path aliases for certain import statements are not resolved when packaging with `@sveltejs/package` 2.5.1+","user":{"login":"maxherrmann","id":36244341,"node_id":"MDQ6VXNlcjM2MjQ0MzQx","avatar_url":"https://avatars.githubusercontent.com/u/36244341?v=4","gravatar_id":"","url":"https://api.github.com/users/maxherrmann","html_url":"https://github.com/maxherrmann","followers_url":"https://api.github.com/users/maxherrmann/followers","following_url":"https://api.github.com/users/maxherrmann/following{/other_user}","gists_url":"https://api.github.com/users/maxherrmann/gists{/gist_id}","starred_url":"https://api.github.com/users/maxherrmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxherrmann/subscriptions","organizations_url":"https://api.github.com/users/maxherrmann/orgs","repos_url":"https://api.github.com/users/maxherrmann/repos","events_url":"https://api.github.com/users/maxherrmann/events{/privacy}","received_events_url":"https://api.github.com/users/maxherrmann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-09-17T16:52:32Z","updated_at":"2025-09-23T11:08:18Z","closed_at":"2025-09-23T11:08:18Z","author_association":"NONE","type":{"id":4885414,"node_id":"IT_kwDOAWhhq84ASoum","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-29T23:39:46Z","updated_at":"2024-07-26T11:19:25Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen packaging with `@sveltejs/package` (versions 2.5.1 or higher), path aliases are not resolved for certain `import` statements, which breaks the package on the consumer side.\n\nThe issue was introduced with #14413.\n\n### Reproduction\n\n### Setup\n\nAssume we have the following [alias](https://svelte.dev/docs/kit/configuration#alias) configuration in `svelte.config.js`:\n\n```js\nalias: {\n  $foo: \"./src/lib/foo\",\n}\n```\n\nAssume we have a `.ts` or `.svelte` file in the root of `./src/lib` with either one of the following import statements (all valid, as per [MDN Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#syntax)):\n\n```ts\nimport foo, { bar } from '$foo'\nimport foo, { bar, baz } from '$foo'\nimport foo, { type bar, type baz } from '$foo'\nimport foo, * as bar from '$foo'\nimport _foo from '$foo'\nimport * as _foo from '$foo'\nimport '$foo'\n```\n\n### Current result after packaging\n\nNone of the path aliases have been resolved.\n\n```ts\nimport foo, { bar } from '$foo'\nimport foo, { bar, baz } from '$foo'\nimport foo, { type bar, type baz } from '$foo'\nimport foo, * as bar from '$foo'\nimport _foo from '$foo'\nimport * as _foo from '$foo'\nimport '$foo'\n```\n\n### Expected result after packaging\n\nAll path aliases have been resolved.\n\n```ts\nimport foo, { bar } from './foo'\nimport foo, { bar, baz } from './foo'\nimport foo, { type bar, type baz } from './foo'\nimport foo, * as bar from './foo'\nimport _foo from './foo'\nimport * as _foo from './foo'\nimport './foo'\n```\n\n### Root cause\n\nThe [current regular expression](https://github.com/sveltejs/kit/blob/d4680a047d2a795c1dbab6b6ff9d281453fca1ef/packages/package/src/utils.js#L51) that identifies path aliases does not seem to capture the following:\n\n- Combinations of default and ~~named~~ยน/namespaced imports\n- Default/namespaced imports with identifiers that start with `_`\n- Side-effect-only imports\n\nยน) See https://github.com/sveltejs/kit/issues/14455#issuecomment-3318374082\n\n### Workaround\n\nAs a workaround, you can use `@sveltejs/package@2.5.0` or rewrite any affected import statements (if possible) so that they are captured by the current regular expression.\n\n### Logs\n\n```Shell\n\n```\n\n### System Info\n\n```Shell\nSystem:\n    OS: macOS 15.6.1\n    CPU: (12) arm64 Apple M4 Pro\n    Memory: 192.52 MB / 24.00 GB\n    Shell: 5.9 - /bin/zsh\n  Binaries:\n    Node: 22.16.0 - ~/.nvm/versions/node/v22.16.0/bin/node\n    npm: 11.4.1 - ~/.nvm/versions/node/v22.16.0/bin/npm\n  Browsers:\n    Chrome: 140.0.7339.133\n    Edge: 140.0.3485.66\n    Safari: 18.6\n```\n\n### Severity\n\nserious, but I can work around it\n\n### Additional Information\n\n_No response_","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/14455/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/14455/timeline","performed_via_github_app":null,"state_reason":"completed"}