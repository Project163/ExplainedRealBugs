[{"id":6898236340,"node_id":"LE_lADOEiPr8c5MxZkCzwAAAAGbKru0","url":"https://api.github.com/repos/sveltejs/kit/issues/events/6898236340","actor":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-06-28T23:54:23Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":6922374609,"node_id":"REFE_lADOEiPr8c5MxZkCzwAAAAGcmw3R","url":"https://api.github.com/repos/sveltejs/kit/issues/events/6922374609","actor":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"41c0ebe8be6948e03d592903cf638b3c6ea491fa","commit_url":"https://api.github.com/repos/sveltejs/kit/commits/41c0ebe8be6948e03d592903cf638b3c6ea491fa","created_at":"2022-07-02T17:20:55Z","performed_via_github_app":null},{"actor":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-02T17:21:16Z","updated_at":"2022-07-02T17:21:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5332","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5332/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5332/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5332/events","html_url":"https://github.com/sveltejs/kit/pull/5332","id":1290608394,"node_id":"PR_kwDOEiPr8c46qp7p","number":5332,"title":"[breaking] graduate `@sveltejs/kit/vite` from experimental and require `vite.config.js`","user":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3229669367,"node_id":"MDU6TGFiZWwzMjI5NjY5MzY3","url":"https://api.github.com/repos/sveltejs/kit/labels/breaking%20change","name":"breaking change","color":"F859C7","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2022-06-30T20:28:56Z","updated_at":"2022-07-19T12:16:05Z","closed_at":"2022-07-05T19:54:21Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":304344049,"node_id":"MDEwOlJlcG9zaXRvcnkzMDQzNDQwNDk=","name":"kit","full_name":"sveltejs/kit","private":false,"owner":{"login":"sveltejs","id":23617963,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNjE3OTYz","avatar_url":"https://avatars.githubusercontent.com/u/23617963?v=4","gravatar_id":"","url":"https://api.github.com/users/sveltejs","html_url":"https://github.com/sveltejs","followers_url":"https://api.github.com/users/sveltejs/followers","following_url":"https://api.github.com/users/sveltejs/following{/other_user}","gists_url":"https://api.github.com/users/sveltejs/gists{/gist_id}","starred_url":"https://api.github.com/users/sveltejs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sveltejs/subscriptions","organizations_url":"https://api.github.com/users/sveltejs/orgs","repos_url":"https://api.github.com/users/sveltejs/repos","events_url":"https://api.github.com/users/sveltejs/events{/privacy}","received_events_url":"https://api.github.com/users/sveltejs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sveltejs/kit","description":"web development, streamlined","fork":false,"url":"https://api.github.com/repos/sveltejs/kit","forks_url":"https://api.github.com/repos/sveltejs/kit/forks","keys_url":"https://api.github.com/repos/sveltejs/kit/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sveltejs/kit/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sveltejs/kit/teams","hooks_url":"https://api.github.com/repos/sveltejs/kit/hooks","issue_events_url":"https://api.github.com/repos/sveltejs/kit/issues/events{/number}","events_url":"https://api.github.com/repos/sveltejs/kit/events","assignees_url":"https://api.github.com/repos/sveltejs/kit/assignees{/user}","branches_url":"https://api.github.com/repos/sveltejs/kit/branches{/branch}","tags_url":"https://api.github.com/repos/sveltejs/kit/tags","blobs_url":"https://api.github.com/repos/sveltejs/kit/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sveltejs/kit/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sveltejs/kit/git/refs{/sha}","trees_url":"https://api.github.com/repos/sveltejs/kit/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sveltejs/kit/statuses/{sha}","languages_url":"https://api.github.com/repos/sveltejs/kit/languages","stargazers_url":"https://api.github.com/repos/sveltejs/kit/stargazers","contributors_url":"https://api.github.com/repos/sveltejs/kit/contributors","subscribers_url":"https://api.github.com/repos/sveltejs/kit/subscribers","subscription_url":"https://api.github.com/repos/sveltejs/kit/subscription","commits_url":"https://api.github.com/repos/sveltejs/kit/commits{/sha}","git_commits_url":"https://api.github.com/repos/sveltejs/kit/git/commits{/sha}","comments_url":"https://api.github.com/repos/sveltejs/kit/comments{/number}","issue_comment_url":"https://api.github.com/repos/sveltejs/kit/issues/comments{/number}","contents_url":"https://api.github.com/repos/sveltejs/kit/contents/{+path}","compare_url":"https://api.github.com/repos/sveltejs/kit/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sveltejs/kit/merges","archive_url":"https://api.github.com/repos/sveltejs/kit/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sveltejs/kit/downloads","issues_url":"https://api.github.com/repos/sveltejs/kit/issues{/number}","pulls_url":"https://api.github.com/repos/sveltejs/kit/pulls{/number}","milestones_url":"https://api.github.com/repos/sveltejs/kit/milestones{/number}","notifications_url":"https://api.github.com/repos/sveltejs/kit/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sveltejs/kit/labels{/name}","releases_url":"https://api.github.com/repos/sveltejs/kit/releases{/id}","deployments_url":"https://api.github.com/repos/sveltejs/kit/deployments","created_at":"2020-10-15T14:00:23Z","updated_at":"2025-11-09T20:00:19Z","pushed_at":"2025-11-09T16:24:14Z","git_url":"git://github.com/sveltejs/kit.git","ssh_url":"git@github.com:sveltejs/kit.git","clone_url":"https://github.com/sveltejs/kit.git","svn_url":"https://github.com/sveltejs/kit","homepage":"https://svelte.dev/docs/kit","size":31752,"stargazers_count":19933,"watchers_count":19933,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2150,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1029,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","svelte"],"visibility":"public","forks":2150,"open_issues":1029,"watchers":19933,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/sveltejs/kit/pulls/5332","html_url":"https://github.com/sveltejs/kit/pull/5332","diff_url":"https://github.com/sveltejs/kit/pull/5332.diff","patch_url":"https://github.com/sveltejs/kit/pull/5332.patch","merged_at":"2022-07-05T19:54:20Z"},"body":"Closes https://github.com/sveltejs/kit/issues/5184\r\nCloses #5308\r\nCloses https://github.com/sveltejs/kit/issues/5335\r\nCloses https://github.com/sveltejs/kit/issues/5312","reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5332/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5332/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-04T04:07:38Z","updated_at":"2022-07-04T04:07:38Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5346","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5346/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5346/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5346/events","html_url":"https://github.com/sveltejs/kit/issues/5346","id":1292288139,"node_id":"I_kwDOEiPr8c5NBsCL","number":5346,"title":"Vite Plugin: emitted files don't show up in the build output","user":{"login":"leonhma","id":67312077,"node_id":"MDQ6VXNlcjY3MzEyMDc3","avatar_url":"https://avatars.githubusercontent.com/u/67312077?v=4","gravatar_id":"","url":"https://api.github.com/users/leonhma","html_url":"https://github.com/leonhma","followers_url":"https://api.github.com/users/leonhma/followers","following_url":"https://api.github.com/users/leonhma/following{/other_user}","gists_url":"https://api.github.com/users/leonhma/gists{/gist_id}","starred_url":"https://api.github.com/users/leonhma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leonhma/subscriptions","organizations_url":"https://api.github.com/users/leonhma/orgs","repos_url":"https://api.github.com/users/leonhma/repos","events_url":"https://api.github.com/users/leonhma/events{/privacy}","received_events_url":"https://api.github.com/users/leonhma/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sveltejs/kit/milestones/3","html_url":"https://github.com/sveltejs/kit/milestone/3","labels_url":"https://api.github.com/repos/sveltejs/kit/milestones/3/labels","id":6045098,"node_id":"MDk6TWlsZXN0b25lNjA0NTA5OA==","number":3,"title":"non-urgent","description":"stuff that's not time-sensitive","creator":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":121,"closed_issues":235,"state":"open","created_at":"2020-10-29T02:28:56Z","updated_at":"2025-10-03T09:31:01Z","due_on":null,"closed_at":null},"comments":6,"created_at":"2022-07-03T12:03:07Z","updated_at":"2022-12-27T19:34:46Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":304344049,"node_id":"MDEwOlJlcG9zaXRvcnkzMDQzNDQwNDk=","name":"kit","full_name":"sveltejs/kit","private":false,"owner":{"login":"sveltejs","id":23617963,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNjE3OTYz","avatar_url":"https://avatars.githubusercontent.com/u/23617963?v=4","gravatar_id":"","url":"https://api.github.com/users/sveltejs","html_url":"https://github.com/sveltejs","followers_url":"https://api.github.com/users/sveltejs/followers","following_url":"https://api.github.com/users/sveltejs/following{/other_user}","gists_url":"https://api.github.com/users/sveltejs/gists{/gist_id}","starred_url":"https://api.github.com/users/sveltejs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sveltejs/subscriptions","organizations_url":"https://api.github.com/users/sveltejs/orgs","repos_url":"https://api.github.com/users/sveltejs/repos","events_url":"https://api.github.com/users/sveltejs/events{/privacy}","received_events_url":"https://api.github.com/users/sveltejs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sveltejs/kit","description":"web development, streamlined","fork":false,"url":"https://api.github.com/repos/sveltejs/kit","forks_url":"https://api.github.com/repos/sveltejs/kit/forks","keys_url":"https://api.github.com/repos/sveltejs/kit/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sveltejs/kit/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sveltejs/kit/teams","hooks_url":"https://api.github.com/repos/sveltejs/kit/hooks","issue_events_url":"https://api.github.com/repos/sveltejs/kit/issues/events{/number}","events_url":"https://api.github.com/repos/sveltejs/kit/events","assignees_url":"https://api.github.com/repos/sveltejs/kit/assignees{/user}","branches_url":"https://api.github.com/repos/sveltejs/kit/branches{/branch}","tags_url":"https://api.github.com/repos/sveltejs/kit/tags","blobs_url":"https://api.github.com/repos/sveltejs/kit/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sveltejs/kit/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sveltejs/kit/git/refs{/sha}","trees_url":"https://api.github.com/repos/sveltejs/kit/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sveltejs/kit/statuses/{sha}","languages_url":"https://api.github.com/repos/sveltejs/kit/languages","stargazers_url":"https://api.github.com/repos/sveltejs/kit/stargazers","contributors_url":"https://api.github.com/repos/sveltejs/kit/contributors","subscribers_url":"https://api.github.com/repos/sveltejs/kit/subscribers","subscription_url":"https://api.github.com/repos/sveltejs/kit/subscription","commits_url":"https://api.github.com/repos/sveltejs/kit/commits{/sha}","git_commits_url":"https://api.github.com/repos/sveltejs/kit/git/commits{/sha}","comments_url":"https://api.github.com/repos/sveltejs/kit/comments{/number}","issue_comment_url":"https://api.github.com/repos/sveltejs/kit/issues/comments{/number}","contents_url":"https://api.github.com/repos/sveltejs/kit/contents/{+path}","compare_url":"https://api.github.com/repos/sveltejs/kit/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sveltejs/kit/merges","archive_url":"https://api.github.com/repos/sveltejs/kit/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sveltejs/kit/downloads","issues_url":"https://api.github.com/repos/sveltejs/kit/issues{/number}","pulls_url":"https://api.github.com/repos/sveltejs/kit/pulls{/number}","milestones_url":"https://api.github.com/repos/sveltejs/kit/milestones{/number}","notifications_url":"https://api.github.com/repos/sveltejs/kit/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sveltejs/kit/labels{/name}","releases_url":"https://api.github.com/repos/sveltejs/kit/releases{/id}","deployments_url":"https://api.github.com/repos/sveltejs/kit/deployments","created_at":"2020-10-15T14:00:23Z","updated_at":"2025-11-09T20:00:19Z","pushed_at":"2025-11-09T16:24:14Z","git_url":"git://github.com/sveltejs/kit.git","ssh_url":"git@github.com:sveltejs/kit.git","clone_url":"https://github.com/sveltejs/kit.git","svn_url":"https://github.com/sveltejs/kit","homepage":"https://svelte.dev/docs/kit","size":31752,"stargazers_count":19933,"watchers_count":19933,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2150,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1029,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","svelte"],"visibility":"public","forks":2150,"open_issues":1029,"watchers":19933,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Describe the bug\n\nI am currently writing a plugin that is supposed to generate the manifest and images needed for a pwa, and the user can bring their own service worker, in order to be as customisable as possible. The icons are resized into a bunch of different variants and then emitted using `emitFiles`. Prior function doesn't give any errors and returns an resolveId that resolves to a valid URL. Everything seems to work, but in the end, nothing turns up in the build output, and when requesting `_app/manifest.webmanifest` or any of the images the server responds with the 404 page.\r\n\r\nI have also tested this using a plain vue3 app, and it works flawlessly.\n\n### Reproduction\n\nSince I don't have the plugin published, you will have to also clone https://github.com/leonhma/vite-plugin-webmanifest.git and use `yarn link`. Here is the original relevant plugin code:\r\n\r\n```typescript\r\nimport { Plugin } from 'vite'\r\nimport { PluginOptions } from './types.js'\r\nimport { readFileSync, existsSync } from 'fs'\r\nimport { generateIcon } from './utils.js';\r\nimport sharp from 'sharp'\r\n\r\n\r\nexport default (options: PluginOptions): Plugin => {\r\n  const purposes: ('any' | 'maskable')[] = ['maskable', 'any']\r\n  const formats: ('webp' | 'png')[] = ['webp', 'png']\r\n\r\n  let manifestUrl: string = ''\r\n\r\n  return {\r\n    name: 'vite-plugin-webmanifest',\r\n    async buildStart() {\r\n      const imageSrc = options.image?.src || './icon.png'\r\n\r\n      const icon = sharp(readFileSync(imageSrc))\r\n\r\n      let icons: object[] = []\r\n\r\n      for (const resolution of (options.image?.resolutions || [180, 192, 270, 512])) {\r\n        for (const purpose of purposes) {\r\n          for (const format of formats) {\r\n            icons.push({\r\n              // <-------- snip -------->\r\n            })\r\n          }\r\n        }\r\n      }\r\n\r\n      const manifest = {\r\n        // <-------- snip --------->\r\n        ...options.manifest || {},\r\n        icons\r\n      };\r\n\r\n\r\n      manifestUrl = this.getFileName(\r\n        this.emitFile({\r\n          type: 'asset',\r\n          fileName: 'manifest.webmanifest',\r\n          source: Buffer.from(JSON.stringify(manifest))\r\n        })\r\n      )\r\n    },\r\n    async transformIndexHtml() {\r\n      return [\r\n        {\r\n          tag: 'link',\r\n          attrs: {\r\n            rel: 'manifest',\r\n            href: manifestUrl\r\n          },\r\n          injectTo: 'head'\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nHere's a URL to the repo for reproduction: https://github.com/leonhma/repro-sveltekit-vite-emitfiles.git\n\n### Logs\n\n```shell\nleonhardmasche@penguin:~/imani$ yarn build && yarn start\r\nyarn run v1.22.19\r\n$ svelte-kit build\r\nvite v2.9.12 building for production...\r\n✓ 17 modules transformed.\r\n  Client build completed. Wrote 6 chunks and 2 assets\r\n  Building server\r\n.svelte-kit/output/client/_app/immutable/manifest.json                               1.45 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/__layout.svelte-3c05abc6.js           1.07 KiB / gzip: 0.65 KiB\r\n.svelte-kit/output/client/_app/immutable/error.svelte-9fc3965b.js                    1.56 KiB / gzip: 0.75 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/dashboard/index.svelte-3d01a1bf.js    0.84 KiB / gzip: 0.52 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/index.svelte-b547958d.js              0.68 KiB / gzip: 0.45 KiB\r\n.svelte-kit/output/client/_app/immutable/chunks/index-69850b26.js                    6.92 KiB / gzip: 2.82 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/pages/__layout.svelte-2ccc8da3.css   0.13 KiB / gzip: 0.13 KiB\r\n.svelte-kit/output/client/_app/immutable/start-61eed66d.js                           23.26 KiB / gzip: 8.79 KiB\r\nvite v2.9.12 building SSR bundle for production...\r\n✓ 15 modules transformed.\r\nGenerated an empty chunk: \"hooks\"\r\n.svelte-kit/output/server/manifest.json                             1.48 KiB\r\n.svelte-kit/output/server/index.js                                  73.21 KiB\r\n.svelte-kit/output/server/entries/endpoints/index.ts.js             0.31 KiB\r\n.svelte-kit/output/server/entries/pages/__layout.svelte.js          0.70 KiB\r\n.svelte-kit/output/server/entries/fallbacks/error.svelte.js         0.72 KiB\r\n.svelte-kit/output/server/entries/pages/dashboard/index.svelte.js   0.42 KiB\r\n.svelte-kit/output/server/entries/pages/index.svelte.js             0.38 KiB\r\n.svelte-kit/output/server/chunks/index-5f038599.js                  2.31 KiB\r\n.svelte-kit/output/server/chunks/hooks-1c45ba0b.js                  0.00 KiB\r\n  Prerendering\r\n(node:6457) ExperimentalWarning: buffer.Blob is an experimental feature. This feature could change at any time\r\n(Use `node --trace-warnings ...` to show where the warning was created)\r\n\r\nRun npm run preview to preview your production build locally.\r\n\r\n> Using @sveltejs/adapter-cloudflare\r\n  ✔ done\r\nDone in 5.47s.\r\nyarn run v1.22.19\n```\n\n\n### System Info\n\n```shell\nSystem:\r\n    OS: Linux 5.10 Debian GNU/Linux 11 (bullseye) 11 (bullseye)\r\n    CPU: (8) arm64 unknown\r\n    Memory: 3.09 GB / 3.10 GB\r\n    Container: Yes\r\n    Shell: 5.1.4 - /bin/bash\r\n  Binaries:\r\n    Node: 16.14.2 - ~/.config/versions/node/v16.14.2/bin/node\r\n    Yarn: 1.22.19 - ~/.yarn/bin/yarn\r\n    npm: 8.5.0 - ~/.config/versions/node/v16.14.2/bin/npm\r\n  npmPackages:\r\n    @sveltejs/adapter-cloudflare: next => 1.0.0-next.24 \r\n    @sveltejs/kit: next => 1.0.0-next.357 \r\n    svelte: ^3.46.0 => 3.48.0\n```\n\n\n### Severity\n\nblocking an upgrade\n\n### Additional Information\n\n_No response_","reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5346/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":6937107724,"node_id":"CE_lADOEiPr8c5MxZkCzwAAAAGde90M","url":"https://api.github.com/repos/sveltejs/kit/issues/events/6937107724","actor":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-07-05T19:54:20Z","state_reason":null,"performed_via_github_app":null},{"id":6937108098,"node_id":"REFE_lADOEiPr8c5MxZkCzwAAAAGde96C","url":"https://api.github.com/repos/sveltejs/kit/issues/events/6937108098","actor":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2e2719cf1e57f16633f8e30c199e56315a245bcf","commit_url":"https://api.github.com/repos/sveltejs/kit/commits/2e2719cf1e57f16633f8e30c199e56315a245bcf","created_at":"2022-07-05T19:54:24Z","performed_via_github_app":null},{"actor":{"login":"benmccann","id":322311,"node_id":"MDQ6VXNlcjMyMjMxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/322311?v=4","gravatar_id":"","url":"https://api.github.com/users/benmccann","html_url":"https://github.com/benmccann","followers_url":"https://api.github.com/users/benmccann/followers","following_url":"https://api.github.com/users/benmccann/following{/other_user}","gists_url":"https://api.github.com/users/benmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/benmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benmccann/subscriptions","organizations_url":"https://api.github.com/users/benmccann/orgs","repos_url":"https://api.github.com/users/benmccann/repos","events_url":"https://api.github.com/users/benmccann/events{/privacy}","received_events_url":"https://api.github.com/users/benmccann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-06T01:18:22Z","updated_at":"2022-07-06T01:18:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5372","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5372/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5372/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5372/events","html_url":"https://github.com/sveltejs/kit/issues/5372","id":1294881346,"node_id":"I_kwDOEiPr8c5NLlJC","number":5372,"title":"Conditional configuration in vite.config.js breaks prod build","user":{"login":"Conduitry","id":16696352,"node_id":"MDQ6VXNlcjE2Njk2MzUy","avatar_url":"https://avatars.githubusercontent.com/u/16696352?v=4","gravatar_id":"","url":"https://api.github.com/users/Conduitry","html_url":"https://github.com/Conduitry","followers_url":"https://api.github.com/users/Conduitry/followers","following_url":"https://api.github.com/users/Conduitry/following{/other_user}","gists_url":"https://api.github.com/users/Conduitry/gists{/gist_id}","starred_url":"https://api.github.com/users/Conduitry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Conduitry/subscriptions","organizations_url":"https://api.github.com/users/Conduitry/orgs","repos_url":"https://api.github.com/users/Conduitry/repos","events_url":"https://api.github.com/users/Conduitry/events{/privacy}","received_events_url":"https://api.github.com/users/Conduitry/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-07-05T23:05:22Z","updated_at":"2022-07-06T14:41:30Z","closed_at":"2022-07-06T14:41:30Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":304344049,"node_id":"MDEwOlJlcG9zaXRvcnkzMDQzNDQwNDk=","name":"kit","full_name":"sveltejs/kit","private":false,"owner":{"login":"sveltejs","id":23617963,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIzNjE3OTYz","avatar_url":"https://avatars.githubusercontent.com/u/23617963?v=4","gravatar_id":"","url":"https://api.github.com/users/sveltejs","html_url":"https://github.com/sveltejs","followers_url":"https://api.github.com/users/sveltejs/followers","following_url":"https://api.github.com/users/sveltejs/following{/other_user}","gists_url":"https://api.github.com/users/sveltejs/gists{/gist_id}","starred_url":"https://api.github.com/users/sveltejs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sveltejs/subscriptions","organizations_url":"https://api.github.com/users/sveltejs/orgs","repos_url":"https://api.github.com/users/sveltejs/repos","events_url":"https://api.github.com/users/sveltejs/events{/privacy}","received_events_url":"https://api.github.com/users/sveltejs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sveltejs/kit","description":"web development, streamlined","fork":false,"url":"https://api.github.com/repos/sveltejs/kit","forks_url":"https://api.github.com/repos/sveltejs/kit/forks","keys_url":"https://api.github.com/repos/sveltejs/kit/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sveltejs/kit/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sveltejs/kit/teams","hooks_url":"https://api.github.com/repos/sveltejs/kit/hooks","issue_events_url":"https://api.github.com/repos/sveltejs/kit/issues/events{/number}","events_url":"https://api.github.com/repos/sveltejs/kit/events","assignees_url":"https://api.github.com/repos/sveltejs/kit/assignees{/user}","branches_url":"https://api.github.com/repos/sveltejs/kit/branches{/branch}","tags_url":"https://api.github.com/repos/sveltejs/kit/tags","blobs_url":"https://api.github.com/repos/sveltejs/kit/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sveltejs/kit/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sveltejs/kit/git/refs{/sha}","trees_url":"https://api.github.com/repos/sveltejs/kit/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sveltejs/kit/statuses/{sha}","languages_url":"https://api.github.com/repos/sveltejs/kit/languages","stargazers_url":"https://api.github.com/repos/sveltejs/kit/stargazers","contributors_url":"https://api.github.com/repos/sveltejs/kit/contributors","subscribers_url":"https://api.github.com/repos/sveltejs/kit/subscribers","subscription_url":"https://api.github.com/repos/sveltejs/kit/subscription","commits_url":"https://api.github.com/repos/sveltejs/kit/commits{/sha}","git_commits_url":"https://api.github.com/repos/sveltejs/kit/git/commits{/sha}","comments_url":"https://api.github.com/repos/sveltejs/kit/comments{/number}","issue_comment_url":"https://api.github.com/repos/sveltejs/kit/issues/comments{/number}","contents_url":"https://api.github.com/repos/sveltejs/kit/contents/{+path}","compare_url":"https://api.github.com/repos/sveltejs/kit/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sveltejs/kit/merges","archive_url":"https://api.github.com/repos/sveltejs/kit/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sveltejs/kit/downloads","issues_url":"https://api.github.com/repos/sveltejs/kit/issues{/number}","pulls_url":"https://api.github.com/repos/sveltejs/kit/pulls{/number}","milestones_url":"https://api.github.com/repos/sveltejs/kit/milestones{/number}","notifications_url":"https://api.github.com/repos/sveltejs/kit/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sveltejs/kit/labels{/name}","releases_url":"https://api.github.com/repos/sveltejs/kit/releases{/id}","deployments_url":"https://api.github.com/repos/sveltejs/kit/deployments","created_at":"2020-10-15T14:00:23Z","updated_at":"2025-11-09T20:00:19Z","pushed_at":"2025-11-09T16:24:14Z","git_url":"git://github.com/sveltejs/kit.git","ssh_url":"git@github.com:sveltejs/kit.git","clone_url":"https://github.com/sveltejs/kit.git","svn_url":"https://github.com/sveltejs/kit","homepage":"https://svelte.dev/docs/kit","size":31752,"stargazers_count":19933,"watchers_count":19933,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2150,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1029,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","svelte"],"visibility":"public","forks":2150,"open_issues":1029,"watchers":19933,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### Describe the bug\r\n\r\nIf your `vite.config.js` uses conditional configuration, Svelte stops trying to compile components files to JS during SSR, and the resulting build fails because Rollup/Acorn is trying to parse Svelte files as JS.\r\n\r\n### Reproduction\r\n\r\nhttps://stackblitz.com/edit/sveltejs-kit-template-default-4wrfgp\r\n\r\n### Logs\r\n\r\n```shell\r\n❯ npm run build\r\n$ vite build\r\nvite v2.9.13 building for production...\r\n✓ 34 modules transformed.\r\n.svelte-kit/output/client/_app/immutable/assets/svelte-logo-87df40b8.svg                           1.85 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-cyrillic-ext-400-normal-3df7909e.woff2   15.40 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-cyrillic-400-normal-c7d433fd.woff2       8.89 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-greek-ext-400-normal-9e2fe623.woff2      7.33 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-greek-400-normal-a8be01ce.woff2          10.27 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-latin-ext-400-normal-6bfabd30.woff2      11.10 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-latin-400-normal-e43b3538.woff2          15.90 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/fira-mono-all-400-normal-1e3b098c.woff             75.55 KiB\r\n.svelte-kit/output/client/_app/immutable/manifest.json                                             2.67 KiB\r\n.svelte-kit/output/client/_app/immutable/start-ab798b44.js                                         23.25 KiB / gzip: 8.72 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/__layout.svelte-f0707ee1.js                         4.77 KiB / gzip: 1.86 KiB\r\n.svelte-kit/output/client/_app/immutable/error.svelte-c8df2b3e.js                                  1.56 KiB / gzip: 0.75 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/about.svelte-692f0ea0.js                            2.51 KiB / gzip: 1.15 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/index.svelte-471ba9cf.js                            5.47 KiB / gzip: 2.42 KiB\r\n.svelte-kit/output/client/_app/immutable/pages/todos/index.svelte-dda24c9b.js                      6.86 KiB / gzip: 2.89 KiB\r\n.svelte-kit/output/client/_app/immutable/chunks/index-9fe72fd8.js                                  11.81 KiB / gzip: 5.02 KiB\r\n.svelte-kit/output/client/_app/immutable/chunks/index-92d65ea7.js                                  0.43 KiB / gzip: 0.30 KiB\r\n.svelte-kit/output/client/_app/immutable/chunks/singletons-d1fb5791.js                             0.05 KiB / gzip: 0.07 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/pages/__layout.svelte-da7c5ce3.css                 5.08 KiB / gzip: 1.56 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/pages/about.svelte-bf4528fa.css                    0.11 KiB / gzip: 0.10 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/pages/index.svelte-e12bfb09.css                    1.45 KiB / gzip: 0.52 KiB\r\n.svelte-kit/output/client/_app/immutable/assets/pages/todos/index.svelte-a910a02d.css              3.70 KiB / gzip: 1.03 KiB\r\nvite v2.9.13 building SSR bundle for production...\r\n✓ 0 modules transformed.\r\ntransforming (1) .svelte-kit/build/index.js[rollup-plugin-dynamic-import-variables] Unexpected token (1:0)\r\nfile: /home/projects/sveltejs-kit-template-default-4wrfgp/src/routes/__layout.svelte:1:0\r\n[vite-plugin-svelte-kit] Unexpected token (1:0)\r\nfile: /home/projects/sveltejs-kit-template-default-4wrfgp/src/routes/__layout.svelte:1:0\r\n```\r\n\r\n\r\n### System Info\r\n\r\n```shell\r\n  System:\r\n    OS: Linux 5.0 undefined\r\n    CPU: (4) x64 Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz\r\n    Memory: 0 Bytes / 0 Bytes\r\n    Shell: 1.0 - /bin/jsh\r\n  Binaries:\r\n    Node: 16.14.2 - /usr/local/bin/node\r\n    Yarn: 1.22.10 - /bin/yarn\r\n    npm: 7.17.0 - /bin/npm\r\n  npmPackages:\r\n    @sveltejs/adapter-auto: next => 1.0.0-next.53 \r\n    @sveltejs/kit: next => 1.0.0-next.359 \r\n    svelte: ^3.46.0 => 3.48.0 \r\n    vite: ^2.9.13 => 2.9.13\r\n```\r\n\r\n\r\n### Severity\r\n\r\nblocking an upgrade\r\n\r\n### Additional Information\r\n\r\n_No response_","reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5372/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]