{"url":"https://api.github.com/repos/sveltejs/kit/issues/10526","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/10526/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/10526/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/10526/events","html_url":"https://github.com/sveltejs/kit/issues/10526","id":1845843625,"node_id":"I_kwDOEiPr8c5uBVap","number":10526,"title":"Prerendering app that logs `$page` will incorrectly fail","user":{"login":"pngwn","id":12937446,"node_id":"MDQ6VXNlcjEyOTM3NDQ2","avatar_url":"https://avatars.githubusercontent.com/u/12937446?v=4","gravatar_id":"","url":"https://api.github.com/users/pngwn","html_url":"https://github.com/pngwn","followers_url":"https://api.github.com/users/pngwn/followers","following_url":"https://api.github.com/users/pngwn/following{/other_user}","gists_url":"https://api.github.com/users/pngwn/gists{/gist_id}","starred_url":"https://api.github.com/users/pngwn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pngwn/subscriptions","organizations_url":"https://api.github.com/users/pngwn/orgs","repos_url":"https://api.github.com/users/pngwn/repos","events_url":"https://api.github.com/users/pngwn/events{/privacy}","received_events_url":"https://api.github.com/users/pngwn/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-08-10T20:22:58Z","updated_at":"2023-08-16T13:43:46Z","closed_at":"2023-08-16T13:43:45Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nLogging out parts of the URL that are not supported while prendering should be ignored due to out magical formatter.\r\n\r\nA very clever cyborg fox told me this:\r\n\r\n> we have https://github.com/sveltejs/kit/blob/a1fe0bfda7ebe8fef29ecad875eaa7c061ab0156/packages/kit/src/utils/url.js#L127-L129 which should be making console.log of the tracked URL object delegate to logging the original URL (and thus bypass the thing blocking access to url.hash) but maybe that broke at some point and/or doesn't work with certain Node versions.\n\n### Reproduction\n\nhttps://stackblitz.com/edit/sveltejs-kit-template-default-eh6kan?file=src%2Froutes%2F%2Bpage.svelte\n\n### Logs\n\n```Shell\nError: Cannot access url.search on a page with prerendering enabled\r\n    at URL.get (file://.../_website/.svelte-kit/output/server/index.js:273:15)\r\n    at [nodejs.util.inspect.custom] (node:internal/url:685:23)\r\n    at formatValue (node:internal/util/inspect:785:19)\r\n    at formatProperty (node:internal/util/inspect:1822:11)\r\n    at formatRaw (node:internal/util/inspect:1033:9)\r\n    at formatValue (node:internal/util/inspect:820:10)\r\n    at inspect (node:internal/util/inspect:347:10)\r\n    at formatWithOptionsInternal (node:internal/util/inspect:2173:40)\r\n    at formatWithOptions (node:internal/util/inspect:2035:10)\r\n    at console.value (node:internal/console/constructor:324:14)\r\nThis is caused by either a bug in Node.js or incorrect usage of Node.js internals.\r\nPlease open an issue with this stack trace at https://github.com/nodejs/node/issues\n```\n\n\n### System Info\n\n```Shell\nSystem:\r\n    OS: macOS 13.3.1\r\n    CPU: (10) arm64 Apple M1 Max\r\n    Memory: 13.25 GB / 64.00 GB\r\n    Shell: 5.9 - /bin/zsh\r\n  Binaries:\r\n    Node: 18.3.0 - ~/.volta/tools/image/node/18.3.0/bin/node\r\n    Yarn: 1.22.17 - ~/.volta/tools/image/yarn/1.22.17/bin/yarn\r\n    npm: 8.3.2 - ~/.volta/tools/image/npm/8.3.2/bin/npm\r\n    pnpm: 8.6.7 - ~/Library/pnpm/pnpm\r\n  Browsers:\r\n    Brave Browser: 112.1.50.114\r\n    Chrome: 115.0.5790.170\r\n    Safari: 16.4\r\n    Safari Technology Preview: 16.4\r\n  npmPackages:\r\n    @sveltejs/adapter-auto: ^2.0.0 => 2.0.1\r\n    @sveltejs/adapter-static: ^2.0.2 => 2.0.2\r\n    @sveltejs/adapter-vercel: ^3.0.3 => 3.0.3\r\n    @sveltejs/kit: ^1.5.0 => 1.16.3\r\n    svelte: ^3.59.2 => 3.59.2\r\n    vite: ^4.3.9 => 4.3.9\n```\n\n\n### Severity\n\nannoyance\n\n### Additional Information\n\nIt is easily worked around (remove the logs), however figuring out that you need to remove the logs is relatively challenging. ","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/10526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/10526/timeline","performed_via_github_app":null,"state_reason":"completed"}