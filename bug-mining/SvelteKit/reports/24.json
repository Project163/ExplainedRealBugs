{"url":"https://api.github.com/repos/sveltejs/kit/issues/4758","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/4758/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/4758/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/4758/events","html_url":"https://github.com/sveltejs/kit/issues/4758","id":1216787076,"node_id":"I_kwDOEiPr8c5IhrKE","number":4758,"title":"adapter-static build with `trailingSlash: \"alway\"` option fails.","user":{"login":"falsetru","id":29461,"node_id":"MDQ6VXNlcjI5NDYx","avatar_url":"https://avatars.githubusercontent.com/u/29461?v=4","gravatar_id":"","url":"https://api.github.com/users/falsetru","html_url":"https://github.com/falsetru","followers_url":"https://api.github.com/users/falsetru/followers","following_url":"https://api.github.com/users/falsetru/following{/other_user}","gists_url":"https://api.github.com/users/falsetru/gists{/gist_id}","starred_url":"https://api.github.com/users/falsetru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/falsetru/subscriptions","organizations_url":"https://api.github.com/users/falsetru/orgs","repos_url":"https://api.github.com/users/falsetru/repos","events_url":"https://api.github.com/users/falsetru/events{/privacy}","received_events_url":"https://api.github.com/users/falsetru/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sveltejs/kit/milestones/2","html_url":"https://github.com/sveltejs/kit/milestone/2","labels_url":"https://api.github.com/repos/sveltejs/kit/milestones/2/labels","id":6044960,"node_id":"MDk6TWlsZXN0b25lNjA0NDk2MA==","number":2,"title":"1.0","description":"stuff we need to nail down before launch","creator":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":628,"state":"closed","created_at":"2020-10-29T01:17:50Z","updated_at":"2022-12-19T11:47:29Z","due_on":null,"closed_at":"2022-12-19T11:47:29Z"},"comments":1,"created_at":"2022-04-27T04:46:45Z","updated_at":"2022-05-11T20:21:23Z","closed_at":"2022-05-11T20:21:23Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nbuild command try to access a file with trailing slash. (ex. `/favicon.png` -> `/favicon.png/`)\n\n### Reproduction\n\n- create app  using create-svelte, 'SvelteKit demo app'.\r\n```\r\nnpm init svelte@next my-app  # Choose default options\r\ncd my-app\r\n```\r\n- Add adapter-static\r\n```\r\nnpm add -D @sveltejs/adapter-static@next\r\nnpm rm -D @sveltejs/adapter-auto\r\nnpm install\r\n```\r\n- Adjust `svelte.config.js` to use adapter-static, and `trailingSlash: 'always'` option.\r\n```diff\r\n--- a/svelte.config.js\r\n+++ b/svelte.config.js\r\n@@ -1,9 +1,10 @@\r\n-import adapter from '@sveltejs/adapter-auto';\r\n+import adapter from '@sveltejs/adapter-static';\r\n \r\n /** @type {import('@sveltejs/kit').Config} */\r\n const config = {\r\n        kit: {\r\n                adapter: adapter(),\r\n+               trailingSlash: 'always',\r\n \r\n                // Override http methods in the Todo forms\r\n                methodOverride: {\r\n```\r\n- run build\r\n```\r\nnpm run build\r\n```\n\n### Logs\n\n```shell\nnpm run build\r\n\r\n> my-app@0.0.1 build\r\n> svelte-kit build\r\n\r\nvite v2.9.6 building for production...\r\n✓ 34 modules transformed.\r\n.svelte-kit/output/client/_app/assets/svelte-logo-87df40b8.svg                           1.85 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-cyrillic-ext-400-normal-3df7909e.woff2   15.40 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-cyrillic-400-normal-c7d433fd.woff2       8.89 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-greek-ext-400-normal-9e2fe623.woff2      7.33 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-greek-400-normal-a8be01ce.woff2          10.27 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-latin-ext-400-normal-6bfabd30.woff2      11.10 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-latin-400-normal-e43b3538.woff2          15.90 KiB\r\n.svelte-kit/output/client/_app/assets/fira-mono-all-400-normal-1e3b098c.woff             75.55 KiB\r\n.svelte-kit/output/client/_app/manifest.json                                             2.67 KiB\r\n.svelte-kit/output/client/_app/pages/__layout.svelte-7a649169.js                         4.76 KiB / gzip: 1.86 KiB\r\n.svelte-kit/output/client/_app/error.svelte-f6969740.js                                  1.56 KiB / gzip: 0.75 KiB\r\n.svelte-kit/output/client/_app/pages/about.svelte-103011ed.js                            2.51 KiB / gzip: 1.15 KiB\r\n.svelte-kit/output/client/_app/pages/index.svelte-1e12193f.js                            5.47 KiB / gzip: 2.42 KiB\r\n.svelte-kit/output/client/_app/pages/todos/index.svelte-43bb6c2c.js                      6.86 KiB / gzip: 2.88 KiB\r\n.svelte-kit/output/client/_app/chunks/index-a0e90cc4.js                                  0.43 KiB / gzip: 0.30 KiB\r\n.svelte-kit/output/client/_app/chunks/singletons-d1fb5791.js                             0.05 KiB / gzip: 0.07 KiB\r\n.svelte-kit/output/client/_app/assets/pages/about.svelte-bf4528fa.css                    0.11 KiB / gzip: 0.10 KiB\r\n.svelte-kit/output/client/_app/start-08e46c80.js                                         23.34 KiB / gzip: 8.67 KiB\r\n.svelte-kit/output/client/_app/assets/pages/__layout.svelte-15681802.css                 4.96 KiB / gzip: 1.55 KiB\r\n.svelte-kit/output/client/_app/chunks/index-2db0445a.js                                  11.77 KiB / gzip: 5.00 KiB\r\n.svelte-kit/output/client/_app/assets/pages/index.svelte-d0605c9c.css                    1.43 KiB / gzip: 0.51 KiB\r\n.svelte-kit/output/client/_app/assets/pages/todos/index.svelte-a910a02d.css              3.70 KiB / gzip: 1.03 KiB\r\nvite v2.9.6 building SSR bundle for production...\r\n✓ 35 modules transformed.\r\n.svelte-kit/output/server/manifest.json                         2.32 KiB\r\n.svelte-kit/output/server/index.js                              75.29 KiB\r\n.svelte-kit/output/server/entries/endpoints/todos/index.js      1.33 KiB\r\n.svelte-kit/output/server/entries/pages/__layout.svelte.js      4.60 KiB\r\n.svelte-kit/output/server/entries/fallbacks/error.svelte.js     0.72 KiB\r\n.svelte-kit/output/server/entries/pages/about.svelte.js         1.38 KiB\r\n.svelte-kit/output/server/entries/pages/index.svelte.js         8.18 KiB\r\n.svelte-kit/output/server/entries/pages/todos/index.svelte.js   5.92 KiB\r\n.svelte-kit/output/server/chunks/index-19ef195d.js              3.94 KiB\r\n.svelte-kit/output/server/chunks/hooks-0bab96cd.js              0.48 KiB\r\n> 404 /favicon.png/ (linked from /)\r\n    at file:///tmp/my-app/node_modules/@sveltejs/kit/dist/chunks/index2.js:988:11\r\n    at save (file:///tmp/my-app/node_modules/@sveltejs/kit/dist/chunks/index2.js:1208:4)\r\n    at visit (file:///tmp/my-app/node_modules/@sveltejs/kit/dist/chunks/index2.js:1099:3)\r\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n```\n```\n\n\n### System Info\n\n```shell\nSystem:\r\n    OS: Linux 5.13 Ubuntu 21.10 21.10 (Impish Indri)\r\n    CPU: (4) x64 Intel(R) Core(TM) i7-7600U CPU @ 2.80GHz\r\n    Memory: 791.54 MB / 15.38 GB\r\n    Container: Yes\r\n    Shell: 5.8 - /usr/bin/zsh\r\n  Binaries:\r\n    Node: 14.19.1 - /usr/bin/node\r\n    Yarn: 1.22.11 - ~/.npm-packages/bin/yarn\r\n    npm: 8.5.0 - ~/.npm-packages/bin/npm\r\n  Browsers:\r\n    Chrome: 101.0.4951.41\r\n    Firefox: 99.0\r\n  npmPackages:\r\n    @sveltejs/adapter-static: ^1.0.0-next.29 => 1.0.0-next.29 \r\n    @sveltejs/kit: next => 1.0.0-next.322 \r\n    svelte: ^3.46.0 => 3.47.0\n```\n\n\n### Severity\n\nblocking an upgrade\n\n### Additional Information\n\nDowngrading from @sveltejs/kit@1.0.0-next.322 to @sveltejs/kit@1.0.0-next.321 solves issue.","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/4758/reactions","total_count":23,"+1":21,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":2,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/4758/timeline","performed_via_github_app":null,"state_reason":"completed"}