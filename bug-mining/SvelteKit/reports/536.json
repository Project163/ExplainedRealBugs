{"url":"https://api.github.com/repos/sveltejs/kit/issues/13675","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/13675/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/13675/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/13675/events","html_url":"https://github.com/sveltejs/kit/issues/13675","id":2971270747,"node_id":"I_kwDOEiPr8c6xGf5b","number":13675,"title":"Introduce of custom transports leads to `deserialize` not working on server side","user":{"login":"gurpreetatwal","id":7547554,"node_id":"MDQ6VXNlcjc1NDc1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/7547554?v=4","gravatar_id":"","url":"https://api.github.com/users/gurpreetatwal","html_url":"https://github.com/gurpreetatwal","followers_url":"https://api.github.com/users/gurpreetatwal/followers","following_url":"https://api.github.com/users/gurpreetatwal/following{/other_user}","gists_url":"https://api.github.com/users/gurpreetatwal/gists{/gist_id}","starred_url":"https://api.github.com/users/gurpreetatwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gurpreetatwal/subscriptions","organizations_url":"https://api.github.com/users/gurpreetatwal/orgs","repos_url":"https://api.github.com/users/gurpreetatwal/repos","events_url":"https://api.github.com/users/gurpreetatwal/events{/privacy}","received_events_url":"https://api.github.com/users/gurpreetatwal/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2025-04-04T04:55:02Z","updated_at":"2025-06-04T09:44:40Z","closed_at":"2025-06-04T09:44:40Z","author_association":"CONTRIBUTOR","type":{"id":4885414,"node_id":"IT_kwDOAWhhq84ASoum","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-29T23:39:46Z","updated_at":"2024-07-26T11:19:25Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nPrior to @sveltejs/kit@2.11.0 I was able to use the `deserialize` function in server side routes to parse the response returned by calling svelte kit action methods using fetch. If relevant, my specific use case is a route that runs automates filling out some forms for the user based on the response from an LLM. I use deserialize to parse the response from the action. \n\nAttempting to upgrade to any version >= 2.11.0 (including latest 2.20.3 as of April 3) results in all server side usages of `deserialize` throwing the following error:\n\n```\nCannot read properties of undefined (reading 'decoders')\nTypeError: Cannot read properties of undefined (reading 'decoders')\n    at deserialize (/node_modules/@sveltejs/kit/src/runtime/app/forms.js:37:84)\n    at load (/src/routes/load/+page.server.js:17:74)\n    at async load_server_data (/node_modules/@sveltejs/kit/src/runtime/server/page/load_data.js:45:18)\n    at async Promise.all (index 1)\n    at async render_data (/node_modules/@sveltejs/kit/src/runtime/server/data/index.js:101:17)\n    at async resolve (/node_modules/@sveltejs/kit/src/runtime/server/respond.js:443:17)\n    at async respond (/node_modules/@sveltejs/kit/src/runtime/server/respond.js:329:20)\n    at async file:///node_modules/@sveltejs/kit/src/exports/vite/dev/index.js:521:22\n```\n\nI ran `npm run build` and `npm run preview` results in the same error as well. \n\n`deserialize` still works when used client side (`.svelte`) files but does not work in any `server.js/ts` files.\n\n### Reproduction\n\n- 2.10.1 (last working version): https://stackblitz.com/edit/deserialize2-10-1\n- 2.11.0 (first failing version): https://stackblitz.com/edit/deserialize2-11-0\n- 2.20.3 (latest): https://stackblitz.com/edit/deserialize2-20-3\n\n### Logs\n\n```Shell\nCannot read properties of undefined (reading 'decoders')\nTypeError: Cannot read properties of undefined (reading 'decoders')\n    at deserialize (/node_modules/@sveltejs/kit/src/runtime/app/forms.js:37:84)\n    at load (/src/routes/load/+page.server.js:17:74)\n    at async load_server_data (/node_modules/@sveltejs/kit/src/runtime/server/page/load_data.js:45:18)\n    at async Promise.all (index 1)\n    at async render_data (/node_modules/@sveltejs/kit/src/runtime/server/data/index.js:101:17)\n    at async resolve (/node_modules/@sveltejs/kit/src/runtime/server/respond.js:443:17)\n    at async respond (/node_modules/@sveltejs/kit/src/runtime/server/respond.js:329:20)\n    at async file:///node_modules/@sveltejs/kit/src/exports/vite/dev/index.js:521:22\n\nCannot read properties of undefined (reading 'decoders')\nTypeError: Cannot read properties of undefined (reading 'decoders')\n    at deserialize (file:///.svelte-kit/output/server/chunks/forms.js:6:50)\n    at load (file:///.svelte-kit/output/server/entries/pages/load/_page.server.js:12:37)\n    at async load_server_data (file:///.svelte-kit/output/server/index.js:621:18)\n    at async Promise.all (index 1)\n    at async render_data (file:///.svelte-kit/output/server/index.js:1965:19)\n    at async resolve2 (file:///.svelte-kit/output/server/index.js:2977:22)\n    at async respond (file:///.svelte-kit/output/server/index.js:2882:22)\n    at async file:///node_modules/@sveltejs/kit/src/exports/vite/preview/index.js:197:5\n```\n\n### System Info\n\n```Shell\nSystem:\n    OS: Linux 5.15 Ubuntu 22.04.5 LTS 22.04.5 LTS (Jammy Jellyfish)\n    CPU: (8) x64 Intel(R) Core(TM) i7-4790K CPU @ 4.00GHz\n    Memory: 11.96 GB / 31.28 GB\n    Container: Yes\n    Shell: 5.8.1 - /usr/bin/zsh\n  Binaries:\n    Node: 22.13.1 - ~/.local/share/nodejs/bin/node\n    Yarn: 1.22.22 - ~/.local/share/nodejs/bin/yarn\n    npm: 10.9.2 - ~/.local/share/nodejs/bin/npm\n    pnpm: 9.1.0 - ~/.local/share/nodejs/bin/pnpm\n  Browsers:\n    Chrome: 135.0.7049.52\n  npmPackages:\n    @sveltejs/adapter-node: ^5.2.12 => 5.2.12\n    @sveltejs/kit: ^2.10.0 => 2.10.0\n    @sveltejs/vite-plugin-svelte: ^3.1.2 => 3.1.2\n    svelte: ^4.2.19 => 4.2.19\n    vite: ^5.4.10 => 5.4.11\n```\n\n### Severity\n\nblocking an upgrade\n\n### Additional Information\n\nProbably related to #13149 ","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/13675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/13675/timeline","performed_via_github_app":null,"state_reason":"completed"}