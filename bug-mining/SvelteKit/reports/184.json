{"url":"https://api.github.com/repos/sveltejs/kit/issues/7066","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/7066/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/7066/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/7066/events","html_url":"https://github.com/sveltejs/kit/issues/7066","id":1389511726,"node_id":"I_kwDOEiPr8c5S0kQu","number":7066,"title":"Cookies are not set after subsequent page reloads","user":{"login":"teemingc","id":54401897,"node_id":"MDQ6VXNlcjU0NDAxODk3","avatar_url":"https://avatars.githubusercontent.com/u/54401897?v=4","gravatar_id":"","url":"https://api.github.com/users/teemingc","html_url":"https://github.com/teemingc","followers_url":"https://api.github.com/users/teemingc/followers","following_url":"https://api.github.com/users/teemingc/following{/other_user}","gists_url":"https://api.github.com/users/teemingc/gists{/gist_id}","starred_url":"https://api.github.com/users/teemingc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/teemingc/subscriptions","organizations_url":"https://api.github.com/users/teemingc/orgs","repos_url":"https://api.github.com/users/teemingc/repos","events_url":"https://api.github.com/users/teemingc/events{/privacy}","received_events_url":"https://api.github.com/users/teemingc/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sveltejs/kit/milestones/2","html_url":"https://github.com/sveltejs/kit/milestone/2","labels_url":"https://api.github.com/repos/sveltejs/kit/milestones/2/labels","id":6044960,"node_id":"MDk6TWlsZXN0b25lNjA0NDk2MA==","number":2,"title":"1.0","description":"stuff we need to nail down before launch","creator":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":628,"state":"closed","created_at":"2020-10-29T01:17:50Z","updated_at":"2022-12-19T11:47:29Z","due_on":null,"closed_at":"2022-12-19T11:47:29Z"},"comments":12,"created_at":"2022-09-28T14:55:39Z","updated_at":"2024-08-24T12:59:38Z","closed_at":"2022-10-13T15:01:49Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nInitially discovered by @shahriar350 in #7055\r\n\r\nThe `handle` and `load` functions do not set a new cookie if it is deleted in the browser.\r\n\r\nThis is proven by deleting the cookie and reloading the page. The cookies are not set after subsequent reloads.\r\n\r\nHowever, invalidating the page and reloading causes the cookies to be set successfully.\r\n\r\nUnfortunately, when running `npm run preview`, only the `handle` cookie gets set this way. The `load` cookie does not get set even after invalidating.\n\n### Reproduction\n\nhttps://github.com/s3812497/sveltekit-cookie-bug\r\n\r\n1. Run the dev server.\r\n2. Open the project in the browser.\r\n3. Delete the cookies.\r\n4. Reload the page.\r\n\r\nExpected:\r\nCookies are set again.\r\n\r\nActual:\r\nCookies are not set.\n\n### Logs\n\n_No response_\n\n### System Info\n\n```shell\nSystem:\r\n    OS: macOS 13.0\r\n    CPU: (8) arm64 Apple M1 Pro\r\n    Memory: 793.89 MB / 32.00 GB\r\n    Shell: 5.8.1 - /bin/zsh\r\n  Binaries:\r\n    Node: 16.17.0 - ~/.nvm/versions/node/v16.17.0/bin/node\r\n    npm: 8.15.0 - ~/.nvm/versions/node/v16.17.0/bin/npm\r\n  Browsers:\r\n    Chrome: 105.0.5195.125\r\n    Firefox: 105.0.1\r\n    Firefox Developer Edition: 105.0\r\n    Safari: 16.1\r\n    Safari Technology Preview: 16.0\r\n  npmPackages:\r\n    @sveltejs/adapter-auto: next => 1.0.0-next.80 \r\n    @sveltejs/kit: next => 1.0.0-next.504 \r\n    svelte: ^3.50.1 => 3.50.1 \r\n    vite: ^3.1.4 => 3.1.4\n```\n\n\n### Severity\n\nserious, but I can work around it\n\n### Additional Information\n\n_No response_","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/7066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/7066/timeline","performed_via_github_app":null,"state_reason":"completed"}