{"url":"https://api.github.com/repos/sveltejs/kit/issues/8270","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/8270/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/8270/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/8270/events","html_url":"https://github.com/sveltejs/kit/issues/8270","id":1512282001,"node_id":"I_kwDOEiPr8c5aI5eR","number":8270,"title":"500 internal error using form actions from different directory when calling `fail()` (node.component is not a function)","user":{"login":"higoka","id":16455725,"node_id":"MDQ6VXNlcjE2NDU1NzI1","avatar_url":"https://avatars.githubusercontent.com/u/16455725?v=4","gravatar_id":"","url":"https://api.github.com/users/higoka","html_url":"https://github.com/higoka","followers_url":"https://api.github.com/users/higoka/followers","following_url":"https://api.github.com/users/higoka/following{/other_user}","gists_url":"https://api.github.com/users/higoka/gists{/gist_id}","starred_url":"https://api.github.com/users/higoka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/higoka/subscriptions","organizations_url":"https://api.github.com/users/higoka/orgs","repos_url":"https://api.github.com/users/higoka/repos","events_url":"https://api.github.com/users/higoka/events{/privacy}","received_events_url":"https://api.github.com/users/higoka/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-12-28T00:24:50Z","updated_at":"2023-01-13T20:07:09Z","closed_at":"2023-01-13T20:07:09Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen i return a `fail()` inside a form action which is in a different directory than the `+page.svelte` itself i throws an error saying `TypeError: node.component is not a function`\r\n\r\nI have two identical `+page.server.js` files one inside `/routes` and one inside `/routes/auth`.\r\nIt works as expected when the `+page.server.js` and `+page.svelte` files are inside the same directory.\r\nI believe it's because of the url changing after the form submission to `/auth?/login` so it tries to load the `+page.svelte` file from the `/auth` directory which there is not thus throwing the `node.component is not a function` error.\r\n\r\nI hope its clear what i mean i also made a live demo here: https://sveltekit-auth-ruby.vercel.app/\r\nThe source code can be found here: https://github.com/higoka/sveltekit-auth\n\n### Reproduction\n\nlive demo: https://sveltekit-auth-ruby.vercel.app/\r\nsource code: https://github.com/higoka/sveltekit-auth\r\n\n\n### Logs\n\n```Shell\nnode.component is not a function\r\nTypeError: node.component is not a function\r\n    at file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/runtime/server/page/render.js:82:64\r\n    at Array.map (<anonymous>)\r\n    at render_response (file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/runtime/server/page/render.js:82:41)\r\n    at render_page (file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/runtime/server/page/index.js:299:16)\r\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at async resolve (file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/runtime/server/index.js:356:17)\r\n    at async respond (file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/runtime/server/index.js:229:20)\r\n    at async file:///Users/nicorickenbach/Sites/sveltekit-auth/node_modules/@sveltejs/kit/src/exports/vite/dev/index.js:444:22\n```\n\n\n### System Info\n\n```Shell\nSystem:\r\n    OS: macOS 12.6.1\r\n    CPU: (8) x64 Intel(R) Core(TM) i7-4770HQ CPU @ 2.20GHz\r\n    Memory: 2.67 GB / 16.00 GB\r\n    Shell: 5.8.1 - /bin/zsh\r\n  Binaries:\r\n    Node: 19.3.0 - /usr/local/bin/node\r\n    npm: 9.2.0 - /usr/local/bin/npm\r\n  Browsers:\r\n    Chrome: 108.0.5359.124\r\n    Safari: 16.1\r\n  npmPackages:\r\n    @sveltejs/adapter-auto: ^1.0.0 => 1.0.0 \r\n    @sveltejs/kit: ^1.0.0 => 1.0.1 \r\n    svelte: ^3.54.0 => 3.55.0 \r\n    vite: ^4.0.0 => 4.0.3\n```\n\n\n### Severity\n\nserious, but I can work around it\n\n### Additional Information\n\n_No response_","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/8270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/8270/timeline","performed_via_github_app":null,"state_reason":"completed"}