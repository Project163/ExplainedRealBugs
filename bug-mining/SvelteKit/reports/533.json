{"url":"https://api.github.com/repos/sveltejs/kit/issues/13546","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/13546/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/13546/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/13546/events","html_url":"https://github.com/sveltejs/kit/issues/13546","id":2898204767,"node_id":"I_kwDOEiPr8c6svxhf","number":13546,"title":"SvelteKit loads CSS of dynamically imported components upfront when the page loads","user":{"login":"onesinghashish","id":6098703,"node_id":"MDQ6VXNlcjYwOTg3MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6098703?v=4","gravatar_id":"","url":"https://api.github.com/users/onesinghashish","html_url":"https://github.com/onesinghashish","followers_url":"https://api.github.com/users/onesinghashish/followers","following_url":"https://api.github.com/users/onesinghashish/following{/other_user}","gists_url":"https://api.github.com/users/onesinghashish/gists{/gist_id}","starred_url":"https://api.github.com/users/onesinghashish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/onesinghashish/subscriptions","organizations_url":"https://api.github.com/users/onesinghashish/orgs","repos_url":"https://api.github.com/users/onesinghashish/repos","events_url":"https://api.github.com/users/onesinghashish/events{/privacy}","received_events_url":"https://api.github.com/users/onesinghashish/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-03-05T19:06:02Z","updated_at":"2025-03-14T22:03:33Z","closed_at":"2025-03-14T22:03:33Z","author_association":"NONE","type":{"id":4885414,"node_id":"IT_kwDOAWhhq84ASoum","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-29T23:39:46Z","updated_at":"2024-07-26T11:19:25Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWe are facing performance issue in our web app which is used inside mobile webview environment. FCP latency is high due to large amount of render blocking css getting loaded when the page loads. This is happening because the css of even the components which are supposed to get dynamically loaded after the initial page load is getting shipped upfront and I haven't found any configuration which will help me avoid this.\n\n\n\n### Reproduction\n\nhttps://stackblitz.com/edit/sveltejs-kit-template-default-x6u4xeph\n\nHere, I am dynamically importing a component called DynamicLoaded inside onMount of root page.svelte. \n\nExpectation: css of DynamicLoaded should load along with js chunk of it lazily.\nActual: css of DynamicLoaded  component gets loaded upfront.\n\n### Logs\n\n```Shell\n\n```\n\n### System Info\n\n```Shell\nSystem:\n    OS: Linux 5.0 undefined\n    CPU: (8) x64 Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz\n    Memory: 0 Bytes / 0 Bytes\n    Shell: 1.0 - /bin/jsh\n  Binaries:\n    Node: 18.20.3 - /usr/local/bin/node\n    Yarn: 1.22.19 - /usr/local/bin/yarn\n    npm: 10.2.3 - /usr/local/bin/npm\n    pnpm: 8.15.6 - /usr/local/bin/pnpm\n  npmPackages:\n    @sveltejs/adapter-auto: ^4.0.0 => 4.0.0 \n    @sveltejs/kit: ^2.16.0 => 2.18.0 \n    @sveltejs/vite-plugin-svelte: ^5.0.0 => 5.0.3 \n    svelte: ^5.0.0 => 5.22.1 \n    vite: ^6.0.0 => 6.2.0\n```\n\n### Severity\n\nserious, but I can work around it\n\n### Additional Information\n\nI was able to work around it by having a local copy of the svelte kit npm module and changing the \nnode_modules/@sveltejs/kit/src/exports/vite/build/build_server.js file. However, this approach is not maintainable in the long run.\n\nChanged the third argument from true to false while calling find_deps function gives the desired result.\n<img width=\"1149\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/22a5b395-3170-46e7-8049-10928b38f739\" />","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/13546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/13546/timeline","performed_via_github_app":null,"state_reason":"completed"}