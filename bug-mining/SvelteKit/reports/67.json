{"url":"https://api.github.com/repos/sveltejs/kit/issues/5899","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5899/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5899/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5899/events","html_url":"https://github.com/sveltejs/kit/issues/5899","id":1339635279,"node_id":"I_kwDOEiPr8c5P2TZP","number":5899,"title":"generated .../$types.d.ts has imports with '.ts'-extension which causes the new +page.server.ts/+page.svelte data prop to have type 'any'","user":{"login":"ollema","id":31876997,"node_id":"MDQ6VXNlcjMxODc2OTk3","avatar_url":"https://avatars.githubusercontent.com/u/31876997?v=4","gravatar_id":"","url":"https://api.github.com/users/ollema","html_url":"https://github.com/ollema","followers_url":"https://api.github.com/users/ollema/followers","following_url":"https://api.github.com/users/ollema/following{/other_user}","gists_url":"https://api.github.com/users/ollema/gists{/gist_id}","starred_url":"https://api.github.com/users/ollema/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ollema/subscriptions","organizations_url":"https://api.github.com/users/ollema/orgs","repos_url":"https://api.github.com/users/ollema/repos","events_url":"https://api.github.com/users/ollema/events{/privacy}","received_events_url":"https://api.github.com/users/ollema/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-08-15T23:29:08Z","updated_at":"2022-08-16T09:33:51Z","closed_at":"2022-08-16T08:16:57Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"update: see https://github.com/sveltejs/kit/issues/5899#issuecomment-1215987727 for the actual issue\r\n\r\n---\r\n\r\n### Describe the bug\r\n\r\nFirst off - maybe this is expected? But when I read:\r\nhttps://kit.svelte.dev/docs/routing#$types\r\n> Throughout the examples above, we've been importing types from a $types.d.ts file. This is a file SvelteKit creates for you in a hidden directory if you're using TypeScript (or JavaScript with JSDoc type annotations) to give you type safety when working with your root files.\r\n> \r\n> For example, annotating export let data with PageData (or LayoutData, for a +layout.svelte file) tells TypeScript that the type of data is whatever was returned from load:\r\n\r\nI thought that the `data` prop would be fully typed!\r\n\r\nWith the `+page.server.ts`:\r\n```ts\r\nimport type { PageServerLoad } from './$types';\r\n\r\nimport { getEvent } from '$lib/api';\r\n\r\nexport const load: PageServerLoad = async ({ params }) => {\r\n\tconst { event, eventResponses } = await getEvent(params.id);\r\n\r\n\treturn {\r\n\t\tevent: event,\r\n\t\teventResponses: eventResponses\r\n\t};\r\n};\r\n```\r\nand `+page.svelte`:\r\n```svelte\r\n<script lang=\"ts\">\r\n\timport type { PageData } from './$types';\r\n\r\n\texport let data: PageData;\r\n</script>\r\n```\r\nI expected `data` to have the type\r\n```\r\ndata: {\r\n    event: event,\r\n    eventResponses: eventResponses\r\n}\r\n```\r\nbut instead, as noted earlier, I get `data: any` (hope you understand the notation used)\r\n\r\n### Reproduction\r\n\r\nsee the description\r\n\r\ncan also clone or checkout my repo:\r\nhttps://github.com/ollema/sersophane/tree/b1380f17998c430e7f91404f92d6fed21e37c001/src/routes/events/%5Bid%5D\r\n\r\nI think this is not super hard to reproduce - either it should happen for everyone OR I might have just misinterpreted the $types chapter\r\n\r\n### Logs\r\nI get this \"problem\" from vscode when viewing `/home/s0001325/work/sersophane/tsconfig.json`:\r\n\r\n```\r\n[{\r\n    \"resource\": \"/home/s0001325/work/sersophane/tsconfig.json\",\r\n    \"owner\": \"typescript\",\r\n    \"severity\": 8,\r\n    \"message\": \"Cannot write file '/home/s0001325/work/sersophane/src/routes/+page.js' because it would overwrite input file.\",\r\n    \"source\": \"ts\",\r\n    \"startLineNumber\": 1,\r\n    \"startColumn\": 1,\r\n    \"endLineNumber\": 1,\r\n    \"endColumn\": 2\r\n}]\r\n```\r\nTried restarting vscode, tried reinstalling packages etc. it is probably not related but it was not there before the migration. Who knows!\r\n\r\nMy `tsconfig.json` is very simple:\r\n```\r\n{\r\n\t\"extends\": \"./.svelte-kit/tsconfig.json\",\r\n\t\"compilerOptions\": {\r\n\t\t\"allowJs\": true,\r\n\t\t\"checkJs\": true,\r\n\t\t\"esModuleInterop\": true,\r\n\t\t\"forceConsistentCasingInFileNames\": true,\r\n\t\t\"resolveJsonModule\": true,\r\n\t\t\"skipLibCheck\": true,\r\n\t\t\"sourceMap\": true,\r\n\t\t\"strict\": true\r\n\t}\r\n}\r\n```\r\n\r\n### System Info\r\n\r\n```shell\r\nSystem:\r\n    OS: Linux 5.15 Ubuntu 20.04.4 LTS (Focal Fossa)\r\n    CPU: (16) x64 Intel(R) Core(TM) i9-10885H CPU @ 2.40GHz\r\n    Memory: 19.86 GB / 31.20 GB\r\n    Container: Yes\r\n    Shell: 5.0.17 - /bin/bash\r\n  Binaries:\r\n    Node: 18.7.0 - ~/.nvm/versions/node/v18.7.0/bin/node\r\n    npm: 8.15.0 - ~/.nvm/versions/node/v18.7.0/bin/npm\r\n  Browsers:\r\n    Chrome: 104.0.5112.79\r\n  npmPackages:\r\n    @sveltejs/adapter-node: next => 1.0.0-next.86 \r\n    @sveltejs/kit: next => 1.0.0-next.407 \r\n    svelte: ^3.49.0 => 3.49.0 \r\n    vite: ^3.0.7 => 3.0.7\r\n```\r\n\r\n\r\n### Severity\r\n\r\nannoyance\r\n\r\n### Additional Information\r\n\r\n_No response_","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5899/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5899/timeline","performed_via_github_app":null,"state_reason":"completed"}