{"url":"https://api.github.com/repos/sveltejs/kit/issues/5079","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5079/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5079/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5079/events","html_url":"https://github.com/sveltejs/kit/issues/5079","id":1249022368,"node_id":"I_kwDOEiPr8c5KcpGg","number":5079,"title":"Crawl follows <link rel=alternate> links in <head>, surprisingly prerendering rss feed generating endpoints","user":{"login":"Bluebie","id":12768,"node_id":"MDQ6VXNlcjEyNzY4","avatar_url":"https://avatars.githubusercontent.com/u/12768?v=4","gravatar_id":"","url":"https://api.github.com/users/Bluebie","html_url":"https://github.com/Bluebie","followers_url":"https://api.github.com/users/Bluebie/followers","following_url":"https://api.github.com/users/Bluebie/following{/other_user}","gists_url":"https://api.github.com/users/Bluebie/gists{/gist_id}","starred_url":"https://api.github.com/users/Bluebie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bluebie/subscriptions","organizations_url":"https://api.github.com/users/Bluebie/orgs","repos_url":"https://api.github.com/users/Bluebie/repos","events_url":"https://api.github.com/users/Bluebie/events{/privacy}","received_events_url":"https://api.github.com/users/Bluebie/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470026,"node_id":"MDU6TGFiZWwyNDI4NDcwMDI2","url":"https://api.github.com/repos/sveltejs/kit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3229642339,"node_id":"MDU6TGFiZWwzMjI5NjQyMzM5","url":"https://api.github.com/repos/sveltejs/kit/labels/p2-nice-to-have","name":"p2-nice-to-have","color":"A7463B","default":false,"description":"SvelteKit cannot be used by a small number of people, quality of life improvements, etc."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sveltejs/kit/milestones/2","html_url":"https://github.com/sveltejs/kit/milestone/2","labels_url":"https://api.github.com/repos/sveltejs/kit/milestones/2/labels","id":6044960,"node_id":"MDk6TWlsZXN0b25lNjA0NDk2MA==","number":2,"title":"1.0","description":"stuff we need to nail down before launch","creator":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":628,"state":"closed","created_at":"2020-10-29T01:17:50Z","updated_at":"2022-12-19T11:47:29Z","due_on":null,"closed_at":"2022-12-19T11:47:29Z"},"comments":1,"created_at":"2022-05-26T02:45:16Z","updated_at":"2022-09-23T07:16:35Z","closed_at":"2022-09-23T07:16:34Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the problem\n\nCurrently, when crawl is enabled, build will crawl seemingly any tag with a href, src, or srcset attribute, and does not contain a rel=\"external\" attribute. Normally, these pages are prerendered: https://github.com/sveltejs/kit/blob/623fa495c46e22213185199e56fad5a3fbaa2f80/packages/kit/src/core/build/prerender/crawl.js#L184\r\n\r\nAs a result, using an endpoint to generate dynamic data, like an rss/atom/json-feed will cause the feed endpoint to be prerendered and the resulting feed on the site to be static and frozen. That might be desirable for static site rendering, but for dynamic sites, it's a problem. It's also surprising to encounter this, because endpoints (may change with: #4093) do not seem to support the `export const prerender = bool` option. It appears the only way to ensure endpoints aren't prerendered and frozen like this is to set rel=\"external\", disable prerendering/crawling entirely, or totally avoid outputting any tags with href/src/srcset attributes pointing to endpoints in html.\r\n\r\nWhile it maybe feasible to use `<link rel=\"alternate external\" href=\"/path/to/feed.atom\">` it feels semantically wrong because it is not an external resource, and I worry if we can really trust feed readers to have such a nuanced understanding of rel attribute semantics.\n\n### Describe the proposed solution\n\nI'm not sure what the right answer is, but here are some ideas:\r\n\r\n1. Don't crawl anything in `<head>`/`<svelte:head>`? Would this break any useful workflows? do people dynamically generate stylesheets or social media open graph type of resources through `<head>`?\r\n2. Adjust crawler to skip `rel=\"alternate\"` specifically to support feeds usecase? Would this break static site builders where a static prerendered feed maybe desirable?\r\n3. Support `export const prerender = false` in endpoints, and have that behaviour somehow refuse the page's inclusion in the prerender output?\r\n4. Implement a second `rel` attribute that functions the same as `\"external\"` for svelte crawler purposes but has no other existing semantics on the web, so we can control crawler at the link level without having undesirable effects on search engines.\r\n\r\nMaybe a composite answer is good. Is it surprising that the crawler follows `<link>`'s in head? I think so. Maybe crawling of `<link>` tags should be opt in? `<link rel=\"stylesheet svelte-prerender\" href=\"/styles-compiler-endpoint.css\">` maybe? Maybe it should be opt in in dynamic site builds but default on with fully static adaptors? But that feels like a messy answer.\n\n### Alternatives considered\n\n_No response_\n\n### Importance\n\nwould make my life easier\n\n### Additional Information\n\n_No response_","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5079/timeline","performed_via_github_app":null,"state_reason":"completed"}