{"url":"https://api.github.com/repos/sveltejs/kit/issues/3935","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/3935/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/3935/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/3935/events","html_url":"https://github.com/sveltejs/kit/issues/3935","id":1139189790,"node_id":"I_kwDOEiPr8c5D5qge","number":3935,"title":"Rethinking `rel=external`","user":{"login":"mrkishi","id":150237,"node_id":"MDQ6VXNlcjE1MDIzNw==","avatar_url":"https://avatars.githubusercontent.com/u/150237?v=4","gravatar_id":"","url":"https://api.github.com/users/mrkishi","html_url":"https://github.com/mrkishi","followers_url":"https://api.github.com/users/mrkishi/followers","following_url":"https://api.github.com/users/mrkishi/following{/other_user}","gists_url":"https://api.github.com/users/mrkishi/gists{/gist_id}","starred_url":"https://api.github.com/users/mrkishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrkishi/subscriptions","organizations_url":"https://api.github.com/users/mrkishi/orgs","repos_url":"https://api.github.com/users/mrkishi/repos","events_url":"https://api.github.com/users/mrkishi/events{/privacy}","received_events_url":"https://api.github.com/users/mrkishi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2850697519,"node_id":"MDU6TGFiZWwyODUwNjk3NTE5","url":"https://api.github.com/repos/sveltejs/kit/labels/router","name":"router","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-02-15T20:36:07Z","updated_at":"2022-02-17T16:31:13Z","closed_at":"2022-02-17T16:31:13Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the problem\n\nRight now, SvelteKit requires us to add a `rel=\"external\"` attribute to links that should cause a regular browser navigation instead of being handled by the client-side router. This allows us to direct users to routes in the same domain that are handled outside SvelteKit.\r\n\r\nThere are a few issues I can see:\r\n\r\n- `rel=\"external\"` is supposed to denote a link points to an external site. While different routes on a single domain being served by SvelteKit and other services could mean exactly that, they are orthogonal concepts‚Äîthey could arguably be considered a single site. The impact is probably minor but unknown: search engines could use this unfavorably.\r\n- It's required not only for external services, but also for static assets and standalone endpoints, which is surprising.\r\n- It optimizes for the exceptional case:\r\n    - The router will render a 404 for any unmatched routes under the app's domain, with the benefit that it doesn't cause a full page navigation and doesn't hit the server.\r\n    - However, 404s are the exception, not the norm: if you have a `/external` link and it doesn't match a route, the expectation is that it exists as a standalone endpoint, static asset or separate service. If it was in fact a link to SvelteKit-handled route that should 404, it'd arguably be the exception.\n\n### Describe the proposed solution\n\nWith that in mind, I propose that the client-side router should relegate links without a matching route to the browser for a full page navigation by default.\r\n\r\n- In the usual case, that would be the desired effect: it'd be a static asset, a standalone endpoint or an external server.\r\n- In the exceptional case (invalid or stale urls, etc), the experience would gracefully degrade: SvelteKit would end up ssr'ing the 404 page and the client-side app would restart normally.\r\n\r\nOn cases where the link _would_ match a SvelteKit route (eg. `/[...path].svelte` as a catch-all would mean any route would match), we'd still need an attribute to disable SvelteKit's client-side routing. We could keep `rel=\"external\"` or come up with a SvelteKit-specific attribute like `sveltekit:noroute` (we have the `sveltekit:noscroll` prior art, but it does sound odd üêê).\n\n### Alternatives considered\n\nThis change would mean the exceptional case (a non-route link should be handled by SvelteKit's client-side router) _would require_ a round-trip. We could, instead, aim to minimize the amount of `sveltekit:noroute` links: instead of requiring it on static assets, standalone endpoints and external services, we could require it only on external services by either:\r\n\r\n- Making the client-side router aware of standalone endpoints and static assets: not ideal as it'd increase the payload for the app, in some cases considerably (#2656 _got rid_ of endpoints from the payload).\r\n- Automatically adding the attribute at compile-time if we see a matching endpoint or asset: viable improvement.\r\n\r\nStill, I don't think it'd be worth the hassle to add the attribute to all externally handled routes just to skip a navigation on 404s, as I'd rather strive to eliminate 404s instead.\n\n### Importance\n\nwould make my life easier\n\n### Additional Information\n\n_No response_","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/3935/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/3935/timeline","performed_via_github_app":null,"state_reason":"completed"}