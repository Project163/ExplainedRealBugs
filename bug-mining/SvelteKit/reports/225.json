{"url":"https://api.github.com/repos/sveltejs/kit/issues/5479","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/5479/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/5479/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/5479/events","html_url":"https://github.com/sveltejs/kit/issues/5479","id":1302441439,"node_id":"I_kwDOEiPr8c5Noa3f","number":5479,"title":"Service Worker Compilation during Development","user":{"login":"meticoeus","id":7563061,"node_id":"MDQ6VXNlcjc1NjMwNjE=","avatar_url":"https://avatars.githubusercontent.com/u/7563061?v=4","gravatar_id":"","url":"https://api.github.com/users/meticoeus","html_url":"https://github.com/meticoeus","followers_url":"https://api.github.com/users/meticoeus/followers","following_url":"https://api.github.com/users/meticoeus/following{/other_user}","gists_url":"https://api.github.com/users/meticoeus/gists{/gist_id}","starred_url":"https://api.github.com/users/meticoeus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meticoeus/subscriptions","organizations_url":"https://api.github.com/users/meticoeus/orgs","repos_url":"https://api.github.com/users/meticoeus/repos","events_url":"https://api.github.com/users/meticoeus/events{/privacy}","received_events_url":"https://api.github.com/users/meticoeus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2428470046,"node_id":"MDU6TGFiZWwyNDI4NDcwMDQ2","url":"https://api.github.com/repos/sveltejs/kit/labels/feature%20/%20enhancement","name":"feature / enhancement","color":"a2eeef","default":false,"description":"New feature or request"},{"id":3286002511,"node_id":"MDU6TGFiZWwzMjg2MDAyNTEx","url":"https://api.github.com/repos/sveltejs/kit/labels/service%20worker","name":"service worker","color":"2493F8","default":false,"description":"Stuff related to service workers"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sveltejs/kit/milestones/2","html_url":"https://github.com/sveltejs/kit/milestone/2","labels_url":"https://api.github.com/repos/sveltejs/kit/milestones/2/labels","id":6044960,"node_id":"MDk6TWlsZXN0b25lNjA0NDk2MA==","number":2,"title":"1.0","description":"stuff we need to nail down before launch","creator":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":628,"state":"closed","created_at":"2020-10-29T01:17:50Z","updated_at":"2022-12-19T11:47:29Z","due_on":null,"closed_at":"2022-12-19T11:47:29Z"},"comments":9,"created_at":"2022-07-12T18:00:27Z","updated_at":"2022-11-11T14:57:07Z","closed_at":"2022-11-11T14:57:06Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the problem\r\n\r\nTesting non-trivial service-worker features in a Sveltekit app is currently pretty painful. The most success I've had is using `npm run build && npm preview`  after every code change, losing the utility of dev mode when testing features that rely on the service-worker.\r\n\r\nAs far as I've been able to find, Sveltekit only supports building the service-worker in a production build.\r\n\r\n### Describe the proposed solution\r\n\r\nAdd a config option to enable building the service-worker in development mode, i.e. when running `npm run dev`. This should skip pre-caching (or provide a way for the user to skip serving cached files) and only load additional functionality from the user's service-worker.\r\n\r\n### Alternatives considered\r\n\r\n[vite-plugin-pwa](https://vite-plugin-pwa.netlify.app/frameworks/sveltekit.html) appears to support [building in development](https://vite-plugin-pwa.netlify.app/guide/development.html) but not for Sveltekit (at least by default, maybe there is a way to configure it to do so?) and also looks like it would add additional configuration to maintain to get it work as well as the built-in SW support.\r\n\r\n### Importance\r\n\r\nwould make my life easier\r\n\r\n### Additional Information\r\n\r\nI am currently building/maintaining an app that makes extensive use of the service-worker to enable offline functionality. It hosts a small graphql server at /graphql as a single source of truth for pages to get data from. It is not proxying a \"real\" graphql server and instead fetches data from multiple places to store in IndexedDB, then queries IDB in the resolvers. It also handles an offline-capable file upload system, uploading files to the server when network service is available.\r\n\r\nAs a result. most of the app does not work well in dev. Sometimes I can use build-then-preview to get localhost to load the service worker, then stop preview and start dev and the page will start live-loading changes to non-service-worker code but this is flaky; if the SW gets unloaded the app needs to be (possibly rebuilt,) previewed, and swapped back to dev again.\r\n\r\nIf anyone has an alternative to get SWs working in dev I'd be glad to hear it.","closed_by":{"login":"Rich-Harris","id":1162160,"node_id":"MDQ6VXNlcjExNjIxNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1162160?v=4","gravatar_id":"","url":"https://api.github.com/users/Rich-Harris","html_url":"https://github.com/Rich-Harris","followers_url":"https://api.github.com/users/Rich-Harris/followers","following_url":"https://api.github.com/users/Rich-Harris/following{/other_user}","gists_url":"https://api.github.com/users/Rich-Harris/gists{/gist_id}","starred_url":"https://api.github.com/users/Rich-Harris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rich-Harris/subscriptions","organizations_url":"https://api.github.com/users/Rich-Harris/orgs","repos_url":"https://api.github.com/users/Rich-Harris/repos","events_url":"https://api.github.com/users/Rich-Harris/events{/privacy}","received_events_url":"https://api.github.com/users/Rich-Harris/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/5479/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/5479/timeline","performed_via_github_app":null,"state_reason":"completed"}