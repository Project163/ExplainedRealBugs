{"url":"https://api.github.com/repos/sveltejs/kit/issues/14679","repository_url":"https://api.github.com/repos/sveltejs/kit","labels_url":"https://api.github.com/repos/sveltejs/kit/issues/14679/labels{/name}","comments_url":"https://api.github.com/repos/sveltejs/kit/issues/14679/comments","events_url":"https://api.github.com/repos/sveltejs/kit/issues/14679/events","html_url":"https://github.com/sveltejs/kit/issues/14679","id":3502129852,"node_id":"I_kwDOEiPr8c7QvkK8","number":14679,"title":"Cannot access '' before initialization","user":{"login":"AndreasHald","id":8914722,"node_id":"MDQ6VXNlcjg5MTQ3MjI=","avatar_url":"https://avatars.githubusercontent.com/u/8914722?v=4","gravatar_id":"","url":"https://api.github.com/users/AndreasHald","html_url":"https://github.com/AndreasHald","followers_url":"https://api.github.com/users/AndreasHald/followers","following_url":"https://api.github.com/users/AndreasHald/following{/other_user}","gists_url":"https://api.github.com/users/AndreasHald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndreasHald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndreasHald/subscriptions","organizations_url":"https://api.github.com/users/AndreasHald/orgs","repos_url":"https://api.github.com/users/AndreasHald/repos","events_url":"https://api.github.com/users/AndreasHald/events{/privacy}","received_events_url":"https://api.github.com/users/AndreasHald/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":4,"created_at":"2025-10-10T09:46:50Z","updated_at":"2025-10-17T13:42:14Z","closed_at":"2025-10-17T08:12:40Z","author_association":"NONE","type":{"id":4885414,"node_id":"IT_kwDOAWhhq84ASoum","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-29T23:39:46Z","updated_at":"2024-07-26T11:19:25Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nBuild fails on a certain remote function setup.\n```                           \nReferenceError [Error]: Cannot access 'schema' before initialization\n    at file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/.svelte-kit/output/server/chunks/remote-1e3r2ap.js:15:26\n    at ModuleJob.run (node:internal/modules/esm/module_job:271:25)\n    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:547:26)\n    at async analyse (file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/node_modules/@sveltejs/kit/src/core/postbuild/analyse.js:173:34)\n    at async MessagePort.<anonymous> (file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/node_modules/@sveltejs/kit/src/utils/fork.js:23:16)\n```\n\nThe reproduction attempts to illustrate the setup as simply as possible but what we are doing on a high level is defining table columns using a const\n\n```ts\n\nexport const tableSetup = {\n   name: {\n      cell: SomeComponent,\n      type: 'text',\n      facet: 'some-facet-type',\n      sortable: true,\n      ...\n   }\n}\n\n```\n\nAnd then inferring the schema for remote functions based on that\n```ts\n\nexport const schema = buildSchemaFromTableSetup(tableSetup)\n\n```\n\nThat way when calling remote functions, you can get types on your filtering, sorting and faceting of the table rows which is really nice.\n\nHowever when updating to the latest version of SvelteKit building this fails. We are currently building it successfully on `2.38.1`\n\n### Reproduction\n\nhttps://github.com/21RISK/sveltekit-remote-function-reproduction\n\nreproduction created from `npx sv create` with as minimal changes as possible to highlight issue. run `npm run build` to see error\n\n### Logs\n\n```Shell\nnode:internal/event_target:1101\n  process.nextTick(() => { throw err; });\n                           ^\nReferenceError [Error]: Cannot access 'schema' before initialization\n    at file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/.svelte-kit/output/server/chunks/remote-1e3r2ap.js:14:26\n    at ModuleJob.run (node:internal/modules/esm/module_job:271:25)\n    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:547:26)\n    at async analyse (file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/node_modules/@sveltejs/kit/src/core/postbuild/analyse.js:173:34)\n    at async MessagePort.<anonymous> (file:///Users/hald/Documents/svelte-kit-remote-function-reproduction/node_modules/@sveltejs/kit/src/utils/fork.js:23:16)\n\nNode.js v22.12.0\n```\n\n### System Info\n\n```Shell\nSystem:\n    OS: macOS 26.0\n    CPU: (10) arm64 Apple M1 Pro\n    Memory: 255.36 MB / 32.00 GB\n    Shell: 5.9 - /bin/zsh\n  Binaries:\n    Node: 22.12.0 - /Users/hald/.nvm/versions/node/v22.12.0/bin/node\n    npm: 11.4.2 - /Users/hald/.nvm/versions/node/v22.12.0/bin/npm\n  Browsers:\n    Chrome: 141.0.7390.67\n    Firefox: 137.0.2\n    Safari: 26.0\n  npmPackages:\n    @sveltejs/adapter-auto: ^6.1.0 => 6.1.1 \n    @sveltejs/kit: ^2.43.2 => 2.46.4 \n    @sveltejs/vite-plugin-svelte: ^6.2.0 => 6.2.1 \n    svelte: ^5.39.5 => 5.39.11 \n    vite: ^7.1.7 => 7.1.9\n```\n\n### Severity\n\nblocking an upgrade\n\n### Additional Information\n\n_No response_","closed_by":{"login":"dummdidumm","id":5968653,"node_id":"MDQ6VXNlcjU5Njg2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5968653?v=4","gravatar_id":"","url":"https://api.github.com/users/dummdidumm","html_url":"https://github.com/dummdidumm","followers_url":"https://api.github.com/users/dummdidumm/followers","following_url":"https://api.github.com/users/dummdidumm/following{/other_user}","gists_url":"https://api.github.com/users/dummdidumm/gists{/gist_id}","starred_url":"https://api.github.com/users/dummdidumm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dummdidumm/subscriptions","organizations_url":"https://api.github.com/users/dummdidumm/orgs","repos_url":"https://api.github.com/users/dummdidumm/repos","events_url":"https://api.github.com/users/dummdidumm/events{/privacy}","received_events_url":"https://api.github.com/users/dummdidumm/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sveltejs/kit/issues/14679/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"timeline_url":"https://api.github.com/repos/sveltejs/kit/issues/14679/timeline","performed_via_github_app":null,"state_reason":"completed"}