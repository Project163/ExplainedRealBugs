diff --git a/src/main/java/org/jfree/chart/annotations/CategoryLineAnnotation.java b/src/main/java/org/jfree/chart/annotations/CategoryLineAnnotation.java
index c232a5e3..cd938d35 100644
--- a/src/main/java/org/jfree/chart/annotations/CategoryLineAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/CategoryLineAnnotation.java
@@ -96,18 +96,22 @@ public class CategoryLineAnnotation extends AbstractAnnotation
      * and (category2, value2).
      *
      * @param category1  the category ({@code null} not permitted).
-     * @param value1  the value.
+     * @param value1  the value (must be finite).
      * @param category2  the category ({@code null} not permitted).
-     * @param value2  the value.
+     * @param value2  the value (must be finite).
      * @param paint  the line color ({@code null} not permitted).
      * @param stroke  the line stroke ({@code null} not permitted).
      */
     public CategoryLineAnnotation(Comparable category1, double value1,
                                   Comparable category2, double value2,
                                   Paint paint, Stroke stroke) {
+        // FIXME : the order of the paint and stroke parameters is reversed
+        // compared to XYLineAnnotation...should be consistent
         super();
         Args.nullNotPermitted(category1, "category1");
+        Args.requireFinite(value1, "value1");
         Args.nullNotPermitted(category2, "category2");
+        Args.requireFinite(value2, "value2");
         Args.nullNotPermitted(paint, "paint");
         Args.nullNotPermitted(stroke, "stroke");
         this.category1 = category1;
@@ -158,11 +162,12 @@ public class CategoryLineAnnotation extends AbstractAnnotation
      * Sets the y-value for the start of the line and sends an
      * {@link AnnotationChangeEvent} to all registered listeners.
      *
-     * @param value  the value.
+     * @param value  the value (must be finite).
      *
      * @see #getValue1()
      */
     public void setValue1(double value) {
+        Args.requireFinite(value, "value");
         this.value1 = value;
         fireAnnotationChanged();
     }
@@ -207,11 +212,12 @@ public class CategoryLineAnnotation extends AbstractAnnotation
      * Sets the y-value for the end of the line and sends an
      * {@link AnnotationChangeEvent} to all registered listeners.
      *
-     * @param value  the value.
+     * @param value  the value (must be finite).
      *
      * @see #getValue2()
      */
     public void setValue2(double value) {
+        Args.requireFinite(value, "value");
         this.value2 = value;
         fireAnnotationChanged();
     }
@@ -303,8 +309,7 @@ public class CategoryLineAnnotation extends AbstractAnnotation
                 CategoryAnchor.MIDDLE, catIndex2, catCount, dataArea,
                 domainEdge);
             lineX2 = rangeAxis.valueToJava2D(this.value2, dataArea, rangeEdge);
-        }
-        else if (orientation == PlotOrientation.VERTICAL) {
+        } else if (orientation == PlotOrientation.VERTICAL) {
             lineX1 = domainAxis.getCategoryJava2DCoordinate(
                 CategoryAnchor.MIDDLE, catIndex1, catCount, dataArea,
                 domainEdge);
diff --git a/src/main/java/org/jfree/chart/annotations/XYBoxAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYBoxAnnotation.java
index ab242208..d6ad8ee8 100644
--- a/src/main/java/org/jfree/chart/annotations/XYBoxAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYBoxAnnotation.java
@@ -56,6 +56,7 @@ import org.jfree.chart.plot.XYPlot;
 import org.jfree.chart.api.RectangleEdge;
 import org.jfree.chart.internal.PaintUtils;
 import org.jfree.chart.api.PublicCloneable;
+import org.jfree.chart.internal.Args;
 import org.jfree.chart.internal.SerialUtils;
 
 /**
@@ -121,10 +122,10 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
     /**
      * Creates a new annotation.
      *
-     * @param x0  the lower x-coordinate of the box (in data space).
-     * @param y0  the lower y-coordinate of the box (in data space).
-     * @param x1  the upper x-coordinate of the box (in data space).
-     * @param y1  the upper y-coordinate of the box (in data space).
+     * @param x0  the lower x-coordinate of the box (in data space, must be finite).
+     * @param y0  the lower y-coordinate of the box (in data space, must be finite).
+     * @param x1  the upper x-coordinate of the box (in data space, must be finite).
+     * @param y1  the upper y-coordinate of the box (in data space, must be finite).
      * @param stroke  the shape stroke ({@code null} permitted).
      * @param outlinePaint  the shape color ({@code null} permitted).
      * @param fillPaint  the paint used to fill the shape ({@code null}
@@ -133,6 +134,10 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
     public XYBoxAnnotation(double x0, double y0, double x1, double y1,
                            Stroke stroke, Paint outlinePaint, Paint fillPaint) {
         super();
+        Args.requireFinite(x0, "x0");
+        Args.requireFinite(y0, "y0");
+        Args.requireFinite(x1, "x1");
+        Args.requireFinite(y1, "y1");
         this.x0 = x0;
         this.y0 = y0;
         this.x1 = x1;
@@ -142,6 +147,73 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
         this.fillPaint = fillPaint;
     }
 
+    /**
+     * Returns the x-coordinate for the bottom left corner of the box (set in the
+     * constructor).
+     * 
+     * @return The x-coordinate for the bottom left corner of the box.
+     */
+    public double getX0() {
+        return x0;
+    }
+
+    /**
+     * Returns the y-coordinate for the bottom left corner of the box (set in the
+     * constructor).
+     * 
+     * @return The y-coordinate for the bottom left corner of the box.
+     */
+    public double getY0() {
+        return y0;
+    }
+
+    /**
+     * Returns the x-coordinate for the top right corner of the box (set in the
+     * constructor).
+     * 
+     * @return The x-coordinate for the top right corner of the box.
+     */
+    public double getX1() {
+        return x1;
+    }
+
+    /**
+     * Returns the y-coordinate for the top right corner of the box (set in the
+     * constructor).
+     * 
+     * @return The y-coordinate for the top right corner of the box.
+     */
+    public double getY1() {
+        return y1;
+    }
+
+    /**
+     * Returns the stroke used for the box outline.
+     * 
+     * @return The stroke (possibly {@code null}). 
+     */
+    public Stroke getStroke() {
+        return stroke;
+    }
+
+    /**
+     * Returns the paint used for the box outline.
+     * 
+     * @return The paint (possibly {@code null}). 
+     */
+    public Paint getOutlinePaint() {
+        return outlinePaint;
+    }
+
+    /**
+     * Returns the paint used for the box fill.
+     * 
+     * @return The paint (possibly {@code null}). 
+     */
+    public Paint getFillPaint() {
+        return fillPaint;
+    }
+
     /**
      * Draws the annotation.  This method is usually called by the
      * {@link XYPlot} class, you shouldn't need to call it directly.
@@ -176,8 +248,7 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
         if (orientation == PlotOrientation.HORIZONTAL) {
             box = new Rectangle2D.Double(transY0, transX1, transY1 - transY0,
                     transX0 - transX1);
-        }
-        else if (orientation == PlotOrientation.VERTICAL) {
+        } else if (orientation == PlotOrientation.VERTICAL) {
             box = new Rectangle2D.Double(transX0, transY1, transX1 - transX0,
                     transY0 - transY1);
         }
@@ -193,7 +264,6 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
             g2.draw(box);
         }
         addEntity(info, box, rendererIndex, getToolTipText(), getURL());
-
     }
 
     /**
@@ -237,7 +307,6 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
         if (!PaintUtils.equal(this.fillPaint, that.fillPaint)) {
             return false;
         }
-        // seem to be the same
         return true;
     }
 
@@ -297,8 +366,7 @@ public class XYBoxAnnotation extends AbstractXYAnnotation
      * @throws ClassNotFoundException  if there is a classpath problem.
      */
     private void readObject(ObjectInputStream stream)
-        throws IOException, ClassNotFoundException {
-
+            throws IOException, ClassNotFoundException {
         stream.defaultReadObject();
         this.stroke = SerialUtils.readStroke(stream);
         this.outlinePaint = SerialUtils.readPaint(stream);
diff --git a/src/main/java/org/jfree/chart/annotations/XYDrawableAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYDrawableAnnotation.java
index fd60cfe8..c632f4ea 100644
--- a/src/main/java/org/jfree/chart/annotations/XYDrawableAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYDrawableAnnotation.java
@@ -82,10 +82,10 @@ public class XYDrawableAnnotation extends AbstractXYAnnotation
     /**
      * Creates a new annotation to be displayed within the given area.
      *
-     * @param x  the x-coordinate for the area.
-     * @param y  the y-coordinate for the area.
-     * @param width  the width of the area.
-     * @param height  the height of the area.
+     * @param x  the x-coordinate for the area (must be finite).
+     * @param y  the y-coordinate for the area (must be finite).
+     * @param width  the width of the area (must be finite).
+     * @param height  the height of the area (must be finite).
      * @param drawable  the drawable object ({@code null} not permitted).
      */
     public XYDrawableAnnotation(double x, double y, double width, double height,
@@ -99,25 +99,73 @@ public class XYDrawableAnnotation extends AbstractXYAnnotation
      * will be drawn at twice the requested display size then scaled down to
      * fit the space.
      *
-     * @param x  the x-coordinate for the area.
-     * @param y  the y-coordinate for the area.
-     * @param displayWidth  the width of the area.
-     * @param displayHeight  the height of the area.
-     * @param drawScaleFactor  the scaling factor for drawing.
+     * @param x  the x-coordinate for the area (must be finite).
+     * @param y  the y-coordinate for the area (must be finite).
+     * @param displayWidth  the width of the area (must be finite).
+     * @param displayHeight  the height of the area (must be finite).
+     * @param drawScaleFactor  the scaling factor for drawing (must be finite).
      * @param drawable  the drawable object ({@code null} not permitted).
      */
     public XYDrawableAnnotation(double x, double y, double displayWidth,
             double displayHeight, double drawScaleFactor, Drawable drawable) {
-
         super();
         Args.nullNotPermitted(drawable, "drawable");
+        Args.requireFinite(x, "x");
+        Args.requireFinite(y, "y");
+        Args.requireFinite(displayWidth, "displayWidth");
+        Args.requireFinite(displayHeight, "displayHeight");
+        Args.requireFinite(drawScaleFactor, "drawScaleFactor");
         this.x = x;
         this.y = y;
         this.displayWidth = displayWidth;
         this.displayHeight = displayHeight;
         this.drawScaleFactor = drawScaleFactor;
         this.drawable = drawable;
+    }
+
+    /**
+     * Returns the x-coordinate (set in the constructor).
+     * 
+     * @return The x-coordinate.
+     */
+    public double getX() {
+        return x;
+    }
+
+    /**
+     * Returns the y-coordinate (set in the constructor).
+     * 
+     * @return The y-coordinate.
+     */
+    public double getY() {
+        return y;
+    }
+
+    /**
+     * Returns the display width (set in the constructor).
+     * 
+     * @return The display width.
+     */
+    public double getDisplayWidth() {
+        return displayWidth;
+    }
 
+    /**
+     * Returns the display height (set in the constructor).
+     * 
+     * @return The display height.
+     */
+    public double getDisplayHeight() {
+        return displayHeight;
+    }
+
+    /**
+     * Returns the scale factor (set in the constructor).
+     * 
+     * @return The scale factor.
+     */
+    public double getDrawScaleFactor() {
+        return drawScaleFactor;
     }
 
     /**
@@ -182,7 +230,6 @@ public class XYDrawableAnnotation extends AbstractXYAnnotation
      */
     @Override
     public boolean equals(Object obj) {
-
         if (obj == this) { // simple case
             return true;
         }
@@ -212,9 +259,7 @@ public class XYDrawableAnnotation extends AbstractXYAnnotation
         if (!Objects.equals(this.drawable, that.drawable)) {
             return false;
         }
-        // seem to be the same...
         return true;
-
     }
 
     /**
diff --git a/src/main/java/org/jfree/chart/annotations/XYImageAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYImageAnnotation.java
index 320d5ac3..895e2b24 100644
--- a/src/main/java/org/jfree/chart/annotations/XYImageAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYImageAnnotation.java
@@ -88,8 +88,8 @@ public class XYImageAnnotation extends AbstractXYAnnotation
      * Creates a new annotation to be displayed at the specified (x, y)
      * location.
      *
-     * @param x  the x-coordinate (in data space).
-     * @param y  the y-coordinate (in data space).
+     * @param x  the x-coordinate (in data space, must be finite).
+     * @param y  the y-coordinate (in data space, must be finite).
      * @param image  the image ({@code null} not permitted).
      */
     public XYImageAnnotation(double x, double y, Image image) {
@@ -110,6 +110,8 @@ public class XYImageAnnotation extends AbstractXYAnnotation
         super();
         Args.nullNotPermitted(image, "image");
         Args.nullNotPermitted(anchor, "anchor");
+        Args.requireFinite(x, "x");
+        Args.requireFinite(y, "y");
         this.x = x;
         this.y = y;
         this.image = image;
@@ -168,10 +170,8 @@ public class XYImageAnnotation extends AbstractXYAnnotation
      */
     @Override
     public void draw(Graphics2D g2, XYPlot plot, Rectangle2D dataArea,
-                     ValueAxis domainAxis, ValueAxis rangeAxis,
-                     int rendererIndex,
-                     PlotRenderingInfo info) {
-
+            ValueAxis domainAxis, ValueAxis rangeAxis,
+            int rendererIndex, PlotRenderingInfo info) {
         PlotOrientation orientation = plot.getOrientation();
         AxisLocation domainAxisLocation = plot.getDomainAxisLocation();
         AxisLocation rangeAxisLocation = plot.getRangeAxisLocation();
@@ -188,8 +188,7 @@ public class XYImageAnnotation extends AbstractXYAnnotation
         if (orientation == PlotOrientation.HORIZONTAL) {
             xx = j2DY;
             yy = j2DX;
-        }
-        else if (orientation == PlotOrientation.VERTICAL) {
+        } else if (orientation == PlotOrientation.VERTICAL) {
             xx = j2DX;
             yy = j2DY;
         }
diff --git a/src/main/java/org/jfree/chart/annotations/XYLineAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYLineAnnotation.java
index 8f8bcd27..86806df2 100644
--- a/src/main/java/org/jfree/chart/annotations/XYLineAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYLineAnnotation.java
@@ -64,6 +64,7 @@ import org.jfree.chart.internal.ShapeUtils;
 
 /**
  * A simple line annotation that can be placed on an {@link XYPlot}.
+ * Instances of this class are immutable.
  */
 public class XYLineAnnotation extends AbstractXYAnnotation
         implements Cloneable, PublicCloneable, Serializable {
@@ -92,7 +93,7 @@ public class XYLineAnnotation extends AbstractXYAnnotation
     /**
      * Creates a new annotation that draws a line from (x1, y1) to (x2, y2)
      * where the coordinates are measured in data space (that is, against the
-     * plot's axes).
+     * plot's axes).  All the line coordinates are required to be finite values.
      *
      * @param x1  the x-coordinate for the start of the line.
      * @param y1  the y-coordinate for the start of the line.
@@ -108,26 +109,86 @@ public class XYLineAnnotation extends AbstractXYAnnotation
      * where the coordinates are measured in data space (that is, against the
      * plot's axes).
      *
-     * @param x1  the x-coordinate for the start of the line.
-     * @param y1  the y-coordinate for the start of the line.
-     * @param x2  the x-coordinate for the end of the line.
-     * @param y2  the y-coordinate for the end of the line.
+     * @param x1  the x-coordinate for the start of the line (must be finite).
+     * @param y1  the y-coordinate for the start of the line (must be finite).
+     * @param x2  the x-coordinate for the end of the line (must be finite).
+     * @param y2  the y-coordinate for the end of the line (must be finite).
      * @param stroke  the line stroke ({@code null} not permitted).
      * @param paint  the line color ({@code null} not permitted).
      */
     public XYLineAnnotation(double x1, double y1, double x2, double y2,
                             Stroke stroke, Paint paint) {
-
         super();
         Args.nullNotPermitted(stroke, "stroke");
         Args.nullNotPermitted(paint, "paint");
+        Args.requireFinite(x1, "x1");
+        Args.requireFinite(y1, "y1");
+        Args.requireFinite(x2, "x2");
+        Args.requireFinite(y2, "y2");
         this.x1 = x1;
         this.y1 = y1;
         this.x2 = x2;
         this.y2 = y2;
         this.stroke = stroke;
         this.paint = paint;
+    }
+
+    /**
+     * Returns the x-coordinate for the starting point of the line (set in the
+     * constructor).
+     * 
+     * @return The x-coordinate for the starting point of the line.
+     */
+    public double getX1() {
+        return x1;
+    }
+
+    /**
+     * Returns the y-coordinate for the starting point of the line (set in the
+     * constructor).
+     * 
+     * @return The y-coordinate for the starting point of the line.
+     */
+    public double getY1() {
+        return y1;
+    }
 
+    /**
+     * Returns the x-coordinate for the ending point of the line (set in the
+     * constructor).
+     * 
+     * @return The x-coordinate for the ending point of the line.
+     */
+    public double getX2() {
+        return x2;
+    }
+
+    /**
+     * Returns the y-coordinate for the ending point of the line (set in the
+     * constructor).
+     * 
+     * @return The y-coordinate for the ending point of the line.
+     */
+    public double getY2() {
+        return y2;
+    }
+
+    /**
+     * Returns the stroke used for drawing the line (set in the constructor).
+     * 
+     * @return The stroke (never {@code null}).
+     */
+    public Stroke getStroke() {
+        return stroke;
+    }
+
+    /**
+     * Returns the paint used for drawing the line (set in the constructor).
+     * 
+     * @return The paint (never {@code null}).
+     */
+    public Paint getPaint() {
+        return paint;
     }
 
     /**
@@ -167,8 +228,7 @@ public class XYLineAnnotation extends AbstractXYAnnotation
                     domainEdge);
             j2DY2 = (float) rangeAxis.valueToJava2D(this.y2, dataArea,
                     rangeEdge);
-        }
-        else if (orientation == PlotOrientation.HORIZONTAL) {
+        } else if (orientation == PlotOrientation.HORIZONTAL) {
             j2DY1 = (float) domainAxis.valueToJava2D(this.x1, dataArea,
                     domainEdge);
             j2DX1 = (float) rangeAxis.valueToJava2D(this.y1, dataArea,
@@ -233,7 +293,6 @@ public class XYLineAnnotation extends AbstractXYAnnotation
         if (!Objects.equals(this.stroke, that.stroke)) {
             return false;
         }
-        // seems to be the same...
         return true;
     }
 
diff --git a/src/main/java/org/jfree/chart/annotations/XYPointerAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYPointerAnnotation.java
index 2047a65a..013ff3d3 100644
--- a/src/main/java/org/jfree/chart/annotations/XYPointerAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYPointerAnnotation.java
@@ -138,6 +138,9 @@ public class XYPointerAnnotation extends XYTextAnnotation
     public XYPointerAnnotation(String label, double x, double y, double angle) {
 
         super(label, x, y);
+        Args.requireFinite(x, "x");
+        Args.requireFinite(y, "y");
+        Args.requireFinite(angle, "angle");
         this.angle = angle;
         this.tipRadius = DEFAULT_TIP_RADIUS;
         this.baseRadius = DEFAULT_BASE_RADIUS;
diff --git a/src/main/java/org/jfree/chart/annotations/XYTextAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYTextAnnotation.java
index 1315cffa..108df8a8 100644
--- a/src/main/java/org/jfree/chart/annotations/XYTextAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYTextAnnotation.java
@@ -140,12 +140,14 @@ public class XYTextAnnotation extends AbstractXYAnnotation
      * Java2D space for display).
      *
      * @param text  the text ({@code null} not permitted).
-     * @param x  the x-coordinate (in data space).
-     * @param y  the y-coordinate (in data space).
+     * @param x  the x-coordinate (in data space, must be finite).
+     * @param y  the y-coordinate (in data space, must be finite).
      */
     public XYTextAnnotation(String text, double x, double y) {
         super();
         Args.nullNotPermitted(text, "text");
+        Args.requireFinite(x, "x");
+        Args.requireFinite(y, "y");
         this.text = text;
         this.font = DEFAULT_FONT;
         this.paint = DEFAULT_PAINT;
@@ -333,6 +335,7 @@ public class XYTextAnnotation extends AbstractXYAnnotation
      * @see #getX()
      */
     public void setX(double x) {
+        Args.requireFinite(x, "x");
         this.x = x;
         fireAnnotationChanged();
     }
@@ -359,6 +362,7 @@ public class XYTextAnnotation extends AbstractXYAnnotation
      * @see #getY()
      */
     public void setY(double y) {
+        Args.requireFinite(y, "y");
         this.y = y;
         fireAnnotationChanged();
     }
diff --git a/src/main/java/org/jfree/chart/annotations/XYTitleAnnotation.java b/src/main/java/org/jfree/chart/annotations/XYTitleAnnotation.java
index 9deab62a..7fa6005e 100644
--- a/src/main/java/org/jfree/chart/annotations/XYTitleAnnotation.java
+++ b/src/main/java/org/jfree/chart/annotations/XYTitleAnnotation.java
@@ -120,6 +120,8 @@ public class XYTitleAnnotation extends AbstractXYAnnotation
     public XYTitleAnnotation(double x, double y, Title title,
             RectangleAnchor anchor) {
         super();
+        Args.requireFinite(x, "x");
+        Args.requireFinite(y, "y");
         Args.nullNotPermitted(title, "title");
         Args.nullNotPermitted(anchor, "anchor");
         this.coordinateType = XYCoordinateType.RELATIVE;
diff --git a/src/main/java/org/jfree/chart/internal/Args.java b/src/main/java/org/jfree/chart/internal/Args.java
index d9b82308..c1da9d9b 100644
--- a/src/main/java/org/jfree/chart/internal/Args.java
+++ b/src/main/java/org/jfree/chart/internal/Args.java
@@ -101,4 +101,21 @@ public class Args {
                     + upperBound);
         }
     }
+    
+    /**
+     * Checks the supplied value is finite (neither infinite nor NaN) and 
+     * throws an {@code IllegalArgumentException} if the requirement is not
+     * met.
+     * 
+     * @param value  the value.
+     * @param name  the parameter name (for use in the exception message).
+     * 
+     * @since 1.5.4
+     */
+    public static void requireFinite(double value, String name) {
+        if (!Double.isFinite(value)) {
+            throw new IllegalArgumentException("Require '" + name + "' (" 
+                    + value + ") to be finite.");
+        }
+    }
 }
diff --git a/src/main/java/org/jfree/chart/internal/LineUtils.java b/src/main/java/org/jfree/chart/internal/LineUtils.java
index c0964927..f86a96d1 100644
--- a/src/main/java/org/jfree/chart/internal/LineUtils.java
+++ b/src/main/java/org/jfree/chart/internal/LineUtils.java
@@ -45,7 +45,9 @@ import java.awt.geom.Rectangle2D;
 public class LineUtils {
 
     /**
-     * Clips the specified line to the given rectangle.
+     * Clips the specified line to the given rectangle.  If any of the line
+     * coordinates is not finite, then the method returns {@code false} and
+     * the line is not modified.
      *
      * @param line  the line ({@code null} not permitted).
      * @param rect  the clipping rectangle ({@code null} not permitted).
@@ -59,6 +61,12 @@ public class LineUtils {
         double y1 = line.getY1();
         double x2 = line.getX2();
         double y2 = line.getY2();
+        
+        // check that the line can be worked with (bug#223)
+        if ((!Double.isFinite(x1) || !Double.isFinite(y1)) 
+                || !Double.isFinite(x2) || !Double.isFinite(y2)) {
+            return false;
+        }
 
         double minX = rect.getMinX();
         double maxX = rect.getMaxX();
@@ -83,43 +91,36 @@ public class LineUtils {
                         && dx != 0.0) {
                     y1 = y1 + (minX - x1) * dy / dx;
                     x1 = minX;
-                }
-                else if ((f1 & Rectangle2D.OUT_RIGHT) == Rectangle2D.OUT_RIGHT
+                } else if ((f1 & Rectangle2D.OUT_RIGHT) == Rectangle2D.OUT_RIGHT
                         && dx != 0.0) {
                     y1 = y1 + (maxX - x1) * dy / dx;
                     x1 = maxX;
-                }
-                else if ((f1 & Rectangle2D.OUT_BOTTOM) == Rectangle2D.OUT_BOTTOM
+                } else if ((f1 & Rectangle2D.OUT_BOTTOM) == Rectangle2D.OUT_BOTTOM
                         && dy != 0.0) {
                     x1 = x1 + (maxY - y1) * dx / dy;
                     y1 = maxY;
-                }
-                else if ((f1 & Rectangle2D.OUT_TOP) == Rectangle2D.OUT_TOP
+                } else if ((f1 & Rectangle2D.OUT_TOP) == Rectangle2D.OUT_TOP
                         && dy != 0.0) {
                     x1 = x1 + (minY - y1) * dx / dy;
                     y1 = minY;
                 }
                 f1 = rect.outcode(x1, y1);
-            }
-            else if (f2 != 0) {
+            } else if (f2 != 0) {
                 // second point is outside, so we update it against one of the
                 // four sides then continue
                 if ((f2 & Rectangle2D.OUT_LEFT) == Rectangle2D.OUT_LEFT
                         && dx != 0.0) {
                     y2 = y2 + (minX - x2) * dy / dx;
                     x2 = minX;
-                }
-                else if ((f2 & Rectangle2D.OUT_RIGHT) == Rectangle2D.OUT_RIGHT
+                } else if ((f2 & Rectangle2D.OUT_RIGHT) == Rectangle2D.OUT_RIGHT
                         && dx != 0.0) {
                     y2 = y2 + (maxX - x2) * dy / dx;
                     x2 = maxX;
-                }
-                else if ((f2 & Rectangle2D.OUT_BOTTOM) == Rectangle2D.OUT_BOTTOM
+                } else if ((f2 & Rectangle2D.OUT_BOTTOM) == Rectangle2D.OUT_BOTTOM
                         && dy != 0.0) {
                     x2 = x2 + (maxY - y2) * dx / dy;
                     y2 = maxY;
-                }
-                else if ((f2 & Rectangle2D.OUT_TOP) == Rectangle2D.OUT_TOP
+                } else if ((f2 & Rectangle2D.OUT_TOP) == Rectangle2D.OUT_TOP
                         && dy != 0.0) {
                     x2 = x2 + (minY - y2) * dx / dy;
                     y2 = minY;
diff --git a/src/test/java/org/jfree/chart/annotations/CategoryLineAnnotationTest.java b/src/test/java/org/jfree/chart/annotations/CategoryLineAnnotationTest.java
index 82c98616..885626c5 100644
--- a/src/test/java/org/jfree/chart/annotations/CategoryLineAnnotationTest.java
+++ b/src/test/java/org/jfree/chart/annotations/CategoryLineAnnotationTest.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2020, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2021, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -------------------------------
  * CategoryLineAnnotationTest.java
  * -------------------------------
- * (C) Copyright 2005-2020, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2005-2021, by Object Refinery Limited and Contributors.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   -;
@@ -42,9 +42,11 @@ import static org.junit.jupiter.api.Assertions.assertFalse;
 
 import java.awt.BasicStroke;
 import java.awt.Color;
+import java.awt.Stroke;
 
 import org.jfree.chart.TestUtils;
 import org.jfree.chart.api.PublicCloneable;
+import static org.junit.jupiter.api.Assertions.assertThrows;
 
 import org.junit.jupiter.api.Test;
 
@@ -53,6 +55,35 @@ import org.junit.jupiter.api.Test;
  */
 public class CategoryLineAnnotationTest {
 
+    @Test
+    public void testConstructorExceptions() {
+        Stroke stroke = new BasicStroke(2.0f);
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation(null, 20.0, "Cat2", 200.0,
+                Color.BLUE, stroke);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation("Cat1", Double.NaN, "Cat2", 200.0,
+                Color.BLUE, stroke);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation("Cat1", 20.0, null, 200.0,
+                Color.BLUE, stroke);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation("Cat1", 20.0, "Cat2", Double.NaN,
+                Color.BLUE, stroke);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation("Cat1", 20.0, "Cat2", 200.0,
+                null, stroke);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            CategoryLineAnnotation a1 = new CategoryLineAnnotation("Cat1", 20.0, "Cat2", 200.0,
+                Color.BLUE, null);
+        });
+    }
+
     /**
      * Confirm that the equals method can distinguish all the required fields.
      */
diff --git a/src/test/java/org/jfree/chart/annotations/XYBoxAnnotationTest.java b/src/test/java/org/jfree/chart/annotations/XYBoxAnnotationTest.java
index fce32538..ae7af70f 100644
--- a/src/test/java/org/jfree/chart/annotations/XYBoxAnnotationTest.java
+++ b/src/test/java/org/jfree/chart/annotations/XYBoxAnnotationTest.java
@@ -44,16 +44,18 @@ import static org.junit.jupiter.api.Assertions.fail;
 import java.awt.BasicStroke;
 import java.awt.Color;
 import java.awt.GradientPaint;
+import java.awt.Stroke;
 
 import org.jfree.chart.JFreeChart;
 import org.jfree.chart.TestUtils;
 import org.jfree.chart.axis.NumberAxis;
 import org.jfree.chart.plot.XYPlot;
-import org.jfree.chart.renderer.xy.XYLineAndShapeRenderer;
 import org.jfree.chart.internal.CloneUtils;
 import org.jfree.chart.api.PublicCloneable;
+import org.jfree.chart.renderer.xy.XYLineAndShapeRenderer;
 import org.jfree.data.xy.DefaultTableXYDataset;
 import org.jfree.data.xy.XYSeries;
+import static org.junit.jupiter.api.Assertions.assertThrows;
 import org.junit.jupiter.api.Test;
 
 /**
@@ -61,6 +63,27 @@ import org.junit.jupiter.api.Test;
  */
 public class XYBoxAnnotationTest {
 
+    @Test
+    public void testConstructorExceptions() {
+        Stroke stroke = new BasicStroke(2.0f);
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYBoxAnnotation a1 = new XYBoxAnnotation(Double.NaN, 20.0, 100.0, 200.0,
+                stroke, Color.BLUE, Color.RED);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYBoxAnnotation a1 = new XYBoxAnnotation(10.0, Double.NaN, 100.0, 200.0,
+                stroke, Color.BLUE, Color.RED);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYBoxAnnotation a1 = new XYBoxAnnotation(10.0, 20.0, Double.NaN, 200.0,
+                stroke, Color.BLUE, Color.RED);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYBoxAnnotation a1 = new XYBoxAnnotation(10.0, 20.0, 100.0, Double.NaN,
+                stroke, Color.BLUE, Color.RED);
+        });
+    }
+
     /**
      * Confirm that the equals method can distinguish all the required fields.
      */
diff --git a/src/test/java/org/jfree/chart/annotations/XYLineAnnotationTest.java b/src/test/java/org/jfree/chart/annotations/XYLineAnnotationTest.java
index 5b736e8f..2e6db860 100644
--- a/src/test/java/org/jfree/chart/annotations/XYLineAnnotationTest.java
+++ b/src/test/java/org/jfree/chart/annotations/XYLineAnnotationTest.java
@@ -39,6 +39,7 @@ package org.jfree.chart.annotations;
 import static org.junit.jupiter.api.Assertions.assertEquals;
 import static org.junit.jupiter.api.Assertions.assertTrue;
 import static org.junit.jupiter.api.Assertions.assertFalse;
+import static org.junit.jupiter.api.Assertions.assertThrows;
 
 import java.awt.BasicStroke;
 import java.awt.Color;
@@ -55,6 +56,50 @@ import org.junit.jupiter.api.Test;
  */
 public class XYLineAnnotationTest {
 
+    private static final double EPSILON = 0.000000001;
+
+    @Test
+    public void testConstructor() {
+        Stroke stroke = new BasicStroke(2.0f);
+        XYLineAnnotation a1 = new XYLineAnnotation(10.0, 20.0, 100.0, 200.0,
+                stroke, Color.BLUE);
+        assertEquals(10.0, a1.getX1(), EPSILON);
+        assertEquals(20.0, a1.getY1(), EPSILON);
+        assertEquals(100.0, a1.getX2(), EPSILON);
+        assertEquals(200.0, a1.getY2(), EPSILON);
+        assertEquals(stroke, a1.getStroke());
+        assertEquals(Color.BLUE, a1.getPaint());
+    }
+    
+    @Test
+    public void testConstructorExceptions() {
+        Stroke stroke = new BasicStroke(2.0f);
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(Double.NaN, 20.0, 100.0, 200.0,
+                stroke, Color.BLUE);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(10.0, Double.NaN, 100.0, 200.0,
+                stroke, Color.BLUE);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(10.0, 20.0, Double.NaN, 200.0,
+                stroke, Color.BLUE);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(10.0, 20.0, 100.0, Double.NaN,
+                stroke, Color.BLUE);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(10.0, 20.0, 100.0, 200.0,
+                null, Color.BLUE);
+        });
+        assertThrows(IllegalArgumentException.class, () -> {
+            XYLineAnnotation a1 = new XYLineAnnotation(10.0, 20.0, 100.0, 200.0,
+                stroke, null);
+        });
+    }
+    
     /**
      * Confirm that the equals method can distinguish all the required fields.
      */
diff --git a/src/test/java/org/jfree/chart/internal/LineUtilsTest.java b/src/test/java/org/jfree/chart/internal/LineUtilsTest.java
index 0fdedfec..ac136548 100644
--- a/src/test/java/org/jfree/chart/internal/LineUtilsTest.java
+++ b/src/test/java/org/jfree/chart/internal/LineUtilsTest.java
@@ -115,4 +115,27 @@ public class LineUtilsTest {
         assertTrue(lineEquals(line, 1.5, 1.5, 2.0, 1.25));
     }
 
+    /**
+     * Tests that a line with Double.NaN coordinates is handled gracefully in 
+     * the clipLine() method (added in response to bug#223).
+     */
+    @Test
+    public void testClipLineWithNaN() {
+        Rectangle2D rect = new Rectangle2D.Double(1.0, 1.0, 1.0, 1.0);
+        Line2D line = new Line2D.Double(Double.NaN, 2, 3, 4);
+        assertFalse(LineUtils.clipLine(line, rect));
+        assertTrue(lineEquals(line, Double.NaN, 2, 3, 4));
+
+        line = new Line2D.Double(1, Double.NaN, 3, 4);
+        assertFalse(LineUtils.clipLine(line, rect));
+        assertTrue(lineEquals(line, 1, Double.NaN, 3, 4));
+
+        line = new Line2D.Double(1, 2, Double.NaN, 4);
+        assertFalse(LineUtils.clipLine(line, rect));
+        assertTrue(lineEquals(line, 1, 2, Double.NaN, 4));
+
+        line = new Line2D.Double(1, 2, 3, Double.NaN);
+        assertFalse(LineUtils.clipLine(line, rect));
+        assertTrue(lineEquals(line, 1, 2, 3, Double.NaN));
+    }
 }
