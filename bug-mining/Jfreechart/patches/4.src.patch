diff --git a/src/main/java/org/jfree/chart/plot/ContourPlot.java b/src/main/java/org/jfree/chart/plot/ContourPlot.java
index 18b8fda1..7354b69f 100644
--- a/src/main/java/org/jfree/chart/plot/ContourPlot.java
+++ b/src/main/java/org/jfree/chart/plot/ContourPlot.java
@@ -955,18 +955,18 @@ public class ContourPlot extends Plot implements ContourValuePlot,
             if (plot.isDomainCrosshairLockedOnData()) {
                 if (plot.isRangeCrosshairLockedOnData()) {
                     // both axes
-                    crosshairState.updateCrosshairPoint(x[k], y[k], transX,
+                    crosshairState.updateCrosshairPoint(x[k], y[k], 0, transX,
                             transY, PlotOrientation.VERTICAL);
                 }
                 else {
                     // just the horizontal axis...
-                    crosshairState.updateCrosshairX(transX);
+                    crosshairState.updateCrosshairX(x[k], transX, 0);
                 }
             }
             else {
                 if (plot.isRangeCrosshairLockedOnData()) {
                     // just the vertical axis...
-                    crosshairState.updateCrosshairY(transY);
+                    crosshairState.updateCrosshairY(y[k], transY, 0);
                 }
             }
         }
@@ -1080,23 +1080,22 @@ public class ContourPlot extends Plot implements ContourValuePlot,
             if (plot.isDomainCrosshairLockedOnData()) {
                 if (plot.isRangeCrosshairLockedOnData()) {
                     // both axes
-                    crosshairState.updateCrosshairPoint(x[k], y[k], transX,
+                    crosshairState.updateCrosshairPoint(x[k], y[k], 0, transX,
                             transY, PlotOrientation.VERTICAL);
                 }
                 else {
                     // just the horizontal axis...
-                    crosshairState.updateCrosshairX(transX);
+                    crosshairState.updateCrosshairX(x[k], transX, 0);
                 }
             }
             else {
                 if (plot.isRangeCrosshairLockedOnData()) {
                     // just the vertical axis...
-                    crosshairState.updateCrosshairY(transY);
+                    crosshairState.updateCrosshairY(y[k], transY, 0);
                 }
             }
         }
 
-
         g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, antiAlias);
 
     }
diff --git a/src/main/java/org/jfree/chart/plot/CrosshairState.java b/src/main/java/org/jfree/chart/plot/CrosshairState.java
index 7b75c8f6..0d95a114 100644
--- a/src/main/java/org/jfree/chart/plot/CrosshairState.java
+++ b/src/main/java/org/jfree/chart/plot/CrosshairState.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -------------------
  * CrosshairState.java
  * -------------------
- * (C) Copyright 2002-2008, by Object Refinery Limited.
+ * (C) Copyright 2002-2017, by Object Refinery Limited.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   -;
@@ -46,6 +46,8 @@
  *               1565168 (DG);
  * 06-Feb-2007 : Added new fields and methods to fix bug 1086307 (DG);
  * 26-Jun-2008 : Now tracks dataset index (DG);
+ * 18-Feb-2017 : Fix for crosshairs with multiple datasets / axes - see 
+ *               bug #36 (DG);
  *
  */
 
@@ -89,22 +91,6 @@ public class CrosshairState {
      */
     private int datasetIndex;
 
-    /**
-     * The index of the domain axis that the crosshair x-value is measured
-     * against.
-     *
-     * @since 1.0.4
-     */
-    private int domainAxisIndex;
-
-    /**
-     * The index of the range axis that the crosshair y-value is measured
-     * against.
-     *
-     * @since 1.0.4
-     */
-    private int rangeAxisIndex;
-
     /**
      * The smallest distance (so far) between the anchor point and a data
      * point.
@@ -120,7 +106,10 @@ public class CrosshairState {
     }
 
     /**
-     * Creates a new {@code crosshairState} instance.
+     * Creates a new {@code crosshairState} instance.  Determination of the
+     * data point nearest the anchor point can be calculated in either
+     * dataspace or Java2D space.  The former should only be used for charts
+     * with a single set of axes.
      *
      * @param calculateDistanceInDataSpace  a flag that controls whether the
      *                                      distance is calculated in data
@@ -156,63 +145,22 @@ public class CrosshairState {
     public void setCrosshairDistance(double distance) {
         this.distance = distance;
     }
-
+    
     /**
-     * Evaluates a data point and if it is the closest to the anchor point it
-     * becomes the new crosshair point.
-     * <P>
-     * To understand this method, you need to know the context in which it will
-     * be called.  An instance of this class is passed to an
-     * {@link org.jfree.chart.renderer.xy.XYItemRenderer} as
-     * each data point is plotted.  As the point is plotted, it is passed to
-     * this method to see if it should be the new crosshair point.
-     *
-     * @param x  x coordinate (measured against the domain axis).
-     * @param y  y coordinate (measured against the range axis).
-     * @param transX  x translated into Java2D space.
-     * @param transY  y translated into Java2D space.
-     * @param orientation  the plot orientation.
-     *
-     * @deprecated Use {@link #updateCrosshairPoint(double, double, int, int,
-     *     double, double, PlotOrientation)}.  See bug report 1086307.
-     */
-    public void updateCrosshairPoint(double x, double y,
-                                     double transX, double transY,
-                                     PlotOrientation orientation) {
-        updateCrosshairPoint(x, y, 0, 0, transX, transY, orientation);
-    }
-
-    /**
-     * Evaluates a data point and if it is the closest to the anchor point it
-     * becomes the new crosshair point.
-     * <P>
-     * To understand this method, you need to know the context in which it will
-     * be called.  An instance of this class is passed to an
-     * {@link org.jfree.chart.renderer.xy.XYItemRenderer} as
-     * each data point is plotted.  As the point is plotted, it is passed to
-     * this method to see if it should be the new crosshair point.
-     *
-     * @param x  x coordinate (measured against the domain axis).
-     * @param y  y coordinate (measured against the range axis).
-     * @param domainAxisIndex  the index of the domain axis for this point.
-     * @param rangeAxisIndex  the index of the range axis for this point.
-     * @param transX  x translated into Java2D space.
-     * @param transY  y translated into Java2D space.
-     * @param orientation  the plot orientation.
-     *
-     * @since 1.0.4
+     *
+     * @since 1.0.20
      */
-    public void updateCrosshairPoint(double x, double y, int domainAxisIndex,
-            int rangeAxisIndex, double transX, double transY,
-            PlotOrientation orientation) {
+    public void updateCrosshairPoint(double x, double y, int datasetIndex,
+            double transX, double transY, PlotOrientation orientation) {
 
         if (this.anchor != null) {
             double d = 0.0;
-            if (this.calculateDistanceInDataSpace) {
+            if (this.calculateDistanceInDataSpace) { 
                 d = (x - this.anchorX) * (x - this.anchorX)
                   + (y - this.anchorY) * (y - this.anchorY);
             }
             else {
+                // anchor point is in Java2D coordinates
                 double xx = this.anchor.getX();
                 double yy = this.anchor.getY();
                 if (orientation == PlotOrientation.HORIZONTAL) {
@@ -227,67 +175,31 @@ public class CrosshairState {
             if (d < this.distance) {
                 this.crosshairX = x;
                 this.crosshairY = y;
-                this.domainAxisIndex = domainAxisIndex;
-                this.rangeAxisIndex = rangeAxisIndex;
+                this.datasetIndex = datasetIndex;
                 this.distance = d;
             }
         }
 
     }
-
-    /**
-     * Evaluates an x-value and if it is the closest to the anchor x-value it
-     * becomes the new crosshair value.
-     * <P>
-     * Used in cases where only the x-axis is numerical.
-     *
-     * @param candidateX  x position of the candidate for the new crosshair
-     *                    point.
-     *
-     * @deprecated Use {@link #updateCrosshairX(double, int)}.  See bug report
-     *     1086307.
-     */
-    public void updateCrosshairX(double candidateX) {
-        updateCrosshairX(candidateX, 0);
-    }
-
+    
     /**
-     * Evaluates an x-value and if it is the closest to the anchor x-value it
-     * becomes the new crosshair value.
-     * <P>
-     * Used in cases where only the x-axis is numerical.
-     *
-     * @param candidateX  x position of the candidate for the new crosshair
-     *                    point.
-     * @param domainAxisIndex  the index of the domain axis for this x-value.
-     *
-     * @since 1.0.4
+     * 
+     * @param x
+     * @param transX
+     * @param datasetIndex 
+     * 
+     * @since 1.0.20
      */
-    public void updateCrosshairX(double candidateX, int domainAxisIndex) {
-
-        double d = Math.abs(candidateX - this.anchorX);
+    public void updateCrosshairX(double x, double transX, int datasetIndex) {
+        if (this.anchor == null) {
+            return;
+        }
+        double d = Math.abs(transX - this.anchor.getX());
         if (d < this.distance) {
-            this.crosshairX = candidateX;
-            this.domainAxisIndex = domainAxisIndex;
+            this.crosshairX = x;
+            this.datasetIndex = datasetIndex;
             this.distance = d;
-        }
-
-    }
-
-    /**
-     * Evaluates a y-value and if it is the closest to the anchor y-value it
-     * becomes the new crosshair value.
-     * <P>
-     * Used in cases where only the y-axis is numerical.
-     *
-     * @param candidateY  y position of the candidate for the new crosshair
-     *                    point.
-     *
-     * @deprecated Use {@link #updateCrosshairY(double, int)}.  See bug report
-     *     1086307.
-     */
-    public void updateCrosshairY(double candidateY) {
-        updateCrosshairY(candidateY, 0);
+        }        
     }
 
     /**
@@ -300,13 +212,16 @@ public class CrosshairState {
      *                    point.
      * @param rangeAxisIndex  the index of the range axis for this y-value.
      *
-     * @since 1.0.4
+     * @since 1.0.20
      */
-    public void updateCrosshairY(double candidateY, int rangeAxisIndex) {
-        double d = Math.abs(candidateY - this.anchorY);
+    public void updateCrosshairY(double candidateY, double transY, int datasetIndex) {
+        if (this.anchor == null) {
+            return;
+        }
+        double d = Math.abs(transY - this.anchor.getY());
         if (d < this.distance) {
             this.crosshairY = candidateY;
-            this.rangeAxisIndex = rangeAxisIndex;
+            this.datasetIndex = datasetIndex;
             this.distance = d;
         }
 
@@ -469,33 +384,4 @@ public class CrosshairState {
     public void setDatasetIndex(int index) {
         this.datasetIndex = index;
     }
-
-    /**
-     * Returns the domain axis index for the crosshair x-value.
-     *
-     * @return The domain axis index.
-     *
-     * @since 1.0.4
-     *
-     * @deprecated As of version 1.0.11, the domain axis should be determined
-     *     using the dataset index.
-     */
-    public int getDomainAxisIndex() {
-        return this.domainAxisIndex;
-    }
-
-    /**
-     * Returns the range axis index for the crosshair y-value.
-     *
-     * @return The range axis index.
-     *
-     * @since 1.0.4
-     *
-     * @deprecated As of version 1.0.11, the domain axis should be determined
-     *     using the dataset index.
-     */
-    public int getRangeAxisIndex() {
-        return this.rangeAxisIndex;
-    }
-
 }
diff --git a/src/main/java/org/jfree/chart/renderer/xy/AbstractXYItemRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/AbstractXYItemRenderer.java
index a4b0abd1..1988aed1 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/AbstractXYItemRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/AbstractXYItemRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ---------------------------
  * AbstractXYItemRenderer.java
  * ---------------------------
- * (C) Copyright 2002-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2002-2017, by Object Refinery Limited and Contributors.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Richard Atkinson;
@@ -123,7 +123,8 @@
  * 07-Apr-2014 : Don't use ObjectList anymore (DG);
  * 29-Jul-2014 : Add rendering hint to normalise domain and range lines (DG);
  * 24-Aug-2014 : Add beginElementGroup() method, part of JFreeSVG support (DG);
- *
+ * 18-Feb-2017 : Fix for crosshairs with multiple datasets / axes - see 
+ *               bug #36 (DG);
  */
 
 package org.jfree.chart.renderer.xy;
@@ -1645,17 +1646,16 @@ public abstract class AbstractXYItemRenderer extends AbstractRenderer
      *                        but the method does nothing in that case).
      * @param x  the x-value (in data space).
      * @param y  the y-value (in data space).
-     * @param domainAxisIndex  the index of the domain axis for the point.
-     * @param rangeAxisIndex  the index of the range axis for the point.
+     * @param datasetIndex  the index of the dataset for the point.
      * @param transX  the x-value translated to Java2D space.
      * @param transY  the y-value translated to Java2D space.
      * @param orientation  the plot orientation ({@code null} not
      *                     permitted).
      *
-     * @since 1.0.4
+     * @since 1.0.20
      */
     protected void updateCrosshairValues(CrosshairState crosshairState,
-            double x, double y, int domainAxisIndex, int rangeAxisIndex,
+            double x, double y, int datasetIndex,
             double transX, double transY, PlotOrientation orientation) {
 
         ParamChecks.nullNotPermitted(orientation, "orientation");
@@ -1664,18 +1664,18 @@ public abstract class AbstractXYItemRenderer extends AbstractRenderer
             if (this.plot.isDomainCrosshairLockedOnData()) {
                 if (this.plot.isRangeCrosshairLockedOnData()) {
                     // both axes
-                    crosshairState.updateCrosshairPoint(x, y, domainAxisIndex,
-                            rangeAxisIndex, transX, transY, orientation);
+                    crosshairState.updateCrosshairPoint(x, y, datasetIndex,
+                            transX, transY, orientation);
                 }
                 else {
                     // just the domain axis...
-                    crosshairState.updateCrosshairX(x, domainAxisIndex);
+                    crosshairState.updateCrosshairX(x, transX, datasetIndex);
                 }
             }
             else {
                 if (this.plot.isRangeCrosshairLockedOnData()) {
                     // just the range axis...
-                    crosshairState.updateCrosshairY(y, rangeAxisIndex);
+                    crosshairState.updateCrosshairY(y, transY, datasetIndex);
                 }
             }
         }
@@ -1944,30 +1944,29 @@ public abstract class AbstractXYItemRenderer extends AbstractRenderer
         fireChangeEvent();
     }
 
-    /**
-     * Considers the current (x, y) coordinate and updates the crosshair point
-     * if it meets the criteria (usually means the (x, y) coordinate is the
-     * closest to the anchor point so far).
-     *
-     * @param crosshairState  the crosshair state ({@code null} permitted,
-     *                        but the method does nothing in that case).
-     * @param x  the x-value (in data space).
-     * @param y  the y-value (in data space).
-     * @param transX  the x-value translated to Java2D space.
-     * @param transY  the y-value translated to Java2D space.
-     * @param orientation  the plot orientation ({@code null} not
-     *                     permitted).
-     *
-     * @deprecated Use {@link #updateCrosshairValues(CrosshairState, double,
-     *         double, int, int, double, double, PlotOrientation)} -- see bug
-     *         report 1086307.
-     */
-    protected void updateCrosshairValues(CrosshairState crosshairState,
-            double x, double y, double transX, double transY,
-            PlotOrientation orientation) {
-        updateCrosshairValues(crosshairState, x, y, 0, 0, transX, transY,
-                orientation);
-    }
-
+//    /**
+//     * Considers the current (x, y) coordinate and updates the crosshair point
+//     * if it meets the criteria (usually means the (x, y) coordinate is the
+//     * closest to the anchor point so far).
+//     *
+//     * @param crosshairState  the crosshair state ({@code null} permitted,
+//     *                        but the method does nothing in that case).
+//     * @param x  the x-value (in data space).
+//     * @param y  the y-value (in data space).
+//     * @param transX  the x-value translated to Java2D space.
+//     * @param transY  the y-value translated to Java2D space.
+//     * @param orientation  the plot orientation ({@code null} not
+//     *                     permitted).
+//     *
+//     * @deprecated Use {@link #updateCrosshairValues(CrosshairState, double,
+//     *         double, int, int, double, double, PlotOrientation)} -- see bug
+//     *         report 1086307.
+//     */
+//    protected void updateCrosshairValues(CrosshairState crosshairState,
+//            double x, double y, double transX, double transY,
+//            PlotOrientation orientation) {
+//        updateCrosshairValues(crosshairState, x, y, 0, transX, transY,
+//                orientation);
+//    }
 
 }
diff --git a/src/main/java/org/jfree/chart/renderer/xy/StackedXYAreaRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/StackedXYAreaRenderer.java
index d50dedef..d98b56b8 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/StackedXYAreaRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/StackedXYAreaRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * --------------------------
  * StackedXYAreaRenderer.java
  * --------------------------
- * (C) Copyright 2003-2016, by Richard Atkinson and Contributors.
+ * (C) Copyright 2003-2017, by Richard Atkinson and Contributors.
  *
  * Original Author:  Richard Atkinson;
  * Contributor(s):   Christian W. Zuckschwerdt;
@@ -65,6 +65,7 @@
  *               methods (DG);
  * 20-Apr-2007 : Updated getLegendItem() for renderer change (DG);
  * 04-Aug-2014 : Fix entity hotspot (patch #312) (UV);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -533,10 +534,9 @@ public class StackedXYAreaRenderer extends XYAreaRenderer
                 }
             }
 
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x1, ph1 + y1, domainAxisIndex,
-                    rangeAxisIndex, transX1, transY1, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x1, ph1 + y1, datasetIndex,
+                    transX1, transY1, orientation);
 
         }
         else if (pass == 1) {
diff --git a/src/main/java/org/jfree/chart/renderer/xy/StandardXYItemRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/StandardXYItemRenderer.java
index 3f27961f..7f67ac47 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/StandardXYItemRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/StandardXYItemRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ---------------------------
  * StandardXYItemRenderer.java
  * ---------------------------
- * (C) Copyright 2001-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2001-2017, by Object Refinery Limited and Contributors.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Mark Watson (www.markwatson.com);
@@ -105,6 +105,7 @@
  * 02-Jun-2008 : Fixed tooltips for data items at lower edges of data area (DG);
  * 17-Jun-2008 : Apply legend shape, font and paint attributes (DG);
  * 03-Jul-2013 : Use ParamChecks (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -979,10 +980,9 @@ public class StandardXYItemRenderer extends AbstractXYItemRenderer
                     (y1 < 0.0));
         }
 
-        int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-        int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-        updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                rangeAxisIndex, transX1, transY1, orientation);
+        int datasetIndex = plot.indexOf(dataset);
+        updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                transX1, transY1, orientation);
 
         // add an entity for the item...
         if (entities != null && isPointInRect(dataArea, xx, yy)) {
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer.java
index a339e914..05d918dd 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -------------------
  * XYAreaRenderer.java
  * -------------------
- * (C) Copyright 2002-2016, by Hari and Contributors.
+ * (C) Copyright 2002-2017, by Hari and Contributors.
  *
  * Original Author:  Hari (ourhari@hotmail.com);
  * Contributor(s):   David Gilbert (for Object Refinery Limited);
@@ -82,6 +82,8 @@
  * 06-Oct-2011 : Avoid GeneralPath methods requiring Java 1.5 (MK);
  * 03-Jul-2013 : Use ParamChecks (DG);
  * 04-Aug-2014 : Restrict entity hotspot to plot area (patch #312) (UV);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
+ *
  */
 
 package org.jfree.chart.renderer.xy;
@@ -643,10 +645,9 @@ public class XYAreaRenderer extends AbstractXYItemRenderer
             }
         }
 
-        int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-        int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-        updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                rangeAxisIndex, transX1, transY1, orientation);
+        int datasetIndex = plot.indexOf(dataset);
+        updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                transX1, transY1, orientation);
 
         // collect entity and tool tip information...
         EntityCollection entities = state.getEntityCollection();
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer2.java b/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer2.java
index ba8fe4c4..d6ec054c 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer2.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYAreaRenderer2.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * --------------------
  * XYAreaRenderer2.java
  * --------------------
- * (C) Copyright 2004-2016, by Hari and Contributors.
+ * (C) Copyright 2004-2017, by Hari and Contributors.
  *
  * Original Author:  Hari (ourhari@hotmail.com);
  * Contributor(s):   David Gilbert (for Object Refinery Limited);
@@ -80,6 +80,7 @@
  * 06-Oct-2011 : Avoid GeneralPath methods requiring Java 1.5 (MK);
  * 03-Jul-2013 : Use ParamChecks (DG);
  * 04-Aug-2014 : Restrict entity hotspot to plot area (patch #312) (UV);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -380,10 +381,9 @@ public class XYAreaRenderer2 extends AbstractXYItemRenderer
             g2.setPaint(lookupSeriesOutlinePaint(series));
             g2.draw(hotspot);
         }
-        int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-        int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-        updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                rangeAxisIndex, transX1, transY1, orientation);
+        int datasetIndex = plot.indexOf(dataset);
+        updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                transX1, transY1, orientation);
 
         // collect entity and tool tip information...
         if (state.getInfo() != null) {
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYBarRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYBarRenderer.java
index bf7dcc3f..32efb687 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYBarRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYBarRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ------------------
  * XYBarRenderer.java
  * ------------------
- * (C) Copyright 2001-2016, by Object Refinery Limited.
+ * (C) Copyright 2001-2017, by Object Refinery Limited.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Richard Atkinson;
@@ -100,6 +100,7 @@
  *               non-visible series (DG);
  * 03-Jul-2013 : Use ParamChecks (DG);
  * 24-Aug-2014 : Add begin/endElementGroup() (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -938,10 +939,9 @@ public class XYBarRenderer extends AbstractXYItemRenderer
         double transX1 = domainAxis.valueToJava2D(x1, dataArea, location);
         double transY1 = rangeAxis.valueToJava2D(y1, dataArea,
                 plot.getRangeAxisEdge());
-        int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-        int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-        updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                rangeAxisIndex, transX1, transY1, plot.getOrientation());
+        int datasetIndex = plot.indexOf(dataset);
+        updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                transX1, transY1, plot.getOrientation());
 
         EntityCollection entities = state.getEntityCollection();
         if (entities != null) {
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYBubbleRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYBubbleRenderer.java
index 7b4badc3..697438eb 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYBubbleRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYBubbleRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ---------------------
  * XYBubbleRenderer.java
  * ---------------------
- * (C) Copyright 2003-2016, by Object Refinery Limited.
+ * (C) Copyright 2003-2017, by Object Refinery Limited.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Christian W. Zuckschwerdt;
@@ -58,6 +58,7 @@
  * 18-May-2007 : Set dataset and seriesKey for LegendItem (DG);
  * 13-Jun-2007 : Fixed seriesVisibility bug (DG);
  * 17-Jun-2008 : Apply legend shape, font and paint attributes (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -268,10 +269,9 @@ public class XYBubbleRenderer extends AbstractXYItemRenderer
                 }
             }
 
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x, y, domainAxisIndex,
-                    rangeAxisIndex, transX, transY, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x, y, datasetIndex,
+                    transX, transY, orientation);
         }
 
     }
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYDifferenceRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYDifferenceRenderer.java
index acabd3aa..6eb5d1fb 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYDifferenceRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYDifferenceRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -------------------------
  * XYDifferenceRenderer.java
  * -------------------------
- * (C) Copyright 2003-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2003-2017, by Object Refinery Limited and Contributors.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Richard West, Advanced Micro Devices, Inc. (major rewrite
@@ -77,6 +77,7 @@
  * 13-Feb-2012 : Applied patch 3450234 for bug 3425881 by Patrick Schlott and
  *               Christoph Schroeder (MH);
  * 03-Jul-2013 : Use ParamChecks (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -935,10 +936,9 @@ public class XYDifferenceRenderer extends AbstractXYItemRenderer
                           x_item, l_x1, l_y1, (l_y1 < 0.0));
         }
 
-        int l_domainAxisIndex = x_plot.getDomainAxisIndex(x_domainAxis);
-        int l_rangeAxisIndex  = x_plot.getRangeAxisIndex(x_rangeAxis);
-        updateCrosshairValues(x_crosshairState, l_x0, l_y0, l_domainAxisIndex,
-                              l_rangeAxisIndex, l_x1, l_y1, l_orientation);
+        int datasetIndex = x_plot.indexOf(x_dataset);
+        updateCrosshairValues(x_crosshairState, l_x0, l_y0, datasetIndex,
+                              l_x1, l_y1, l_orientation);
 
         if (0 == x_item) {
             return;
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYDotRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYDotRenderer.java
index 3e3a8ab8..23b3e170 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYDotRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYDotRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ------------------
  * XYDotRenderer.java
  * ------------------
- * (C) Copyright 2002-2016, by Object Refinery Limited.
+ * (C) Copyright 2002-2017, by Object Refinery Limited.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   Christian W. Zuckschwerdt;
@@ -49,6 +49,7 @@
  *               getLegendItem() (DG);
  * 17-Jun-2008 : Apply legend shape, font and paint attributes (DG);
  * 03-Jul-2013 : Use ParamChecks (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -258,10 +259,9 @@ public class XYDotRenderer extends AbstractXYItemRenderer
                         this.dotHeight);
             }
 
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x, y, domainAxisIndex,
-                    rangeAxisIndex, transX, transY, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x, y, datasetIndex,
+                    transX, transY, orientation);
         }
 
     }
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYLineAndShapeRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYLineAndShapeRenderer.java
index ff55f9a0..211995fa 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYLineAndShapeRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYLineAndShapeRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * ---------------------------
  * XYLineAndShapeRenderer.java
  * ---------------------------
- * (C) Copyright 2004-2016, by Object Refinery Limited.
+ * (C) Copyright 2004-2017, by Object Refinery Limited.
  *
  * Original Author:  David Gilbert (for Object Refinery Limited);
  * Contributor(s):   -;
@@ -67,6 +67,7 @@
  * 18-May-2009 : Clip lines in drawPrimaryLine() (DG);
  * 05-Jul-2012 : Removed JDK 1.3.1 code (DG);
  * 02-Jul-2013 : Use ParamChecks (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -1176,10 +1177,9 @@ public class XYLineAndShapeRenderer extends AbstractXYItemRenderer
                     (y1 < 0.0));
         }
 
-        int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-        int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-        updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                rangeAxisIndex, transX1, transY1, orientation);
+        int datasetIndex = plot.indexOf(dataset);
+        updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                transX1, transY1, orientation);
 
         // add an entity for the item, but only if it falls within the data
         // area...
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYShapeRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYShapeRenderer.java
index 0e62662e..8b0cbd9d 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYShapeRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYShapeRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2015, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * --------------------
  * XYShapeRenderer.java
  * --------------------
- * (C) Copyright 2008-2015 by Andreas Haumer, xS+S and Contributors.
+ * (C) Copyright 2008-2017 by Andreas Haumer, xS+S and Contributors.
  *
  * Original Author:  Martin Hoeller (x Software + Systeme  xS+S - Andreas
  *                       Haumer);
@@ -41,6 +41,7 @@
  * 19-Oct-2011 : Fixed NPE in findRangeBounds() (bug 3026341) (DG);
  * 03-Jul-2013 : Use ParamChecks (DG);
  * 09-Sep-2015 : Add update for crosshair (DG);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -490,10 +491,9 @@ public class XYShapeRenderer extends AbstractXYItemRenderer
                 }
             }
             
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x, y, domainAxisIndex,
-                    rangeAxisIndex, transX, transY, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x, y, datasetIndex,
+                    transX, transY, orientation);
 
             // add an entity for the item...
             if (entities != null) {
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYStepAreaRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYStepAreaRenderer.java
index c7e31331..4bb093f7 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYStepAreaRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYStepAreaRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -----------------------
  * XYStepAreaRenderer.java
  * -----------------------
- * (C) Copyright 2003-2016, by Matthias Rose and Contributors.
+ * (C) Copyright 2003-2017, by Matthias Rose and Contributors.
  *
  * Original Author:  Matthias Rose (based on XYAreaRenderer.java);
  * Contributor(s):   David Gilbert (for Object Refinery Limited);
@@ -52,6 +52,7 @@
  * 14-May-2008 : Call addEntity() from within drawItem() (DG);
  * 19-May-2009 : Fixed FindBugs warnings, patch by Michal Wozniak (DG);
  * 05-Dec-2013 : Added setStepPoint() method (LR);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -557,10 +558,9 @@ public class XYStepAreaRenderer extends AbstractXYItemRenderer
 
         // do we need to update the crosshair values?
         if (!Double.isNaN(y1)) {
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                    rangeAxisIndex, transX1, transY1, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                    transX1, transY1, orientation);
         }
 
         // collect entity and tool tip information...
diff --git a/src/main/java/org/jfree/chart/renderer/xy/XYStepRenderer.java b/src/main/java/org/jfree/chart/renderer/xy/XYStepRenderer.java
index 287cae9d..b0afed0a 100644
--- a/src/main/java/org/jfree/chart/renderer/xy/XYStepRenderer.java
+++ b/src/main/java/org/jfree/chart/renderer/xy/XYStepRenderer.java
@@ -2,7 +2,7 @@
  * JFreeChart : a free chart library for the Java(tm) platform
  * ===========================================================
  *
- * (C) Copyright 2000-2016, by Object Refinery Limited and Contributors.
+ * (C) Copyright 2000-2017, by Object Refinery Limited and Contributors.
  *
  * Project Info:  http://www.jfree.org/jfreechart/index.html
  *
@@ -27,7 +27,7 @@
  * -------------------
  * XYStepRenderer.java
  * -------------------
- * (C) Copyright 2002-2016, by Roger Studner and Contributors.
+ * (C) Copyright 2002-2017, by Roger Studner and Contributors.
  *
  * Original Author:  Roger Studner;
  * Contributor(s):   David Gilbert (for Object Refinery Limited);
@@ -67,6 +67,7 @@
  * 24-Sep-2008 : Fixed bug 2113627 by utilising second pass to draw item
  *               labels (DG);
  * 29-Feb-2016 : Improved performance by only drawing visible lines (MN);
+ * 18-Feb-2017 : Updates for crosshairs (bug #36) (DG);
  *
  */
 
@@ -272,10 +273,9 @@ public class XYStepRenderer extends XYLineAndShapeRenderer
             }
 
             // submit this data item as a candidate for the crosshair point
-            int domainAxisIndex = plot.getDomainAxisIndex(domainAxis);
-            int rangeAxisIndex = plot.getRangeAxisIndex(rangeAxis);
-            updateCrosshairValues(crosshairState, x1, y1, domainAxisIndex,
-                    rangeAxisIndex, transX1, transY1, orientation);
+            int datasetIndex = plot.indexOf(dataset);
+            updateCrosshairValues(crosshairState, x1, y1, datasetIndex,
+                    transX1, transY1, orientation);
 
             // collect entity and tool tip information...
             EntityCollection entities = state.getEntityCollection();
