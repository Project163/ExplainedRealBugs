diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 608d2f055..857239812 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -22,6 +22,10 @@
   <body>
 
   <release version="4.1" date="TBD" description="">
+    <action issue="COLLECTIONS-525" dev="tn" type="fix" due-to="Zigler Zhang">
+      The map returned by "PatriciaTrie#prefixMap()" did not contain all keys
+      that are prefixed by the given search key in some rare cases.
+    </action>
     <action issue="COLLECTIONS-511" dev="tn" type="add" due-to="Nathan Blomquist, Brent Worden">
       Added new methods "CollectionUtils#partition(...)" to partition an input collection
       into separate output collections based on evaluation of one or more predicates.
diff --git a/src/main/java/org/apache/commons/collections4/trie/AbstractPatriciaTrie.java b/src/main/java/org/apache/commons/collections4/trie/AbstractPatriciaTrie.java
index b79b7d084..613eade59 100644
--- a/src/main/java/org/apache/commons/collections4/trie/AbstractPatriciaTrie.java
+++ b/src/main/java/org/apache/commons/collections4/trie/AbstractPatriciaTrie.java
@@ -1088,7 +1088,7 @@ abstract class AbstractPatriciaTrie<K, V> extends AbstractBitwiseTrie<K, V> {
         TrieEntry<K, V> current = root.left;
         TrieEntry<K, V> path = root;
         while(true) {
-            if (current.bitIndex <= path.bitIndex || lengthInBits < current.bitIndex) {
+            if (current.bitIndex <= path.bitIndex || lengthInBits <= current.bitIndex) {
                 break;
             }
 
@@ -1120,8 +1120,8 @@ abstract class AbstractPatriciaTrie<K, V> extends AbstractBitwiseTrie<K, V> {
 
         // Found key's length-th bit differs from our key
         // which means it cannot be the prefix...
-        if (isBitSet(prefix, endIndexInBits, endIndexInBits)
-                != isBitSet(entry.key, lengthInBits, lengthInBits(entry.key))) {
+        if (isBitSet(prefix, endIndexInBits - 1, endIndexInBits)
+                != isBitSet(entry.key, lengthInBits - 1, lengthInBits(entry.key))) {
             return null;
         }
 
@@ -2264,7 +2264,7 @@ abstract class AbstractPatriciaTrie<K, V> extends AbstractBitwiseTrie<K, V> {
             if (prefixStart == null) {
                 final Set<Map.Entry<K,V>> empty = Collections.emptySet();
                 return empty.iterator();
-            } else if (delegate.lengthInBits >= prefixStart.bitIndex) {
+            } else if (delegate.lengthInBits > prefixStart.bitIndex) {
                 return new SingletonIterator(prefixStart);
             } else {
                 return new EntryIterator(prefixStart, delegate.prefix, delegate.offsetInBits, delegate.lengthInBits);
diff --git a/src/test/java/org/apache/commons/collections4/trie/PatriciaTrieTest.java b/src/test/java/org/apache/commons/collections4/trie/PatriciaTrieTest.java
index 1cf483a46..def26b9bf 100755
--- a/src/test/java/org/apache/commons/collections4/trie/PatriciaTrieTest.java
+++ b/src/test/java/org/apache/commons/collections4/trie/PatriciaTrieTest.java
@@ -26,7 +26,6 @@ import junit.framework.Test;
 
 import org.apache.commons.collections4.BulkTest;
 import org.apache.commons.collections4.map.AbstractSortedMapTest;
-
 import org.junit.Assert;
 
 /**
@@ -326,6 +325,26 @@ public class PatriciaTrieTest<V> extends AbstractSortedMapTest<String, V> {
         Assert.assertFalse(iter.hasNext());
     }
 
+    public void testPrefixMapSizes() {
+        // COLLECTIONS-525
+        PatriciaTrie<String> aTree = new PatriciaTrie<String>();
+        aTree.put("点评", "测试");
+        aTree.put("书评", "测试");
+        assertTrue(aTree.prefixMap("点").containsKey("点评"));
+        assertEquals("测试", aTree.prefixMap("点").get("点评"));
+        assertFalse(aTree.prefixMap("点").isEmpty());
+        assertEquals(1, aTree.prefixMap("点").size());
+        assertEquals(1, aTree.prefixMap("点").keySet().size());
+        assertEquals(1, aTree.prefixMap("点").entrySet().size());
+        assertEquals(1, aTree.prefixMap("点评").values().size());
+
+        aTree.clear();
+        aTree.put("点评", "联盟");
+        aTree.put("点版", "定向");
+        assertEquals(2, aTree.prefixMap("点").keySet().size());
+        assertEquals(2, aTree.prefixMap("点").values().size());
+    }
+
     //-----------------------------------------------------------------------
 
     @Override
