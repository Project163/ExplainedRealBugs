diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-chromium].png
new file mode 100644
index 000000000..76d656060
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-firefox].png
new file mode 100644
index 000000000..c07eff4bc
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-webkit].png
new file mode 100644
index 000000000..f95a4457e
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-chromium].png
new file mode 100644
index 000000000..38ce18457
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-firefox].png
new file mode 100644
index 000000000..a243192a2
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-webkit].png
new file mode 100644
index 000000000..920a1dc5e
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-no-wrap[light_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-chromium].png
new file mode 100644
index 000000000..6775ffc89
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-firefox].png
new file mode 100644
index 000000000..9b4025f98
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-webkit].png
new file mode 100644
index 000000000..ad27927f8
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-chromium].png
new file mode 100644
index 000000000..dc3417bb2
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-firefox].png
new file mode 100644
index 000000000..aea1fca7c
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-webkit].png
new file mode 100644
index 000000000..703c782fc
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-long-single-word-string-wrap[light_theme-webkit].png differ
diff --git a/e2e_playwright/st_code.py b/e2e_playwright/st_code.py
index 40d58fa5c..a55b683b0 100644
--- a/e2e_playwright/st_code.py
+++ b/e2e_playwright/st_code.py
@@ -128,3 +128,8 @@ print(processed)
 
 st.code(long_code, width=400, wrap_lines=True)
 st.code(long_code, width="stretch")
+
+long_single_word_string = "askldfjlweklrjweifjlsdfliwjlierjilsildfjlslfij" * 3
+
+st.code(long_single_word_string)
+st.code(long_single_word_string, wrap_lines=True)
diff --git a/e2e_playwright/st_code_test.py b/e2e_playwright/st_code_test.py
index bda73e25e..d744a91f8 100644
--- a/e2e_playwright/st_code_test.py
+++ b/e2e_playwright/st_code_test.py
@@ -73,7 +73,7 @@ def test_code_blocks_render_correctly(
 ):
     """Test that the code blocks render as expected via screenshot matching."""
     code_blocks = themed_app.get_by_test_id("stCode")
-    expect(code_blocks).to_have_count(23)
+    expect(code_blocks).to_have_count(25)
     # The code blocks might require a bit more time for rendering, so wait until
     # the text is truly visible. Otherwise we might get blank code blocks in the
     # screenshots.
@@ -82,7 +82,7 @@ def test_code_blocks_render_correctly(
         f"()=>document.body.textContent.split('def foo()').length === {foo_func_count}"
     )
     # Check that there are 15 code blocks with the class "language-python"
-    expect(themed_app.locator("code.language-python")).to_have_count(21)
+    expect(themed_app.locator("code.language-python")).to_have_count(23)
 
     assert_snapshot(code_blocks.nth(0), name="st_code-auto_lang")
     assert_snapshot(code_blocks.nth(1), name="st_code-empty")
@@ -105,6 +105,17 @@ def test_code_blocks_render_correctly(
     assert_snapshot(code_blocks.nth(19), name="st_code-height-long-code")
     assert_snapshot(code_blocks.nth(20), name="st_code-height-short-code")
 
+    # Test long single word string
+    long_string = "askldfjlweklrjweifjlsdfliwjlierjilsildfjlslfij" * 3
+    code_blocks.nth(23).scroll_into_view_if_needed()
+    expect(themed_app.get_by_text(long_string)).to_have_count(2)
+    expect(themed_app.get_by_text(long_string).nth(0)).to_be_attached()
+    assert_snapshot(code_blocks.nth(23), name="st_code-long-single-word-string-no-wrap")
+
+    code_blocks.nth(24).scroll_into_view_if_needed()
+    expect(themed_app.get_by_text(long_string).nth(1)).to_be_attached()
+    assert_snapshot(code_blocks.nth(24), name="st_code-long-single-word-string-wrap")
+
 
 def test_correct_bottom_spacing_for_code_blocks(app: Page):
     """Test that the code blocks have the correct bottom spacing."""
diff --git a/frontend/lib/src/components/elements/CodeBlock/StreamlitSyntaxHighlighter.tsx b/frontend/lib/src/components/elements/CodeBlock/StreamlitSyntaxHighlighter.tsx
index ffacf7122..ec2144f32 100644
--- a/frontend/lib/src/components/elements/CodeBlock/StreamlitSyntaxHighlighter.tsx
+++ b/frontend/lib/src/components/elements/CodeBlock/StreamlitSyntaxHighlighter.tsx
@@ -77,7 +77,7 @@ function StreamlitSyntaxHighlighter({
 
   return (
     <StyledCodeBlock className="stCode" data-testid="stCode">
-      <StyledPre>
+      <StyledPre wrapLines={wrapLines ?? false}>
         <SyntaxHighlighter
           language={language}
           PreTag="div"
diff --git a/frontend/lib/src/components/elements/CodeBlock/styled-components.ts b/frontend/lib/src/components/elements/CodeBlock/styled-components.ts
index 3b4094dc8..1771bad5e 100644
--- a/frontend/lib/src/components/elements/CodeBlock/styled-components.ts
+++ b/frontend/lib/src/components/elements/CodeBlock/styled-components.ts
@@ -26,7 +26,7 @@ const codeLink: CSSObject = {
 
 export const StyledInlineCode = styled.code(({ theme }) => ({
   padding: "0.2em 0.4em",
-  wordWrap: "break-word",
+  overflowWrap: "break-word",
   whiteSpace: "pre-wrap",
   margin: 0,
   borderRadius: theme.radii.md,
@@ -39,7 +39,14 @@ export const StyledInlineCode = styled.code(({ theme }) => ({
   ...codeLink,
 }))
 
-const codeBlockStyle = (theme: Theme): CSSObject => ({
+type StyledCodeProps = {
+  wrapLines: boolean
+}
+
+const codeBlockStyle = (
+  theme: Theme,
+  wrapLines: StyledCodeProps["wrapLines"]
+): CSSObject => ({
   background: "transparent",
   border: 0,
   color: "inherit",
@@ -50,15 +57,16 @@ const codeBlockStyle = (theme: Theme): CSSObject => ({
   margin: 0,
   overflowX: "auto",
   padding: 0,
-  whiteSpace: "pre",
-  wordBreak: "normal",
-  wordWrap: "normal",
+  whiteSpace: wrapLines ? "pre-wrap" : "pre",
+  overflowWrap: wrapLines ? "break-word" : "normal",
   ...codeLink,
 })
 
-export const StyledCode = styled.code(({ theme }) => ({
-  ...codeBlockStyle(theme),
-}))
+export const StyledCode = styled.code<StyledCodeProps>(
+  ({ theme, wrapLines }) => ({
+    ...codeBlockStyle(theme, wrapLines),
+  })
+)
 
 /*
   This is the default prism.js theme for JavaScript, CSS and HTML, but
@@ -66,127 +74,129 @@ export const StyledCode = styled.code(({ theme }) => ({
 
   See https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript
 */
-export const StyledPre = styled.pre(({ theme }) => ({
-  height: "100%",
-  background: theme.colors.codeBackgroundColor,
-  borderRadius: theme.radii.default,
-  color: theme.colors.bodyText,
-  fontSize: theme.fontSizes.twoSm,
-  fontFamily: theme.genericFonts.codeFont,
-  display: "block",
-  // Remove browser default top margin
-  margin: 0,
-  // Disable auto-hiding scrollbar in legacy Edge to avoid overlap,
-  // making it impossible to interact with the content
-  msOverflowStyle: "scrollbar",
-
-  // Don't allow content to break outside
-  overflow: "auto",
-
-  // Add padding around the code
-  padding: theme.spacing.lg,
-  // Add padding to the right to account for the copy button
-  paddingRight: theme.iconSizes.threeXL,
-
-  code: { ...codeBlockStyle(theme) },
-
-  // The token can consist of many lines, e.g. a triple-quote string, so
-  // we need to make sure that the color is not overwritten.
-  ".comment.linenumber": {
-    color: theme.colors.fadedText40,
+export const StyledPre = styled.pre<StyledCodeProps>(
+  ({ theme, wrapLines }) => ({
+    height: "100%",
+    background: theme.colors.codeBackgroundColor,
+    borderRadius: theme.radii.default,
+    color: theme.colors.bodyText,
     fontSize: theme.fontSizes.twoSm,
+    fontFamily: theme.genericFonts.codeFont,
+    display: "block",
+    // Remove browser default top margin
+    margin: 0,
+    // Disable auto-hiding scrollbar in legacy Edge to avoid overlap,
+    // making it impossible to interact with the content
+    msOverflowStyle: "scrollbar",
+
+    // Don't allow content to break outside
+    overflow: "auto",
+
+    // Add padding around the code
+    padding: theme.spacing.lg,
+    // Add padding to the right to account for the copy button
+    paddingRight: theme.iconSizes.threeXL,
+
+    code: { ...codeBlockStyle(theme, wrapLines) },
+
+    // The token can consist of many lines, e.g. a triple-quote string, so
+    // we need to make sure that the color is not overwritten.
+    ".comment.linenumber": {
+      color: theme.colors.fadedText40,
+      fontSize: theme.fontSizes.twoSm,
+
+      // Center-align number vertically, or they'll be positioned differently when
+      // wrapLines=true. Even with this change, though, the position is still ~2px
+      // off.
+      // NOTE: The alignSelf below only apply applies when wrapLines=true, because
+      // that option wraps this element in a flex container.
+      alignSelf: "center",
+
+      // Override the default token's min-width, to ensure it fits 3-digit lines
+      minWidth: `${theme.spacing.threeXL} !important`,
+    },
 
-    // Center-align number vertically, or they'll be positioned differently when
-    // wrapLinst=true. Even with this change, though, the position is still ~2px
-    // off.
-    // NOTE: The alignSelf below only apply applies when wrapLines=true, because
-    // that option wraps this element in a flex container.
-    alignSelf: "center",
-
-    // Override the default token's min-width, to ensure it fits 3-digit lines
-    minWidth: `${theme.spacing.threeXL} !important`,
-  },
-
-  ".token.comment, .token.prolog, .token.doctype, .token.cdata": {
-    color: theme.colors.gray70,
-  },
+    ".token.comment, .token.prolog, .token.doctype, .token.cdata": {
+      color: theme.colors.gray70,
+    },
 
-  ".token.punctuation": {
-    color: theme.colors.gray70,
-  },
+    ".token.punctuation": {
+      color: theme.colors.gray70,
+    },
 
-  ".namespace": {
-    opacity: 0.7,
-  },
+    ".namespace": {
+      opacity: 0.7,
+    },
 
-  ".token.attr-name, .token.property, .token.variable": {
-    color: theme.colors.lightBlue80,
-  },
+    ".token.attr-name, .token.property, .token.variable": {
+      color: theme.colors.lightBlue80,
+    },
 
-  ".token.boolean, .token.constant, .token.symbol": {
-    color: theme.colors.green70,
-  },
+    ".token.boolean, .token.constant, .token.symbol": {
+      color: theme.colors.green70,
+    },
 
-  ".token.number, .token.regex": {
-    color: theme.colors.blueGreen80,
-  },
+    ".token.number, .token.regex": {
+      color: theme.colors.blueGreen80,
+    },
 
-  ".token.string, .token.char, .token.attr-value": {
-    color: theme.colors.green80,
-  },
+    ".token.string, .token.char, .token.attr-value": {
+      color: theme.colors.green80,
+    },
 
-  ".token.operator, .token.entity": {
-    color: theme.colors.orange90,
-  },
+    ".token.operator, .token.entity": {
+      color: theme.colors.orange90,
+    },
 
-  ".token.url": {
-    color: theme.colors.purple80,
-  },
+    ".token.url": {
+      color: theme.colors.purple80,
+    },
 
-  ".token.decorator, .token.atrule": {
-    color: theme.colors.orange90,
-  },
+    ".token.decorator, .token.atrule": {
+      color: theme.colors.orange90,
+    },
 
-  ".token.keyword, .token.tag": {
-    color: theme.colors.blue70,
-  },
+    ".token.keyword, .token.tag": {
+      color: theme.colors.blue70,
+    },
 
-  ".token.function, .token.class-name, .token.selector": {
-    color: theme.colors.blue70,
-    fontWeight: theme.fontWeights.extrabold,
-  },
+    ".token.function, .token.class-name, .token.selector": {
+      color: theme.colors.blue70,
+      fontWeight: theme.fontWeights.extrabold,
+    },
 
-  ".token.important": {
-    color: theme.colors.red70,
-    fontWeight: theme.fontWeights.extrabold,
-  },
+    ".token.important": {
+      color: theme.colors.red70,
+      fontWeight: theme.fontWeights.extrabold,
+    },
 
-  ".token.comment": {
-    color: theme.colors.gray70,
-    fontStyle: "italic",
-  },
+    ".token.comment": {
+      color: theme.colors.gray70,
+      fontStyle: "italic",
+    },
 
-  ".token.italic": {
-    fontStyle: "italic",
-  },
+    ".token.italic": {
+      fontStyle: "italic",
+    },
 
-  ".token.entity": {
-    cursor: "help",
-  },
+    ".token.entity": {
+      cursor: "help",
+    },
 
-  /**
-   * Diff syntax highlighting
-   */
-  ".token.deleted.line, .token.deleted.prefix": {
-    color: theme.colors.red70,
-  },
-  ".token.inserted.line, .token.inserted.prefix": {
-    color: theme.colors.green70,
-  },
-  ".token.unchanged.line": {
-    color: theme.colors.gray70,
-  },
-}))
+    /**
+     * Diff syntax highlighting
+     */
+    ".token.deleted.line, .token.deleted.prefix": {
+      color: theme.colors.red70,
+    },
+    ".token.inserted.line, .token.inserted.prefix": {
+      color: theme.colors.green70,
+    },
+    ".token.unchanged.line": {
+      color: theme.colors.gray70,
+    },
+  })
+)
 
 export const StyledCopyButtonContainer = styled.div(({ theme }) => ({
   opacity: 0,
diff --git a/frontend/lib/src/components/elements/ExceptionElement/ExceptionElement.tsx b/frontend/lib/src/components/elements/ExceptionElement/ExceptionElement.tsx
index 5c50984d6..3535e1275 100644
--- a/frontend/lib/src/components/elements/ExceptionElement/ExceptionElement.tsx
+++ b/frontend/lib/src/components/elements/ExceptionElement/ExceptionElement.tsx
@@ -94,7 +94,7 @@ function StackTrace({ stackTrace }: Readonly<StackTraceProps>): ReactElement {
       <StyledStackTraceTitle>Traceback:</StyledStackTraceTitle>
       <StyledStackTrace>
         <StyledStackTraceContent>
-          <StyledCode>
+          <StyledCode wrapLines={false}>
             {stackTrace.map((row: string, index: number) => (
               <StyledStackTraceRow
                 // TODO: Update to match React best practices
diff --git a/frontend/lib/src/components/shared/ErrorElement/ErrorElement.tsx b/frontend/lib/src/components/shared/ErrorElement/ErrorElement.tsx
index 388c9814c..1ca19e30a 100644
--- a/frontend/lib/src/components/shared/ErrorElement/ErrorElement.tsx
+++ b/frontend/lib/src/components/shared/ErrorElement/ErrorElement.tsx
@@ -49,7 +49,7 @@ function ErrorElement(props: ErrorElementProps): ReactElement {
       {message}
       {stack ? (
         <StyledStackTrace data-testid="stErrorElementStack">
-          <StyledCode>{cleanedStack}</StyledCode>
+          <StyledCode wrapLines={false}>{cleanedStack}</StyledCode>
         </StyledStackTrace>
       ) : null}
     </AlertContainer>
diff --git a/frontend/lib/src/components/shared/StreamlitMarkdown/__snapshots__/StreamlitMarkdown.test.tsx.snap b/frontend/lib/src/components/shared/StreamlitMarkdown/__snapshots__/StreamlitMarkdown.test.tsx.snap
index 7e899e72b..b28e3cae3 100644
--- a/frontend/lib/src/components/shared/StreamlitMarkdown/__snapshots__/StreamlitMarkdown.test.tsx.snap
+++ b/frontend/lib/src/components/shared/StreamlitMarkdown/__snapshots__/StreamlitMarkdown.test.tsx.snap
@@ -4,11 +4,11 @@ exports[`CustomCodeTag Element > should trim leading and final newlines 1`] = `
 <body>
   <div>
     <div
-      class="stCode css-p1ioam eptj1qr4"
+      class="stCode css-1ydllgh e1mha0dk4"
       data-testid="stCode"
     >
       <pre
-        class="css-ltpfi7 eptj1qr2"
+        class="css-14drx84 e1mha0dk2"
       >
         <div
           style="background-color: transparent;"
@@ -25,10 +25,10 @@ exports[`CustomCodeTag Element > should trim leading and final newlines 1`] = `
         </div>
       </pre>
       <div
-        class="css-chk1w8 eptj1qr3"
+        class="css-chk1w8 e1mha0dk3"
       >
         <button
-          class="css-rann4k eptj1qr5"
+          class="css-1ccyvjs e1mha0dk5"
           data-clipboard-text="      def hello():
           print("Hello, Streamlit!")"
           data-testid="stCodeCopyButton"
