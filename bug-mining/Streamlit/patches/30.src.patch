diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-chromium].png
index a3ff4c8dd..f37d0722f 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-chromium].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-firefox].png
index ece34d50d..fc43c202a 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-firefox].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-webkit].png
index a99028a83..79f2f1a0d 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-webkit].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-chromium].png
index fe228fafc..a8ec9ff65 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-chromium].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-firefox].png
index fcace7a33..f17a09ea2 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-firefox].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-webkit].png
index 3069900bc..118833a9a 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-webkit].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav[light_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[chromium].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[chromium].png
index b17f67e29..914dac504 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[chromium].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[firefox].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[firefox].png
index 4cc23c47d..62fc3753e 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[firefox].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[webkit].png b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[webkit].png
index d69c47c82..b96c68304 100644
Binary files a/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[webkit].png and b/e2e_playwright/__snapshots__/linux/mpa_basics_test/mpa-sidebar_nav_expanded[webkit].png differ
diff --git a/e2e_playwright/multipage_apps/mpa_basics.py b/e2e_playwright/multipage_apps/mpa_basics.py
index e6c04fc2f..360c41972 100644
--- a/e2e_playwright/multipage_apps/mpa_basics.py
+++ b/e2e_playwright/multipage_apps/mpa_basics.py
@@ -17,6 +17,8 @@ import streamlit as st
 st.header("Main Page")
 st.slider("x")
 
-page_2 = st.button("`pages/02_page2.py`")
-if page_2:
+if st.button("`pages/02_page2.py`"):
     st.switch_page("pages/02_page2.py")
+
+if st.button("`pages/08_slow_page.py`"):
+    st.switch_page("pages/08_slow_page.py")
diff --git a/e2e_playwright/multipage_apps/mpa_basics_test.py b/e2e_playwright/multipage_apps/mpa_basics_test.py
index e3066f10c..ea2db615c 100644
--- a/e2e_playwright/multipage_apps/mpa_basics_test.py
+++ b/e2e_playwright/multipage_apps/mpa_basics_test.py
@@ -134,7 +134,7 @@ def test_switch_page(app: Page):
     """Test that we can switch between pages by triggering st.switch_page."""
 
     # Click the button to trigger st.switch_page using relative path
-    app.get_by_test_id("baseButton-secondary").click()
+    app.get_by_test_id("stButton").nth(0).locator("button").first.click()
     wait_for_app_run(app)
 
     # Check that we are on the correct page
@@ -159,12 +159,28 @@ def test_switch_page_removes_query_params(page: Page, app_port: int):
     wait_for_app_loaded(page)
 
     # Trigger st.switch_page
-    page.get_by_test_id("stButton").locator("button").first.click()
+    page.get_by_test_id("stButton").nth(0).locator("button").first.click()
     wait_for_app_loaded(page)
     # Check that query params don't persist
     expect(page).to_have_url(f"http://localhost:{app_port}/page2")
 
 
+def test_switch_page_switches_immediately_if_second_page_is_slow(app: Page):
+    app.get_by_test_id("stButton").nth(1).locator("button").first.click()
+
+    # Wait for the view container and main menu to appear (like in wait_for_app_loaded),
+    # but don't wait for the script to finish running.
+    app.wait_for_selector(
+        "[data-testid='stAppViewContainer']", timeout=30000, state="attached"
+    )
+    app.wait_for_selector("[data-testid='stMainMenu']", timeout=20000, state="attached")
+
+    # We expect to see the page transition to the slow page by the time this call times
+    # out in 5s. Otherwise, the page contents aren't being rendered until the script has
+    # fully completed, and we've run into https://github.com/streamlit/streamlit/issues/7954
+    expect(app.get_by_test_id("stHeading")).to_contain_text("Slow page")
+
+
 def test_removes_query_params_when_swapping_pages(page: Page, app_port: int):
     """Test that query params are removed when swapping pages"""
 
diff --git a/e2e_playwright/multipage_apps/pages/08_slow_page.py b/e2e_playwright/multipage_apps/pages/08_slow_page.py
new file mode 100644
index 000000000..859d3ea53
--- /dev/null
+++ b/e2e_playwright/multipage_apps/pages/08_slow_page.py
@@ -0,0 +1,20 @@
+# Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import time
+
+import streamlit as st
+
+st.header("Slow page")
+time.sleep(10)
diff --git a/lib/streamlit/runtime/app_session.py b/lib/streamlit/runtime/app_session.py
index 2176bcaed..69d12edc8 100644
--- a/lib/streamlit/runtime/app_session.py
+++ b/lib/streamlit/runtime/app_session.py
@@ -583,6 +583,7 @@ class AppSession:
             script_finished_msg = self._create_script_finished_message(
                 ForwardMsg.FINISHED_EARLY_FOR_RERUN
             )
+            self._state = AppSessionState.APP_NOT_RUNNING
             self._enqueue_forward_msg(script_finished_msg)
             if self._local_sources_watcher:
                 self._local_sources_watcher.update_watched_modules()
diff --git a/lib/tests/streamlit/runtime/app_session_test.py b/lib/tests/streamlit/runtime/app_session_test.py
index 67c23a81f..fe1c3ac67 100644
--- a/lib/tests/streamlit/runtime/app_session_test.py
+++ b/lib/tests/streamlit/runtime/app_session_test.py
@@ -350,6 +350,25 @@ class AppSessionTest(unittest.TestCase):
 
             self.assertIsNone(session._debug_last_backmsg_id)
 
+    @patch("streamlit.runtime.app_session.ScriptRunner", MagicMock(spec=ScriptRunner))
+    @patch("streamlit.runtime.app_session.AppSession._enqueue_forward_msg", MagicMock())
+    def test_sets_state_to_not_running_on_rerun_event(self):
+        session = _create_test_session()
+        session._create_scriptrunner(initial_rerun_data=RerunData())
+        session._state = AppSessionState.APP_IS_RUNNING
+
+        with patch(
+            "streamlit.runtime.app_session.asyncio.get_running_loop",
+            return_value=session._event_loop,
+        ):
+            session._handle_scriptrunner_event_on_event_loop(
+                sender=session._scriptrunner,
+                event=ScriptRunnerEvent.SCRIPT_STOPPED_FOR_RERUN,
+                forward_msg=ForwardMsg(),
+            )
+
+            self.assertEqual(session._state, AppSessionState.APP_NOT_RUNNING)
+
     def test_passes_client_state_on_run_on_save(self):
         session = _create_test_session()
         session._run_on_save = True
