diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[chromium].png
new file mode 100644
index 000000000..dd4d32931
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[firefox].png
new file mode 100644
index 000000000..a44ce0d02
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[webkit].png
new file mode 100644
index 000000000..73a6e5378
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-columns[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[chromium].png
new file mode 100644
index 000000000..522b094e7
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[firefox].png
new file mode 100644
index 000000000..ac4eb72df
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[webkit].png
new file mode 100644
index 000000000..c6226eb90
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-form_container[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[chromium].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[chromium].png
new file mode 100644
index 000000000..41eeb6045
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[firefox].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[firefox].png
new file mode 100644
index 000000000..d9248ca22
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[webkit].png b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[webkit].png
new file mode 100644
index 000000000..af3c5d8fb
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_code_test/st_code-height_container[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[chromium].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[chromium].png
new file mode 100644
index 000000000..72c6e4441
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[firefox].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[firefox].png
new file mode 100644
index 000000000..641fffaf5
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[webkit].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[webkit].png
new file mode 100644
index 000000000..baec0a5c8
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-columns[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[chromium].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[chromium].png
new file mode 100644
index 000000000..c1369d28e
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[firefox].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[firefox].png
new file mode 100644
index 000000000..5e057512f
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[webkit].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[webkit].png
new file mode 100644
index 000000000..0ffb98258
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_content[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[chromium].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[chromium].png
new file mode 100644
index 000000000..e43cbe9e6
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[firefox].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[firefox].png
new file mode 100644
index 000000000..4e4a96ad3
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[webkit].png b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[webkit].png
new file mode 100644
index 000000000..0b5ae3eb7
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_container_test/st_container-nested_overflow[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[chromium].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[chromium].png
new file mode 100644
index 000000000..18739f927
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[firefox].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[firefox].png
new file mode 100644
index 000000000..f1eeed7fb
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[webkit].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[webkit].png
new file mode 100644
index 000000000..37378d406
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-columns[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[chromium].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[chromium].png
new file mode 100644
index 000000000..cb6be6baa
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[firefox].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[firefox].png
new file mode 100644
index 000000000..27f3786da
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[webkit].png b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[webkit].png
new file mode 100644
index 000000000..5f747edbb
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_form_test/st_form-height_container[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[chromium].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[chromium].png
new file mode 100644
index 000000000..d4476cd7d
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[firefox].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[firefox].png
new file mode 100644
index 000000000..13e178554
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[webkit].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[webkit].png
new file mode 100644
index 000000000..9297608d4
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-code_stretch_height_in_container[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[chromium].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[chromium].png
new file mode 100644
index 000000000..f8709b314
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[firefox].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[firefox].png
new file mode 100644
index 000000000..789632e4b
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[webkit].png b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[webkit].png
new file mode 100644
index 000000000..89caa24f4
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_tabs_test/st_tabs-fixed_height_stretch_height[webkit].png differ
diff --git a/e2e_playwright/st_code.py b/e2e_playwright/st_code.py
index a55b683b0..d61b1677a 100644
--- a/e2e_playwright/st_code.py
+++ b/e2e_playwright/st_code.py
@@ -133,3 +133,19 @@ long_single_word_string = "askldfjlweklrjweifjlsdfliwjlierjilsildfjlslfij" * 3
 
 st.code(long_single_word_string)
 st.code(long_single_word_string, wrap_lines=True)
+
+with st.form("form with a code block", height=400):
+    st.code(code, height="stretch")
+    st.form_submit_button("Submit")
+
+col1, col2 = st.columns(2)
+
+with col1:
+    st.code(code, height=300)
+    st.code(code, height="stretch")
+with col2:
+    st.code(code, height="stretch")
+
+with st.container(height=300, key="container_with_code"):
+    st.code(code, height=100)
+    st.code(code, height="stretch")
diff --git a/e2e_playwright/st_code_test.py b/e2e_playwright/st_code_test.py
index d744a91f8..3da2566b3 100644
--- a/e2e_playwright/st_code_test.py
+++ b/e2e_playwright/st_code_test.py
@@ -73,7 +73,7 @@ def test_code_blocks_render_correctly(
 ):
     """Test that the code blocks render as expected via screenshot matching."""
     code_blocks = themed_app.get_by_test_id("stCode")
-    expect(code_blocks).to_have_count(25)
+    expect(code_blocks).to_have_count(31)
     # The code blocks might require a bit more time for rendering, so wait until
     # the text is truly visible. Otherwise we might get blank code blocks in the
     # screenshots.
@@ -82,7 +82,7 @@ def test_code_blocks_render_correctly(
         f"()=>document.body.textContent.split('def foo()').length === {foo_func_count}"
     )
     # Check that there are 15 code blocks with the class "language-python"
-    expect(themed_app.locator("code.language-python")).to_have_count(23)
+    expect(themed_app.locator("code.language-python")).to_have_count(29)
 
     assert_snapshot(code_blocks.nth(0), name="st_code-auto_lang")
     assert_snapshot(code_blocks.nth(1), name="st_code-empty")
@@ -186,3 +186,27 @@ def test_width_configurations(app: Page, assert_snapshot: ImageCompareFunction):
     # Test longer code blocks with different widths
     assert_snapshot(code_elements.nth(21), name="st_code-width_pixels")
     assert_snapshot(code_elements.nth(22), name="st_code-width_stretch")
+
+
+def test_form_with_code_block(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that code blocks render correctly within forms."""
+    # Get the form container and snapshot the entire form
+    form_container = app.get_by_test_id("stForm")
+    form_container.scroll_into_view_if_needed()
+    assert_snapshot(form_container, name="st_code-form_container")
+
+
+def test_columns_with_code_blocks(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that code blocks render correctly within columns."""
+    # Get the columns container and snapshot the entire columns layout
+    columns_container = app.get_by_test_id("stHorizontalBlock")
+    columns_container.scroll_into_view_if_needed()
+    assert_snapshot(columns_container, name="st_code-columns")
+
+
+def test_container_with_code_blocks(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that code blocks render correctly within containers with fixed height."""
+    # Get the container with height and snapshot the entire container
+    height_container = app.get_by_test_id("stVerticalBlock").last
+    height_container.scroll_into_view_if_needed()
+    assert_snapshot(height_container, name="st_code-height_container")
diff --git a/e2e_playwright/st_container.py b/e2e_playwright/st_container.py
index 2fa971aba..2ac989dc7 100644
--- a/e2e_playwright/st_container.py
+++ b/e2e_playwright/st_container.py
@@ -63,3 +63,27 @@ with st.container(border=True):
 # Test that an empty container without height or border is not rendered.
 with st.container(border=True):
     st.container()
+
+with st.container(height=200, border=True):
+    st.write("Inside container 1")
+    with st.container(height=250, border=True):
+        st.write("Inside container 2")
+
+with st.container(height=200, border=True):
+    st.write("Inside container 3")
+    with st.container(border=True):
+        st.write("Inside container 4")
+
+col1, col2 = st.columns(2)
+
+with col1:
+    with st.container(height=200, border=True):
+        st.write("Inside container 5")
+    with st.container(border=True):
+        st.write("Inside container 6")
+
+with col2:
+    with st.container(border=True):
+        st.write("Inside container 7")
+    with st.container(height=100, border=True):
+        st.write("Inside container 8")
diff --git a/e2e_playwright/st_container_test.py b/e2e_playwright/st_container_test.py
index 21de61a84..1de5a4e58 100644
--- a/e2e_playwright/st_container_test.py
+++ b/e2e_playwright/st_container_test.py
@@ -53,9 +53,7 @@ def test_renders_container_with_border(
     themed_app: Page, assert_snapshot: ImageCompareFunction
 ):
     """Test that st.container(border=True) renders correctly with a border."""
-    container_with_border = themed_app.get_by_test_id(
-        "stVerticalBlockBorderWrapper"
-    ).nth(2)
+    container_with_border = themed_app.get_by_test_id("stVerticalBlock").nth(3)
     assert_snapshot(container_with_border, name="st_container-has_border")
     # This one should not have scrolling activated:
     expect(container_with_border).not_to_have_css("overflow", "auto")
@@ -64,13 +62,13 @@ def test_renders_container_with_border(
 def test_renders_scroll_container(app: Page, assert_snapshot: ImageCompareFunction):
     """Test that st.container(height=<pixels>) renders a scroll container."""
 
-    scroll_container = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(3)
+    scroll_container = app.get_by_test_id("stVerticalBlock").nth(4)
     expect(scroll_container).to_have_css("overflow", "auto")
     expect(scroll_container).to_have_css("height", "200px")
     expect(scroll_container).to_have_attribute("data-test-scroll-behavior", "normal")
     assert_snapshot(scroll_container, name="st_container-scroll_container")
 
-    scroll_container_empty = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(4)
+    scroll_container_empty = app.get_by_test_id("stVerticalBlock").nth(5)
     expect(scroll_container_empty).to_have_css("overflow", "auto")
     expect(scroll_container_empty).to_have_css("height", "100px")
     expect(scroll_container_empty).to_have_attribute(
@@ -79,7 +77,7 @@ def test_renders_scroll_container(app: Page, assert_snapshot: ImageCompareFuncti
     assert_snapshot(scroll_container_empty, name="st_container-scroll_container_empty")
 
     # This one should be pinned to the bottom:
-    scroll_container_chat = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(5)
+    scroll_container_chat = app.get_by_test_id("stVerticalBlock").nth(6)
     expect(scroll_container_chat).to_have_css("overflow", "auto")
     expect(scroll_container_chat).to_have_css("height", "200px")
     expect(scroll_container_chat).to_have_attribute(
@@ -100,13 +98,13 @@ def test_correctly_handles_first_chat_message(
 
     wait_for_app_run(app)
 
-    # Wait for the stVerticalBlockBorderWrapper container to switch to scroll-to-bottom:
-    expect(app.get_by_test_id("stVerticalBlockBorderWrapper").nth(4)).to_have_attribute(
+    # Wait for the stVerticalBlock container to switch to scroll-to-bottom:
+    expect(app.get_by_test_id("stVerticalBlock").nth(5)).to_have_attribute(
         "data-test-scroll-behavior", "scroll-to-bottom"
     )
 
     assert_snapshot(
-        app.get_by_test_id("stVerticalBlockBorderWrapper").nth(4),
+        app.get_by_test_id("stVerticalBlock").nth(5),
         name="st_container-added_chat_message",
     )
 
@@ -123,19 +121,38 @@ def test_custom_css_class_via_key(app: Page):
 
 def test_empty_containers(app: Page):
     # Test that an empty container with a border is rendered.
-    border_outer_container = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(6)
+    border_outer_container = app.get_by_test_id("stVerticalBlock").nth(17)
     expect(
-        border_outer_container.get_by_test_id("stVerticalBlockBorderWrapper").first
+        border_outer_container.get_by_test_id("stVerticalBlock").first
     ).to_be_visible()
 
     # Test that an empty container with height is rendered.
-    height_outer_container = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(8)
+    height_outer_container = app.get_by_test_id("stVerticalBlock").nth(19)
     expect(
-        height_outer_container.get_by_test_id("stVerticalBlockBorderWrapper").first
+        height_outer_container.get_by_test_id("stVerticalBlock").first
     ).to_be_visible()
 
     # Test that an empty container without height or border is not rendered.
-    empty_outer_container = app.get_by_test_id("stVerticalBlockBorderWrapper").nth(10)
-    expect(
-        empty_outer_container.get_by_test_id("stVerticalBlockBorderWrapper")
-    ).to_have_count(0)
+    empty_outer_container = app.get_by_test_id("stVerticalBlock").nth(21)
+    expect(empty_outer_container.get_by_test_id("stVerticalBlock")).to_have_count(0)
+
+
+def test_nested_containers(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that nested containers render correctly with different height configurations."""
+    # Test first nested container example (outer: height=200, inner: height=250)
+    nested_container_1 = app.get_by_test_id("stVerticalBlock").nth(22)
+    nested_container_1.scroll_into_view_if_needed()
+    assert_snapshot(nested_container_1, name="st_container-nested_overflow")
+
+    # Test second nested container example (outer: height=200, inner: no height)
+    nested_container_2 = app.get_by_test_id("stVerticalBlock").nth(24)
+    nested_container_2.scroll_into_view_if_needed()
+    assert_snapshot(nested_container_2, name="st_container-nested_content")
+
+
+def test_containers_in_columns(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that containers render correctly within columns."""
+    # Get the columns container and snapshot the entire columns layout
+    columns_container = app.get_by_test_id("stHorizontalBlock").last
+    columns_container.scroll_into_view_if_needed()
+    assert_snapshot(columns_container, name="st_container-columns")
diff --git a/e2e_playwright/st_form.py b/e2e_playwright/st_form.py
index 9c181b1de..8ae7bb1e4 100644
--- a/e2e_playwright/st_form.py
+++ b/e2e_playwright/st_form.py
@@ -213,3 +213,43 @@ with st.form("form_16", height="content"):
     )
     if submitted_16:
         st.write("Form submitted")
+
+
+col1, col2 = st.columns(2)
+with col1:
+    with st.form("form_17", height=400):
+        st.write("Form height: 400px")
+        text_input = st.text_input("Form 17 - Text Input")
+        st.form_submit_button(
+            help="Submit by clicking",
+        )
+
+    with st.form("form_18", height="stretch"):
+        st.write("Form height: stretch")
+        text_input = st.text_input("Form 18 - Text Input")
+        st.form_submit_button(
+            help="Submit by clicking",
+        )
+
+with col2:
+    with st.form("form_19", height="stretch"):
+        st.write("Form height: stretch")
+        text_input = st.text_input("Form 19 - Text Input")
+        st.form_submit_button(
+            help="Submit by clicking",
+        )
+
+with st.container(height=600, border=True):
+    with st.form("form_20", height="stretch"):
+        st.write("Form height: stretch")
+        text_input = st.text_input("Form 20 - Text Input")
+        st.form_submit_button(
+            help="Submit by clicking",
+        )
+
+    with st.form("form_21", height="content"):
+        st.write("Form height: content")
+        text_input = st.text_input("Form 21 - Text Input")
+        st.form_submit_button(
+            help="Submit by clicking",
+        )
diff --git a/e2e_playwright/st_form_test.py b/e2e_playwright/st_form_test.py
index 5c5454647..0be75fad7 100644
--- a/e2e_playwright/st_form_test.py
+++ b/e2e_playwright/st_form_test.py
@@ -304,3 +304,21 @@ def test_form_height_configurations(app: Page, assert_snapshot: ImageCompareFunc
     form_16 = app.get_by_test_id("stForm").nth(15)
     expect(form_16.get_by_test_id("stFormSubmitButton").first).to_be_visible()
     assert_snapshot(form_16, name="st_form-content_height")
+
+    # Stretch height is tested inside containers and columns below.
+
+
+def test_forms_in_columns(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that forms render correctly within columns."""
+    # Get the columns container and snapshot the entire columns layout
+    columns_container = app.get_by_test_id("stHorizontalBlock").last
+    columns_container.scroll_into_view_if_needed()
+    assert_snapshot(columns_container, name="st_form-columns")
+
+
+def test_forms_in_container(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that forms render correctly within containers with fixed height."""
+    # Get the container with height and snapshot the entire container
+    height_container = app.get_by_test_id("stVerticalBlock").nth(20)
+    height_container.scroll_into_view_if_needed()
+    assert_snapshot(height_container, name="st_form-height_container")
diff --git a/e2e_playwright/st_tabs.py b/e2e_playwright/st_tabs.py
index 31f21dcf7..c41a7525c 100644
--- a/e2e_playwright/st_tabs.py
+++ b/e2e_playwright/st_tabs.py
@@ -57,3 +57,31 @@ fixed_width_tabs = st.tabs(["width_test_1", "width_test_2", "width_test_3"], wid
 
 for i, tab in enumerate(fixed_width_tabs):
     tab.write(f"Hello {i}")
+
+# Tabs layout tests.
+tab_with_code_1, tab_with_code_2 = st.tabs(["Tab 1", "Tab 2"])
+
+container = tab_with_code_1.container(height=200)
+container.code(
+    """
+def hello():
+    print("Hello, Streamlit!")
+""",
+    height="stretch",
+)
+
+tab_with_code_2.code(
+    """
+def hello():
+    print("Hello, Streamlit!")
+""",
+    height=200,
+)
+
+tab_with_code_2.code(
+    """
+def hello():
+    print("Hello, Streamlit!")
+""",
+    height="stretch",
+)
diff --git a/e2e_playwright/st_tabs_test.py b/e2e_playwright/st_tabs_test.py
index dc785e570..edc6886bc 100644
--- a/e2e_playwright/st_tabs_test.py
+++ b/e2e_playwright/st_tabs_test.py
@@ -20,7 +20,7 @@ from e2e_playwright.shared.app_utils import check_top_level_class, get_expander
 
 def test_tabs_render_correctly(themed_app: Page, assert_snapshot: ImageCompareFunction):
     st_tabs = themed_app.get_by_test_id("stTabs")
-    expect(st_tabs).to_have_count(6)
+    expect(st_tabs).to_have_count(7)
 
     assert_snapshot(st_tabs.nth(0), name="st_tabs-sidebar")
     assert_snapshot(st_tabs.nth(1), name="st_tabs-text_input")
@@ -56,3 +56,16 @@ def test_tabs_with_html(app: Page):
     expect(app.get_by_text("This is HTML tab 3")).to_be_visible()
     tabs.get_by_role("tab", name="HTML Tab 1").click()
     expect(app.get_by_text("This is HTML tab 1")).to_be_visible()
+
+
+def test_tabs_with_code_layouts(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that tabs with code blocks and different height configurations render correctly."""
+    tabs_with_code = app.get_by_test_id("stTabs").nth(6)
+
+    # Test Tab 1 with container and stretched code
+    tabs_with_code.scroll_into_view_if_needed()
+    assert_snapshot(tabs_with_code, name="st_tabs-code_stretch_height_in_container")
+
+    # Switch to Tab 2 and test fixed height and stretched code
+    tabs_with_code.get_by_role("tab", name="Tab 2").click()
+    assert_snapshot(tabs_with_code, name="st_tabs-fixed_height_stretch_height")
diff --git a/frontend/app/src/StreamlitLib.test.tsx b/frontend/app/src/StreamlitLib.test.tsx
index 0a003023e..466c75a8b 100644
--- a/frontend/app/src/StreamlitLib.test.tsx
+++ b/frontend/app/src/StreamlitLib.test.tsx
@@ -230,6 +230,7 @@ class StreamlitLibExample extends PureComponent<Props, State> {
         widgetMgr={this.widgetMgr}
         uploadClient={this.uploadClient}
         widgetsDisabled={false}
+        height="auto"
       />
     )
   }
diff --git a/frontend/app/src/components/AppView/AppView.tsx b/frontend/app/src/components/AppView/AppView.tsx
index ce73eed37..b8cb698eb 100644
--- a/frontend/app/src/components/AppView/AppView.tsx
+++ b/frontend/app/src/components/AppView/AppView.tsx
@@ -194,6 +194,7 @@ function AppView(props: AppViewProps): ReactElement {
       widgetMgr={widgetMgr}
       widgetsDisabled={widgetsDisabled}
       uploadClient={uploadClient}
+      height="auto"
     />
   )
 
diff --git a/frontend/app/src/components/AppView/ScrollToBottomContainer.tsx b/frontend/app/src/components/AppView/ScrollToBottomContainer.tsx
index 76d8f4ce2..b86c94557 100644
--- a/frontend/app/src/components/AppView/ScrollToBottomContainer.tsx
+++ b/frontend/app/src/components/AppView/ScrollToBottomContainer.tsx
@@ -30,7 +30,7 @@ export interface Props {
 
 export default function ScrollToBottomContainer(props: Props): ReactElement {
   const { className, tabIndex, children, isEmbedded, disableScrolling } = props
-  const scrollContainerRef = useScrollToBottom()
+  const scrollContainerRef = useScrollToBottom(true)
 
   return (
     <StyledAppViewMain
diff --git a/frontend/lib/src/components/core/Block/Block.test.tsx b/frontend/lib/src/components/core/Block/Block.test.tsx
index 391170e27..c3be7b9c0 100644
--- a/frontend/lib/src/components/core/Block/Block.test.tsx
+++ b/frontend/lib/src/components/core/Block/Block.test.tsx
@@ -92,9 +92,9 @@ describe("FlexBoxContainer Block Component", () => {
     expect(horizontalBlock).toHaveAttribute("direction", "row")
 
     expect(screen.getAllByTestId("stColumn")).toHaveLength(4)
-    expect(
-      screen.getAllByTestId("stVerticalBlockBorderWrapper")[0]
-    ).not.toHaveStyle("overflow: auto")
+    expect(screen.getAllByTestId("stVerticalBlock")[0]).not.toHaveStyle(
+      "overflow: auto"
+    )
   })
 
   it("should add the user-specified key as class", () => {
@@ -119,9 +119,9 @@ describe("FlexBoxContainer Block Component", () => {
 
     renderWithContexts(makeVerticalBlockComponent(block), {})
 
-    expect(
-      screen.getAllByTestId("stVerticalBlockBorderWrapper")[0]
-    ).toHaveStyle("overflow: auto")
+    expect(screen.getAllByTestId("stVerticalBlock")[0]).toHaveStyle(
+      "overflow: auto"
+    )
   })
 
   it("should show border when border is True", () => {
@@ -133,9 +133,9 @@ describe("FlexBoxContainer Block Component", () => {
     )
     renderWithContexts(makeVerticalBlockComponent(block), {})
 
-    expect(
-      screen.getAllByTestId("stVerticalBlockBorderWrapper")[0]
-    ).toHaveStyle("border: 1px solid rgba(49, 51, 63, 0.2);")
+    expect(screen.getAllByTestId("stVerticalBlock")[0]).toHaveStyle(
+      "border: 1px solid rgba(49, 51, 63, 0.2);"
+    )
   })
 
   describe("VerticalBlock", () => {
diff --git a/frontend/lib/src/components/core/Block/Block.tsx b/frontend/lib/src/components/core/Block/Block.tsx
index a2f227828..86c6be7e1 100644
--- a/frontend/lib/src/components/core/Block/Block.tsx
+++ b/frontend/lib/src/components/core/Block/Block.tsx
@@ -56,8 +56,6 @@ import {
 } from "./utils"
 import ElementNodeRenderer from "./ElementNodeRenderer"
 import {
-  StyledBlockWrapper,
-  StyledBlockWrapperProps,
   StyledColumn,
   StyledFlexContainerBlock,
   StyledFlexContainerBlockProps,
@@ -131,6 +129,7 @@ const ChildRenderer = (props: BlockPropsWithoutWidth): ReactElement => {
 
 interface ContainerContentsWrapperProps extends BaseBlockProps {
   node: BlockNode
+  height: React.CSSProperties["height"]
 }
 
 export const ContainerContentsWrapper = (
@@ -140,6 +139,9 @@ export const ContainerContentsWrapper = (
     direction: Direction.VERTICAL,
     flex: 1,
     gap: streamlit.GapSize.SMALL,
+    height: props.height,
+    // eslint-disable-next-line streamlit-custom/no-hardcoded-theme-values
+    border: false,
   }
 
   const userKey = getKeyFromId(props.node.deltaBlock.id)
@@ -157,28 +159,6 @@ export const ContainerContentsWrapper = (
   )
 }
 
-export interface ScrollToBottomBlockWrapperProps
-  extends StyledBlockWrapperProps {
-  children: ReactNode
-}
-
-// A wrapper for Blocks that adds scrolling with pinned to bottom behavior.
-function ScrollToBottomBlockWrapper(
-  props: ScrollToBottomBlockWrapperProps
-): ReactElement {
-  const { children } = props
-  const scrollContainerRef = useScrollToBottom()
-
-  return (
-    <StyledBlockWrapper
-      {...props}
-      ref={scrollContainerRef as React.RefObject<HTMLDivElement>}
-    >
-      {children}
-    </StyledBlockWrapper>
-  )
-}
-
 interface FlexBoxContainerProps extends BaseBlockProps {
   node: BlockNode
 }
@@ -188,11 +168,18 @@ export const FlexBoxContainer = (
 ): ReactElement => {
   const direction = getDirectionOfBlock(props.node.deltaBlock)
 
-  // TODO: as advanced layouts is rolled out, we will add useLayoutStyles
+  const activateScrollToBottom = getActivateScrollToBottomBackwardsCompatible(
+    props.node
+  )
+  const scrollContainerRef = useScrollToBottom(activateScrollToBottom)
+
+  const height = getHeightBackwardsCompatible(props.node.deltaBlock)
+  const flex = height ? `0 0 ${height}px` : undefined
+
+  // TODO(lawilby): as advanced layouts is rolled out, we will add useLayoutStyles
   // here to get the correct styles for the flexbox container based on user
   // settings.
   const styles = {
-    flex: 1,
     gap:
       // This is backwards compatible with old proto messages since previously
       // the gap size was defaulted to small.
@@ -202,45 +189,28 @@ export const FlexBoxContainer = (
     // This is also backwards capatible since previously wrap was not added
     // to the flex container.
     wrap: props.node.deltaBlock.flexContainer?.wrap ?? false,
-  }
-
-  const activateScrollToBottom = getActivateScrollToBottomBackwardsCompatible(
-    props.node
-  )
-
-  // Decide which wrapper to use based on whether we need to activate scrolling to bottom
-  // This is done for performance reasons, to prevent the usage of useScrollToBottom
-  // if it is not needed.
-  const BlockBorderWrapper = activateScrollToBottom
-    ? ScrollToBottomBlockWrapper
-    : StyledBlockWrapper
-
-  const blockBorderWrapperProps = {
+    height,
+    flex,
     border: getBorderBackwardsCompatible(props.node.deltaBlock),
-    height: getHeightBackwardsCompatible(props.node.deltaBlock),
   }
 
   const userKey = getKeyFromId(props.node.deltaBlock.id)
 
   return (
-    <BlockBorderWrapper
-      {...blockBorderWrapperProps}
-      data-testid="stVerticalBlockBorderWrapper"
+    <StyledFlexContainerBlock
+      {...styles}
+      className={classNames(
+        getClassnamePrefix(direction),
+        convertKeyToClassName(userKey)
+      )}
+      data-testid={getClassnamePrefix(direction)}
+      ref={scrollContainerRef as React.RefObject<HTMLDivElement>}
       data-test-scroll-behavior={
         activateScrollToBottom ? "scroll-to-bottom" : "normal"
       }
     >
-      <StyledFlexContainerBlock
-        {...styles}
-        className={classNames(
-          getClassnamePrefix(direction),
-          convertKeyToClassName(userKey)
-        )}
-        data-testid={getClassnamePrefix(direction)}
-      >
-        <ChildRenderer {...props} />
-      </StyledFlexContainerBlock>
-    </BlockBorderWrapper>
+      <ChildRenderer {...props} />
+    </StyledFlexContainerBlock>
   )
 }
 
@@ -289,6 +259,7 @@ const BlockNodeRenderer = (props: BlockPropsWithoutWidth): ReactElement => {
     <ContainerContentsWrapper
       {...childProps}
       disableFullscreenMode={disableFullscreenMode}
+      height="100%"
     />
   )
 
@@ -382,7 +353,7 @@ const BlockNodeRenderer = (props: BlockPropsWithoutWidth): ReactElement => {
       mappedChildProps: JSX.IntrinsicAttributes & BlockPropsWithoutWidth
     ): ReactElement => {
       // avoid circular dependency where Tab uses VerticalBlock but VerticalBlock uses tabs
-      return <ContainerContentsWrapper {...mappedChildProps} />
+      return <ContainerContentsWrapper {...mappedChildProps} height="auto" />
     }
     // We can't use StyledLayoutWrapper for tabs currently because of the horizontal scrolling
     // management that is handled in the Tabs component. TODO(lwilby): Investigate whether it makes
diff --git a/frontend/lib/src/components/core/Block/styled-components.ts b/frontend/lib/src/components/core/Block/styled-components.ts
index c363e7c9b..ffd10a784 100644
--- a/frontend/lib/src/components/core/Block/styled-components.ts
+++ b/frontend/lib/src/components/core/Block/styled-components.ts
@@ -16,6 +16,7 @@
 
 import React from "react"
 
+import { isInteger } from "lodash"
 import styled from "@emotion/styled"
 
 import { Block as BlockProto, streamlit } from "@streamlit/protobuf"
@@ -44,11 +45,12 @@ export interface StyledElementContainerProps {
   height: React.CSSProperties["height"]
   elementType: string
   overflow: React.CSSProperties["overflow"]
+  flex?: React.CSSProperties["flex"]
 }
 
 const GLOBAL_ELEMENTS = ["balloons", "snow"]
 export const StyledElementContainer = styled.div<StyledElementContainerProps>(
-  ({ theme, isStale, width, height, elementType, overflow }) => ({
+  ({ theme, isStale, width, height, elementType, overflow, flex }) => ({
     width,
     height,
     maxWidth: "100%",
@@ -56,6 +58,7 @@ export const StyledElementContainer = styled.div<StyledElementContainerProps>(
     // floating buttons.
     position: "relative",
     overflow,
+    flex,
 
     "@media print": {
       overflow: "visible",
@@ -147,36 +150,18 @@ export const StyledColumn = styled.div<StyledColumnProps>(
   }
 )
 
-export interface StyledBlockWrapperProps {
-  border: boolean
-  height?: number
-}
-
-export const StyledBlockWrapper = styled.div<StyledBlockWrapperProps>(
-  ({ theme, border, height }) => ({
-    display: "block",
-    ...(border && {
-      border: `${theme.sizes.borderWidth} solid ${theme.colors.borderColor}`,
-      borderRadius: theme.radii.default,
-      padding: `calc(${theme.spacing.lg} - ${theme.sizes.borderWidth})`,
-    }),
-    ...(height && {
-      height: `${height}px`,
-      overflow: "auto",
-    }),
-  })
-)
-
 export interface StyledFlexContainerBlockProps {
   direction: React.CSSProperties["flexDirection"]
   gap?: streamlit.GapSize | undefined
   flex?: React.CSSProperties["flex"]
   wrap?: boolean
+  height?: React.CSSProperties["height"]
+  border: boolean
 }
 
 export const StyledFlexContainerBlock =
   styled.div<StyledFlexContainerBlockProps>(
-    ({ theme, direction, gap, flex, wrap }) => {
+    ({ theme, direction, gap, flex, wrap, height, border }) => {
       let gapWidth
       if (gap !== undefined) {
         gapWidth = translateGapWidth(gap, theme)
@@ -187,10 +172,16 @@ export const StyledFlexContainerBlock =
         gap: gapWidth,
         width: "100%",
         maxWidth: "100%",
-        height: "auto",
+        height: height ?? "auto",
+        overflow: isInteger(height) ? "auto" : "visible",
         flexDirection: direction,
         flex,
         flexWrap: wrap ? "wrap" : "nowrap",
+        ...(border && {
+          border: `${theme.sizes.borderWidth} solid ${theme.colors.borderColor}`,
+          borderRadius: theme.radii.default,
+          padding: `calc(${theme.spacing.lg} - ${theme.sizes.borderWidth})`,
+        }),
       }
     }
   )
@@ -198,13 +189,15 @@ export const StyledFlexContainerBlock =
 export interface StyledLayoutWrapperProps {
   width?: React.CSSProperties["width"]
   height?: React.CSSProperties["height"]
+  flex?: React.CSSProperties["flex"]
 }
 
 export const StyledLayoutWrapper = styled.div<StyledLayoutWrapperProps>(
-  ({ width, height }) => ({
+  ({ width, height, flex }) => ({
     display: "flex",
     width,
     maxWidth: "100%",
     height,
+    flex,
   })
 )
diff --git a/frontend/lib/src/components/core/Layout/useLayoutStyles.test.tsx b/frontend/lib/src/components/core/Layout/useLayoutStyles.test.tsx
index a02bfcfbb..9a7cc6028 100644
--- a/frontend/lib/src/components/core/Layout/useLayoutStyles.test.tsx
+++ b/frontend/lib/src/components/core/Layout/useLayoutStyles.test.tsx
@@ -26,7 +26,7 @@ class MockElement implements Element {
 
   heightConfig?: streamlit.HeightConfig | null
 
-  type?: "imgs" | "textArea"
+  type?: "imgs" | "textArea" | "iframe" | "deckGlJsonChart" | "arrowDataFrame"
 
   constructor(props: Partial<MockElement> = {}) {
     Object.assign(this, props)
@@ -317,7 +317,11 @@ describe("#useLayoutStyles", () => {
         ],
         [
           new streamlit.HeightConfig({ pixelHeight: 100 }),
-          getDefaultStyles({ height: 100, overflow: "auto" }),
+          getDefaultStyles({
+            height: 100,
+            overflow: "auto",
+            flex: "0 0 100px",
+          }),
         ],
       ])(
         "and with a heightConfig value of %o, returns %o",
@@ -348,13 +352,45 @@ describe("#useLayoutStyles", () => {
 
     describe("with height defined on subElement but element.heightConfig is null or undefined", () => {
       it.each([
-        [100, null, getDefaultStyles({ height: 100, overflow: "auto" })],
-        [200, null, getDefaultStyles({ height: 200, overflow: "auto" })],
+        [
+          100,
+          null,
+          getDefaultStyles({
+            height: 100,
+            overflow: "auto",
+            flex: "0 0 100px",
+          }),
+        ],
+        [
+          200,
+          null,
+          getDefaultStyles({
+            height: 200,
+            overflow: "auto",
+            flex: "0 0 200px",
+          }),
+        ],
         [0, null, getDefaultStyles({})],
         [-100, null, getDefaultStyles({})],
         [NaN, null, getDefaultStyles({})],
-        [100, undefined, getDefaultStyles({ height: 100, overflow: "auto" })],
-        [200, undefined, getDefaultStyles({ height: 200, overflow: "auto" })],
+        [
+          100,
+          undefined,
+          getDefaultStyles({
+            height: 100,
+            overflow: "auto",
+            flex: "0 0 100px",
+          }),
+        ],
+        [
+          200,
+          undefined,
+          getDefaultStyles({
+            height: 200,
+            overflow: "auto",
+            flex: "0 0 200px",
+          }),
+        ],
         [0, undefined, getDefaultStyles({})],
         [-100, undefined, getDefaultStyles({})],
         [NaN, undefined, getDefaultStyles({})],
@@ -383,7 +419,14 @@ describe("#useLayoutStyles", () => {
         [0, getDefaultStyles({})],
         [-100, getDefaultStyles({})],
         [NaN, getDefaultStyles({})],
-        [100, getDefaultStyles({ height: 100, overflow: "auto" })],
+        [
+          100,
+          getDefaultStyles({
+            height: 100,
+            overflow: "auto",
+            flex: "0 0 100px",
+          }),
+        ],
       ])("and with a height value of %s, returns %o", (height, expected) => {
         const element = new MockElement()
         const subElement = { height }
@@ -442,7 +485,11 @@ describe("#useLayoutStyles", () => {
             heightConfig: new streamlit.HeightConfig({ pixelHeight: 200 }),
             height: 100,
           },
-          getDefaultStyles({ height: 200, overflow: "auto" }),
+          getDefaultStyles({
+            height: 200,
+            overflow: "auto",
+            flex: "0 0 200px",
+          }),
         ],
         [
           {
@@ -488,7 +535,12 @@ describe("#useLayoutStyles", () => {
             widthConfig: new streamlit.WidthConfig({ pixelWidth: 200 }),
             heightConfig: new streamlit.HeightConfig({ pixelHeight: 300 }),
           },
-          getDefaultStyles({ width: 200, height: 300, overflow: "auto" }),
+          getDefaultStyles({
+            width: 200,
+            height: 300,
+            overflow: "auto",
+            flex: "0 0 300px",
+          }),
         ],
         [
           {
@@ -515,11 +567,21 @@ describe("#useLayoutStyles", () => {
       it.each([
         [
           { width: 200, height: 300 },
-          getDefaultStyles({ width: 200, height: 300, overflow: "auto" }),
+          getDefaultStyles({
+            width: 200,
+            height: 300,
+            overflow: "auto",
+            flex: "0 0 300px",
+          }),
         ],
         [
           { width: 0, height: 100 },
-          getDefaultStyles({ width: "auto", height: 100, overflow: "auto" }),
+          getDefaultStyles({
+            width: "auto",
+            height: 100,
+            overflow: "auto",
+            flex: "0 0 100px",
+          }),
         ],
         [
           { width: 100, height: 0 },
@@ -583,5 +645,49 @@ describe("#useLayoutStyles", () => {
         }
       )
     })
+
+    describe("flex property behavior", () => {
+      it("should include flex when height is set via heightConfig pixelHeight", () => {
+        const element = new MockElement({
+          heightConfig: new streamlit.HeightConfig({ pixelHeight: 250 }),
+        })
+        const { result } = renderHook(() => useLayoutStyles({ element }))
+        expect(result.current.flex).toBe("0 0 250px")
+      })
+
+      it("should include flex when height is set via subElement height", () => {
+        const element = new MockElement()
+        const subElement = { height: 175 }
+        const { result } = renderHook(() =>
+          useLayoutStyles({ element, subElement })
+        )
+        expect(result.current.flex).toBe("0 0 175px")
+      })
+
+      it("should not include flex when height is stretch", () => {
+        const element = new MockElement({
+          heightConfig: new streamlit.HeightConfig({ useStretch: true }),
+        })
+        const { result } = renderHook(() => useLayoutStyles({ element }))
+        expect(result.current.flex).toBeUndefined()
+      })
+
+      it("should not include flex when height is content", () => {
+        const element = new MockElement({
+          heightConfig: new streamlit.HeightConfig({ useContent: true }),
+        })
+        const { result } = renderHook(() => useLayoutStyles({ element }))
+        expect(result.current.flex).toBeUndefined()
+      })
+
+      it.each([
+        ["stretch", new streamlit.HeightConfig({ useStretch: true })],
+        ["content", new streamlit.HeightConfig({ useContent: true })],
+      ])("should not include flex when height is %s", (_, heightConfig) => {
+        const element = new MockElement({ heightConfig })
+        const { result } = renderHook(() => useLayoutStyles({ element }))
+        expect(result.current.flex).toBeUndefined()
+      })
+    })
   })
 })
diff --git a/frontend/lib/src/components/core/Layout/useLayoutStyles.ts b/frontend/lib/src/components/core/Layout/useLayoutStyles.ts
index 7c599456c..895192021 100644
--- a/frontend/lib/src/components/core/Layout/useLayoutStyles.ts
+++ b/frontend/lib/src/components/core/Layout/useLayoutStyles.ts
@@ -139,6 +139,7 @@ export type UseLayoutStylesShape = {
   width: React.CSSProperties["width"]
   height: React.CSSProperties["height"]
   overflow: React.CSSProperties["overflow"]
+  flex?: React.CSSProperties["flex"]
 }
 
 /**
@@ -158,6 +159,7 @@ export const useLayoutStyles = ({
         overflow: "visible",
       }
     }
+    let flex: React.CSSProperties["flex"] = undefined
 
     // The st.image element is potentially a list of images, so we always want
     // the enclosing container to be full width. The size of individual
@@ -204,12 +206,16 @@ export const useLayoutStyles = ({
     } else if (heightType === DimensionType.PIXEL) {
       height = commandHeight
       overflow = skipOverflow ? "visible" : "auto"
+      // TODO (lawilby): We only have vertical containers currently, but this will be
+      // modified to handle horizontal containers when direction on containers is implemented.
+      flex = `0 0 ${commandHeight}px`
     }
 
     return {
       width,
       height,
       overflow,
+      flex,
     }
   }, [element, subElement])
 
diff --git a/frontend/lib/src/hooks/useScrollAnimation.test.ts b/frontend/lib/src/hooks/useScrollAnimation.test.ts
index 33cd9512b..686cd0274 100644
--- a/frontend/lib/src/hooks/useScrollAnimation.test.ts
+++ b/frontend/lib/src/hooks/useScrollAnimation.test.ts
@@ -49,7 +49,7 @@ describe("useScrollAnimation", () => {
   it("should animate scroll", () => {
     vi.useFakeTimers()
 
-    renderHook(() => useScrollAnimation(targetElement, onEndMock, true))
+    renderHook(() => useScrollAnimation(targetElement, onEndMock, true, true))
 
     // Simulate scroll animation
     vi.advanceTimersByTime(5)
@@ -72,7 +72,7 @@ describe("useScrollAnimation", () => {
     vi.useFakeTimers()
 
     const { unmount } = renderHook(() =>
-      useScrollAnimation(targetElement, onEndMock, true)
+      useScrollAnimation(targetElement, onEndMock, true, true)
     )
 
     expect(targetElement.addEventListener).toHaveBeenCalledTimes(2)
@@ -102,13 +102,19 @@ describe("useScrollAnimation", () => {
   })
 
   it("should not animate scroll if target element is null", () => {
-    renderHook(() => useScrollAnimation(null, onEndMock, true))
+    renderHook(() => useScrollAnimation(null, onEndMock, true, true))
 
     expect(targetElement.addEventListener).not.toHaveBeenCalled()
   })
 
   it("should not animate scroll if isAnimating is false", () => {
-    renderHook(() => useScrollAnimation(targetElement, onEndMock, false))
+    renderHook(() => useScrollAnimation(targetElement, onEndMock, false, true))
+
+    expect(targetElement.addEventListener).not.toHaveBeenCalled()
+  })
+
+  it("should not animate scroll if active is false", () => {
+    renderHook(() => useScrollAnimation(targetElement, onEndMock, true, false))
 
     expect(targetElement.addEventListener).not.toHaveBeenCalled()
   })
diff --git a/frontend/lib/src/hooks/useScrollAnimation.ts b/frontend/lib/src/hooks/useScrollAnimation.ts
index b46c51747..66cf3c523 100644
--- a/frontend/lib/src/hooks/useScrollAnimation.ts
+++ b/frontend/lib/src/hooks/useScrollAnimation.ts
@@ -80,7 +80,8 @@ function step(
 export default function useScrollAnimation(
   target: HTMLElement | null,
   onEnd: () => void,
-  isAnimating: boolean
+  isAnimating: boolean,
+  active: boolean
 ): void {
   const animator = useRef(0)
 
@@ -123,7 +124,7 @@ export default function useScrollAnimation(
   }, [onEnd])
 
   useLayoutEffect(() => {
-    if (!target || !isAnimating) {
+    if (!target || !isAnimating || !active) {
       return
     }
     animate(target.scrollTop, 1)
@@ -144,5 +145,5 @@ export default function useScrollAnimation(
     }
 
     return () => cancelAnimationFrame(animator.current)
-  }, [animate, animator, handleCancelAnimation, target, isAnimating])
+  }, [animate, animator, handleCancelAnimation, target, isAnimating, active])
 }
diff --git a/frontend/lib/src/hooks/useScrollSpy.test.ts b/frontend/lib/src/hooks/useScrollSpy.test.ts
index 1e4457aa1..c67a1f759 100644
--- a/frontend/lib/src/hooks/useScrollSpy.test.ts
+++ b/frontend/lib/src/hooks/useScrollSpy.test.ts
@@ -89,7 +89,9 @@ describe("useScrollSpy hook", () => {
   })
 
   it("should set up and clean up event listeners", () => {
-    const { unmount } = renderHook(() => useScrollSpy(target, eventHandler))
+    const { unmount } = renderHook(() =>
+      useScrollSpy(target, eventHandler, true)
+    )
 
     expect(target.addEventListener).toHaveBeenCalledWith(
       "scroll",
@@ -110,14 +112,21 @@ describe("useScrollSpy hook", () => {
   })
 
   it("should not set up event listeners if no target is provided", () => {
-    renderHook(() => useScrollSpy(null, eventHandler))
+    renderHook(() => useScrollSpy(null, eventHandler, true))
+
+    expect(target.addEventListener).not.toHaveBeenCalled()
+    expect(eventHandler).not.toHaveBeenCalled()
+  })
+
+  it("should not set up event listeners if active is false", () => {
+    renderHook(() => useScrollSpy(target, eventHandler, false))
 
     expect(target.addEventListener).not.toHaveBeenCalled()
     expect(eventHandler).not.toHaveBeenCalled()
   })
 
   it("should debounce events", () => {
-    renderHook(() => useScrollSpy(target, eventHandler))
+    renderHook(() => useScrollSpy(target, eventHandler, true))
 
     const scrollEvent = new Event("scroll")
     act(() => {
diff --git a/frontend/lib/src/hooks/useScrollSpy.ts b/frontend/lib/src/hooks/useScrollSpy.ts
index afae16fc3..49f6a1931 100644
--- a/frontend/lib/src/hooks/useScrollSpy.ts
+++ b/frontend/lib/src/hooks/useScrollSpy.ts
@@ -102,7 +102,8 @@ const DEFAULT_DEBOUNCE_MS = 100
 export default function useScrollSpy(
   target: HTMLElement | null,
   // eslint-disable-next-line @typescript-eslint/no-explicit-any -- TODO: Replace 'any' with a more specific type.
-  eventHandler: ({ timeStampLow }: any) => void
+  eventHandler: ({ timeStampLow }: any) => void,
+  active: boolean
 ): void {
   const onEventRef = useRef(eventHandler)
 
@@ -125,7 +126,7 @@ export default function useScrollSpy(
   )
 
   useLayoutEffect(() => {
-    if (!target) {
+    if (!target || !active) {
       return () => {}
     }
 
@@ -133,5 +134,5 @@ export default function useScrollSpy(
     handleEvent({ target })
 
     return () => target.removeEventListener("scroll", handleEvent)
-  }, [handleEvent, target])
+  }, [handleEvent, target, active])
 }
diff --git a/frontend/lib/src/hooks/useScrollToBottom.test.ts b/frontend/lib/src/hooks/useScrollToBottom.test.ts
index 5e63054b3..7e69778ce 100644
--- a/frontend/lib/src/hooks/useScrollToBottom.test.ts
+++ b/frontend/lib/src/hooks/useScrollToBottom.test.ts
@@ -35,7 +35,7 @@ describe("useScrollToBottom", () => {
       vi.fn(),
       { current: initialValue },
     ])
-    const { result } = renderHook(() => useScrollToBottom())
+    const { result } = renderHook(() => useScrollToBottom(true))
 
     expect(result.current).not.toBeNull()
     expect(result.current.current).toBeNull()
diff --git a/frontend/lib/src/hooks/useScrollToBottom.ts b/frontend/lib/src/hooks/useScrollToBottom.ts
index 65eee1cd4..72aacadce 100644
--- a/frontend/lib/src/hooks/useScrollToBottom.ts
+++ b/frontend/lib/src/hooks/useScrollToBottom.ts
@@ -64,7 +64,9 @@ function isAtBottom({
  * - The second effect attaches a focus event listener to update
  *   the scrollHeight value.
  */
-export function useScrollToBottom<T extends HTMLElement>(): RefObject<T> {
+export function useScrollToBottom<T extends HTMLElement>(
+  active: boolean
+): RefObject<T> {
   const scrollableRef = useRef<T>(null)
   const [isSticky, setIsSticky, isStickyRef] = useStateRef(false)
   const [isAnimating, setIsAnimating, isAnimatingRef] = useStateRef(true)
@@ -163,7 +165,7 @@ export function useScrollToBottom<T extends HTMLElement>(): RefObject<T> {
   )
 
   useEffect(() => {
-    if (scrollableRef.current) {
+    if (scrollableRef.current && active) {
       let stickyButNotAtEndSince = 0
 
       const timeout = setImmediateInterval(() => {
@@ -216,6 +218,7 @@ export function useScrollToBottom<T extends HTMLElement>(): RefObject<T> {
     isStickyRef,
     setIsSticky,
     setIsAnimating,
+    active,
   ])
 
   useEffect(() => {
@@ -229,7 +232,7 @@ export function useScrollToBottom<T extends HTMLElement>(): RefObject<T> {
     //   Since the "scrollHeight" is not latest value, this "scroll" event will be ignored and stickiness will not be modified.
     // - That means, if the user "focus" to a newly added element that is at the end of the scroll view, the "scroll to bottom" button will continue to show.
     const target = scrollableRef.current
-    if (target) {
+    if (target && active) {
       const handleFocus = (): void => {
         scrollHeightRef.current = target.scrollHeight
       }
@@ -243,13 +246,14 @@ export function useScrollToBottom<T extends HTMLElement>(): RefObject<T> {
         target.removeEventListener("focus", handleFocus, { capture: true })
       }
     }
-  }, [scrollableRef])
+  }, [scrollableRef, active])
 
-  useScrollSpy(scrollableRef.current, handleScroll)
+  useScrollSpy(scrollableRef.current, handleScroll, active)
   useScrollAnimation(
     scrollableRef.current,
     handleScrollToBottomFinished,
-    isAnimating
+    isAnimating,
+    active
   )
 
   return scrollableRef
diff --git a/lib/streamlit/elements/code.py b/lib/streamlit/elements/code.py
index 63cad6bd6..e279101bf 100644
--- a/lib/streamlit/elements/code.py
+++ b/lib/streamlit/elements/code.py
@@ -15,9 +15,10 @@
 from __future__ import annotations
 
 import re
-from typing import TYPE_CHECKING, Literal, cast
+from typing import TYPE_CHECKING, cast
 
 from streamlit.elements.lib.layout_utils import (
+    Height,
     LayoutConfig,
     WidthWithoutContent,
     validate_height,
@@ -40,7 +41,7 @@ class CodeMixin:
         *,
         line_numbers: bool = False,
         wrap_lines: bool = False,
-        height: int | Literal["content"] | None = "content",
+        height: Height | None = "content",
         width: WidthWithoutContent = "stretch",
     ) -> DeltaGenerator:
         """Display a code block with optional syntax highlighting.
diff --git a/lib/streamlit/elements/form.py b/lib/streamlit/elements/form.py
index 4b0bbe7b4..d1d7c7ede 100644
--- a/lib/streamlit/elements/form.py
+++ b/lib/streamlit/elements/form.py
@@ -18,6 +18,7 @@ from typing import TYPE_CHECKING, Literal, cast
 
 from streamlit.elements.lib.form_utils import FormData, current_form_id, is_in_form
 from streamlit.elements.lib.layout_utils import (
+    Height,
     Width,
     get_height_config,
     get_width_config,
@@ -75,7 +76,7 @@ class FormMixin:
         enter_to_submit: bool = True,
         border: bool = True,
         width: Width = "stretch",
-        height: int | Literal["content"] = "content",
+        height: Height = "content",
     ) -> DeltaGenerator:
         """Create a form that batches elements together with a "Submit" button.
 
diff --git a/lib/tests/streamlit/elements/code_test.py b/lib/tests/streamlit/elements/code_test.py
index c848fc407..2412e2f29 100644
--- a/lib/tests/streamlit/elements/code_test.py
+++ b/lib/tests/streamlit/elements/code_test.py
@@ -212,6 +212,19 @@ class CodeElement(DeltaGeneratorTestCase):
         )
         assert element.height_config.use_content
 
+    def test_st_code_with_height_stretch(self):
+        """Test st.code with stretch height."""
+        code = "print('My string = %d' % my_value)"
+        st.code(code, height="stretch")
+
+        element = self.get_delta_from_queue().new_element
+        assert element.code.code_text == code
+        assert (
+            element.height_config.WhichOneof("height_spec")
+            == HeightConfigFields.USE_STRETCH.value
+        )
+        assert element.height_config.use_stretch
+
     @parameterized.expand(["invalid", -100, 0, 100.5])
     def test_st_code_with_invalid_height(self, height):
         """Test st.code with invalid height values."""
diff --git a/lib/tests/streamlit/form_test.py b/lib/tests/streamlit/form_test.py
index a4e2ee852..8f5027cb3 100644
--- a/lib/tests/streamlit/form_test.py
+++ b/lib/tests/streamlit/form_test.py
@@ -478,6 +478,16 @@ class FormDimensionsTest(DeltaGeneratorTestCase):
         assert form_proto.form.form_id == "form_with_content"
         assert form_proto.height_config.use_content
 
+    def test_form_with_stretch_height(self):
+        """Test form with stretch height."""
+        with st.form("form_with_stretch", height="stretch"):
+            st.text_input("Input")
+            st.form_submit_button("Submit")
+
+        form_proto = self.get_delta_from_queue(0).add_block
+        assert form_proto.form.form_id == "form_with_stretch"
+        assert form_proto.height_config.use_stretch
+
     @parameterized.expand(
         [
             ("invalid", "invalid"),
