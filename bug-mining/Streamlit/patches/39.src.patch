diff --git a/e2e/specs/st_columns_layout.spec.js b/e2e/specs/st_columns_layout.spec.js
deleted file mode 100644
index cf37db79b..000000000
--- a/e2e/specs/st_columns_layout.spec.js
+++ /dev/null
@@ -1,41 +0,0 @@
-/**
- * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-describe("st.columns layout", () => {
-  it("shows columns horizontally when viewport > 640", () => {
-    cy.viewport(641, 800);
-    cy.loadApp("http://localhost:3000/");
-
-    cy.get("[data-testid='stHorizontalBlock']")
-      .first()
-      .matchImageSnapshot("columns-layout-horizontal");
-  });
-
-  it("stacks columns vertically when viewport <= 640", () => {
-    cy.viewport(640, 800);
-    cy.loadApp("http://localhost:3000/");
-
-    cy.getIndexed("[data-testid='stHorizontalBlock']", 0).matchImageSnapshot(
-      "columns-layout-vertical"
-    );
-  });
-
-  it("still takes up space with no elements present", () => {
-    cy.getIndexed("[data-testid='stHorizontalBlock']", 1).matchImageSnapshot(
-      "columns-with-one-element"
-    );
-  });
-});
diff --git a/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[chromium].png b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[chromium].png
new file mode 100644
index 000000000..3fd4328c7
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[firefox].png b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[firefox].png
new file mode 100644
index 000000000..14f626138
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[webkit].png b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[webkit].png
new file mode 100644
index 000000000..85d5e9c1a
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/responsive_test/page_fullscreen_button_edge_case[webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-chromium].png
new file mode 100644
index 000000000..3e83c4a00
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-firefox].png
new file mode 100644
index 000000000..22e842f15
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-webkit].png
new file mode 100644
index 000000000..c31fad05c
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-chromium].png
new file mode 100644
index 000000000..49902920d
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-firefox].png
new file mode 100644
index 000000000..6378ad358
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-webkit].png
new file mode 100644
index 000000000..1cb7d69e0
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-horizontal[light_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-chromium].png
new file mode 100644
index 000000000..5e1b52cea
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-firefox].png
new file mode 100644
index 000000000..fb8a2e3cd
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-webkit].png
new file mode 100644
index 000000000..a285b593f
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-chromium].png
new file mode 100644
index 000000000..b8ab221f3
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-firefox].png
new file mode 100644
index 000000000..21ef61d19
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-webkit].png
new file mode 100644
index 000000000..ac3892857
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-layout-vertical[light_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-chromium].png
new file mode 100644
index 000000000..014d60a01
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-firefox].png
new file mode 100644
index 000000000..790bd9f4e
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-webkit].png
new file mode 100644
index 000000000..ba83e833c
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[dark_theme-webkit].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-chromium].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-chromium].png
new file mode 100644
index 000000000..29facb74d
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-chromium].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-firefox].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-firefox].png
new file mode 100644
index 000000000..660b7076a
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-firefox].png differ
diff --git a/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-webkit].png b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-webkit].png
new file mode 100644
index 000000000..eacc514c8
Binary files /dev/null and b/e2e_playwright/__snapshots__/linux/st_columns_layout_test/columns-with-one-element[light_theme-webkit].png differ
diff --git a/e2e_playwright/responsive.py b/e2e_playwright/responsive.py
new file mode 100644
index 000000000..80510b2ae
--- /dev/null
+++ b/e2e_playwright/responsive.py
@@ -0,0 +1,20 @@
+# Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import numpy as np
+
+import streamlit as st
+
+img = np.repeat(0, 3000 * 800).reshape(800, 3000)
+st.image(img)
diff --git a/e2e_playwright/responsive_test.py b/e2e_playwright/responsive_test.py
new file mode 100644
index 000000000..d92017cdc
--- /dev/null
+++ b/e2e_playwright/responsive_test.py
@@ -0,0 +1,28 @@
+# Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+from playwright.sync_api import Page, expect
+
+from e2e_playwright.conftest import ImageCompareFunction
+
+
+def test_fullscreen_button_edge_case(app: Page, assert_snapshot: ImageCompareFunction):
+    """Test that window doesn't oveflow with window"""
+    app.set_viewport_size({"width": 780, "height": 400})
+    image = app.get_by_test_id("stFullScreenFrame")
+    expect(image).to_have_count(1)
+    image.hover()
+    expect(app.get_by_test_id("StyledFullScreenButton")).to_have_css("opacity", "1")
+
+    assert_snapshot(app, name="page_fullscreen_button_edge_case")
diff --git a/e2e/scripts/st_columns_layout.py b/e2e_playwright/st_columns_layout.py
similarity index 100%
rename from e2e/scripts/st_columns_layout.py
rename to e2e_playwright/st_columns_layout.py
diff --git a/e2e_playwright/st_columns_layout_test.py b/e2e_playwright/st_columns_layout_test.py
new file mode 100644
index 000000000..df51f3ac2
--- /dev/null
+++ b/e2e_playwright/st_columns_layout_test.py
@@ -0,0 +1,49 @@
+# Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+from playwright.sync_api import Page, expect
+
+from e2e_playwright.conftest import ImageCompareFunction
+
+
+def test_show_columns_horizontally_when_viewport_allows(
+    themed_app: Page, assert_snapshot: ImageCompareFunction
+):
+    """shows columns horizontally when viewport > 640"""
+    themed_app.set_viewport_size({"width": 641, "height": 800})
+    horizontal_blocks = themed_app.get_by_test_id("stHorizontalBlock")
+    expect(horizontal_blocks).to_have_count(2)
+
+    assert_snapshot(horizontal_blocks.nth(0), name="columns-layout-horizontal")
+
+
+def test_show_columns_vertically_when_viewport_requires(
+    themed_app: Page, assert_snapshot: ImageCompareFunction
+):
+    """stacks columns vertically when viewport <= 640"""
+    themed_app.set_viewport_size({"width": 640, "height": 800})
+    horizontal_blocks = themed_app.get_by_test_id("stHorizontalBlock")
+    expect(horizontal_blocks).to_have_count(2)
+
+    assert_snapshot(horizontal_blocks.nth(0), name="columns-layout-vertical")
+
+
+def test_columns_always_take_up_space(
+    themed_app: Page, assert_snapshot: ImageCompareFunction
+):
+    """columns still takes up space with no elements present"""
+    horizontal_blocks = themed_app.get_by_test_id("stHorizontalBlock")
+    expect(horizontal_blocks).to_have_count(2)
+
+    assert_snapshot(horizontal_blocks.nth(1), name="columns-with-one-element")
diff --git a/frontend/app/src/components/AppView/AppView.tsx b/frontend/app/src/components/AppView/AppView.tsx
index 3b32a444b..667888036 100644
--- a/frontend/app/src/components/AppView/AppView.tsx
+++ b/frontend/app/src/components/AppView/AppView.tsx
@@ -129,7 +129,7 @@ function AppView(props: AppViewProps): ReactElement {
     toastAdjustment,
   } = React.useContext(AppContext)
 
-  const { addScriptFinishedHandler, removeScriptFinishedHandler } =
+  const { addScriptFinishedHandler, removeScriptFinishedHandler, libConfig } =
     React.useContext(LibContext)
 
   const layout = wideMode ? "wide" : "narrow"
@@ -225,6 +225,7 @@ function AppView(props: AppViewProps): ReactElement {
           hasBottom={hasBottomElements}
           isEmbedded={embedded}
           hasSidebar={showSidebar}
+          disableFullscreenMode={Boolean(libConfig.disableFullscreenMode)}
         >
           {renderBlock(elements.main)}
         </StyledAppViewBlockContainer>
diff --git a/frontend/app/src/components/AppView/styled-components.ts b/frontend/app/src/components/AppView/styled-components.ts
index caef95109..18a788dc4 100644
--- a/frontend/app/src/components/AppView/styled-components.ts
+++ b/frontend/app/src/components/AppView/styled-components.ts
@@ -96,6 +96,7 @@ export interface StyledAppViewBlockContainerProps {
   isWideMode: boolean
   showPadding: boolean
   addPaddingForHeader: boolean
+  disableFullscreenMode: boolean
   hasBottom: boolean
 }
 
@@ -108,6 +109,7 @@ export const StyledAppViewBlockContainer =
       isWideMode,
       showPadding,
       addPaddingForHeader,
+      disableFullscreenMode,
       theme,
     }) => {
       let topEmbedPadding: string = showPadding ? "6rem" : "2.1rem"
@@ -120,6 +122,24 @@ export const StyledAppViewBlockContainer =
       const bottomEmbedPadding =
         showPadding && !hasBottom ? "10rem" : theme.spacing.lg
       const wideSidePadding = isWideMode ? "5rem" : theme.spacing.lg
+
+      // Full screen-enabled elements can overflow the page when the screen
+      // size is slightly over the content max width.
+      // 50rem = contentMaxWidth + 2 * 2rem (size of button as margin)
+      // We use 0.5 to give a little extra space for a scrollbar that takes
+      // space like safari and avoid scrollbar jitter.
+      //
+      // See https://github.com/streamlit/streamlit/issues/6990
+      // TODO: Remove this workaround when we migrated to the new fullscreen buttons
+      const shouldHandleFullScreenButton =
+        !isWideMode && !disableFullscreenMode
+      const fullScreenButtonStyles = shouldHandleFullScreenButton
+        ? {
+            [`@media (max-width: 50.5rem)`]: {
+              maxWidth: `calc(100vw - 4.5rem)`,
+            },
+          }
+        : {}
       return {
         width: theme.sizes.full,
         paddingLeft: theme.spacing.lg,
@@ -134,6 +154,8 @@ export const StyledAppViewBlockContainer =
         minWidth: isWideMode ? "auto" : undefined,
         maxWidth: isWideMode ? "initial" : theme.sizes.contentMaxWidth,
 
+        ...fullScreenButtonStyles,
+
         [`@media print`]: {
           minWidth: "100%",
           paddingTop: 0,
diff --git a/frontend/lib/src/components/shared/FullScreenWrapper/FullScreenWrapper.tsx b/frontend/lib/src/components/shared/FullScreenWrapper/FullScreenWrapper.tsx
index 22a494e0c..7b94e9388 100644
--- a/frontend/lib/src/components/shared/FullScreenWrapper/FullScreenWrapper.tsx
+++ b/frontend/lib/src/components/shared/FullScreenWrapper/FullScreenWrapper.tsx
@@ -151,7 +151,7 @@ class FullScreenWrapper extends PureComponent<FullScreenWrapperProps, State> {
       >
         {!disableFullscreenMode && (
           <StyledFullScreenButton
-            data-testid={"StyledFullScreenButton"}
+            data-testid="StyledFullScreenButton"
             onClick={buttonOnClick}
             title={buttonTitle}
             isExpanded={expanded}
