{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9848","repository_url":"https://api.github.com/repos/streamlit/streamlit","labels_url":"https://api.github.com/repos/streamlit/streamlit/issues/9848/labels{/name}","comments_url":"https://api.github.com/repos/streamlit/streamlit/issues/9848/comments","events_url":"https://api.github.com/repos/streamlit/streamlit/issues/9848/events","html_url":"https://github.com/streamlit/streamlit/issues/9848","id":2652314514,"node_id":"I_kwDODCoeTs6eFxuS","number":9848,"title":"Community Cloud customizations missing in Firefox (st.navigation URLs broken, no custom menu items)","user":{"login":"sfc-gh-mgolebiowskiowczarek","id":167206877,"node_id":"U_kgDOCfdf3Q","avatar_url":"https://avatars.githubusercontent.com/u/167206877?v=4","gravatar_id":"","url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek","html_url":"https://github.com/sfc-gh-mgolebiowskiowczarek","followers_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/followers","following_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/following{/other_user}","gists_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/gists{/gist_id}","starred_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/subscriptions","organizations_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/orgs","repos_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/repos","events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/events{/privacy}","received_events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1516285324,"node_id":"MDU6TGFiZWwxNTE2Mjg1MzI0","url":"https://api.github.com/repos/streamlit/streamlit/labels/type:bug","name":"type:bug","color":"D93F0B","default":false,"description":"Something isn't working"},{"id":3022365121,"node_id":"MDU6TGFiZWwzMDIyMzY1MTIx","url":"https://api.github.com/repos/streamlit/streamlit/labels/status:confirmed","name":"status:confirmed","color":"FEF2C0","default":false,"description":"Bug has been confirmed by the Streamlit team"},{"id":3230107623,"node_id":"MDU6TGFiZWwzMjMwMTA3NjIz","url":"https://api.github.com/repos/streamlit/streamlit/labels/priority:P3","name":"priority:P3","color":"ff4b4b","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"sfc-gh-mgolebiowskiowczarek","id":167206877,"node_id":"U_kgDOCfdf3Q","avatar_url":"https://avatars.githubusercontent.com/u/167206877?v=4","gravatar_id":"","url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek","html_url":"https://github.com/sfc-gh-mgolebiowskiowczarek","followers_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/followers","following_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/following{/other_user}","gists_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/gists{/gist_id}","starred_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/subscriptions","organizations_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/orgs","repos_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/repos","events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/events{/privacy}","received_events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sfc-gh-mgolebiowskiowczarek","id":167206877,"node_id":"U_kgDOCfdf3Q","avatar_url":"https://avatars.githubusercontent.com/u/167206877?v=4","gravatar_id":"","url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek","html_url":"https://github.com/sfc-gh-mgolebiowskiowczarek","followers_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/followers","following_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/following{/other_user}","gists_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/gists{/gist_id}","starred_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/subscriptions","organizations_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/orgs","repos_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/repos","events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/events{/privacy}","received_events_url":"https://api.github.com/users/sfc-gh-mgolebiowskiowczarek/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2024-11-12T14:13:46Z","updated_at":"2024-11-18T13:29:24Z","closed_at":"2024-11-15T17:46:34Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Checklist\n\n- [X] I have searched the [existing issues](https://github.com/streamlit/streamlit/issues) for similar issues.\n- [X] I added a very descriptive title to this issue.\n- [X] I have provided sufficient information below to help reproduce this issue.\n\n### Summary\n\nWhen running a Streamlit app in Community Cloud in Firefox (tested 132.0.1 on macOS Sequoia), CC customizations do not apply. For example:\r\n1. The Fork & GitHub buttons are missing in the top menu.\r\n2. When using `st.navigation`, when you inspect URLs of the pages, in Firefox they will look like https://my-app.streamlit.app/~/+/page_2 - the `/~/+` prefix should not be there - CC sends a `SET_PAGE_LINK_BASE_URL` message to set `pageLinkBaseUrl` to `https://my-app.streamlit.app`.\n\n### Reproducible Code Example\n\n```Python\nimport streamlit as st\r\n\r\npages = {\r\n    \"Section 1\": [\r\n        st.Page(\"page_1.py\", title=\"Page 1\"),\r\n        st.Page(\"page_2.py\", title=\"Page 2\"),\r\n    ],\r\n    \"Section 2\": [\r\n        st.Page(\"page_3.py\", title=\"Page 3\"),\r\n        st.Page(\"page_4.py\", title=\"Page 4\"),\r\n    ],\r\n}\r\n\r\npg = st.navigation(pages)\r\npg.run()\n```\n\n\n### Steps To Reproduce\n\n1. Create a file named \"streamlit_app.py\" app from the code above. Create `page_1.py` etc. with any content. You can also clone https://github.com/sfc-gh-mgolebiowskiowczarek/streamlit-navigation-test-app/blob/main/streamlit_app.py instead.\r\n2. Deploy it in CC (https://share.streamlit.io)\r\n3. Open the deployed app in Firefox.\r\n\n\n### Expected Behavior\n\n1. Right click on a link to \"Page 2\", look at the URL. Its pathname part should just be `part_2`.\r\n2. The Fork & GitHub buttons should be present in the top right menu.\n\n### Current Behavior\n\n1. Right click on a link to \"Page 2\", see it contains `/~/+` at the beginning of the path part.\r\n2. See that there's no Fork button or the GitHub button at the top-right of the page.\n\n### Is this a regression?\n\n- [ ] Yes, this used to work in a previous version.\n\n### Debug info\n\n- Streamlit version: 1.40.1\r\n- Python version: 3.11.x\r\n- Operating System: macOS Sequoia 14.7.1 (23H222)\r\n- Browser: Firefox 132.0.1 \r\n\n\n### Additional Information\n\nThe cause is that Firefox doesn't receive messages from Community Cloud. Messages are sent but Streamlit then validates the domain against supported ones. It does so by wrapping the pattern in the `URL` constructor. The problem is, `new URL(\"https://*.streamlit.apptest\")` crashes in Firefox with:\r\n```\r\nUncaught TypeError: URL constructor: https://*.streamlit.apptest is not a valid URL.\r\n```","closed_by":{"login":"kmcgrady","id":69432,"node_id":"MDQ6VXNlcjY5NDMy","avatar_url":"https://avatars.githubusercontent.com/u/69432?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcgrady","html_url":"https://github.com/kmcgrady","followers_url":"https://api.github.com/users/kmcgrady/followers","following_url":"https://api.github.com/users/kmcgrady/following{/other_user}","gists_url":"https://api.github.com/users/kmcgrady/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcgrady/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcgrady/subscriptions","organizations_url":"https://api.github.com/users/kmcgrady/orgs","repos_url":"https://api.github.com/users/kmcgrady/repos","events_url":"https://api.github.com/users/kmcgrady/events{/privacy}","received_events_url":"https://api.github.com/users/kmcgrady/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9848/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/streamlit/streamlit/issues/9848/timeline","performed_via_github_app":null,"state_reason":"completed"}