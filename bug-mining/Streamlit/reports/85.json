{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9841","repository_url":"https://api.github.com/repos/streamlit/streamlit","labels_url":"https://api.github.com/repos/streamlit/streamlit/issues/9841/labels{/name}","comments_url":"https://api.github.com/repos/streamlit/streamlit/issues/9841/comments","events_url":"https://api.github.com/repos/streamlit/streamlit/issues/9841/events","html_url":"https://github.com/streamlit/streamlit/issues/9841","id":2650516383,"node_id":"I_kwDODCoeTs6d-6uf","number":9841,"title":"Lagged session state management in st.form","user":{"login":"rgodbey-rev","id":181754675,"node_id":"U_kgDOCtVbMw","avatar_url":"https://avatars.githubusercontent.com/u/181754675?v=4","gravatar_id":"","url":"https://api.github.com/users/rgodbey-rev","html_url":"https://github.com/rgodbey-rev","followers_url":"https://api.github.com/users/rgodbey-rev/followers","following_url":"https://api.github.com/users/rgodbey-rev/following{/other_user}","gists_url":"https://api.github.com/users/rgodbey-rev/gists{/gist_id}","starred_url":"https://api.github.com/users/rgodbey-rev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rgodbey-rev/subscriptions","organizations_url":"https://api.github.com/users/rgodbey-rev/orgs","repos_url":"https://api.github.com/users/rgodbey-rev/repos","events_url":"https://api.github.com/users/rgodbey-rev/events{/privacy}","received_events_url":"https://api.github.com/users/rgodbey-rev/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1516285324,"node_id":"MDU6TGFiZWwxNTE2Mjg1MzI0","url":"https://api.github.com/repos/streamlit/streamlit/labels/type:bug","name":"type:bug","color":"D93F0B","default":false,"description":"Something isn't working"},{"id":3022365121,"node_id":"MDU6TGFiZWwzMDIyMzY1MTIx","url":"https://api.github.com/repos/streamlit/streamlit/labels/status:confirmed","name":"status:confirmed","color":"FEF2C0","default":false,"description":"Bug has been confirmed by the Streamlit team"},{"id":3230105890,"node_id":"MDU6TGFiZWwzMjMwMTA1ODkw","url":"https://api.github.com/repos/streamlit/streamlit/labels/priority:P2","name":"priority:P2","color":"ff4b4b","default":false,"description":""},{"id":4078156025,"node_id":"LA_kwDODCoeTs7zE7j5","url":"https://api.github.com/repos/streamlit/streamlit/labels/feature:st.form","name":"feature:st.form","color":"C5DEF5","default":false,"description":""},{"id":4647798379,"node_id":"LA_kwDODCoeTs8AAAABFQfGaw","url":"https://api.github.com/repos/streamlit/streamlit/labels/feature:st.text_area","name":"feature:st.text_area","color":"C5DEF5","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2024-11-11T22:15:00Z","updated_at":"2024-11-13T12:00:20Z","closed_at":"2024-11-13T12:00:20Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Checklist\r\n\r\n- [X] I have searched the [existing issues](https://github.com/streamlit/streamlit/issues) for similar issues.\r\n- [X] I added a very descriptive title to this issue.\r\n- [X] I have provided sufficient information below to help reproduce this issue.\r\n\r\n### Summary\r\n\r\n\r\nUsing Streamlit 1.40.0 and Python 3.11.10, I seemed to have encountered a bug with st.text_area inside of st.form. Below is my code:\r\n```\r\nimport streamlit as st\r\n\r\nwith st.form(\"form\"):\r\n    test_text = st.text_area(\"test\", key=\"test input\")\r\n    submitted = st.form_submit_button(\"submit\")\r\n\r\nif submitted:\r\n    st.write(st.session_state)\r\n```\r\n\r\nWhat I would expect, per the behavior in previous streamlit versions, is when I ctrl+enter, it updates session state as you would expect it to while submitting the form. However it seems to be delayed. If you write in the text box, ctrl enter, it will have no text. You would have to edit the text again, then ctrl enter again, to get the text from the first edit.\r\n\r\n### Reproducible Code Example\r\n\r\n[![Open in Streamlit Cloud](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://issues.streamlitapp.com/?issue=gh-9841)\r\n\r\n```Python\r\nimport streamlit as st\r\n\r\nwith st.form(\"form\"):\r\n    test_text = st.text_area(\"test\", key=\"test input\")\r\n    submitted = st.form_submit_button(\"submit\")\r\n\r\nif submitted:\r\n    st.write(st.session_state)\r\n```\r\n\r\n\r\n### Steps To Reproduce\r\n\r\n1. Type in the form; hit ctrl + enter.\r\n2. Change the text in the box; hit ctrl + enter.\r\n\r\n### Expected Behavior\r\n\r\n_No response_\r\n\r\n### Current Behavior\r\n\r\n![image](https://github.com/user-attachments/assets/5537a0c6-6b38-4287-99a3-db77735eb231)\r\n\r\n\r\n### Is this a regression?\r\n\r\n- [X] Yes, this used to work in a previous version.\r\n\r\n### Debug info\r\n\r\n- Streamlit version: 1.40.0\r\n- Python version: 3.11\r\n- Operating System: WSL (Ubuntu 22)\r\n- Browser: Chrome in windows\r\n\r\n\r\n### Additional Information\r\n\r\n_No response_","closed_by":{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9841/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/streamlit/streamlit/issues/9841/timeline","performed_via_github_app":null,"state_reason":"completed"}