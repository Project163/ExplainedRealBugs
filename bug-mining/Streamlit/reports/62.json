{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9063","repository_url":"https://api.github.com/repos/streamlit/streamlit","labels_url":"https://api.github.com/repos/streamlit/streamlit/issues/9063/labels{/name}","comments_url":"https://api.github.com/repos/streamlit/streamlit/issues/9063/comments","events_url":"https://api.github.com/repos/streamlit/streamlit/issues/9063/events","html_url":"https://github.com/streamlit/streamlit/issues/9063","id":2399634522,"node_id":"I_kwDODCoeTs6PB4Ra","number":9063,"title":"close a slow dialog may have chance to break the whole ui","user":{"login":"link89","id":3314130,"node_id":"MDQ6VXNlcjMzMTQxMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3314130?v=4","gravatar_id":"","url":"https://api.github.com/users/link89","html_url":"https://github.com/link89","followers_url":"https://api.github.com/users/link89/followers","following_url":"https://api.github.com/users/link89/following{/other_user}","gists_url":"https://api.github.com/users/link89/gists{/gist_id}","starred_url":"https://api.github.com/users/link89/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/link89/subscriptions","organizations_url":"https://api.github.com/users/link89/orgs","repos_url":"https://api.github.com/users/link89/repos","events_url":"https://api.github.com/users/link89/events{/privacy}","received_events_url":"https://api.github.com/users/link89/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1516285324,"node_id":"MDU6TGFiZWwxNTE2Mjg1MzI0","url":"https://api.github.com/repos/streamlit/streamlit/labels/type:bug","name":"type:bug","color":"D93F0B","default":false,"description":"Something isn't working"},{"id":3022365121,"node_id":"MDU6TGFiZWwzMDIyMzY1MTIx","url":"https://api.github.com/repos/streamlit/streamlit/labels/status:confirmed","name":"status:confirmed","color":"FEF2C0","default":false,"description":"Bug has been confirmed by the Streamlit team"},{"id":3230105890,"node_id":"MDU6TGFiZWwzMjMwMTA1ODkw","url":"https://api.github.com/repos/streamlit/streamlit/labels/priority:P2","name":"priority:P2","color":"ff4b4b","default":false,"description":""},{"id":6666807362,"node_id":"LA_kwDODCoeTs8AAAABjV9oQg","url":"https://api.github.com/repos/streamlit/streamlit/labels/feature:st.dialog","name":"feature:st.dialog","color":"c5def5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-07-10T02:54:45Z","updated_at":"2024-07-15T20:19:30Z","closed_at":"2024-07-15T20:19:30Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Checklist\n\n- [X] I have searched the [existing issues](https://github.com/streamlit/streamlit/issues) for similar issues.\n- [X] I added a very descriptive title to this issue.\n- [X] I have provided sufficient information below to help reproduce this issue.\n\n### Summary\n\nWhen a dialog contain some slow method (takes about 1s) before using `st.rerun` to close the dialog , there are chance that the whole ui is being render into the dialog. As you can see in the recording, the page in the background become blank and the content is in dialog when cilck close\r\n\r\nhttps://www.loom.com/share/d6fcd84f27fc4a288ac778d6775c4cac\r\n\n\n### Reproducible Code Example\n\n```Python\nimport streamlit as st\r\nimport time\r\n\r\n@st.experimental_dialog('slow dialog')\r\ndef slow_dialog():\r\n\r\n    st.text_input('text')\r\n    time.sleep(1)\r\n    if st.button('Close'):\r\n        st.session_state['data'] = 'fake data'\r\n        st.rerun()\r\n\r\n\r\nif 'data' not in st.session_state:\r\n    st.session_state['data'] = 'no data'\r\n\r\nfor i in range(5):\r\n    st.number_input(f'input 2 {i}')\r\n\r\nst.write(st.session_state['data'])\r\n\r\nif st.button('open slow dialog'):\r\n    slow_dialog()\n```\n\n\n### Steps To Reproduce\n\n1. open dialog\r\n2. type something in text input  **Key point: don't press enter or lost focus of text input**\r\n3. click close button as fast as you can\r\n\r\nWhen you execute this sequence, the dialog will be render twice: one is trigger by text_input lost focus, and the other is trigger by click the the close button. They are happening almost at the same time which create a race condition to reproduce the bug.\n\n### Expected Behavior\n\n_No response_\n\n### Current Behavior\n\n_No response_\n\n### Is this a regression?\n\n- [ ] Yes, this used to work in a previous version.\n\n### Debug info\n\n- Streamlit version: 1.36.0\r\n- Python version: 3.9\r\n- Operating System: ubuntu in windows wsl2\r\n- Browser: ms edge\r\n\n\n### Additional Information\n\n_No response_","closed_by":{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/streamlit/streamlit/issues/9063/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/streamlit/streamlit/issues/9063/timeline","performed_via_github_app":null,"state_reason":"completed"}