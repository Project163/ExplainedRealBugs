{"url":"https://api.github.com/repos/streamlit/streamlit/issues/3512","repository_url":"https://api.github.com/repos/streamlit/streamlit","labels_url":"https://api.github.com/repos/streamlit/streamlit/issues/3512/labels{/name}","comments_url":"https://api.github.com/repos/streamlit/streamlit/issues/3512/comments","events_url":"https://api.github.com/repos/streamlit/streamlit/issues/3512/events","html_url":"https://github.com/streamlit/streamlit/issues/3512","id":937295527,"node_id":"MDU6SXNzdWU5MzcyOTU1Mjc=","number":3512,"title":"Discrepancy between value shown and value returned by widged when it is redisplayed","user":{"login":"clo-vis","id":25638902,"node_id":"MDQ6VXNlcjI1NjM4OTAy","avatar_url":"https://avatars.githubusercontent.com/u/25638902?v=4","gravatar_id":"","url":"https://api.github.com/users/clo-vis","html_url":"https://github.com/clo-vis","followers_url":"https://api.github.com/users/clo-vis/followers","following_url":"https://api.github.com/users/clo-vis/following{/other_user}","gists_url":"https://api.github.com/users/clo-vis/gists{/gist_id}","starred_url":"https://api.github.com/users/clo-vis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clo-vis/subscriptions","organizations_url":"https://api.github.com/users/clo-vis/orgs","repos_url":"https://api.github.com/users/clo-vis/repos","events_url":"https://api.github.com/users/clo-vis/events{/privacy}","received_events_url":"https://api.github.com/users/clo-vis/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1516285324,"node_id":"MDU6TGFiZWwxNTE2Mjg1MzI0","url":"https://api.github.com/repos/streamlit/streamlit/labels/type:bug","name":"type:bug","color":"D93F0B","default":false,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"vdonato","id":3144420,"node_id":"MDQ6VXNlcjMxNDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/3144420?v=4","gravatar_id":"","url":"https://api.github.com/users/vdonato","html_url":"https://github.com/vdonato","followers_url":"https://api.github.com/users/vdonato/followers","following_url":"https://api.github.com/users/vdonato/following{/other_user}","gists_url":"https://api.github.com/users/vdonato/gists{/gist_id}","starred_url":"https://api.github.com/users/vdonato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdonato/subscriptions","organizations_url":"https://api.github.com/users/vdonato/orgs","repos_url":"https://api.github.com/users/vdonato/repos","events_url":"https://api.github.com/users/vdonato/events{/privacy}","received_events_url":"https://api.github.com/users/vdonato/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"vdonato","id":3144420,"node_id":"MDQ6VXNlcjMxNDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/3144420?v=4","gravatar_id":"","url":"https://api.github.com/users/vdonato","html_url":"https://github.com/vdonato","followers_url":"https://api.github.com/users/vdonato/followers","following_url":"https://api.github.com/users/vdonato/following{/other_user}","gists_url":"https://api.github.com/users/vdonato/gists{/gist_id}","starred_url":"https://api.github.com/users/vdonato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdonato/subscriptions","organizations_url":"https://api.github.com/users/vdonato/orgs","repos_url":"https://api.github.com/users/vdonato/repos","events_url":"https://api.github.com/users/vdonato/events{/privacy}","received_events_url":"https://api.github.com/users/vdonato/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":4,"created_at":"2021-07-05T18:25:43Z","updated_at":"2021-07-27T22:17:01Z","closed_at":"2021-07-21T19:48:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Summary\r\n\r\nWhen a widget is redisplayed, the value returned is not the same value the widget shows.\r\n\r\n### Steps to reproduce\r\n\r\nHere an example with multiselect:\r\n\r\n```\r\nimport streamlit\r\n\r\nletter = streamlit.sidebar.radio(\"Letter\", [\"A\", \"B\"])\r\nif letter == \"A\":\r\n    numbers = streamlit.multiselect(\"Number\", [\"1\", \"2\"])\r\nelse:\r\n    numbers = streamlit.multiselect(\"Number\", [\"3\", \"4\"])\r\n\r\nif len(numbers) == 0:\r\n    streamlit.write(\"I didn't compute anything because no number is selected\")\r\nelse:    \r\n    streamlit.write(f\"I started an expensive computation using the chosen letter {letter} and the currently selected numbers {numbers}\")\r\n```\r\n\r\n1. With 'A' selected, select the numbers 1 and 2\r\n2. Change the sidebar selection to 'B', then again to 'A'\r\n\r\n**Expected behavior:**\r\n\r\nEither \r\n1) the multiselect widget is empty and shows \"Select an option\"; the message seen is \"I didn't compute anything because no number is selected\" (which I prefer)\r\nOr\r\n2) the multiselect widget has the last values selected when it was shown the last time (1 and 2) and the message seen is \"I started an expensive computation using the chosen letter A and the currently selected numbers [1, 2]\r\n\r\n**Actual behavior:**\r\n\r\nThe multiselect widget is empty and shows 'Select an option' , but the message seen is \"I started an expensive computation using the chosen letter A and the currently selected numbers [1, 2]\"\r\n\r\n**Workaround**\r\n\r\nTo get the 2nd expected behavior, add the arguments key=\"key\", default = streamlit.session_state[\"key\"]\r\n\r\nTo get the 1st behavior, ü§∑‚Äç‚ôÇÔ∏è\r\n\r\n### Debug info\r\n\r\n- Streamlit version: 0.84.0\r\n- Python version: 3.9.5\r\n- Using Conda\r\n\r\n### Is this a regression?\r\nWith streamlit 0.82.0, I got the behavior (1)","closed_by":{"login":"vdonato","id":3144420,"node_id":"MDQ6VXNlcjMxNDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/3144420?v=4","gravatar_id":"","url":"https://api.github.com/users/vdonato","html_url":"https://github.com/vdonato","followers_url":"https://api.github.com/users/vdonato/followers","following_url":"https://api.github.com/users/vdonato/following{/other_user}","gists_url":"https://api.github.com/users/vdonato/gists{/gist_id}","starred_url":"https://api.github.com/users/vdonato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdonato/subscriptions","organizations_url":"https://api.github.com/users/vdonato/orgs","repos_url":"https://api.github.com/users/vdonato/repos","events_url":"https://api.github.com/users/vdonato/events{/privacy}","received_events_url":"https://api.github.com/users/vdonato/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/streamlit/streamlit/issues/3512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/streamlit/streamlit/issues/3512/timeline","performed_via_github_app":null,"state_reason":"completed"}