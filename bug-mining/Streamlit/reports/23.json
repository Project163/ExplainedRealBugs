{"url":"https://api.github.com/repos/streamlit/streamlit/issues/5661","repository_url":"https://api.github.com/repos/streamlit/streamlit","labels_url":"https://api.github.com/repos/streamlit/streamlit/issues/5661/labels{/name}","comments_url":"https://api.github.com/repos/streamlit/streamlit/issues/5661/comments","events_url":"https://api.github.com/repos/streamlit/streamlit/issues/5661/events","html_url":"https://github.com/streamlit/streamlit/issues/5661","id":1440594472,"node_id":"I_kwDODCoeTs5V3boo","number":5661,"title":"camera_input repeatedly reopens webcam as window width changes (in wide layout)","user":{"login":"kcarnold","id":21072,"node_id":"MDQ6VXNlcjIxMDcy","avatar_url":"https://avatars.githubusercontent.com/u/21072?v=4","gravatar_id":"","url":"https://api.github.com/users/kcarnold","html_url":"https://github.com/kcarnold","followers_url":"https://api.github.com/users/kcarnold/followers","following_url":"https://api.github.com/users/kcarnold/following{/other_user}","gists_url":"https://api.github.com/users/kcarnold/gists{/gist_id}","starred_url":"https://api.github.com/users/kcarnold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcarnold/subscriptions","organizations_url":"https://api.github.com/users/kcarnold/orgs","repos_url":"https://api.github.com/users/kcarnold/repos","events_url":"https://api.github.com/users/kcarnold/events{/privacy}","received_events_url":"https://api.github.com/users/kcarnold/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1516285324,"node_id":"MDU6TGFiZWwxNTE2Mjg1MzI0","url":"https://api.github.com/repos/streamlit/streamlit/labels/type:bug","name":"type:bug","color":"D93F0B","default":false,"description":"Something isn't working"},{"id":3022365121,"node_id":"MDU6TGFiZWwzMDIyMzY1MTIx","url":"https://api.github.com/repos/streamlit/streamlit/labels/status:confirmed","name":"status:confirmed","color":"FEF2C0","default":false,"description":"Bug has been confirmed by the Streamlit team"},{"id":3230107623,"node_id":"MDU6TGFiZWwzMjMwMTA3NjIz","url":"https://api.github.com/repos/streamlit/streamlit/labels/priority:P3","name":"priority:P3","color":"ff4b4b","default":false,"description":""},{"id":4366692428,"node_id":"LA_kwDODCoeTs8AAAABBEZwTA","url":"https://api.github.com/repos/streamlit/streamlit/labels/feature:st.camera_input","name":"feature:st.camera_input","color":"C5DEF5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-08T17:13:40Z","updated_at":"2022-12-02T16:10:40Z","closed_at":"2022-12-02T16:10:40Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Checklist\r\n\r\n- [X] I have searched the [existing issues](https://github.com/streamlit/streamlit/issues) for similar issues.\r\n- [X] I added a very descriptive title to this issue.\r\n- [X] I have provided sufficient information below to help reproduce this issue.\r\n\r\n### Summary\r\n\r\nI set up a wide-layout Streamlit app with two columns, and put a `st.camera_input` in the left column. The positioning was such that when the camera preview appeared it expanded the height enough that a scrollbar appeared. That changed the width of the page (and thus the column containing the camera widget, which (presumably because of the behavior mentioned in https://github.com/streamlit/streamlit/issues/4320) caused the `camera_input` widget to close and reopen the webcam input, hiding the preview in the process. Repeat.\r\n\r\nThis initially appeared as a rapidly jittering page, then as `camera_input` not working at all, and now (as I write this) my MacBook Pro's camera LED is cycling on and off, half an hour or more after closing the Streamlit app and browser that caused this problem. This part is a bug in macOS 12.6.1, which must have some queue of media requests that has way too big a bound, and a bug in Firefox that allows a webpage to spam this queue.\r\n\r\nHowever, even if the macOS and Firefox bugs are fixed, this issue could still result in jitter or unstable image sizes in camera previews in Streamlit.\r\n\r\nUsing a consistent and predictable capture canvas size, as requested in https://github.com/streamlit/streamlit/issues/4320, would readily fix this issue also.\r\n\r\n### Reproducible Code Example\r\n\r\nhttps://issues.streamlit.app/?issue=gh-5661\r\n\r\n### Steps To Reproduce\r\n\r\n```import streamlit as st\r\nfrom PIL import Image\r\n\r\nst.set_page_config(layout=\"wide\")\r\n\r\ncol1, col2 = st.columns(2)\r\n\r\nwith col1:\r\n   img_file_buffer = st.camera_input(\"Take a picture\")\r\n\r\nif img_file_buffer is not None:\r\n    im = Image.open(img_file_buffer)\r\n    st.write(f\"{im.width} x {im.height}\")\r\n\r\nwith col2:\r\n    height = st.number_input(\"height\", value=200, step=10)\r\n    st.write(f'<div style=\"border: 5px solid red; height: {height}px\">Adjust me</div>', unsafe_allow_html=True)\r\n```\r\n\r\n1. Take a photo. Notice that the size is a nonstandard size, like (for me) 773 x 579. This is the other (and more fundamental) bug, https://github.com/streamlit/streamlit/issues/4320. (But the default should be a standard, useful size.)\r\n2. Clear the photo.\r\n3. Adjust the right-side height until a scroll bar appears. Notice that the camera input restarts. This isn't too bothersome, but...\r\n4. Resize your browser window horizontally, just for a short time. Don't do this for too long or your webcam won't work for a while.\r\n\r\n### Expected Behavior\r\n\r\n_No response_\r\n\r\n### Current Behavior\r\n\r\n_No response_\r\n\r\n### Is this a regression?\r\n\r\n- [ ] Yes, this used to work in a previous version.\r\n\r\n### Debug info\r\n\r\n- Streamlit version: 1.13\r\n- Python version: 3.10.6\r\n- Operating System: macOS 12.6.1\r\n- Browser: Firefox 106.0.5\r\n- Virtual environment: n/a\r\n\r\n\r\n### Additional Information\r\n\r\n_No response_\r\n\r\n### Are you willing to submit a PR?\r\n\r\n- [X] Yes, I am willing to submit a PR!","closed_by":{"login":"kajarenc","id":6664805,"node_id":"MDQ6VXNlcjY2NjQ4MDU=","avatar_url":"https://avatars.githubusercontent.com/u/6664805?v=4","gravatar_id":"","url":"https://api.github.com/users/kajarenc","html_url":"https://github.com/kajarenc","followers_url":"https://api.github.com/users/kajarenc/followers","following_url":"https://api.github.com/users/kajarenc/following{/other_user}","gists_url":"https://api.github.com/users/kajarenc/gists{/gist_id}","starred_url":"https://api.github.com/users/kajarenc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kajarenc/subscriptions","organizations_url":"https://api.github.com/users/kajarenc/orgs","repos_url":"https://api.github.com/users/kajarenc/repos","events_url":"https://api.github.com/users/kajarenc/events{/privacy}","received_events_url":"https://api.github.com/users/kajarenc/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/streamlit/streamlit/issues/5661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/streamlit/streamlit/issues/5661/timeline","performed_via_github_app":null,"state_reason":"completed"}