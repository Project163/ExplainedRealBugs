<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:17:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-10478] Groovy4: java.lang.VerifyError: Bad invokespecial instruction: interface method reference is in an indirect superinterface.</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-10478</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;ul&gt;
	&lt;li&gt;Tried to execute my Groovy 3 to Groovy 4 performance degradation test case (see &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10307&quot; title=&quot;Groovy 4 runtime performance on average 2.4x slower than Groovy 3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10307&quot;&gt;GROOVY-10307&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;Code worked with Groovy 4.0.0-RC1, but Groovy 4.0.0 throws RTE:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.VerifyError: Bad invokespecial instruction: &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; method reference is in an indirect superinterface.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Standalone test to reproduce error upcoming&lt;/li&gt;
	&lt;li&gt;The error occurs when trying to access a class that represents a concrete database table, deriving from a shared database table base class with certain shared properties/methods added through a hierarchy of Groovy traits, with the properties/methods also occuring in interfaces implemented through said traits&lt;/li&gt;
	&lt;li&gt;The error only occurs if that class is @CompileStatic annotated&lt;/li&gt;
	&lt;li&gt;The error reported seems to be non-deterministically picked from any of the traits&apos; properties/methods&lt;/li&gt;
	&lt;li&gt;Full error:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.VerifyError: Bad invokespecial instruction: interface method reference is in an indirect superinterface.
Exception Details:
  Location:
    Goo.GooTrait2trait$super$getNecessaryMember()Ljava/lang/String; @37: invokespecial
  Reason:
    Error exists in the bytecode
  Bytecode:
    0000000: 2ac1 0042 9900 202a ba00 5000 00b9 0054
    0000010: 0100 1255 03bd 0004 b800 5bba 005e 0000
    0000020: b000 00bf 2ab7 0062 b0                 
  Stackmap Table:
    full_frame(@33,{},{Object[#100]})
    append_frame(@36,Object[#2])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Stacktrace starting with JUnit 4 test invocation:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3137)
	at java.base/java.lang.Class.getDeclaredConstructors(Class.java:2357)
	at org.codehaus.groovy.reflection.CachedClass$2.lambda$initValue$4(CachedClass.java:69)
	at java.base/java.security.AccessController.doPrivileged(Native Method)
	at org.codehaus.groovy.vmplugin.v8.Java8.doPrivileged(Java8.java:628)
	at org.codehaus.groovy.reflection.CachedClass$2.initValue(CachedClass.java:74)
	at org.codehaus.groovy.reflection.CachedClass$2.initValue(CachedClass.java:64)
	at org.codehaus.groovy.util.LazyReference.getLocked(LazyReference.java:50)
	at org.codehaus.groovy.util.LazyReference.get(LazyReference.java:37)
	at org.codehaus.groovy.reflection.CachedClass.getConstructors(CachedClass.java:258)
	at groovy.lang.MetaClassImpl.&amp;lt;init&amp;gt;(MetaClassImpl.java:232)
	at groovy.lang.MetaClassImpl.&amp;lt;init&amp;gt;(MetaClassImpl.java:242)
	at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.createNormalMetaClass(MetaClassRegistry.java:166)
	at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.createWithCustomLookup(MetaClassRegistry.java:156)
	at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.create(MetaClassRegistry.java:139)
	at org.codehaus.groovy.reflection.ClassInfo.getMetaClassUnderLock(ClassInfo.java:271)
	at org.codehaus.groovy.reflection.ClassInfo.getMetaClass(ClassInfo.java:314)
	at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.getMetaClass(MetaClassRegistryImpl.java:269)
	at org.codehaus.groovy.vmplugin.v8.Selector$MethodSelector.getMetaClass(Selector.java:575)
	at org.codehaus.groovy.vmplugin.v8.Selector$MethodSelector.setCallSiteTarget(Selector.java:1006)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.fallback(IndyInterface.java:351)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.access$000(IndyInterface.java:49)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface$FallbackSupplier.get(IndyInterface.java:281)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.lambda$fromCache$1(IndyInterface.java:301)
	at java.base/java.util.HashMap.computeIfAbsent(HashMap.java:1133)
	at org.codehaus.groovy.vmplugin.v8.CacheableCallSite.getAndPut(CacheableCallSite.java:61)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.lambda$fromCache$2(IndyInterface.java:298)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.doWithCallSite(IndyInterface.java:367)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.fromCache(IndyInterface.java:295)
	at ConsoleScript2.interfaceMethodIsIndirectSuperinterfaceBugTest(ConsoleScript2:15)
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.fromCache(IndyInterface.java:318)
	at ConsoleScript2.run(ConsoleScript2:18)
	at groovy.lang.GroovyShell.runScriptOrMainOrTestOrRunnable(GroovyShell.java:259)
	at groovy.lang.GroovyShell.run(GroovyShell.java:365)
	at groovy.lang.GroovyShell.run(GroovyShell.java:344)
	at groovy.lang.GroovyShell.run(GroovyShell.java:170)
	at groovy.console.ui.Console$GroovySourceType.run(Console.groovy:1174)
	at groovy.console.ui.Console.doRun(Console.groovy:1406)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:343)
	at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:328)
	at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:342)
	at org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:63)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:203)
	at groovy.console.ui.Console$_runScriptImpl_closure21.doCall(Console.groovy:1364)
	at groovy.console.ui.Console$_runScriptImpl_closure21.doCall(Console.groovy)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:343)
	at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:328)
	at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:279)
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1009)
	at groovy.lang.Closure.call(Closure.java:418)
	at groovy.lang.Closure.call(Closure.java:412)
	at groovy.lang.Closure.run(Closure.java:500)
	at java.base/java.lang.Thread.run(Thread.java:834)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Test case:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test

@groovy.transform.CompileStatic &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Goo &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; GooTrait1 {}

trait GooTrait1 &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; GooTrait2, GooInterface {}

trait GooTrait2 { &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; necessaryMember = &lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt; }

&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; GooInterface {}

@Test
void interfaceMethodIsIndirectSuperinterfaceBugTest() {
  &lt;span class=&quot;code-comment&quot;&gt;// java.lang.VerifyError: Bad invokespecial instruction: &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; method reference is in an indirect superinterface.
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; clazz = Goo
  println clazz.name
}

interfaceMethodIsIndirectSuperinterfaceBugTest()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; &lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13428168">GROOVY-10478</key>
            <summary>Groovy4: java.lang.VerifyError: Bad invokespecial instruction: interface method reference is in an indirect superinterface.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="emge">mgroovy</reporter>
                        <labels>
                    </labels>
                <created>Sun, 13 Feb 2022 01:22:12 +0000</created>
                <updated>Sat, 23 Jul 2022 16:23:34 +0000</updated>
                            <resolved>Thu, 24 Feb 2022 00:05:08 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>3.0.10</fixVersion>
                    <fixVersion>4.0.1</fixVersion>
                                    <component>bytecode</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17491699" author="emilles" created="Sun, 13 Feb 2022 20:45:44 +0000"  >&lt;p&gt;Are you able to track down the source of the method call or reference?  Looks like maybe &lt;tt&gt;getTS_UPDATED&lt;/tt&gt;.  This is possibly related to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10362&quot; title=&quot;STC reports an unexpected method ambiguity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10362&quot;&gt;&lt;del&gt;GROOVY-10362&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9853&quot; title=&quot;ClassFormatError using method reference on interface target&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9853&quot;&gt;&lt;del&gt;GROOVY-9853&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17492542" author="emge" created="Tue, 15 Feb 2022 11:16:26 +0000"  >&lt;p&gt;I have extracted what looks like the minimal test case that reproduces the bug (see above).&lt;/p&gt;</comment>
                            <comment id="17492610" author="paulk" created="Tue, 15 Feb 2022 13:24:53 +0000"  >&lt;p&gt;I updated the stacktrace and verify error details to match the minimal example.&lt;/p&gt;</comment>
                            <comment id="17497080" author="emilles" created="Thu, 24 Feb 2022 00:05:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/693e1031e5e64ccfac872f06c496a44db5575a82&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/693e1031e5e64ccfac872f06c496a44db5575a82&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 37 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ziv4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>