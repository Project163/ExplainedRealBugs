<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:29:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5739] performance problem in DefaultGroovyMethods.removeAll()</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5739</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;There is a performance problem in &quot;DefaultGroovyMethods.removeAll&quot;.&lt;br/&gt;
It appears in version 2.0.4 and also in the latest revision&lt;br/&gt;
(f8c7f25..).  I attached a JUnit test that exposes this problem and a&lt;br/&gt;
one-line patch (patchRemoveAll.diff) that fixes it.  On my machine,&lt;br/&gt;
for this test, the patch provides a 37X speedup.&lt;/p&gt;

&lt;p&gt;Running the JUnit test for the un-patched version is, the output is:&lt;br/&gt;
Time is 2040&lt;/p&gt;

&lt;p&gt;The output for the patched version is:&lt;br/&gt;
Time is 54&lt;/p&gt;

&lt;p&gt;The problem is that the current implementation of &quot;removeAll&quot; calls:&lt;/p&gt;

&lt;p&gt;&quot;self.removeAll(Arrays.asList(items));&quot;&lt;/p&gt;

&lt;p&gt;which typically (e.g., java.util.AbstractCollection and thus most&lt;br/&gt;
collections) calls &quot;contains&quot; on the parameter (a list) for each&lt;br/&gt;
element in &quot;self&quot;.  &quot;contains&quot; on a list has linear complexity, which&lt;br/&gt;
is very slow when called many times.&lt;/p&gt;

&lt;p&gt;The patch uses a HashSet as a parameter, which has constant complexity&lt;br/&gt;
for &quot;contains&quot;.&lt;/p&gt;

&lt;p&gt;&quot;DefaultGroovyMethods.retainAll&quot; has a similar problem.  I attached a&lt;br/&gt;
second patch for it (patchRetainAll.diff)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12818444">GROOVY-5739</key>
            <summary>performance problem in DefaultGroovyMethods.removeAll()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="adriannistor">Adrian Nistor</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Oct 2012 13:33:01 +0000</created>
                <updated>Sun, 5 Apr 2015 14:44:07 +0000</updated>
                            <resolved>Thu, 4 Oct 2012 06:16:29 +0000</resolved>
                                    <version>2.0.4</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>2.1.0-beta-1</fixVersion>
                    <fixVersion>1.8.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14473339" author="adriannistor" created="Tue, 2 Oct 2012 18:49:37 +0000"  >&lt;p&gt;Looking at the current implementation of&lt;br/&gt;
&quot;DefaultGroovyMethods.intersect&quot; and &quot;DefaultGroovyMethods.disjoint&quot;,&lt;br/&gt;
I see these methods avoid O(N^2) complexity by using a TreeSet with a&lt;br/&gt;
NumberAwareComparator.  The final code fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4606&quot; title=&quot;Exteremely bad performance of .unique() and .unique {closure}&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4606&quot;&gt;GROOVY-4606&lt;/a&gt; had a&lt;br/&gt;
similar solution.&lt;/p&gt;

&lt;p&gt;I attached new patches for &quot;removeAll&quot; and &quot;retainAll&quot;&lt;br/&gt;
(patchRemoveAllNumberAwareComparator.diff and&lt;br/&gt;
patchRetainAllNumberAwareComparator.diff).  Similarly to&lt;br/&gt;
&quot;DefaultGroovyMethods.intersect&quot; and &quot;DefaultGroovyMethods.disjoint&quot;,&lt;br/&gt;
my new patches avoid O(N^2) complexity by using a TreeSet with a&lt;br/&gt;
NumberAwareComparator.&lt;/p&gt;</comment>
                            <comment id="14473391" author="paulk" created="Thu, 4 Oct 2012 06:16:29 +0000"  >&lt;p&gt;Second patch applied. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12723003" name="TestRemoveAll.java" size="683" author="" created="Tue, 2 Oct 2012 13:33:02 +0000"/>
                            <attachment id="12722926" name="patchRemoveAll.diff" size="644" author="" created="Tue, 2 Oct 2012 13:33:02 +0000"/>
                            <attachment id="12722372" name="patchRemoveAllNumberAwareComparator.diff" size="740" author="" created="Tue, 2 Oct 2012 18:49:48 +0000"/>
                            <attachment id="12723032" name="patchRetainAll.diff" size="644" author="" created="Tue, 2 Oct 2012 13:33:02 +0000"/>
                            <attachment id="12721728" name="patchRetainAllNumberAwareComparator.diff" size="740" author="" created="Tue, 2 Oct 2012 18:49:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cm53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>