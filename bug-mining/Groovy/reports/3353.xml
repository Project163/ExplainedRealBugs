<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:57:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8511] @PackageScope(METHODS) fails under Parrot Parser due to synthetic public determination</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8511</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The new Parrot Parser does not set the synthetic public flag quite the same as before for methods.  This affects &lt;tt&gt;@PackageScope(PackageScopeTarget.METHODS)&lt;/tt&gt; specifically because it checks that a method is synthetic public before altering the method&apos;s modifiers.&lt;/p&gt;

&lt;p&gt;You can compare how this flag is set for methods in &lt;tt&gt;AntlrParserPlugin.methodDef&lt;/tt&gt; and &lt;tt&gt;AstBuilder.visitMethodDeclaration(MethodDeclarationContext)&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13145155">GROOVY-8511</key>
            <summary>@PackageScope(METHODS) fails under Parrot Parser due to synthetic public determination</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="emilles">Eric Milles</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Mar 2018 19:52:15 +0000</created>
                <updated>Wed, 21 Mar 2018 09:47:42 +0000</updated>
                            <resolved>Tue, 20 Mar 2018 19:06:24 +0000</resolved>
                                    <version>2.6.0-alpha-3</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16399751" author="daniel_sun" created="Thu, 15 Mar 2018 01:38:46 +0000"  >&lt;p&gt;All roads lead to Rome &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;See&#160;&lt;a href=&quot;https://github.com/apache/groovy/commit/594dd7d742057d0c31393ed80fffe3da31dcc78b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/594dd7d742057d0c31393ed80fffe3da31dcc78b&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16400830" author="emilles" created="Thu, 15 Mar 2018 17:49:44 +0000"  >&lt;p&gt;It is not a problem for the scenario you tested.  However there are other ways to use @PackageScope.  You can annotate the class and indicate that fields and/or methods should be package-private.&lt;/p&gt;

&lt;p&gt;Also, I don&apos;t agree with your general determination of synthetic public.  If there is not &quot;private&quot;, &quot;public&quot; or &quot;protected&quot; explicitly, you go into a series of checks for annotation and whatnot.  Isn&apos;t a class, field, method or property synthetic public when it lacks one of the three visibility modifiers?  Not setting that metadata correctly can have many unforseen downstream consequences, like the one in the PackageScope transform.&lt;/p&gt;</comment>
                            <comment id="16400856" author="emilles" created="Thu, 15 Mar 2018 18:03:26 +0000"  >&lt;p&gt;Here are some additional examples of &lt;tt&gt;@PackageScope&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope3() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(PackageScopeTarget.FIELDS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        FieldDeclaration field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), isPackagePrivate(field.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope3a() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.transform.PackageScopeTarget.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(FIELDS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        FieldDeclaration field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), isPackagePrivate(field.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope3b() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.transform.PackageScopeTarget.FIELDS\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(FIELDS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        FieldDeclaration field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), isPackagePrivate(field.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope4() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  @PackageScope &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope5() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(PackageScopeTarget.METHODS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope5a() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.transform.PackageScopeTarget.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(METHODS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope5b() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.transform.PackageScopeTarget.METHODS\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope(METHODS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope6() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.transform.PackageScopeTarget.*\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@PackageScope([CLASS, FIELDS, METHODS])\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
    }

    @Test &lt;span class=&quot;code-comment&quot;&gt;// @PackageScope only applies to synthetic &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; members
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope7() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@groovy.transform.PackageScope(groovy.transform.PackageScopeTarget.FIELDS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field1\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field2\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field3\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; field4\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        FieldDeclaration field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field1&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), isPackagePrivate(field.modifiers));
        field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field2&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), Modifier.isPublic(field.modifiers));
        field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field3&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), Modifier.isPrivate(field.modifiers));
        field = findField(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;field4&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(field.modifiers), Modifier.isProtected(field.modifiers));
    }

    @Test &lt;span class=&quot;code-comment&quot;&gt;// @PackageScope only applies to synthetic &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; members
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPackageScope8() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@groovy.transform.PackageScope(groovy.transform.PackageScopeTarget.METHODS)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method1() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method2() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method3() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method4() {}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt;,
        };

        runNegativeTest(sources, &quot;&quot;);

        MethodDeclaration method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method1&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), isPackagePrivate(method.modifiers));
        method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method2&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), Modifier.isPublic(method.modifiers));
        method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method3&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), Modifier.isPrivate(method.modifiers));
        method = findMethod(getCUDeclFor(&lt;span class=&quot;code-quote&quot;&gt;&quot;Foo.groovy&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;method4&quot;&lt;/span&gt;);
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Expected &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; but was: &quot;&lt;/span&gt; + Modifier.toString(method.modifiers), Modifier.isProtected(method.modifiers));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16401299" author="daniel_sun" created="Fri, 16 Mar 2018 00:10:51 +0000"  >&lt;p&gt;&#160;I added one of your test case. The output of the Parrot parser and old parser is same. In addition, I manually check the each methods&apos; &lt;tt&gt;syntheticPublic&lt;/tt&gt;, they are all &lt;tt&gt;false&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.PackageScope(groovy.transform.PackageScopeTarget.METHODS)
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo2 {
    &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method1() {}
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method2() {}
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method3() {}
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; method4() {}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;See&#160;&lt;a href=&quot;https://github.com/apache/groovy/commit/4ba0b72b2c6c418f22fe2ab6fb7a8b4e5c36d381&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/4ba0b72b2c6c418f22fe2ab6fb7a8b4e5c36d381&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
P.S. If&#160;&lt;tt&gt;syntheticPublic&lt;/tt&gt; is not set correctly, code will run into error:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/transform/PackageScopeASTTransformation.java#L91-L94&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/transform/PackageScopeASTTransformation.java#L91-L94&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/transform/PackageScopeASTTransformation.java#L101-L104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/transform/PackageScopeASTTransformation.java#L101-L104&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16401964" author="emilles" created="Fri, 16 Mar 2018 14:19:40 +0000"  >&lt;p&gt;Your added test does not appear to check the visibility of the methods after compilation to determine if the transform was applied correctly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The checks you linked in &lt;tt&gt;PackageScopeASTTransformation&lt;/tt&gt;&#160;are how I discovered this problem.&#160; If synthetic public is not set, package-private visibility will not be applied.&#160; Does core groovy have tests for &lt;tt&gt;PackageScope&lt;/tt&gt;?&#160; It appears from this bug that you are the first to add any.&#160; I have about a dozen tests for it and when I ran with Parrot Parser, only the ones with an annotation directly on the affected member worked.&lt;/p&gt;</comment>
                            <comment id="16403385" author="daniel_sun" created="Sat, 17 Mar 2018 11:24:49 +0000"  >&lt;p&gt;The main target of Parrot parser is to generate same output with the old one&apos;s. I wish you could provide a runnable test to reproduce the issue, then I will fix the failing test you provide.&lt;/p&gt;</comment>
                            <comment id="16405154" author="emilles" created="Mon, 19 Mar 2018 17:25:16 +0000"  >&lt;p&gt;I&apos;ts not really easy for me to access a pure Parrot Parser environment that&apos;s up-to-date.  Here is a test class that runs fine under Groovy 2.4:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.*
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.PackageScope
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.PackageScopeTarget

@PackageScope(PackageScopeTarget.METHODS)
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy8511 {
  private &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; isPrivate() {}
  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; isPackagePrivate() {}
  public &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; isPublic() {}

  public static void main(args) {
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;public&apos;&lt;/span&gt; == Modifier.toString(getModifiers())
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;public&apos;&lt;/span&gt; == Modifier.toString(getDeclaredMethod(&lt;span class=&quot;code-quote&quot;&gt;&apos;isPublic&apos;&lt;/span&gt;).modifiers)
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;private&apos;&lt;/span&gt; == Modifier.toString(getDeclaredMethod(&lt;span class=&quot;code-quote&quot;&gt;&apos;isPrivate&apos;&lt;/span&gt;).modifiers)
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&apos; == Modifier.toString(getDeclaredMethod(&apos;&lt;/span&gt;isPackagePrivate&apos;).modifiers)
      println &lt;span class=&quot;code-quote&quot;&gt;&apos;done&apos;&lt;/span&gt;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16405710" author="daniel_sun" created="Tue, 20 Mar 2018 02:30:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt;&#160;your code runs well with groovy-3.0.0-alpha-1 and groovy-2.6.0-alpha-3:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.lang.reflect.*
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.PackageScope
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.PackageScopeTarget

@PackageScope(PackageScopeTarget.METHODS)
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy8511 {
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; def isPrivate() {}
  def isPackagePrivate() {}
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; def isPublic() {}

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args) {
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt; == Modifier.toString(getModifiers())
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt; == Modifier.toString(getDeclaredMethod(&lt;span class=&quot;code-quote&quot;&gt;&apos;isPublic&apos;&lt;/span&gt;).modifiers)
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;&apos;&lt;/span&gt; == Modifier.toString(getDeclaredMethod(&lt;span class=&quot;code-quote&quot;&gt;&apos;isPrivate&apos;&lt;/span&gt;).modifiers)
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&apos; == Modifier.toString(getDeclaredMethod(&apos;&lt;/span&gt;isPackagePrivate&apos;).modifiers)
      println &lt;span class=&quot;code-quote&quot;&gt;&apos;done&apos;&lt;/span&gt;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you want to access the latest version of Parrot, you can reference the project: &lt;a href=&quot;https://github.com/danielsun1106/try-jitpack&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/danielsun1106/try-jitpack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16406467" author="emilles" created="Tue, 20 Mar 2018 15:09:33 +0000"  >&lt;p&gt;I&apos;m not really sure how this is working under Parrot Parser given the state of AstBuilder.isSyntheticPublic.  But as long as the end result is correct, I guess you can close this issue.  Thanks for looking into it a bit further.&lt;/p&gt;

&lt;p&gt;In case you are interested, you can track my progress integrating Parrot Parser support into Eclipse IDE here &lt;a href=&quot;https://github.com/groovy/groovy-eclipse/issues/412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-eclipse/issues/412&lt;/a&gt; and &lt;a href=&quot;https://github.com/groovy/groovy-eclipse/blob/master/base/org.codehaus.groovy26/src/org/apache/groovy/parser/antlr4/AstBuilder.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-eclipse/blob/master/base/org.codehaus.groovy26/src/org/apache/groovy/parser/antlr4/AstBuilder.java&lt;/a&gt; (look for &quot;// GRECLIPSE&quot; comments).&lt;/p&gt;</comment>
                            <comment id="16407680" author="daniel_sun" created="Wed, 21 Mar 2018 09:47:42 +0000"  >&lt;p&gt;&lt;em&gt;I&apos;m not really sure how this is working under Parrot Parser given the state of AstBuilder.isSyntheticPublic. But as long as the end result is correct&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;All roads lead to Rome&#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;In case you are interested, you can track my progress integrating Parrot Parser support into Eclipse IDE here &lt;a href=&quot;https://github.com/groovy/groovy-eclipse/issues/412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-eclipse/issues/412&lt;/a&gt; and &lt;a href=&quot;https://github.com/groovy/groovy-eclipse/blob/master/base/org.codehaus.groovy26/src/org/apache/groovy/parser/antlr4/AstBuilder.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-eclipse/blob/master/base/org.codehaus.groovy26/src/org/apache/groovy/parser/antlr4/AstBuilder.java&lt;/a&gt; (look for &quot;// GRECLIPSE&quot; comments).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Awesome! Thanks for your hard work!&lt;/b&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rb2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>