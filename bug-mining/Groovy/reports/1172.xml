<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:14:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4015] GStrings are not coerced to Strings in super constructor call</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4015</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;class Foo {&lt;br/&gt;
  def Foo(String s) { }&lt;br/&gt;
}&lt;br/&gt;
class ImplString extends Foo {&lt;br/&gt;
  def ImplString(String s) &lt;/p&gt;
{
    super(s)
  }&lt;br/&gt;
}&lt;br/&gt;
class ImplObject extends Foo {&lt;br/&gt;
  def ImplObject(s) {    super(s)  }
&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;def a = 2&lt;/p&gt;

&lt;p&gt;new ImplString(&quot;GString $a&quot;)&lt;br/&gt;
new ImplObject(&quot;String&quot;)&lt;br/&gt;
new ImplObject(&quot;GString $a&quot;) //fails with CCE&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815018">GROOVY-4015</key>
            <summary>GStrings are not coerced to Strings in super constructor call</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="gromopetr">Peter Gromov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jan 2010 12:11:53 +0000</created>
                <updated>Wed, 7 Apr 2010 23:46:52 +0000</updated>
                            <resolved>Fri, 29 Jan 2010 04:00:27 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.6.8</fixVersion>
                    <fixVersion>1.7.1</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14468803" author="roshandawrani" created="Wed, 27 Jan 2010 13:26:45 +0000"  >&lt;p&gt;Here is the patch I want to suggest.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Index: src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
===================================================================
--- src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java    (revision 19110)
+++ src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java    (working copy)
@@ -2471,7 +2471,7 @@
                 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ClassHelper.isPrimitiveType(type)) {
                     helper.unbox(type);
                 } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
-                    helper.doCast(type);
+                   doConvertAndCast(type, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
                 }
                 helper.swapWithObject(type);
             }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When ASM visits special constructor calls, it simply casts arguments to parameter types of the chosen contructor instead of convertAndCast.&lt;/p&gt;

&lt;p&gt;Just doing the cast is not sufficient because the constructor selection logic (SBA#selectConstructorAndTransformArguments()) doesn&apos;t do the exact type match - it allows all assignable types. So for a call like super(GString), the constructor &amp;lt;init&amp;gt;(String) passes SBA&apos;s constructor selection logic, but if a convert call is not made at runtime, the invocation of the constructor will fail because GString is not directly castable to String, for instance. Both pieces of logic - selection and invocation have to be in sync.&lt;/p&gt;

&lt;p&gt;Anyone sees any issues with it? If not, I would like to go ahead and apply it.&lt;/p&gt;</comment>
                            <comment id="14468759" author="blackdrag" created="Thu, 28 Jan 2010 04:25:37 +0000"  >&lt;p&gt;looks good&lt;/p&gt;</comment>
                            <comment id="14468778" author="roshandawrani" created="Thu, 28 Jan 2010 09:21:19 +0000"  >&lt;p&gt;Fixed. &lt;/p&gt;

&lt;p&gt;Arguments of this()/super() calls are now coerced to the types of the parameters of the selected constructor.&lt;/p&gt;</comment>
                            <comment id="14468846" author="roshandawrani" created="Fri, 29 Jan 2010 03:58:39 +0000"  >&lt;p&gt;The fix made for this issue has been undone. &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4016&quot; title=&quot;Single super constructor argument is casted to array if super constructor has vararg parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4016&quot;&gt;&lt;del&gt;GROOVY-4016&lt;/del&gt;&lt;/a&gt; needs a fix in the very same area of ASM and that fix must handle the issue reported in this JIRA as well. Please refer to comments of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4016&quot; title=&quot;Single super constructor argument is casted to array if super constructor has vararg parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4016&quot;&gt;&lt;del&gt;GROOVY-4016&lt;/del&gt;&lt;/a&gt; for relevant details. This issue is being marked as duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4016&quot; title=&quot;Single super constructor argument is casted to array if super constructor has vararg parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4016&quot;&gt;&lt;del&gt;GROOVY-4016&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Sorry about the inconvenience but I had no idea about &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4016&quot; title=&quot;Single super constructor argument is casted to array if super constructor has vararg parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4016&quot;&gt;&lt;del&gt;GROOVY-4016&lt;/del&gt;&lt;/a&gt; when I worked on this one.&lt;/p&gt;</comment>
                            <comment id="14468805" author="roshandawrani" created="Fri, 29 Jan 2010 04:00:27 +0000"  >&lt;p&gt;This issue will be handled under the very similar issue reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4016&quot; title=&quot;Single super constructor argument is casted to array if super constructor has vararg parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4016&quot;&gt;&lt;del&gt;GROOVY-4016&lt;/del&gt;&lt;/a&gt;. Please refer to that JIRA for details.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12815048">GROOVY-4016</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12722256" name="4015_v18x_Patch.txt" size="620" author="roshandawrani" created="Wed, 27 Jan 2010 13:26:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bvof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>