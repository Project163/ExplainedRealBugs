<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:08:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7848] Closure generic parameters ignored and return types missing from collections methods</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7848</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The theme of this ticket is type failures even specifying the correct input parameter type in a Closure, specifically these 2 methods fail to compile with CompileStatic/TypeChecked:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List foo(){
    [[1,2], [3,4]].collect{List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; pair -&amp;gt; pair[0]+pair[1]}
}

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; bar(){
    [[1, 3], [1, 2]].transpose().inject(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;){acc, List pair -&amp;gt; acc &amp;amp;&amp;amp; pair[0] == pair[1]}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first is due to the generic parameter Integer apparently being ignored.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Error:(15, 48) Groovyc: &lt;span class=&quot;error&quot;&gt;&amp;#91;Static type checking&amp;#93;&lt;/span&gt; - Cannot find matching method java.lang.Object#plus(java.lang.Object). Please check if the declared type is right and if the method exists.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ignoring it is just fine when compiling in Dynamic mode, but makes it apparently impossible to write a similar Type Safe method&lt;/p&gt;

&lt;p&gt;Apparently, this part of the language is as yet undocumented:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/index.html#generics&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.groovy-lang.org/latest/html/documentation/index.html#generics&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The second method instead, has a similar failure to locate Object#getAt(int), but the actual error is this one:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Error:(20, 50) Groovyc: Expected parameter of type java.lang.Object but got java.util.List&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Which is imho a bit unhelpful: I&apos;m obviously passing it a List, at runtime... and the the Closure parameter type is List, given that I would expect the error to be the other way around: expected parameter of type List, but got Object&lt;/p&gt;

&lt;p&gt;But the problem is not actually with Closure types, inference or the like... I suspect it might simply be an imprecise type specified for transpose() result: it should be List&amp;lt;List&amp;gt;, but is instead List (once I understood this I simply created an intermedia variable with the explicit type as a workaround)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12973342">GROOVY-7848</key>
            <summary>Closure generic parameters ignored and return types missing from collections methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="berdario">Dario Bertini</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 May 2016 08:38:51 +0000</created>
                <updated>Thu, 23 Jul 2020 14:16:22 +0000</updated>
                            <resolved>Sat, 18 Jul 2020 07:20:01 +0000</resolved>
                                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                    <fixVersion>3.0.5</fixVersion>
                    <fixVersion>2.5.13</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17156759" author="emilles" created="Mon, 13 Jul 2020 14:46:25 +0000"  >&lt;p&gt;&lt;tt&gt;transpose()&lt;/tt&gt; accepts and returns a plain List, so there is not much hope for type inferencing down the line.&lt;/p&gt;

&lt;p&gt;In the collect case, &lt;tt&gt;[&lt;span class=&quot;error&quot;&gt;&amp;#91;1,2&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;3,4&amp;#93;&lt;/span&gt;]&lt;/tt&gt; is inferred as &lt;tt&gt;List&amp;lt;List&amp;gt;&lt;/tt&gt; and that is why the plus operation gives an error.  Pull request is incomoing.&lt;/p&gt;</comment>
                            <comment id="17156815" author="emilles" created="Mon, 13 Jul 2020 16:06:26 +0000"  >&lt;p&gt;You can rewrite the &quot;bar&quot; case like this for no STC errors:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; bar() {
  List&amp;lt;List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt; pairs = [[1,3], [1,2]].transpose()
  pairs.inject(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) { flag, pair -&amp;gt; flag &amp;amp;&amp;amp; pair[0] == pair[1] }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17160357" author="paulk" created="Sat, 18 Jul 2020 07:20:01 +0000"  >&lt;p&gt;Proposed PR merged. Thanks all.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yl67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>