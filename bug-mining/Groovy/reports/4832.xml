<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:24:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11409] Spring Boot JPA Repository Class is not autowired in Groovy</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11409</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have a code that works in java. its sample spring-boot application:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.example.demo;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; lombok.Getter;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; lombok.Setter;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; lombok.extern.slf4j.Slf4j;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.beans.factory.annotation.Autowired;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.SpringApplication;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.autoconfigure.SpringBootApplication;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.context.event.ApplicationReadyEvent;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.context.event.EventListener;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.data.jpa.repository.config.EnableJpaRepositories;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.data.repository.CrudRepository;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.stereotype.Repository;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.transaction.annotation.Isolation;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.transaction.annotation.Transactional;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.*;

@SpringBootApplication
@EnableJpaRepositories(considerNestedRepositories = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
@Slf4j
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DemoApplication {


    @Getter @Setter
    @Entity
    @Table(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Record {
       @Id
       @GeneratedValue(strategy = GenerationType.IDENTITY)
       &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; id;
       &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; data;
    }
    @Repository
    @Transactional(isolation = Isolation.SERIALIZABLE)
    &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; RecordRepository &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CrudRepository&amp;lt;Record, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; {
    }

    @Autowired
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DemoApplication.RecordRepository recordRepository;

    @EventListener(ApplicationReadyEvent.class)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void ready() {
       Iterable&amp;lt;DemoApplication.Record&amp;gt; all = recordRepository.findAll();
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (all.iterator().hasNext()) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;There should be no records&quot;&lt;/span&gt;);
       }
       recordRepository.save(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DemoApplication.Record());
       all = recordRepository.findAll();
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!all.iterator().hasNext()) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;There should be records&quot;&lt;/span&gt;);
       }
       log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;All good&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
       SpringApplication.run(DemoApplication.class, args).close();
    }

}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And its property file (application.yaml):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
server:
  port: 8080

spring:
  sql:
    init:
      platform: sqlite
      mode: always
  datasource:
    url: &lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:sqlite::memory:&quot;&lt;/span&gt;
    username:
    password:
    driver-&lt;span class=&quot;code-keyword&quot;&gt;class-&lt;/span&gt;name: org.sqlite.JDBC
  jpa:
    database-platform: org.sqlite.hibernate.dialect.SQLiteDialect
    show-sql: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
    defer-datasource-initialization: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
    hibernate:
      ddl-auto: create
      jdbc:
        time_zone: UTC
    open-in-view: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Running it works as expected, &quot;All good&quot; is shown into console.&lt;/p&gt;

&lt;p&gt;After converting the same code to groovy this code fail. The error is:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
No qualifying bean of type &lt;span class=&quot;code-quote&quot;&gt;&apos;com.example.demo2.DemoApplication$RecordRepository&apos;&lt;/span&gt; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, the spring is not seeing static nested class IF it is in groovy.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This is the groove code I run:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.example.demo2
@GrabConfig
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.springframework.boot&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;spring-boot-starter-web&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.7.18&apos;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.xerial&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;sqlite-jdbc&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;3.45.3.0&apos;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.springframework.boot&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;spring-boot-starter-data-jpa&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.7.18&apos;&lt;/span&gt;)

@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;com.github.gwenn&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;sqlite-dialect&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&quot;0.1.4&quot;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;jakarta.persistence&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;jakarta.persistence-api&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;2.2.2&apos;&lt;/span&gt;)
@GrabExclude(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;javax.persistence&apos;&lt;/span&gt;, module=&lt;span class=&quot;code-quote&quot;&gt;&apos;javax.persistence-api&apos;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.jboss.spec.javax.transaction&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;jboss-transaction-api_1.2_spec&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;1.1.1.Final&apos;&lt;/span&gt;)
@GrabExclude(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.jboss.spec.javax.transaction&apos;&lt;/span&gt;, module=&lt;span class=&quot;code-quote&quot;&gt;&apos;jboss-transaction-api_1.2_spec&apos;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;jakarta.transaction&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;jakarta.transaction-api&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;1.3.1&apos;&lt;/span&gt;)
@Grab(group = &lt;span class=&quot;code-quote&quot;&gt;&apos;com.zaxxer&apos;&lt;/span&gt;, module = &lt;span class=&quot;code-quote&quot;&gt;&apos;HikariCP&apos;&lt;/span&gt;, version = &lt;span class=&quot;code-quote&quot;&gt;&apos;5.1.0&apos;&lt;/span&gt;)
@Grab(group=&lt;span class=&quot;code-quote&quot;&gt;&apos;org.slf4j&apos;&lt;/span&gt;, module=&lt;span class=&quot;code-quote&quot;&gt;&apos;slf4j-simple&apos;&lt;/span&gt;, version=&lt;span class=&quot;code-quote&quot;&gt;&apos;2.0.13&apos;&lt;/span&gt;)
@Grab(group=&lt;span class=&quot;code-quote&quot;&gt;&apos;org.slf4j&apos;&lt;/span&gt;, module=&lt;span class=&quot;code-quote&quot;&gt;&apos;slf4j-api&apos;&lt;/span&gt;, version=&lt;span class=&quot;code-quote&quot;&gt;&apos;2.0.13&apos;&lt;/span&gt;)
@Grab(group=&lt;span class=&quot;code-quote&quot;&gt;&apos;cglib&apos;&lt;/span&gt;, module=&lt;span class=&quot;code-quote&quot;&gt;&apos;cglib&apos;&lt;/span&gt;, version=&lt;span class=&quot;code-quote&quot;&gt;&apos;3.2.4&apos;&lt;/span&gt;)

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.beans.factory.annotation.Autowired;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.SpringApplication;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.autoconfigure.SpringBootApplication;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.boot.context.event.ApplicationReadyEvent
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.data.jpa.repository.config.EnableJpaRepositories;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.data.repository.CrudRepository;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.stereotype.Repository;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.transaction.annotation.Isolation;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.transaction.annotation.Transactional
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.springframework.context.event.EventListener

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.Entity
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.GeneratedValue
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.GenerationType
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.Id
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.persistence.Table

@SpringBootApplication
@EnableJpaRepositories(considerNestedRepositories = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DemoApplication {

    @Entity
    @Table(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Record {
        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; id
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; data
    }
    @Repository
    @Transactional(isolation = Isolation.SERIALIZABLE)
    &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; RecordRepository &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CrudRepository&amp;lt;Record, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; {
    }

    @Autowired
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DemoApplication.RecordRepository recordRepository;

    @EventListener(ApplicationReadyEvent.class)
    void ready() {
        Iterable&amp;lt;DemoApplication.Record&amp;gt; all = recordRepository.findAll();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (all.iterator().hasNext()) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;There should be no records&quot;&lt;/span&gt;);
        }
        recordRepository.save(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DemoApplication.Record());
        all = recordRepository.findAll();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!all.iterator().hasNext()) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;There should be records&quot;&lt;/span&gt;);
        }
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;All good&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        SpringApplication.run(DemoApplication.class, args).close();
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I run it with this script:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#!/bin/env bash
groovy -version
java -version
cd groovy &amp;amp;&amp;amp; groovy src/com/example/demo2/DemoApplication.groovy --spring.config.location=application.yaml &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ans this is output (boht java case and groovy case):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#10004; nb6:~/work/bugreport&amp;gt; ./run_java.sh&#160;
[INFO] Scanning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; projects...
[INFO]&#160;
[INFO] --------------------------&amp;lt; com.example:demo &amp;gt;--------------------------
[INFO] Building demo 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]&#160;
[INFO] --- exec-maven-plugin:3.3.0:java (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) @ demo ---&#160; . &#160; ____ &#160; &#160; &#160; &#160; &#160;_ &#160; &#160; &#160; &#160; &#160; &#160;__ _ _
&#160;/\\ / ___&apos;_ __ _ _(_)_ __ &#160;__ _ \ \ \ \
( ( )\___ | &lt;span class=&quot;code-quote&quot;&gt;&apos;_ | &apos;&lt;/span&gt;_| | &apos;_ \/ _` | \ \ \ \
&#160;\\/ &#160;___)| |_)| | | | | || (_| | &#160;) ) ) )
&#160; &apos; &#160;|____| .__|_| |_|_| |_\__, | / / / /
&#160;=========|_|==============|___/=/_/_/_/
&#160;:: Spring Boot :: &#160; &#160; &#160; &#160; &#160; &#160; &#160; (v2.7.18)2024-06-16 02:47:55.694 &#160;INFO 71733 --- [lication.main()] com.example.demo.DemoApplication &#160; &#160; &#160; &#160; : Starting DemoApplication using Java 17 on nb6 with PID 71733 (/home/msangel/work/bugreport/java/target/classes started by msangel in /home/msangel/work/bugreport/java)
2024-06-16 02:47:55.697 &#160;INFO 71733 --- [lication.main()] com.example.demo.DemoApplication &#160; &#160; &#160; &#160; : No active profile set, falling back to 1 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; profile: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;
2024-06-16 02:47:56.092 &#160;INFO 71733 --- [lication.main()] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-06-16 02:47:56.126 &#160;INFO 71733 --- [lication.main()] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 26 ms. Found 1 JPA repository interfaces.
2024-06-16 02:47:56.512 &#160;INFO 71733 --- [lication.main()] o.hibernate.jpa.internal.util.LogHelper &#160;: HHH000204: Processing PersistenceUnitInfo [name: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;]
2024-06-16 02:47:56.551 &#160;INFO 71733 --- [lication.main()] org.hibernate.Version &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;: HHH000412: Hibernate ORM core version 5.6.15.Final
2024-06-16 02:47:56.685 &#160;INFO 71733 --- [lication.main()] o.hibernate.annotations.common.Version &#160; : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2024-06-16 02:47:56.755 &#160;INFO 71733 --- [lication.main()] org.hibernate.dialect.Dialect &#160; &#160; &#160; &#160; &#160; &#160;: HHH000400: Using dialect: org.sqlite.hibernate.dialect.SQLiteDialect
2024-06-16 02:47:56.793 &#160;INFO 71733 --- [lication.main()] com.zaxxer.hikari.HikariDataSource &#160; &#160; &#160; : HikariPool-1 - Starting...
2024-06-16 02:47:56.927 &#160;INFO 71733 --- [lication.main()] com.zaxxer.hikari.HikariDataSource &#160; &#160; &#160; : HikariPool-1 - Start completed.
2024-06-16 02:47:56.935 &#160;INFO 71733 --- [lication.main()] org.hibernate.dialect.Dialect &#160; &#160; &#160; &#160; &#160; &#160;: HHH000400: Using dialect: org.sqlite.hibernate.dialect.SQLiteDialect
2024-06-16 02:47:57.377 &#160;INFO 71733 --- [lication.main()] o.h.e.t.j.p.i.JtaPlatformInitiator &#160; &#160; &#160; : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2024-06-16 02:47:57.388 &#160;INFO 71733 --- [lication.main()] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; persistence unit &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&apos;&lt;/span&gt;
2024-06-16 02:47:57.724 &#160;INFO 71733 --- [lication.main()] com.example.demo.DemoApplication &#160; &#160; &#160; &#160; : Started DemoApplication in 2.489 seconds (JVM running &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 4.638)
2024-06-16 02:47:57.874 &#160;INFO 71733 --- [lication.main()] com.example.demo.DemoApplication &#160; &#160; &#160; &#160; : All good
2024-06-16 02:47:57.877 &#160;INFO 71733 --- [lication.main()] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; persistence unit &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&apos;&lt;/span&gt;
2024-06-16 02:47:57.879 &#160;INFO 71733 --- [lication.main()] com.zaxxer.hikari.HikariDataSource &#160; &#160; &#160; : HikariPool-1 - Shutdown initiated...
2024-06-16 02:47:57.882 &#160;INFO 71733 --- [lication.main()] com.zaxxer.hikari.HikariDataSource &#160; &#160; &#160; : HikariPool-1 - Shutdown completed.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: &#160;3.851 s
[INFO] Finished at: 2024-06-16T02:47:57+02:00
[INFO] ------------------------------------------------------------------------&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#10004; nb6:~/work/bugreport&amp;gt; ./run_groovy.sh&#160;
Groovy Version: 4.0.21 JVM: 17 Vendor: Oracle Corporation OS: Linux
openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;17&quot;&lt;/span&gt; 2021-09-14
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 17+35-2724)
OpenJDK 64-Bit Server VM (build 17+35-2724, mixed mode, sharing)
SLF4J(W): No SLF4J providers were found.
SLF4J(W): Defaulting to no-operation (NOP) logger implementation
SLF4J(W): See https:&lt;span class=&quot;code-comment&quot;&gt;//www.slf4j.org/codes.html#noProviders &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; further details.&#160; . &#160; ____ &#160; &#160; &#160; &#160; &#160;_ &#160; &#160; &#160; &#160; &#160; &#160;__ _ _
&lt;/span&gt;&#160;/\\ / ___&apos;_ __ _ _(_)_ __ &#160;__ _ \ \ \ \
( ( )\___ | &lt;span class=&quot;code-quote&quot;&gt;&apos;_ | &apos;&lt;/span&gt;_| | &apos;_ \/ _` | \ \ \ \
&#160;\\/ &#160;___)| |_)| | | | | || (_| | &#160;) ) ) )
&#160; &apos; &#160;|____| .__|_| |_|_| |_\__, | / / / /
&#160;=========|_|==============|___/=/_/_/_/
&#160;:: Spring Boot :: &#160; &#160; &#160; &#160; &#160; &#160; &#160; (v2.7.18)Caught: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &lt;span class=&quot;code-quote&quot;&gt;&apos;demoApplication&apos;&lt;/span&gt;: Unsatisfied dependency expressed through field &lt;span class=&quot;code-quote&quot;&gt;&apos;recordRepository&apos;&lt;/span&gt;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &lt;span class=&quot;code-quote&quot;&gt;&apos;com.example.demo2.DemoApplication$RecordRepository&apos;&lt;/span&gt; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)}
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &lt;span class=&quot;code-quote&quot;&gt;&apos;demoApplication&apos;&lt;/span&gt;: Unsatisfied dependency expressed through field &lt;span class=&quot;code-quote&quot;&gt;&apos;recordRepository&apos;&lt;/span&gt;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &lt;span class=&quot;code-quote&quot;&gt;&apos;com.example.demo2.DemoApplication$RecordRepository&apos;&lt;/span&gt; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)}
&#160; &#160; at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:713)
&#160; &#160; at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:693)
&#160; &#160; at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
&#160; &#160; at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:408)
&#160; &#160; at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
&#160; &#160; at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
&#160; &#160; at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
&#160; &#160; at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
&#160; &#160; at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
&#160; &#160; at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
&#160; &#160; at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
&#160; &#160; at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955)
&#160; &#160; at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:929)
&#160; &#160; at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:591)
&#160; &#160; at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)
&#160; &#160; at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:732)
&#160; &#160; at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:409)
&#160; &#160; at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)
&#160; &#160; at org.springframework.boot.SpringApplication.run(SpringApplication.java:1300)
&#160; &#160; at org.springframework.boot.SpringApplication.run(SpringApplication.java:1289)
&#160; &#160; at com.example.demo2.DemoApplication.main(DemoApplication.groovy:70)
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &lt;span class=&quot;code-quote&quot;&gt;&apos;com.example.demo2.DemoApplication$RecordRepository&apos;&lt;/span&gt; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)}
&#160; &#160; at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1801)
&#160; &#160; at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1357)
&#160; &#160; at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
&#160; &#160; at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:710)
&#160; &#160; ... 20 more
&#10008;-1 nb6:~/work/bugreport&amp;gt;&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Why the groovy version is not working with literally the same code?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>linux</environment>
        <key id="13582789">GROOVY-11409</key>
            <summary>Spring Boot JPA Repository Class is not autowired in Groovy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="msangel">msangel</reporter>
                        <labels>
                    </labels>
                <created>Sun, 16 Jun 2024 00:59:27 +0000</created>
                <updated>Fri, 30 Aug 2024 05:20:31 +0000</updated>
                                            <version>4.0.21</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17855266" author="msangel" created="Sun, 16 Jun 2024 01:00:21 +0000"  >&lt;p&gt;Attached all the sources and project structure&lt;/p&gt;</comment>
                            <comment id="17855431" author="emilles" created="Sun, 16 Jun 2024 18:23:11 +0000"  >&lt;p&gt;When you run your demo using the &lt;tt&gt;groovy&lt;/tt&gt; command, the script is parsed into classes at run-time.  These classes are not locate-able using Spring&apos;s default path-based resource loader.  I did not work out how to make spring aware of these, but there are some ideas on SO.  Maybe someone with more experience could say how to connect spring to groovy&apos;s dynamic script parsing mechanisms.&lt;/p&gt;

&lt;p&gt;I compiled the script with &lt;tt&gt;groovyc&lt;/tt&gt; first and then ran with &lt;tt&gt;groovy&lt;/tt&gt; and it could then find the nested interface class.&lt;/p&gt;</comment>
                            <comment id="17876021" author="msangel" created="Thu, 22 Aug 2024 16:10:56 +0000"  >&lt;p&gt;I dig a bit. So a root is that when discover candidates, actually when discover all classes in package via `PathMatchingResourcePatternResolver.getResources(String locationPattern)` in Groovy it returns empty collection since there are no classes at &quot;classpath*:com/example/demo2/&lt;b&gt;{&lt;/b&gt;}/{*}.class&quot; pattern, since no class files at all. This is why it works after compiling first - after compaling we do have physical class files at that location.&#160;&lt;br/&gt;
Proposed solution will be: change that &quot;getResources&quot; method so if it is in Groovy evaluation mode, it should read a list of classes somehow differently.&#160;&lt;/p&gt;

&lt;p&gt;The stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
getResources:251, GenericApplicationContext (org.springframework.context.support)
scanCandidateComponents:421, ClassPathScanningCandidateComponentProvider (org.springframework.context.annotation)
findCandidateComponents:316, ClassPathScanningCandidateComponentProvider (org.springframework.context.annotation)
findCandidateComponents:123, RepositoryComponentProvider (org.springframework.data.repository.config)
lambda$&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;$1:80, RepositoryConfigurationSourceSupport (org.springframework.data.repository.config)
apply:-1, RepositoryConfigurationSourceSupport$$Lambda$693/0x0000798f244d9f40 (org.springframework.data.repository.config)
accept:273, ReferencePipeline$7$1 (java.util.stream)
tryAdvance:1856, Spliterators$IteratorSpliterator (java.util)
lambda$initPartialTraversalState$0:292, StreamSpliterators$WrappingSpliterator (java.util.stream)
getAsBoolean:-1, StreamSpliterators$WrappingSpliterator$$Lambda$113/0x0000798f240b0490 (java.util.stream)
fillBuffer:206, StreamSpliterators$AbstractWrappingSpliterator (java.util.stream)
doAdvance:161, StreamSpliterators$AbstractWrappingSpliterator (java.util.stream)
tryAdvance:298, StreamSpliterators$WrappingSpliterator (java.util.stream)
hasNext:681, Spliterators$1Adapter (java.util)
getRepositoryConfigurations:93, RepositoryConfigurationExtensionSupport (org.springframework.data.repository.config)
registerRepositoriesIn:159, RepositoryConfigurationDelegate (org.springframework.data.repository.config)
registerBeanDefinitions:106, RepositoryBeanDefinitionRegistrarSupport (org.springframework.data.repository.config)
lambda$loadBeanDefinitionsFromRegistrars$1:396, ConfigurationClassBeanDefinitionReader (org.springframework.context.annotation)
accept:-1, ConfigurationClassBeanDefinitionReader$$Lambda$675/0x0000798f244d0cd8 (org.springframework.context.annotation)
forEach:721, LinkedHashMap (java.util)
loadBeanDefinitionsFromRegistrars:395, ConfigurationClassBeanDefinitionReader (org.springframework.context.annotation)
loadBeanDefinitionsForConfigurationClass:157, ConfigurationClassBeanDefinitionReader (org.springframework.context.annotation)
loadBeanDefinitions:129, ConfigurationClassBeanDefinitionReader (org.springframework.context.annotation)
processConfigBeanDefinitions:343, ConfigurationClassPostProcessor (org.springframework.context.annotation)
postProcessBeanDefinitionRegistry:247, ConfigurationClassPostProcessor (org.springframework.context.annotation)
invokeBeanDefinitionRegistryPostProcessors:311, PostProcessorRegistrationDelegate (org.springframework.context.support)
invokeBeanFactoryPostProcessors:112, PostProcessorRegistrationDelegate (org.springframework.context.support)
invokeBeanFactoryPostProcessors:756, AbstractApplicationContext (org.springframework.context.support)
refresh:572, AbstractApplicationContext (org.springframework.context.support)
refresh:147, ServletWebServerApplicationContext (org.springframework.boot.web.servlet.context)
refresh:732, SpringApplication (org.springframework.boot)
refreshContext:409, SpringApplication (org.springframework.boot)
run:308, SpringApplication (org.springframework.boot)
run:1300, SpringApplication (org.springframework.boot)
run:1289, SpringApplication (org.springframework.boot)
main:71, DemoApplication (com.example.demo2)
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So either edit generic &quot;getResources&quot; so it always will return additional &quot;virtual&quot; resources like class files EITHER edit &quot;getRepositoryConfigurations&quot; so it will be aware of Groovy magic.&#160;&lt;/p&gt;</comment>
                            <comment id="17876176" author="blackdrag" created="Fri, 23 Aug 2024 05:34:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msangel&quot; class=&quot;user-hover&quot; rel=&quot;msangel&quot;&gt;msangel&lt;/a&gt;&#160; I think it may not be enough to provide some indicator in getResources, Spring needs to be actually able to load the bytecode of those classes. After a class has been defined, there is afaik no access to the bytecode anymore unless you have the code saved somewhere. Since the class files do not exist, not even in memory, there is nothing to load the bytecode from.&lt;/p&gt;</comment>
                            <comment id="17877880" author="msangel" created="Thu, 29 Aug 2024 20:20:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; since groovy classloader extends URLClassLoader, it must provide a path to those classes. In any case, they are stored somewhere. A lot of libraries depends on access to .class file, starting from Spring and many testing libraries like mockito. How to expose them is another question. Fair will be to have some tmp location that exists till process run and rely on those. Of course if the script reloaded, the class file must be rebuild.&#160;&lt;br/&gt;
Until that I see no way for spring boot to work with groovy in interpreter mode.&#160;&lt;/p&gt;</comment>
                            <comment id="17877967" author="blackdrag" created="Fri, 30 Aug 2024 05:20:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msangel&quot; class=&quot;user-hover&quot; rel=&quot;msangel&quot;&gt;msangel&lt;/a&gt; it is a URLClassLoader for the script discovery, but it does not provide a way to load .class files from somewhere. The compiler compiles the scripts to memory in bytecode and then provides them to defineClass. From that point on the class is loaded and the bytecode forgotten. The loader could be extended to save the classes, or keep them in memory. There is the option of setting an output path in the compiler configuration given to the class loader, which is of course much more easy. But this will still require a script, that loads the main script for Spring Boot via GroovyShell or GroovyClassLoader&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12816923">GROOVY-6105</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13069523" name="bugreport.7z" size="10937" author="msangel" created="Sun, 16 Jun 2024 00:59:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ptog:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>