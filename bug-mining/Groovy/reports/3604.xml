<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:03:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9136] Compile error when accessing a public field inside a closure</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9136</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code works fine in 2.5.6 but breaks in 2.5.7:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Class1 {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; prop1
}

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Class2 {

    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; doThing(Class1 c1) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;something&apos;&lt;/span&gt;.with {
            println c1.prop1
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; it
        }
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Class2().doThing(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Class1(prop1: &lt;span class=&quot;code-quote&quot;&gt;&apos;value1&apos;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The error is&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Access to Class1#c1 is forbidden at line: -1, column: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that if you remove the `public` modifier from `Class1.prop1` the code is fine. Likewise, if you take `@CompileStatic` off of `Class2`, everything works fine.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13234945">GROOVY-9136</key>
            <summary>Compile error when accessing a public field inside a closure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="jbellassai">John Bellassai</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 May 2019 16:42:00 +0000</created>
                <updated>Tue, 30 Jul 2019 09:02:35 +0000</updated>
                            <resolved>Sat, 25 May 2019 06:46:00 +0000</resolved>
                                    <version>2.5.7</version>
                                    <fixVersion>2.5.8</fixVersion>
                    <fixVersion>3.0.0-beta-2</fixVersion>
                                    <component>Static compilation</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16846946" author="emilles" created="Thu, 23 May 2019 18:34:38 +0000"  >&lt;p&gt;Line and column can be set by adding &quot;receiver.setSourcePosition(expr);&quot; to &lt;tt&gt;VariableExpressionTransformer.tryTransformDelegateToProperty&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16846952" author="emilles" created="Thu, 23 May 2019 18:44:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9007&quot; title=&quot;Getting java.lang.NoSuchFieldError with groovy version 2.5.6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9007&quot;&gt;&lt;del&gt;GROOVY-9007&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9063&quot; title=&quot;Groovy 2.5.6 @CompileStatic generates invalid bytecode (leading to runtime ClassCastException) when accessing protected instance member from 2 level of nested closures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9063&quot;&gt;&lt;del&gt;GROOVY-9063&lt;/del&gt;&lt;/a&gt;, et al. were the reason for this change in behavior.  This method from &lt;tt&gt;StaticTypeCheckingVisitor&lt;/tt&gt; has check for closure parameter access (aka &lt;tt&gt;accessedVariable == declaredVariable&lt;/tt&gt;).  It does not have a check for enclosing method parameter access.  And so, control flow falls to &lt;tt&gt;delegationData = &quot;owner&quot;;&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; checkOrMarkInnerPropertyOwnerAccess(Expression source, FieldNode fn, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; lhsOfAssignment, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; delegationData) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fn == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || fn.isStatic() || fn.isPrivate() || &lt;span class=&quot;code-quote&quot;&gt;&quot;delegate&quot;&lt;/span&gt;.equals(delegationData)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; delegationData;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (source &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; PropertyExpression &amp;amp;&amp;amp; typeCheckingContext.getEnclosingClosureStack().size() == 1) {
            PropertyExpression pe = (PropertyExpression) source;
            &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ownerProperty = !(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;&quot;&lt;/span&gt;.equals(pe.getPropertyAsString()));
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ownerProperty &amp;amp;&amp;amp; pe.getObjectExpression() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; VariableExpression) {
                Variable accessedVariable = ((VariableExpression) pe.getObjectExpression()).getAccessedVariable();
                Variable declaredVariable = typeCheckingContext.getEnclosingClosure().getClosureExpression().getVariableScope().getDeclaredVariable(pe.getObjectExpression().getText());
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (accessedVariable != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; accessedVariable == declaredVariable) ownerProperty = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ownerProperty) {
                delegationData = &lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt;;
                pe.getObjectExpression().putNodeMetaData(StaticTypesMarker.IMPLICIT_RECEIVER, delegationData);
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; delegationData;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02yt4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>