<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:05:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9440] Missing line number information in stack trace</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9440</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;If you try to run these two features in a Spock spec:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
def foo() {
  expect: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
  where: a &amp;lt;&amp;lt; [b]
}

def bar() {
  expect: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
  where: a &amp;lt;&amp;lt; b
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You will get a &lt;tt&gt;MissingPropertyException&lt;/tt&gt; for both of them, which is perfectly fine.&lt;/p&gt;

&lt;p&gt;The problem is, that for &lt;tt&gt;foo&lt;/tt&gt; there is a line number in the stack trace while for &lt;tt&gt;bar&lt;/tt&gt; there is not.&lt;/p&gt;

&lt;p&gt;I checked the byte code, there it is also missing for the &lt;tt&gt;bar&lt;/tt&gt; case.&lt;/p&gt;

&lt;p&gt;According to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt; the line number information is present in the AST:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;BlockStatement (no info) -&amp;gt; ReturnStatement (no info) -&amp;gt; Variable (with line number info) // b&lt;br/&gt;
BlockStatement (no info) -&amp;gt; ReturnStatement (no info) -&amp;gt; ListExp (correct info) -&amp;gt; Variable (correct info) // &lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13289931">GROOVY-9440</key>
            <summary>Missing line number information in stack trace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="vampire">Bj&#246;rn Kautler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Mar 2020 00:18:03 +0000</created>
                <updated>Fri, 22 Dec 2023 11:38:24 +0000</updated>
                            <resolved>Fri, 6 Oct 2023 16:02:48 +0000</resolved>
                                    <version>2.5.8</version>
                    <version>3.0.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17052628" author="paulk" created="Fri, 6 Mar 2020 01:00:03 +0000"  >&lt;p&gt;I can add that I haven&apos;t yet been able to recreate the problem by coding the equivalent methods by hand in Groovy but I can&apos;t see anything suspicious about the Spock created methods either.&lt;/p&gt;</comment>
                            <comment id="17053159" author="vampire" created="Fri, 6 Mar 2020 08:43:36 +0000"  >&lt;p&gt;Ah, I got it.&lt;/p&gt;

&lt;p&gt;The line information is taken from the parent statement.&lt;/p&gt;

&lt;p&gt;In the &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&lt;/tt&gt; example from the &lt;tt&gt;ListExp&lt;/tt&gt;, in the &lt;tt&gt;b&lt;/tt&gt; example from the &lt;tt&gt;ReturnStatement&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;If I either replace the explicit return statement by an expression statement and let Groovy auto-inject the return statement or set the source position on the return statement manually, the line information is contained in the byte code and in the stack trace.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure whether this is a fix or a work-around though, i. e. if you need to change something in Groovy due to this.&lt;br/&gt;
This is up to you to decide. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17053219" author="paulk" created="Fri, 6 Mar 2020 09:43:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vampire&quot; class=&quot;user-hover&quot; rel=&quot;vampire&quot;&gt;vampire&lt;/a&gt; Nice detective work! We&apos;ll investigate further what we can do on the Groovy side. At least you have a workaround for now. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17059808" author="emilles" created="Sun, 15 Mar 2020 20:39:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vampire&quot; class=&quot;user-hover&quot; rel=&quot;vampire&quot;&gt;vampire&lt;/a&gt; You mention that line info is taken from the parent statement.  Before the Spock transform, I see two ExpressionStatement instances for each test method with full line information.  After the Spock global transform, the methods have been rewritten and expanded quite significantly.  Where in those methods should I be looking for the enclosing statements of &quot;a &amp;lt;&amp;lt; &lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&quot; and &quot;a &amp;lt;&amp;lt; b&quot;?&lt;/p&gt;

&lt;p&gt;It appears to me that Groovy is setting up the AST properly, then the Spock global transform does its thing.  At which point, you say the line information of the two methods differs.  Is it not the Spock transform that is the source of the issue?&lt;/p&gt;</comment>
                            <comment id="17067791" author="paulk" created="Thu, 26 Mar 2020 15:45:41 +0000"  >&lt;p&gt;So this issue is about whether we make Groovy smarter when giving line info with errors. We could for instance take line info directly from a statement rather than the parent statement if the parent would yield no useful line info. Actually, looking at this further I am not sure this is on the Groovy side. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vampire&quot; class=&quot;user-hover&quot; rel=&quot;vampire&quot;&gt;vampire&lt;/a&gt;, when you say the line info is taken from the parent, did you mean Spock supplies the parent node as part of the error message?&lt;/p&gt;</comment>
                            <comment id="17067828" author="vampire" created="Thu, 26 Mar 2020 16:42:40 +0000"  >&lt;p&gt;No, I meant Groovy&lt;/p&gt;

&lt;p&gt;Just like in your example:&lt;/p&gt;

&lt;p&gt;&amp;gt; BlockStatement (no info) -&amp;gt; ReturnStatement (no info) -&amp;gt; Variable (with line number info) // b&lt;br/&gt;
 &amp;gt; BlockStatement (no info) -&amp;gt; ReturnStatement (no info) -&amp;gt; ListExp (correct info) -&amp;gt; Variable (correct info) //&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The problem is with `Variable`, it is not found so it produces a missing property exception.&lt;br/&gt;
The line information for the stack trace is taken from `ReturnStatement` in the first case, and from `ListExp` in the second case.&lt;br/&gt;
Because of that the first case shows no line information in the stack trace while the second does.&lt;/p&gt;


&lt;p&gt;(In the meantime I fixed it in Spock so that the return statement has proper line number info)&lt;/p&gt;</comment>
                            <comment id="17772626" author="emilles" created="Fri, 6 Oct 2023 16:03:24 +0000"  >&lt;p&gt;Line number available for Groovy 3.0.19 and Spock 2.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0c83s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>