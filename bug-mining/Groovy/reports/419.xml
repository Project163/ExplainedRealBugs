<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:01:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2137] Enum class does not load</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2137</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Looks as if they compile properly, but lead to an error at load time. Groovysh session transcript follows.&lt;/p&gt;

&lt;p&gt;Groovy Shell (1.1-beta-3, JVM: 1.6.0_01-b06)&lt;br/&gt;
Type &apos;go&apos; to execute statements; Type &apos;help&apos; for more information.&lt;br/&gt;
groovy&amp;gt; enum E &lt;/p&gt;
{A, B, C}
&lt;p&gt;groovy&amp;gt; go&lt;br/&gt;
ERROR: groovy.lang.GroovyRuntimeException: Failed to create Script instance for class: class E. Reason: java.lang.InstantiationException: E&lt;br/&gt;
groovy.lang.GroovyRuntimeException: Failed to create Script instance for class: class E. Reason: java.lang.InstantiationException: E&lt;br/&gt;
        at org.codehaus.groovy.runtime.InvokerHelper.createScript(InvokerHelper.java:385)&lt;br/&gt;
        at groovy.lang.GroovyShell.parse(GroovyShell.java:500)&lt;br/&gt;
        at groovy.lang.GroovyShell.parse (GroovyShell.java:480)&lt;br/&gt;
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:458)&lt;br/&gt;
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:434)&lt;br/&gt;
        at groovy.ui.InteractiveShell.run(InteractiveShell.java :289)&lt;br/&gt;
        at groovy.ui.InteractiveShell.main(InteractiveShell.java:101)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java :39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.rootLoader (GroovyStarter.java:101)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)&lt;br/&gt;
Caused by: java.lang.InstantiationException: E&lt;br/&gt;
        at java.lang.Class.newInstance0(Class.java:340)&lt;br/&gt;
        at java.lang.Class.newInstance(Class.java:308)&lt;br/&gt;
        at org.codehaus.groovy.runtime.InvokerHelper.createScript(InvokerHelper.java:366)&lt;br/&gt;
        ... 12 more&lt;/p&gt;</description>
                <environment>JDK 1.5.0 / JDK 1.6.0; Windows Vista</environment>
        <key id="12817237">GROOVY-2137</key>
            <summary>Enum class does not load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="jstaudemeyer">J&#246;rg Staudemeyer</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Sep 2007 16:38:34 +0000</created>
                <updated>Thu, 11 Oct 2007 19:48:21 +0000</updated>
                            <resolved>Thu, 11 Oct 2007 19:48:21 +0000</resolved>
                                    <version>1.1-beta-3</version>
                                    <fixVersion>1.1-rc-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14463138" author="shemnon" created="Mon, 24 Sep 2007 15:56:46 +0000"  >&lt;p&gt;The compiler returns an Enum object, whereas the InvokerHelper is expecting a Script or a GroovyObject.  &lt;/p&gt;

&lt;p&gt;I propose we return the Class object for the enum in this instance (IMHO the other sensible option being to return null).  This will only be visible in scripts where the only expression is a single enum statement, so I don&apos;t think it can be tripped elsewhere accidentally.&lt;/p&gt;
</comment>
                            <comment id="14463172" author="shemnon" created="Mon, 24 Sep 2007 16:11:29 +0000"  >&lt;p&gt;This patch gets rid of the exception....&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Index: src/main/org/codehaus/groovy/runtime/InvokerHelper.java
===================================================================
--- src/main/org/codehaus/groovy/runtime/InvokerHelper.java     (revision 8215)
+++ src/main/org/codehaus/groovy/runtime/InvokerHelper.java     (working copy)
@@ -353,7 +353,7 @@
         return invokeMethod(script, &quot;run&quot;, EMPTY_ARGS);
     }

-    public static Script createScript(Class scriptClass, Binding context) {
+    public static Script createScript(final Class scriptClass, Binding context)
 {
         // for empty scripts
         if (scriptClass == null) {
             return new Script() {
@@ -363,11 +363,18 @@
             };
         }
         try {
-            final GroovyObject object = (GroovyObject) scriptClass.newInstance();
             Script script = null;
-            if (object instanceof Script) {
-                script = (Script) object;
+            if (Script.class.isAssignableFrom(scriptClass)) {
+                script = (Script) scriptClass.newInstance();
+            } else if (Enum.class.isAssignableFrom(scriptClass)) {
+                // return the class object...
+                script = new Script() {
+                    public Object run() {
+                        return scriptClass;
+                    }
+                };
             } else {
+                final GroovyObject object = (GroovyObject) scriptClass.newInstance();
                 // it could just be a class, so lets wrap it in a Script wrapper
                 // though the bindings will be ignored
                 script = new Script() {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But then actual attempts to use the enum result in the following exception....&lt;/p&gt;

&lt;p&gt;groovy&amp;gt; enum E &lt;/p&gt;
{A,B,C}
&lt;p&gt;groovy&amp;gt; go&lt;br/&gt;
===&amp;gt; class E&lt;br/&gt;
groovy&amp;gt; E.A&lt;br/&gt;
groovy&amp;gt; go&lt;br/&gt;
ERROR: java.lang.ExceptionInInitializerError&lt;br/&gt;
java.lang.ExceptionInInitializerError&lt;br/&gt;
        at java.lang.Class.forName0(Native Method)&lt;br/&gt;
        at java.lang.Class.forName(Class.java:164)&lt;br/&gt;
        at Script2.class$(Script2.groovy)&lt;br/&gt;
        at Script2.run(Script2.groovy)&lt;br/&gt;
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:459)&lt;br/&gt;
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:434)&lt;br/&gt;
        at groovy.ui.InteractiveShell.run(InteractiveShell.java:289)&lt;br/&gt;
        at groovy.ui.InteractiveShell.main(InteractiveShell.java:101)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:101)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)&lt;br/&gt;
Caused by: org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot cast object &apos;[Ljava.lang.Object;@adb1d4&apos; with class &apos;[Ljava.lang.Object;&apos; to class &apos;E&apos;&lt;br/&gt;
        at org.codehaus.groovy.runtime.typehandling.DefaultTypeTransformation.castToType(DefaultTypeTransformation.java:326)&lt;br/&gt;
        at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.castToType(ScriptBytecodeAdapter.java:642)&lt;br/&gt;
        at E.$INIT(Script1.groovy)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.codehaus.groovy.runtime.metaclass.ReflectionMetaMethod.invoke(ReflectionMetaMethod.java:64)&lt;br/&gt;
        at org.codehaus.groovy.runtime.MetaClassHelper.doMethodInvoke(MetaClassHelper.java:537)&lt;br/&gt;
        at groovy.lang.MetaClassImpl.invokeStaticMethod(MetaClassImpl.java:913)&lt;br/&gt;
        at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:69)&lt;br/&gt;
        at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:74)&lt;br/&gt;
        at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodN(ScriptBytecodeAdapter.java:158)&lt;br/&gt;
        at E.&amp;lt;clinit&amp;gt;(Script1.groovy)&lt;br/&gt;
        ... 14 more&lt;/p&gt;

&lt;p&gt;(JVM 1.5.0_11-b03 Windows Vista, if it matters)&lt;/p&gt;

&lt;p&gt;Hence the failures I didn&apos;t commit and will let the deeper language folks dig at it.&lt;/p&gt;</comment>
                            <comment id="14463180" author="blackdrag" created="Mon, 24 Sep 2007 16:16:04 +0000"  >&lt;p&gt;enums created by Groovy are implementing GroovyObject. I think the problem is more inside the static initializer.. looks like a ClassCastException.. a trivial element is missing I guess &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14463301" author="blackdrag" created="Thu, 11 Oct 2007 19:48:21 +0000"  >&lt;p&gt;the exception int the static initializer is fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bocv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>