<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:05:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9424] Incorrect handling of final variables within switch</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9424</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code runs on groovy 2.4.18 but not on groovy 3.0.1.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {

    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result

    &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (2) {
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1: result = &lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 2: result = &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: result = &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;
    }

    println result
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Error: Groovyc: The variable &lt;span class=&quot;error&quot;&gt;&amp;#91;result&amp;#93;&lt;/span&gt; is declared final but is reassigned.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Since we use final in our codebase a lot (although it seems to be ignored by groovy 2.4), &lt;br/&gt;
we will have to adjust a lot of places to make our code groovy 3.0 compatible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13287692">GROOVY-9424</key>
            <summary>Incorrect handling of final variables within switch</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="d.wilmer.1980">Daniel Wilmer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Feb 2020 09:06:20 +0000</created>
                <updated>Fri, 6 Mar 2020 23:17:57 +0000</updated>
                            <resolved>Tue, 3 Mar 2020 05:13:30 +0000</resolved>
                                                    <fixVersion>2.5.10</fixVersion>
                    <fixVersion>3.0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17045402" author="paulk" created="Wed, 26 Feb 2020 11:24:55 +0000"  >&lt;p&gt;This looks like a bug in the final variable analyzer.&lt;/p&gt;</comment>
                            <comment id="17049912" author="paulk" created="Tue, 3 Mar 2020 05:13:30 +0000"  >&lt;p&gt;Thanks for spotting the issue. The proposed PR has been merged.&lt;/p&gt;</comment>
                            <comment id="17051912" author="rieske" created="Thu, 5 Mar 2020 08:52:28 +0000"  >&lt;p&gt;It looks like this change&#160;&lt;a href=&quot;https://github.com/apache/groovy/commit/cd2b0e42fcf418e16776f34a66ed5cacc7711630#diff-3557aa86d96d4931ca9f64e88bd5f85fR480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/cd2b0e42fcf418e16776f34a66ed5cacc7711630#diff-3557aa86d96d4931ca9f64e88bd5f85fR480&lt;/a&gt;&#160;introduced a regression in compiling switch statements with clauses containing only a break.&lt;/p&gt;

&lt;p&gt;A simple reproducer:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 42 
&lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;(i) { 
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1: 
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt; 
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 2: 
        println 2 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This yields the following with the latest Groovy 2.5.10-SNAPSHOT:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ClassCastException: &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.codehaus.groovy.ast.stmt.ReturnStatement cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.codehaus.groovy.ast.stmt.BlockStatement (org.codehaus.groovy .ast.stmt.ReturnStatement and org.codehaus.groovy.ast.stmt.BlockStatement are in unnamed module of loader org.gradle.internal.classloader.VisitableURLClassLoader @135490 40) at org.codehaus.groovy.classgen.FinalVariableAnalyzer.fallsThrough(FinalVariableAnalyzer.java:480)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;Adding anything between the first case and break makes it compile again:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 42 
&lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;(i) { 
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1: 
        &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt; 
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 2: 
        println 2 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17051936" author="paulk" created="Thu, 5 Mar 2020 09:16:38 +0000"  >&lt;p&gt;Thanks for spotting that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rieske&quot; class=&quot;user-hover&quot; rel=&quot;rieske&quot;&gt;rieske&lt;/a&gt; and the workaround. I&apos;ll clone the issue and fix. The other workaround is to add any additional statement after the switch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13289752">GROOVY-9438</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0bwe0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>