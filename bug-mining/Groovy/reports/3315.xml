<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:57:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8338] Calling Stream.of from groovy class in JDK 9 fails</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8338</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Trying to call Stream.of from groovy class (groovy version 2.4.12) using JDK 9 (jdk 9 181) fails. &lt;br/&gt;
Example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; test

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.stream.Stream

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        Stream.of(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;).forEach({ println(it) })
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The code above fails with:&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.IncompatibleClassChangeError: Method java.util.stream.Stream.of(Ljava/lang/Object;)Ljava/util/stream/Stream; must be InterfaceMethodref constant&lt;br/&gt;
	at java_util_stream_Stream$of.call(Unknown Source)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:48)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:113)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)&lt;br/&gt;
	at test.B.main(B.groovy:7)&lt;/p&gt;


&lt;p&gt;The same occurs for other interface static methods also:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; D {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; D of(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; D() {
        };
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        D.of(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;)
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also fails with:&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.IncompatibleClassChangeError: Method test.D.of(Ljava/lang/String;)Ltest/D; must be InterfaceMethodref constant&lt;br/&gt;
	at test.D$of.call(Unknown Source)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:48)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:113)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)&lt;br/&gt;
	at test.C.main(C.groovy:7)&lt;/p&gt;

&lt;p&gt;Running with JDK 8 works fine.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13106389">GROOVY-8338</key>
            <summary>Calling Stream.of from groovy class in JDK 9 fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="marnyl">Marcus Nylander</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Oct 2017 12:31:21 +0000</created>
                <updated>Tue, 10 Apr 2018 13:02:26 +0000</updated>
                            <resolved>Wed, 7 Mar 2018 01:21:12 +0000</resolved>
                                    <version>2.4.12</version>
                                    <fixVersion>2.6.0-alpha-3</fixVersion>
                    <fixVersion>3.0.0-alpha-2</fixVersion>
                    <fixVersion>2.5.0-rc-1</fixVersion>
                                    <component>groovy-runtime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16303419" author="slnowak" created="Tue, 26 Dec 2017 00:42:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; is this issue solved on GROOVY_2_4_X branch of &lt;a href=&quot;https://github.com/apache/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy&lt;/a&gt; ? I&apos;m trying to run spock tests on jdk9, but i&apos;m also having issues with static methods on interfaces. &lt;/p&gt;

&lt;p&gt;I even tried building groovy-all from sources (GROOVY_2_4_X) and use it in my project, but then I get &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;method: call signature: (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;) Illegal type in constant pool&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Same thing happens when I try to run InterfaceStaticMethodCallTest:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.VerifyError: (class: java_util_stream_Stream$of, method: callStatic signature: (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;) Illegal type in constant pool

	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getDeclaredConstructors0(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.privateGetDeclaredConstructors(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:2671)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor0(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3075)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:1825)
	at org.codehaus.groovy.reflection.ClassLoaderForClassArtifacts.defineClassAndGetConstructor(ClassLoaderForClassArtifacts.java:82)
	at org.codehaus.groovy.runtime.callsite.CallSiteGenerator.compileStaticMethod(CallSiteGenerator.java:262)
	at org.codehaus.groovy.reflection.CachedMethod.createStaticMetaMethodSite(CachedMethod.java:295)
	at org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite.createStaticMetaMethodSite(StaticMetaMethodSite.java:114)
	at groovy.lang.MetaClassImpl.createStaticSite(MetaClassImpl.java:3421)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallStaticSite(CallSiteArray.java:76)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallSite(CallSiteArray.java:161)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)
	at TestScript0.run(TestScript0.groovy:4)
	at groovy.lang.GroovyShell.evaluate(GroovyShell.java:574)
	at groovy.lang.GroovyShell.evaluate(GroovyShell.java:612)
	at groovy.lang.GroovyShell.evaluate(GroovyShell.java:593)
	at groovy.test.GroovyAssert.assertScript(GroovyAssert.java:83)
	at groovy.util.GroovyTestCase.assertScript(GroovyTestCase.java:203)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSiteNoUnwrapNoCoerce.invoke(PogoMetaMethodSite.java:210)
	at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:59)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:51)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:157)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:169)
	at org.codehaus.groovy.vmplugin.v8.InterfaceStaticMethodCallTest.testStreamOf(InterfaceStaticMethodCallTest.groovy:28)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at junit.framework.TestCase.runTest(TestCase.java:176)
	at junit.framework.TestCase.runBare(TestCase.java:141)
	at junit.framework.TestResult$1.protect(TestResult.java:122)
	at junit.framework.TestResult.runProtected(TestResult.java:142)
	at junit.framework.TestResult.run(TestResult.java:125)
	at junit.framework.TestCase.run(TestCase.java:129)
	at junit.framework.TestSuite.runTest(TestSuite.java:252)
	at junit.framework.TestSuite.run(TestSuite.java:247)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:86)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)
	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oh and btw I&apos;m not quite sure why do you depend on &apos;asm-all:6.0&apos;. It seems like it&apos;s not available in maven central (couldn&apos;t find anything newer than &lt;a href=&quot;https://mvnrepository.com/artifact/org.ow2.asm/asm-all/6.0_BETA&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mvnrepository.com/artifact/org.ow2.asm/asm-all/6.0_BETA&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="16303711" author="blackdrag" created="Tue, 26 Dec 2017 09:51:40 +0000"  >&lt;p&gt;2.4.14 should have the fix. There is a second part to this fix where we upgrade to 2.4.x to ASM6 (not beta). As for depending on asm-all:6.0 actually we are currently investigating where we depend on that, because groovy-core does not depend on the no longer existing asm-all artifact.&lt;/p&gt;</comment>
                            <comment id="16303714" author="slnowak" created="Tue, 26 Dec 2017 09:53:59 +0000"  >&lt;p&gt;So the latest commit from GROOVY_2_4_X should fix that? In my case, unfortunately it haven&apos;t. Maybe because I was compiling with asmVersion = 6.0-BETA?&lt;/p&gt;</comment>
                            <comment id="16303728" author="blackdrag" created="Tue, 26 Dec 2017 10:11:21 +0000"  >&lt;p&gt;Even though I did backport the change to 2.4.x, it is very possible I will have to change the fix version and say it is 2.5+ only. On the CI server the same fix works well on master and 2.5.x, but the JDK8 snapshot build currently fails there.... because it requests asm-all-6.0, which does not exist. Right now I have no idea what would be different for Groovy 2.4 to not pass verification and still work with for example master or 2.5. Would it possible for you to test Groovy 2.5? I know there are problems with master and spock, because master is set to Groovy 3, but 2.5 should work, should it not?&lt;/p&gt;</comment>
                            <comment id="16303731" author="slnowak" created="Tue, 26 Dec 2017 10:14:27 +0000"  >&lt;p&gt;I can try to build 2.5 from sources and test it but I&apos;m not sure if spock is compatible with 2.5. &lt;br/&gt;
When I&apos;m trying to build groovy locally, it also can&apos;t find asm-all-6.0, i had to downgrade the dependency.&lt;/p&gt;</comment>
                            <comment id="16303757" author="slnowak" created="Tue, 26 Dec 2017 10:54:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; Well, I had some compilation issues on 2.5, but after fixing that:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.IncompatibleClassChangeError: Method io.vavr.control.Validation.valid(Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Lio/vavr/control/Validation; must be InterfaceMethodref constant&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Of course, Validation.valid is a static factory method on an interface. So it looks like the issue is still there. &lt;/p&gt;

&lt;p&gt;Let me know if I&apos;m doing anything wrong:&lt;br/&gt;
1) i&apos;m trying to compile groovy locally&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;MacBook-Pro-Slawomir:groovy snowak$ git log -1
commit ad4b5d15e2191349f7ddc588cc208a4014a240d4 (HEAD -&amp;gt; GROOVY_2_5_X, upstream/GROOVY_2_5_X)
Author: sunlan &amp;lt;sunlan@apache.org&amp;gt;
Date:   Tue Dec 26 12:54:01 2017 +0800

    Simplify the arguments of `coerceToSAM` method

    (cherry picked from commit 6e5f47f)

MacBook-Pro-Slawomir:groovy snowak$ ./gradlew clean dist -x test  --parallel&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2) then I specify compiled jar as a maven depencency:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.codehaus.groovy&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;groovy&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;2.5.0-SNAPSHOT&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;system&amp;lt;/scope&amp;gt;
            &amp;lt;systemPath&amp;gt;/Users/snowak/work/projects/groovy/target/libs/groovy-2.5.0-SNAPSHOT.jar&amp;lt;/systemPath&amp;gt;
        &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should work, right?&lt;/p&gt;</comment>
                            <comment id="16323530" author="daniel_sun" created="Fri, 12 Jan 2018 04:29:14 +0000"  >&lt;p&gt;The following code still fails when running on Java9&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ java -Xmx32m -version
java version &lt;span class=&quot;code-quote&quot;&gt;&quot;9.0.1&quot;&lt;/span&gt;
Java(TM) SE &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 9.0.1+11)
Java HotSpot(TM) 64-Bit Server VM (build 9.0.1+11, mixed mode)
$ javac -J-Xmx32m -version
javac 9.0.1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; [2, 3, 4] == Stream.of(1, 2, 3).map(e -&amp;gt; e + 1).collect(Collectors.toList());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/apache/groovy/jobs/327967597&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/groovy/jobs/327967597&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
groovy.transform.stc.LambdaTest &amp;gt; testMethodCall FAILED
    java.lang.IncompatibleClassChangeError: Method java.util.stream.Stream.of([Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/util/stream/Stream; must be InterfaceMethodref constant
        at Test1.p1(TestScript0.groovy:15)
        at Test1.main(TestScript0.groovy:9)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.base/java.lang.reflect.Method.invoke(Method.java:564)
        at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:103)
        at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:325)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1299)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1047)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:835)
        at Test1.invokeMethod(TestScript0.groovy)
        at org.codehaus.groovy.runtime.InvokerHelper$1.run(InvokerHelper.java:456)
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:445)
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:483)
        at groovy.lang.GroovyShell.evaluate(GroovyShell.java:464)
        at groovy.test.GroovyAssert.assertScript(GroovyAssert.java:83)
        at groovy.util.GroovyTestCase.assertScript(GroovyTestCase.java:203)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.base/java.lang.reflect.Method.invoke(Method.java:564)
        at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSiteNoUnwrapNoCoerce.invoke(PogoMetaMethodSite.java:210)
        at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:59)
        at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:51)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:157)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:169)
        at groovy.transform.stc.LambdaTest.testMethodCall(LambdaTest.groovy:24)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16323641" author="paulk" created="Fri, 12 Jan 2018 07:13:12 +0000"  >&lt;p&gt;Should we reopen this?&lt;/p&gt;</comment>
                            <comment id="16324567" author="blackdrag" created="Fri, 12 Jan 2018 21:17:40 +0000"  >&lt;p&gt;then most likely somebody else has to solve the problem&lt;/p&gt;</comment>
                            <comment id="16324763" author="paulk" created="Sat, 13 Jan 2018 00:03:51 +0000"  >&lt;p&gt;Well, I don&apos;t care whether it is closed or remains open so long as we know what parts have been fixed so far and what cases are still left to do. I wasn&apos;t following as closely as I possibly should have early on and I have kind of lost track. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; what&apos;s your understanding of the current status? Some cases fail for master in JDK9 and some issues on 2_4_X?&lt;/p&gt;</comment>
                            <comment id="16325122" author="blackdrag" created="Sat, 13 Jan 2018 13:02:01 +0000"  >&lt;p&gt;What I fixed is the  proxy generator callsite caching is using to make the call. So as long as the call is done through the proxy it should work. Or so I thought. the message tells me that the proxy class is loaded but incorrect. It tells me that me fix is not applied for it actually and that this still generates the old proxy version we still require because those people cannot keep java9 and java8 working properly together at times. I think it depends on the VM if it works or not.&lt;/p&gt;</comment>
                            <comment id="16325543" author="slnowak" created="Sun, 14 Jan 2018 12:25:27 +0000"  >&lt;p&gt;I&apos;ve just built groovy-all jar from latest commit on 2.4.X branch, included it in my test project and the following test&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StaticMethodCall &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Specification {

    def &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test&apos;&lt;/span&gt;() {
        expect:
        Stream.of(1, 2, 3).map({ it + 1 }).collect(Collectors.toList()) == [2, 3, 4]
    }

}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;passed on jdk 9.0.1&lt;/p&gt;

&lt;p&gt;However, there&apos;s still something broken. I&apos;ve added a static Vertx.vertx() call &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StaticMethodCall &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Specification {
    def &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test&apos;&lt;/span&gt;() {
        expect:
        def vertx = Vertx.vertx()
        &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and it fails with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.VerifyError: (class: io/vertx/core/Vertx$vertx, method: callStatic signature: (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;) Illegal type in constant pool

	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.privateGetDeclaredConstructors(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3110)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor0(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3315)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:2108)
	at com.example.app.StaticMethodCall.&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test(StaticMethodCall.groovy:9)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it&apos;s not caused by vertx itself as it works on jdk9, it only fails in groovy.&lt;/p&gt;

&lt;p&gt;// edit:&lt;br/&gt;
I&apos;m trying to recreate the issue without using vertx, will get back to you&lt;/p&gt;</comment>
                            <comment id="16325565" author="paulk" created="Sun, 14 Jan 2018 13:06:46 +0000"  >&lt;p&gt;Thanks! Your results with and without @CompileStatic would also potentially be useful information.&lt;/p&gt;</comment>
                            <comment id="16325571" author="slnowak" created="Sun, 14 Jan 2018 13:18:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt;&lt;br/&gt;
Ok, so this is what I&apos;ve found so far:&lt;br/&gt;
If you define an interface:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; InterfaceWithStaticMethod {

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; someStaticMethod() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;then this works:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StaticMethodCall &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Specification {
    def &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test&apos;&lt;/span&gt;() {
        expect:
        InterfaceWithStaticMethod.someStaticMethod()
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;however this fails:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StaticMethodCall &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Specification {
    def &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test&apos;&lt;/span&gt;() {
        expect:
        def result = InterfaceWithStaticMethod.someStaticMethod()
        result
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.VerifyError: (class: example/app/InterfaceWithStaticMethod$someStaticMethod, method: callStatic signature: (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;) Illegal type in constant pool

	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.privateGetDeclaredConstructors(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3110)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor0(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3315)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getConstructor(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:2108)
	at com.example.app.StaticMethodCall.&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test(StaticMethodCall.groovy:9)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running it with @CompileStatic yields:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[INFO] Running com.example.app.StaticMethodCall
[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 3.161 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in com.example.app.StaticMethodCall
[ERROR] &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test(com.example.app.StaticMethodCall)  Time elapsed: 0.068 s  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.lang.IncompatibleClassChangeError: Method example.app.InterfaceWithStaticMethod.someStaticMethod()Z must be InterfaceMethodref constant
        at com.example.app.StaticMethodCall.&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test(StaticMethodCall.groovy:11)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Errors: 
[ERROR]   StaticMethodCall.&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; method call test:11 IncompatibleClassChange Method exa...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="16326317" author="daniel_sun" created="Mon, 15 Jan 2018 15:04:59 +0000"  >&lt;p&gt;I found javac creates `Integer` array for `Stream.of(1, 2, 3)`, but groovy creates `Object` array. Maybe it is the cause why `Stream.of` fails in Java9, which is more strict to verify.&lt;/p&gt;</comment>
                            <comment id="16326357" author="slnowak" created="Mon, 15 Jan 2018 15:49:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daniel_sun&quot; class=&quot;user-hover&quot; rel=&quot;daniel_sun&quot;&gt;daniel_sun&lt;/a&gt; See my comment above - this issue is not&#160;related to &apos;Stream.of&apos; itself.&lt;/p&gt;</comment>
                            <comment id="16342298" author="slnowak" created="Sat, 27 Jan 2018 20:28:40 +0000"  >&lt;p&gt;Do you have any idea when this could be fixed?&lt;/p&gt;</comment>
                            <comment id="16364207" author="slnowak" created="Wed, 14 Feb 2018 15:06:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt; this kind of blocks the usage of groovy (for example for testing) in any jdk9 based project. Are there any plans to fix this issue?&lt;/p&gt;</comment>
                            <comment id="16388842" author="paulk" created="Wed, 7 Mar 2018 01:21:12 +0000"  >&lt;p&gt;I believe the fix worked for 2.5+ but doesn&apos;t work (or at least isn&apos;t sufficient) for 2_4_X. I&apos;ve cloned the issue to cater for that case.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13143062">GROOVY-8494</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3krun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>