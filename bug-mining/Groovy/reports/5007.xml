<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:27:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11341] @CompileStatic: Compilation fails due to a synthetic bridge method in the subclass</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11341</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given the following Java classes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; InterfaceBase {
&#160; &#160; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; getValue();
}
&#160;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyImplBase {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; getValue() {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 42L;
&#160; &#160; }
}
&#160;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyImpl &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MyImplBase &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; InterfaceBase {
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
And the following SimpleCaller.groovy:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SimpleCaller {

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
      &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; v = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyImpl().getValue();
      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(v); &lt;span class=&quot;code-comment&quot;&gt;//42
&lt;/span&gt;   }

} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The compilation fails with:&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;tt&gt;SimpleCaller.groovy: 7: &lt;span class=&quot;error&quot;&gt;&amp;#91;Static type checking&amp;#93;&lt;/span&gt; - Cannot assign value of type java.lang.Object to variable of type java.lang.Long&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;@ line 7, column 16.&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160;Long v = new MyImpl().getValue();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ^&lt;/tt&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
Compiling the equivalent &lt;tt&gt;SimpleCaller.java&lt;/tt&gt; with &lt;em&gt;javac&lt;/em&gt; completes successfully.&lt;br/&gt;
&#160;&lt;br/&gt;
This structure is a bit uncommon, because MyImplBase uses a covariant return type and doesn&apos;t implement the interface directly, only its subclass does.&lt;br/&gt;
&#160;&lt;br/&gt;
I believe the problem is connected to the synthetic bridge method inserted into the bytecode of &lt;em&gt;MyImpl&lt;/em&gt;, which is picked up and preferred by &lt;em&gt;groovyc&lt;/em&gt; over the non-synthetic method in &lt;em&gt;MyImplBase&lt;/em&gt;.&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
In case this is related: The synthetic bridge method is selected when using reflection as well, causing the inferred type by javac and reflection to diverge:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Method getValueMethod = MyImpl.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;getValue&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; MyImpl.getValue() &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
Workarounds:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Disable static compilation&lt;/li&gt;
	&lt;li&gt;An explicit cast to Long in SimpleCaller.&lt;/li&gt;
	&lt;li&gt;Explicitly repeat the covariant method signature in MyImpl&lt;/li&gt;
	&lt;li&gt;If possible, add/Move the implements to MyImplBase - then the synthetic method is in the same class as the real one, which &lt;em&gt;groovyc&lt;/em&gt; is able to detect.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Using generics in the Interface doesn&apos;t work either (probably due to type erasure).&lt;br/&gt;
&#160;&lt;br/&gt;
Seems to be a more generalized issue when compared to the similar &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5003&quot; title=&quot;[PATCH] Fix the problem in handling bridge methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5003&quot;&gt;&lt;del&gt;GROOVY-5003&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13572674">GROOVY-11341</key>
            <summary>@CompileStatic: Compilation fails due to a synthetic bridge method in the subclass</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="peter99">Peter Schmitz</reporter>
                        <labels>
                            <label>CompileStatic</label>
                            <label>groovyc</label>
                    </labels>
                <created>Wed, 20 Mar 2024 10:14:00 +0000</created>
                <updated>Fri, 5 Sep 2025 15:21:49 +0000</updated>
                            <resolved>Fri, 5 Sep 2025 15:21:42 +0000</resolved>
                                    <version>2.4.x</version>
                    <version>2.5.x</version>
                    <version>3.0.21</version>
                    <version>5.0.0-alpha-7</version>
                    <version>4.0.20</version>
                                    <fixVersion>5.0.0-alpha-8</fixVersion>
                                    <component>Static compilation</component>
                    <component>Static Type Checker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17829904" author="emilles" created="Fri, 22 Mar 2024 15:12:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/d82ae1715efff292e48f712d71aee8f4b9d7ab77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/d82ae1715efff292e48f712d71aee8f4b9d7ab77&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18018422" author="emilles" created="Fri, 5 Sep 2025 15:21:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/dd37d71e9739a6ad3219c76643ea1f7d8bb33a49&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/dd37d71e9739a6ad3219c76643ea1f7d8bb33a49&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13627584">GROOVY-11746</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12816985">GROOVY-5003</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12811568">GROOVY-7363</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13516723">GROOVY-10897</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1o3t4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>