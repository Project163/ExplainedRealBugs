<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:22:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4980] Named argument constructor doesn&apos;t work for inner classes</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4980</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Outer {
  &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Inner {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name
  }

  def doit() {
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Inner(name: &lt;span class=&quot;code-quote&quot;&gt;&quot;fred&quot;&lt;/span&gt;)
  }
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Outer().doit()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caught: groovy.lang.GroovyRuntimeException: Could not find matching constructor for: Outer$Inner(Outer, java.util.LinkedHashMap)
	at Outer.doit(OuterF.groovy:7)
	at OuterF.run(OuterF.groovy:11)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12815797">GROOVY-4980</key>
            <summary>Named argument constructor doesn&apos;t work for inner classes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="pniederw">Peter Niederwieser</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Aug 2011 17:58:28 +0000</created>
                <updated>Fri, 14 Oct 2011 00:28:05 +0000</updated>
                            <resolved>Tue, 13 Sep 2011 12:37:33 +0000</resolved>
                                    <version>1.7.10</version>
                                    <fixVersion>1.8.3</fixVersion>
                    <fixVersion>1.9-beta-4</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14471760" author="roshandawrani" created="Tue, 13 Sep 2011 00:34:17 +0000"  >&lt;p&gt;Attaching a patch for review.&lt;/p&gt;</comment>
                            <comment id="14471648" author="blackdrag" created="Tue, 13 Sep 2011 04:48:07 +0000"  >&lt;p&gt;I somehow remember a problem with Class#getEnclosingClass. Some of these methods are working only if the class file bytecode version is really 1.5 or higher. Our default is still 1.4. But since your example is not using 1.5 code and is still working that might not be the case here. Otherwise the patch looks just fine to me&lt;/p&gt;</comment>
                            <comment id="14471761" author="roshandawrani" created="Tue, 13 Sep 2011 05:12:51 +0000"  >&lt;p&gt;1) My understanding was that Groovy version &amp;gt;= 1.7, we only generate V1_5 bytecode (major version = 49) and that&apos;s why we don&apos;t have JDK 1.4 builds anymore for these Groovy versions. Is that incorrect?&lt;/p&gt;

&lt;p&gt;2) Even if our intention is to generate JDK 1.4-compliant code based on features (annotations, generics) being used in the Groovy code, I don&apos;t think it will ever do it in practice. The reason being that ResolveVisitor.resolveGenericsTypes() unconditionally sets usesGenerics = true on every classnode it processes. Due to that the bytecode being generated for class Outer in the example code of this issue is still V1_5 and not V1_3.&lt;/p&gt;

&lt;p&gt;Am I misreading something?&lt;/p&gt;</comment>
                            <comment id="14471737" author="blackdrag" created="Tue, 13 Sep 2011 05:47:37 +0000"  >&lt;p&gt;I am quite sure we don&apos;t produce V1_5 always. But anyway, we should make it the default for all branches&lt;/p&gt;</comment>
                            <comment id="14471632" author="roshandawrani" created="Tue, 13 Sep 2011 05:51:55 +0000"  >&lt;p&gt;So, r u saying that I can assume it is ok to assume V1_5 is default and apply the patch?&lt;/p&gt;</comment>
                            <comment id="14471667" author="blackdrag" created="Tue, 13 Sep 2011 06:51:44 +0000"  >&lt;p&gt;No... I am saying we have to ensure 1.5 is the default first.&lt;/p&gt;</comment>
                            <comment id="14471602" author="roshandawrani" created="Tue, 13 Sep 2011 06:59:40 +0000"  >&lt;p&gt;To me it looks like we only produce V1_5 bytecode anyway. Ensuring that we only produce V1_5 code should be simple by having AsmClassGenerator.getBytecodeVersion() always return Opcodes.V1_5.&lt;/p&gt;

&lt;p&gt;The real questions are:&lt;/p&gt;

&lt;p&gt;a) are we we clear that it&apos;s no longer our intention to try and produce V1_3 bytecode (as was the confusion in an earlier comment here).&lt;/p&gt;

&lt;p&gt;b) your doubt that we don&apos;t always produce V1_5 bytecode as of now even in newer Groovy versions (&amp;gt;= 1.7). When is that, and why is that? If it is really needed, then it&apos;s not my call to always ensure V1_5 code.&lt;/p&gt;</comment>
                            <comment id="14471776" author="blackdrag" created="Tue, 13 Sep 2011 07:20:48 +0000"  >&lt;p&gt;(a) I spoke with Guillaume about that and we agreed that we should migrate to V1_5. &lt;br/&gt;
(b) If you want to see an example of when we produce V1_3 code I suggest you take class X { class Y {}} and look at the generated bytecode. I see there the usage of class version 47, which is V1_3. I would have said we don&apos;t need to go that far and can take the example above, but it actually shows that there is a very uneven handling of these things. Outer get the class version 49, Outer.Inner 47. Since we need 49 on Inner there is still the danger of your patch not working. Anayway... I think the point that 49 is not always used is clear now.&lt;/p&gt;

&lt;p&gt;As for AsmClassGenerator.getBytecodeVersion().. I guess we can change it to always return V1_5 for now, but I think in the long term we have to adjust the logic with CompilerConfiguration as well.&lt;/p&gt;</comment>
                            <comment id="14471723" author="roshandawrani" created="Tue, 13 Sep 2011 07:31:29 +0000"  >&lt;p&gt;True. Misread ResolveVisitor.resolveGenericsTypes()&apos;s &quot;if (types == null) return&quot;. Sorry.&lt;/p&gt;

&lt;p&gt;So, I will change the bytecode version in ASM to V1_5 on 1.8.x and master and then apply this patch. If it becomes clear where adjustments need to be made to CompilerConfiguration, will do that as well.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14471702" author="blackdrag" created="Tue, 13 Sep 2011 08:04:58 +0000"  >&lt;p&gt;I am wondering if we should push that to 1.7 as well&lt;/p&gt;</comment>
                            <comment id="14471762" author="roshandawrani" created="Tue, 13 Sep 2011 08:08:10 +0000"  >&lt;p&gt;Not sure if it makes sense to remove support for V1_3 after 1.7.&quot;10&quot;. &lt;/p&gt;

&lt;p&gt;I would rather 1.7.11 also has the support, but then this fix and ensure-V1_5 go hand in hand. If we want to push this feature to 1.7.x line, we will need to remove support for V1_3 in whatever shape it exists currently.&lt;/p&gt;</comment>
                            <comment id="14471688" author="blackdrag" created="Tue, 13 Sep 2011 08:14:37 +0000"  >&lt;p&gt;I think you are right. Btw, thanks for working on this Roshan&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722976" name="commit-36655bb.diff" size="4718" author="roshandawrani" created="Tue, 13 Sep 2011 00:34:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bn7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>