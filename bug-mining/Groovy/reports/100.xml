<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:55:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-441] Expression in string is expanded at the begin of the string, not where it is defined</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-441</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Consider the following snippet:&lt;/p&gt;

&lt;p&gt;arg     = &quot;test&quot;&lt;br/&gt;
content = &quot;${arg} =&quot;&lt;/p&gt;

&lt;p&gt;if (arg != &quot;something&quot;)&lt;br/&gt;
{&lt;br/&gt;
    content += &quot;?&quot;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;content += &quot;= ${arg}.&quot;&lt;/p&gt;

&lt;p&gt;println content&lt;/p&gt;

&lt;p&gt;This does result in the following output:&lt;/p&gt;

&lt;p&gt;test =?test= .&lt;/p&gt;

&lt;p&gt;The expression in the string added to &apos;content&apos; was expanded at the beginning of the string.&lt;br/&gt;
Strangely this does seem to have something to do with the if statement above it. If the string to which arg is compared to, is changed from &quot;something&quot; to &quot;test&quot;, than the output is correct (i.e. test == test.)&lt;/p&gt;</description>
                <environment>jdk1.4.2_02, WinXP, Groovy from CVS</environment>
        <key id="12812545">GROOVY-441</key>
            <summary>Expression in string is expanded at the begin of the string, not where it is defined</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spullara">Sam Pullara</assignee>
                                    <reporter username="tomdz">Thomas Dudziak</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Apr 2004 15:50:13 +0000</created>
                <updated>Tue, 4 May 2004 13:16:52 +0000</updated>
                            <resolved>Mon, 3 May 2004 22:58:17 +0000</resolved>
                                    <version>1.0-beta-5</version>
                                    <fixVersion>1.0-beta-5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14460341" author="markcc" created="Mon, 3 May 2004 20:31:10 +0000"  >&lt;p&gt;The problem turned out to be an error in how the value array was updated when&lt;br/&gt;
a java.lang.String is added to a GString. The following is the corrected contents&lt;br/&gt;
of the method GString.plus(String):&lt;/p&gt;


&lt;p&gt;    public GString plus(String that) {&lt;br/&gt;
        String[] currentStrings = getStrings();&lt;br/&gt;
        String[] newStrings = null;&lt;br/&gt;
	Object[] newValues = null;&lt;/p&gt;

&lt;p&gt;	newStrings = new String&lt;span class=&quot;error&quot;&gt;&amp;#91;currentStrings.length + 1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
	newValues = new Object&lt;span class=&quot;error&quot;&gt;&amp;#91;getValues().length + 1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
	int lastIndex = currentStrings.length;&lt;br/&gt;
	System.arraycopy(currentStrings, 0, newStrings, 0, lastIndex);&lt;br/&gt;
	System.arraycopy(getValues(), 0, newValues, 0, getValues().length);&lt;br/&gt;
	newStrings&lt;span class=&quot;error&quot;&gt;&amp;#91;lastIndex&amp;#93;&lt;/span&gt; = that;&lt;br/&gt;
	newValues&lt;span class=&quot;error&quot;&gt;&amp;#91;getValues().length&amp;#93;&lt;/span&gt; = &quot;&quot;;&lt;/p&gt;

&lt;p&gt;        final String[] finalStrings = newStrings;&lt;br/&gt;
        return new GString(newValues) {&lt;br/&gt;
            public String[] getStrings() &lt;/p&gt;
{
                return finalStrings;
            }
&lt;p&gt;        };&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;And the following is an addition to GStringTest to check that this is&lt;br/&gt;
working. (This is a simplified version of the code from the bug report,&lt;br/&gt;
which was a great compact demonstration of the problem.)&lt;/p&gt;

&lt;p&gt;    void testStringInMiddle() {&lt;br/&gt;
    	 arg = &quot;test&quot;&lt;br/&gt;
         content = &quot;${arg} =&quot;&lt;br/&gt;
	 content += &quot;?&quot;&lt;br/&gt;
	 content += &quot;= ${arg}.&quot;&lt;br/&gt;
	 assert content == &quot;test =?= test.&quot;&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="14460324" author="spullara" created="Mon, 3 May 2004 22:58:17 +0000"  >&lt;p&gt;Patch from issue applied, tests ran successfully.  Test case should still be added.&lt;/p&gt;</comment>
                            <comment id="14460261" author="markcc" created="Tue, 4 May 2004 13:07:12 +0000"  >&lt;p&gt;More tests to be adding to GStringTest.groovy:&lt;/p&gt;


&lt;p&gt;    void testStringInMiddle() {&lt;br/&gt;
    	 arg = &quot;test&quot;&lt;br/&gt;
         content = &quot;${arg} =&quot;&lt;br/&gt;
	 content += &quot;?&quot;&lt;br/&gt;
	 content += &quot;= ${arg}.&quot;&lt;br/&gt;
	 assert content == &quot;test =?= test.&quot;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    void testTwoStringsInMiddle() {&lt;br/&gt;
    	 a = &quot;---&quot;&lt;br/&gt;
	 b  = &quot;${a} :&quot;&lt;br/&gt;
	 b += &quot;&amp;lt;&amp;lt;&quot;&lt;br/&gt;
	 b += &quot;&amp;gt;&amp;gt;&quot;&lt;br/&gt;
         b += &quot;: ${a}&quot;&lt;br/&gt;
	 assert b == &quot;--- :&amp;lt;&amp;lt;&amp;gt;&amp;gt;: ---&quot;&lt;br/&gt;
    }       &lt;/p&gt;

&lt;p&gt;    void testAlternatingGStrings() {&lt;br/&gt;
    	 a = &quot;---&quot;&lt;br/&gt;
         b = &quot;${a} :&quot;&lt;br/&gt;
	 b += &quot;&amp;lt;&amp;lt;&quot;&lt;br/&gt;
         b += &quot; [&lt;span class=&quot;error&quot;&gt;&amp;#91;${a}&amp;#93;&lt;/span&gt;] &quot;&lt;br/&gt;
         b += &quot;&amp;gt;&amp;gt;&quot;&lt;br/&gt;
         b += &quot;: ${a}&quot;&lt;br/&gt;
	 assert b == &quot;--- :&amp;lt;&amp;lt; [&lt;span class=&quot;error&quot;&gt;&amp;#91;---&amp;#93;&lt;/span&gt;] &amp;gt;&amp;gt;: ---&quot;&lt;br/&gt;
   }&lt;/p&gt;</comment>
                            <comment id="14460235" author="jstrachan" created="Tue, 4 May 2004 13:16:52 +0000"  >&lt;p&gt;patches applied&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cdp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>