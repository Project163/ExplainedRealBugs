<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4170] Currying private methods</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4170</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Private methods cannot be curried any more under 1.7.2. I&apos;m pretty sure the code worked fine under earlier Groovy versions.&lt;/p&gt;

&lt;p&gt;The code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CurryFoo {
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void foo1(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) {
        println &lt;span class=&quot;code-quote&quot;&gt;&apos;Hurray! Foo1 can be curried.&apos;&lt;/span&gt;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void foo2(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) {
        println &lt;span class=&quot;code-quote&quot;&gt;&apos;Hurray! Foo2 can be curried.&apos;&lt;/span&gt;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void bar() {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.&amp;amp;foo1.curry(&lt;span class=&quot;code-quote&quot;&gt;&apos;anything&apos;&lt;/span&gt;, 1).call()
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.&amp;amp;foo2.curry(&lt;span class=&quot;code-quote&quot;&gt;&apos;anything&apos;&lt;/span&gt;, 1).call()
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CurryFoo().bar()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;outputs:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Hurray! Foo1 can be curried.
Caught: java.lang.IllegalArgumentException: To curry 2 argument(s) expect index range 0..-2 but found 0
    at groovyx.gpars.samples.safe.CurryFoo.bar(CurrySample.groovy:30)
    at groovyx.gpars.samples.safe.CurrySample.run(CurrySample.groovy:34)

Process finished with exit code 1 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Roshan Dawrani commented on the mailing list:&lt;br/&gt;
True. Doesn&apos;t work under 1.7.3 as reported and works on 1.6.9.&lt;br/&gt;
This seems to have been caused (unintentionally) by some recent changes in closure currying (rcurry / ncurry).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12818397">GROOVY-4170</key>
            <summary>Currying private methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="roller_vaclav">Vaclav Pech</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Apr 2010 13:25:47 +0000</created>
                <updated>Wed, 23 Jun 2010 15:45:01 +0000</updated>
                            <resolved>Wed, 14 Apr 2010 01:21:51 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.3</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14469340" author="roshandawrani" created="Tue, 13 Apr 2010 16:06:30 +0000"  >&lt;p&gt;I looked a bit into it.&lt;/p&gt;

&lt;p&gt;What is happening is that in MethodClosure, it selects the method that responds to the method whose pointer MethodClosure holds.&lt;/p&gt;

&lt;p&gt;This method selection is made by call &quot;InvokerHelper.getMetaClass(clazz).respondsTo(owner, method)&quot;. While this works ok for non-private methods, it doesn&apos;t for private methods - because method selected for &quot;foo2&quot; is the MOP method &quot;this$2$foo2&quot;.&lt;/p&gt;

&lt;p&gt;Since MethodClosure matches the name to get the # of parameters, in this case, because of the name mismatch, it continues to have 0 as the # of parameters, even though foo2() has 2 parameters - that causes the index calculation to go wrong in CurriedClosure and the newly added check for ncurry/rcurry rejects the code with an exception.&lt;/p&gt;</comment>
                            <comment id="14469352" author="roshandawrani" created="Tue, 13 Apr 2010 16:29:43 +0000"  >&lt;p&gt;Here is the patch I propose. After the matching methods have been found through the call &quot;InvokerHelper.getMetaClass(clazz).respondsTo(owner, method)&quot;, there is no need to further match the name. &lt;/p&gt;

&lt;p&gt;It&apos;s not right to match the name anyway, as for private methods (&quot;foo&quot;), it is the MOP methods(&quot;this$2$foo2&quot;) that receive the call and then delegate to the private methods they cover.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Index: src/main/org/codehaus/groovy/runtime/MethodClosure.java
===================================================================
--- src/main/org/codehaus/groovy/runtime/MethodClosure.java (revision 19867)
+++ src/main/org/codehaus/groovy/runtime/MethodClosure.java (working copy)
@@ -44,7 +44,7 @@
         List&amp;lt;MetaMethod&amp;gt; methods = InvokerHelper.getMetaClass(clazz).respondsTo(owner, method);

         for(MetaMethod m : methods) {
-            if (method.equals(m.getName()) &amp;amp;&amp;amp; m.getParameterTypes().length &amp;gt; maximumNumberOfParameters) {
+            if (m.getParameterTypes().length &amp;gt; maximumNumberOfParameters) {
                 Class[] pt = m.getNativeParameterTypes();
                 maximumNumberOfParameters = pt.length;
                 parameterTypes = pt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479064" author="paulk" created="Tue, 13 Apr 2010 17:10:48 +0000"  >&lt;p&gt;Looks good to me. So, I suspect even though one level of currying was working, if the # of params was wrong, then possibly further currying even prior to the recent changes may have broken things.&lt;/p&gt;</comment>
                            <comment id="14469298" author="roshandawrani" created="Wed, 14 Apr 2010 01:21:51 +0000"  >&lt;p&gt;Fixed.&lt;/p&gt;</comment>
                            <comment id="14479056" author="roller_vaclav" created="Wed, 14 Apr 2010 02:55:01 +0000"  >&lt;p&gt;Wow, that was quick. Thank you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bu5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>