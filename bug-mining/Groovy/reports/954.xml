<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:12:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3498] Closure is magically invoked</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3498</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When the following script is run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi&quot;&lt;/span&gt; }
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The output is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hi
bye
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Even worse is the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo = 3
{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi&quot;&lt;/span&gt; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which results in:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caught: groovy.lang.MissingMethodException: 
No signature of method: java.lang.Integer.call() is applicable for argument types:
(BindingTest2$_run_closure1) values: [BindingTest2$_run_closure1@144b3c7b]
groovy.lang.MissingMethodException: 
No signature of method: java.lang.Integer.call() is applicable for argument types:
(BindingTest2$_run_closure1) values: [BindingTest2$_run_closure1@144b3c7b]
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:54)
	at org.codehaus.groovy.runtime.callsite.PojoMetaClassSite.call(PojoMetaClassSite.java:46)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:43)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:117)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:125)
	at BindingTest2.run(BindingTest2.groovy:1)
	at groovy.lang.GroovyShell.runScriptOrMainOrTestOrRunnable(GroovyShell.java:256)
	at groovy.lang.GroovyShell.run(GroovyShell.java:218)
	at groovy.lang.GroovyShell.run(GroovyShell.java:147)
	at groovy.ui.GroovyMain.processOnce(GroovyMain.java:493)
	at groovy.ui.GroovyMain.run(GroovyMain.java:308)
	at groovy.ui.GroovyMain.process(GroovyMain.java:294)
	at groovy.ui.GroovyMain.processArgs(GroovyMain.java:111)
	at groovy.ui.GroovyMain.main(GroovyMain.java:92)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:108)
	at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="12818029">GROOVY-3498</key>
            <summary>Closure is magically invoked</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="pniederw">Peter Niederwieser</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Apr 2009 09:40:37 +0000</created>
                <updated>Thu, 14 May 2009 10:47:12 +0000</updated>
                            <resolved>Fri, 1 May 2009 13:10:53 +0000</resolved>
                                    <version>1.6.2</version>
                                    <fixVersion>1.6.3</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14466857" author="roshandawrani" created="Thu, 30 Apr 2009 23:41:02 +0000"  >&lt;p&gt;I was looking at the first issue (hi and bye one) and it seems to be caused by the fix made for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-123&quot; title=&quot;Block treated as closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-123&quot;&gt;&lt;del&gt;GROOVY-123&lt;/del&gt;&lt;/a&gt;, &lt;br/&gt;
which seems like an issue reported in the opposite direction.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-123&quot; title=&quot;Block treated as closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-123&quot;&gt;&lt;del&gt;GROOVY-123&lt;/del&gt;&lt;/a&gt; is about compiler treating a {} block as a closure. Because of the fix, Verifier -&amp;gt; filterStatement() gets rid &lt;br/&gt;
of the surrounding ClosureExpression if it is for a parameter-less closure.&lt;/p&gt;

&lt;p&gt;Can someone confirm whether the block {} in code below should be treated as a closure (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3498&quot; title=&quot;Closure is magically invoked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3498&quot;&gt;&lt;del&gt;GROOVY-3498&lt;/del&gt;&lt;/a&gt;) or a regular block (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-123&quot; title=&quot;Block treated as closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-123&quot;&gt;&lt;del&gt;GROOVY-123&lt;/del&gt;&lt;/a&gt;)?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi&quot;&lt;/span&gt; }
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14466899" author="roshandawrani" created="Fri, 1 May 2009 00:00:19 +0000"  >&lt;p&gt;So, just to highlight a bit differently:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi 1&quot;&lt;/span&gt;}
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye 1&quot;&lt;/span&gt;
{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi 2&quot;&lt;/span&gt;}
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye 2&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is changing to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi 1&quot;&lt;/span&gt;
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye 1&quot;&lt;/span&gt;
println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi 2&quot;&lt;/span&gt;
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye 2&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and closure classes are not even being generated. So, it is not that closures are being called magically.&lt;/p&gt;</comment>
                            <comment id="14466948" author="pniederw" created="Fri, 1 May 2009 06:11:32 +0000"  >&lt;p&gt;&amp;gt;Can someone confirm whether the block {} in code below should be treated as a closure (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3498&quot; title=&quot;Closure is magically invoked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3498&quot;&gt;&lt;del&gt;GROOVY-3498&lt;/del&gt;&lt;/a&gt;) or a regular block (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-123&quot; title=&quot;Block treated as closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-123&quot;&gt;&lt;del&gt;GROOVY-123&lt;/del&gt;&lt;/a&gt;)?&lt;br/&gt;
How could { -&amp;gt; be considered a block?&lt;/p&gt;

&lt;p&gt;&amp;gt;So, it is not that closures are being called magically&lt;br/&gt;
That&apos;s the user&apos;s perception.&lt;/p&gt;</comment>
                            <comment id="14466818" author="blackdrag" created="Fri, 1 May 2009 06:32:52 +0000"  >&lt;p&gt;I wrapped the exception lines a little&lt;/p&gt;</comment>
                            <comment id="14466995" author="blackdrag" created="Fri, 1 May 2009 06:34:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-123&quot; title=&quot;Block treated as closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-123&quot;&gt;&lt;del&gt;GROOVY-123&lt;/del&gt;&lt;/a&gt;... omg, that is beta-3 from 5 years ago! This part of the code should not have survived that long... For the first JSR releases (before 1.0) it was decided that free blocks have to be labeled. Unpacking something that looks like a Closure into a block, just because it might be a block and in the process forgetting, that {-&amp;gt;} is actually a closure without parameters and not a block...  I vote for removing that transformation from Verifier#filterStatement&lt;/p&gt;</comment>
                            <comment id="14466888" author="blackdrag" created="Fri, 1 May 2009 06:35:14 +0000"  >&lt;p&gt;I reduced the priority, because this is no critical issue if it could survive 5 years without being seen&lt;/p&gt;</comment>
                            <comment id="14466986" author="roshandawrani" created="Fri, 1 May 2009 07:53:01 +0000"  >&lt;p&gt;I also think that transformation should be removed. I was surprised to see that ClosureExpression being stripped away too.&lt;/p&gt;

&lt;p&gt;So, coming to the 2nd issue reported in the JIRA:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo = 3
{ -&amp;gt; ... }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is being taken as &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo = 3(
{ -&amp;gt; ... }
)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;. which in turn is being taken as&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo = 3.call(
{ -&amp;gt; ... }
)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As far as I know, all these steps are ok and needed. It is not being caused by any transformation. In the very initial AST that is being created based on groovy grammer, it is taken as 3.call({-&amp;gt; ...}), which in this case fails because there is no &quot;call&quot; method on Integer that accepts a closure argument.&lt;/p&gt;

&lt;p&gt;Jochen, do you think something should be corrected there? If yes, based on what conditions (I mean how should that scenario be identified)?&lt;/p&gt;</comment>
                            <comment id="14466946" author="blackdrag" created="Fri, 1 May 2009 08:05:02 +0000"  >&lt;p&gt;it is a non trivial problem to know that in &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo=a
{...}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we want the closure on itself and in &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;foo= list.each
{...}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we do not. But the version with call seems to be wrong to me. I think if the last is a constant, then no closure should be attached. The convention with .call is ok for variables and such, but not for simple constants.&lt;/p&gt;</comment>
                            <comment id="14466914" author="guillaume" created="Fri, 1 May 2009 08:08:33 +0000"  >&lt;p&gt;But strings are constants too, and that means things like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;quoted-method-name&quot;&lt;/span&gt; { &lt;span class=&quot;code-comment&quot;&gt;/* some closure and its statements */&lt;/span&gt; } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;may not work anymore?&lt;/p&gt;</comment>
                            <comment id="14466900" author="blackdrag" created="Fri, 1 May 2009 09:13:45 +0000"  >&lt;p&gt;ah, true, I forgot about them... what do you suggest? Should we try and disallow it if it is no string? Or keep it as is?&lt;/p&gt;</comment>
                            <comment id="14466996" author="roshandawrani" created="Fri, 1 May 2009 10:35:05 +0000"  >&lt;p&gt;Can we please keep it as is? Then I can quickly work on the first part issue? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14466858" author="guillaume" created="Fri, 1 May 2009 10:42:35 +0000"  >&lt;p&gt;I&apos;d tend to keep it as is, actually, yes.&lt;br/&gt;
But something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{ -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&quot;hi&quot;&lt;/span&gt; }
println &lt;span class=&quot;code-quote&quot;&gt;&quot;bye&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is obviously not a block.&lt;br/&gt;
So the closure should not be executed IMHO.&lt;/p&gt;</comment>
                            <comment id="14466928" author="roshandawrani" created="Fri, 1 May 2009 10:47:10 +0000"  >&lt;p&gt;Guillaume, the code you have pointed to is the first issue out of the 2 reported in this JIRA. That&apos;s what I wanted to modify so that it does not become executed by transforming it to a block (through that transformation in Verifier#filterStatement())&lt;/p&gt;

&lt;p&gt;The behavior related to the 2nd issue reported - we want to keep as is, right?&lt;/p&gt;</comment>
                            <comment id="14466820" author="blackdrag" created="Fri, 1 May 2009 11:02:22 +0000"  >&lt;p&gt;yes&lt;/p&gt;</comment>
                            <comment id="14466916" author="roshandawrani" created="Fri, 1 May 2009 13:10:53 +0000"  >&lt;p&gt;Fixed the first issue.&lt;/p&gt;

&lt;p&gt;No changes made for the 2nd one as discussed here.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cosv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>