<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:58:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8579] No bytecode level check is done before producing JDK8+ bytecodes</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8579</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Create a file using a JDK8 static interface method, e.g. &lt;tt&gt;MyScript.groovy&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic

@CompileStatic
Comparator myMethod() {
    Map.Entry.comparingByKey()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Compile using JDK8. On Groovy 3.0, use &lt;tt&gt;-Dgroovy.target.bytecode=1.7&lt;/tt&gt; (not required for 2.5/6).&lt;/p&gt;

&lt;p&gt;Note from &lt;tt&gt;javap -v&lt;/tt&gt; that the bytecode version is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; major version: 51
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and that an InterfaceMethodref to the &lt;tt&gt;Map.Entry&lt;/tt&gt; static interface method exists:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   #48 = InterfaceMethodref #45.#47       // java/util/Map$Entry.comparingByKey:()Ljava/util/Comparator;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now try to use that class in another script, e.g.:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
println &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyScript().myMethod()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You will note this error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.VerifyError: Illegal type at constant pool entry 48 in class MyScript
Exception Details:
  Location:
    MyScript.myMethod()Ljava/util/Comparator; @0: invokestatic
  Reason:
    Constant pool index 48 is invalid
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;For Groovy 2.5/6 you can just run &lt;tt&gt;groovy MyScript.groovy&lt;/tt&gt; to see the VerifyError, though using groovyc will let you see the generated bytecode.&lt;/p&gt;

&lt;p&gt;So there are two problems:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;we should not set bytecode level to be the minimum level for the Groovy version (7 is default for 2.5/6) when producing bytecode requiring JDK8+.&lt;/li&gt;
	&lt;li&gt;we should probably just complain if &lt;tt&gt;groovy.target.bytecode&lt;/tt&gt; is ever set below the minimum value for the particular Groovy version.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13158993">GROOVY-8579</key>
            <summary>No bytecode level check is done before producing JDK8+ bytecodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="paulk">Paul King</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2018 03:20:15 +0000</created>
                <updated>Sun, 17 Nov 2019 07:35:28 +0000</updated>
                            <resolved>Sat, 19 May 2018 15:22:08 +0000</resolved>
                                                    <fixVersion>2.5.0-rc-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16478769" author="githubbot" created="Thu, 17 May 2018 09:02:37 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/709&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8579&quot; title=&quot;No bytecode level check is done before producing JDK8+ bytecodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8579&quot;&gt;&lt;del&gt;GROOVY-8579&lt;/del&gt;&lt;/a&gt;: No bytecode level check is done before producing JDK8+ b&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;ytecode&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/groovy&lt;/a&gt; groovy8579&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/709.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/709.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #709&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a237b8e11483ceef63ff5895de6d60d219cff58d&lt;br/&gt;
Author: Paul King &amp;lt;paulk@...&amp;gt;&lt;br/&gt;
Date:   2018-05-17T09:00:18Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8579&quot; title=&quot;No bytecode level check is done before producing JDK8+ bytecodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8579&quot;&gt;&lt;del&gt;GROOVY-8579&lt;/del&gt;&lt;/a&gt;: No bytecode level check is done before producing JDK8+ bytecode&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16480328" author="githubbot" created="Fri, 18 May 2018 08:18:22 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/709&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/709&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16480550" author="paulk" created="Fri, 18 May 2018 12:00:26 +0000"  >&lt;p&gt;Partially fixed. It now attempts to automatically set the class version to JDK8 when producing JDK8 specfiic bytecode even if the default minimum bytecode version is say 1.7. What remains is a warning/error when the target bytecode is explicitly set to 1.7 and JDK8 specific bytecodes are needed.&lt;/p&gt;</comment>
                            <comment id="16481661" author="paulk" created="Sat, 19 May 2018 15:22:08 +0000"  >&lt;p&gt;I&apos;ll close this off. If we need further warning messages we can do the changes under a separate ticket.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3tnnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>