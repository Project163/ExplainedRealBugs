<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:49:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7750] @Lazy allows instantiation of abstract class</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7750</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given this code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Lazy
Foo foo

&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You&apos;ll get:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.InstantiationException
	at sun.reflect.InstantiationExceptionConstructorAccessorImpl.newInstance(InstantiationExceptionConstructorAccessorImpl.java:48)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
	at org.codehaus.groovy.reflection.CachedConstructor.invoke(CachedConstructor.java:80)
	at org.codehaus.groovy.runtime.callsite.ConstructorSite$ConstructorSiteNoUnwrapNoCoerce.callConstructor(ConstructorSite.java:105)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallConstructor(CallSiteArray.java:60)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:235)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:239)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This isn&apos;t really helpful. If I mistype a method name, Groovy will help me out with suggestions, why not here?&lt;/p&gt;

&lt;p&gt;MODIFICATION by blackdrag:&lt;br/&gt;
@Lazy should recognize this and fail compilation to avoid the initialization of an abstract class.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12936901">GROOVY-7750</key>
            <summary>@Lazy allows instantiation of abstract class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="johann">Johann</reporter>
                        <labels>
                            <label>usability</label>
                    </labels>
                <created>Thu, 4 Feb 2016 22:49:11 +0000</created>
                <updated>Tue, 2 May 2017 02:03:21 +0000</updated>
                            <resolved>Tue, 24 May 2016 12:06:46 +0000</resolved>
                                    <version>2.4.4</version>
                                    <fixVersion>2.5.0-alpha-1</fixVersion>
                                    <component>groovy-runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15283382" author="rahulsom" created="Sat, 14 May 2016 02:29:37 +0000"  >&lt;p&gt;I tried this in 2.4.5&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {
  @Lazy Foo foo
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().foo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It rightly complains &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.InstantiationException
	at Demo.getFoo(ConsoleScript2)
	at ConsoleScript2.run(ConsoleScript2:7)
	at ConsoleScript2.main(ConsoleScript2)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I believe this can be considered fixed.&lt;/p&gt;</comment>
                            <comment id="15283464" author="blackdrag" created="Sat, 14 May 2016 07:24:14 +0000"  >&lt;p&gt;wasn&#180;t the report exactly about getting this exception and not finding the message helpful? Infact this message is from the JVM and we could not do much but catch it and rethrow a better version. The problem though is, how to get a better version. We do not easily know what classes are available, which is different to methods and properties. So I do not see how we could improve this right now.  Well, that is from the exception side&lt;/p&gt;</comment>
                            <comment id="15283465" author="blackdrag" created="Sat, 14 May 2016 07:26:02 +0000"  >&lt;p&gt;I changed this to a bug, because @Lazy should not cause initialization of an abstract class and thus should fail compilation here. I changed title and description accordingly&lt;/p&gt;</comment>
                            <comment id="15284401" author="paulk" created="Mon, 16 May 2016 11:34:22 +0000"  >&lt;p&gt;It is an interesting edge case that raises a few questions in my mind. It should be noted that there are arguably some slight inconsistencies in current behavior even ignoring @Lazy for the moment, e.g. take this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This currently returns a compilation error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;You cannot create an instance from the abstract class &apos;Foo&apos;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, this slight change:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
Foo.newInstance()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;gives the previously mentioned &lt;tt&gt;InstantiationException&lt;/tt&gt;. However, with some metaprogramming, this works fine:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
Foo.metaClass.constructor = { &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo() {} }
Foo.newInstance()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, perhaps the compilation error (which we added 6 years ago) is arguably too strong for a dynamic language - but fine if TypeChecked or CompileStatic were in play. I can&apos;t recall all the discussion but I suspect at the time we were trying to catch a common developer mistake without the benefit of having TypeChecked/CompileStatic as an option. We can&apos;t easily cover all reflective code possibilities so we only handle the most common case. I don&apos;t necessarily have a problem with this inconsistency but I suspect it isn&apos;t well documented.&lt;/p&gt;

&lt;p&gt;So, now looking at the @Lazy situation, I think the case which needs to be handled is the special behavior when no initial value is given and the no-arg constructor is lazily called if needed to create a new instance (that&apos;s the equivalent to the &lt;tt&gt;new Foo()&lt;/tt&gt; case above). If we wanted to be fully dynamic, there isn&apos;t much we can do apart from catching the &lt;tt&gt;InstantiationException&lt;/tt&gt; and re-wrapping it in a nicer way. Ideally, we&apos;d check more rigorously for TypeChecked/CompileStatic but that isn&apos;t simple. If however, we wanted to have some compromise (trading off some dynamic capability in return for catching a few more likely error cases at compile time), then we can easily check the type that would be instantiated for the case when there is no initial value and return a compilation error somewhat similar to the initial compilation exception at the start of this comment.&lt;/p&gt;

&lt;p&gt;So, I&apos;m suggesting that this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {
  @Lazy Foo foo
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;might fail compilation with a message something like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;You cannot lazily create an instance from the abstract class &apos;Foo&apos; for field &apos;foo&apos;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There&apos;ll be other cases which fail with existing errors:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Lazy Foo foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo() &lt;span class=&quot;code-comment&quot;&gt;// existing compilation error
&lt;/span&gt;@Lazy Foo foo = Foo.newInstance() &lt;span class=&quot;code-comment&quot;&gt;// InstantiationException&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15286411" author="githubbot" created="Tue, 17 May 2016 11:08:51 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/334&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7750&quot; title=&quot;@Lazy allows instantiation of abstract class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7750&quot;&gt;&lt;del&gt;GROOVY-7750&lt;/del&gt;&lt;/a&gt;: @Lazy allows instantiation of abstract class&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/groovy&lt;/a&gt; groovy7750&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/334.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/334.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #334&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 58bcbac0f354a7da678fd23b23df196c9edda743&lt;br/&gt;
Author: paulk &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2016-05-17T11:06:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7750&quot; title=&quot;@Lazy allows instantiation of abstract class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7750&quot;&gt;&lt;del&gt;GROOVY-7750&lt;/del&gt;&lt;/a&gt;: @Lazy allows instantiation of abstract class&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15298076" author="paulk" created="Tue, 24 May 2016 12:08:17 +0000"  >&lt;p&gt;Proposed PR merged onto master&lt;/p&gt;</comment>
                            <comment id="15311625" author="githubbot" created="Thu, 2 Jun 2016 02:41:21 +0000"  >&lt;p&gt;Github user paulk-asert closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/334&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sgbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>