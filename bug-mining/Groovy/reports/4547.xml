<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:20:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9089] STC: owner qualifier produces error for nested closures</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9089</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;In the example script below, the use of the &quot;owner&quot; qualifier causes an error.  Replace with &quot;delegate&quot; and no error.  Disable static compilation and no error.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C1 {
  void m() {
    print &lt;span class=&quot;code-quote&quot;&gt;&apos;outer delegate&apos;&lt;/span&gt;
  }
}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C2 {
  void m() {
    print &lt;span class=&quot;code-quote&quot;&gt;&apos;inner delegate&apos;&lt;/span&gt;
  }
}
void outer(@DelegatesTo(value = C1) Closure block) {
  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C1()
  block()
}
void inner(@DelegatesTo(value = C2, strategy = Closure.DELEGATE_FIRST) Closure block) {
  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C2()
  block()
}

@groovy.transform.CompileStatic &lt;span class=&quot;code-comment&quot;&gt;// comment out and script prints &lt;span class=&quot;code-quote&quot;&gt;&quot;outer delegate&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; expected
&lt;/span&gt;void test() {
  outer {
    inner {
      owner.m() &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot find matching method Script#m(). Please check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the declared type is right and &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the method exists.&quot;&lt;/span&gt;
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// replace &lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt; with &lt;span class=&quot;code-quote&quot;&gt;&quot;delegate&quot;&lt;/span&gt; and CompileStatic has no error and prints &lt;span class=&quot;code-quote&quot;&gt;&quot;inner delegate&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;as&lt;/span&gt; expected
&lt;/span&gt;    }
  }
}

test()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13228687">GROOVY-9089</key>
            <summary>STC: owner qualifier produces error for nested closures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="emilles">Eric Milles</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Apr 2019 19:41:51 +0000</created>
                <updated>Sun, 23 Oct 2022 11:14:36 +0000</updated>
                            <resolved>Fri, 30 Aug 2019 17:46:18 +0000</resolved>
                                    <version>3.0.0-alpha-4</version>
                    <version>2.5.6</version>
                                    <fixVersion>3.0.0-beta-1</fixVersion>
                    <fixVersion>2.5.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16831175" author="emilles" created="Wed, 1 May 2019 18:42:45 +0000"  >&lt;p&gt;My thought is to have &lt;tt&gt;StaticTypeCheckingVisitor.makeOwnerList&lt;/tt&gt; handle &quot;owner&quot;, &quot;delegate&quot; and &quot;thisObject&quot; in the object expression.  This is the sequence that gathers potential sources for method &quot;m&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                &lt;span class=&quot;code-comment&quot;&gt;// method call receivers are :
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;//   - possible &lt;span class=&quot;code-quote&quot;&gt;&quot;with&quot;&lt;/span&gt; receivers
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;//   - the actual receiver as found in the method call expression
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;//   - any of the potential receivers found in the &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; temporary table
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// in that order
&lt;/span&gt;                List&amp;lt;Receiver&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; receivers = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedList&amp;lt;Receiver&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt;();
                List&amp;lt;Receiver&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; owners = makeOwnerList(objectExpression);
                addReceivers(receivers, owners, call.isImplicitThis());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Currently the owners list is populated only with the enclosing class.  This seems odd for an object expression &quot;owner&quot;.&lt;/p&gt;</comment>
                            <comment id="16831182" author="emilles" created="Wed, 1 May 2019 18:46:12 +0000"  >&lt;p&gt;Before doing any of that, this bit in &lt;tt&gt;StaticTypeCheckingVisitor.visitVariableExpression&lt;/tt&gt; is not setup for nested closures:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        TypeCheckingContext.EnclosingClosure enclosingClosure = typeCheckingContext.getEnclosingClosure();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (enclosingClosure != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            /* GRECLIPSE edit -- GROOVY-9089
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = vexp.getName();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (name.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt;) || name.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;thisObject&quot;&lt;/span&gt;)) {
                storeType(vexp, typeCheckingContext.getEnclosingClassNode());
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;delegate&quot;&lt;/span&gt;.equals(name)) {
                DelegationMetadata md = getDelegationMetadata(enclosingClosure.getClosureExpression());
                ClassNode type = typeCheckingContext.getEnclosingClassNode();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (md != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) type = md.getType();
                storeType(vexp, type);
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
            }
            */
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (vexp.getName()) {
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;delegate&quot;&lt;/span&gt;:
                DelegationMetadata md = getDelegationMetadata(enclosingClosure.getClosureExpression());
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (md != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    storeType(vexp, md.getType());
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
                }
                &lt;span class=&quot;code-comment&quot;&gt;// falls through
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt;:
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (typeCheckingContext.getEnclosingClosureStack().size() &amp;gt; 1) {
                    storeType(vexp, CLOSURE_TYPE);
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
                }
                &lt;span class=&quot;code-comment&quot;&gt;// falls through
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;thisObject&quot;&lt;/span&gt;:
                storeType(vexp, typeCheckingContext.getEnclosingClassNode());
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
            }
            &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE end
&lt;/span&gt;        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16831220" author="emilles" created="Wed, 1 May 2019 19:56:00 +0000"  >&lt;p&gt;And the change to &lt;tt&gt;makeOwnerList&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; List&amp;lt;Receiver&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; makeOwnerList(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression objectExpression) {
        ...
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (typeCheckingContext.lastImplicitItType != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
                &amp;amp;&amp;amp; objectExpression &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; VariableExpression
                &amp;amp;&amp;amp; ((VariableExpression) objectExpression).getName().equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;it&quot;&lt;/span&gt;)) {
            owners.add(Receiver.&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;make(typeCheckingContext.lastImplicitItType));
        }
        &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE add -- GROOVY-9089
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (typeCheckingContext.delegationMetadata != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
                &amp;amp;&amp;amp; objectExpression &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; VariableExpression
                &amp;amp;&amp;amp; ((VariableExpression) objectExpression).getName().equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt;)
                &amp;amp;&amp;amp; &lt;span class=&quot;code-comment&quot;&gt;/*isNested:*/&lt;/span&gt;typeCheckingContext.delegationMetadata.getParent() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            owners.clear();
            List&amp;lt;Receiver&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; enclosingClass = Collections.singletonList(
                Receiver.&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;make(typeCheckingContext.getEnclosingClassNode()));
            addReceivers(owners, enclosingClass, typeCheckingContext.delegationMetadata.getParent(), &lt;span class=&quot;code-quote&quot;&gt;&quot;owner.&quot;&lt;/span&gt;);
         }
        &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE end
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; owners;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16831227" author="emilles" created="Wed, 1 May 2019 20:16:45 +0000"  >&lt;p&gt;This will not support path expressions like &quot;owner.owner.something&quot; or &quot;owner.delegate.something&quot;.  They continue to show an error.&lt;/p&gt;</comment>
                            <comment id="16833973" author="paulk" created="Mon, 6 May 2019 16:25:50 +0000"  >&lt;p&gt;After apply your change, the test suite passes but the above test case now fails with:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;java.lang.ClassCastException: C1 cannot be cast to groovy.lang.Closure&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This then looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9063&quot; title=&quot;Groovy 2.5.6 @CompileStatic generates invalid bytecode (leading to runtime ClassCastException) when accessing protected instance member from 2 level of nested closures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9063&quot;&gt;&lt;del&gt;GROOVY-9063&lt;/del&gt;&lt;/a&gt; to me.&lt;/p&gt;</comment>
                            <comment id="16833985" author="emilles" created="Mon, 6 May 2019 16:43:41 +0000"  >&lt;p&gt;This assumes &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9086&quot; title=&quot;@CompileStatic of closure calls with OWNER_FIRST fail at runtime with ClassCastException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9086&quot;&gt;&lt;del&gt;GROOVY-9086&lt;/del&gt;&lt;/a&gt; changes were applied.  It appears those have been applied to master.  I&apos;m checking my history for any other changes that may have been missed.&lt;/p&gt;</comment>
                            <comment id="16834008" author="emilles" created="Mon, 6 May 2019 17:02:36 +0000"  >&lt;p&gt;The change for 9007 was not made quite the same as I indicated.  In the new method &lt;tt&gt;StaticTypeCheckingVisitor.checkOrMarkInnerPropertyOwnerAccess&lt;/tt&gt;, there is a check &lt;tt&gt;typeCheckingContext.getEnclosingClosure() != null&lt;/tt&gt;.  However, this should be &lt;tt&gt;typeCheckingContext.getEnclosingClosureStack().size() == 1&lt;/tt&gt; so that the new &lt;tt&gt;addReceivers&lt;/tt&gt; stuff from 9086 applies to nested closures (stack depth &amp;gt; 1).&lt;/p&gt;</comment>
                            <comment id="16834217" author="paulk" created="Mon, 6 May 2019 21:46:41 +0000"  >&lt;p&gt;Yes, just fixed that - sorry I misread what was happening there. That fixes the &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9063&quot; title=&quot;Groovy 2.5.6 @CompileStatic generates invalid bytecode (leading to runtime ClassCastException) when accessing protected instance member from 2 level of nested closures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9063&quot;&gt;&lt;del&gt;GROOVY-9063&lt;/del&gt;&lt;/a&gt; but not the example here.&lt;/p&gt;</comment>
                            <comment id="16834233" author="emilles" created="Mon, 6 May 2019 22:15:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt;, my commits are here: &lt;a href=&quot;https://github.com/groovy/groovy-eclipse/commits/master&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-eclipse/commits/master&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Should be April 30th or newer.&lt;/p&gt;

&lt;p&gt;Here are my two test cases that get compiled and executed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test &lt;span class=&quot;code-comment&quot;&gt;// https://issues.apache.org/jira/browse/GROOVY-9089
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompileStatic9089() {
        &lt;span class=&quot;code-comment&quot;&gt;//@formatter:off
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Script.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C1 {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  void m() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    print &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; delegate&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C2 {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  void m() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    print &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; delegate&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&apos;rawtypes&apos;&lt;/span&gt;)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;(@DelegatesTo(value = C1) Closure block) {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C1()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&apos;rawtypes&apos;&lt;/span&gt;)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;(@DelegatesTo(value = C2, strategy = Closure.DELEGATE_FIRST) Closure block) {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C2()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@groovy.transform.CompileStatic\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void test() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;      owner.m()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;test()\n&quot;&lt;/span&gt;,
        };
        &lt;span class=&quot;code-comment&quot;&gt;//@formatter:on
&lt;/span&gt;
        runConformTest(sources, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; delegate&quot;&lt;/span&gt;);
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompileStatic9089a() {
        &lt;span class=&quot;code-comment&quot;&gt;//@formatter:off
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sources = {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;Script.groovy&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C1 {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  void m() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    print &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; delegate&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C2 {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  void m() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    print &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; delegate&apos;&lt;/span&gt;\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&apos;rawtypes&apos;&lt;/span&gt;)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt;(@DelegatesTo(value = C1) Closure block) {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C1()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&apos;rawtypes&apos;&lt;/span&gt;)\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;(@DelegatesTo(value = C2, strategy = Closure.OWNER_FIRST) Closure block) {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block.delegate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C2()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  block()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;@groovy.transform.CompileStatic\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;void test() {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; {\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;      delegate.m()\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;    }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;  }\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;}\n&quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;test()\n&quot;&lt;/span&gt;,
        };
        &lt;span class=&quot;code-comment&quot;&gt;//@formatter:on
&lt;/span&gt;
        runConformTest(sources, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; delegate&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16834266" author="paulk" created="Mon, 6 May 2019 23:16:55 +0000"  >&lt;p&gt;I have merged the suggested changes under the related &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9063&quot; title=&quot;Groovy 2.5.6 @CompileStatic generates invalid bytecode (leading to runtime ClassCastException) when accessing protected instance member from 2 level of nested closures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9063&quot;&gt;&lt;del&gt;GROOVY-9063&lt;/del&gt;&lt;/a&gt; along with its testcase. I&apos;ll leave this open for now.&lt;/p&gt;</comment>
                            <comment id="16919772" author="emilles" created="Fri, 30 Aug 2019 17:46:18 +0000"  >&lt;p&gt;This was resolved with changes linked to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9063&quot; title=&quot;Groovy 2.5.6 @CompileStatic generates invalid bytecode (leading to runtime ClassCastException) when accessing protected instance member from 2 level of nested closures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9063&quot;&gt;&lt;del&gt;GROOVY-9063&lt;/del&gt;&lt;/a&gt;.  Test case refactor for proof was recently merged as well.&lt;/p&gt;</comment>
                            <comment id="17622782" author="emilles" created="Sun, 23 Oct 2022 11:14:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/dac95aef0374abd569c10c0104c16d8b05dd80d3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/dac95aef0374abd569c10c0104c16d8b05dd80d3&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 3 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z01wa0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>