<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:39:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6605] Object ranges should be inferred as Range&lt;Object&gt; for improved fluency</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6605</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code fails with &lt;tt&gt;master&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BigInteger iterative(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BigInteger n) {
    validateParameter(n)
    BigInteger total = 1G
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (n &amp;gt; 1) { (2G..n).each{BigInteger i -&amp;gt; total *= i } }
    total
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The reason is that the inferred type of the big integer range is not &lt;tt&gt;Range&amp;lt;BigInteger&amp;gt;&lt;/tt&gt; but the concrete type &lt;tt&gt;ObjectRange&lt;/tt&gt;. Unfortunately, this type is not generified in the Groovy codebase and can&apos;t be without breaking binary compatibility.&lt;/p&gt;

&lt;p&gt;As a workaround, the inferred type should be &lt;tt&gt;Range&amp;lt;BigInteger&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12817311">GROOVY-6605</key>
            <summary>Object ranges should be inferred as Range&lt;Object&gt; for improved fluency</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="melix">C&#233;dric Champeau</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Mar 2014 07:09:23 +0000</created>
                <updated>Tue, 4 Mar 2014 16:31:45 +0000</updated>
                            <resolved>Mon, 3 Mar 2014 07:19:41 +0000</resolved>
                                    <version>2.2.2</version>
                                    <fixVersion>2.3.0-beta-1</fixVersion>
                    <fixVersion>2.2.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14475592" author="russel" created="Mon, 3 Mar 2014 09:37:59 +0000"  >&lt;p&gt;Sponditious, fixed before I entered the issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;There is one left though, to with trampolines:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BigInteger tailRecursiveTrampoline(BigInteger n) {
    validateParameter(n)
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Closure&amp;lt;BigInteger&amp;gt; iterate
    iterate = {BigInteger i, BigInteger result -&amp;gt; i &amp;lt; 2 ? result : iterate.trampoline(i - 1, result * i)}.trampoline()
    (BigInteger) iterate(n, 1G)
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;leads to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:
file:/home/users/russel/Progs/Applications/Factorial/Groovy/Factorial_simple.groovy: 73: [Static type checking] - Incompatible &lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt; argument types. Cannot assign groovy.lang.Closure &amp;lt;java.io.Serializable&amp;gt; to: groovy.lang.Closure &amp;lt;BigInteger&amp;gt;
 @ line 73, column 15.
       iterate = {BigInteger i, BigInteger result -&amp;gt; i &amp;lt; 2 ? result : iterate.trampoline(i - 1, result * i)}.trampoline()
                 ^
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14475532" author="melix" created="Mon, 3 Mar 2014 09:52:54 +0000"  >&lt;p&gt;I don&apos;t think it&apos;s an error here, but rather a limit of the type system. In:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;i&amp;lt;2 ? result : iterate.trampoline(i - 1, result * i)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;tt&gt;result&lt;/tt&gt; is a &lt;tt&gt;BigInteger&lt;/tt&gt;, while &lt;tt&gt;iterate.trampoline(i-1, result *i)&lt;/tt&gt; returns a &lt;tt&gt;Closure&amp;lt;BigInteger&amp;gt;&lt;/tt&gt;. This makes me wonder how this code actually works &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;However, rewriting as this would pass:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*
@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BigInteger tailRecursiveTrampoline(BigInteger n) {
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Closure&amp;lt;BigInteger&amp;gt; iterate
    iterate = {BigInteger i, BigInteger result -&amp;gt; i &amp;lt; 2 ? result : (BigInteger) iterate.trampoline(i - 1, result * i)()}.trampoline()
    iterate(n, 1G)
  }
  
tailRecursiveTrampoline(5)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(note that the inner trampoline closure is called)&lt;/p&gt;</comment>
                            <comment id="14475561" author="russel" created="Mon, 3 Mar 2014 11:52:51 +0000"  >&lt;p&gt;OK, that bit in the middle is worrying &quot;how this code actually works&quot;, if you don&apos;t know, I certainly don&apos;t &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Type issue: with a ? x : y I would have thought the type checker would demand that x and y were of compatible types BigInteger and Closure&amp;lt;BigInteger&amp;gt; are not compatible in that sense. However the code definitely works at run time with CompileStatic but type checking skipped. So there must be an implicit function call executed.&lt;/p&gt;

&lt;p&gt;Having had the issue pointed out, I prefer your variant anyway so will switch to that. However it does leave a mystery to resolve.&lt;/p&gt;</comment>
                            <comment id="14475548" author="russel" created="Mon, 3 Mar 2014 11:59:06 +0000"  >&lt;p&gt;OK, this is getting very weird, the trampoline is now creating a stack overflow: it isn&apos;t actually trampolining.&lt;/p&gt;

&lt;p&gt;Hang on. I know how this works. &lt;em&gt;iterate&lt;/em&gt; returns a trampoline not a value until the last iteration when it returns a value so the version with the extra () must be wrong. Perhaps this is a case where the only type has to be Object.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cpjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>