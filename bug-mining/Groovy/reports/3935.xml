<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:09:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6453] groovysh in Windows 7/8/10 doesn&apos;t support arrow keys and Del</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6453</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have bare windows 8 with fresh JDK. I run Groovysh in cmd.exe.&lt;br/&gt;
Groovysh 2.1.9 works as expected.&lt;/p&gt;

&lt;p&gt;Groovysh 2.2.0 doesn&apos;t react to arrow keys and Del, i.e. up key doesn&apos;t show previous command, left key doesn&apos;t shift cursor etc.&lt;/p&gt;

&lt;p&gt;After some investigation I found what is working:&lt;br/&gt;
ctrl-a   go to beginning of line&lt;br/&gt;
ctrl-e   go to End of line&lt;br/&gt;
ctrl-f   go Forward one char&lt;br/&gt;
ctrl-b   go Backward one char&lt;br/&gt;
ctrl-d   delete the char&lt;br/&gt;
ctrl-h   and backspace = delete left char&lt;br/&gt;
ctrl-p   recall previous line&lt;br/&gt;
ctrl-n   recall next line&lt;br/&gt;
ctrl-s   search&lt;br/&gt;
ctrl-r   reverse search &lt;br/&gt;
It&apos;s nice and feel myself like a Linux hacker, but I want arrow keys too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I tried different options:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;upgrade jline2.10 to 2.11 - no effect&lt;/li&gt;
	&lt;li&gt;--terminal=unix - it helps, but duplicate prompt (groovy:000&amp;gt;) and no more colors in console&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Looks like problem lies in new jline v2 (groovysh 2.1.9 uses jline1.0)&lt;/p&gt;</description>
                <environment>Windows 8, 64bit (v6.2, build 9200), java version &amp;quot;1.7.0_45&amp;quot; SE Runtime Environment (build 1.7.0_45-b18) HotSpot 64-Bit Server VM (build 24.45-b08, mixed mode), Russian locale (!)</environment>
        <key id="12818474">GROOVY-6453</key>
            <summary>groovysh in Windows 7/8/10 doesn&apos;t support arrow keys and Del</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="rybin.andrey@gmail.com">Andrew P Fink</reporter>
                        <labels>
                            <label>console</label>
                            <label>jline</label>
                    </labels>
                <created>Mon, 25 Nov 2013 04:36:18 +0000</created>
                <updated>Mon, 7 Dec 2020 22:09:43 +0000</updated>
                            <resolved>Wed, 11 Nov 2020 08:31:18 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>3.0.7</fixVersion>
                    <fixVersion>4.0.0-alpha-2</fixVersion>
                                    <component>Groovysh</component>
                        <due></due>
                            <votes>10</votes>
                                    <watches>17</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="14475279" author="graemerocher" created="Tue, 26 Nov 2013 09:32:30 +0000"  >&lt;p&gt;Reported JLine issue &lt;a href=&quot;https://github.com/jline/jline2/issues/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jline/jline2/issues/115&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14475255" author="graemerocher" created="Tue, 26 Nov 2013 10:31:24 +0000"  >&lt;p&gt;Original issue &lt;a href=&quot;https://github.com/jline/jline2/issues/100&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jline/jline2/issues/100&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;115 was closed as a duplicate&lt;/p&gt;</comment>
                            <comment id="14475298" author="pschumacher" created="Tue, 26 Nov 2013 12:09:49 +0000"  >&lt;p&gt;Apparently this error does not occur for all locales. I can replicate it with Windows 7 and a german locale.&lt;/p&gt;

&lt;p&gt;This workaround mentioned in the jline issue works for me: &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The other, less nice, workaround is to just use (assuming emacs mode) Control-n for down and Control-p for up&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14475735" author="pschumacher" created="Sat, 12 Apr 2014 03:59:17 +0000"  >&lt;p&gt;The jline 2 issue was &lt;a href=&quot;https://github.com/jline/jline2/pull/134&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fixed&lt;/a&gt;. Now we just have to wait for a jline 2 release.&lt;/p&gt;</comment>
                            <comment id="14476089" author="webczat" created="Sat, 7 Jun 2014 08:36:25 +0000"  >&lt;p&gt;Actually the issue was fixed, but arrows still don&apos;t work and I believe it is groovy&apos;s fault this time.&lt;br/&gt;
I&apos;ve tested jline-2.11 and 2.12 and a custom test application, 2.11 gives some strange characters when pressing arrows, 2.12 works.&lt;br/&gt;
Note that when groovy is running and jline-2.11 is used nothing at all shows on the screen when pressing arrows, and trace does not give the event on keypress, the same in jline 2.12.&lt;/p&gt;</comment>
                            <comment id="14476071" author="webczat" created="Sun, 8 Jun 2014 05:10:16 +0000"  >&lt;p&gt;This bug is caused by the fact that jline2 now reads keys from console using winapi functions, but before that, it checks if the InputStream passed to the ConsoleReader is System.in or a FileInputStream attached to the stdin file descriptor.&lt;br/&gt;
groovysh wraps System.in in it&apos;s own stream and that causes this problem.&lt;br/&gt;
I&apos;ve tested it using a program that just created a ConsoleReader and performed reader.readLine() in an infinite loop.&lt;br/&gt;
Everything was ok when System.in was passed, but it broke when System.in has been wrapped in a BufferedInputStream.&lt;br/&gt;
The results were identical.&lt;/p&gt;</comment>
                            <comment id="14476016" author="pschumacher" created="Mon, 9 Jun 2014 03:45:14 +0000"  >&lt;p&gt;Hi Micha,&lt;/p&gt;

&lt;p&gt;thanks for your analysis. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Any ideas on how to fix this?&lt;/p&gt;</comment>
                            <comment id="14476029" author="webczat" created="Mon, 9 Jun 2014 04:28:39 +0000"  >&lt;p&gt;Actually, I am not sure, because I do not know what this wrapper stream is doing.&lt;br/&gt;
The easiest thing would be to just remove a wrapper completely.&lt;br/&gt;
If you would reset System.in to a wrapper it will work but I believe it would skip the wrapper completely, because jline uses windows console api to read keys in this case and does not probably use System.in.&lt;br/&gt;
I didn&apos;t do an in-depth analysis of everything, so I am not sure about the possible ways to go except removing a wrapper.&lt;/p&gt;</comment>
                            <comment id="14476088" author="lhotari" created="Tue, 10 Jun 2014 00:43:40 +0000"  >&lt;p&gt;jline 2.12 is available in maven central now &lt;a href=&quot;http://search.maven.org/#artifactdetails%7Cjline%7Cjline%7C2.12%7Cjar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://search.maven.org/#artifactdetails%7Cjline%7Cjline%7C2.12%7Cjar&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476101" author="lhotari" created="Wed, 11 Jun 2014 13:13:22 +0000"  >&lt;p&gt;FYI, We are using jline 2.12 in Grails now. Jline has changed the way how UnixTerminal.restore() behaves. &lt;br/&gt;
We had to do this hack for Grails:&lt;br/&gt;
&lt;a href=&quot;https://github.com/grails/grails-core/commit/113d9c2b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/grails/grails-core/commit/113d9c2b&lt;/a&gt;&lt;br/&gt;
because of this change in jline 2.12:&lt;br/&gt;
&lt;a href=&quot;https://github.com/jline/jline2/commit/187cc08f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jline/jline2/commit/187cc08f&lt;/a&gt;&lt;br/&gt;
Just to make you aware of the problems we had in Grails when upgrading to jline 2.12 . &lt;br/&gt;
jline 2.12 did fix the issues with Windows terminals.&lt;/p&gt;

&lt;p&gt;It might be better to use something like this in a shell script to save and restore terminal settings:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;saved_terminal_settings=$(stty -g)
call the app
stty &lt;span class=&quot;code-quote&quot;&gt;&quot;$saved_terminal_settings&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this is what jline is trying to do, but for some reason that doesn&apos;t work for Grails.&lt;/p&gt;</comment>
                            <comment id="14476123" author="glockenstein" created="Wed, 2 Jul 2014 10:17:47 +0000"  >&lt;p&gt;I tested the beta of groovy 2.4.0 with jline 2.12 under windows 7 and arrow keys still do not work.&lt;/p&gt;</comment>
                            <comment id="14503093" author="webczat" created="Mon, 20 Apr 2015 16:07:51 +0000"  >&lt;p&gt;As I said few months ago, this is &lt;b&gt;NOT&lt;/b&gt; a jline bug, but a groovy bug (see comments above). And I am not surprised it still doesn&apos;t work, and it seems that it also doesn&apos;t work for my friend (I myself still didn&apos;t update groovy to the latest version actually).&lt;/p&gt;</comment>
                            <comment id="14562032" author="wayyoung" created="Thu, 28 May 2015 00:00:11 +0000"  >&lt;p&gt;I am using groovysh 2.4.3 + jline2 2.12.1 on windows 7 with Chinese locale. &lt;br/&gt;
The arrow keys are not worked.&lt;br/&gt;
As your analyzing, I modified the isSystemIn(...) in WindowsTerminal.java from jline2 to always return true.&lt;br/&gt;
Now the arrow keys are worked.&lt;br/&gt;
Thank you very much!!&lt;/p&gt;</comment>
                            <comment id="14581964" author="webczat" created="Thu, 11 Jun 2015 14:17:29 +0000"  >&lt;p&gt;Okay, but this still should be fixed, and actually it is not a jline bug, unless we expect jline to add an override that says: this is really a console. Othervise groovy has to do something.&lt;/p&gt;</comment>
                            <comment id="14586184" author="pluradj" created="Mon, 15 Jun 2015 15:21:05 +0000"  >&lt;p&gt;This works for me to enable arrow keys `-Djline.terminal=none`.&lt;/p&gt;

&lt;p&gt;I haven&apos;t spent a long time in these packages, so I&apos;m not really clear what I&apos;m missing out on with this setting &amp;#8211; see WindowsTerminal.java from jline, and the WrappedInputStream usage in InteractiveShellRunner.groovy from groovy-groovysh. jline doesn&apos;t detect that the input stream is actually stdin because groovysh wrappers it.&lt;/p&gt;

&lt;p&gt;jline acknowledges that it is a bit messy...&lt;br/&gt;
&lt;a href=&quot;https://github.com/jline/jline2/blob/master/src/main/java/jline/WindowsTerminal.java#L77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jline/jline2/blob/master/src/main/java/jline/WindowsTerminal.java#L77&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jline/jline2/blob/master/src/main/java/jline/WindowsTerminal.java#L170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jline/jline2/blob/master/src/main/java/jline/WindowsTerminal.java#L170&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/incubator-groovy/blob/master/subprojects/groovy-groovysh/src/main/groovy/org/codehaus/groovy/tools/shell/InteractiveShellRunner.groovy#L49&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/blob/master/subprojects/groovy-groovysh/src/main/groovy/org/codehaus/groovy/tools/shell/InteractiveShellRunner.groovy#L49&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15131053" author="deisner" created="Wed, 3 Feb 2016 20:16:57 +0000"  >&lt;p&gt;&quot;I&apos;m not really clear what I&apos;m missing out on with this setting&quot;&lt;/p&gt;

&lt;p&gt;In my case (groovysh launced from Windows 7 cmd.exe), setting jline.terminal to none does fix the arrow key history browsing, but it breaks tab-completion. :^(&lt;/p&gt;</comment>
                            <comment id="16252235" author="qaston" created="Tue, 14 Nov 2017 21:45:39 +0000"  >&lt;p&gt;You can add the following code to your groovy.rc as a workaround:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@groovy.transform.InheritConstructors
class WindowsTerminalControlCharFix extends jline.WindowsTerminal {
	@Override
	protected boolean isSystemIn(java.io.InputStream i) throws IOException {
			// groovysh wraps the input stream in WrappedInputStream, need to handle this case properly to enable windows controll character handling
			if (i instanceof org.codehaus.groovy.tools.shell.util.WrappedInputStream) {
					return super.isSystemIn(((org.codehaus.groovy.tools.shell.util.WrappedInputStream)i).wrapped);
			}
			return super.isSystemIn(i);
	}
}

// if no terminal specified use a version of windows terminal class that handles windows control characters properly - see https://issues.apache.org/jira/browse/GROOVY-6453
if (!System.getProperty(&quot;jline.terminal&quot;)) {
	jline.TerminalFactory.registerFlavor(jline.TerminalFactory.Flavor.WINDOWS, WindowsTerminalControlCharFix.class);
	System.setProperty(&quot;jline.terminal&quot;,&quot;win&quot;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16666760" author="guyr" created="Mon, 29 Oct 2018 05:28:53 +0000"  >&lt;p&gt;Found this via search.&#160; I&apos;m on Windows 7 64-bit, and tried both groovy-2.6.0-alpha-3 and groovy-3.0.0-alpha-3.&#160; Cursor keys are not working in either one.&#160; I&apos;m surprised to see this issue is now 5 years old.&#160; Is there some basic restriction preventing this from being corrected in groovysh?&lt;/p&gt;

&lt;p&gt;I tried creating a groovy.rc file containing the contents from the previous post by Dariusz Antoniuk, but don&apos;t know where to put it.&#160; I tried in \groovy-3.0.0-alpha-3\bin, \groovy-3.0.0-alpha-3\conf, and C:\Users\&amp;lt;myusername&amp;gt;\.groovy, and it still didn&apos;t work.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;UPDATE&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Found this post that says the file to update is actually groovysh.rc.&#160; &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/52898321/groovysh-rc-file-breaks-groovysh-evaluate-switch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/52898321/groovysh-rc-file-breaks-groovysh-evaluate-switch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So I updated that in my home directory.&#160; Now I&apos;m getting a NullPointerException:&lt;/p&gt;

&lt;p&gt;D:\&amp;gt;groovysh&lt;br/&gt;
Picked up JAVA_TOOL_OPTIONS: -Duser.timezone=GMT&lt;br/&gt;
FATAL: java.lang.NullPointerException&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.util.concurrent.ConcurrentHashMap.replaceNode(ConcurrentHashMap.java:1106)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.util.concurrent.ConcurrentHashMap.remove(ConcurrentHashMap.java:1097)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.memoize.UnlimitedConcurrentCache.remove(UnlimitedConcurrentCache.java:70)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at groovy.lang.GroovyClassLoader.removeClassCacheEntry(GroovyClassLoader.java:640)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PlainObjectMetaMethodSite.doInvoke(PlainObjectMetaMethodSite.jav&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrapNoCoerce.invoke(P&lt;br/&gt;
ethodSite.java:213)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:55)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Interpreter.evaluate(Interpreter.groovy:96)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Evaluator$evaluate.call(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh.evaluateWithStoredBoundVars(Groovysh.groovy:263)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PlainObjectMetaMethodSite.doInvoke(PlainObjectMetaMethodSite.jav&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSiteNoUnwrapNoCoerce.invoke(P&lt;br/&gt;
ethodSite.java:190)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:58)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:51)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:157)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:177)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh.execute(Groovysh.groovy:204)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Shell.leftShift(Shell.groovy:122)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Shell$leftShift$0.call(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.commands.LoadCommand$_load_closure1.doCall(LoadCommand.groovy:86)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:104)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:326)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:264)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1043)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at groovy.lang.Closure.call(Closure.java:421)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.DefaultGroovyMethods.callClosureForLine(DefaultGroovyMethods.java:5913)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.IOGroovyMethods.eachLine(IOGroovyMethods.java:463)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.IOGroovyMethods.eachLine(IOGroovyMethods.java:416)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.ResourceGroovyMethods.eachLine(ResourceGroovyMethods.java:349)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.ResourceGroovyMethods.eachLine(ResourceGroovyMethods.java:333)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.dgm$989.invoke(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(Poj&lt;br/&gt;
hodSite.java:246)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:55)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.commands.LoadCommand.load(LoadCommand.groovy:82)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.commands.LoadCommand$load.call(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:128)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh.loadUserScript(Groovysh.groovy:400)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh.run(Groovysh.groovy:588)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh$run$0.callCurrent(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:51)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:157)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:169)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh.run(Groovysh.groovy:577)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Groovysh$run.call(Unknown Source)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:136)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Main.startGroovysh(Main.groovy:193)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PlainObjectMetaMethodSite.doInvoke(PlainObjectMetaMethodSite.jav&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSiteNoUnwrapNoCoerce.invoke(P&lt;br/&gt;
ethodSite.java:190)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.call(PogoMetaMethodSite.java:70)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:136)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.shell.Main.main(Main.groovy:159)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:114)&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:136)&lt;/p&gt;</comment>
                            <comment id="17191888" author="ninside" created="Tue, 8 Sep 2020 00:03:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qaston&quot; class=&quot;user-hover&quot; rel=&quot;qaston&quot;&gt;qaston&lt;/a&gt;&#160;I put the code snippet right inside my shell wrapper. It does restore arrow keys functionality! Thanks for the suggestion.&lt;/p&gt;

&lt;p&gt;However now the cursor itself stays on the previous line (the line that was restored from history and executed).&lt;/p&gt;

&lt;p&gt;I am on windows 10.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13011194/13011194_image-2020-09-07-20-03-41-004.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17191896" author="ninside" created="Tue, 8 Sep 2020 00:56:06 +0000"  >&lt;p&gt;hmm hyper.js doesn&apos;t have that behavior. So maybe it is windows terminal issue...&lt;/p&gt;</comment>
                            <comment id="17227992" author="daniel_sun" created="Sun, 8 Nov 2020 13:27:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pluradj&quot; class=&quot;user-hover&quot; rel=&quot;pluradj&quot;&gt;pluradj&lt;/a&gt; Your suggestion works for me. Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="17227994" author="daniel_sun" created="Sun, 8 Nov 2020 13:28:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pluradj&quot; class=&quot;user-hover&quot; rel=&quot;pluradj&quot;&gt;pluradj&lt;/a&gt; Here is the PR based on your suggestion:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/pull/1413&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1413&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12817341">GROOVY-6859</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13011194" name="image-2020-09-07-20-03-41-004.png" size="8399" author="ninside" created="Tue, 8 Sep 2020 00:03:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cabj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>