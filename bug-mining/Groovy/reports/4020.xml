<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:10:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9805] Multiple assignment statements seperated by semicolons on a single line within a try catch block can lead to java.lang.VerifyError</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9805</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I&apos;ve been working on upgrading Groovy from 2.4.17 to 3.0.6 and came across a snippet of code that no longer works.&lt;/p&gt;

&lt;p&gt;Here&apos;s an example to illustrate the issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
def x; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; { x = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.nanoTime(); x = &lt;span class=&quot;code-quote&quot;&gt;&quot;ok&quot;&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;( ex ) {}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This results in the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.VerifyError: Stack map does not match the one at exception handler 39
 Exception Details:
 Location:
 Test.main([Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)V @39: astore
 Reason:
 Type &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&apos;&lt;/span&gt; (current frame, locals[2]) is not assignable to &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&apos;&lt;/span&gt; (stack map, locals[2])
 Current Frame:
 bci: @24
 flags: { }
 locals: { &lt;span class=&quot;code-quote&quot;&gt;&apos;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;[Lorg/codehaus/groovy/runtime/callsite/CallSite;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&apos;&lt;/span&gt; }
 stack: { &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/Exception&apos;&lt;/span&gt; }
 Stackmap Frame:
 bci: @39
 flags: { }
 locals: { &lt;span class=&quot;code-quote&quot;&gt;&apos;[Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;[Lorg/codehaus/groovy/runtime/callsite/CallSite;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&apos;&lt;/span&gt; }
 stack: { &lt;span class=&quot;code-quote&quot;&gt;&apos;java/lang/Exception&apos;&lt;/span&gt; }
 Bytecode:
 0x0000000: b800 184c 014d 2c57 2b12 2532 1227 1229
 0x0000010: b900 2f03 004e 2d4d 2d57 1231 3a04 1904
 0x0000020: 4d19 0457 a700 093a 0500 a700 03a7 0008
 0x0000030: 3a06 1906 bfb1 
 Exception Handler Table:
 bci [8, 39] =&amp;gt; handler: 39
 bci [8, 39] =&amp;gt; handler: 48
 bci [39, 42] =&amp;gt; handler: 48
 Stackmap Table:
 full_frame(@39,{Object57,Object59,Object61},{Object51})
 same_frame(@45)
 same_locals_1_stack_item_frame(@48,Object63)
 same_frame(@53) at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getDeclaredMethods0(Native Method)
 at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.privateGetDeclaredMethods(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:2701)
 at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.privateGetMethodRecursive(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3048)
 at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getMethod0(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3018)
 at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getMethod(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:1784)
 at sun.launcher.LauncherHelper.validateMainClass(LauncherHelper.java:544)
 at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:526)
 Error: A JNI error has occurred, please check your installation and &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; again
 Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;ve been able to refactor the code so it works in a couple of different ways. The most preferable was removing the assignment of System.nanoTime() to x as really it was unused however something strange still seems to be happening here.&lt;/p&gt;

&lt;p&gt;Interestingly the same code works if you provide a new line i.e:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
def x; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;{ x = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.nanoTime(); 
            x = &lt;span class=&quot;code-quote&quot;&gt;&quot;ok&quot;&lt;/span&gt; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;( ex ) {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It also works if you remove the try catch block:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
def x; x = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.nanoTime(); x = &lt;span class=&quot;code-quote&quot;&gt;&apos;ok&apos;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;ve tested different versions of Groovy and this appears to no longer work from 2.5.0-rc-1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13338462">GROOVY-9805</key>
            <summary>Multiple assignment statements seperated by semicolons on a single line within a try catch block can lead to java.lang.VerifyError</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="3" iconUrl="https://issues.apache.org/jira/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="mdonaghey075">Matthew Donaghey</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Nov 2020 16:38:52 +0000</created>
                <updated>Tue, 8 Dec 2020 23:37:38 +0000</updated>
                                            <version>2.5.0-rc-1</version>
                    <version>4.0.0-alpha-1</version>
                    <version>2.5.13</version>
                    <version>3.0.6</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17246189" author="emilles" created="Tue, 8 Dec 2020 23:36:33 +0000"  >&lt;p&gt;I suspect this is a bug in ASM&apos;s stack frame computation.  When I set system property &lt;tt&gt;groovy.log.classgen&lt;/tt&gt; to true, the only difference I see between the example code and the same plus a newline between the two assignments is an extra label and &lt;tt&gt;LINENUMBER&lt;/tt&gt; instruction.&lt;/p&gt;

&lt;p&gt;If I manually write an extra label before the second assignment expression, there is no verify error.  So I could pursue some kind of fix where there are extra labels written between statements.  Or do we want to wait for ASM devs to have a look?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0k7xk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>