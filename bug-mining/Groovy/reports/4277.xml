<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:15:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8693] Calling indirect default interface methods fails both dynamic/static compiled</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8693</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given &lt;em&gt;&amp;lt;interface&amp;gt; Intr &amp;lt;|- Impl &amp;lt;| SubImpl&lt;/em&gt; where &lt;em&gt;Intr&lt;/em&gt; is an Java8 interface with a default implementation, running &lt;em&gt;SubImpl&lt;/em&gt; fails both with &lt;em&gt;CompileDynamic:&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; groovy.lang.MissingMethodException: No signature of method: sut.SubImpl.doSomething() is applicable for argument types: () values: []
Possible solutions: doSomething(), toString(), toString()
 at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:72)
 at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodOnSuperN(ScriptBytecodeAdapter.java:148)
 at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodOnSuper0(ScriptBytecodeAdapter.java:166)
 at sut.SubImpl.doSomething(SubImpl.groovy:6)
 at sut.Intr$doSomething.call(Unknown Source)
 at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)
 at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
 at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:120)
 at sut.Main.main(Main.groovy:8)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and -&lt;em&gt;Static&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
Exception in thread &quot;main&quot; java.lang.VerifyError: Bad invokespecial instruction: interface method reference is in an indirect superinterface.
Exception Details:
 Location:
 sut/SubImpl.doSomething()V @1: invokespecial
 Reason:
 Error exists in the bytecode
 Bytecode:
 0x0000000: 2ab7 0014 0157 2a12 16b8 001c 0157 b1

at java.lang.Class.getDeclaredConstructors0(Native Method)
 at java.lang.Class.privateGetDeclaredConstructors(Class.java:2671)
 at java.lang.Class.getDeclaredConstructors(Class.java:2020)
 at org.codehaus.groovy.reflection.CachedClass$2$1.run(CachedClass.java:88)
 at java.security.AccessController.doPrivileged(Native Method)
 at org.codehaus.groovy.reflection.CachedClass$2.initValue(CachedClass.java:86)
 at org.codehaus.groovy.reflection.CachedClass$2.initValue(CachedClass.java:81)
 at org.codehaus.groovy.util.LazyReference.getLocked(LazyReference.java:50)
 at org.codehaus.groovy.util.LazyReference.get(LazyReference.java:37)
 at org.codehaus.groovy.reflection.CachedClass.getConstructors(CachedClass.java:311)
 at groovy.lang.MetaClassImpl.&amp;lt;init&amp;gt;(MetaClassImpl.java:218)
 at groovy.lang.MetaClassImpl.&amp;lt;init&amp;gt;(MetaClassImpl.java:228)
 at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.createNormalMetaClass(MetaClassRegistry.java:171)
 at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.createWithCustomLookup(MetaClassRegistry.java:161)
 at groovy.lang.MetaClassRegistry$MetaClassCreationHandle.create(MetaClassRegistry.java:144)
 at org.codehaus.groovy.reflection.ClassInfo.getMetaClassUnderLock(ClassInfo.java:288)
 at org.codehaus.groovy.reflection.ClassInfo.getMetaClass(ClassInfo.java:331)
 at org.codehaus.groovy.runtime.metaclass.MetaClassRegistryImpl.getMetaClass(MetaClassRegistryImpl.java:270)
 at org.codehaus.groovy.runtime.InvokerHelper.getMetaClass(InvokerHelper.java:976)
 at org.codehaus.groovy.runtime.callsite.CallSiteArray.createCallConstructorSite(CallSiteArray.java:86)
 at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallConstructor(CallSiteArray.java:59)
 at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:238)
 at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:242)
 at sut.Main.main(Main.groovy:8)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;See a full example here: &lt;a href=&quot;https://github.com/christoph-frick/groovy-inheritance-vs-default-interface-method&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/christoph-frick/groovy-inheritance-vs-default-interface-method&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13170922">GROOVY-8693</key>
            <summary>Calling indirect default interface methods fails both dynamic/static compiled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="ridcully">Christoph Frick</reporter>
                        <labels>
                            <label>breaking</label>
                            <label>default-methods</label>
                    </labels>
                <created>Mon, 9 Jul 2018 17:45:29 +0000</created>
                <updated>Sun, 21 Sep 2025 21:31:07 +0000</updated>
                            <resolved>Fri, 3 Dec 2021 20:51:39 +0000</resolved>
                                    <version>2.5.0</version>
                                    <fixVersion>4.0.0-rc-1</fixVersion>
                    <fixVersion>4.0.0-rc-2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16964246" author="emilles" created="Thu, 31 Oct 2019 17:46:43 +0000"  >&lt;p&gt;Recreation scenario (inlined):&lt;/p&gt;

&lt;p&gt;Face.java&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Face {
  &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; void meth() {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;);
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Impl.java&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Impl &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Face {
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Main.java (illustrates expected behavior)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Main {
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
    Face impl = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Impl() {
      @Override
      &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void meth() {
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;override&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.meth();
      }
    };
    impl.meth();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test.groovy&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Impl2 &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Impl {
  @Override
  void meth() {
    println &lt;span class=&quot;code-quote&quot;&gt;&apos;override&apos;&lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.meth() &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; MissingMethodException: No signature of method: Impl2.meth() is applicable &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; argument types: () values: []
&lt;/span&gt;  }
  void more() {}
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Impl().meth()
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Impl2().meth()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16964268" author="emilles" created="Thu, 31 Oct 2019 18:05:42 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9909&quot; title=&quot;Cannot call super when overriding an interface default method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9909&quot;&gt;&lt;del&gt;GROOVY-9909&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-9884&quot; title=&quot;groovy3: setProperty does not work in sub classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-9884&quot;&gt;&lt;del&gt;GROOVY-9884&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8587&quot; title=&quot;Calling super in an overridden method results in MissingMethodException when method indirectly inherited from trait&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8587&quot;&gt;&lt;del&gt;GROOVY-8587&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8021&quot; title=&quot;Super in traits causes MissingMethodException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8021&quot;&gt;&lt;del&gt;GROOVY-8021&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17449674" author="emilles" created="Fri, 26 Nov 2021 22:04:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/538374a1799947912496bf3a9aa8590cf5e38a75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/538374a1799947912496bf3a9aa8590cf5e38a75&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17452458" author="emilles" created="Thu, 2 Dec 2021 15:05:15 +0000"  >&lt;p&gt;The SC case has been fixed.  For the dynamic case, I think I understand all the moving parts and was able to make it work experimentally.  There are a few other cases that would require fixes to make it all hold together.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; I {
  &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; m() { }
}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; I {
}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;D &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; C {
  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; m() {
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.m()
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1. &lt;tt&gt;InvocationWriter#makeCall&lt;/tt&gt; converts &quot;super.m()&quot; into &quot;ScriptBytecodeAdapter.invokeMethodOnSuper0(C.class, this, &quot;m&quot;)&quot;.  The choice of &quot;C&quot; was made for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4035&quot; title=&quot;Super method calls from anonymous classes sometimes fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4035&quot;&gt;&lt;del&gt;GROOVY-4035&lt;/del&gt;&lt;/a&gt; and I think it should be &quot;D&quot;.&lt;/p&gt;

&lt;p&gt;2. As part of (1), a note is made to trigger &lt;tt&gt;MopWriter&lt;/tt&gt; to create the method &quot;super$2$m&quot; that writes the &lt;tt&gt;INVOKESPECIAL&lt;/tt&gt; call &quot;super.m()&quot; for the dynamic runtime.&lt;/p&gt;

&lt;p&gt;3. When &lt;tt&gt;invokeMethodOnSuper0&lt;/tt&gt; is executed, &lt;tt&gt;MetaClassImpl&lt;/tt&gt;/&lt;tt&gt;MetaMethodIndex&lt;/tt&gt; build up an index of the mehtods of C.  The entry for &quot;m&quot; has the declared method of C in the &quot;methods&quot; slot.  And the &quot;methodsForSuper&quot; has the interface default method.  methodsForSuper is supposed to have &quot;super$2$m&quot; substituted by &lt;tt&gt;MetaClassImpl#replaceWithMOPCalls&lt;/tt&gt;, but the distance calculation of the compiler and runtime differs.&lt;/p&gt;

&lt;p&gt;So, if &lt;tt&gt;InvocationWriter#makeCall&lt;/tt&gt; drops &quot;.getSuperClass()&quot;, &lt;tt&gt;MetaMethodIndex#isOverridden&lt;/tt&gt; is adjusted for interface methods, and &lt;tt&gt;MetaClassImpl#replaceWithMOPCalls&lt;/tt&gt; is adjusted for distance of interface methods then the test case will succeed.&lt;/p&gt;

&lt;p&gt;I think these changes are in keeping with the design of the &quot;super$dist$name&quot; MOP methods, which are meant for the runtime when carrying out &quot;super.name()&quot; invocation.  Using &quot;D&quot; as the sender (today&apos;s behavior) falls down when D is not a Groovy class.&lt;/p&gt;</comment>
                            <comment id="17452475" author="emilles" created="Thu, 2 Dec 2021 15:53:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/cae5301aa9c9a274d92a760ecb70e057d746fb65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/cae5301aa9c9a274d92a760ecb70e057d746fb65&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/b5c7e1ce9e1838eef5a7eb9b6373587afa9ca24e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/b5c7e1ce9e1838eef5a7eb9b6373587afa9ca24e&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/6ccf8d74afc81c70f75125f3ed347f7587d7c2e9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/6ccf8d74afc81c70f75125f3ed347f7587d7c2e9&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/7cd12222cbd8b7210fc0b3dc64de8e03c46d2e8f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/7cd12222cbd8b7210fc0b3dc64de8e03c46d2e8f&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/34ffbd02b16bffff59d4c1e252aeaacf77587d46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/34ffbd02b16bffff59d4c1e252aeaacf77587d46&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/a63ee5e26023dd22db81834d7134053bd566f441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/a63ee5e26023dd22db81834d7134053bd566f441&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13554112">GROOVY-11193</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/christoph-frick/groovy-inheritance-vs-default-interface-method]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vopj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>