<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:54:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7970] Can&apos;t call private method from outer class when using anonymous inner classes and @CS</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7970</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.json.*
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.*

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Writable renderTemplate(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o, Map args) {
    
    }
    def foo(Map map, Map arguments) {
    
        def writable = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Writable() {
            @Override
            Writer writeTo(Writer out) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
                StreamingJsonBuilder builder = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamingJsonBuilder(out)
                builder.call {
                    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(key in map.keySet()) {
                        def o = map.get(key)
                        Writable writable = renderTemplate((&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)o, arguments)
                        call(key.toString(), writable)
                    }
                }
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; out
            }
        }
    }
}

writable = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bar().foo([one:&lt;span class=&quot;code-quote&quot;&gt;&apos;two&apos;&lt;/span&gt;],[foo:&lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt;])

sw = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringWriter()
writable.writeTo(sw)
println sw
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Results in a compilation error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[Static type checking] - Cannot find matching method Bar$1#renderTemplate(java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;, java.util.Map). Please check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the declared type is right and &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the method exists.
 at line: 18, column: 45
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you attempt to use &lt;tt&gt;Bar.this&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Writable writable = Bar.&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.renderTemplate((&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)o, arguments)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result is a VerifierError&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.VerifyError: (class: Bar$1$_writeTo_closure1, method: doCall signature: (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;) Incompatible argument to function
	at Bar$1.writeTo(ConsoleScript11:15)
	at groovy.lang.Writable$writeTo.call(Unknown Source)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:48)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:113)
	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13012274">GROOVY-7970</key>
            <summary>Can&apos;t call private method from outer class when using anonymous inner classes and @CS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="graemerocher1">Graeme Rocher</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Oct 2016 07:40:43 +0000</created>
                <updated>Tue, 2 May 2017 02:03:40 +0000</updated>
                            <resolved>Sun, 19 Feb 2017 21:45:13 +0000</resolved>
                                    <version>2.4.7</version>
                                    <fixVersion>2.5.0-alpha-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15576333" author="paulk" created="Fri, 14 Oct 2016 19:58:28 +0000"  >&lt;p&gt;A slightly simpler example (and indicating that it isn&apos;t just private methods)::&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; renderTemplate(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; arg) { &lt;span class=&quot;code-quote&quot;&gt;&quot;dummy$arg&quot;&lt;/span&gt; }
    def foo() {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;A&apos;&lt;/span&gt;.with{ renderTemplate(it) } &lt;span class=&quot;code-comment&quot;&gt;// OK &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not in &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; class
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;() {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
               &lt;span class=&quot;code-quote&quot;&gt;&apos;B&apos;&lt;/span&gt;.with{ renderTemplate(it) } &lt;span class=&quot;code-comment&quot;&gt;// ERROR
&lt;/span&gt;               &lt;span class=&quot;code-comment&quot;&gt;// renderTemplate(&lt;span class=&quot;code-quote&quot;&gt;&apos;C&apos;&lt;/span&gt;) // OK &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not within closure
&lt;/span&gt;            }
        }
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bar().foo()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which has this error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[Static type checking] - Cannot find matching method Bar$1#renderTemplate(java.lang.String). Please check if the declared type is right and if the method exists.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15611543" author="paulk" created="Thu, 27 Oct 2016 11:05:19 +0000"  >&lt;p&gt;After applying the proposed PR#451 from &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7973&quot; title=&quot;Class.this not evaluated correctly within a closure within an inner class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7973&quot;&gt;&lt;del&gt;GROOVY-7973&lt;/del&gt;&lt;/a&gt; the following script works (i.e. the above suggested workaround which was showing a VerifyError):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; renderTemplate(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; arg) { &lt;span class=&quot;code-quote&quot;&gt;&quot;dummy$arg&quot;&lt;/span&gt; }
    def foo() {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;() {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bar() {
               &lt;span class=&quot;code-quote&quot;&gt;&apos;B&apos;&lt;/span&gt;.with{ Bar.&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.renderTemplate(it) }
            }
        }
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bar().foo().bar() == &lt;span class=&quot;code-quote&quot;&gt;&apos;dummyB&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I also have a fix that lets the non-workaround case through the type checker but the generated code isn&apos;t right yet and causes cast exceptions (it was never written to properly generate code in that case). I still need to do a bit more work to fix that case.&lt;/p&gt;</comment>
                            <comment id="15611555" author="graemerocher1" created="Thu, 27 Oct 2016 11:11:46 +0000"  >&lt;p&gt;Great news! I guess we need to work out if the former case should be allowed&lt;/p&gt;</comment>
                            <comment id="15611586" author="paulk" created="Thu, 27 Oct 2016 11:25:53 +0000"  >&lt;p&gt;I think it probably should - but I&apos;ll work on that more tomorrow and see if any ugly cases come up. It is always tricky with closures since they are so flexible, you can&apos;t make as many assumptions about what they would definitely produce. The type checking extension mechanism is in place for that purpose. If we can&apos;t be certain what should happen we should leave it out of the main compilation path. &lt;/p&gt;</comment>
                            <comment id="15615142" author="githubbot" created="Fri, 28 Oct 2016 11:30:01 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/452&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/452&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7970&quot; title=&quot;Can&amp;#39;t call private method from outer class when using anonymous inner classes and @CS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7970&quot;&gt;&lt;del&gt;GROOVY-7970&lt;/del&gt;&lt;/a&gt;: Can&apos;t call private method from outer class when using anonymous inner classes and @CS&lt;/p&gt;

&lt;p&gt;    Not a final solution. This fixes public methods. Private/protected methods are handled by a different code path which isn&apos;t yet fixed.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/groovy&lt;/a&gt; groovy7970&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/452.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/452.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #452&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b75907f844f0abb44414ee3e53e9bb247ee33a55&lt;br/&gt;
Author: paulk &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2016-10-25T04:30:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7970&quot; title=&quot;Can&amp;#39;t call private method from outer class when using anonymous inner classes and @CS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7970&quot;&gt;&lt;del&gt;GROOVY-7970&lt;/del&gt;&lt;/a&gt;: Can&apos;t call private method from outer class when using anonymous inner classes and @CS (allow through the type checker)&lt;/p&gt;

&lt;p&gt;commit 63e55bbd79a1fa5318feaf08c43ac9e86e9c0593&lt;br/&gt;
Author: paulk &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2016-10-28T11:27:24Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7970&quot; title=&quot;Can&amp;#39;t call private method from outer class when using anonymous inner classes and @CS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7970&quot;&gt;&lt;del&gt;GROOVY-7970&lt;/del&gt;&lt;/a&gt;: Can&apos;t call private method from outer class when using anonymous inner classes and @CS&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15655031" author="githubbot" created="Thu, 10 Nov 2016 20:20:36 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/452&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/452&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15655265" author="paulk" created="Thu, 10 Nov 2016 21:52:31 +0000"  >&lt;p&gt;Even though this is a bug fix, the fix relies on several other changes that have only happened on the 2.5 branch (current master). It could be back-ported but will be a little tedious and require some work. Is it important to have this fix in the 2_4_X branch?&lt;/p&gt;</comment>
                            <comment id="15873855" author="paulk" created="Sun, 19 Feb 2017 21:45:13 +0000"  >&lt;p&gt;No further feedback - leaving as a 2.5 only fix for now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34vtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>