<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:55:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-313] &apos;package&apos; accessible methods not handled correctly</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-313</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Calling a &apos;package&apos; accessible method (in a Java class) from a groovy script in a different package results in a java.lang.IllegalAccessError, but calling a private method is ok. Since setAccessible is used to gain access to all methods, I assume that package private methods should be callable as well.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;br/&gt;
1) Compile the Java class included at the end&lt;br/&gt;
2) Add it to the classpath&lt;br/&gt;
3) Start the groovy shell and type:&lt;br/&gt;
   1&amp;gt; f = new bar.Foo()&lt;br/&gt;
   2&amp;gt; f.priv()&lt;br/&gt;
   3&amp;gt; f.pack()&lt;br/&gt;
   4&amp;gt; go&lt;br/&gt;
4) You should see this:&lt;br/&gt;
-----------------------------------------------------------&lt;br/&gt;
[]&lt;br/&gt;
I am private&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; a serious error occurred: tried to access method bar.Foo.pack()V from class&lt;br/&gt;
gjdk.bar.Foo_GroovyReflector&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; stacktrace:&lt;br/&gt;
java.lang.IllegalAccessError: tried to access method bar.Foo.pack()V from class&lt;br/&gt;
gjdk.bar.Foo_GroovyReflector&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Notice that it was ok to call the private method, but not ok to call the package accessible method.&lt;/p&gt;


&lt;p&gt;package bar;&lt;br/&gt;
public class Foo&lt;br/&gt;
{&lt;br/&gt;
   public void pub() &lt;/p&gt;
{
      System.out.println(&quot;I am public&quot;);
   }
&lt;p&gt;   protected void prot() &lt;/p&gt;
{
      System.out.println(&quot;I am protected&quot;);
   }
&lt;p&gt;   void pack() &lt;/p&gt;
{
      System.out.println(&quot;I am package&quot;);
   }
&lt;p&gt;   private void priv() &lt;/p&gt;
{
      System.out.println(&quot;I am private&quot;);
   }
&lt;p&gt;}&lt;/p&gt;</description>
                <environment>Windows XP, Sun JDK 1.4.2</environment>
        <key id="12815929">GROOVY-313</key>
            <summary>&apos;package&apos; accessible methods not handled correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spullara">Sam Pullara</assignee>
                                    <reporter username="staffan">Staffan Larsen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Mar 2004 11:23:09 +0000</created>
                <updated>Mon, 24 May 2004 01:40:43 +0000</updated>
                            <resolved>Mon, 24 May 2004 01:40:43 +0000</resolved>
                                    <version>1.0-beta-4</version>
                                    <fixVersion>1.0-beta-6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14459910" author="staffan" created="Tue, 23 Mar 2004 11:31:02 +0000"  >&lt;p&gt;Some more information:&lt;/p&gt;

&lt;p&gt;1) The testcase works correctly if you execute it as a groovy script with groovy.cmd instead of running manuallly it with groovysh.cmd.&lt;/p&gt;

&lt;p&gt;I think the reason for this is that groovy.lang.GroovyShell calls MetaClass.setUseReflection(true), but groovy.ui.InteractiveShell does not. Not sure which is correct.&lt;/p&gt;


&lt;p&gt;2) The real problem seems to be in MetaClass.isValidReflectorMethod() which does not handle package accessibility. Adding the following lines to the method (after the initial isPrivate||isProtected test) makes it work, but I am not sure this is the correct solution:&lt;/p&gt;

&lt;p&gt;  if (!method.isPublic()) &lt;/p&gt;
{
    return false;
  }</comment>
                            <comment id="14460244" author="spullara" created="Mon, 24 May 2004 01:40:43 +0000"  >&lt;p&gt;We must use setAccessible for anything non-public.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cjvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>