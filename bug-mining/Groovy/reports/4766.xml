<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:23:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11271] ConcurrentCommonCache causes memory leaks.</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11271</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;ConcurrentCommonCache uses a read-write lock to wrap CommonCache into a thread-safe data structure. However, CommonCache uses the underlying LinkedHashMap, which causes conflicts when using the LRU algorithm because the LinkedHashMap.get method modifies the internal linked list. This conflicts with the read lock used by the get method in ConcurrentCommonCache when multiple threads access it. Due to multithreading conflicts, the maximum cache size of 64 becomes ineffective, ultimately causing memory leaks. Additionally, we have already encountered memory leaks in our production environment.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13563834">GROOVY-11271</key>
            <summary>ConcurrentCommonCache causes memory leaks.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="a767856866">cong yang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jan 2024 03:04:59 +0000</created>
                <updated>Tue, 5 Mar 2024 01:53:29 +0000</updated>
                            <resolved>Thu, 11 Jan 2024 17:32:45 +0000</resolved>
                                    <version>4.0.7</version>
                                    <fixVersion>2.5.24</fixVersion>
                    <fixVersion>4.0.18</fixVersion>
                    <fixVersion>3.0.21</fixVersion>
                                    <component>ast builder</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17804198" author="blackdrag" created="Mon, 8 Jan 2024 09:22:36 +0000"  >&lt;p&gt;to add ore details: &lt;a href=&quot;https://github.com/apache/groovy/blob/5a3cf7c86feacc6f257cc72942e6ef8789920cf4/src/main/java/org/codehaus/groovy/runtime/memoize/CommonCache.java#L67&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/5a3cf7c86feacc6f257cc72942e6ef8789920cf4/src/main/java/org/codehaus/groovy/runtime/memoize/CommonCache.java#L67&lt;/a&gt;&lt;br/&gt;
This creates a CommonCache where accessOrder is set to true and then any get call on the underlying LinkedHashMap can cause a write change, not covered  appropriately by the checks.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sunlan&quot; class=&quot;user-hover&quot; rel=&quot;sunlan&quot;&gt;sunlan&lt;/a&gt; This looks like a bigger change will be required to fix this&lt;/p&gt;</comment>
                            <comment id="17804211" author="daniel_sun" created="Mon, 8 Jan 2024 09:44:08 +0000"  >&lt;p&gt;The fastest way to fix the issue is abandoning the usage of read lock and use write lock instead.&lt;/p&gt;</comment>
                            <comment id="17804244" author="blackdrag" created="Mon, 8 Jan 2024 11:57:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daniel_sun&quot; class=&quot;user-hover&quot; rel=&quot;daniel_sun&quot;&gt;daniel_sun&lt;/a&gt; This is correct, but then it is not much better than a synchronized collection&lt;/p&gt;</comment>
                            <comment id="17804347" author="githubbot" created="Mon, 8 Jan 2024 15:38:05 +0000"  >&lt;p&gt;daniellansun opened a new pull request, #2030:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2030&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2030&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-11271&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/GROOVY-11271&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17804349" author="daniel_sun" created="Mon, 8 Jan 2024 15:44:43 +0000"  >&lt;blockquote&gt;
&lt;p&gt;This is correct, but then it is not much better than a synchronized collection&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; After trading off between function and performance, I chosen the &lt;tt&gt;ConcurrentLinkedHashMap&lt;/tt&gt; instead of &lt;tt&gt;synchronized&lt;/tt&gt; when LRU is enabled.&lt;/p&gt;</comment>
                            <comment id="17804358" author="emilles" created="Mon, 8 Jan 2024 16:18:12 +0000"  >&lt;p&gt;Can someone explain where this gets used?  What features are impacted by this flaw in &lt;tt&gt;ConcurrentCommonCache&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="17804416" author="blackdrag" created="Mon, 8 Jan 2024 18:33:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; See &lt;a href=&quot;https://blog.mrhaki.com/2013/11/groovy-goodness-cache-methods.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://blog.mrhaki.com/2013/11/groovy-goodness-cache-methods.html&lt;/a&gt;. in case of for example @Memoized(maxCacheSize = 2) a LRU of size 2 is used. If now many threads read the memoized results and change the order of what is last recently used, this can result in the described problem.&lt;/p&gt;</comment>
                            <comment id="17805726" author="githubbot" created="Thu, 11 Jan 2024 17:22:33 +0000"  >&lt;p&gt;daniellansun merged PR #2030:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2030&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2030&lt;/a&gt;&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mlqg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>