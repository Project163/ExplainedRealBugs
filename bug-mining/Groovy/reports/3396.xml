<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:58:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6171] Memory tweaks for groovy compiler</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6171</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I&apos;ve been doing some profiling of Groovy-Eclipse and I found a few things you should be aware of in the Groovy compiler:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;org.codehaus.groovy.classgen.asm.ClosureWriter.UseExistingReference should be a static interface.  As it is now, every reference to &lt;tt&gt;UseExistingReference.class&lt;/tt&gt; will have a back pointer to an instance of &lt;tt&gt;ClosureWritier&lt;/tt&gt;.  Making the interface static will avoid that back reference.&lt;/li&gt;
	&lt;li&gt;The &lt;tt&gt;org.codehaus.groovy.ast.ASTNode.metaDataMap&lt;/tt&gt; field should be lazily initiailzed.  And when it is initialized, it should be done with a smaller initial size.  This field is taking up massive amounts of space in my profile and it is mostly and empty field.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;These two changes would cause massive memory savings in Groovy-Eclipse.  We have already implemeted #2 and have seen a big benefit.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12817005">GROOVY-6171</key>
            <summary>Memory tweaks for groovy compiler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="werdna">Andrew Eisenberg</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 May 2013 17:12:35 +0000</created>
                <updated>Sat, 1 Jun 2013 06:11:54 +0000</updated>
                            <resolved>Wed, 29 May 2013 06:52:40 +0000</resolved>
                                                    <fixVersion>2.1.4</fixVersion>
                    <fixVersion>2.2.0-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14474394" author="guillaume" created="Sat, 25 May 2013 14:49:47 +0000"  >&lt;p&gt;Hi Andrew! What about making pull requests of those enhancements so we can have a closer look at the proposed changes? (and also to avoid increasing the number of patches on your side as well &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14474462" author="werdna" created="Mon, 27 May 2013 00:07:30 +0000"  >&lt;p&gt;Done.  See &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/197&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/197&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14474557" author="blackdrag" created="Mon, 27 May 2013 08:41:47 +0000"  >&lt;p&gt;Andrew, how many ListHashMap instances do you have active in those profiling sessions?&lt;/p&gt;</comment>
                            <comment id="14474528" author="werdna" created="Mon, 27 May 2013 10:43:36 +0000"  >&lt;p&gt;Depending on which projects are open, somewhere on the order of 80,000.&lt;/p&gt;

&lt;p&gt;Groovy-Eclipse caches ModuleNodes where possible.  They shouldn&apos;t be calculated unless something has changed.&lt;/p&gt;</comment>
                            <comment id="14474537" author="blackdrag" created="Mon, 27 May 2013 11:56:58 +0000"  >&lt;p&gt;So the magnitude of what the enhancements will give are less than 5MB?&lt;/p&gt;</comment>
                            <comment id="14474442" author="werdna" created="Mon, 27 May 2013 13:03:23 +0000"  >&lt;p&gt;Actually, that&apos;s not correct.  The number is 80,000 ClassNodes.  And each ClassNode has a full AST below it, so a ballpark is around 500,000 ASTNodes.  Not only is it the memory, but also the extra initialization time of creating these empty maps that are not used.&lt;/p&gt;</comment>
                            <comment id="14474424" author="blackdrag" created="Tue, 28 May 2013 04:18:42 +0000"  >&lt;p&gt;That&apos;s why I asked for the number of ListHashMap instances &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; 500k is of course an entire different number than 80k... still I would expect no more than 100MB being used by that. On the other hand you are of course right with the object creation taking time, that is not really needed. So I see this more as an speed improvement than one for memory, though it is  very rare that you can save on both. Anyway... +1 for the change, now that the magnitude is more clear to me.&lt;/p&gt;</comment>
                            <comment id="14474558" author="melix" created="Wed, 29 May 2013 05:28:10 +0000"  >&lt;p&gt;Tested the pull request, everything looks fine, but I would suggest to only put the improvement into &lt;tt&gt;master&lt;/tt&gt;, what do you think?&lt;/p&gt;</comment>
                            <comment id="14474539" author="melix" created="Wed, 29 May 2013 06:52:40 +0000"  >&lt;p&gt;After discussions with the team, we agreed to introduce the improvement in both &lt;tt&gt;master&lt;/tt&gt; and &lt;tt&gt;2_1_X&lt;/tt&gt; branches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c507:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>