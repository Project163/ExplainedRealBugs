<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:14:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3888] GroovyServlets does not find groovlets in web application core under tomcat6</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3888</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I create web application, which can be simplicified to &apos;groovy-all-1.7-beta2.jar&apos; in lib, web.xml with standard&lt;br/&gt;
GroovyServlet definition:&lt;br/&gt;
---------------------------&lt;br/&gt;
    &amp;lt;servlet&amp;gt;&lt;br/&gt;
      &amp;lt;servlet-name&amp;gt;Groovy&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
      &amp;lt;servlet-class&amp;gt;groovy.servlet.GroovyServlet&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
    &amp;lt;/servlet&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
      &amp;lt;servlet-name&amp;gt;Groovy&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
      &amp;lt;url-pattern&amp;gt;*.groovy&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
    &amp;lt;/servlet-mapping&amp;gt;&lt;br/&gt;
------------------------------&lt;/p&gt;

&lt;p&gt;and x.groovy with next text:&lt;br/&gt;
--------------------------&lt;br/&gt;
import java.util.Date&lt;br/&gt;
import groovy.xml.MarkupBuilder&lt;/p&gt;

&lt;p&gt;def expr=&quot;&quot;;&lt;br/&gt;
def result=&quot;&quot;;&lt;br/&gt;
if (request.getParameter(&quot;expr&quot;)!=null) {&lt;br/&gt;
  expr=request.getParameter(&quot;expr&quot;);&lt;br/&gt;
}&lt;br/&gt;
html.html{&lt;br/&gt;
 body{&lt;br/&gt;
  form(id:&quot;console_form&quot;, method:&quot;post&quot;){&lt;br/&gt;
   table{&lt;br/&gt;
     tr{&lt;br/&gt;
       td{textarea(name:&quot;expr&quot;,cols:120, rows:6, &quot;${expr}&quot;)}&lt;br/&gt;
     }&lt;br/&gt;
     tr{&lt;br/&gt;
       td&lt;/p&gt;
{input(type:&quot;submit&quot;)}
&lt;p&gt;     }&lt;br/&gt;
     tr{&lt;br/&gt;
       td{textarea(name:&quot;result&quot;,cols:120, rows:10, disabled:true,&lt;br/&gt;
                   &quot;${result}&quot;)}&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
  }&lt;br/&gt;
 }&lt;br/&gt;
}&lt;br/&gt;
----------------------------------&lt;/p&gt;

&lt;p&gt;than, ater typing url:  &lt;a href=&quot;http://127.0.0.1:8080/ifs/x.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8080/ifs/x.groovy&lt;/a&gt;&lt;br/&gt;
at first type, form is show, after submit (which must go on same URL) I see 404 page&lt;br/&gt;
with message in catalina.out:&lt;br/&gt;
INFO: GroovyServlet Error:  script: &apos;/x.groovy&apos;:  Script not found, sending 404.&lt;br/&gt;
GroovyServlet Error:  script: &apos;/x.groovy&apos;:  Script not found, sending 404.&lt;/p&gt;

&lt;p&gt;Note, that bug is specific to 1.7-beta-2.  in 1.6.1 all work as expected.&lt;/p&gt;

&lt;p&gt;If more information is needed, I can prepare war file with stripped-down application.&lt;/p&gt;</description>
                <environment>fedora 11/tomcat 6/&lt;br/&gt;
OpenJDK Runtime Environment (IcedTea6 1.6) (fedora-29.b16.fc11-x86_64)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 14.0-b16, mixed mode)&lt;br/&gt;
</environment>
        <key id="12818042">GROOVY-3888</key>
            <summary>GroovyServlets does not find groovlets in web application core under tomcat6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="rssh">Ruslan Shevchenko</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Nov 2009 17:21:29 +0000</created>
                <updated>Wed, 10 Oct 2012 15:19:27 +0000</updated>
                            <resolved>Fri, 20 Nov 2009 10:54:50 +0000</resolved>
                                    <version>1.7-beta-2</version>
                                    <fixVersion>1.7-rc-1</fixVersion>
                                    <component>Groovlet / GSP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14468070" author="roshandawrani" created="Fri, 20 Nov 2009 02:43:33 +0000"  >&lt;p&gt;I was able to reproduce the issue and solve it using the current patch. I need someone to review it please.&lt;/p&gt;

&lt;p&gt;The issue was related to the name with which GroovyScriptEngine maintains its scriptCache (introduce in some recent dependency checking logic in GSE). When GroovyScriptEngine loads a script by name &apos;/x.groovy&apos;, it opens a URLConnection and caches the compiled class with the URLConnection path, which is like &apos;/localhost/myapp/x.groovy&apos; (with tomcat 6). When the request is submitted again, it tries to do the timestamp check to see if script has a newer timestamp, and there it tries to do servletContext.getResource(&quot;/&quot; + &quot;/localhost/myapp/x.groovy&quot;), with &quot;/localhost/myapp/x.groovy&quot; being the dependency name in scriptCache, and it becomes wrong because it should actually just be servletContext.getResource(&quot;/&quot; + &quot;/x.groovy&quot;).&lt;/p&gt;

&lt;p&gt;servletContext.getResource(&quot;/&quot; + &quot;/localhost/myapp/x.groovy&quot;) fails with ResourceNotFound exception resulting in 404 messages.&lt;/p&gt;

&lt;p&gt;So, instead of interfering with caching logic of GroovyScriptEngine, which can affect other places too, I have fixed it in groovy.servlet.AbstractHttpServlet#getResourceConnection() itself to remove the base virtual path from dependency name, if it is found.&lt;/p&gt;</comment>
                            <comment id="14468114" author="blackdrag" created="Fri, 20 Nov 2009 03:02:37 +0000"  >&lt;p&gt;Argh, such an easy fix... and here I was trying and trying and got into absolutely the wrong direction. Roshan thanks a lot! And yes this patch looks good to me. &lt;/p&gt;</comment>
                            <comment id="14468170" author="roshandawrani" created="Fri, 20 Nov 2009 03:13:03 +0000"  >&lt;p&gt;That&apos;s quite pleasing to read.&lt;/p&gt;

&lt;p&gt;I first went into another direction too to see if I could change the name with which GSE does script caching, but changed my mind as I didn&#180;t think GSE serves only the servlet funcionality - and I didn&#180;t want to impact other areas. So, went ahead with this much easier and more localized fix.&lt;/p&gt;

&lt;p&gt;I will apply the patch soon.&lt;/p&gt;</comment>
                            <comment id="14468206" author="guillaume" created="Fri, 20 Nov 2009 04:05:32 +0000"  >&lt;p&gt;So with this fix, does that mean that we&apos;ll be able to use Groovlets properly again on various containers? Jetty, and Tomcat, come to mind?&lt;br/&gt;
Currently, beta-2 is broken as it&apos;s not working on Tomcat I believe, but does on Jetty.&lt;br/&gt;
Once the fix will be in place, I&apos;ll also double check that it&apos;s working well on Google App Engine.&lt;/p&gt;</comment>
                            <comment id="14468082" author="blackdrag" created="Fri, 20 Nov 2009 04:46:32 +0000"  >&lt;p&gt;yeah, I think with this fix stupid GSE will finally work as it should&lt;/p&gt;</comment>
                            <comment id="14468217" author="roshandawrani" created="Fri, 20 Nov 2009 07:47:57 +0000"  >&lt;p&gt;I applied the fix.&lt;/p&gt;

&lt;p&gt;Guillaume, do you want me to leave this JIRA open till you check it on Jetty and Google App Engine and see if there are any issues related to this fix with them?&lt;/p&gt;</comment>
                            <comment id="14468051" author="guillaume" created="Fri, 20 Nov 2009 09:55:03 +0000"  >&lt;p&gt;Hi Roshan, I&apos;ve just tried using Groovy Trunk with your changes, both on the locallly and deployed on Google App Engine, and everything seems to run just fine.&lt;br/&gt;
I have not double checked things work on Tomcat or raw Jetty, especially the reloading, but I trust you it&apos;s working.&lt;/p&gt;</comment>
                            <comment id="14468149" author="guillaume" created="Fri, 20 Nov 2009 10:03:28 +0000"  >&lt;p&gt;Roshan, have you also had a look at this one, to see if dependent scripts / classes work fine too?&lt;br/&gt;
&lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY-3702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY-3702&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14468071" author="roshandawrani" created="Fri, 20 Nov 2009 10:54:50 +0000"  >&lt;p&gt;Ok, I have now tested the reported issue on Jetty as well. No problem there too. So, I am marking this one as &apos;Fixed&apos;&lt;/p&gt;

&lt;p&gt;I will try whether this fix has had any effect on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3702&quot; title=&quot;Groovlet: depending groovy files are not recompiled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3702&quot;&gt;&lt;del&gt;GROOVY-3702&lt;/del&gt;&lt;/a&gt; as well and post back.&lt;/p&gt;</comment>
                            <comment id="14468132" author="guillaume" created="Fri, 20 Nov 2009 12:28:13 +0000"  >&lt;p&gt;Very good!&lt;/p&gt;</comment>
                            <comment id="14469079" author="enes1177" created="Sat, 6 Mar 2010 16:43:13 +0000"  >&lt;p&gt;Hi; &lt;br/&gt;
I have a problem related to this issue.&lt;/p&gt;

&lt;p&gt;I have a simple groovy web application, with groovlets and templateservlet.&lt;br/&gt;
It has similar structure with GAELYK template project, replaced GAELYK servlet with GroovyServlet.&lt;br/&gt;
When I deploy application to tomcat 6, and configure it as virtual host, it gives 404 telling &quot;Script not found&quot; for groovlets when I try to reach it from domain name.&lt;br/&gt;
There is no problem when reaching it from ip-address.&lt;/p&gt;

&lt;p&gt;I handled the situation by moving groovlet from /WEB-INF/groovy to / (context base).&lt;br/&gt;
But this time I realised groovlet does not work as expected. It seems it re-constructs its resources at each call. For example I inspected re-construction of my singleton services.&lt;/p&gt;

&lt;p&gt;When I downgraded, changed my groovy libs from 1.7.1 to 1.6.7; the problem disappeared and it started to work correctly.&lt;/p&gt;

&lt;p&gt;Here is my virtual host definition on conf/server.xml is like this.&lt;/p&gt;

&lt;p&gt;&amp;lt;Host name=&quot;www.example.com&quot; appBase=&quot;webapps/example&quot; &amp;gt;&lt;br/&gt;
&amp;lt;Alias&amp;gt;example.com&amp;lt;/Alias&amp;gt;&lt;br/&gt;
&amp;lt;Context path=&quot;&quot; docBase=&quot;.&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/Host&amp;gt;&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Enes&lt;/p&gt;</comment>
                            <comment id="14469033" author="roshandawrani" created="Sat, 6 Mar 2010 19:22:48 +0000"  >&lt;p&gt;I tried with a virtual host on my Windows XP box with tomcat 6 and I can&apos;t seem to reproduce the issue. It works fine for me with scripts under WEB-INF\groovy.&lt;/p&gt;

&lt;p&gt;Can someone else also try?&lt;/p&gt;

&lt;p&gt;I am not sure what you mean by &quot;groovlet re-constructs its resources at each call. For example I inspected re-construction of my singleton services.&quot; What resources?&lt;/p&gt;

&lt;p&gt;If you can provide a small WAR (a concrete example) that showcases your issue, it will be much clearer.&lt;/p&gt;</comment>
                            <comment id="14469043" author="enes1177" created="Sun, 7 Mar 2010 07:39:24 +0000"  >&lt;p&gt;How have you tried it on your local?&lt;br/&gt;
It is working on my local, or when trying to reach the remote with direct ip address too?&lt;br/&gt;
But when using domain address, it produces the problem.&lt;br/&gt;
It may be about internal context handling of tomcat.&lt;/p&gt;

&lt;p&gt;Reconstruction of resources: Sorry I might use wrong words. Let me explain what I experience.&lt;br/&gt;
I have a service groovy class. MyService.groovy&lt;br/&gt;
It is singleton and groovlet refers it as def myService = MyService.getInstance();&lt;br/&gt;
So I expect the construction (constructor) of singleton, once.&lt;br/&gt;
But when I move the groovlet from /WEB-INF/groovy to / ;&lt;br/&gt;
I see at each call the singleton constructor is called again.&lt;br/&gt;
So I lose the data which are stored on variables of service class.&lt;br/&gt;
But I think, this is not what we have to focus on. As we should not be required to to move the groovlet from WEB-INF/groovy.&lt;/p&gt;

&lt;p&gt;Ok will send a prototype war.&lt;/p&gt;

</comment>
                            <comment id="14469080" author="enes1177" created="Sun, 7 Mar 2010 08:52:10 +0000"  >&lt;p&gt;You can reach the prototype war at:&lt;br/&gt;
&lt;a href=&quot;http://test.groovy.s3.amazonaws.com/gprototype.war&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://test.groovy.s3.amazonaws.com/gprototype.war&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is the test scenario:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Copy war to your local tomcat6.&lt;br/&gt;
You will see incrementing counter.&lt;br/&gt;
No Problem&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Copy war to your remote tomcat6.&lt;br/&gt;
Reach the app with ip address of remote server.&lt;br/&gt;
You will see incrementing counter.&lt;br/&gt;
No Problem&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Copy war to your remote tomcat6.&lt;br/&gt;
Configure a virtual host and restart the tomcat.&lt;br/&gt;
Reach the app with domain name you configured.&lt;br/&gt;
You will see &quot;Script not found&quot; in catalina.out&lt;br/&gt;
Now move the groovlet. mv WEB-INF/groovy/start.groovy .&lt;br/&gt;
You will see the app but counter does not increment&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Another clue. If you put the war to Tomcat as ROOT.war;&lt;br/&gt;
script not found error does not appear but counter does not increment again.&lt;br/&gt;
ROOT is the default context of tomcat as you know.&lt;/p&gt;

</comment>
                            <comment id="14469035" author="roshandawrani" created="Mon, 8 Mar 2010 02:00:47 +0000"  >&lt;p&gt;Your first comment did not mention anything about local/remote. It only mentioned about accessing with domain name/ip address, so that&apos;s what I had tried (locally) after setting up the virtual host (www.example.com) and accessing through it and couldn&apos;t reproduce the issue.&lt;/p&gt;

&lt;p&gt;I now understand that the issue is not present with local tomcat (whether with domain name or IP address). The issue is only there when you access the app on a remote app with a domain name based URL. Can you confirm?&lt;/p&gt;

&lt;p&gt;And if that is the case, someone else will have to look into it unfortunately as I don&apos;t have access to multiple computers to try it out.&lt;/p&gt;</comment>
                            <comment id="14469068" author="enes1177" created="Mon, 8 Mar 2010 03:45:11 +0000"  >&lt;p&gt;Yes, problem occurs in remote, with domain based url. &lt;/p&gt;

&lt;p&gt;I did not try but I guess the problem should reproduce in your local if you direct the domain, by adding your domain record to direct to your localhost &quot;windows&amp;gt;system32&amp;gt;drivers&amp;gt;etc&amp;gt;hosts&quot; &lt;/p&gt;</comment>
                            <comment id="14469091" author="roshandawrani" created="Mon, 8 Mar 2010 05:10:31 +0000"  >&lt;p&gt;Locally that is how I had tried - I defined a virtual host and added an entry for that host in &quot;windows\system32\drivers\etc\hosts&quot; file but couldn&apos;t reproduce the issue. It picked up groovy scripts fine from WEB-INF\groovy directory.&lt;/p&gt;

&lt;p&gt;You may want to check if you run into the issue locally also.&lt;/p&gt;

&lt;p&gt;For remote setup, someone else has to pitch in who has access to multiple computers. Sorry, but I don&apos;t.&lt;/p&gt;</comment>
                            <comment id="14473311" author="dariusan" created="Wed, 10 Oct 2012 10:11:30 +0000"  >&lt;p&gt;I have issues again using Groovlets with Groovy 2.0.4 again!&lt;/p&gt;

&lt;p&gt;The page only loads once and the second time I get 404:&lt;/p&gt;

&lt;p&gt;17:06:39.815 &lt;span class=&quot;error&quot;&gt;&amp;#91;http-8080-2&amp;#93;&lt;/span&gt; I o.a.c.c.C.[.[.&lt;span class=&quot;error&quot;&gt;&amp;#91;/some-web-app&amp;#93;&lt;/span&gt; - GroovyServlet Error:  script: &apos;/test.groovy&apos;:  Script not found, sending 404.&lt;br/&gt;
GroovyServlet Error:  script: &apos;/test.groovy&apos;:  Script not found, sending 404.&lt;/p&gt;

&lt;p&gt;Shall I open a new bug or is this a reopen?&lt;/p&gt;</comment>
                            <comment id="14473361" author="blackdrag" created="Wed, 10 Oct 2012 15:19:25 +0000"  >&lt;p&gt;This is probably &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5747&quot; title=&quot;First call to Groovlet succeeds but subsequent calls return 404&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5747&quot;&gt;&lt;del&gt;GROOVY-5747&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722128" name="3888_v17x.txt" size="1127" author="roshandawrani" created="Fri, 20 Nov 2009 02:43:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c693:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>