<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:59:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-1882] NullPointerException when running two or more  scripts with GroovyScriptEngine in multiple threads .</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-1882</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;NullPointerException  is always thrown  when running the two  scripts  in multiple threads  with the same GroovyScriptEngine instance.&lt;/p&gt;


&lt;p&gt;Besides the NPE,the result is not correct sometime.&lt;/p&gt;

&lt;p&gt;Here is a  wrong result: &lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at groovy.util.GroovyScriptEngine$ScriptCacheEntry.access$502(GroovyScriptEngine.java:101)&lt;br/&gt;
	at groovy.util.GroovyScriptEngine.updateCacheEntry(GroovyScriptEngine.java:358)&lt;br/&gt;
	at groovy.util.GroovyScriptEngine.run(GroovyScriptEngine.java:395)&lt;br/&gt;
	at GroovyConcurrentTest$ScriptRunner.run(GroovyConcurrentTest.java:63)&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script3.groovy result:null&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script2&lt;/p&gt;

&lt;p&gt;I extpect the resut looks like this:&lt;br/&gt;
run :script2.groovy result:script2&lt;br/&gt;
run :script3.groovy result:script3&lt;/p&gt;

&lt;p&gt;Maybe the NPE is caused by the currentCacheEntry  is null?&lt;/p&gt;</description>
                <environment>Windows XP SP2 / Sun JDK1.5..0_09&lt;br/&gt;
</environment>
        <key id="12817155">GROOVY-1882</key>
            <summary>NullPointerException when running two or more  scripts with GroovyScriptEngine in multiple threads .</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="d0ngw">Dongyong Wang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 May 2007 21:27:12 +0000</created>
                <updated>Thu, 5 Jul 2007 05:08:46 +0000</updated>
                            <resolved>Thu, 5 Jul 2007 05:08:46 +0000</resolved>
                                    <version>1.1-beta-1</version>
                                    <fixVersion>1.1-beta-2</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14477315" author="d0ngw" created="Thu, 10 May 2007 10:55:17 +0000"  >&lt;p&gt;I was trying to fix this bug, and created a patch file. You can apply it  to see whether it &apos;s right to help repair bug. &lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14462691" author="blackdrag" created="Thu, 17 May 2007 12:13:19 +0000"  >&lt;p&gt;hmm... currentCacheEntry could be null while findClass is executed. That would explain the NPE. The synchronization on an interned String gives me a little headache... but should work. But there is no guaranteee, that findClass would be executed only from the GroovyScriptEngine... Additionally I have doubts, that the dependency tracking will work this way in all cases. findClass is not always executed. IMHO the usage of ResourceConnector should be reaplced with GroovyResourceLoader and GroovyClassLoader should be used more directly.&lt;/p&gt;</comment>
                            <comment id="14477351" author="d0ngw" created="Fri, 18 May 2007 11:59:21 +0000"  >&lt;p&gt;As you said that the use of currentCacheEntry  is not precise.&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Besides the above problem  if someone call loadScriptByName  to get a scipt class,the current class implement is not thread safe,and so on.&lt;br/&gt;
It&apos;s implements thrown CurrentModifyExcepiton in Groovy1.0,but to 1.1-beta-1,is not thread safe also.&lt;/p&gt;

&lt;p&gt;So I suggest  it&apos;s a good idea that the current implements should be reimplemented.&lt;/p&gt;

&lt;p&gt;BTW,does the GRails use this class?I haven&apos;t used it. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14462840" author="blackdrag" created="Thu, 5 Jul 2007 05:08:46 +0000"  >&lt;p&gt;patched&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721729" name="GroovyScriptEngine.patch" size="2119" author="" created="Thu, 10 May 2007 10:55:17 +0000"/>
                            <attachment id="12721186" name="test.zip" size="1177" author="" created="Wed, 9 May 2007 21:27:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c62f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>