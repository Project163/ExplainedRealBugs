<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:22:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-10756] STC: parameterized and bounded return value for java class property</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-10756</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A Java class having a method returning a generic Collection,&lt;/li&gt;
	&lt;li&gt;A groovy script compiled with &quot;CompileStatic&quot; and using the method of the JavaClass&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Then the type of the element of the collection is not correctly inferred.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bridge { &lt;span class=&quot;code-comment&quot;&gt;// java
&lt;/span&gt;    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;T &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; File&amp;gt; Collection&amp;lt;T&amp;gt; getFiles() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; and the following script:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.CompileStatic
def cst() {
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bridge().files.collect { it.name }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the compilation fails with the error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[Static type checking] - No such property: name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; class: java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It works in v3.0.10 but not in v3.0.11&lt;/li&gt;
	&lt;li&gt;It works if the class is defined in the groovy script&lt;/li&gt;
	&lt;li&gt;A repro is available here: &lt;a href=&quot;https://github.com/j3rem1e/groovy-bug-generic&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/j3rem1e/groovy-bug-generic&lt;/a&gt; (&lt;tt&gt;&amp;gt;mvn test&lt;/tt&gt;)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13480711">GROOVY-10756</key>
            <summary>STC: parameterized and bounded return value for java class property</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="j3rem1e">J. Br&#233;bec</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Sep 2022 19:14:09 +0000</created>
                <updated>Wed, 27 Dec 2023 18:22:22 +0000</updated>
                            <resolved>Fri, 9 Sep 2022 19:43:54 +0000</resolved>
                                    <version>3.0.11</version>
                    <version>2.5.18</version>
                    <version>4.0.4</version>
                                    <fixVersion>2.5.19</fixVersion>
                    <fixVersion>3.0.13</fixVersion>
                    <fixVersion>4.0.6</fixVersion>
                                    <component>Static Type Checker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17602413" author="emilles" created="Fri, 9 Sep 2022 15:12:04 +0000"  >&lt;p&gt;This is a similar issue as described in &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10651&quot; title=&quot;STC: closure parameter type inference for raw type that is iterable over type parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10651&quot;&gt;&lt;del&gt;GROOVY-10651&lt;/del&gt;&lt;/a&gt;.  Binary and source types get different treatment.  Specifically the generics for &quot;Collection&amp;lt;T&amp;gt;&quot; are different. When &lt;tt&gt;ResolveVisitor&lt;/tt&gt; processes the source, it sets the type &lt;tt&gt;File&lt;/tt&gt; as the redirect for the &lt;tt&gt;T&lt;/tt&gt; type parameter (see &lt;tt&gt;ResolveVisitor#resolveGenericsType&lt;/tt&gt;). However, both the ASM and ClassLoader resolution (via &lt;tt&gt;ClassNodeResolver&lt;/tt&gt;) leave &quot;T -&amp;gt; Object&quot; for the generics type.&lt;/p&gt;

&lt;p&gt;I may stil have some experimental code that walks the generics and fills this info in.  However, there are order of operations concerns that can lead to stack overflow conditions in the decompiler code, which is one reason I never got out of the experimental stage.&lt;/p&gt;

&lt;p&gt;Update: The class file parsing is not too different in 3.0.10.  The reason this started failing in 3.0.11 is a change in &lt;tt&gt;StaticTypeCheckingVisitor&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17602534" author="emilles" created="Fri, 9 Sep 2022 19:43:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/2924b9e138a8c6dedb79f93f78453183d2d99241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/2924b9e138a8c6dedb79f93f78453183d2d99241&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17602546" author="j3rem1e" created="Fri, 9 Sep 2022 20:18:58 +0000"  >&lt;p&gt;Thanks a lot !&lt;/p&gt;</comment>
                            <comment id="17606996" author="j3rem1e" created="Tue, 20 Sep 2022 08:44:57 +0000"  >&lt;p&gt;With 3.13, the previous snippet works. However, this one doesn&apos;t :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.CompileStatic
def cst2() {
    def f = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bridge().files[0]
    f.name
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error is now:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Static type checking] - No such property: name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; class: java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;
 @ line 10, column 5.
       f.name
       ^
1 error
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have updated the git repo.&lt;/p&gt;</comment>
                            <comment id="17607255" author="emilles" created="Tue, 20 Sep 2022 15:02:00 +0000"  >&lt;p&gt;Until this is fixed in Groovy 3.0.14, you can workaround the fully-resolve-on-assignment issue with either &quot;new Bridge().files&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.name&quot; or &quot;def files = new Bridge().files; files&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.name&quot;&lt;/p&gt;</comment>
                            <comment id="17607320" author="j3rem1e" created="Tue, 20 Sep 2022 17:06:18 +0000"  >&lt;p&gt;Thank for the suggestion ^^&lt;/p&gt;

&lt;p&gt;However these errors come from my automated integration test, and the scripts are business logic stored in a database and written by my client, I can&apos;t change it.&lt;/p&gt;</comment>
                            <comment id="17607322" author="emilles" created="Tue, 20 Sep 2022 17:14:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/efe514a5e28828309e7decbfaf923b5c7f42b05d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/efe514a5e28828309e7decbfaf923b5c7f42b05d&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17758072" author="jeremie.brebec" created="Wed, 23 Aug 2023 14:12:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; does this have been merged into v3 ? It looks like it doesn&apos;t work&#160; in v3.0.19&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17758085" author="emilles" created="Wed, 23 Aug 2023 14:35:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeremie.brebec&quot; class=&quot;user-hover&quot; rel=&quot;jeremie.brebec&quot;&gt;jeremie.brebec&lt;/a&gt; This is directly checked in Groovy 3: &lt;a href=&quot;https://github.com/apache/groovy/blob/38d5c992e1a6e0726778b29aaaf73b86e69e07a8/src/test/groovy/transform/stc/ClosureParamTypeInferenceSTCTest.groovy#L732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/38d5c992e1a6e0726778b29aaaf73b86e69e07a8/src/test/groovy/transform/stc/ClosureParamTypeInferenceSTCTest.groovy#L732&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Do you have a new example that fails?&lt;/p&gt;</comment>
                            <comment id="17758087" author="jeremie.brebec" created="Wed, 23 Aug 2023 14:38:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; &lt;del&gt;The one in my commentary (20 september 2022). I will recheck that.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;I am wrong, this example pass. Probably something in my side. I will recheck that and create another issue if necessary.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17758397" author="jeremie.brebec" created="Thu, 24 Aug 2023 07:00:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; It&apos;s slighty the same example :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.CompileStatic
def cst2() {
    def f = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bridge().files
    f[0].name
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The index accessor is after the variable, and this fails with the same error as before :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[Static type checking] - No such property: name &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; class: java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;
 @ line 10, column 5.
       f[0].name
       ^
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The test passes with the latest 4.0.14 however, but I&apos;m still in the v3 branch because of issues on performance of the parrot parser I did&apos;nt investigate yet.&lt;/p&gt;</comment>
                            <comment id="17758739" author="emilles" created="Thu, 24 Aug 2023 22:01:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/fe1e89cad786a76245858c9c44e1f261807d442a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/fe1e89cad786a76245858c9c44e1f261807d442a&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13548575">GROOVY-11163</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13562998">GROOVY-11258</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13386314">GROOVY-10153</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13448428">GROOVY-10651</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13469023">GROOVY-10671</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z18f3k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>