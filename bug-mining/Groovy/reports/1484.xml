<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:19:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4786] @EqualsAndHashCode : excludes does not work correctly </title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4786</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code should work. It fails in 1.8-rc4:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.EqualsAndHashCode

@EqualsAndHashCode(excludes=&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;X {
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; b
}

x1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(a:1, b:10)
x2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(a:1, b:100)

&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; x1 == x2
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; x1.hashCode() == x2.hashCode() &lt;span class=&quot;code-comment&quot;&gt;// failure here&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Ubuntu 10.10</environment>
        <key id="12815593">GROOVY-4786</key>
            <summary>@EqualsAndHashCode : excludes does not work correctly </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="e.castro">Emmanuel Castro</reporter>
                        <labels>
                    </labels>
                <created>Sun, 17 Apr 2011 04:18:43 +0000</created>
                <updated>Wed, 27 Apr 2011 19:05:43 +0000</updated>
                            <resolved>Sun, 17 Apr 2011 16:38:18 +0000</resolved>
                                    <version>1.8-rc-4</version>
                                    <fixVersion>1.8.0</fixVersion>
                                    <component>ast builder</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14471195" author="e.castro" created="Sun, 17 Apr 2011 06:13:18 +0000"  >&lt;p&gt;I think @EqualsAndHashCode should &amp;#8209; by default - ignore @Lazy properties. Thoses properties are generally pure functional results of the non lazy properties, which are tested by the equals().&lt;/p&gt;

&lt;p&gt;It might be convenient to exclude properties annotated by, say, @Transient, because their values may change without changing the general properties of the objects.&lt;/p&gt;</comment>
                            <comment id="14471175" author="e.castro" created="Sun, 17 Apr 2011 06:49:29 +0000"  >&lt;p&gt;In EqualsAndHashCodeASTTransformation, the transformer test if field contains &quot;$&quot;. It seems not too work with @Lazy (which produce synthetic field with a &quot;$&quot;). Consider the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.EqualsAndHashCode

def dump(x) { &lt;span class=&quot;code-comment&quot;&gt;// I don&apos;t want the standard dump that calls hashCode()
&lt;/span&gt;    println x.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;declaredFields.findAll{ it.modifiers == 2 }.collect{ it.accessible=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; ; [it, it.get(x)] }
}

@EqualsAndHashCode
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;X { 
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a 
    @Lazy &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; b = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;$a&amp;gt;&quot;&lt;/span&gt;
}

x1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(a:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;)
x2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(a:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;)

x1.b &lt;span class=&quot;code-comment&quot;&gt;// force the evaluation of b
&lt;/span&gt;dump(x1)
dump(x2)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; x1 == x2
dump(x1)
dump(x2) &lt;span class=&quot;code-comment&quot;&gt;// You can see that the $b field has been evaluated and tested by ==&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479507" author="paulk" created="Sun, 17 Apr 2011 16:38:18 +0000"  >&lt;p&gt;Thanks for spotting that! Excludes was wired up for equals but not hashCode - and previously there was no unit test for this particular case to guard against such an error. Fixed now.&lt;/p&gt;</comment>
                            <comment id="14479511" author="paulk" created="Sun, 17 Apr 2011 17:24:00 +0000"  >&lt;p&gt;Just for clarification, what was fixed was the originally reported problem with &lt;tt&gt;excludes&lt;/tt&gt; and &lt;tt&gt;hashCode()&lt;/tt&gt;. No change was made wrt &lt;tt&gt;@Lazy&lt;/tt&gt;. The default behavior (unless the &lt;tt&gt;includeFields&lt;/tt&gt; attribute is set to &lt;tt&gt;true&lt;/tt&gt;) is to base &lt;tt&gt;equals&lt;/tt&gt; and &lt;tt&gt;hashCode&lt;/tt&gt; on properties - so in the case of &lt;tt&gt;b&lt;/tt&gt; being lazy above, the property &lt;tt&gt;b&lt;/tt&gt; is still part of the evaluation - the backing field &lt;tt&gt;$b&lt;/tt&gt; is not. If you did set &lt;tt&gt;includeFields=true&lt;/tt&gt;, then because the backing field included the dollar character it would still not be included but the property would still be. Just use &lt;tt&gt;excludes=&apos;b&apos;&lt;/tt&gt; if you really don&apos;t want the &apos;==&apos; method to evaluate &lt;tt&gt;b&lt;/tt&gt;. Or raise a separate issue if you believe there is some incorrect behavior wrt &lt;tt&gt;@Lazy&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bswf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>