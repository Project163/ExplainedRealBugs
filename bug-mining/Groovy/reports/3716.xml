<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:04:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9406] `VerifyError` when annotating with both @InheritConstructors and @NullCheck and calling the resulting c&apos;tor</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9406</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given a class annotated with both `@InheritConstructors` and&lt;br/&gt;
 `@NullCheck` (note the order!), a `java.lang.VerifyError` happens, when&lt;br/&gt;
 the c&apos;tor is called.&lt;/p&gt;

&lt;p&gt;E.g.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Base {
	&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; id
	Base(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; id) { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.id = id }
}

@groovy.transform.InheritConstructors &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;1&amp;gt;
&lt;/span&gt;@groovy.transform.NullCheck           &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;2&amp;gt;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Sub &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Base {}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Sub(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Results in:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caught: java.lang.VerifyError: Bad operand type when invoking &amp;lt;init&amp;gt;
Exception Details:
  Location:
    Sub.&amp;lt;init&amp;gt;(Ljava/lang/Long;)V @38: invokespecial
  Reason:
    Invalid type: &apos;Sub&apos; (current frame, stack[0])
  Current Frame:
    bci: @38
    flags: { }
    locals: { &apos;Sub&apos;, &apos;java/lang/Long&apos;, &apos;[Lorg/codehaus/groovy/runtime/callsite/CallSite;&apos; }
    stack: { &apos;Sub&apos;, &apos;java/lang/Long&apos; }
  Bytecode:
    0x0000000: b800 104d 2ab7 0013 2b01 b800 1999 0014
    0x0000010: 2c12 1a32 121c 121e b900 2403 00c0 0026
    0x0000020: bf2a 2bc0 0028 b700 2ab1               
  Stackmap Table:
    full_frame(@33,{Object[#2],Object[#40],Object[#48]},{})

java.lang.VerifyError: Bad operand type when invoking &amp;lt;init&amp;gt;
Exception Details:
  Location:
    Sub.&amp;lt;init&amp;gt;(Ljava/lang/Long;)V @38: invokespecial
  Reason:
    Invalid type: &apos;Sub&apos; (current frame, stack[0])
  Current Frame:
    bci: @38
    flags: { }
    locals: { &apos;Sub&apos;, &apos;java/lang/Long&apos;, &apos;[Lorg/codehaus/groovy/runtime/callsite/CallSite;&apos; }
    stack: { &apos;Sub&apos;, &apos;java/lang/Long&apos; }
  Bytecode:
    0x0000000: b800 104d 2ab7 0013 2b01 b800 1999 0014
    0x0000010: 2c12 1a32 121c 121e b900 2403 00c0 0026
    0x0000020: bf2a 2bc0 0028 b700 2ab1               
  Stackmap Table:
    full_frame(@33,{Object[#2],Object[#40],Object[#48]},{})

	at nullcheckinherhitctor.run(nullcheckinherhitctor.groovy:10)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Please note: switching `&amp;lt;1&amp;gt;` and `&amp;lt;2&amp;gt;` does &lt;b&gt;not&lt;/b&gt; show this error, but&lt;br/&gt;
 the `null` does not throw either.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13286051">GROOVY-9406</key>
            <summary>`VerifyError` when annotating with both @InheritConstructors and @NullCheck and calling the resulting c&apos;tor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="ridcully">Christoph Frick</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Feb 2020 17:53:15 +0000</created>
                <updated>Mon, 9 Mar 2020 03:05:50 +0000</updated>
                            <resolved>Fri, 21 Feb 2020 03:22:33 +0000</resolved>
                                    <version>3.0.1</version>
                                    <fixVersion>3.0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17039423" author="paulk" created="Tue, 18 Feb 2020 20:20:38 +0000"  >&lt;p&gt;Good catch Christoph. Both transforms run at the &lt;tt&gt;CANONICALIZATION&lt;/tt&gt; phase, so the order matters and it&apos;s a given with the declarative style of transforms that there can be transform interactions.&lt;br/&gt;
If &lt;tt&gt;NullCheck&lt;/tt&gt; is first, it instruments all existing methods/constructors with null checks (but there aren&apos;t any at that point). Then &lt;tt&gt;InheritConstructors&lt;/tt&gt; adds the required constructors.&lt;br/&gt;
If &lt;tt&gt;InheritConstructors&lt;/tt&gt; is first, the required constructor is added which calls &lt;tt&gt;super(id)&lt;/tt&gt; as the first statement (and it is required to be first). The bug is that &lt;tt&gt;NullCheck&lt;/tt&gt; is adding the check for null ahead of the &lt;tt&gt;super(id)&lt;/tt&gt; statement.&lt;/p&gt;</comment>
                            <comment id="17039431" author="ridcully" created="Tue, 18 Feb 2020 20:27:16 +0000"  >&lt;p&gt;I understood the doc comment of `@NullCheck` as so, that only &lt;em&gt;explicitly&lt;/em&gt; defined functions are null-protected (and I see this behaviour with empiric tests around e.g. `@TupleConstructor`). So `@NullChecker` must not work at all in this case, right?&lt;/p&gt;</comment>
                            <comment id="17039453" author="paulk" created="Tue, 18 Feb 2020 21:01:15 +0000"  >&lt;p&gt;True, so you have found two bugs in one! If you add an explicit constructor calling super (instead of &lt;tt&gt;@InheritConstructors&lt;/tt&gt;) you still get the &lt;tt&gt;VerifyError&lt;/tt&gt;. I&apos;ll fix the &lt;tt&gt;VerifyError&lt;/tt&gt; and then we can possibly make the &lt;em&gt;explicit&lt;/em&gt; part be configurable to potentially include generated methods.&lt;/p&gt;</comment>
                            <comment id="17041500" author="paulk" created="Fri, 21 Feb 2020 03:22:33 +0000"  >&lt;p&gt;This should be fixed now. It was previously getting declared methods which included generated ones in some cases. It now skips those but has a flag to try to add null checks on some generated cases too.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13286980">GROOVY-9417</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0bmhs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>