<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:25:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2582] cannot extend java.util.Properties unless getProperty() is overridden</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2582</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Running this in groovyconsole&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Configuration &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; java.util.Properties 
{  
    
}  
1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;yields the following error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception thrown: org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed, 
Script9: -1: the return type is incompatible with java.lang.String getProperty(java.lang.String) in 
java.util.Properties. Node: org.codehaus.groovy.ast.MethodNode. At [-1:-1]  @ line -1, column -1.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when the getProperty() method is overridden the code runs fine:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Configuration &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; java.util.Properties 
{  
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getProperty(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) {
    }
} 
1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment>Windows 2000, JDK 1.6, Groovy 1.5.4</environment>
        <key id="12814048">GROOVY-2582</key>
            <summary>cannot extend java.util.Properties unless getProperty() is overridden</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="erikb">Erik Bartels</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Feb 2008 10:24:39 +0000</created>
                <updated>Wed, 3 Dec 2008 19:00:41 +0000</updated>
                            <resolved>Wed, 3 Dec 2008 19:00:41 +0000</resolved>
                                    <version>1.5.4</version>
                                    <fixVersion>1.6-rc-1</fixVersion>
                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>ast builder</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14465471" author="roshandawrani" created="Thu, 13 Nov 2008 05:49:43 +0000"  >&lt;p&gt;Adding some details to describe the following conditions in which this problem occurs :-&lt;/p&gt;

&lt;p&gt;1) Base class and interface are implemented in java. The base class does not implement this interface. The base class and interface define a method that have incompatible return types but otherwise matching signatures.&lt;/p&gt;

&lt;p&gt;2) There is a class in groovy that extends that above mentioned base class and implements the interface. Compiling the groovy class throws the compilation error mentioned in this JIRA item. (groovy does not consider method implementation in Base class as implementation of interface method because of incompatible return type and hence marks considers the interface method as unimplemented and groovy class as abstract)&lt;/p&gt;

&lt;p&gt;The code that demonstrates the above conditions is:&lt;/p&gt;

&lt;p&gt;Interface and Base class in java:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; IParent {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; invokeMe();
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Parent {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; invokeMe(){&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;} &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type incompatible to method defined in IParent
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Subclass in groovy:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Child &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Parent &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; IParent {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&quot;public class Configuration extends java.util.Properties&quot; fails because java.util.Properties has &quot;public String getProperty(String)&quot; and GroovyObject has &quot;public Object getProperty(String)&quot; - same conditions as mentioned above.&lt;/p&gt;

&lt;p&gt;Hope it helps.&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14465529" author="blackdrag" created="Thu, 13 Nov 2008 06:23:15 +0000"  >&lt;p&gt;I guess I should extend that a bit.... afaik it does not matter if it is in Groovy or not, important is that there is a parent class method that is covariant to a method in a n interface I implement in the subclass. The Java compiler seems not to have a problem with this, so it should be allowed in Groovy too. The current algorithm for covariants is looking at methods covariant to methods from the super class and interfaces only.  That means a method of the current class &quot;overrides&quot; the method of the super class or implements an interface method. Now here we have a parent class method &quot;overriding&quot; the method from an interface implemented in the current class. This is out of the scope of the algorithm, so the algorithm has to be adapted to consider these methods too.&lt;/p&gt;</comment>
                            <comment id="14465595" author="roshandawrani" created="Thu, 13 Nov 2008 08:36:07 +0000"  >&lt;p&gt;But even Java has the same problem:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; IParent {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; invokeMe();
}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Parent {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; invokeMe(){&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;}	
}

	/*
	 * The following line results in compilation error because the &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type is
	 * incompatible.
	 */
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Child &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Parent &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; IParent {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; invokeMe();
}

	/*
	 * Child &lt;span class=&quot;code-keyword&quot;&gt;class&lt;&lt;/span&gt;span class=&quot;code-quote&quot;&gt;&apos; code as shown above is what following Configuration groovy class&apos;&lt;/span&gt;s generated code 
will come down to &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; groovy does somehow implement GroovyObject&apos;s &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; getProperty(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)&quot;&lt;/span&gt; method
	 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Configuration &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; java.util.Properties 
{  
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getProperty(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) {
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think what groovy compiler is doing is correct - in the sense that the compilation in this scenario should fail.&lt;/p&gt;

&lt;p&gt;Probably what can be done is make some checks in groovy compiler to identify this scenario (java parent class providing the implementation for an interface that  groovy subclass implements) and throw a different message with some suggested solution.&lt;/p&gt;

&lt;p&gt;However, additional checks will affect the compilation and runtime performance both. Or, it can be documented well but then it is not as useful as a good message from compiler.&lt;/p&gt;</comment>
                            <comment id="14465558" author="blackdrag" created="Thu, 13 Nov 2008 09:58:54 +0000"  >&lt;p&gt;to override &quot;String invokeMe&quot; with &quot;Object invokeMe&quot; is of course wrong. But we are talking about a method added by the compiler automatically. AFAIK the compiler does no longer add the method as of 1.5.7 and 1.6-beta2 if the parent class has already a method like that. But this does not solve the problem here. Since IParent requires a Object returning method one method like that has to be added as bridge, which calls the String returning method.  This part is missing and will probably lead to a compilation error talking about not having implemented an abstract method. Or another problem... &lt;/p&gt;

&lt;p&gt;If your Child class above would not contain any method declaration, then it should compile in Java.&lt;/p&gt;</comment>
                            <comment id="14465564" author="roshandawrani" created="Thu, 13 Nov 2008 10:12:11 +0000"  >&lt;p&gt;I see. So, you are saying that for a method that is added automatically by the compiler, it is ok to have &quot;Object invokeMe&quot; in sub-class bytecode &lt;span class=&quot;error&quot;&gt;&amp;#91;one that adapts the call to String invokeMe&amp;#93;&lt;/span&gt; when its parent is having &quot;String invokeMe&quot; - something that both java/groovy compilers both don&apos;t allow for user written code?&lt;/p&gt;

&lt;p&gt;I didn&apos;t understand that compiler can use this extra power. I thought rules needed to be same whether methods were being added by compiler or the methods were being overridden in the code.&lt;/p&gt;

&lt;p&gt;The JVM won&apos;t have any issue executing that code? I am just curious.&lt;/p&gt;</comment>
                            <comment id="14465598" author="blackdrag" created="Thu, 13 Nov 2008 10:42:54 +0000"  >&lt;p&gt;yes, the compiler should reuse the existing method. A Object version will still exist, it only is a bridge to the real implementation, the covariant method. The JVM only cares about an existing Object method, because there is an interface with that method and the method must be implemented. But the JVM allows multiple methods of the same name with the same parameter types and different return types. When you for example compile a class with a method String invokeMet(), and the parent class contains a method Object invokeMe, then we have the covariant case here and the compiler will not only add the method String invokeMe() as specified by the user, the compiler will also add a bridge method for Object invokeMe() that will call the String returning method. From this logic the constraints of covariants do also become clear... the overriding method must return a class, that is a subclass of the other method return type. String is ok for Object, but obviously not for Integer.&lt;/p&gt;

&lt;p&gt;Now our policy for methods from GroovyObject is, that they are only added if needed. If the super class is already implementing them, then don&apos;t override. If the user has specified them, then don&apos;t replace. According to this, the compiler must not add another getProperty method, because Properties has already one. If that is not doing the right thing, then the method needs to be overridden by user code.&lt;/p&gt;

&lt;p&gt;So I compare this case more to your Child class without any user methods... which should compile and cause the compiler to add the bridge method.&lt;/p&gt;
</comment>
                            <comment id="14465517" author="roshandawrani" created="Thu, 13 Nov 2008 11:02:52 +0000"  >&lt;p&gt;Thanks for explaining. I had no idea about covariant methods. Your suggested approach is very clear now.&lt;/p&gt;

&lt;p&gt;Can you please point me to where in the compiler code this covariant algorithm is implemented - say in 1.5.8? &lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;

&lt;p&gt;rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14465596" author="erikb" created="Fri, 14 Nov 2008 03:54:16 +0000"  >&lt;p&gt;&amp;gt; So I compare this case more to your Child class without any user methods... which should compile and cause the compiler to add the bridge method.&lt;/p&gt;

&lt;p&gt;Agreed.   Your compiler discussion is a bit beyond me but with Groovy&apos;s promise of Java integration I certainly think the code should work...  &lt;/p&gt;</comment>
                            <comment id="14465862" author="blackdrag" created="Wed, 3 Dec 2008 19:00:41 +0000"  >&lt;p&gt;fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bw47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>