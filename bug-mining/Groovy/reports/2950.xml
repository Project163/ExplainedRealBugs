<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:47:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7623] IBM Java (J9) ClassValue works correctly so should use it by default</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7623</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7591&quot; title=&quot;Use of ClassValue causes major memory leak&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7591&quot;&gt;&lt;del&gt;GROOVY-7591&lt;/del&gt;&lt;/a&gt; disabled the use of java.lang.ClassValue by default due to a bug in OpenJDK: &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8136353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8136353&lt;/a&gt; The result is that &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6704&quot; title=&quot;Memory leak in ClassInfo when using MetaClasses&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6704&quot;&gt;&lt;del&gt;GROOVY-6704&lt;/del&gt;&lt;/a&gt; occurs on all versions of Java again.&lt;/p&gt;

&lt;p&gt;The bug in OpenJDK does not impact IBM Java, so when running on IBM Java, java.lang.ClassValue should be used by default.  So at least users on IBM Java will not experience &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6704&quot; title=&quot;Memory leak in ClassInfo when using MetaClasses&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6704&quot;&gt;&lt;del&gt;GROOVY-6704&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12903831">GROOVY-7623</key>
            <summary>IBM Java (J9) ClassValue works correctly so should use it by default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pascalschumacher">Pascal Schumacher</assignee>
                                    <reporter username="candrews">Craig</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Oct 2015 17:14:30 +0000</created>
                <updated>Tue, 30 Aug 2016 14:19:43 +0000</updated>
                            <resolved>Mon, 19 Oct 2015 16:44:12 +0000</resolved>
                                    <version>2.4.5</version>
                                    <fixVersion>2.4.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14950806" author="candrews" created="Fri, 9 Oct 2015 17:20:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/137&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14963585" author="githubbot" created="Mon, 19 Oct 2015 16:43:03 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/137&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14963589" author="pascalschumacher" created="Mon, 19 Oct 2015 16:44:37 +0000"  >&lt;p&gt;Pull request merged. Thanks!&lt;/p&gt;</comment>
                            <comment id="15449136" author="gsandrew" created="Tue, 30 Aug 2016 14:17:26 +0000"  >&lt;p&gt;For anyone who is attempting to use the IBM JDK 8 for a grails project, here is how I did it in my development environment for a Grails 2.5.5 project.  I&apos;m sure there is a lower common denominator of a solution but, this is what I did.  I&apos;m currently deploying to Heroku in production and developing on Mac OSX so it made things a little trickier since I didn&apos;t have a Linux environment handy to unpack the .bin from IBM.  &lt;/p&gt;

&lt;p&gt;Once you&apos;ve got the .tar.gz in hand, I had to untar it, remove jre/lib/xml.jar since it&apos;s using old versions of xerces/xalan/etc classes and weren&apos;t playing nice with my Grails 2.5.5 project.  Then, I added the following files into jre/lib/endorsed:&lt;/p&gt;

&lt;p&gt;jaxp-api-1.4.2.jar, serializer-2.7.2.jar, xalan-2.7.2.jar, xercesImpl-2.9.1.jar, xml-apis-1.3.04.jar&lt;/p&gt;

&lt;p&gt;Now, there&apos;s a fun little piece of code in ClasspathConfigurer that likes to force you to use a particular javax.xml.parsers.DocumentBuilderFactory if Grails finds a xercesImpl dependency (transitive or not) in your BuildConfig.  And, ClasspathConfigurer gets invoked when using ./grailsw (which Heroku makes use of). So, that&apos;s why I &quot;had&quot; to put xercesImpl in the endorsed lib instead of just using the version in my project.  I attempted to use the IBM JDK as it was combined with Heroku&apos;s support for a .jdk-overlay directory but it wasn&apos;t strong enough of an override.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;ClasspathConfigurer.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void addDependenciesToURLs(Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; excludes, List&amp;lt;URL&amp;gt; urls, List&amp;lt;File&amp;gt; runtimeDeps) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; MalformedURLException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (runtimeDeps == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (File file : runtimeDeps) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (file == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ) {
                &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
            }


            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (file.getName().contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;xercesImpl&quot;&lt;/span&gt;)) {
                &lt;span class=&quot;code-comment&quot;&gt;// workaround &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; GRAILS-9708
&lt;/span&gt;                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;javax.xml.parsers.DocumentBuilderFactory&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderFactoryImpl&quot;&lt;/span&gt;);
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (excludes != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !excludes.contains(file.getName())) {
                URL url = file.toURI().toURL();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (urls.contains(url)) &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;

                urls.add(url);
                excludes.add(file.getName());
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my BuildConfig.groovy I had to add setting the following dependencies:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;runtime (&lt;span class=&quot;code-quote&quot;&gt;&apos;org.codehaus.groovy.modules.http-builder:http-builder:0.7.1&apos;&lt;/span&gt;) {excludes &lt;span class=&quot;code-quote&quot;&gt;&apos;xercesImpl&apos;&lt;/span&gt;}

runtime &lt;span class=&quot;code-quote&quot;&gt;&quot;xalan:xalan:2.7.2&quot;&lt;/span&gt;

runtime &lt;span class=&quot;code-quote&quot;&gt;&quot;com.fasterxml.woodstox:woodstox-core:5.0.3&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The xercesImpl exclusion I explained and the woodstox is because the xml.jar IBM had included some streaming XML class files that needed replenishing.&lt;/p&gt;

&lt;p&gt;Then......&lt;/p&gt;

&lt;p&gt;After I re-tared up the IBM JDK with the xml.jar removed and my other jars inserted I was able to start the Heroku server and get past the step of grailsw that auto-generates the war file. &lt;/p&gt;

&lt;p&gt;Then....&lt;/p&gt;

&lt;p&gt; I ran into the problem where IBM&apos;s JSSE loves to default to using TLS 1.0 and my integration with Stripe was failing since that requires TLSv1.2 &quot;or higher&quot;.  After some more headbanging I ran into this IBM support doc that was satisfyingly infuriating.  I was simultaneously pissed they made the choice not to operate like every other JDK but at least they made it possible to play nice.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Use the system property com.ibm.jsse2.overrideDefaultTLS to match the behavior of SSLContext.getInstance(&quot;TLS&quot;) in the IBM SDK with the Oracle implementation.&lt;/p&gt;

&lt;p&gt;com.ibm.jsse2.overrideDefaultTLS =true|false&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;from &lt;a href=&quot;http://www.ibm.com/support/knowledgecenter/SSYKE2_8.0.0/com.ibm.java.security.component.80.doc/security-component/jsse2Docs/matchsslcontext_tls.html#matchsslcontext_tls&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;IBM Support&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After all of that and I&apos;m still not seeing the classes get garbage collected.  I pray it&apos;s because I&apos;m somehow misusing groovy.use.classvalue=true&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12826186/12826186_Screen+Shot+2016-08-30+at+10.11.18+AM.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12813177">GROOVY-6704</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12915354">GROOVY-7683</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12863687">GROOVY-7591</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12826186" name="Screen Shot 2016-08-30 at 10.11.18 AM.png" size="60430" author="gsAndrew" created="Tue, 30 Aug 2016 14:17:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mtsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>