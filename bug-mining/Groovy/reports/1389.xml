<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:17:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4475] Boolean seems to support toBoolean() but yields incorrect results</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4475</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This is curious (with groovy shipped with grails 1.3.4)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; b = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
def x = b.toBoolean()

println x
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; x
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1) where is no-arg toBoolean() coming from&lt;br/&gt;
2) why does it return false for true input.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12811702">GROOVY-4475</key>
            <summary>Boolean seems to support toBoolean() but yields incorrect results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="guillaume">Guillaume Sauthier</assignee>
                                    <reporter username="marc@anyware.co.uk">Marc Palmer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Oct 2010 11:56:15 +0000</created>
                <updated>Wed, 15 Dec 2010 16:57:00 +0000</updated>
                            <resolved>Thu, 14 Oct 2010 10:08:14 +0000</resolved>
                                                    <fixVersion>1.7.6</fixVersion>
                    <fixVersion>1.8-beta-3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14470150" author="roshandawrani" created="Tue, 12 Oct 2010 12:37:29 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3704&quot; title=&quot;boolean.toBoolean()  always return false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3704&quot;&gt;&lt;del&gt;GROOVY-3704&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14479347" author="marc@anyware.co.uk" created="Tue, 12 Oct 2010 14:40:14 +0000"  >&lt;p&gt;Jochen - this may be a duplicate - but the duplicate is closed and the problem still exists.&lt;/p&gt;

&lt;p&gt;There is a violated user expectation. This warrants some discussion and a solution.&lt;/p&gt;

&lt;p&gt;e.g. no-arg instance method toBoolean() should be supported on Boolean in GDK, most likely. Having this behaviour makes no sense at all. Yes we know the reason for it, but that does not mean the behaviour makes sense to users.&lt;/p&gt;</comment>
                            <comment id="14479360" author="marc@anyware.co.uk" created="Tue, 12 Oct 2010 14:52:03 +0000"  >&lt;p&gt;The question here really is:&lt;/p&gt;

&lt;p&gt;Should Boolean.toBoolean(null) be called at all in this case. Is this documented, defined behaviour in Groovy? I&apos;ve not come across this before for method invocations (closures yes). Are we 100% sure its not an accidental leakage of functionality from closures&lt;/p&gt;

&lt;p&gt;If yes, this is desired behaviour, then we need GDK instance method toBoolean() to stop this nonsense happening for users. The workaround of always doing toString().toBoolean() on polymorphic values is wasteful, and won&apos;t always work if the toString representation of the object is not compatible with String.toBoolean() behaviour.&lt;/p&gt;

&lt;p&gt;At the very bottom line, every coder of every other language will surely laugh at Groovy users for having an out of the box implementation of true.toBoolean() that returns false.&lt;/p&gt;</comment>
                            <comment id="14470256" author="burtbeckwith" created="Tue, 12 Oct 2010 14:53:46 +0000"  >&lt;p&gt;Perhaps this comment belongs on 3704, but what are the negative implications of adding a proper toBoolean method to the Boolean metaclass? Any code that relies on the behavior of the private static method (i.e. true == false) is badly broken anyway.&lt;/p&gt;</comment>
                            <comment id="14479350" author="marc@anyware.co.uk" created="Tue, 12 Oct 2010 14:59:08 +0000"  >&lt;p&gt;I agree re: 3704 but I&apos;m not sure it matters much.&lt;/p&gt;

&lt;p&gt;I&apos;m wondering if actually toBoolean() should exist on all classes and defer to the customizable groovy truth implementation? Surely that makes more sense?&lt;/p&gt;</comment>
                            <comment id="14470312" author="blackdrag" created="Tue, 12 Oct 2010 15:15:42 +0000"  >&lt;p&gt;Would you be happy if that would throw an Exception? Like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; toBoolean(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; b){
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MissingMethodException(&lt;span class=&quot;code-quote&quot;&gt;&quot;toBoolean&quot;&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;class,&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[0]);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then the call would be causinga MissingMethodException... Or we throw a different and suggest the usage of asBoolean or booleanValue.&lt;/p&gt;

&lt;p&gt;As for if toBoolean() should exist on all classes and defer to groovy truth... well, that would be asBoolean... I don&apos;t think it is wise to promote a different method here.&lt;/p&gt;

&lt;p&gt;On the matter of if toBoolean should be called with null here at all... Yes and no. It is a private staticmethod, so the answer would be no, but answering like this makes the issue a 2.0 thing and there is an issue for things like these already. shold it actually be called with null as value, then yes, that is general Groovy method invocation logic... One that I don&apos;t intend to support for 2.0 anymore. I don&apos;t know if this was originally a leakage from Closures, it is not now.&lt;/p&gt;</comment>
                            <comment id="14479363" author="marc@anyware.co.uk" created="Tue, 12 Oct 2010 15:35:32 +0000"  >&lt;p&gt;I don&apos;t think toBoolean( x ) should throw an exception because this is a valid JDK method. The problem is how groovy invokes it&lt;/p&gt;

&lt;p&gt;I think non-static toBoolean() with no args should be implemented and work as expected.&lt;/p&gt;

&lt;p&gt;Why?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;Logic&quot;&lt;/span&gt;.toString() == &lt;span class=&quot;code-quote&quot;&gt;&quot;Logic&quot;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; 5.toInteger() == 5
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; [1,2].toArray() == [1,2]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All these pass. Except assert true.toBoolean() == true&lt;/p&gt;

&lt;p&gt;This is not rocket science, we are essentially broken &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;A caveat here - there is no non-static Character.toCharacter() either&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="14470290" author="blackdrag" created="Tue, 12 Oct 2010 15:38:32 +0000"  >&lt;p&gt;I suggested to capture toBoolean(), not toBoolean(String). &lt;/p&gt;</comment>
                            <comment id="14479361" author="marc@anyware.co.uk" created="Tue, 12 Oct 2010 15:53:05 +0000"  >&lt;p&gt;OK my bad, but still throwing an exception on toBoolean() makes no sense to the user. Especially when they know they have a boolean.&lt;/p&gt;

&lt;p&gt;But anyway, why would toBoolean(boolean) be called when you are invoking (accidentally) toBoolean(null)?&lt;/p&gt;

&lt;p&gt;what is the problem with:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; toBoolean() { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14470229" author="blackdrag" created="Tue, 12 Oct 2010 16:47:31 +0000"  >&lt;p&gt;seems like some more explanations are needed.... The idea is that this method normally does not exist. As such it would normally throw a MissingMethodException. The code I showed is for DefaultGroovyMethods, which stores the methods it adds to objects in category style. The first argument is actually &quot;this&quot; then. So toBoolean(Boolean) becomes Boolean#toBoolean(). People can still call toBoolean(null) and get the strange behaviour of course. But since this is all about toBoolean() without arguments, and since that is with what people expect, I would think this as a reasonable solution. The pro side is that this is the least invasive change I can think of here. Adding toBoolean() to everyting is very invasive.&lt;/p&gt;</comment>
                            <comment id="14470257" author="roshandawrani" created="Tue, 12 Oct 2010 22:59:07 +0000"  >&lt;p&gt;But if are introducing a DGM toBoolean(Boolean) to stop the boolean.toBoolean() call from going to that private static JDK method, then why is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; toBoolean(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; self){
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;not preferred over&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; toBoolean(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; self){
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; some exception....
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What am I missing?&lt;/p&gt;</comment>
                            <comment id="14470364" author="pledbrook" created="Wed, 13 Oct 2010 02:59:47 +0000"  >&lt;p&gt;Just to throw myself into the ring. I know that Groovy now has an asBoolean() method, but it also has polymorphich &lt;tt&gt;toInteger()&lt;/tt&gt; and &lt;tt&gt;toLong()&lt;/tt&gt; methods. That&apos;s why Marc and I expect a &lt;tt&gt;Boolean.toBoolean()&lt;/tt&gt; as well as a &lt;tt&gt;String.toBoolean()&lt;/tt&gt;. It seems amazingly inconsistent not to have it.&lt;/p&gt;

&lt;p&gt;Also, I believe that bringing &lt;tt&gt;asBoolean()&lt;/tt&gt; into this discussion is a red herring. Consider this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;println &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;.toBoolean()
println &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;.asBoolean()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This prints out&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;false
true
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hence &lt;tt&gt;toBoolean()&lt;/tt&gt; and &lt;tt&gt;asBoolean()&lt;/tt&gt; have different semantics. This must suggest that &lt;tt&gt;Boolean.toBoolean()&lt;/tt&gt; should be added?&lt;/p&gt;</comment>
                            <comment id="14470291" author="pledbrook" created="Wed, 13 Oct 2010 03:03:54 +0000"  >&lt;p&gt;Perhaps I should just throw my hat into the ring instead? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14470335" author="blackdrag" created="Wed, 13 Oct 2010 06:13:02 +0000"  >&lt;p&gt;toInteger(), toLong() and such are relicts of code that is now in DefaultTypeTransformation using those methods Groovy made internal conversion mechanisms visible to the outside. But internal code and API requirements may differ over time, so the parts developed into different directions. As you can see, those methods are mostly from Groovy 1.0, the most early version possible.&lt;/p&gt;

&lt;p&gt;I am a bit puzzled as of why nobody did yet answer if toBoolean() throwing an exception is not good enough for them. Making toBoolean() mirror asBoolean() is for me quite bad. In that case it would be much better to deprecate asBoolean() and use toBoolean() instead. If that had not been introduced in 1.7 already, then I would have suggested this route instead. This route could be considered maybe for 2.0... even though I am not happy with such small changes, that are hard to recognize. &lt;/p&gt;
</comment>
                            <comment id="14470347" author="pledbrook" created="Wed, 13 Oct 2010 07:59:17 +0000"  >&lt;p&gt;Hmmm...I don&apos;t remember &lt;tt&gt;&quot;1234&quot; as Integer&lt;/tt&gt; working before. I see why that now makes toInteger() rather redundant.&lt;/p&gt;

&lt;p&gt;That still leaves the problem that &lt;tt&gt;&quot;false&quot;&lt;/tt&gt; as Boolean returns &lt;tt&gt;true&lt;/tt&gt;, whereas &lt;tt&gt;true.toString()&lt;/tt&gt; gives &lt;tt&gt;&quot;true&quot;&lt;/tt&gt;. But then you would be breaking the current meaning of Groovy Truth. Having a &lt;tt&gt;Boolean.toBoolean()&lt;/tt&gt; convenience method would at least give us a behaviour that matches the reverse of &lt;tt&gt;String.toBoolean()&lt;/tt&gt;. So to be explicit, throwing a &lt;tt&gt;MissingMethodException&lt;/tt&gt; wouldn&apos;t be sufficient because I think a proper implementation of &lt;tt&gt;Boolean.toBoolean()&lt;/tt&gt; is required.&lt;/p&gt;</comment>
                            <comment id="14470314" author="blackdrag" created="Wed, 13 Oct 2010 11:10:53 +0000"  >&lt;p&gt;String#toBoolean() goes btw back to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-1292&quot; title=&quot;Improve the provision of toXXX methods in DGM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-1292&quot;&gt;&lt;del&gt;GROOVY-1292&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-1293&quot; title=&quot;Add toXXX methiods to GPath expressions for objects produced by XMLSlurper&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-1293&quot;&gt;&lt;del&gt;GROOVY-1293&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;a Boolean#toBoolean() does not help with (&quot;false&quot; as Boolean)... &lt;/p&gt;

&lt;p&gt;I am still not sure what you guys actually want. toInteger() and such where added as numeric conversion methods. Of course toBoolean() is not by default in that set, as it is not toClosure, toGString, and many other basic types. &lt;/p&gt;</comment>
                            <comment id="14470275" author="pledbrook" created="Wed, 13 Oct 2010 11:50:43 +0000"  >&lt;p&gt;Correct, Boolean#toBoolean() won&apos;t suddenly change the behaviour of (&quot;false&quot; as Boolean), but that&apos;s fine. That&apos;s not the intention. The idea is to have a method that matches String#toBoolean() on Boolean itself, so you can deal with the two types polymorphically, i.e. given:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;b1 = &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;
b2 = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
b3 = &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;
b4 = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then these assertions pass&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !b1.toBoolean()
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !b2.toBoolean()
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; b3.toBoolean()
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; b4.toBoolean()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why is this a bad idea? I mean, toInteger() et al. may not have been intended for the uses we have put it to, but it has become a standard approach for dealing with values that may be a string or an integer. That&apos;s why we&apos;d like the same behaviour for toBoolean().&lt;/p&gt;

&lt;p&gt;Hope that explains what we want better.&lt;/p&gt;

&lt;p&gt;Also I would argue that a boolean is a numeric type although it has a limited range &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14470258" author="blackdrag" created="Wed, 13 Oct 2010 12:07:34 +0000"  >&lt;p&gt;can you give a more real world example?&lt;/p&gt;</comment>
                            <comment id="14479356" author="marc@anyware.co.uk" created="Wed, 13 Oct 2010 14:47:42 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Validateable
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;InviteForm {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; email
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; approved
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestController {
    def inviteService

    def inviteUser = { InviteForm form -&amp;gt;
        inviteService.inviteUser(form)
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;InviteService = {
    def inviteUser(args) {
        def invite = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Invite()
        invite.email = args.email
        &lt;span class=&quot;code-comment&quot;&gt;// BOOM - we want args.approved to be anything - string or &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; etc
&lt;/span&gt;        invite.approved = args.approved.toBoolean()
        invite.save()
    }    
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above fails. It is a simplification of the real world problem I fixed in a grails plugin.&lt;/p&gt;

&lt;p&gt;The workaround involves something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;invite.approved = args.approved.toString().toBoolean() 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which is counterintuitive when you know it may be a boolean or string, and inefficient.&lt;/p&gt;</comment>
                            <comment id="14470276" author="blackdrag" created="Wed, 13 Oct 2010 17:59:55 +0000"  >&lt;p&gt;to understand the example... why is inviteUser called one time with a boolean and one time with a String? and why is it there ok to have a String like &quot;foo bar&quot; eval to... well I think it is false, and only strings like &quot;true&quot;, &quot;y&quot; or &quot;yes&quot; should eval to true? Doesn&apos;t that mean you will have to check the String befroe hand? Waht do you do if args.approved is a Integer?&lt;/p&gt;</comment>
                            <comment id="14479359" author="marc@anyware.co.uk" created="Thu, 14 Oct 2010 03:39:20 +0000"  >&lt;p&gt;This is a web app, and we are using &quot;duck typing&quot; in our APIs to make things as flexible as possible for users.&lt;/p&gt;

&lt;p&gt;So they may have a grails command object (statically typed properties) or it might be the &quot;params&quot; map with string values in. Or it might be a mock object.&lt;/p&gt;

&lt;p&gt;This is simply about making lenient &quot;do the right thing&quot; APIs.&lt;/p&gt;</comment>
                            <comment id="14479351" author="marc@anyware.co.uk" created="Thu, 14 Oct 2010 03:40:27 +0000"  >&lt;p&gt;Re: Integer. Wouldn&apos;t it be nice if toBoolean existed on Integer.&lt;/p&gt;

&lt;p&gt;Unfortunately you can&apos;t use customizable groovy truth (as Boolean) for this as of the unintended side effects of the implementation of String.asBoolean&lt;/p&gt;</comment>
                            <comment id="14470245" author="pledbrook" created="Thu, 14 Oct 2010 04:01:54 +0000"  >&lt;p&gt;A little more context. The &lt;tt&gt;InviteService&lt;/tt&gt; may be provided by a plugin. Users would have their own controllers that use that service and pass in an &lt;tt&gt;approved&lt;/tt&gt; value. In the above example, the user is using a command object, so &lt;tt&gt;approved&lt;/tt&gt; is a boolean. Another user might have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestController {
    def inviteService

    def inviteUser = {
        inviteService.inviteUser(params)
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;in which case the &lt;tt&gt;approved&lt;/tt&gt; value is a string (&apos;params&apos; does not type conversion).&lt;/p&gt;

&lt;p&gt;Another example is in tag libraries. Consider this tag:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;g:someTag absolute=&lt;span class=&quot;code-quote&quot;&gt;&quot;false&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The tag in this case will see the attribute &lt;tt&gt;absolute&lt;/tt&gt; with a string value, but if you change the tag to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;g:someTag absolute=&lt;span class=&quot;code-quote&quot;&gt;&quot;${isAbsolute}&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where &lt;tt&gt;isAbsolute&lt;/tt&gt; is a boolean value, then the tag will see the &lt;tt&gt;absolute&lt;/tt&gt; attribute as a boolean. Being able to treat the two identically in the tag code is a great boon and one of the advantages of Groovy over Java. If it worked as we would expect of course.&lt;/p&gt;</comment>
                            <comment id="14479365" author="marc@anyware.co.uk" created="Thu, 14 Oct 2010 04:10:30 +0000"  >&lt;p&gt;Furthermore, the ${isAbsolute} example is bang on - the value of that should be duck-typed. This is standard behaviour in grails tags, but is painful to achieve as you must do x.toString().toBoolean() (after you discover later that x.toBoolean() goes wrong). asBoolean in this case does not work.&lt;/p&gt;

&lt;p&gt;Jochen - I&apos;m starting to thing the root cause here is that customizable Groovy Truth has caused the problem by being implemented as a coercion to Boolean. This is not I think, in hindsight, correct - at least not in the traditional implementation of Groovy&apos;s String &amp;gt; boolean coercion methods.&lt;/p&gt;

&lt;p&gt;e.g. if Groovy Truth customization had been implemented like an operator instead of part of the &quot;asXXXX&quot; coercion mechanisms, this problem would not be happening because you could say to everyone &quot;toXXXXX is deprecated, use &apos;as Y&apos; from now on&quot;.&lt;/p&gt;

&lt;p&gt;Except we can&apos;t do this now because String.asBoolean() implements groovy truth, the world where &quot;false&quot; == true.&lt;/p&gt;

&lt;p&gt;Is it really too late to fix this? Can we be brave and fix (break) it in 2.0? Use Object.truthValue() or similar for groovy truth evaluation, and make asBoolean the same as Boolean.valueOf(String). ?&lt;/p&gt;</comment>
                            <comment id="14470315" author="blackdrag" created="Thu, 14 Oct 2010 09:25:28 +0000"  >&lt;p&gt;gee, this issue turned out to be more complicated than expected...&lt;/p&gt;

&lt;p&gt;What I got from the GSP example is that Grails GSP allow you not in a very good way to give primitives and keep their type. I would not have it implemented like this, but ok, that part is given. And I take it as a inconsistency in Grails that we are supposed to fix in Groovy-Core by adding workarounds. There would not have been any need for this discussion if both had been handled in the same way.. that is both as boolean or both as String.&lt;/p&gt;

&lt;p&gt;The argument with duck typing here is a bit strange to me. What for example prevents me to put in there any arbitrary class? Nothing. So it is normal that if you don&apos;t provide an object that supports the used API, that the code fails with a MissingMethodException. I don&apos;t see why this then automatically means to provide a toBoolean() method on Object. Because judging from your code, that is what you are requesting in the end. All I see is that the toBoolean() method on Boolean should not have been visible and none of this would have mattered. &lt;/p&gt;

&lt;p&gt;You seem to think that String#toBoolean() does handle only true and false... that is not right:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; toBoolean(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; self) {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; trimmed = self.trim();

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;.equalsIgnoreCase(trimmed) || &lt;span class=&quot;code-quote&quot;&gt;&quot;y&quot;&lt;/span&gt;.equalsIgnoreCase(trimmed) || &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;.equals(trimmed)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.TRUE;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.FALSE;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;code like this is what brings localization nightmares. &lt;/p&gt;

&lt;p&gt;And if I would go and change asBoolean to truthValue, then wouldn&apos;t you normally be one of the first complaining? The only reason I mentioned asBoolean and Groovy truth is, because I was back then not yet in the clear about what you actually want and that toBoolean and asBoolean are quite similar, with the tendency to take one for the other. Back then I thought you wanted to let that be Groovy truth, but now I know you really want something else. So let us put the name similarity issue beside.&lt;/p&gt;

&lt;p&gt;What you really want is a conversion function that works with different types and is specific to what is allowed in your app. Right?&lt;/p&gt;</comment>
                            <comment id="14479362" author="marc@anyware.co.uk" created="Thu, 14 Oct 2010 09:44:07 +0000"  >&lt;p&gt;There is no inconsistency in Grails.&lt;/p&gt;

&lt;p&gt;Attributes are passed to tags as specified by the user. String literals are usually passed with x=&quot;y&quot; notation, which makes perfect sense. Users can also pass specific data values in using the GSP EL which evaluates native groovy expressions and returns their values. Hence x=&quot;${true}&quot;.&lt;/p&gt;

&lt;p&gt;Coercing x=&quot;true&quot; automatically to x=&quot;${true}&quot; would be bad (and probably cause issues with JSP compatibility) and x=&quot;${&apos;something&apos;}&quot; to pass any string literals would be extremely annoying.&lt;/p&gt;

&lt;p&gt;This is about philosophy. The Grails (and I assume, perhaps wrongly, Groovy) way is to make things as easy as possible for the user. Assume as little as possible, &quot;do the right thing&quot; as much as possible. Funnily enough this has turned out very popular with developers.&lt;/p&gt;

&lt;p&gt;I would not have complained about truthValue(), especially if asBoolean worked i.e. &quot;false&quot;.asBoolean() == false. It isn&apos;t. For most people, this is intuitively broken, seeing as the other asXXXX coercions are (off the top of my head) much more literal and not &quot;fudged&quot; like groovy truth is for String (which is a good thing - just not in asBoolean).&lt;/p&gt;

&lt;p&gt;Please can this get some high level discussion in the whole groovy team?&lt;/p&gt;

</comment>
                            <comment id="14470278" author="guillaume" created="Thu, 14 Oct 2010 09:56:34 +0000"  >&lt;p&gt;We&apos;ll go with Boolean#toBoolean() and be done with this issue.&lt;br/&gt;
We&apos;ve got no intention to do any breaking change in Groovy Truth as of now.&lt;br/&gt;
With this new method, b.toBoolean() will return true for b being &quot;true&quot; or Boolean.TRUE, so &quot;duck typing&quot; is preserved.&lt;/p&gt;</comment>
                            <comment id="14470260" author="graemerocher" created="Thu, 14 Oct 2010 10:01:07 +0000"  >&lt;p&gt;Jochen I&apos;m not sure something so simple has evolved into such a complicated discussion. Groovy is a dynamic language that is supposed to support duck typing and be intuitive.&lt;/p&gt;

&lt;p&gt;The fact that &quot;true&quot;.toBoolean() and true.toBoolean() return different values is a bug to me and it has nothing to do with Grails. The fact that Groovy is under the covers calling into a static method toBoolean(null) is even more of a bug. I am unsure as to why we are even debating this.&lt;/p&gt;</comment>
                            <comment id="14470231" author="blackdrag" created="Thu, 14 Oct 2010 10:43:29 +0000"  >&lt;p&gt;That Boolean#toBoolean(null) is called is something I wanted to fix even before the 1.0 release, but I got no majority for this. So in fact it is no bug, it is an unlucky feature, back then with the argument that SwingBuilder needs that. I did see it as evil doing. Funny thing is, I was also for not allowing static methods being called using an instance. I see that of a thing broken in Java and having that in Groovy is a bug for me too. But again no majority here. Any of those two would have prevented Boolean#toBoolean() being a successful call. That the method is private and that we want to fix that in Groovy 2 is well known I think. From my view the fact this method is callable is then based on 3 bugs. Fixing one of them would have nullified this issue, because then a MissingMethodException had been thrown. Then there would have been indeed no discussion.&lt;/p&gt;

&lt;p&gt;I wonder what code then would have been produced.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bzhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>