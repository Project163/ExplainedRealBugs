<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:27:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11522] Possible Null Pointer Dereference in VariableScopeVisitor.java</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11522</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;h1&gt;&lt;a name=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h1&gt;

&lt;p&gt;In file:&#160;&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/classgen/VariableScopeVisitor.java#L649&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;b&gt;VariableScopeVisitor.java&lt;/b&gt;&lt;/a&gt;, there is a potential case of null pointer dereference. In method&#160;&lt;tt&gt;&lt;b&gt;visitFieldExpression&lt;/b&gt;&lt;/tt&gt;&#160;inside class&#160;&lt;tt&gt;&lt;b&gt;VariableScopeVisitor&lt;/b&gt;&lt;/tt&gt;, there is a call to&#160;&lt;tt&gt;&lt;b&gt;checkVariableContextAccess&lt;/b&gt;&lt;/tt&gt;&#160;which passes&#160;&lt;tt&gt;&lt;b&gt;variable&lt;/b&gt;&lt;/tt&gt;&#160;as a parameter and the&#160;&lt;tt&gt;&lt;b&gt;variable&lt;/b&gt;&lt;/tt&gt;&#160;object comes from&#160;&lt;tt&gt;&lt;b&gt;findVariableDeclaration(name)&lt;/b&gt;&lt;/tt&gt;, likely locating the variable using its name.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void visitFieldExpression(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FieldExpression expression) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = expression.getFieldName();
        &lt;span class=&quot;code-comment&quot;&gt;//TODO: change that to get the correct scope
&lt;/span&gt;        Variable variable = findVariableDeclaration(name);
        checkVariableContextAccess(variable, expression);
    }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Inside&#160;&lt;b&gt;checkVariableContextAccess&lt;/b&gt;&#160;method&#160;&lt;b&gt;variable&lt;/b&gt;&#160;is immediately referenced in the call&#160;&lt;b&gt;variable.isInStaticContext()&lt;/b&gt;&#160;without any kind of null-checking.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void checkVariableContextAccess(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Variable variable, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression expression) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (variable.isInStaticContext()) {
            ...
        }
    } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But&#160;&lt;b&gt;findVariableDeclaration&lt;/b&gt;&#160;returns null in cases where&#160;&lt;b&gt;name&lt;/b&gt;&#160;equals&#160;super&#160;or&#160;this. In these cases&#160;&lt;b&gt;variable.isInStaticContext()&lt;/b&gt;&#160;will cause &lt;b&gt;NullPointerException&lt;/b&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Variable findVariableDeclaration(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {        
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;&quot;&lt;/span&gt;.equals(name) || &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;&quot;&lt;/span&gt;.equals(name)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;    
         ...                   
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Additionally there are two instances (&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/classgen/VariableScopeVisitor.java#L662&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;first&lt;/a&gt;, &#160;&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/codehaus/groovy/classgen/VariableScopeVisitor.java#L691&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;second&lt;/a&gt;) of invoking &lt;font color=&quot;#172b4d&quot;&gt;&lt;tt&gt;&lt;b&gt;findVariableDeclaration&lt;/b&gt;&lt;/tt&gt;&lt;/font&gt; in the same file where the returned &lt;b&gt;Variable&lt;/b&gt; object is checked for null value.&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;SponsorshipandSupport&quot;&gt;&lt;/a&gt;Sponsorship and Support&lt;/h3&gt;

&lt;p&gt;This work is done by the security researchers from OpenRefactory and is supported by the&#160;&lt;a href=&quot;https://openssf.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Open Source Security Foundation (OpenSSF)&lt;/a&gt;:&#160;&lt;a href=&quot;https://alpha-omega.dev/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Project Alpha-Omega&lt;/a&gt;. Alpha-Omega is a project partnering with open source software project maintainers to systematically find new, as-yet-undiscovered vulnerabilities in open source code - and get them fixed - to improve global software supply chain security.&lt;/p&gt;

&lt;p&gt;The bug is found by running the iCR tool by&#160;&lt;a href=&quot;https://openrefactory.com/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;OpenRefactory, Inc.&lt;/a&gt;&#160;and then manually triaging the results.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13598888">GROOVY-11522</key>
            <summary>Possible Null Pointer Dereference in VariableScopeVisitor.java</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="zaki023">Zaki</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Nov 2024 09:05:24 +0000</created>
                <updated>Tue, 15 Jul 2025 17:42:18 +0000</updated>
                            <resolved>Tue, 15 Jul 2025 17:39:30 +0000</resolved>
                                                    <fixVersion>4.0.28</fixVersion>
                    <fixVersion>5.0.0-beta-2</fixVersion>
                    <fixVersion>3.0.26</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17898566" author="paulk" created="Fri, 15 Nov 2024 10:24:44 +0000"  >&lt;p&gt;Thanks Zaki, that is an interesting case. The Groovy grammar doesn&apos;t let you input programs where field names are &quot;super&quot; or &quot;this&quot;, so I don&apos;t believe normal developers using Groovy could ever trigger that NPE.&lt;/p&gt;

&lt;p&gt;Groovy does allow folks to write AST transforms, and while adding a field programmatically called &quot;this&quot; or &quot;super&quot; would be considered dangerous, we might want to add an additional guard for that case - or we could disallow such additions. Here is a test script showing that scenario:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.*
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.expr.FieldExpression
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.control.SourceUnit
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.classgen.VariableScopeVisitor
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; static groovyjarjarasm.asm.Opcodes.ACC_PUBLIC

&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; myClass = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassNode(&lt;span class=&quot;code-quote&quot;&gt;&quot;MyClass&quot;&lt;/span&gt;, ACC_PUBLIC, ClassHelper.OBJECT_TYPE)
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; myField = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FieldNode(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;&quot;&lt;/span&gt;, ACC_PUBLIC, ClassHelper.OBJECT_TYPE, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
myClass.addField(myField)
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; su = SourceUnit.create(&lt;span class=&quot;code-quote&quot;&gt;&apos;dummy&apos;&lt;/span&gt;, &apos;&apos;)
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; vsv = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; VariableScopeVisitor(su)
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; fieldX = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FieldExpression(myField)
vsv.visitFieldExpression(fieldX)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NullPointerException
    at org.codehaus.groovy.classgen.VariableScopeVisitor.checkVariableContextAccess(VariableScopeVisitor.java:336)
    at org.codehaus.groovy.classgen.VariableScopeVisitor.visitFieldExpression(VariableScopeVisitor.java:560)
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I wouldn&apos;t regard it as high priority given that it isn&apos;t something we&apos;d ever expect in real-life scenarios - but probably worth addressing in any case.&lt;/p&gt;</comment>
                            <comment id="17898579" author="JIRAUSER307605" created="Fri, 15 Nov 2024 11:08:25 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt; for your response and test script.&lt;/p&gt;

&lt;p&gt;I assumed this probably wouldn&apos;t happen in normal use cases so I set the priority to minor. Nevertheless I wanted to bring it into your attention and let you decide if it is something you would want to fix.&lt;/p&gt;</comment>
                            <comment id="18007301" author="emilles" created="Tue, 15 Jul 2025 17:39:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/e7b7fc70b08147e5f4973b0be5d16024761774fa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/e7b7fc70b08147e5f4973b0be5d16024761774fa&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sktk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>