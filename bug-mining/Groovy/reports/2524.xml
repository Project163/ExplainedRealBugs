<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:39:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5360] XmlParser and XmlSlurper strip whitespace text by default</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5360</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Currently both XmlParser and XmlSlurper elide text that is only whitespace. Surely it is for the application and not the parser to determine what to do with whitespace that is not inside an opening or closing tag. Both classes allow for changing the behaviour programatically. I argue that the current default in not consistent with generally expected behaviour and so should be changed. Clearly this is a breaking change and so should not happen in the 1.8.x series. The 2.0.x series should take the opportunity to make this change. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12816090">GROOVY-5360</key>
            <summary>XmlParser and XmlSlurper strip whitespace text by default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="russel">Dr. Russel Winder</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Mar 2012 12:12:32 +0000</created>
                <updated>Mon, 27 Jan 2020 09:57:12 +0000</updated>
                            <resolved>Mon, 27 Jan 2020 09:57:12 +0000</resolved>
                                    <version>2.0-beta-2</version>
                                                    <component>XML Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14472546" author="russel" created="Fri, 23 Mar 2012 12:48:52 +0000"  >&lt;p&gt;XmlParser uses the property trimWhitespace with (wrong) default true, and XmlSlurper uses the property keepWhitespace with the (wrong) default false.  Should have a consistent API.&lt;/p&gt;</comment>
                            <comment id="14479921" author="paulk" created="Tue, 3 Apr 2012 20:21:07 +0000"  >&lt;p&gt;For me, I am less concerned about the &quot;ignorable whitespace&quot; trimming - that is a concept that appears within many XML apis with differing default behaviour - so long as it is clearly documented. What I think definitely needs changing is that element text is trimmed by &lt;tt&gt;XmlParser&lt;/tt&gt; as part of trimming &quot;ignorable whitespace&quot;. I think this is broken as a default, i.e. &lt;tt&gt;&amp;lt;root&amp;gt; X &amp;lt;/root&amp;gt;&lt;/tt&gt; will return &quot;X&quot; as the element text not &quot; X &quot;. Actually, I had better give some more examples to explain ... coming shortly ...&lt;/p&gt;</comment>
                            <comment id="14479876" author="paulk" created="Wed, 4 Apr 2012 01:33:22 +0000"  >&lt;p&gt;Some examples for discussion are shown below - I am only discussing &lt;tt&gt;XmlParser&lt;/tt&gt; to start with. All the examples use this parser:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser()

&lt;span class=&quot;code-comment&quot;&gt;// utility method to make it easier to see special whitespace chars
&lt;/span&gt;def encode(s) { s.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&apos; &apos;&lt;/span&gt;, /_/).replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&apos;\n&apos;&lt;/span&gt;, /\\n/).replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&apos;\r&apos;&lt;/span&gt;, /\\r/).replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&apos;\t&apos;&lt;/span&gt;, /\\t/) }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I should also note that I am using a locally modified version of &lt;tt&gt;XmlParser&lt;/tt&gt; which fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5119&quot; title=&quot;Node.depthFirst() &amp;#39;forgets&amp;#39; text nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5119&quot;&gt;&lt;del&gt;GROOVY-5119&lt;/del&gt;&lt;/a&gt; among other things that I haven&apos;t committed yet - but I am wanting to discuss what I think the expected behaviour should be and current limitations. The first example is here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def xml1 = &apos;&apos;&apos;\
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; standalone=&lt;span class=&quot;code-quote&quot;&gt;&quot;yes&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;!DOCTYPE books [
    &amp;lt;!ELEMENT books (book)*&amp;gt;
    &amp;lt;!ELEMENT book (name, author, comment)&amp;gt;
    &amp;lt;!ELEMENT name (#PCDATA)&amp;gt;
    &amp;lt;!ELEMENT author (#PCDATA)&amp;gt;
    &amp;lt;!ELEMENT comment (#PCDATA)&amp;gt;
]&amp;gt;
&amp;lt;books&amp;gt;
    &amp;lt;book&amp;gt;
        &amp;lt;name&amp;gt;Groovy in Action&amp;lt;/name&amp;gt;
        &amp;lt;author&amp;gt;
            Dierk et al
        &amp;lt;/author&amp;gt;
        &amp;lt;comment&amp;gt; &amp;lt;/comment&amp;gt;
    &amp;lt;/book&amp;gt;
&amp;lt;/books&amp;gt;
&apos;&apos;&apos;
def result1 = [:].withDefault{&apos;&apos;}
[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;].each { trim -&amp;gt;
    parser.trimWhitespace = trim
    def books = parser.parseText(xml1)
    books.each { book -&amp;gt;
        book.each {
            result1[trim] += it &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Node ? &lt;span class=&quot;code-quote&quot;&gt;&quot;[${it.name()}:${encode(it.text())}]&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;(&apos;&lt;/span&gt; + encode(it) + &lt;span class=&quot;code-quote&quot;&gt;&apos;)&apos;&lt;/span&gt;
        }
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result1 == [
        (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;): /[name:Groovy_in_Action][author:Dierk_et_al][comment:]/,
        (&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;):/[name:Groovy_in_Action][author:\n____________Dierk_et_al\n________][comment:_]/
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Because we are using a DTD, the underlying Java parser has removed ignorable white space for us. I think most people would want the result obtained with trimWhitespace false (i.e. the opposite of what the default is). However, some people might actually want to preserve the whitespace found in the original documents and currently we don&apos;t support this. We could change the behaviour of XmlParser to retain the ignorable whitespace - there is a currently empty &lt;tt&gt;ignorableWhitespace(...)&lt;/tt&gt; method that we could use. The question then remains do we just drop the &quot;autoTrimming&quot; (i.e. current default) behaviour or have a flag to allow that too?&lt;/p&gt;

&lt;p&gt;The next example doesn&apos;t have a DTD. The underlying parser doesn&apos;t attempt to work out ignorable whitespace - it assumes that any part of the document may contain mixed content, so in theory nothing is ignorable. The results are:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def xml2 = &apos;&apos;&apos;\
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; ?&amp;gt;
&amp;lt;books&amp;gt;
    &amp;lt;book&amp;gt;
        &amp;lt;name&amp;gt;Groovy in Action&amp;lt;/name&amp;gt;
        &amp;lt;author&amp;gt;
            Dierk et al
        &amp;lt;/author&amp;gt;
        &amp;lt;comment&amp;gt; &amp;lt;/comment&amp;gt;
    &amp;lt;/book&amp;gt;
&amp;lt;/books&amp;gt;
&apos;&apos;&apos;
def result2 = [:].withDefault{&apos;&apos;}
[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;].each { trim -&amp;gt;
    parser.trimWhitespace = trim
    def books = parser.parseText(xml2)
    books.each { book -&amp;gt;
        book.each {
            result2[trim] +=  it &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Node ? &lt;span class=&quot;code-quote&quot;&gt;&quot;[${it.name()}:${encode(it.text())}]&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;(&apos;&lt;/span&gt; + encode(it) + &lt;span class=&quot;code-quote&quot;&gt;&apos;)&apos;&lt;/span&gt;
        }
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result2 == [
        (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;): /[name:Groovy_in_Action][author:Dierk_et_al][comment:]/,
        (&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;):/(\n)(_)(_)(_)(_)(\n________)[name:Groovy_in_Action](\n________)[author:\n____________Dierk_et_al\n________](\n________)[comment:_](\n____)(\n)/
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With trimming set to &quot;true&quot;, the result we get is not unreasonable but we can see that the single space &quot;comment&quot; element has lost information, i.e. the single character. With trimming set to false we now get all of the text nodes containing whitespace. We get the &quot;space&quot; back for the &quot;comment&quot; element but now have a whole bunch of annoying text nodes that we have to &quot;step over&quot; while processing. I suspect most people would prefer to have the &quot;false&quot; result for example 1 with the ability to get the extra text nodes in special circumstances. This would be the very breaking part of a change here. People would expect &quot;book.children().size() == 3&quot; not &quot;13&quot;. So do we try to mimic what the underlying XML would do if it did have a DTD?&lt;/p&gt;

&lt;p&gt;The final example is a mixed content example for completeness and which might be relevant for future discussions but I won&apos;t say any more about it just yet.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def xml3 = &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;p&amp;gt;&amp;lt;b&amp;gt;Groovy in Action&amp;lt;/b&amp;gt; by &amp;lt;em&amp;gt;Dierk et al&amp;lt;/em&amp;gt;&amp;lt;/p&amp;gt;&apos;&lt;/span&gt;
def result3 = [:].withDefault{&apos;&apos;}
[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;].each { trim -&amp;gt;
    parser.trimWhitespace = trim
    def p = parser.parseText(xml3)
    p.each {
        result3[trim] += it &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Node ? &lt;span class=&quot;code-quote&quot;&gt;&quot;[${it.name()}:${encode(it.text())}]&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;(&apos;&lt;/span&gt; + encode(it) + &lt;span class=&quot;code-quote&quot;&gt;&apos;)&apos;&lt;/span&gt;
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result3 == [
        (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;): /[b:Groovy_in_Action](by)[em:Dierk_et_al]/,
        (&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;):/[b:Groovy_in_Action](_by_)[em:Dierk_et_al]/
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14480444" author="paulk" created="Tue, 8 Apr 2014 03:53:21 +0000"  >&lt;p&gt;There is now a trimIgnorableWhitespace as well as a trimWhitespace setting for XmlParser (see  &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6678&quot; title=&quot;XmlParser should provide a trimIgnorableWhitespace setting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6678&quot;&gt;&lt;del&gt;GROOVY-6678&lt;/del&gt;&lt;/a&gt;). Both retain the current settings of true but if we changed the default for trimWhitespace to false, we would get the same behavior as for XmlSlurper. This would preserve any whitespace within nodes, i.e. in mixed content or whitespace in a text node value while &quot;skipping over&quot; whitespace between nodes. The fully preserving behavior can be obtained using the trimIgnorableWhitespace flag.&lt;/p&gt;

&lt;p&gt;The window for getting this in 2.3 is closing if not already closed but I&apos;ll just mention it here in case there are super strong feelings that we must get this in 2.3. The downside is that lots of existing test cases break as we have hard-coded expectations based around the current trimming.&lt;/p&gt;

&lt;p&gt;I&apos;ll also note that DOMCategory also has trimming with what I think is the wrong default setting (and it currently has no way to flip the flag - it&apos;s a private flag which Groovy tricks can be used to tweak which is kind of ugly).&lt;/p&gt;</comment>
                            <comment id="14475696" author="pschumacher" created="Tue, 8 Apr 2014 05:31:55 +0000"  >&lt;p&gt;I would welcome a change of the default behavior.&lt;/p&gt;</comment>
                            <comment id="14480440" author="paulk" created="Wed, 9 Apr 2014 03:09:39 +0000"  >&lt;p&gt;I created a pull request that changes the default behavior of XmlParser wrt whitespace trimming within nodes. No changes wrt ignorable whitespace are covered by this PR. Also, for now, for a handful of tests use the trimWhitespace setting of XmlParser to reset the default behavior back to existing behavior. Over time we can alter the expectations and remove the use of that setting in those tests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/groovy/groovy-core/pull/375&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/375&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14480452" author="paulk" created="Wed, 9 Apr 2014 04:10:22 +0000"  >&lt;p&gt;OK, I have made a new issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6683&quot; title=&quot;XmlParser trims text by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6683&quot;&gt;&lt;del&gt;GROOVY-6683&lt;/del&gt;&lt;/a&gt;) for the text trimming behavior I discussed above and will leave this existing issue to address Russel&apos;s original concern about whitespace only as I kind of hijacked the issue with some of my comments above.&lt;/p&gt;</comment>
                            <comment id="14480473" author="paulk" created="Wed, 9 Apr 2014 04:54:50 +0000"  >&lt;p&gt;Russel, see also &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6685&quot; title=&quot;Align naming for XmlParser/XmlSlurper/DOMCategory whitespace handling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6685&quot;&gt;&lt;del&gt;GROOVY-6685&lt;/del&gt;&lt;/a&gt;. So, the API is now consistent (with appropriate aliases to avoid breaking backwards compatibility at the API level). So the remaining thing wrt this issue is I believe the actual default value of the &lt;tt&gt;keepIgnorableWhitespace&lt;/tt&gt; property. If there is too much noise with all my comments above, feel free to close this one and create a fresh one.&lt;/p&gt;</comment>
                            <comment id="17024203" author="paulk" created="Mon, 27 Jan 2020 09:57:12 +0000"  >&lt;p&gt;I propose not changing this default for the current XmlParser and XmlSlurper. We plan to look into merging those for 4.0 and we can look at the appropriate default for trimming whitespace at that time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2csyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>