<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:11:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3389] Field Hiding Behavior Regression</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3389</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Member hiding behavior has changed between 1.5.7 and 1.6 . Previous code which caused member hiding now does not.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bar
   
    void doIt() {
        def bar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;)
       
        println bar &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; File    &lt;span class=&quot;code-comment&quot;&gt;// prints &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; (1.6), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; (1.5.7)
&lt;/span&gt;        println bar &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// prints &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; (1.6), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; (1.5.7)
&lt;/span&gt;    }
}

def foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo()
foo.doIt()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Roshan:&lt;/p&gt;

&lt;p&gt;&quot;&quot;&quot;&lt;br/&gt;
Looks like a bug to me because&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bar
    void doIt(File bar) {
        println bar &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; File &lt;span class=&quot;code-comment&quot;&gt;// returns &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;    }
}

def foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo()
foo.doIt(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And it should be consistent in hiding behavior whethere it is a method parameter that is doing the hiding or a local, method-level variable.&lt;br/&gt;
&quot;&quot;&quot;&lt;/p&gt;

&lt;p&gt;Jochen:&lt;/p&gt;

&lt;p&gt;&quot;&quot;&quot;&lt;br/&gt;
that is clearly a bug that crept in unnoticed. Please fill an issue for it, this absolutely needs to be fixed for the next release&lt;br/&gt;
&quot;&quot;&quot;&lt;/p&gt;</description>
                <environment>Discovered running on Windows XP, JDK 1.6.0_07</environment>
        <key id="12814596">GROOVY-3389</key>
            <summary>Field Hiding Behavior Regression</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="gyrm">Haw-Bin Chai</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Mar 2009 09:37:47 +0000</created>
                <updated>Tue, 7 Apr 2009 23:33:16 +0000</updated>
                            <resolved>Tue, 3 Mar 2009 22:11:44 +0000</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.6.1</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14466660" author="roshandawrani" created="Mon, 2 Mar 2009 14:15:28 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
    I looked into it and there does not seem to be any problem in any transformation before ACG gets called.&lt;/p&gt;

&lt;p&gt;The following code highlights the issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bar
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args) {
        def bar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;)
        println bar.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;name &lt;span class=&quot;code-comment&quot;&gt;// prints java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
&lt;/span&gt;    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The line of interest is &quot;def bar = new File(&apos;.&apos;)&quot;. In the class file this declaration gets rendered as&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; bar = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)ScriptBytecodeAdapter.castToType(arrayOfCallSite[0].callConstructor($get$$&lt;span class=&quot;code-keyword&quot;&gt;class$&lt;/span&gt;java$io$File(), &lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt;), $get$$&lt;span class=&quot;code-keyword&quot;&gt;class$&lt;/span&gt;java$lang$&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, the file object gets casted(converted) to String and hence, effectively, what gets assigned to variable &quot;bar&quot; is new File(&apos;.&apos;).toString() and not new File(&apos;.&apos;). And that is why &apos;bar instanceof File&apos; check returns false in the given example.&lt;/p&gt;

&lt;p&gt;The problem is originating at ACG.evaluateEqual(), which, for DeclarationExpression, first does the RHS (including the casting) and then does the LHS (defining the variable on the compileStack). So, when it is doing the RHS and casting stuff, the local variable is not in the compileStack and what is visible to it is class field bar and it picks up its type and does the casting by mistake. That piece of code has to be re-arranged so that it first adds the local variable on the compileStack so that at casting time, it picks up the type of correct variable.&lt;/p&gt;

&lt;p&gt;I will try working on a patch, but so far I have gotten only this far.&lt;/p&gt;

&lt;p&gt;Hope it helps.&lt;br/&gt;
Roshan&lt;/p&gt;
</comment>
                            <comment id="14466569" author="roshandawrani" created="Mon, 2 Mar 2009 15:18:04 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I am attaching the patch that is fixing this issue and didn&apos;t break any existing tests.&lt;/p&gt;

&lt;p&gt;Please let me know if I can apply it.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14466552" author="blackdrag" created="Mon, 2 Mar 2009 15:32:57 +0000"  >&lt;p&gt;the patch looks good to me... but of course a test case is missing! And we should test if the issue is present on 1.5.x as well&lt;/p&gt;</comment>
                            <comment id="14466644" author="roshandawrani" created="Tue, 3 Mar 2009 22:11:44 +0000"  >&lt;p&gt;Fixed on 1.6.1 and 1.7-beta-1. The issue was not found on 1.5.x.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722099" name="3389_v16x.txt" size="945" author="roshandawrani" created="Mon, 2 Mar 2009 15:18:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cq7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>