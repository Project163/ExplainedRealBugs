<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:55:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-363] lineNumber table has all 0 instead of correct offsets</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-363</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;LineNumber table in generated class file has all line offsets to 0.&lt;br/&gt;
Which makes groovy classes imposible to use in any debugger.&lt;/p&gt;

&lt;p&gt;Looking on ClassGenerator.java I see following method&lt;/p&gt;

&lt;p&gt;    protected void onLineNumber(ASTNode statement) {&lt;br/&gt;
        int number = statement.getLineNumber();&lt;br/&gt;
        if (number &amp;gt;= 0 &amp;amp;&amp;amp; cv != null) &lt;/p&gt;
{
            cv.visitLineNumber(number, new Label());
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;it creates a Label but this label remains unresolved.&lt;br/&gt;
I think it was intended to be something like this&lt;/p&gt;


&lt;p&gt;    protected void onLineNumber(ASTNode statement) {&lt;br/&gt;
        int number = statement.getLineNumber();&lt;br/&gt;
        if (number &amp;gt;= 0 &amp;amp;&amp;amp; cv != null) &lt;/p&gt;
{
            Label l = new Label();
            cv.visitLabel(l);
            cv.visitLineNumber(number, l);
        }
&lt;p&gt;    }&lt;/p&gt;


&lt;p&gt;could you please put it in the CVS.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12812494">GROOVY-363</key>
            <summary>lineNumber table has all 0 instead of correct offsets</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jstrachan">James Strachan</assignee>
                                    <reporter username="blib">Boris Bliznioukov</reporter>
                        <labels>
                    </labels>
                <created>Sun, 4 Apr 2004 19:33:21 +0000</created>
                <updated>Thu, 16 Dec 2004 16:56:58 +0000</updated>
                            <resolved>Thu, 16 Dec 2004 16:56:58 +0000</resolved>
                                    <version>1.0-beta-5</version>
                                    <fixVersion>1.0-beta-8</fixVersion>
                                    <component>class generator</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="300">5m</timeoriginalestimate>
                            <timeestimate seconds="300">5m</timeestimate>
                                        <comments>
                            <comment id="14460082" author="zohar" created="Wed, 7 Apr 2004 06:50:40 +0000"  >&lt;p&gt;Boris, thanks again , I&apos;ll have a look.&lt;/p&gt;</comment>
                            <comment id="14460112" author="blib" created="Sun, 11 Apr 2004 17:50:26 +0000"  >&lt;p&gt;It looks like there is also another related problem.&lt;/p&gt;

&lt;p&gt;Class generator does not generate linumber table information for the last line of any method. So any method that have jusr one line does not produce any linenumber entries at all. For example:&lt;/p&gt;

&lt;p&gt;class a {&lt;br/&gt;
    test() &lt;/p&gt;
{
        println &quot;aaa&quot;
    }
&lt;p&gt;    other() &lt;/p&gt;
{
        test()
    }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;does not produce any linenumber table in the resulting class.&lt;br/&gt;
If method have 2 lines you see just one entry in linenumber table, instead of 2 entries.&lt;/p&gt;

&lt;p&gt;Also it would be great if we could generate line number entry for closing } of the method.&lt;/p&gt;</comment>
                            <comment id="14460161" author="zohar" created="Wed, 14 Apr 2004 20:10:02 +0000"  >&lt;p&gt;James , can you have a look at this pls.&lt;/p&gt;</comment>
                            <comment id="14460225" author="jstrachan" created="Wed, 14 Apr 2004 22:17:20 +0000"  >&lt;p&gt;Zohar - aha you&apos;ve applied Boris&apos;s patch to CVS - I was just about to do that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So for 1 line statements, do we need to visit 2 labels? e.g.&lt;/p&gt;

&lt;p&gt;1&amp;gt; foo() &lt;/p&gt;
{ 
2&amp;gt;   println &quot;hey&quot;
3&amp;gt; }

&lt;p&gt;we&apos;d need to do the pseudo code of&lt;/p&gt;

&lt;p&gt;visitLine(2)&lt;br/&gt;
println &quot;hey&quot;&lt;br/&gt;
visitLine(3)&lt;/p&gt;

&lt;p&gt;?&lt;/p&gt;

&lt;p&gt;If so we need some way to add the line info for } to the AST somehow as we don&apos;t have it yet. Unless we cheat for now and just add.&lt;/p&gt;

&lt;p&gt;visitLine(lastStatementLine + 1)&lt;/p&gt;

&lt;p&gt;at the end of visitMethod() in ClassGen?&lt;/p&gt;</comment>
                            <comment id="14460179" author="blib" created="Thu, 15 Apr 2004 03:47:43 +0000"  >&lt;p&gt;yes, the pseudo code is right.&lt;br/&gt;
as for cheating &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; closing } CAN be on the same line as last statement...&lt;/p&gt;

&lt;p&gt;foo () &lt;/p&gt;
{ println &quot;ho&quot; }

&lt;p&gt;So I don&apos;t know if its a such a good idea.&lt;/p&gt;</comment>
                            <comment id="14460008" author="jstrachan" created="Fri, 16 Apr 2004 02:10:18 +0000"  >&lt;p&gt;OK so how about as a quick hack we use the same line as the last statement for } for now - which is a pretty easy fix, then we fix the AST to know the line number of the }&lt;/p&gt;</comment>
                            <comment id="14460256" author="blib" created="Mon, 19 Apr 2004 10:07:22 +0000"  >&lt;p&gt;I had a quick look at ASTNode and indeed it only stores start position. It is a very well demonstrated by code in SyntaxException &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return the end column on which the error occurs&lt;br/&gt;
     */&lt;br/&gt;
    public int getEndColumn() 
{
        return getStartColumn() + 1;
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I guess at the end of the game ASTNode should also have end position of the element, but I understand it might be quite a big change for the parser. And I can&apos;t think of any benefit except this bug for the moment.&lt;/p&gt;

&lt;p&gt;So let it be ... or may be you can ask Chris Poirier about that. I don&apos;t know what is the priority on that issue, so it&apos;s your call James.&lt;/p&gt;</comment>
                            <comment id="14460749" author="blackdrag" created="Thu, 16 Dec 2004 16:56:58 +0000"  >&lt;p&gt;already in CVS&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ckyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>