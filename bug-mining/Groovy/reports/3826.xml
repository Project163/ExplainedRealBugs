<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:07:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9554] @Field variable access within closures broken</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9554</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@groovy.transform.Field &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; abc
binding.variables.clear()
abc = &lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt;
println binding.hasVariable(&lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt;)
[&lt;span class=&quot;code-quote&quot;&gt;&quot;D&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;E&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;F&quot;&lt;/span&gt;].each { abc += it }
println binding.getVariable(&lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; abc == &lt;span class=&quot;code-quote&quot;&gt;&quot;abcDEF&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If a variable is declared using the @Field annotation, it can be assigned to in the main script body, but any assignment inside a closure (here the closure used with each) ends up in the script binding instead. Assignments within regular methods work fine, too. If the variables is accessed inside the closure and it is not in the binding, then the value will come from the field. As soon as it is in the binding, the binding variable takes precedence over the field. In both cases the field declared with @Field needs to have precedence over anything that is in the binding, just like local variables do.&lt;/p&gt;

&lt;p&gt; &#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13305178">GROOVY-9554</key>
            <summary>@Field variable access within closures broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="eddelplus">Jochen Eddelbuettel</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 May 2020 11:18:33 +0000</created>
                <updated>Thu, 23 Jul 2020 14:16:10 +0000</updated>
                            <resolved>Tue, 23 Jun 2020 11:33:07 +0000</resolved>
                                    <version>2.4.15</version>
                    <version>3.0.3</version>
                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                    <fixVersion>3.0.5</fixVersion>
                    <fixVersion>2.5.13</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17109436" author="eddelplus" created="Sun, 17 May 2020 11:25:54 +0000"  >&lt;p&gt;I guess this [blog post|&lt;a href=&quot;https://e.printstacktrace.blog/groovy-script-closure-does-not-modify-field-annotated-variable/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://e.printstacktrace.blog/groovy-script-closure-does-not-modify-field-annotated-variable/&lt;/a&gt;] kind of explains that I&apos;m looking at a bug that is deemed a feature, right?&lt;/p&gt;

&lt;p&gt;If @Field could generate a getter and a setter, that would allow forcing accesss to the field. An explicit call to the getter or setter would prevent the shadowing by the binding, which is the approach I&apos;ve taken to make sure I&apos;m reaching my @BaseScript defined properties.&lt;/p&gt;

&lt;p&gt;How is that for a future improvement? It could even be a separate AST Annotation, e.g. @PropertyField or @BeanField.&lt;/p&gt;</comment>
                            <comment id="17125272" author="emilles" created="Wed, 3 Jun 2020 19:57:35 +0000"  >&lt;p&gt;&lt;tt&gt;groovy.lang.Script#setProperty&lt;/tt&gt; could check for a field before adding a property to the binding.&#160; You could experiment with this in your script by overriding &lt;tt&gt;setProperty(String,Object)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17135266" author="emilles" created="Sun, 14 Jun 2020 18:51:51 +0000"  >&lt;p&gt;A bit of info that may help you right away: &lt;tt&gt;@Field&lt;/tt&gt; does generate a public setter for non-final fields.  So you can call &quot;setAbc(...)&quot; within your closure.  You could also use &quot;this.@abc&quot; in your closure to target the &quot;attribute&quot;, which often resolves to a field.&lt;/p&gt;

&lt;p&gt;Also, if the PR is accepted and you want to bypass a script field and read or write from binding, you can add the &quot;binding.&quot; qualifier to any variable.&lt;/p&gt;</comment>
                            <comment id="17141053" author="eddelplus" created="Sat, 20 Jun 2020 11:58:08 +0000"  >&lt;p&gt;Wow, Eric, that pull request looks like your taking this bull by the horns. I&apos;ll keep watching how this evolves and be playing with your other advice for the time being.&lt;/p&gt;</comment>
                            <comment id="17142855" author="paulk" created="Tue, 23 Jun 2020 11:33:07 +0000"  >&lt;p&gt;Proposed PR merged. Thanks everyone!&lt;/p&gt;

&lt;p&gt;At the moment, for 2.4.x you need to rely on the workarounds Eric mentioned. We don&apos;t have plans for another 2.4 release unless an urgent security fix is required or a very bad bug is discovered.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0es2w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>