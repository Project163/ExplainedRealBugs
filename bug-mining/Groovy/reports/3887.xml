<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:08:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9692] Adding extension method &apos;call&apos; on ArrayList with Closure as a parameter stopped working in 3.0.x</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9692</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Custom extension like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomExtension {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; MyData call(ArrayList header, Closure code) {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyData(data: header.join(&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;) + &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + code())
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; MyData test(ArrayList header, Closure code) {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyData(data: header.join(&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;) + &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + code())
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;used to work with Groovy 2.5.12&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomExtensionTest {
    @Test
    void &lt;span class=&quot;code-quote&quot;&gt;&quot;implicit call on array with closure used to work&quot;&lt;/span&gt;() {
        def result = [1, 2, 3] {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.data == &lt;span class=&quot;code-quote&quot;&gt;&apos;1:2:3 world&apos;&lt;/span&gt;
    }

    @Test
    void &lt;span class=&quot;code-quote&quot;&gt;&quot;explicit call on array with closure still works&quot;&lt;/span&gt;() {
        def result = [1, 2, 3].test {
            &lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.data == &lt;span class=&quot;code-quote&quot;&gt;&apos;1:2:3 world&apos;&lt;/span&gt;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with Groovy 3.0.x&#160;I get this error instead&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
groovy.lang.MissingMethodException: No signature of method: regression.CustomExtensionTest.[1, 2, 3]() is applicable &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; argument types: (regression.CustomExtensionTest$_call_on_array_with_closure_used_to_work_closure1) values: [regression.CustomExtensionTest$_call_on_array_with_closure_used_to_work_closure1@8b87145]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is this intentional?&lt;/p&gt;

&lt;p&gt;I have attached a maven project to reproduce.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13322903">GROOVY-9692</key>
            <summary>Adding extension method &apos;call&apos; on ArrayList with Closure as a parameter stopped working in 3.0.x</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="ninside">Mykola Golubyev</reporter>
                        <labels>
                    </labels>
                <created>Sun, 16 Aug 2020 02:12:14 +0000</created>
                <updated>Wed, 11 Nov 2020 02:00:59 +0000</updated>
                            <resolved>Sat, 5 Sep 2020 10:11:05 +0000</resolved>
                                    <version>3.0.0-beta-1</version>
                    <version>3.0.0-rc-1</version>
                    <version>3.0.5</version>
                                    <fixVersion>4.0.0-alpha-1</fixVersion>
                    <fixVersion>3.0.6</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17180062" author="ninside" created="Tue, 18 Aug 2020 20:20:38 +0000"  >&lt;p&gt;Hello, could you please confirm if this is a regression? I will start reading on how to contribute to groovy. This is blocking migration of webtau testing framework to 3.x&lt;/p&gt;</comment>
                            <comment id="17180114" author="paulk" created="Tue, 18 Aug 2020 21:45:26 +0000"  >&lt;p&gt;Yes, this is a regression. I haven&apos;t looked into the grammar yet to see if this was done for a reason.&lt;/p&gt;

&lt;p&gt;Looking at the AST tree for 2.5 we see the list being the receiver and the method being &quot;call&quot;:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13010058/13010058_image-2020-08-19-07-38-38-768.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I checked 2.5.10, 2.5.12, 2.5.13.&lt;/p&gt;

&lt;p&gt;Looking at the same tree for 3 we see &lt;tt&gt;this&lt;/tt&gt;&#160;being the receiver and the list expression has been assigned to the method which seems a little strange:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13010059/13010059_image-2020-08-19-07-40-33-584.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I checked back to 3.0.0-beta-1.&lt;/p&gt;

&lt;p&gt;I was using the following as my test case:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomExtension {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; call(ArrayList header, Closure code) {
        header.join(&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;) + &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + code()
    }
}

use(CustomExtension) {
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; [1, 2, 3] { &lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt; } == &lt;span class=&quot;code-quote&quot;&gt;&apos;1:2:3 world&apos;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17180120" author="emilles" created="Tue, 18 Aug 2020 22:01:42 +0000"  >&lt;p&gt;The inferred type of list and map literals has changed from &lt;tt&gt;ArrayList&lt;/tt&gt; and &lt;tt&gt;LinkedHashSet&lt;/tt&gt; to the corresponding interface types.  If your custom extension uses &lt;tt&gt;List&lt;/tt&gt; as the self type, the category method works as intended.&lt;/p&gt;</comment>
                            <comment id="17180125" author="ninside" created="Tue, 18 Aug 2020 22:07:00 +0000"  >&lt;p&gt;I changed types from &lt;tt&gt;ArrayList&lt;/tt&gt;&#160;to &lt;tt&gt;List&lt;/tt&gt;&#160;and still get the same error.&lt;br/&gt;
 Note that attached example uses extension via &lt;tt&gt;org.codehaus.groovy.runtime.ExtensionModule&lt;/tt&gt;&#160;and not via &lt;tt&gt;use()&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17180133" author="emilles" created="Tue, 18 Aug 2020 22:22:08 +0000"  >&lt;p&gt;Sorry, got fooled by something else.  Looks like when I run under new parser the error comes and when I switch back to antrl2, it runs fine.  So as Paul says, the interpretation of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&quot; as &quot;this.&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&quot; is the likely root cause.&lt;/p&gt;</comment>
                            <comment id="17180141" author="emilles" created="Tue, 18 Aug 2020 22:36:16 +0000"  >&lt;p&gt;This is the condition that the parser plugin fell into in the olden days (from org.codehaus.groovy.antlr.AntlrParserPlugin#methodCallExpression):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            implicitThis = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
            name = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConstantExpression(&lt;span class=&quot;code-quote&quot;&gt;&quot;call&quot;&lt;/span&gt;);
            objectExpression = expression(selector, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m checking the &lt;tt&gt;AstBuilder&lt;/tt&gt; (antlr4 equivalent) for the same case...&lt;/p&gt;</comment>
                            <comment id="17180145" author="paulk" created="Tue, 18 Aug 2020 22:50:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; That is the correct place to look. If you have no luck, let me know and I&apos;ll take a look too.&lt;/p&gt;</comment>
                            <comment id="17180148" author="paulk" created="Tue, 18 Aug 2020 22:52:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ninside&quot; class=&quot;user-hover&quot; rel=&quot;ninside&quot;&gt;ninside&lt;/a&gt; You can switch Groovy 3 to use the old antlr2 parser. That might be a possible workaround while we look at this. It means you won&apos;t have access to the new Groovy 3 additions though including lambda expressions.&lt;/p&gt;</comment>
                            <comment id="17180158" author="ninside" created="Tue, 18 Aug 2020 23:08:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulk&quot; class=&quot;user-hover&quot; rel=&quot;paulk&quot;&gt;paulk&lt;/a&gt;&#160;that sounds good! How do I do this switch? webtau is both a command line tool and a set of libraries. So can be used as a dependency to say JUnit and as a standalone test runner via command line (including REPL mode). I assume I can control antlr2 parser in the case of command line tool, but not in the case of it being used as a dependency? &#160;&lt;/p&gt;</comment>
                            <comment id="17180159" author="emilles" created="Tue, 18 Aug 2020 23:10:06 +0000"  >&lt;p&gt;This should do the trick: &lt;a href=&quot;https://github.com/apache/groovy/pull/1348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1348&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17181199" author="ninside" created="Thu, 20 Aug 2020 13:46:30 +0000"  >&lt;p&gt;Is there anything I can do to help at this point?&lt;/p&gt;</comment>
                            <comment id="17183620" author="ninside" created="Mon, 24 Aug 2020 22:09:00 +0000"  >&lt;p&gt;Looks like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt;&#160;merged PR. Thank you.&lt;br/&gt;
Do you know when is the next patch build scheduled?&lt;/p&gt;</comment>
                            <comment id="17183629" author="paulk" created="Mon, 24 Aug 2020 22:50:43 +0000"  >&lt;p&gt;Probably a couple of weeks way. We still have a few regressions reported that we haven&apos;t worked through yet that we would like for the next releases.&lt;/p&gt;</comment>
                            <comment id="17193920" author="ninside" created="Fri, 11 Sep 2020 00:07:07 +0000"  >&lt;p&gt;I see the status is FIXED, great!&lt;/p&gt;

&lt;p&gt;do you know when maven central 3.0.6 will land?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13009939" name="groovy3-call-regression.zip" size="9398" author="ninside" created="Sun, 16 Aug 2020 02:10:25 +0000"/>
                            <attachment id="13010058" name="image-2020-08-19-07-38-38-768.png" size="36266" author="paulk" created="Tue, 18 Aug 2020 21:38:38 +0000"/>
                            <attachment id="13010059" name="image-2020-08-19-07-40-33-584.png" size="36400" author="paulk" created="Tue, 18 Aug 2020 21:40:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 9 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hsz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>