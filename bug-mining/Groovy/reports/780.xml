<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:08:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2382] 64K limit on strings -- Caught: java.lang.ClassFormatError: Unknown constant tag 84 in class file test</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2382</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Assigning a string of 65535 characters or larger results in this error: Caught: java.lang.ClassFormatError: Unknown constant tag 84 in class file test.&lt;/p&gt;

&lt;p&gt;Attached testcase&apos;s string is exactly 65535 characters. Removing a single character from the string eliminates this error.&lt;/p&gt;</description>
                <environment>Fedora Core 7 64-bit  running 32-bit jdk 1.5.10</environment>
        <key id="12813791">GROOVY-2382</key>
            <summary>64K limit on strings -- Caught: java.lang.ClassFormatError: Unknown constant tag 84 in class file test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="jmeeks">Jonathan Meeks</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Dec 2007 09:59:48 +0000</created>
                <updated>Thu, 30 Oct 2008 13:07:58 +0000</updated>
                            <resolved>Thu, 30 Oct 2008 13:07:58 +0000</resolved>
                                    <version>1.5</version>
                                    <fixVersion>1.6-rc-1</fixVersion>
                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>bytecode</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14463757" author="blackdrag" created="Wed, 12 Dec 2007 11:05:51 +0000"  >&lt;p&gt;yes I guess we should check this and several other things (like method length)&lt;/p&gt;</comment>
                            <comment id="14464703" author="jessewatson" created="Tue, 29 Apr 2008 15:52:35 +0000"  >&lt;p&gt;I ran into this issue as well.  Might seem like not that big a deal, but here it something to consider...&lt;/p&gt;

&lt;p&gt;While it is unfortunate that there is this limit on String literals in groovy, it is much worse to get this kind of error message as opposed to something like &quot;String literal too long&quot;.  The ClassFormatError is not confidence-building in a new language like Groovy, and a better error message would at least lend the appearance of some robustness.  I love Groovy, but if we want it to gain acceptance, focusing on robustness is key &amp;#8211; error messages like this one really reveal the immaturity of a language.&lt;/p&gt;</comment>
                            <comment id="14464686" author="blackdrag" created="Tue, 29 Apr 2008 16:09:18 +0000"  >&lt;p&gt;The 64k limit is none of the language Groovy, it is more a limit of the JVM, See &lt;a href=&quot;http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#88659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#88659&lt;/a&gt; &lt;blockquote&gt;&lt;p&gt;The length of field and method names, field and method descriptors, and other constant string values is limited to 65535 characters by the 16-bit unsigned length item of the CONSTANT_Utf8_info structure (&#167;4.4.7). Note that the limit is on the number of bytes in the encoding and not on the number of encoded characters. UTF-8 encodes some characters using two or three bytes. Thus, strings incorporating multibyte characters are further constrained. &lt;/p&gt;&lt;/blockquote&gt;&lt;br/&gt;
The obvious solution is to split the String by the compiler in chunks small than 64k and concat them to get the real string. And that is the target of resolving this issue. I guess adding checks for the number of constant pool entries, descriptor lengths and others are also something we should do. The only reason for me making the current situation bad, is that the ClassFormatErrors or VerifyErrors are errors and no exceptions. From the side of having a security leak or something like this, because of such an error... I think there is nothing to be afraid of. The JVM is responsible for this, not the generated bytecode.&lt;/p&gt;</comment>
                            <comment id="14464718" author="jessewatson" created="Tue, 29 Apr 2008 17:47:49 +0000"  >&lt;p&gt;Jochen &amp;#8211; thanks for the clarification.  I didn&apos;t realize this limit was in the JVM &amp;#8211; good to know.&lt;/p&gt;

&lt;p&gt;I guess my larger point was more perception-oriented than anything.  ClassFormatError &lt;b&gt;smells&lt;/b&gt; like a bad internal error, and someone like myself seeing that (without knowing as much as yourself about what is really going on), I think: UH-OH, SOMETHING IS DEEPLY WRONG HERE...   GROOVY IS UNSTABLE!&lt;/p&gt;

&lt;p&gt;For no other reason than because in Java, the &lt;b&gt;only&lt;/b&gt; time you would see a ClassFormatError is when your compiler has a bug in it, or if you are trying to run some non-class file through a JVM.&lt;/p&gt;

&lt;p&gt;For example, a too-long string literal run through javac produces the following compile-time error: &quot;constant string too long&quot;.  That feels like the error message from a stable, mature compiler / language.  And maybe this is your point as well when you say: &quot;ClassFormatErrors or VerifyErrors are errors and no exceptions&quot;.&lt;/p&gt;

&lt;p&gt;My only point is that I think the perception of stability comes mainly from making sure that errors are caught up front and reasonable error messages are given, rather than producing an invalid class file and falling back on the JVM to throw a ClassFormatError.  And (like many others) I want to see Groovy become perceived as stable in the market place so I can justify its use in my organization, etc.&lt;/p&gt;

&lt;p&gt;I agree with you there is nothing to truly be afraid of from a technical standpoint (security, etc).  The only thing to fear is fear itself &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14465571" author="blackdrag" created="Thu, 30 Oct 2008 13:07:58 +0000"  >&lt;p&gt;the compiler will now complain if the string is too big&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721767" name="test.groovy" size="65550" author="jmeeks" created="Wed, 12 Dec 2007 09:59:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bzkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>