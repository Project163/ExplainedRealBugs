<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:37:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6456] AbstractHttpServlet.applyResourceNameMatcher race condition</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6456</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;groovy.servlet.AbstractHttpServlet#applyResourceNameMatcher uses java.util.regex.Matcher object in this way:&lt;/p&gt;

&lt;p&gt;matcher.reset(uri);&lt;/p&gt;

&lt;p&gt;but Matcher is NOT ThreadSafe!&lt;/p&gt;

&lt;p&gt;javadoc:&lt;br/&gt;
Instances of this class are not safe for use by multiple concurrent threads.&lt;/p&gt;

&lt;p&gt;Pattern class IS thread safe.&lt;/p&gt;


&lt;p&gt;stacktrace from bug demo&lt;br/&gt;
2013-12-01 23:36:50.009:WARN:oejs.ServletHandler:/1Test.groovy&lt;br/&gt;
java.lang.IndexOutOfBoundsException: start 0, end -1, s.length() 14&lt;br/&gt;
	at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:476)&lt;br/&gt;
	at java.lang.StringBuffer.append(StringBuffer.java:309)&lt;br/&gt;
	at java.util.regex.Matcher.appendReplacement(Matcher.java:839)&lt;br/&gt;
	at java.util.regex.Matcher.replaceAll(Matcher.java:906)&lt;br/&gt;
	at groovy.servlet.AbstractHttpServlet.applyResourceNameMatcher(AbstractHttpServlet.java:303)&lt;br/&gt;
	at groovy.servlet.AbstractHttpServlet.getScriptUri(AbstractHttpServlet.java:290)&lt;br/&gt;
	at groovy.servlet.GroovyServlet.service(GroovyServlet.java:105)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12818489">GROOVY-6456</key>
            <summary>AbstractHttpServlet.applyResourceNameMatcher race condition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="rybin.andrey@gmail.com">Andrew P Fink</reporter>
                        <labels>
                            <label>breaking</label>
                    </labels>
                <created>Wed, 27 Nov 2013 13:15:18 +0000</created>
                <updated>Sat, 5 Apr 2014 00:00:53 +0000</updated>
                            <resolved>Mon, 13 Jan 2014 09:27:41 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.3.0-beta-1</fixVersion>
                                    <component>Groovlet / GSP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14480381" author="rybin.andrey@gmail.com" created="Sun, 1 Dec 2013 13:40:49 +0000"  >&lt;p&gt;bug demo. &lt;br/&gt;
$ groovy runme&lt;/p&gt;</comment>
                            <comment id="14475300" author="pschumacher" created="Sun, 1 Dec 2013 16:08:58 +0000"  >&lt;p&gt;Thanks for reporting. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If you like to you can send us a pull request with a fix. Else I will take a look in the next few days if nobody else beats me to it.&lt;/p&gt;</comment>
                            <comment id="14480405" author="rybin.andrey@gmail.com" created="Mon, 2 Dec 2013 03:06:11 +0000"  >&lt;p&gt;bug fixed, little optimized version&lt;/p&gt;</comment>
                            <comment id="14475152" author="rybin.andrey@gmail.com" created="Mon, 2 Dec 2013 03:08:09 +0000"  >&lt;p&gt;Sorry, no time for pull, but new version attached.&lt;/p&gt;</comment>
                            <comment id="14480409" author="rybin.andrey@gmail.com" created="Mon, 2 Dec 2013 07:10:42 +0000"  >&lt;p&gt;Matcher bug fixed. &lt;br/&gt;
optimization. &lt;br/&gt;
&apos;NPE in war&apos; bug fixed.&lt;/p&gt;</comment>
                            <comment id="14480398" author="rybin.andrey@gmail.com" created="Mon, 2 Dec 2013 08:04:29 +0000"  >&lt;p&gt;during test process I found strange GroovyScripEngine behavior. I doubt: is it normal?&lt;/p&gt;

&lt;p&gt;//Groovlet1.groovy&lt;br/&gt;
println DS //DS exists in binding&lt;/p&gt;

&lt;p&gt;getResourceConnection was called several times:&lt;br/&gt;
//getScriptUri: /nsa/Groovlet1.groovy -&amp;gt; /Groovlet1.groovy&lt;br/&gt;
getResourceConnection: /Groovlet1.groovy&lt;br/&gt;
getResourceConnection: java/lang/DS.groovy&lt;br/&gt;
getResourceConnection: java/io/DS.groovy&lt;br/&gt;
getResourceConnection: java/net/DS.groovy&lt;br/&gt;
getResourceConnection: java/util/DS.groovy&lt;br/&gt;
getResourceConnection: groovy/lang/DS.groovy&lt;br/&gt;
getResourceConnection: groovy\lang\DS.groovy&lt;br/&gt;
getResourceConnection: groovy/util/DS.groovy&lt;br/&gt;
getResourceConnection: groovy\util\DS.groovy&lt;br/&gt;
getResourceConnection: DS.groovy&lt;br/&gt;
getResourceConnection: DS.groovy&lt;br/&gt;
getResourceConnection: java/lang/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: java/io/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: java/net/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: java/util/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: groovy/lang/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: groovy/util/Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: Groovlet1$DS.groovy&lt;br/&gt;
getResourceConnection: Groovlet1BeanInfo.groovy&lt;br/&gt;
getResourceConnection: Groovlet1Customizer.groovy&lt;/p&gt;</comment>
                            <comment id="14475324" author="pschumacher" created="Mon, 2 Dec 2013 12:57:33 +0000"  >&lt;p&gt;Hi Andrej, &lt;/p&gt;

&lt;p&gt;np about the pull request. Thanks for the fixed version. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I converted it to a &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/294&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pull request&lt;/a&gt; to make reviewing easier.&lt;/p&gt;

&lt;p&gt;Sadly I do not know if the GroovyScripEngine behavior is normal. Maybe blackdrag blackdrag or somebody else can comment on this?&lt;/p&gt;
</comment>
                            <comment id="14475166" author="guillaume" created="Mon, 2 Dec 2013 13:29:18 +0000"  >&lt;p&gt;Regarding the behavior of GroovyScriptEngine, yes, that&apos;s its normal behavior, to try and find where DS is coming from. Seeing it looks like it&apos;s a capitalized name, Groovy thinks it might be a class, so it tries to find where that DS class could be coming from.&lt;/p&gt;</comment>
                            <comment id="14480412" author="rybin.andrey@gmail.com" created="Tue, 3 Dec 2013 06:06:29 +0000"  >&lt;p&gt;Could You inspect new &apos;performant&apos; version and do another pull request for it?&lt;br/&gt;
I did some obvious optimizations, so it should be faster.&lt;/p&gt;

&lt;p&gt;AbstractHttpServlet.perf.java&lt;br/&gt;
*Matcher bugfix. &lt;br/&gt;
*NPE in war bugfix.&lt;br/&gt;
*more optimizations&lt;/p&gt;</comment>
                            <comment id="14475287" author="pschumacher" created="Wed, 11 Dec 2013 15:20:30 +0000"  >&lt;p&gt;I updated the pull request with the new version (AbstractHttpServlet.perf.java) of the patch.&lt;/p&gt;</comment>
                            <comment id="14475247" author="blackdrag" created="Mon, 13 Jan 2014 09:27:42 +0000"  >&lt;p&gt;We decide to apply this even though it is a breaking change. But we think the feature is not used much and the fix is easy to do. So we think it is more important to fix the race condition here. thanks for the contribution&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722193" name="AbstractHttpServlet.java" size="17476" author="" created="Mon, 2 Dec 2013 07:10:42 +0000"/>
                            <attachment id="12722398" name="AbstractHttpServlet.perf.java" size="17496" author="" created="Tue, 3 Dec 2013 09:30:43 +0000"/>
                            <attachment id="12723136" name="groovyServlet_MatcherBug.zip" size="1051" author="" created="Sun, 1 Dec 2013 13:40:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bx3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>