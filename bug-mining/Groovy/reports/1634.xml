<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:23:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4966] VeryifyError in multi-dimensional array usage:  Incompatible argument to function</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4966</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When running this code, I get the attached error.  Please see: &lt;a href=&quot;http://pastie.org/2327875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pastie.org/2327875&lt;/a&gt;.  Dropping back to 1.7 seems to work.  I&apos;m running 1.8.1, but the problem also exists in 1.8.0.&lt;/p&gt;</description>
                <environment>Mac OSX 10.7, jdk 1.6.0_26-b03-383-11A511</environment>
        <key id="12815774">GROOVY-4966</key>
            <summary>VeryifyError in multi-dimensional array usage:  Incompatible argument to function</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="cfriedline">Chris</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Aug 2011 08:58:43 +0000</created>
                <updated>Sat, 24 Dec 2011 03:08:04 +0000</updated>
                            <resolved>Tue, 29 Nov 2011 21:42:17 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>1.8.5</fixVersion>
                    <fixVersion>2.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14471582" author="cfriedline" created="Sat, 6 Aug 2011 09:11:57 +0000"  >&lt;p&gt;Sorry, this error is not present in 1.8.0, I forgot to recompile after changing the gdk.  It does remain in 1.8.1, however. &lt;/p&gt;</comment>
                            <comment id="14471562" author="roshandawrani" created="Sat, 6 Aug 2011 22:12:45 +0000"  >&lt;p&gt;Here is a shorter piece of code that reproduces it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;[] c1 = &lt;span class=&quot;code-quote&quot;&gt;&apos;xy&apos;&lt;/span&gt;.toCharArray()
getIndex(c1[0])

/*
&lt;span class=&quot;code-comment&quot;&gt;//Note: This works fine
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; a = &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;
getIndex(a)
*/

def getIndex(&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; base) {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14472005" author="roshandawrani" created="Mon, 28 Nov 2011 21:57:51 +0000"  >&lt;p&gt;Corrected the bug title a bit.&lt;/p&gt;</comment>
                            <comment id="14472084" author="roshandawrani" created="Mon, 28 Nov 2011 22:02:06 +0000"  >&lt;p&gt;Here is the shorter version of the code that currently reproduces the bug. (Probably the shorter version supplied earlier resulted in a VerifyError due to some other reason, and that piece of code works now.)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ParalinearTest {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args){}

    void zeroMatrix(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[][] matrix) {
        matrix[0][0]
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The bug can be seen in action on Groovy Web Console here: &lt;a href=&quot;http://groovyconsole.appspot.com/edit/597001&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovyconsole.appspot.com/edit/597001&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14472120" author="roshandawrani" created="Mon, 28 Nov 2011 22:14:56 +0000"  >&lt;p&gt;The VerifyError is caused by how multi-dimensional arrays are handled on the fast-path.&lt;/p&gt;

&lt;p&gt;For &quot;int[][] matrix&quot;, matrix&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; is written in the class like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;BytecodeInterface8.intArrayGet(BytecodeInterface8.objectArrayGet(matrix, 0), 0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when it should have been written as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;BytecodeInterface8.intArrayGet((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[])ScriptBytecodeAdapter.castToType(BytecodeInterface8.objectArrayGet(matrix, 0), &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[]), 0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result of BytecodeInterface8.objectArrayGet was not casted to int[], which made the BytecodeInterface8.intArrayGet() call invalid.&lt;/p&gt;

&lt;p&gt;The following patch solves the issue (tested locally with the latest shorter version and the original testcase of the bug):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@@ -166,11 +166,15 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BinaryExpressionMultiTypeDispatcher &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; BinaryExpressionHelper
                 leftExp.visit(acg);
                 os.doGroovyCast(leftTypeOrig);
                 rightExp.visit(acg);
                 os.doGroovyCast(int_TYPE);
                 bew.arrayGet(operation, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
-                os.replace(leftType,2);
+                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(bew &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; BinaryObjectExpressionHelper) {
+                    os.replace(ClassHelper.OBJECT_TYPE,2);
+                } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
+                    os.replace(leftType,2);
+                }
             } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                 &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.evaluateBinaryExpression(message, binExp);
             }
         } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
             &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; operationType = getOperandConversionType(leftType,rightType);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14472069" author="blackdrag" created="Tue, 29 Nov 2011 06:45:18 +0000"  >&lt;p&gt;Well spotted Roshan! If that patch works with a 3d and 4d array too, then it would be nice of you to commit it. But I think it will work&lt;/p&gt;</comment>
                            <comment id="14472070" author="roshandawrani" created="Tue, 29 Nov 2011 21:42:17 +0000"  >&lt;p&gt;Extended the test to cover 3d, 4d arrays also. They also work now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cqn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>