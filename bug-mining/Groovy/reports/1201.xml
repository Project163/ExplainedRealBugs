<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:15:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3384] XML NodeList.add(index, Node) does not work as expected</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3384</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following test fails - the new node is always inserted at the end of the list&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;def xml = &quot;&amp;lt;parent&amp;gt;&amp;lt;child id=\&quot;1\&quot;/&amp;gt;&amp;lt;/parent&amp;gt;&quot;
def parent = new XmlParser().parseText(xml)
def node = new Node(parent, &quot;child&quot;, [id:&quot;2&quot;])
parent.child.add(0, node)
assert parent.child[0] == node
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The following test fails too - In this case, the second assertions fails - the node is inserted twice!&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;def xml = &quot;&amp;lt;parent&amp;gt;&amp;lt;child id=\&quot;1\&quot;/&amp;gt;&amp;lt;/parent&amp;gt;&quot;
def parent = new XmlParser().parseText(xml)
def node = new Node(parent, &quot;child&quot;, [id:&quot;2&quot;])
parent.children().add(0, node)
assert parent.children()[0] == node
assert parent.children()[2] != node
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Mac OS X</environment>
        <key id="12818372">GROOVY-3384</key>
            <summary>XML NodeList.add(index, Node) does not work as expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="peter.rietzler@smarter-ecommerce.com">Peter Rietzler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Feb 2009 17:15:51 +0000</created>
                <updated>Tue, 7 Apr 2015 19:13:02 +0000</updated>
                            <resolved>Wed, 24 Feb 2010 06:47:41 +0000</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.7.2</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                    <component>XML Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14466668" author="roshandawrani" created="Thu, 5 Mar 2009 05:37:31 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I looked into this issue a bit and I think I can add a few things here to get started. I am no xml or groovy-xml expert , so I am just going to say things based on what I see in the implementation.&lt;/p&gt;

&lt;p&gt;So, a few things that should help reduce the confusion:&lt;/p&gt;

&lt;p&gt;1) As soon as you say &quot;def node = new Node(parent, &quot;child&quot;, &lt;span class=&quot;error&quot;&gt;&amp;#91;id:&amp;quot;2&amp;quot;&amp;#93;&lt;/span&gt;)&quot;, you add &quot;node&quot; as a child of node parent. So, if you check the value of &quot;parent.child.size()&quot; before and after the node declaration above, you will see a difference of 1. The explicit add() call is not needed.&lt;/p&gt;

&lt;p&gt;2) There is a difference in accessing list of child nodes as &quot;parent.child&quot; and &quot;parent.children()&quot;. &quot;parent.child&quot; constructs a new node list and adds child nodes to it whereas parent.children() returns the original copy. parent.children() is based on groovy.util.Node API but parent.child is a general feature that can be seen at play in following snippet:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Dummy {
    def id
}
def dlist = []
dlist &amp;lt;&amp;lt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Dummy(id:&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;)
dlist &amp;lt;&amp;lt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Dummy(id:&lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;)
println dlist.id &lt;span class=&quot;code-comment&quot;&gt;// list.id = a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; list made-up of id attribute of each Dummy instance that is in dlist&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, coming to your first piece of code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def xml = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;parent&amp;gt;&amp;lt;child id=\&quot;&lt;/span&gt;1\&lt;span class=&quot;code-quote&quot;&gt;&quot;/&amp;gt;&amp;lt;/parent&amp;gt;&quot;&lt;/span&gt;
def parent = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser().parseText(xml)
def node = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Node(parent, &lt;span class=&quot;code-quote&quot;&gt;&quot;child&quot;&lt;/span&gt;, [id:&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;]) &lt;span class=&quot;code-comment&quot;&gt;// now node is already a child of parent - added after first child
&lt;/span&gt;parent.child.add(0, node) &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; does not affect anything as it is working on the nodelist copy
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; parent.child[0] == node &lt;span class=&quot;code-comment&quot;&gt;// fails because parent.child[0] is the original child1&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In your 2nd piece of code, you do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def node = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Node(parent, &lt;span class=&quot;code-quote&quot;&gt;&quot;child&quot;&lt;/span&gt;, [id:&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;]) &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; adds node as the 2nd child
&lt;/span&gt;parent.children().add(0, node) &lt;span class=&quot;code-comment&quot;&gt;// node gets added again at index 0, so parent has node, child1, node as children now.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What you can do is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def xml = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;parent&amp;gt;&amp;lt;child id=\&quot;&lt;/span&gt;1\&lt;span class=&quot;code-quote&quot;&gt;&quot;/&amp;gt;&amp;lt;/parent&amp;gt;&quot;&lt;/span&gt;
def parent = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser().parseText(xml)
def node = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Node(parent, &lt;span class=&quot;code-quote&quot;&gt;&quot;child&quot;&lt;/span&gt;, [id:&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;]) &lt;span class=&quot;code-comment&quot;&gt;// adds node as 2nd child
&lt;/span&gt;parent.remove(node) &lt;span class=&quot;code-comment&quot;&gt;// removes node from parent&apos;s children
&lt;/span&gt;parent.children().add(0, node) &lt;span class=&quot;code-comment&quot;&gt;// re-inserts node at desired position in child list
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; parent.child[0] == node
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There may be better ways of doing it, but I hope I have highlighted what was wrong in your given code.&lt;/p&gt;</comment>
                            <comment id="14466603" author="peter.rietzler@smarter-ecommerce.com" created="Mon, 9 Mar 2009 02:48:51 +0000"  >&lt;p&gt;Thanks - it seems that the late hour has shaded my sight &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve implemented the stuff by just following the JavaDoc - maybe this issue should be changed to make the JavaDoc better ...&lt;/p&gt;</comment>
                            <comment id="14466626" author="roshandawrani" created="Mon, 9 Mar 2009 03:51:59 +0000"  >&lt;p&gt;I thought of asking you to change the affected component category from Xml Processing to documentation, but then noticed that there is no such component listed under groovy.&lt;/p&gt;

&lt;p&gt;Anyway, good to know that you were able to proceed.&lt;/p&gt;</comment>
                            <comment id="14478916" author="paulk" created="Wed, 24 Feb 2010 06:47:41 +0000"  >&lt;p&gt;I added javadoc to the Node constructors to make it clearer that they cause an implicit add to the parent Node.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cf5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>