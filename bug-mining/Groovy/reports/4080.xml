<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:12:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8001] Static compiling fails type checking with generics</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8001</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given a property of type &lt;tt&gt;Map&amp;lt;String, Object&amp;gt;&lt;/tt&gt; and the assignment:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;myObject.property = [&lt;span class=&quot;code-quote&quot;&gt;&apos;myKey&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;${buildDir}/file-cache&quot;&lt;/span&gt;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I get the following error:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Static type checking&amp;#93;&lt;/span&gt; - Cannot assign value of type java.util.LinkedHashMap &amp;lt;java.lang.String, groovy.lang.GString&amp;gt; to variable of type java.util.Map &amp;lt;java.lang.String, java.lang.Object&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have to manually cast the value to &lt;tt&gt;Object&lt;/tt&gt; for it to work without warnings:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;myObject.property = [&lt;span class=&quot;code-quote&quot;&gt;&apos;myKey&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;${buildDir}/file-cache&quot;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should not be needed, since any object is a valid instance of &lt;tt&gt;Object&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13021834">GROOVY-8001</key>
            <summary>Static compiling fails type checking with generics</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="jmsotuyo">Juan Mart&#237;n Sotuyo Dodero</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Nov 2016 19:52:04 +0000</created>
                <updated>Sun, 2 May 2021 09:18:28 +0000</updated>
                            <resolved>Fri, 2 Apr 2021 14:38:27 +0000</resolved>
                                    <version>2.4.7</version>
                                    <fixVersion>4.0.0-alpha-3</fixVersion>
                                    <component>Static Type Checker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15677889" author="emilles" created="Fri, 18 Nov 2016 21:59:22 +0000"  >&lt;p&gt;I think this mirrors Java&apos;s handling of the same.  If you had &lt;tt&gt;Map&amp;lt;String,? extends Object&amp;gt;&lt;/tt&gt; for property the assignment should succeed.  Or if you do the cast as you have indicated, you help the inferencing engine out to get to String, Object.  We have to do this same thing all the time when using Arrays.asList(), Collection.singletonMap(), and so on.&lt;/p&gt;</comment>
                            <comment id="15677914" author="jmsotuyo" created="Fri, 18 Nov 2016 22:09:23 +0000"  >&lt;p&gt;The types for the &lt;tt&gt;LinkedHashMap&lt;/tt&gt; are inferred by Groovy.&lt;/p&gt;

&lt;p&gt;If I wrote:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[&lt;span class=&quot;code-quote&quot;&gt;&apos;myKey&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;${buildDir}/file-cache&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;otherKey&apos;&lt;/span&gt;: 4G]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It would be treated as a &lt;tt&gt;LinkedHashMap&amp;lt;String, Object&amp;gt;&lt;/tt&gt;  and would work just as fine. The problem here is how Groovy is inferring the types for the Map.&lt;/p&gt;

&lt;p&gt;I believe Groovy should (and can) look not only at the values, but how the variable is used to determine the used types when doing static compilation and either throw an error if a mismatch is found, or sort it out if it&apos;s possible.&lt;/p&gt;</comment>
                            <comment id="15677939" author="emilles" created="Fri, 18 Nov 2016 22:18:08 +0000"  >&lt;p&gt;Sure, GString and BigDecimal will give you Object as the least upper bound type.  If you had &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;key1: &amp;quot;GString&amp;quot;, key2: &amp;#39;String&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; you&apos;d get &lt;tt&gt;Map&amp;lt;String,CharSequence&amp;gt;&lt;/tt&gt; not Object.  Java would infer this the same way.  Cast either value to Object and that will be the least upper bound.  Java and Groovy can&apos;t do much more than they are already doing because you don&apos;t always have a nicely typed item on the left hand side of the assignment.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36iof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>