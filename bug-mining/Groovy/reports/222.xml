<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:57:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-1026] Null argument to methods with vararg parameters are replaced with array of length 1</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-1026</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This code now fails:&lt;/p&gt;

&lt;p&gt;package groovy.bugs;&lt;br/&gt;
import java.lang.reflect.*&lt;br/&gt;
class ReflectionInvokeBug extends GroovyTestCase {&lt;br/&gt;
  void testInvoke() &lt;/p&gt;
{
    def clazz = &quot;org.codehaus.groovy.dummy.ClassWithStaticMethod&quot;
    Class c = Class.forName(clazz)
    Method init = c.getDeclaredMethod(&quot;staticMethod&quot;, null)
  }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;with this exception:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; There was 1 error:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; 1) testInvoke(groovy.bugs.ReflectionInvokeBug)java.lang.ClassCastException: [Ljava.lang.Object;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at gjdk.java.lang.Class_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at groovy.lang.MetaMethod.invoke(MetaMethod.java:110)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at groovy.lang.MetaClass.doMethodInvoke(MetaClass.java:1557)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at groovy.lang.MetaClass.invokeStaticMethod(MetaClass.java:520)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:137)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethod(ScriptBytecodeAdapter.java:85)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at groovy.bugs.ReflectionInvokeBug.testInvoke(Unknown Source)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;      at groovy.util.GroovyTestSuite.main(GroovyTestSuite.java:79)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;This must be due to some recent change since I upgraded today and it worked before.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12816382">GROOVY-1026</key>
            <summary>Null argument to methods with vararg parameters are replaced with array of length 1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phkim">Kim, Pilho</assignee>
                                    <reporter username="meling">Hein Meling</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Aug 2005 06:47:50 +0000</created>
                <updated>Tue, 23 Aug 2022 17:16:57 +0000</updated>
                            <resolved>Tue, 23 Aug 2005 02:46:29 +0000</resolved>
                                    <version>1.0-JSR-4</version>
                                    <fixVersion>1.0-JSR-4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14461530" author="meling" created="Mon, 22 Aug 2005 10:25:00 +0000"  >&lt;p&gt;The following test also fails.  That is, it seems to replace null reference arguments with an array of length 1 containing a null reference. I&apos;ll attach the updated testcase and raise this issue to blocker priority since it prevents calling methods with null argument and test for it.&lt;/p&gt;

&lt;p&gt;  void testNullArgument2() &lt;/p&gt;
{
    Object[] arglist = new Object[0]
    def s = methodArg(arglist)
    assert s == &quot;length: 0&quot;
    println &quot;empty: &quot; + s
    def v = methodArg(null)
    assert v == &quot;null is ok&quot;
    println &quot;null: &quot; + v
  }

&lt;p&gt;  String methodArg(Object[] args) {&lt;br/&gt;
    println &quot;Hey: &quot; + args&lt;br/&gt;
    if (args == null) &lt;/p&gt;
{
      return &quot;null is ok&quot;
    }
&lt;p&gt; else &lt;/p&gt;
{
      return &quot;length: &quot; + args.length
    }
&lt;p&gt;  }&lt;/p&gt;</comment>
                            <comment id="14461426" author="meling" created="Mon, 22 Aug 2005 10:26:02 +0000"  >&lt;p&gt;Raised priority to blocker priority.&lt;/p&gt;</comment>
                            <comment id="14461407" author="meling" created="Mon, 22 Aug 2005 10:28:54 +0000"  >&lt;p&gt;Attached updated testcase.&lt;/p&gt;</comment>
                            <comment id="14461378" author="phkim" created="Mon, 22 Aug 2005 12:53:59 +0000"  >&lt;p&gt;These is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-1026&quot; title=&quot;Null argument to methods with vararg parameters are replaced with array of length 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-1026&quot;&gt;&lt;del&gt;GROOVY-1026&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14461510" author="phkim" created="Mon, 22 Aug 2005 12:57:31 +0000"  >&lt;p&gt;The issue &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-1023&quot; title=&quot;methods with varargs are called with null when args are empty but should use an empty Array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-1023&quot;&gt;&lt;del&gt;GROOVY-1023&lt;/del&gt;&lt;/a&gt; has been fixed just now.&lt;br/&gt;
So the next example, changed from your example, should work after building CVS HEAD&lt;/p&gt;

&lt;p&gt;X--------------------------------------------&lt;br/&gt;
class Issue1026 extends GroovyTestCase {&lt;/p&gt;

&lt;p&gt;    void testNullArgument2() &lt;/p&gt;
{ 
        Object[] arglist = new Object[0] 
        def s = methodArg(arglist) 
        assert s == &quot;length: 0&quot; 
        println &quot;empty: &quot; + s 

        def v = methodArg(null) 
        assert v == &quot;length: 1&quot; 
        println &quot;v is not null: &quot; + v 

        def w = methodArg() 
        assert w == &quot;length: 0&quot; 
        println &quot;w is not null: &quot; + w 
    }
&lt;p&gt; &lt;/p&gt;

&lt;p&gt;    String methodArg(Object[] args) &lt;/p&gt;
{ 
        println &quot;Hey: &quot; + args 
        return &quot;length: &quot; + args.length 
    }
&lt;p&gt; &lt;br/&gt;
}&lt;br/&gt;
X------------------------------------------------------&lt;/p&gt;</comment>
                            <comment id="14461457" author="meling" created="Mon, 22 Aug 2005 13:12:32 +0000"  >&lt;p&gt;Sure this change would pass the test, but that is &lt;b&gt;not&lt;/b&gt; the issue; it does not test the desired behavior.&lt;/p&gt;

&lt;p&gt;Calling a vararg method with &apos;null&apos; should not replace the arg with an array of length 1.  This is not Java behavior, since in Java we can test if the &apos;args&apos; parameter coming into the method is null. The current CVS HEAD prevents us from testing if it is null.  And this breaks things like Class.getDeclaredMethod(&quot;methodName&quot;, null), which is perfectly legal in Java.&lt;/p&gt;

&lt;p&gt;IMHO, the current CVS HEAD behavior has to be reverted to the previous behavior, otherwise it will be impossible to work with important parts of Java based APIs.  That is, unless you can come up with a reasonable substitute for this behavior, albeit I think it would be beneficial to be consistent with Java on this point.&lt;/p&gt;</comment>
                            <comment id="14461427" author="blackdrag" created="Mon, 22 Aug 2005 13:34:18 +0000"  >&lt;p&gt;in java5:&lt;/p&gt;

&lt;p&gt;public class Test {&lt;br/&gt;
	static void foo(int... i)&lt;/p&gt;
{
		System.out.println(i.length);
	}

&lt;p&gt;	public static void main(String[] args) throws Exception&lt;/p&gt;
{
		foo(null);
	}
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;will throw an NP, because i is null&lt;/p&gt;</comment>
                            <comment id="14461408" author="phkim" created="Mon, 22 Aug 2005 22:30:24 +0000"  >&lt;p&gt;In Java 5, the varargs &quot;Object...&quot; acts differently from the varargs &quot;int...&quot;&lt;br/&gt;
A Compile Time Warning is produced.&lt;br/&gt;
If it is executed, a NPE is generated.&lt;/p&gt;

&lt;p&gt;X-------------------------------------------&lt;br/&gt;
public class Test1 { &lt;br/&gt;
    static void foo1(Object... i) &lt;/p&gt;
{ 
        System.out.println(i.length); 
    }
&lt;p&gt; &lt;/p&gt;

&lt;p&gt;    public static void main(String[] args) throws Exception &lt;/p&gt;
{ 
        foo1(null);
    }
&lt;p&gt; &lt;br/&gt;
} &lt;br/&gt;
X-------------------------------------------&lt;/p&gt;


&lt;p&gt;C:\test&amp;gt;javac Test1.java&lt;br/&gt;
Test1.java:7: warning: non-varargs call of varargs method with inexact argument&lt;br/&gt;
type for last parameter;&lt;br/&gt;
cast to java.lang.Object for a varargs call&lt;br/&gt;
cast to java.lang.Object[] for a non-varargs call and to suppress this warning&lt;br/&gt;
        foo1(null);&lt;br/&gt;
             ^&lt;br/&gt;
1 warning&lt;/p&gt;

&lt;p&gt;C:\test&amp;gt;java Test1&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.NullPointerException&lt;br/&gt;
        at Test1.foo1(Test1.java:3)&lt;br/&gt;
        at Test1.main(Test1.java:7)&lt;/p&gt;</comment>
                            <comment id="14461468" author="phkim" created="Mon, 22 Aug 2005 23:46:33 +0000"  >&lt;p&gt;Hi Hein&lt;/p&gt;

&lt;p&gt;With this patch &lt;a href=&quot;http://cvs.groovy.codehaus.org/changelog/groovy/groovy/groovy-core?cs=MAIN:phk:20050823043805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.groovy.codehaus.org/changelog/groovy/groovy/groovy-core?cs=MAIN:phk:20050823043805&lt;/a&gt;&lt;br/&gt;
the issue should be fixed.&lt;/p&gt;

&lt;p&gt;Would you try test the CVS HEAD build?&lt;br/&gt;
If succeed, then  you may close this issue yourself.&lt;/p&gt;

&lt;p&gt;Kim&lt;/p&gt;</comment>
                            <comment id="14461531" author="meling" created="Tue, 23 Aug 2005 02:46:29 +0000"  >&lt;p&gt;Thanks a bunch Kim. It works now!&lt;/p&gt;

&lt;p&gt;Hein&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12818515">GROOVY-6146</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13379468">GROOVY-10099</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12812965">GROOVY-1023</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12721271" name="NullArgumentBug.groovy" size="959" author="meling" created="Mon, 22 Aug 2005 10:28:54 +0000"/>
                            <attachment id="12721407" name="ReflectionInvokeBug.groovy" size="359" author="meling" created="Mon, 22 Aug 2005 06:47:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2by5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>