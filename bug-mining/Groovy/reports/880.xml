<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:10:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3264] DGM#denormalize - Mac style line breaks and empty string</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3264</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;DGM#denormalize, in contrast to DGM#normalize, does not handle Mac style line breaks correctly. It throws an IndexOutOfBoundsException with empty strings.&lt;/p&gt;

&lt;p&gt;Attached a patch that solves this. It does not need an import of PlatformLineWriter and throws no IOException anymore.&lt;/p&gt;

&lt;p&gt;The patch also contains an alternative implementation of DGM#normalize it has speedup factors of 0.66 to 8 compared with the current implementation. However I don&apos;t know if it would have any practical worth to replace the current implementation.&lt;/p&gt;

&lt;p&gt;The second patch adds tests to DefaultGroovyMethodsTest.&lt;/p&gt;

&lt;p&gt;Additionally, I would like to discuss if DGM#normalize should really remove the last trailing linefeed.&lt;/p&gt;</description>
                <environment>Groovy 1.5.8, 1.6, trunk.</environment>
        <key id="12814522">GROOVY-3264</key>
            <summary>DGM#denormalize - Mac style line breaks and empty string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="veita">Alexander Veit</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Jan 2009 08:49:12 +0000</created>
                <updated>Thu, 22 Jan 2009 21:34:44 +0000</updated>
                            <resolved>Fri, 16 Jan 2009 03:30:52 +0000</resolved>
                                    <version>1.6-rc-1</version>
                                    <fixVersion>1.6-rc-2</fixVersion>
                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14466230" author="veita" created="Wed, 7 Jan 2009 13:13:52 +0000"  >&lt;p&gt;Other than the names of the patch files pretend they&apos;re not for trunk but for the 1.6 branch.&lt;/p&gt;</comment>
                            <comment id="14466148" author="jimwhite" created="Tue, 13 Jan 2009 20:02:51 +0000"  >&lt;p&gt;I would like &lt;tt&gt;denormalize&lt;/tt&gt; to be defined strictly in terms of replacing &lt;/p&gt;
{&apos;\n&apos;}
&lt;p&gt; with the platform line separator.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3246&quot; title=&quot;There should be a DGM.normalize(String) method which acts like readLines().join(&amp;#39;\n&amp;#39;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3246&quot;&gt;&lt;del&gt;GROOVY-3246&lt;/del&gt;&lt;/a&gt; for the proposed patch.&lt;/p&gt;</comment>
                            <comment id="14466172" author="jimwhite" created="Tue, 13 Jan 2009 20:14:38 +0000"  >&lt;p&gt;Ah, I&apos;ve actually read this issue now, and I agree that &lt;tt&gt;normalize&lt;/tt&gt; should not strip the trailing line  separator.  The patch tidies all this stuff up.&lt;/p&gt;</comment>
                            <comment id="14466233" author="jimwhite" created="Wed, 14 Jan 2009 11:33:44 +0000"  >&lt;p&gt;I don&apos;t think &lt;tt&gt;denormalize&lt;/tt&gt; should replace CR with line separators.  The reason is that a normalized string will only have LF for line termination.  If you&apos;ve got a string that isn&apos;t normalized (i.e. may have CR for line termination), then you should use &lt;tt&gt;normalize&lt;/tt&gt; on it first.&lt;/p&gt;
</comment>
                            <comment id="14466181" author="veita" created="Thu, 15 Jan 2009 16:50:32 +0000"  >&lt;p&gt;Your current implementation of &lt;tt&gt;denormalize&lt;/tt&gt;, as well as the attached patch, replaces single &lt;tt&gt;CR&lt;/tt&gt; with line separators.&lt;/p&gt;

&lt;p&gt;The old implemetation only replaced &lt;tt&gt;LF&lt;/tt&gt; and &lt;tt&gt;CR LF&lt;/tt&gt; line separators.&lt;/p&gt;

&lt;p&gt;So the current implementation seems to be more logical to me.&lt;/p&gt;</comment>
                            <comment id="14478426" author="paulk" created="Thu, 15 Jan 2009 16:59:39 +0000"  >&lt;p&gt;OK, obviously we need to fix the IOOBE and handle Mac style line breaks. My preferred goal would be that if I used getText() followed by normalize() followed by denormalize() then I would leave the original line endings &quot;mostly intact&quot;.&lt;/p&gt;</comment>
                            <comment id="14466310" author="jimwhite" created="Fri, 16 Jan 2009 02:50:53 +0000"  >&lt;p&gt;I changed my mind and decided that handling all line separators was the right thing to do.  &lt;/p&gt;

&lt;p&gt;It also turned out to be very easy because it just involved putting in a call to &lt;tt&gt;normalize&lt;/tt&gt; (which I was trying to claim the user ought to do - my bad) and that is fairly quick if there is little overhead if there are no CR in the string.&lt;/p&gt;

&lt;p&gt;And &lt;tt&gt;getText().normalize().denormalize()&lt;/tt&gt; will return exactly the original string if it used the platform line separators exclusively.  The last line will have a line separator or not just as the original string did.  Of course &lt;tt&gt;getText().normalize().denormalize()&lt;/tt&gt; (and &lt;tt&gt;getText().normalize().normalize().denormalize()&lt;/tt&gt;) is the same as &lt;tt&gt;getText().denormalize()&lt;/tt&gt; because &lt;tt&gt;denormalize&lt;/tt&gt; does a &lt;tt&gt;normalize&lt;/tt&gt; rather than assuming LF for line separation.  See the test cases in &lt;tt&gt;groovy.StringTest&lt;/tt&gt; and &lt;tt&gt;groovy.bugs.Groovy3235Bug&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12814478">GROOVY-3246</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12721501" name="patch-DGM-trunk.txt" size="3263" author="veita" created="Wed, 7 Jan 2009 08:49:12 +0000"/>
                            <attachment id="12721985" name="patch-DGMTest-trunk.txt" size="2561" author="veita" created="Wed, 7 Jan 2009 08:49:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 45 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2chqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>