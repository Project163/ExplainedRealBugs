<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:36:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5974] @Delegate should support including/excluding which methods are delegated to (and optionally complain if multiple exist) - simple use cases</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5974</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have 3 delegate clases:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CommonDelegate {
    def &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = &lt;span class=&quot;code-quote&quot;&gt;&quot;CommonDelegate&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CommonDelegate2 {
    def &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = &lt;span class=&quot;code-quote&quot;&gt;&quot;CommonDelegate2&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CommonDelegate3 {
    def &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = &lt;span class=&quot;code-quote&quot;&gt;&quot;CommonDelegate3&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and a class Foo:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CommonDelegate {

    @Delegate
    def CommonDelegate2 commonDelegate2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CommonDelegate2()

    @Delegate
    def CommonDelegate3 commonDelegate3 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CommonDelegate3()

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, I run this code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def Foo foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo()
println(foo.getValue())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And this prints &quot;CommonDelegate2&quot;&lt;/p&gt;

&lt;p&gt;Question is now whether @Delegate should complain about the ambiguous call to getValue() in foo.getValue() as people expect @Delegate to be type-safe&lt;/p&gt;</description>
                <environment>groovy-2.1.0 on Windows using IDEA IC123.139</environment>
        <key id="12812156">GROOVY-5974</key>
            <summary>@Delegate should support including/excluding which methods are delegated to (and optionally complain if multiple exist) - simple use cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="oliver_plow">Oliver Plow</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Feb 2013 07:53:49 +0000</created>
                <updated>Mon, 14 Oct 2013 16:53:55 +0000</updated>
                            <resolved>Thu, 29 Aug 2013 20:59:16 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.2.0-beta-2</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14474022" author="oliver_plow" created="Mon, 4 Feb 2013 07:56:12 +0000"  >&lt;p&gt;Sorry for the typo in the first line. It should be: &quot;I have 3 delegate classes:&quot;&lt;/p&gt;</comment>
                            <comment id="14474122" author="pschumacher" created="Mon, 4 Feb 2013 12:16:06 +0000"  >&lt;p&gt;Added code tags and fixed the typo mentioned by Oliver Plow.&lt;/p&gt;</comment>
                            <comment id="14480159" author="paulk" created="Mon, 4 Feb 2013 18:29:26 +0000"  >&lt;p&gt;The current doco says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If multiple delegate fields are used and the same method signature occurs&lt;br/&gt;
in more than one of the respective field types, then the delegate will be&lt;br/&gt;
made to the first defined field having that signature. If this does occur,&lt;br/&gt;
it might be regarded as a smell (or at least poor style) and it might be&lt;br/&gt;
clearer to do the delegation by long hand.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We could certainly be clearer about what would happen wrt inherited methods.&lt;/p&gt;

&lt;p&gt;In terms of improvement, we could make it stricter, though it might become less flexible unless we also allowed for more finer grained customization ala something like Project Lombok&apos;s &quot;types&quot; and &quot;excludes&quot; interface customization for its @Delegate.&lt;/p&gt;</comment>
                            <comment id="14474005" author="oliver_plow" created="Tue, 5 Feb 2013 02:11:12 +0000"  >&lt;p&gt;Something a bit more wild I have thought of is to make wrapper methods for delegate methods (methods that redirect the method call to the delegate class) selectively private or public. For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
	def &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; foo;
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar {
	@Delegate
	def &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Foo foo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo()

	def bar() {		
		setFoo(&lt;span class=&quot;code-quote&quot;&gt;&quot;hi&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// okay, since inst &lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; foo declared inside class
&lt;/span&gt;	}
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {
	def &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
		def Bar bar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Bar()
		bar.getFoo() &lt;span class=&quot;code-comment&quot;&gt;// makes sense to allow &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;?
&lt;/span&gt;	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Test.main bar.getFoo() can be called. Compiler won&apos;t complain singe the delegate wrapper method for Foo.getFoo() in class Bar was declared public just as Foo.getFoo(). But this breaks encapsualtion of my Bar class now. Inst var foo is private in Bar and hence I don&apos;t want foo to be accessible from outside class Bar.&lt;/p&gt;

&lt;p&gt;Just some point I wanted to mention which struck my mind.&lt;/p&gt;</comment>
                            <comment id="14480168" author="paulk" created="Wed, 6 Feb 2013 05:31:30 +0000"  >&lt;p&gt;Some interesting ideas but I am worried that this issue might lose focus in which case experience has shown that it is less likely that it will receive attention.&lt;/p&gt;

&lt;p&gt;Is your main concern that you would like a compile error? Is there a way we can improve the doco that would change your expectations with respect to your comment: &quot;people expect @Delegate to be type-safe&quot;? I can see the scope for potential confusion though I am not sure it is strictly a type-safety issue.&lt;/p&gt;

&lt;p&gt;Would an extra boolean parameter (perhaps &quot;strict=true&quot;) that forced a compile-time error for the case above suit your needs? Perhaps defaulting to false for backwards compatibility reasons?&lt;/p&gt;</comment>
                            <comment id="14474175" author="oliver_plow" created="Sun, 10 Feb 2013 15:49:52 +0000"  >&lt;p&gt;Hi Paul, thanks for the effort you took to deal with this matter. About type-safety: If aFoo called a private method of CommonDelegate a compile-time error would be displayed (at least in IDEA) as only a public method of CommonDelegate could be called from aFoo. Now, if there are ambiguous calls to getValue() the user would also expect the compiler to drop a note about it.&lt;/p&gt;

&lt;p&gt;About the other issue I mentioned in the sample with a class Foo and a class Bar: I found some interesting documentt about it: &lt;a href=&quot;http://ecs.victoria.ac.nz/twiki/pub/Main/TechnicalReportSeries/ECSTR11-01.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ecs.victoria.ac.nz/twiki/pub/Main/TechnicalReportSeries/ECSTR11-01.pdf&lt;/a&gt; (I managed to download it with Chrome). There it says on p.69: &quot;Embedding&lt;br/&gt;
a type publishes all of the embedded type&amp;rsquo;s public members, because GO has only two visibility scopes and GO does not provide an alternative mechanism for hiding members of embedded types.&quot;. This is exactly what I was refering to. In Go, there is apparently nothing that can be done about it. But the issue could be addressed in Groovy&apos;s @Delegate transformation &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="14474166" author="oliver_plow" created="Mon, 11 Feb 2013 03:19:32 +0000"  >&lt;p&gt;Now I found another interesting one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. This is valid Kotlin code that compiles an runs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;open trait Base
{

    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; fun base() : Unit {
        println(&lt;span class=&quot;code-quote&quot;&gt;&quot;base&quot;&lt;/span&gt;)
    }
}

open &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BaseImpl : Base {

}

open &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C() {
    fun foo() {
        println(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Derived(b : Base = BaseImpl()) : Base by b, C() {

    fun baseDerived() : Unit {
        base()
    }

}

fun main(args: Array&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;)

{
    val d = Derived()
    d.baseDerived()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It prints &quot;base&quot; to the console. Note that method base() in trait Base is declared protected. Nevertheless, it can be seen from within class Derived, where it is called from within baseDervied(). What I mean is that there is a point in allowing access to protected methods/vars. Something to think about for the @Delegate annotation. Just intended as some input &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="14480189" author="paulk" created="Mon, 11 Feb 2013 19:09:22 +0000"  >&lt;p&gt;I will try to summarise what I think you are saying:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;it would be good to have some warning or error when multiple methods with the same signature are available for delegation&lt;/li&gt;
	&lt;li&gt;it would be useful to make protected methods of delegates available as protected methods in the owner class&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Wrt (1): currently methods are not carried over to the owner class if a method already exists with the same signature - hence if the owner or one of its subclasses doesn&apos;t have a particular method and multiple delegates do, the first mentioned delegate wins. Our options would be to omit an error or warning. We tend to leave warnings in the realm of IDEs and CodeNarc style tools. So, we &lt;em&gt;could&lt;/em&gt; make this a compile-time error. This would be a breaking change and hence we would typically at least have a way to turn it on/off (e.g. strict=true). Even so, I think the strict mode would not be very flexible - there is no way to control which methods come from which interfaces, e.g. suppose I want printName from Person and printAddress from Customer assuming both classes/interfaces have both methods. You can&apos;t use order in the class to achieve the desired delegation. So I would encourage long hand in that scenario. The alternative would be to provide something like Project Lombok&apos;s types and excludes options as mentioned in an earlier comment.&lt;/p&gt;

&lt;p&gt;Wrt (2): that is certainly possible - I guess it would need to be turned on and off rather than always mandatory - so it&apos;s a case of complicating the interface for a small gain in terms of flexibility - there is a separate activity to allow traits to be defined in Groovy - my inclination is to wait and see if it addresses mixing in a protected method in this way. If it does, I would tend to leave it out of @Delegate which can then be just pure delegation.&lt;/p&gt;</comment>
                            <comment id="14474177" author="oliver_plow" created="Tue, 12 Feb 2013 04:56:48 +0000"  >&lt;p&gt;&lt;blockquote&gt;&lt;p&gt;suppose I want printName from Person and printAddress from Customer assuming both classes/interfaces have both methods. You can&apos;t use order in the class to achieve the desired delegation.&lt;/p&gt;&lt;/blockquote&gt;That&apos;s right. The user would have to resolve the ambuiguity by explicitly sending prinName and printAddress to the applicable delegate.&lt;/p&gt;

&lt;p&gt;&lt;blockquote&gt;&lt;p&gt;there is a separate activity to allow traits to be defined in Groovy - my inclination is to wait and see if it addresses mixing in a protected method in this way.&lt;/p&gt;&lt;/blockquote&gt;Would be very interested in this traits activity. Sounds cool.&lt;/p&gt;

&lt;p&gt;&lt;blockquote&gt;&lt;p&gt;If it does, I would tend to leave it out of @Delegate which can then be just pure delegation.&lt;/p&gt;&lt;/blockquote&gt;Sure, I understand you want to keep @Delegate backwards compatible.&lt;/p&gt;</comment>
                            <comment id="14474071" author="oliver_plow" created="Tue, 12 Feb 2013 05:23:38 +0000"  >&lt;p&gt;I think another issue is that multiple delegates may result in similar problems as with mutliple inheritance. So, may be a good idea not to advance too quick here. I think I will make my private clone of @Delegate and change it for my experimental needs and this issue can be closed then.&lt;/p&gt;</comment>
                            <comment id="14480155" author="paulk" created="Tue, 12 Feb 2013 22:19:39 +0000"  >&lt;p&gt;Wrt (2) above: I&apos;ll assume your request is closed.&lt;/p&gt;

&lt;p&gt;Wrt (1) I think it might be worthwhile to have filtering similar to Project Lombok anyway, so I&apos;ll leave this issue open to achieve that goal.&lt;/p&gt;

&lt;p&gt;Wrt &quot;multiple inheritance&quot;. Different languages have different solutions to mitigating against the diamond problem (see &lt;a href=&quot;http://en.wikipedia.org/wiki/Multiple_inheritance#Mitigation&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/Multiple_inheritance#Mitigation&lt;/a&gt;) so I don&apos;t see any issue here as long as it is clearly defined.&lt;/p&gt;</comment>
                            <comment id="14480173" author="paulk" created="Tue, 12 Feb 2013 22:21:16 +0000"  >&lt;p&gt;Title updated to reflect previous comment.&lt;/p&gt;</comment>
                            <comment id="14480333" author="paulk" created="Thu, 29 Aug 2013 04:36:32 +0000"  >&lt;p&gt;Created a clone to handle advanced use case - see &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6329&quot; title=&quot;@Delegate should support including/excluding which methods are delegated to (and optionally complain if multiple exist) - advanced use cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-6329&quot;&gt;&lt;del&gt;GROOVY-6329&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Advanced use cases might include introducing the following annotation parameters &lt;tt&gt;strict&lt;/tt&gt;, &lt;tt&gt;includeTypes&lt;/tt&gt;, &lt;tt&gt;excludeTypes&lt;/tt&gt;. I&apos;ll keep the simple use cases which can be handled with &lt;tt&gt;includes&lt;/tt&gt;, &lt;tt&gt;excludes&lt;/tt&gt; in this issue.&lt;/p&gt;</comment>
                            <comment id="14474879" author="paulk" created="Thu, 29 Aug 2013 20:59:16 +0000"  >&lt;p&gt;annotation parameters &lt;tt&gt;includes&lt;/tt&gt; and &lt;tt&gt;excludes&lt;/tt&gt; added.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c68n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>