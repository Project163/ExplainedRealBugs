<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:16:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5169] JsonOutput.toJson(object) is not returning expected results</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5169</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Consider the attached Groovy script. It defines two classes. Each has public properties explicitly defined. When I send the resulting objects to JsonOutput.toJson(), I expect the public properties of the object to be serialized into the JSON output. This is not working as expected. The only properties that get serialized are those created via &quot;def propName&quot; and those that seem to have getter methods (this in not actually the case).&lt;/p&gt;

&lt;p&gt;Attached is a screenshot of GroovyConsole running the attached script.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815877">GROOVY-5169</key>
            <summary>JsonOutput.toJson(object) is not returning expected results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="jsumners">James Sumners</reporter>
                        <labels>
                            <label>properties</label>
                    </labels>
                <created>Mon, 5 Dec 2011 12:38:36 +0000</created>
                <updated>Thu, 3 Feb 2022 22:35:37 +0000</updated>
                            <resolved>Fri, 14 Jan 2022 10:58:28 +0000</resolved>
                                    <version>1.8.4</version>
                    <version>2.4.1</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>JSON</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="14472108" author="roshandawrani" created="Tue, 6 Dec 2011 19:59:15 +0000"  >&lt;p&gt;Yes. I think JsonOutput.toJson(Object) should be generally in sync with object.dump(), which it is not currently.&lt;/p&gt;</comment>
                            <comment id="14472075" author="blackdrag" created="Wed, 7 Dec 2011 02:21:05 +0000"  >&lt;p&gt;@James... if you use a visibility modifier in a declaration for a property, then you actually do not declare a property, but a field only. So if you do &quot;public String bar&quot;, then you don&apos;t have a bar property, but a bar field. If you do &quot;String bar&quot;, then you get a bar property.&lt;/p&gt;</comment>
                            <comment id="14472093" author="roshandawrani" created="Wed, 7 Dec 2011 02:25:24 +0000"  >&lt;p&gt;And a private getter makes a property?&lt;/p&gt;</comment>
                            <comment id="14472137" author="roshandawrani" created="Wed, 7 Dec 2011 02:44:54 +0000"  >&lt;p&gt;Wouldn&apos;t it make sense if JsonOutput.toJson(Object) included public fields too?&lt;/p&gt;</comment>
                            <comment id="14472094" author="blackdrag" created="Wed, 7 Dec 2011 05:36:54 +0000"  >&lt;p&gt;the visibility of the getter is not included in determining if something is a property or not. &lt;/p&gt;</comment>
                            <comment id="14472174" author="guillaume" created="Wed, 7 Dec 2011 05:45:32 +0000"  >&lt;p&gt;When this was initially implemented, the idea was to use properties, not public fields or anything else.&lt;br/&gt;
Also, I think only public properties should be used for that JSON serialization.&lt;br/&gt;
So according to that logic and concern, I think with your example that foo should be serialized as {} and bar as {&quot;bar&quot;:&quot;foo&quot;} &amp;#8211; ie. only public getters used for the serialization.&lt;/p&gt;</comment>
                            <comment id="14472109" author="roshandawrani" created="Wed, 7 Dec 2011 06:14:13 +0000"  >&lt;p&gt;&amp;gt;&amp;gt; the visibility of the getter is not included in determining if something is a property or not.&lt;/p&gt;

&lt;p&gt;Didn&apos;t mean in the usual &quot;property&quot; sense. I meant outputting a private getter in a JSON looks odd (and public fields are being ignored). As Guillaume seems to agree, only public getters should be used for JSON serialization.&lt;/p&gt;</comment>
                            <comment id="14472138" author="jsumners" created="Wed, 7 Dec 2011 07:36:18 +0000"  >&lt;p&gt;From &lt;a href=&quot;http://groovy.codehaus.org/Groovy+Beans&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy.codehaus.org/Groovy+Beans&lt;/a&gt; &amp;#8211; &quot;In Groovy, fields and properties have been merged so that they act and look the same.&quot;&lt;/p&gt;

&lt;p&gt;Given that statement, I still think these objects should serialize as I outlined.&lt;/p&gt;</comment>
                            <comment id="14473351" author="bhatt.umang7" created="Sun, 14 Oct 2012 13:18:27 +0000"  >&lt;p&gt;probably(i am not sure) we need to do changes in MetaClassImpl.java.&lt;/p&gt;

&lt;p&gt;I have made some changes and its working with me(its giving output as Mr. James said).&lt;/p&gt;

&lt;p&gt;what am i supposed to do now? to whom do i need to submit the change for review ?&lt;/p&gt;

&lt;p&gt;how do i run the test cases ? to whom i need to send the patch ?&lt;/p&gt;</comment>
                            <comment id="14473312" author="blackdrag" created="Sun, 14 Oct 2012 15:43:05 +0000"  >&lt;p&gt;you can attach the patch here. It would help to check if the test can be applied to the code base without any test failing.&lt;/p&gt;</comment>
                            <comment id="14473847" author="pschumacher" created="Fri, 18 Jan 2013 14:24:43 +0000"  >&lt;p&gt;@umang bhatt:&lt;br/&gt;
Could you attach your patch?&lt;/p&gt;</comment>
                            <comment id="14473947" author="bhatt.umang7" created="Thu, 24 Jan 2013 03:24:35 +0000"  >&lt;p&gt;I am a beginner so please review my code. Also i have not run any tests yet. &lt;/p&gt;

&lt;p&gt;I have changed  public List&amp;lt;MetaProperty&amp;gt; getProperties() method. &lt;/p&gt;

&lt;p&gt;I have tried fixing the issue. The order is a little different than what is desired.&lt;br/&gt;
I can change the behavior as you say(eg include the value that we get from the getter/accesor method).&lt;/p&gt;</comment>
                            <comment id="14473830" author="bhatt.umang7" created="Thu, 24 Jan 2013 03:27:34 +0000"  >&lt;p&gt;I have attached the file that contains changes. I have also attached a screenshot.&lt;/p&gt;</comment>
                            <comment id="14473854" author="blackdrag" created="Thu, 24 Jan 2013 03:48:46 +0000"  >&lt;p&gt;Please always create a minimal patch file, just attaching the new file does not help much in judging if the change should be done or not. I created the patch for you, plus made some formatting changes to minimize the patch&lt;/p&gt;</comment>
                            <comment id="14473930" author="bhatt.umang7" created="Thu, 24 Jan 2013 04:03:10 +0000"  >&lt;p&gt;patch&lt;/p&gt;</comment>
                            <comment id="14474055" author="blackdrag" created="Thu, 24 Jan 2013 04:04:00 +0000"  >&lt;p&gt;Part of the patch is puzzling me before we had (!setter &amp;amp;&amp;amp; !getter) to filter out properties that are in fact fields and thus have neither getter or setter. What is kept are read- or write-only properties. With your (!setter || !getter) those are removed as well. I can understand from the JSON perspective, but for getProperties this looks wrong. &lt;/p&gt;

&lt;p&gt;Next is the element.getModifiers() != 1, which seems to be there to filter out all non public fields. Since we filtered out all fields before already, thus is surely ok in principle, but you don&apos;t do something like that for MetaBeanProperties. They can be protected or package private as well imho. Why should getProperties show a protected MetaBeanProperty, but not a protected CachedField?&lt;/p&gt;

&lt;p&gt;My Conclusion:&lt;br/&gt;
Changing getProperties to return many more is a potentially breaking change, so it surely wouldn&apos;t go into 1.8.x or 2.0.x. I think for 2.1.x it is too late. We have to investigate though how that method is used before we can say that it goes into 2.2, otherwise the next possible version would be 3.0 only. I would suggest finding another way to tackle the problem and keep the changes to the json classes itself if possible.&lt;/p&gt;</comment>
                            <comment id="14474013" author="bhatt.umang7" created="Thu, 24 Jan 2013 04:09:59 +0000"  >&lt;p&gt;ok.&lt;br/&gt;
1. I would try to make changes in json related class, should it be fine ?&lt;br/&gt;
2. Do i need to change the behavior(output) in any way ? Or this is fine ?&lt;/p&gt;
</comment>
                            <comment id="14474036" author="guillaume" created="Thu, 24 Jan 2013 05:00:17 +0000"  >&lt;p&gt;First of all, before doing any further change to your patch, let&apos;s agree on what should be serialized or not.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;public properties: Yes (ie. both final and non final)&lt;/li&gt;
	&lt;li&gt;public fields: Yes (both final and non final)&lt;/li&gt;
	&lt;li&gt;static properties, static fields, whether public, protected or private: No&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14473858" author="bhatt.umang7" created="Thu, 24 Jan 2013 07:24:58 +0000"  >&lt;p&gt;here is a new patch that does the same thing by adding a method in JsonOutput class&lt;/p&gt;</comment>
                            <comment id="14473949" author="blackdrag" created="Thu, 24 Jan 2013 08:07:09 +0000"  >&lt;p&gt;hmm... CachedField is only an internal representation for fields. That means the patch should include only fields that are public. But the usual property is one with getter and setter and private field. In the json_test.groovy attached above this would imho mean that Bar#bar is excluded since it is a property backed by a private field. &lt;/p&gt;

&lt;p&gt;Also there is the question to answer if a property that consists only of a getter or setter and no field should be included. And dynamically added properties are up to discussion as well I think.&lt;/p&gt;</comment>
                            <comment id="14473978" author="jsumners" created="Thu, 24 Jan 2013 09:45:01 +0000"  >&lt;p&gt;&quot;Also there is the question to answer if a property that consists only of a getter or setter and no field should be included. And dynamically added properties are up to discussion as well I think.&quot;&lt;/p&gt;

&lt;p&gt;When I originally filed the bug, and this still hold true for me, I assumed that the instance of the object would be serialized in such a fashion that it could be recreated from the JSON. That would imply dynamically added properties should be included in the serialization. Otherwise, what are you serializing?&lt;/p&gt;</comment>
                            <comment id="14473857" author="blackdrag" created="Thu, 24 Jan 2013 12:45:46 +0000"  >&lt;p&gt;but if you want this to recreate the object afterwards, then read-only-properties are going to be a problem for you - plus dynamically added properties will only be available if they have been added on the deserialization side as well.&lt;/p&gt;</comment>
                            <comment id="14473994" author="jsumners" created="Thu, 24 Jan 2013 13:44:28 +0000"  >&lt;p&gt;Well, since Groovy doesn&apos;t deserialize JSON to an object anyway (that I can tell) that&apos;s a moot point. It would be left up to the deserializer as to how to handle that.&lt;/p&gt;</comment>
                            <comment id="14473832" author="jsumners" created="Thu, 24 Jan 2013 13:49:08 +0000"  >&lt;p&gt;By the way, back when I filed this bug I ended up resorting to some ridiculousness to get around it &amp;#8211; &lt;a href=&quot;http://stackoverflow.com/questions/7853809/iterating-an-objects-own-properties-in-groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/7853809/iterating-an-objects-own-properties-in-groovy&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476148" author="richardhightower" created="Mon, 21 Jul 2014 14:58:31 +0000"  >&lt;p&gt;I am lost in the comment stream. What works? What is broken?&lt;/p&gt;</comment>
                            <comment id="16314906" author="bhatt.umang7" created="Sat, 6 Jan 2018 21:06:24 +0000"  >&lt;p&gt;Although years have passed by, trying this one more time. Please bear with me. Attaching one more diff with recent changes. Can you please help me make it correct (0002_patch.txt)? The code now does not affect everything else, change is local to Json.&lt;/p&gt;

&lt;p&gt;Thank you so much for your help in advance.&lt;/p&gt;</comment>
                            <comment id="17468832" author="emilles" created="Tue, 4 Jan 2022 20:24:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/pull/1670/commits/f6ab340292465749edac4dec377fe526aded8d28&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1670/commits/f6ab340292465749edac4dec377fe526aded8d28&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/pull/1670/commits/8811fcdbdf6a11c43f7c09a81105a2227f9fddc2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1670/commits/8811fcdbdf6a11c43f7c09a81105a2227f9fddc2&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13422725">GROOVY-10449</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13420631">GROOVY-10438</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12722379" name="0001-bugfix.patch" size="2348" author="bhatt.umang7" created="Thu, 24 Jan 2013 07:39:01 +0000"/>
                            <attachment id="12904959" name="0002_patch.txt" size="1633" author="bhatt.umang7" created="Sat, 6 Jan 2018 21:06:44 +0000"/>
                            <attachment id="12722983" name="GroovyConsole_output.png" size="281754" author="jsumners" created="Mon, 5 Dec 2011 12:38:37 +0000"/>
                            <attachment id="12723120" name="MetaClassImpl.java" size="154644" author="bhatt.umang7" created="Thu, 24 Jan 2013 04:03:10 +0000"/>
                            <attachment id="12722655" name="MetaClassImpl.patch" size="2060" author="blackdrag" created="Thu, 24 Jan 2013 03:48:46 +0000"/>
                            <attachment id="12722594" name="json_test.groovy" size="802" author="jsumners" created="Mon, 5 Dec 2011 12:38:37 +0000"/>
                            <attachment id="12722656" name="screenshot.png" size="68880" author="bhatt.umang7" created="Thu, 24 Jan 2013 03:24:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2btfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>