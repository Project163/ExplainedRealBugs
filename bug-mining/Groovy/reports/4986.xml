<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:27:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11666] Incremental compilation in groovyc Ant task is not working properly</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11666</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given this small MCVE:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-none&quot;&gt;
./build.xml
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;project name=&quot;foo&quot; xmlns:groovy=&quot;antlib:org.codehaus.groovy.ant&quot; xmlns:ivy=&quot;antlib:org.apache.ivy.ant&quot;&amp;gt;
    &amp;lt;property name=&quot;config.ivy.version&quot; value=&quot;2.2.0&quot;/&amp;gt;
    &amp;lt;property name=&quot;lib.dir&quot; location=&quot;build/libs&quot;/&amp;gt;
    &amp;lt;property name=&quot;ivy.jar.dir&quot; location=&quot;${lib.dir}/ivy&quot;/&amp;gt;
    &amp;lt;property name=&quot;ivy.jar.filename&quot; value=&quot;ivy-${config.ivy.version}.jar&quot;/&amp;gt;
    &amp;lt;property name=&quot;ivy.jar.file&quot; location=&quot;${ivy.jar.dir}/${ivy.jar.filename}&quot;/&amp;gt;

    &amp;lt;target name=&quot;check-ivy&quot;&amp;gt;
        &amp;lt;available property=&quot;ivy.jar.present&quot;
                   file=&quot;${ivy.jar.file}&quot;
                   type=&quot;file&quot;/&amp;gt;
    &amp;lt;/target&amp;gt;

    &amp;lt;target name=&quot;download-ivy&quot; depends=&quot;check-ivy&quot; unless=&quot;ivy.jar.present&quot;&amp;gt;
        &amp;lt;mkdir dir=&quot;${ivy.jar.dir}&quot;/&amp;gt;
        &amp;lt;get src=&quot;https://repo.maven.apache.org/maven2/org/apache/ivy/ivy/${config.ivy.version}/ivy-${config.ivy.version}.jar&quot; dest=&quot;${ivy.jar.file}&quot; usetimestamp=&quot;true&quot;/&amp;gt;
    &amp;lt;/target&amp;gt;

    &amp;lt;target name=&quot;init-ivy&quot; depends=&quot;download-ivy&quot; unless=&quot;ivy.done&quot;&amp;gt;
        &amp;lt;property name=&quot;ivy.retrieve.pattern&quot; value=&quot;${lib.dir}/[conf]/[artifact](-[classifier]).[ext]&quot;/&amp;gt;
        &amp;lt;taskdef resource=&quot;org/apache/ivy/ant/antlib.xml&quot; classpath=&quot;${ivy.jar.file}&quot; loaderref=&quot;ivy.loader&quot; uri=&quot;antlib:org.apache.ivy.ant&quot;/&amp;gt;
    &amp;lt;/target&amp;gt;

    &amp;lt;target name=&quot;retrieve&quot; description=&quot;retrieve the dependencies&quot; depends=&quot;init-ivy&quot; unless=&quot;ivy.done&quot;&amp;gt;
        &amp;lt;ivy:retrieve sync=&quot;true&quot;/&amp;gt;
        &amp;lt;ivy:retrieve pattern=&quot;${lib.dir}/ivy/[artifact]-[revision].[ext]&quot; organisation=&quot;org.apache.ivy&quot; module=&quot;ivy&quot; revision=&quot;${config.ivy.version}&quot; conf=&quot;default&quot; inline=&quot;true&quot;/&amp;gt;
        &amp;lt;property name=&quot;ivy.done&quot; value=&quot;true&quot;/&amp;gt;
    &amp;lt;/target&amp;gt;

    &amp;lt;target name=&quot;compile&quot; depends=&quot;retrieve&quot;&amp;gt;
        &amp;lt;mkdir dir=&quot;build/classes/main&quot;/&amp;gt;
        &amp;lt;taskdef resource=&quot;org/codehaus/groovy/antlib.xml&quot; uri=&quot;antlib:org.codehaus.groovy.ant&quot;&amp;gt;
            &amp;lt;classpath&amp;gt;
                &amp;lt;fileset dir=&quot;${lib.dir}/groovy-ant&quot; includes=&quot;*.jar&quot;/&amp;gt;
            &amp;lt;/classpath&amp;gt;
        &amp;lt;/taskdef&amp;gt;
        &amp;lt;groovy:groovyc srcdir=&quot;src&quot; destdir=&quot;build/classes/main&quot;&amp;gt;
            &amp;lt;classpath&amp;gt;
                &amp;lt;fileset dir=&quot;${lib.dir}/compile&quot; includes=&quot;*.jar&quot;/&amp;gt;
            &amp;lt;/classpath&amp;gt;
        &amp;lt;/groovy:groovyc&amp;gt;
    &amp;lt;/target&amp;gt;
&amp;lt;/project&amp;gt;

./ivy.xml
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;ivy-module version=&quot;2.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;https://ant.apache.org/ivy/schemas/ivy.xsd&quot;&amp;gt;
    &amp;lt;info organisation=&quot;foo&quot; module=&quot;foo&quot;/&amp;gt;

    &amp;lt;configurations&amp;gt;
        &amp;lt;conf name=&quot;compile&quot; description=&quot;Compile dependencies&quot; visibility=&quot;private&quot; transitive=&quot;false&quot;/&amp;gt;
        &amp;lt;conf name=&quot;groovy-ant&quot; description=&quot;Dependencies for Groovy Ant tasks&quot; visibility=&quot;private&quot;/&amp;gt;
    &amp;lt;/configurations&amp;gt;

    &amp;lt;dependencies defaultconfmapping=&quot;%-&amp;gt;default&quot;&amp;gt;
        &amp;lt;dependency org=&quot;org.apache.groovy&quot; name=&quot;groovy&quot; rev=&quot;4.0.26&quot; conf=&quot;compile&quot;/&amp;gt;
        &amp;lt;dependency org=&quot;org.apache.groovy&quot; name=&quot;groovy-ant&quot; rev=&quot;4.0.26&quot; conf=&quot;groovy-ant&quot;/&amp;gt;
        &amp;lt;dependency org=&quot;org.apache.groovy&quot; name=&quot;groovy-groovydoc&quot; rev=&quot;4.0.26&quot; conf=&quot;groovy-ant&quot;/&amp;gt;
    &amp;lt;/dependencies&amp;gt;
&amp;lt;/ivy-module&amp;gt;

./src/Bar.groovy
class Bar {
   def foo = new Foo()
}

./src/Foo.groovy
class Foo {
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you now do &lt;tt&gt;ant compile&lt;/tt&gt;, everything works just fine.&lt;br/&gt;
Now modify only the class &lt;tt&gt;Bar&lt;/tt&gt; in some way (that does not remove the reference to &lt;tt&gt;Foo&lt;/tt&gt;).&lt;br/&gt;
And now run &lt;tt&gt;ant compile&lt;/tt&gt; again.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;groovyc&lt;/tt&gt; task wants to be nice and only compile the changed &lt;tt&gt;Bar&lt;/tt&gt; class, but it fails with &lt;tt&gt;2: unable to resolve class Foo&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;groovyc&lt;/tt&gt; task should probably automatically contain its destination directory in the classpath to fix this.&lt;/p&gt;

&lt;p&gt;This is also the work-around I am using, by adding &lt;tt&gt;&amp;lt;pathelement location=&quot;build/classes/main&quot;/&amp;gt;&lt;/tt&gt; inside the &lt;tt&gt;&amp;lt;classpath&amp;gt;&lt;/tt&gt;.&lt;br/&gt;
This makes the incremental compiling work as expected as now the previously compiled classes are part of the classpath and can be found.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13618228">GROOVY-11666</key>
            <summary>Incremental compilation in groovyc Ant task is not working properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="vampire">Bj&#246;rn Kautler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 May 2025 14:59:37 +0000</created>
                <updated>Thu, 17 Jul 2025 21:47:20 +0000</updated>
                            <resolved>Thu, 17 Jul 2025 21:47:20 +0000</resolved>
                                    <version>4.0.26</version>
                                    <fixVersion>5.0.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17951849" author="emilles" created="Thu, 15 May 2025 18:07:25 +0000"  >&lt;p&gt;Have you tested this scenario with &lt;tt&gt;javac&lt;/tt&gt;?  Most behavior is modeled after that.  In fact it can be embedded for joint compilation, so we want to stay in alignment.&lt;/p&gt;</comment>
                            <comment id="17951909" author="vampire" created="Thu, 15 May 2025 20:45:10 +0000"  >&lt;p&gt;I did not, but tried now. &lt;br/&gt;
Works like expected. &lt;br/&gt;
It says on second run that it compiles one file and it is successful.&lt;/p&gt;</comment>
                            <comment id="18007828" author="emilles" created="Thu, 17 Jul 2025 14:03:54 +0000"  >&lt;p&gt;Thanks for checking.  In fact, looking at the documentation, this seems to be stated from the very start: &quot;The source and destination directory will be recursively scanned for Java source files to compile. Only .java files that have no corresponding .class file or where the .class file is older than the .java file will be compiled.&quot;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ant.apache.org/manual/Tasks/javac.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ant.apache.org/manual/Tasks/javac.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18007836" author="vampire" created="Thu, 17 Jul 2025 14:21:37 +0000"  >&lt;p&gt;That is what is happening and is what is expected.&lt;br/&gt;
The unexpected part is, that it does not use the class files of the destination directory as compile classpath. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="18007887" author="emilles" created="Thu, 17 Jul 2025 17:32:33 +0000"  >&lt;p&gt;It seems the relevant setting is this one:&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13077542/13077542_screenshot-1.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.groovy-lang.org/latest/html/documentation/groovyc-ant-task.html#groovyc-ant-task-using&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.groovy-lang.org/latest/html/documentation/groovyc-ant-task.html#groovyc-ant-task-using&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18007902" author="emilles" created="Thu, 17 Jul 2025 18:47:23 +0000"  >&lt;p&gt;I have created a test case from your example.  However, when running incremental compilation, I am seeing that &lt;tt&gt;ResolveVisitor#resolveToOuter&lt;/tt&gt; is delegating to the &lt;tt&gt;ClassNodeResolver&lt;/tt&gt; and it is picking up the class file for Foo from the destination directory.&lt;/p&gt;

&lt;p&gt;So, I can add the destination directory to the classpath, but I do not have a test that ensures this is effective.&lt;/p&gt;</comment>
                            <comment id="18007910" author="vampire" created="Thu, 17 Jul 2025 20:16:57 +0000"  >&lt;p&gt;Hm, indeed it sounds like it should work by default but could be disabled.&lt;br/&gt;
But I did not do that. :-/&lt;/p&gt;</comment>
                            <comment id="18007915" author="emilles" created="Thu, 17 Jul 2025 21:03:27 +0000"  >&lt;p&gt;I think I figured it out.  The Ant runtime includes all the build input and output directories.  The test script uses the same output directory for &lt;tt&gt;destDir&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="18007918" author="vampire" created="Thu, 17 Jul 2025 21:22:21 +0000"  >&lt;p&gt;I don&apos;t understand what that means and why that means that `includeDestClasses` is not doing what it is supposed to do, but I&apos;m glad that you made some progress. :-D&lt;/p&gt;</comment>
                            <comment id="18007922" author="emilles" created="Thu, 17 Jul 2025 21:47:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/5ac33ade3f77a281ec57c8469d4a5979a08f1c50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/5ac33ade3f77a281ec57c8469d4a5979a08f1c50&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13077542" name="screenshot-1.png" size="19299" author="emilles" created="Thu, 17 Jul 2025 17:32:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vvdk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>