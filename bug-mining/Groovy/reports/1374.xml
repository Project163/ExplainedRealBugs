<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:17:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4449] Vararg parameter allowed in non-last position but fails at runtime</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4449</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Groovy doesn&apos;t give an error when a vararg parameter doesn&apos;t come last in a parameter list, but then fails at runtime when the method is called in vararg-style. For example, the following code...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;... strs, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) { println i }
foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;me&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;you&quot;&lt;/span&gt;, 42)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...produces:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;groovy.lang.MissingMethodException: No signature of method: ConsoleScript11.foo() is applicable for argument types: (java.lang.String, java.lang.String, java.lang.Integer) values: [me, you, 42]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I assume the underlying reason is that groovyc currently simply treats String... as syntactic sugar for String[], without any further checks.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815320">GROOVY-4449</key>
            <summary>Vararg parameter allowed in non-last position but fails at runtime</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="pniederw">Peter Niederwieser</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Sep 2010 07:32:47 +0000</created>
                <updated>Wed, 15 Dec 2010 16:56:59 +0000</updated>
                            <resolved>Fri, 1 Oct 2010 13:53:21 +0000</resolved>
                                    <version>1.7.5</version>
                                    <fixVersion>1.7.6</fixVersion>
                    <fixVersion>1.8-beta-3</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14470127" author="pniederw" created="Thu, 30 Sep 2010 08:09:55 +0000"  >&lt;p&gt;Similar problem exists when vararg parameter is followed by an optional parameter:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;... strs, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0) { println i}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Calling this method in vararg-style only works if no value is given for i.&lt;/p&gt;</comment>
                            <comment id="14470211" author="roshandawrani" created="Fri, 1 Oct 2010 07:25:31 +0000"  >&lt;p&gt;Attaching a patch that disallows a var-arg parameter if it is not the last one.&lt;/p&gt;</comment>
                            <comment id="14470162" author="blackdrag" created="Fri, 1 Oct 2010 08:09:25 +0000"  >&lt;p&gt;hmmm... I find a bit troublesome to have a change to the AST, just to find an error in APP, which creates the AST. We should look for a more local change I think&lt;/p&gt;</comment>
                            <comment id="14470126" author="roshandawrani" created="Fri, 1 Oct 2010 09:01:01 +0000"  >&lt;p&gt;Actually I could have made the change local to APP to begin with but I was surprised to see that AST does not retain this information at all that a method parameter was syntactically marked as var-arg.&lt;/p&gt;

&lt;p&gt;Later on in the compilation cycle, it goes by the last parameter being an array to determine whether it is a var-arg method, which is not really so reliable, is it?&lt;/p&gt;

&lt;p&gt;If we retain this information in AST, it will have support for differentiating between the cases where a parameter was marked as String... vs String[]. Now that people integrated with groovy at AST level, it could of use to some, if not all. So, that was the intention behind adding that info to Parameter. Of-course the change can be made local to APP and AST be left as is.&lt;/p&gt;

&lt;p&gt;Your call.&lt;/p&gt;</comment>
                            <comment id="14470236" author="pniederw" created="Fri, 1 Oct 2010 09:33:58 +0000"  >&lt;p&gt;I have nothing against extending the AST (in fact I think that some of the newer Groovy features have too little AST representation), but I&apos;d like to bring up one lesson here that I recently learned the hard way: Because Groovy doesn&apos;t provide a standard way to copy an AST node (say with a copy method), it&apos;s very dangerous to introduce new fields. Not only do you have to find all locations in the Groovy codebase where the AST node is manually copied (which isn&apos;t too difficult), but chances are that external AST transforms will also manually copy the AST node. Such transforms will continue to compile after a new field is introduced, but their usage will lead to the field&apos;s value getting lost. This can lead to bugs that are extremely hard to find.&lt;br/&gt;
I should probably make a separate issue for this, but I thought I&apos;d mention it here.&lt;/p&gt;

&lt;p&gt;By the way, here is some AST information that I&apos;ve missed in the past (for Spock and other stuff):&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Is the method name in this method definition given as a string literal?&lt;/li&gt;
	&lt;li&gt;Is the method name in this method invocation given as a string literal?&lt;/li&gt;
	&lt;li&gt;Did the method caller pass named arguments or a map? (this one I actually needed at runtime, for a DSL)&lt;/li&gt;
	&lt;li&gt;What&apos;s the (exact) source code for this AST node?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14470249" author="blackdrag" created="Fri, 1 Oct 2010 09:58:56 +0000"  >&lt;p&gt;from the Groovy side saying a varg is a method that has as last parameter an array is exactly that what it should be. For Groovy there is no difference between String[] and String... as last parameter. The only reason I did not close this as a Won&apos;t Fix is, that people coming from Java would maybe be too perplexed by seeing a String... in the middle of a method signature. &lt;/p&gt;

&lt;p&gt;As for Peter&apos;s questions... &lt;/p&gt;

&lt;p&gt;the first two are easily solvable I think. The problem is more the one of a use case and a test confirming the issue according to the use case. I never had use to know if it is a String based version or a normal name.&lt;/p&gt;

&lt;p&gt;&quot;Did the method caller pass named arguments or a map?&quot; This is too is probably not too difficult to solve... Instead of using a normal Map we can use a special Map sub class. A simple instanceof in the method can then show what it was.&lt;/p&gt;

&lt;p&gt;&quot;What&apos;s the (exact) source code for this AST node?&quot; that is actually more difficult I think and I have no real answer to this.&lt;/p&gt;</comment>
                            <comment id="14470093" author="roshandawrani" created="Fri, 1 Oct 2010 12:24:24 +0000"  >&lt;p&gt;For it to be marked as &quot;Won&apos;t Fix&quot;, the feature needs to be not half-baked, but full. If it only compiles but doesn&apos;t work at runtime, there is something to be &quot;fixed&quot; - one way or other.&lt;/p&gt;

&lt;p&gt;Since no value is seen in maintaining in the &quot;String... vs String[]&quot; info in AST, I am making the change local to APP to disallow var-arg if not the last parameter.&lt;/p&gt;</comment>
                            <comment id="14470144" author="roshandawrani" created="Fri, 1 Oct 2010 13:53:22 +0000"  >&lt;p&gt;Fixed. Compiler now rejects a var-arg parameter if it is not in the last position.&lt;/p&gt;

&lt;p&gt;Any other valid but unrelated requirements that have been discussed here, please take them forward on mailing-list/separate issue(s).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722456" name="4449_v17x.diff" size="4181" author="roshandawrani" created="Fri, 1 Oct 2010 07:25:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ctpb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>