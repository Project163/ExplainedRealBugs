<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:15:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4058] Unexpected compilation error with MapEntryExpression usage - groovy grammar issue?</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4058</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code compiles fine:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.concurrent.*
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {
    def bar () {
        ExecutorService pool = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        pool.submit(( &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; ) [ run : { &lt;span class=&quot;code-quote&quot;&gt;&quot;some statement&quot;&lt;/span&gt;; 
            &lt;span class=&quot;code-comment&quot;&gt;//println &lt;span class=&quot;code-quote&quot;&gt;&quot;fishy print&quot;&lt;/span&gt;
&lt;/span&gt;        }])
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But if I uncomment the print statement from inside the closure, like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.concurrent.*
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {
    def bar () {
        ExecutorService pool = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        pool.submit(( &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; ) [ run : { &lt;span class=&quot;code-quote&quot;&gt;&quot;some statement&quot;&lt;/span&gt;; 
            println &lt;span class=&quot;code-quote&quot;&gt;&quot;fishy print&quot;&lt;/span&gt;
        }])
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I get the following compilation error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;...\Try.groovy: 5: You tried to use a map entry for an index operation, this is not allowed. Maybe something should be set in parentheses or a comma is missing?
 @ line 5, column 36.
           pool.submit(( Runnable ) [ run : { &quot;some statement&quot;; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is the AST formed in 2 cases (2nd case has the wrong AST)&lt;/p&gt;

&lt;p&gt;Case 1: (Successful compilation)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ArgumentListExpression[
    CastExpression[
        (java.lang.Runnable) 
            MapExpression[
                MapEntryExpression(key: ConstantExpression[run], value: ClosureExpression[]{...}
                )
            ]
    ]
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Case 2: (Failing compilation)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ArgumentListExpression[
    BinaryExpression[
        left = ClassExpression[type: java.lang.Runnable]
        operation = &quot;[&quot;
        right = MapEntryExpression(key: ConstantExpression[run], value: ClosureExpression[]{...})]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12814851">GROOVY-4058</key>
            <summary>Unexpected compilation error with MapEntryExpression usage - groovy grammar issue?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ait">Alex Tkachman</assignee>
                                    <reporter username="roshandawrani">Roshan Dawrani</reporter>
                        <labels>
                    </labels>
                <created>Sun, 14 Feb 2010 21:19:16 +0000</created>
                <updated>Wed, 7 Apr 2010 23:45:14 +0000</updated>
                            <resolved>Tue, 30 Mar 2010 02:22:03 +0000</resolved>
                                    <version>1.8-beta-1</version>
                                    <fixVersion>1.7.2</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14468946" author="roshandawrani" created="Sun, 14 Feb 2010 22:34:14 +0000"  >&lt;p&gt;I am wondering whether in indexPropertyArgs() rule, &lt;span class=&quot;error&quot;&gt;&amp;#91;key : value&amp;#93;&lt;/span&gt; should not be matched.&lt;/p&gt;

&lt;p&gt;Does it make sense in any case to have a &lt;span class=&quot;error&quot;&gt;&amp;#91;x : ...&amp;#93;&lt;/span&gt; in the subscript operation?&lt;/p&gt;</comment>
                            <comment id="14479025" author="paulk" created="Tue, 30 Mar 2010 08:59:57 +0000"  >&lt;p&gt;It would be nicer if we had a solution to this problem at the grammar level but that&apos;s a much harder fix. So, I have added a test in the meantime - if we can refactor at some point at least we shouldn&apos;t have this particular regression.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cnhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>