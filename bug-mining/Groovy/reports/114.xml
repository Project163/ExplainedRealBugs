<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:55:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-426] Infinite loop for n = []; println n[-1];</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-426</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;n = []&lt;br/&gt;
println n&lt;span class=&quot;error&quot;&gt;&amp;#91;-1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;causes a (seamingly) infinite loop&lt;/p&gt;</description>
                <environment>Mac OS X Panther 11.3, JDK 1.4.2</environment>
        <key id="12812562">GROOVY-426</key>
            <summary>Infinite loop for n = []; println n[-1];</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spullara">Sam Pullara</assignee>
                                    <reporter username="jamiemc">Jamie McCrindle</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Apr 2004 18:19:08 +0000</created>
                <updated>Sun, 23 May 2004 16:38:12 +0000</updated>
                            <resolved>Sun, 23 May 2004 16:38:12 +0000</resolved>
                                                    <fixVersion>1.0-beta-6</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14460386" author="alexeyv" created="Thu, 13 May 2004 18:28:26 +0000"  >&lt;p&gt;The culprit here is this piece of code in DefaultRubyMethods.&lt;br/&gt;
This algorythm goes into an endless loop when size = 0 (empty array) and i &amp;lt; 0.&lt;/p&gt;

&lt;p&gt;    protected static int normaliseIndex(int i, int size) {&lt;br/&gt;
        while (i &amp;lt; 0) &lt;/p&gt;
{
            i += size;
        }
&lt;p&gt;        return i;&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;In other cases, it also leads to unintuitive results, such as &lt;/p&gt;

&lt;p&gt;n&lt;span class=&quot;error&quot;&gt;&amp;#91;-15&amp;#93;&lt;/span&gt; == n&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; &lt;br/&gt;
if n is a list (or array) of 10 elements&lt;/p&gt;

&lt;p&gt;Groovy lists are sparse. I.e., if n has one element, n&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; == null, and can be assigned. What should be a behavior for negative indices then? Ruby behaves like this:&lt;/p&gt;

&lt;p&gt;irb(main):001:0&amp;gt; n = []&lt;br/&gt;
=&amp;gt; []&lt;br/&gt;
irb(main):002:0&amp;gt; n&lt;span class=&quot;error&quot;&gt;&amp;#91;-1&amp;#93;&lt;/span&gt;&lt;br/&gt;
=&amp;gt; nil&lt;br/&gt;
irb(main):003:0&amp;gt; n&lt;span class=&quot;error&quot;&gt;&amp;#91;-1&amp;#93;&lt;/span&gt; = 2&lt;br/&gt;
IndexError: index -1 out of array&lt;br/&gt;
        from (irb):3:in `[]=&apos;&lt;br/&gt;
        from (irb):3&lt;/p&gt;

&lt;p&gt;And also:&lt;/p&gt;

&lt;p&gt;irb(main):005:0&amp;gt; n = (1..5).to_a&lt;br/&gt;
=&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5&amp;#93;&lt;/span&gt;&lt;br/&gt;
irb(main):006:0&amp;gt; n&lt;span class=&quot;error&quot;&gt;&amp;#91;-15&amp;#93;&lt;/span&gt;&lt;br/&gt;
=&amp;gt; nil&lt;br/&gt;
irb(main):007:0&amp;gt; n&lt;span class=&quot;error&quot;&gt;&amp;#91;-15&amp;#93;&lt;/span&gt; = 2&lt;br/&gt;
IndexError: index -15 out of array&lt;br/&gt;
        from (irb):7:in `[]=&apos;&lt;br/&gt;
        from (irb):7&lt;/p&gt;

&lt;p&gt;I guess it should be same in Groovy. &lt;br/&gt;
Not sure how to fix this. Maybe like this:&lt;/p&gt;

&lt;p&gt;    protected static int normaliseIndex(int i, int size) {&lt;br/&gt;
        if (i &amp;lt; 0) {&lt;br/&gt;
            if (-i &amp;gt; size) &lt;/p&gt;
{
                throw new IndexOutOfBoundsException(&quot;SUITABLE MESSAGE&quot;);
            }
&lt;p&gt; else &lt;/p&gt;
{
                return (i + size)
            }
&lt;p&gt;        } else &lt;/p&gt;
{
            return i;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;Clients of this method should then catch this exception and return null if they are doing a read access, or just pass the exception up the stack, if it is an assignment.&lt;/p&gt;</comment>
                            <comment id="14460216" author="spullara" created="Sun, 23 May 2004 16:38:12 +0000"  >&lt;p&gt;FIX &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-426&quot; title=&quot;Infinite loop for n = []; println n[-1];&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-426&quot;&gt;&lt;del&gt;GROOVY-426&lt;/del&gt;&lt;/a&gt;: If your negative index is out of bounds, you will now get an exception instead of a strange wrapping behavior or an infinite loop.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bsaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>