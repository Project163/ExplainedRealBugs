<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:04:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9120] Anonymous class enclosing reference broken in 2.5.7</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9120</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Follow up ticket of &quot;2.5.7 regression with references?&quot; mail.&lt;/p&gt;

&lt;p&gt;Using a ref defined outside an anonymous class frol the inner class is considered typed as &quot;Reference&quot; making it impossible to use in any java method now. It was working fine in 2.5.6.&lt;/p&gt;

&lt;p&gt;There is an example referenced in the dev list mail but it should be straight forward to reproduce.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13232819">GROOVY-9120</key>
            <summary>Anonymous class enclosing reference broken in 2.5.7</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="romain.manni-bucau">Romain Manni-Bucau</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 May 2019 17:03:51 +0000</created>
                <updated>Thu, 9 Apr 2020 21:38:23 +0000</updated>
                            <resolved>Thu, 9 Apr 2020 15:33:22 +0000</resolved>
                                    <version>2.5.7</version>
                    <version>2.5.8</version>
                                    <fixVersion>2.5.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16962077" author="emilles" created="Tue, 29 Oct 2019 14:53:18 +0000"  >&lt;p&gt;Can you include an example that reproduces the issue?  It is difficult to follow trail into mailing list and be sure we have understood properly.&lt;/p&gt;</comment>
                            <comment id="17006231" author="alexkazakov90" created="Tue, 31 Dec 2019 21:27:47 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt;, I found the same issue. Here is my example.&lt;br/&gt;
 Working in 2.5.6, not working in 2.5.7 and 2.5.8&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.function.Supplier

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ReproduceBug {
    &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Module {
        &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; runnable()
        Supplier&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; numberSupplier()
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Module newModule() {
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; number = 1

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Module() {

            @Override
            &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; runnable() {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; {
                    println(&lt;span class=&quot;code-quote&quot;&gt;&quot;number is ${number}&quot;&lt;/span&gt;)
                }
            }

            @Override
            Supplier&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; numberSupplier() {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; { number }
            }
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        def module = newModule()
        println(&lt;span class=&quot;code-quote&quot;&gt;&apos;number is &apos;&lt;/span&gt; + module.numberSupplier().get())
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;version 2.5.6 prints&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;number is 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;versions 2.5.7 and 2.5.8 print&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;number is groovy.lang.Reference@32502377
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17006486" author="emilles" created="Wed, 1 Jan 2020 21:18:35 +0000"  >&lt;p&gt;Thanks for recreation scenario.&#160; It was the changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5961&quot; title=&quot;Variable scope not checked properly for AIC in static method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5961&quot;&gt;&lt;del&gt;GROOVY-5961&lt;/del&gt;&lt;/a&gt; that caused this.&#160;&#160;&lt;a href=&quot;https://github.com/apache/groovy/commit/3cb400392baee07f7725ada2f222e1184abe9436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/3cb400392baee07f7725ada2f222e1184abe9436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I will try and sort out why the scope changes have resulted in Reference type being used instead of property type.&lt;/p&gt;</comment>
                            <comment id="17006508" author="emilles" created="Wed, 1 Jan 2020 22:43:18 +0000"  >&lt;p&gt;&lt;tt&gt;VariableScopeVisitor#checkVariableNameForDeclaration&lt;/tt&gt; looks for a variable declaration for a given name.  When found, the scopes between the declaration and reference are updated with a local variable reference.  In your example, the second occurrence of &quot;number&quot; in &lt;tt&gt;numberSupplier()&lt;/tt&gt; goes through a different path in &lt;tt&gt;checkVariableNameForDeclaration&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This block is missing something to prevent indicating that &quot;number&quot; is a class variable on subsequent visitations:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        VariableScope end = scope;
        scope = currentScope;
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (scope != end) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (end.isClassScope() ||
                    (end.isReferencedClassVariable(name) &amp;amp;&amp;amp; end.getDeclaredVariable(name) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)) {
                scope.putReferencedClassVariable(&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// gets here, but should not
&lt;/span&gt;            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                scope.putReferencedLocalVariable(&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;);
            }
            scope = scope.getParent();
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 45 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02lo8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>