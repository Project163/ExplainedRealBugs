<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:01:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2258] AntBuilder broken by a RC-1 -&gt; RC-2 change: Can&apos;t find compiler</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2258</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;After a clean compile and install of Groovy and a clean compile and install of Gant then when Gant tries to process a javac Ant task, the following output is generated:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; gant test&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;groovyc&amp;#93;&lt;/span&gt; No sources to compile&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;mkdir&amp;#93;&lt;/span&gt; Created dir: /home/Checkouts/Subversion/Gant/gant/trunk/target/test-classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 1 source file to /home/Checkouts/Subversion/Gant/gant/trunk/target/classes&lt;br/&gt;
Unable to find a javac compiler;&lt;br/&gt;
com.sun.tools.javac.Main is not on the classpath.&lt;br/&gt;
Perhaps JAVA_HOME does not point to the JDK.&lt;br/&gt;
It is currently set to &quot;/usr/lib/jvm/java-6-sun-1.6.0.03/jre&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; echo $JAVA_HOME&lt;br/&gt;
/usr/lib/jvm/java-6-sun-1.6.0.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</description>
                <environment>Ubuntu 7.10 Gutsy Gibbon, java version &amp;quot;1.6.0_03&amp;quot;, Groovy Head r8979</environment>
        <key id="12813840">GROOVY-2258</key>
            <summary>AntBuilder broken by a RC-1 -&gt; RC-2 change: Can&apos;t find compiler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="russel">Dr. Russel Winder</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Nov 2007 14:49:20 +0000</created>
                <updated>Thu, 15 Nov 2007 14:20:58 +0000</updated>
                            <resolved>Thu, 15 Nov 2007 14:20:58 +0000</resolved>
                                    <version>1.1-rc-2</version>
                                    <fixVersion>1.1-rc-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14463321" author="blackdrag" created="Thu, 1 Nov 2007 17:31:11 +0000"  >&lt;p&gt;Is this a blocker for gant, or for groovy?&lt;/p&gt;

&lt;p&gt;besides that.... is it possible, that the gant script sets a new JAVA_HOME? &lt;/p&gt;</comment>
                            <comment id="14463492" author="russel" created="Fri, 2 Nov 2007 02:29:59 +0000"  >&lt;p&gt;I beleive this is a blocker for both Gant and Groovy.  I believe this problem has arisen due to a change in Groovy over the last three or four weeks.&lt;/p&gt;

&lt;p&gt;Gant does not alter the JAVA_HOME variable:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; grep -r JAVA src&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Of the Ant tasks used in the Gant build, only the Ant.javac task appears to be affected, the Ant.groovyc, Ant.junit tasks appears to work just fine.&lt;/p&gt;</comment>
                            <comment id="14463500" author="blackdrag" created="Fri, 2 Nov 2007 07:18:55 +0000"  >&lt;p&gt;hmm.. if I see it right, the gant script starts the startGroovy script, which means the error should be there. There I find only this suspicious part:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;# Attempt to set JAVA_HOME &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it&apos;s not already set.
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ -z &lt;span class=&quot;code-quote&quot;&gt;&quot;$JAVA_HOME&quot;&lt;/span&gt; ] ; then
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $darwin ; then 
        [ -z &lt;span class=&quot;code-quote&quot;&gt;&quot;$JAVA_HOME&quot;&lt;/span&gt; -a -d &lt;span class=&quot;code-quote&quot;&gt;&quot;/Library/Java/Home&quot;&lt;/span&gt; ] &amp;amp;&amp;amp; export JAVA_HOME=&lt;span class=&quot;code-quote&quot;&gt;&quot;/Library/Java/Home&quot;&lt;/span&gt;
        [ -z &lt;span class=&quot;code-quote&quot;&gt;&quot;$JAVA_HOME&quot;&lt;/span&gt; -a -d &lt;span class=&quot;code-quote&quot;&gt;&quot;/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/JavaVM.framework/Home&quot;&lt;/span&gt; ] &amp;amp;&amp;amp; export JAVA_HOME=&lt;span class=&quot;code-quote&quot;&gt;&quot;/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Frameworks/JavaVM.framework/Home&quot;&lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        javaExecutable=&lt;span class=&quot;code-quote&quot;&gt;&quot;`which javac`&quot;&lt;/span&gt;
        [ -z &lt;span class=&quot;code-quote&quot;&gt;&quot;$javaExecutable&quot;&lt;/span&gt; -o &lt;span class=&quot;code-quote&quot;&gt;&quot;`expr \&quot;&lt;/span&gt;$javaExecutable\&lt;span class=&quot;code-quote&quot;&gt;&quot; : &lt;span class=&quot;code-quote&quot;&gt;&apos;\([^ ]*\)&apos;&lt;/span&gt;`&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;no&quot;&lt;/span&gt; ] &amp;amp;&amp;amp; die &lt;span class=&quot;code-quote&quot;&gt;&quot;JAVA_HOME not set and cannot find javac to deduce location, please set JAVA_HOME.&quot;&lt;/span&gt;
        # readlink(1) is not available as standard on Solaris 10.
        readLink=`which readlink`
        [ `expr &lt;span class=&quot;code-quote&quot;&gt;&quot;$readLink&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;\([^ ]*\)&apos;&lt;/span&gt;` = &lt;span class=&quot;code-quote&quot;&gt;&quot;no&quot;&lt;/span&gt; ] &amp;amp;&amp;amp; die &lt;span class=&quot;code-quote&quot;&gt;&quot;JAVA_HOME not set and readlink not available, please set JAVA_HOME.&quot;&lt;/span&gt;
        javaExecutable=&lt;span class=&quot;code-quote&quot;&gt;&quot;`readlink -f \&quot;&lt;/span&gt;$javaExecutable\&lt;span class=&quot;code-quote&quot;&gt;&quot;`&quot;&lt;/span&gt;
        javaHome=&lt;span class=&quot;code-quote&quot;&gt;&quot;`dirname \&quot;&lt;/span&gt;$javaExecutable\&lt;span class=&quot;code-quote&quot;&gt;&quot;`&quot;&lt;/span&gt;
        javaHome=`expr &lt;span class=&quot;code-quote&quot;&gt;&quot;$javaHome&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;\(.*\)/bin&apos;&lt;/span&gt;`
        export JAVA_HOME=&lt;span class=&quot;code-quote&quot;&gt;&quot;$javaHome&quot;&lt;/span&gt;
    fi
fi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but If I recall correctly, then [ -z &quot;$JAVA_HOME&quot; ] ; is used to est for an unset variable (or zero length), which means that JAVA_HOME was not set before. Could you in your example give the output to the following program?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;which javac
echo $JAVA_HOME
gant test
echo $JAVA_HOME
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;because I expect now, that JAVA_HOME was first not set and is then set by the startGroovy script, but to the wrong location, because.. well because I think that &quot;which javac&quot; finds the the jre instead of the jdk. If that is correct, then setting PATH differently would help, as well as setting JAVA_HOME before.&lt;/p&gt;</comment>
                            <comment id="14463541" author="russel" created="Fri, 2 Nov 2007 08:15:55 +0000"  >&lt;p&gt;The problem here is that I have a JAVA_HOME set so none of the above code should get executed.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; which javac&lt;br/&gt;
/usr/lib/jvm/java-6-sun-1.6.0.03/bin/javac&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; echo $JAVA_HOME&lt;br/&gt;
/usr/lib/jvm/java-6-sun-1.6.0.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; gant test&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 3 source files to /home/Checkouts/Subversion/Gant/gant/trunk/target/classes&lt;br/&gt;
Unable to find a javac compiler;&lt;br/&gt;
com.sun.tools.javac.Main is not on the classpath.&lt;br/&gt;
Perhaps JAVA_HOME does not point to the JDK.&lt;br/&gt;
It is currently set to &quot;/usr/lib/jvm/java-6-sun-1.6.0.03/jre&quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; echo $JAVA_HOME&lt;br/&gt;
/usr/lib/jvm/java-6-sun-1.6.0.03&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;executing the Gant script with -x, I see that:&lt;/p&gt;

&lt;p&gt; exec /usr/lib/jvm/java-6-sun-1.6.0.03/bin/java -classpath /home/users/russel/lib/Java/groovy/lib/groovy-1.1-rc-2-SNAPSHOT.jar -Dprogram.name=gant -Dgroovy.starter.conf=/home/users/russel/lib/Java/groovy/conf/groovy-starter.conf -Dgroovy.home=/home/users/russel/lib/Java/groovy -Dtools.jar=/usr/lib/jvm/java-6-sun-1.6.0.03/lib/tools.jar org.codehaus.groovy.tools.GroovyStarter --main gant.Gant --conf /home/users/russel/lib/Java/groovy/conf/groovy-starter.conf --classpath .&lt;/p&gt;

&lt;p&gt;all of which seems entirely fine.&lt;/p&gt;

&lt;p&gt;Thre string jre doesn&apos;t appear in the Gant source.  In the Groovy source it appears in src/main/org/codehaus/groovy/tools/javac/JavacJavaCompiler.java and src/bin/startGroovy&lt;/p&gt;
</comment>
                            <comment id="14463332" author="blackdrag" created="Fri, 2 Nov 2007 08:25:56 +0000"  >&lt;p&gt;I get the feeling that the startup scripts are ok, but that the discovery mechanism for the javac task in the ant lib is a bit broken... just to be absolutely sure that it is no Groovy. Could you execute a gant script containing this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;println (&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.getenv(&lt;span class=&quot;code-quote&quot;&gt;&quot;JAVA_HOME&quot;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;if this still prints usr/lib/jvm/java-6-sun-1.6.0.03 instead of the JRE version, then it can&apos;t be a startup related problem. Then it is either antbuilder, or ant itself.&lt;/p&gt;</comment>
                            <comment id="14463376" author="russel" created="Fri, 2 Nov 2007 08:32:35 +0000"  >
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; more build.gant &lt;br/&gt;
println (System.getenv(&quot;JAVA_HOME&quot;))&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; gant&lt;br/&gt;
/usr/lib/jvm/java-6-sun-1.6.0.03&lt;br/&gt;
Target default does not exist.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I would be surprised if it was an Ant issue, I have been using 1.7.0 for many moons.&lt;/p&gt;</comment>
                            <comment id="14463351" author="blackdrag" created="Fri, 2 Nov 2007 08:47:49 +0000"  >&lt;p&gt;it might be right that you are using ant 1.7.0 for a long time now, but as you can see groovy is not setting a different JAVA_HOME here. So it might be the combination that causes a problem. Looking at the code of AntBuilder I can&apos;t find anything that could cause this problem. That leaves it to the javac task. &lt;/p&gt;</comment>
                            <comment id="14463522" author="russel" created="Sat, 3 Nov 2007 05:31:07 +0000"  >&lt;p&gt;I suspect we must continue to doubt Groovy and that the change is a thing that has happened in Groovy.&lt;/p&gt;

&lt;p&gt;I assume AntBuilder does not fork Ant jobs but loads the Ant jars and calls the appropriate methods.  This would mean that the environment variables are not an issue, that the problem is a classpath and class loaders issues.  So what can have changed in Groovy that means that tools.jar is not on the classpath for AntBuilder?&lt;/p&gt;</comment>
                            <comment id="14463485" author="russel" created="Sat, 3 Nov 2007 12:13:54 +0000"  >&lt;p&gt;OK, this is definitely not a Gant problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  The script:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AntBuilder ( ).javac ( srcdir : &lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt; , destdir : &lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp&apos;&lt;/span&gt; )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;causes the result:&lt;/p&gt;

&lt;p&gt;&amp;gt; groovy AntBuilderProblem.groovy &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 17 source files to /tmp&lt;br/&gt;
Caught: : Unable to find a javac compiler;&lt;br/&gt;
com.sun.tools.javac.Main is not on the classpath.&lt;br/&gt;
Perhaps JAVA_HOME does not point to the JDK.&lt;br/&gt;
It is currently set to &quot;/usr/lib/jvm/java-6-sun-1.6.0.03/jre&quot;&lt;br/&gt;
        at AntBuilderProblem.run(AntBuilderProblem.groovy:1)&lt;br/&gt;
        at AntBuilderProblem.main(AntBuilderProblem.groovy)&lt;/p&gt;</comment>
                            <comment id="14463504" author="russel" created="Sun, 4 Nov 2007 02:04:27 +0000"  >&lt;p&gt;OK, I have doen the experiment:  I downloaded Groovy RC-1 and used that and everything is fine.  Groovy RC-2 and Subversion head have the problem.  This is definitely not a Gant or Ant problem per se since they were not changed.  Thus something has changed between RC-1 and RC-2 which means that in effect Groovy is broken.&lt;/p&gt;

&lt;p&gt;I think the AntBuilder code acts as a test.  I will turn this into a Groovy unit test and add it in.  This will of course mean that the Groovy tests will break.&lt;/p&gt;
</comment>
                            <comment id="14463570" author="russel" created="Sun, 4 Nov 2007 02:17:00 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; more GROOVY_2258.groovy&lt;br/&gt;
#! /usr/bin/env groovy&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;new AntBuilder ( ).javac ( srcdir : &apos;.&apos; , destdir : &apos;/tmp&apos; )&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; which groovy&lt;br/&gt;
/home/users/russel/lib/Java/groovy/bin/groovy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; groovy -v&lt;br/&gt;
Groovy Version: 1.1-final-SNAPSHOT JVM: 1.6.0_03-b05&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; groovy GROOVY_2258.groovy&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 17 source files to /tmp&lt;br/&gt;
Caught: : Unable to find a javac compiler;&lt;br/&gt;
com.sun.tools.javac.Main is not on the classpath.&lt;br/&gt;
Perhaps JAVA_HOME does not point to the JDK.&lt;br/&gt;
It is currently set to &quot;/usr/lib/jvm/java-6-sun-1.6.0.03/jre&quot;&lt;br/&gt;
        at GROOVY_2258.run(GROOVY_2258.groovy:3)&lt;br/&gt;
        at GROOVY_2258.main(GROOVY_2258.groovy)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt; GROOVY_HOME=/sparedisk/russel/groovy-1.1-rc-1/target/install /sparedisk/russel/groovy-1.1-rc-1/target/install/bin/groovy GROOVY_2258.groovy&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 17 source files to /tmp&lt;br/&gt;
/home/users/russel/Progs/OddsByLanguage/Groovy/&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-917&quot; title=&quot;Cannot instantiate Java inner class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-917&quot;&gt;&lt;del&gt;GROOVY-917&lt;/del&gt;&lt;/a&gt;/X.java:1: duplicate class: X&lt;br/&gt;
public class X {&lt;br/&gt;
       ^&lt;br/&gt;
/home/users/russel/Progs/OddsByLanguage/Groovy/IanDarwin/wc.java:7: class WC is public, should be declared in a file named WC.java&lt;br/&gt;
public class WC {&lt;br/&gt;
       ^&lt;br/&gt;
2 errors&lt;br/&gt;
Caught: : Compile failed; see the compiler error output for details.&lt;br/&gt;
        at GROOVY_2258.run(GROOVY_2258.groovy:3)&lt;br/&gt;
        at GROOVY_2258.main(GROOVY_2258.groovy)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="14463434" author="blackdrag" created="Sun, 4 Nov 2007 07:38:06 +0000"  >&lt;p&gt;the change I can think of is that the tools.jar is no longer loaded by default through Groovy. And I guess since it is not loaded through Groovy, ant tries to find it by itself and does that wrong. I still really suspect that ant is doing something wrong here. adding tools.jar would be a workaround that you could try. If it works then, then I really think it is the fault of Ant, if not, then it is something inside Groovy I guess... something I have no ideas of what it could be. &lt;/p&gt;</comment>
                            <comment id="14463585" author="russel" created="Sun, 4 Nov 2007 12:38:41 +0000"  >&lt;p&gt;As observed by Jochen Theodorou, the thing that is causing the difference is the presence or absence of the line:&lt;/p&gt;

&lt;p&gt;load ${tools.jar}&lt;/p&gt;

&lt;p&gt;in $GROOVY_HOME/conf/groovy-starter.conf.  With the line AntBuilder works fine but Mac OS X won&apos;t work because Apple have merged rt.jar and tools.jar into a single classes.jar in the Mac OS X version of Java (for some incomprehensible reason).  Without the line, Mac OS X is fine but AntBuilder now has a serious problem, it fails to fins any class in tools.jar.&lt;/p&gt;

&lt;p&gt;We therefore have a dilema, Groovy is either broken on Mac OS X or has a broken AntBuilder.&lt;/p&gt;</comment>
                            <comment id="14463571" author="blackdrag" created="Sun, 4 Nov 2007 13:20:45 +0000"  >&lt;p&gt;I took a look at the ant source and found this line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; JAVA_HOME = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.getProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.home&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which makes me ask myself who is setting this property... running a java program on my windows machine this shows me: &quot;C:\Programme\JavaSoft\sdk\jre&quot; and then it is no wonder it gets a problem, because that is the JRE and not the JDK part. I confirmed this with my linux machine.. it is pointing to &quot;/usr/lib/j2sdk1.5-sun/jre&quot; there and that differs from my JAVA_HOME which is set to &quot;/usr/lib/j2sdk1.5-sun&quot;&lt;/p&gt;

&lt;p&gt; I must say I think the ANT message is extremly misleading, because even though it is speaking of JAVA_HOME, it means the property java.home and that property is set by the VM to the JRE and not the JDK. No wonder Ant will not find the javac binary, because in that directory and its subdirectories, there is no javac command. So in my eyes ant is broken here. I guess when running ant from the command line, something in ant-utils or such will correct the path.&lt;/p&gt;

&lt;p&gt;The question is now how we react to this.  I mean it is clear, that the javac class won&apos;t be found, if it is not on the classpath, which will happen if we don&apos;t include the tools.jar. Or should the user have to do that? Russel, what do you suggest?&lt;/p&gt;</comment>
                            <comment id="14463484" author="russel" created="Mon, 5 Nov 2007 02:02:43 +0000"  >&lt;p&gt;Jochen, well spotted!&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;println ( &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.properties.&lt;span class=&quot;code-quote&quot;&gt;&apos;java.home&apos;&lt;/span&gt; )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;prints the path to the JRE for me as well.  This is of course not surprising and exactly as it should be since this is the path to the JVM, not to the JDK.&lt;/p&gt;

&lt;p&gt;I think it is clear that the Ant error message is completely misleading.  I have added a bug report in the Ant Bugzilla (43794).&lt;/p&gt;

&lt;p&gt;I think we have to find out what Ant does internally to allow the javac task to run, so that we know how Ant gets round this problem.  Currently I am assuing they define their own class loader and it looks in all the right places, including tools.jar on all systems other than Mac OS X.&lt;/p&gt;

&lt;p&gt;I think that maybe Groovy should check to see if it is running from a JRE or from a JDK with embedded JRE, and in the latter case add tools.jar to the classpath.  This then ensures people running only on a JRE can run Groovy (but at the expense of not being able to do some things such as run the Ant javac task) whilst people using a JDK get everything and no surprises.  This also gets round the Mac OS X problem since classes.jar is already on the classpath.&lt;/p&gt;</comment>
                            <comment id="14463438" author="blackdrag" created="Sun, 11 Nov 2007 23:55:20 +0000"  >&lt;p&gt;As said on the list, the solution seems to be for me to use a slightly different property syntax in the conf file. for example ${x?} instead of ${x}, where the ? indicates that the property might not be set. then we can modify the tools.jar line to &quot;load ${tools.jar?}&quot;. an alternative syntax wold be $?&lt;/p&gt;
{x} or simply ?{x}
&lt;p&gt;. Or we could go the other way and say an error should be thrown if a property does not exist, but assign this a another syntax like !&lt;/p&gt;
{x}
&lt;p&gt; and say that ${x} will handle non existing properties.&lt;/p&gt;</comment>
                            <comment id="14463596" author="blackdrag" created="Thu, 15 Nov 2007 14:20:58 +0000"  >&lt;p&gt;ok, I changed the conf file and the class using that file as config. ${x} now defines a not required property. If x is not defined, then the whole load instruction for this will be ignored. This means a &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;load ${tools.jar}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will be ignored if tools.jar is not set. To get the old version you need to use $!&lt;/p&gt;
{x}
&lt;p&gt;, which will then throw an error. This should fix the problem since with this the tools.jar will be on the classpath per default again and then ANT should be able to find the javac class again and does not try to find the external javac compiler, which seems not to work in many configurations.&lt;/p&gt;

&lt;p&gt;so I close this as fixed for now. Would be nice of you to test it and see if it is really fixed Russel.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bwkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>