<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:03:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9059] Failed to parse/compile generic methods with &quot;extends&quot;</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9059</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic

&lt;span class=&quot;code-comment&quot;&gt;// This bug affects: groovy-2.4.16, groovy-2.5.6, groovy-3.0.0-alpha-4
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// This bug also affect IDEA&apos;s syntax parser
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; X&amp;lt;T&amp;gt; {
    &lt;span class=&quot;code-comment&quot;&gt;// Intellij IDEA reports that &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt; is not necessary
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// BUT without the &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&apos;&lt;/span&gt; modifier, there is a syntax error
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; T foo(T o);
}
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Y&amp;lt;T&amp;gt; {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;O &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; T&amp;gt; O foo(O o);
}

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestGroovyGeneric {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        def x = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;() {
            &lt;span class=&quot;code-comment&quot;&gt;// it compiles
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// BUT: Intellij IDEA reports: ERROR: Method &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; is not implemented
&lt;/span&gt;            @Override
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; o) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o }
        }

        &lt;span class=&quot;code-comment&quot;&gt;// Strangely, such code compiles
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// BUT: Intellij IDEA reports: ERROR: Method &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; is not implemented
&lt;/span&gt;        def y1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Y&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;() {
            @Override
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; o) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o }
        }

        &lt;span class=&quot;code-comment&quot;&gt;// Can not compile:
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// BUT: Intellij IDEA reports no error ....
&lt;/span&gt;        def y2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Y&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;() {
            @Override
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; o) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o }
        }
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12964268/12964268_image-2019-03-30-13-10-20-819.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13224954">GROOVY-9059</key>
            <summary>Failed to parse/compile generic methods with &quot;extends&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="wxiaoguang">Xiaoguang Wang</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Mar 2019 05:10:36 +0000</created>
                <updated>Tue, 19 Jul 2022 20:31:06 +0000</updated>
                            <resolved>Wed, 7 Aug 2019 23:42:57 +0000</resolved>
                                    <version>2.4.16</version>
                    <version>3.0.0-alpha-4</version>
                    <version>2.5.6</version>
                                    <fixVersion>3.0.0-rc-1</fixVersion>
                    <fixVersion>2.5.18</fixVersion>
                                    <component>Static compilation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16805646" author="paulk" created="Sat, 30 Mar 2019 06:02:53 +0000"  >&lt;p&gt;Some comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Jetbrains have their own bug tracker for Intellij IDEA bugs: &lt;a href=&quot;https://youtrack.jetbrains.com/issues/idea&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://youtrack.jetbrains.com/issues/idea&lt;/a&gt;&lt;br/&gt;
  (look for/create new issues under the &quot;Groovy&quot; subsystem)&lt;/li&gt;
	&lt;li&gt;the &quot;public&quot; modifier before the method type parameters is needed for the current Antlr2 parser but not the new Parrot parser in 3.0. Perhaps IDEA isn&apos;t geared up to distinguish those cases depending on Groovy version selected for your project.&lt;/li&gt;
	&lt;li&gt;The same behavior seems to occur with or without @CompileStatic, so a simpler reproducer is to remove that.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Having said those things, there does seem to be a problem for the bounded type parameter cases. Workaround is to just replace String with Object or def in say your third example and while obviously needing more work will pass due to bridge methods for the time being.&lt;/p&gt;</comment>
                            <comment id="16805652" author="wxiaoguang" created="Sat, 30 Mar 2019 06:11:44 +0000"  >&lt;p&gt;Sorry I messed different problems together.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The main problem here is about&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Y&amp;lt;T&amp;gt; { 
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;O &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; T&amp;gt; O foo(O o); 
}

def y2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Y&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;() {
    @Override
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; o) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It compiles in Java, and such code appears in Srping&apos;s code, eg: `org.springframework.security.config.annotation.ObjectPostProcessor&amp;lt;T&amp;gt;` which has `&lt;tt&gt;&amp;lt;O extends &lt;a href=&quot;https://docs.spring.io/spring-security/site/docs/4.2.10.RELEASE/apidocs/org/springframework/security/config/annotation/ObjectPostProcessor.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;T&lt;/a&gt;&amp;gt;&lt;/tt&gt; &lt;tt&gt;&lt;a href=&quot;https://docs.spring.io/spring-security/site/docs/4.2.10.RELEASE/apidocs/org/springframework/security/config/annotation/ObjectPostProcessor.html#postProcess-O-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;postProcess&lt;/a&gt;(O&#160;object)&lt;/tt&gt;`&lt;/p&gt;

&lt;p&gt;Such different behavior (groovy&apos;s error) makes developers do not know how to use Groovy with Spring.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16805694" author="paulk" created="Sat, 30 Mar 2019 07:18:34 +0000"  >&lt;p&gt;No problems, I agree we need to fix this. I presume other&apos;s have found the workaround since I believe this problem has been around for a while, but we should get rid of the need for the workaround.&lt;/p&gt;</comment>
                            <comment id="16822042" author="emilles" created="Fri, 19 Apr 2019 16:42:57 +0000"  >&lt;p&gt;This last line in &lt;tt&gt;Verifier.getCovariantImplementation&lt;/tt&gt; fails to identify the link between &lt;tt&gt;String foo(String o)&lt;/tt&gt; in the impl and &lt;tt&gt;&amp;lt;O extends T&amp;gt; O foo(O o)&lt;/tt&gt; in the interface.  And so, without the covariant method, the abstract method errors are produced.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; MethodNode getCovariantImplementation(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MethodNode oldMethod, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MethodNode overridingMethod, Map genericsSpec, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ignoreError) {
        &lt;span class=&quot;code-comment&quot;&gt;// method name
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!oldMethod.getName().equals(overridingMethod.getName())) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((overridingMethod.getModifiers() &amp;amp; ACC_BRIDGE) != 0) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (oldMethod.isPrivate()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        &lt;span class=&quot;code-comment&quot;&gt;// parameters
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; normalEqualParameters = equalParametersNormal(overridingMethod, oldMethod);
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; genericEqualParameters = equalParametersWithGenerics(overridingMethod, oldMethod, genericsSpec);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16822125" author="emilles" created="Fri, 19 Apr 2019 18:38:26 +0000"  >&lt;p&gt;So by including the generics of &lt;tt&gt;oldMethod&lt;/tt&gt;, &lt;tt&gt;equalParametersWithGenerics&lt;/tt&gt; can get from &lt;tt&gt;O -&amp;gt; Object&lt;/tt&gt; to &lt;tt&gt;O -&amp;gt; T -&amp;gt; Object&lt;/tt&gt;.  Since &lt;tt&gt;genericsSpec&lt;/tt&gt; is only used to convert types from &lt;tt&gt;oldMethod&lt;/tt&gt;, I removed the existing call &lt;tt&gt;addMethodGenerics(overridingMethod, genericsSpec)&lt;/tt&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// org.codehaus.groovy.classgen.Verifier
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; MethodNode getCovariantImplementation(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MethodNode oldMethod, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MethodNode overridingMethod, Map genericsSpec, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ignoreError) {
        &lt;span class=&quot;code-comment&quot;&gt;// method name
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!oldMethod.getName().equals(overridingMethod.getName())) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((overridingMethod.getModifiers() &amp;amp; ACC_BRIDGE) != 0) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (oldMethod.isPrivate()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE add -- GROOVY-9059
&lt;/span&gt;        genericsSpec = GenericsUtils.addMethodGenerics(oldMethod, genericsSpec);
        &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE end
&lt;/span&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// parameters
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; normalEqualParameters = equalParametersNormal(overridingMethod, oldMethod);
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; genericEqualParameters = equalParametersWithGenerics(overridingMethod, oldMethod, genericsSpec);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!normalEqualParameters &amp;amp;&amp;amp; !genericEqualParameters) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        /* GRECLIPSE edit -- GROOVY-9059
        &lt;span class=&quot;code-comment&quot;&gt;//correct to method level generics &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the overriding method
&lt;/span&gt;        genericsSpec = GenericsUtils.addMethodGenerics(overridingMethod, genericsSpec);
        */

        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type
&lt;/span&gt;        ClassNode mr = overridingMethod.getReturnType();
        ClassNode omr = oldMethod.getReturnType();
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; equalReturnType = mr.equals(omr);

        ClassNode testmr = correctToGenericsSpec(genericsSpec, omr);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From there, it needs some help to use the entry &lt;tt&gt;T=T-&amp;gt;java.lang.String&lt;/tt&gt; from &lt;tt&gt;genericsSpec&lt;/tt&gt;.  I did it using a special method from ClassNode that was introduced for a previous fix:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// org.codehaus.groovy.ast.tools.GenericsUtils
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; ClassNode correctToGenericsSpec(Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,ClassNode&amp;gt; genericsSpec, ClassNode type) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type.isArray()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; correctToGenericsSpec(genericsSpec, type.getComponentType()).makeArray();
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type.isGenericsPlaceHolder()) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = type.getGenericsTypes()[0].getName();
            type = genericsSpec.get(name);
            &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE add -- GROOVY-9059
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; type.isGenericsPlaceHolder()) {
                type = type.asGenericsType().getUpperBounds()[0];
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; correctToGenericsSpec(genericsSpec, type);
            }
            &lt;span class=&quot;code-comment&quot;&gt;// GRECLIPSE end
&lt;/span&gt;        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) type = ClassHelper.OBJECT_TYPE;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// org.codehaus.groovy.ast.ClassNode
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; GenericsType asGenericsType() {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isGenericsPlaceHolder()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericsType(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            ClassNode upper = (redirect != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? redirect : &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericsType(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassNode[]{upper}, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With that in place, you can do this without error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Why &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Y&amp;lt;CharSequence&amp;gt; {
  @Override
  public &amp;lt;CS &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CharSequence&amp;gt; CS foo(CS cs) { cs }
}
&lt;span class=&quot;code-comment&quot;&gt;// or
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; why = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Y&amp;lt;CharSequence&amp;gt;() {
  @Override
  public &amp;lt;CS &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CharSequence&amp;gt; CS foo(CS cs) { cs }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, your example of using String and no method generics still produces 1 error (from groovyc) and 1 warning (from eclipse):&lt;br/&gt;
1. Method &apos;foo&apos; from class &apos;Bar$1&apos; does not override method from its superclass or interfaces but is annotated with @Override.&lt;br/&gt;
2. The return type String for foo(String) from the type new Y&amp;lt;String&amp;gt;(){} needs unchecked conversion to conform to O from the type Y&amp;lt;T&amp;gt;&lt;/p&gt;</comment>
                            <comment id="16901316" author="emilles" created="Tue, 6 Aug 2019 17:34:00 +0000"  >&lt;p&gt;Taking another look at this, it appears that &lt;tt&gt;GenericsUtils.addMethodGenerics&lt;/tt&gt; is where the information loss occurs for groovyc.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ClassNode&amp;gt; addMethodGenerics(MethodNode current, Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ClassNode&amp;gt; oldSpec) {
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ClassNode&amp;gt; ret = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ClassNode&amp;gt;(oldSpec);
        &lt;span class=&quot;code-comment&quot;&gt;// ret starts with the original type specs, now add gts &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the current method &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; any
&lt;/span&gt;        GenericsType[] sgts = current.getGenericsTypes();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sgts != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (GenericsType sgt : sgts) {
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = sgt.getName();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sgt.isPlaceholder()) {
                    ClassNode redirect;
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sgt.getUpperBounds() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        redirect = sgt.getUpperBounds()[0];
                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sgt.getLowerBound() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        redirect = sgt.getLowerBound();
                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                        redirect = ClassHelper.OBJECT_TYPE;
                    }
                    ClassNode type = ClassHelper.makeWithoutCaching(name);
                    type.setGenericsPlaceHolder(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// type is &lt;span class=&quot;code-quote&quot;&gt;&quot;O&quot;&lt;/span&gt; and redirect is &lt;span class=&quot;code-quote&quot;&gt;&quot;T -&amp;gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&quot;&lt;/span&gt;
&lt;/span&gt;                    type.setRedirect(redirect); &lt;span class=&quot;code-comment&quot;&gt;// after &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, type is &lt;span class=&quot;code-quote&quot;&gt;&quot;O -&amp;gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&quot;&lt;/span&gt;; &lt;span class=&quot;code-quote&quot;&gt;&quot;T&quot;&lt;/span&gt; has been lost
&lt;/span&gt;                    ret.put(name, type);
                } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                    ret.put(name, sgt.getType());
                }
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ret;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For the &lt;tt&gt;correctToGenericsSpec&lt;/tt&gt; calls to work after this, &quot;T&quot; must be retained in the redirect of &quot;O&quot;.&lt;/p&gt;</comment>
                            <comment id="16902545" author="daniel_sun" created="Wed, 7 Aug 2019 23:42:57 +0000"  >&lt;p&gt;The proposed PR was merged. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12964268" name="image-2019-03-30-13-10-20-819.png" size="231281" author="wxiaoguang" created="Sat, 30 Mar 2019 05:10:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z019mg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>