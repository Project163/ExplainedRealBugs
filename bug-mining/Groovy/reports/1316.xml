<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4269] metaClosure not called when using named parameters in Sql.rows</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4269</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Running the following code shows the problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.sql.*

def sql = Sql.newInstance([...])

def metaClosure = { meta -&amp;gt;
  meta.each { col -&amp;gt;
    println col.columnName
  }
}

println &lt;span class=&quot;code-quote&quot;&gt;&quot;Named:&quot;&lt;/span&gt;

sql.rows(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT COUNT(*) AS &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; FROM Table WHERE Id BETWEEN :start AND :end&quot;&lt;/span&gt;, [start: 10000, end: 11000], metaClosure).each { res -&amp;gt;
  println res[0]
}

println &lt;span class=&quot;code-quote&quot;&gt;&quot;Ordinal:&quot;&lt;/span&gt;

sql.rows(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT COUNT(*) AS &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; FROM Table WHERE Id BETWEEN ? AND ?&quot;&lt;/span&gt;, [10000, 11000], metaClosure).each { res -&amp;gt;
  println res[0]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Result on my computer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Named:
994
Ordinal:
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;
994
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Showing the metaClosure that prints the column name is not called when using named parameters.&lt;/p&gt;</description>
                <environment>Windows XP SP3, JVM 1.6.0_07</environment>
        <key id="12815211">GROOVY-4269</key>
            <summary>metaClosure not called when using named parameters in Sql.rows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="aperry">Alain Perry</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jun 2010 03:36:54 +0000</created>
                <updated>Sun, 13 May 2012 03:30:05 +0000</updated>
                            <resolved>Sat, 5 May 2012 00:24:34 +0000</resolved>
                                    <version>1.7.3</version>
                                    <fixVersion>2.0-beta-3</fixVersion>
                    <fixVersion>1.8.7</fixVersion>
                                    <component>SQL processing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14479230" author="paulk" created="Wed, 30 Jun 2010 03:55:41 +0000"  >&lt;p&gt;What happens if you put your map in a list, e.g.:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[[start: 10000, end: 11000]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I suspect we don&apos;t support metaClosure with the arbitrary params required for ordinal params. We could do some smart looking up of the last param I guess.&lt;/p&gt;</comment>
                            <comment id="14469712" author="roshandawrani" created="Wed, 30 Jun 2010 04:56:11 +0000"  >&lt;p&gt;Yes, method selection seems at fault here. &lt;/p&gt;

&lt;p&gt;For the args (String, Map params, Closure), it chooses rows(String query, Object[] params) over rows(String query, List params, Closure metaClosure) and thus metaClosure fails to get executed.&lt;/p&gt;</comment>
                            <comment id="14469689" author="roshandawrani" created="Wed, 30 Jun 2010 04:58:28 +0000"  >&lt;p&gt;For me, wrapping params in a list as [&lt;span class=&quot;error&quot;&gt;&amp;#91;start: 1, end: 5&amp;#93;&lt;/span&gt;] worked.&lt;/p&gt;</comment>
                            <comment id="14469697" author="roshandawrani" created="Wed, 30 Jun 2010 05:03:35 +0000"  >&lt;p&gt;Paul, the javadoc of Sql#rows(String sql, List&amp;lt;Object&amp;gt; params, Closure metaClosure) needs to be updated if metaClosure support is not there with arbitrary params required for ordinal params. &lt;/p&gt;

&lt;p&gt;Javadoc for the metaClosure version of rows() can be updated with a named parameter example (with the extra list wrapping)&lt;/p&gt;</comment>
                            <comment id="14479234" author="paulk" created="Wed, 30 Jun 2010 05:30:36 +0000"  >&lt;p&gt;Roshan, are you suggesting some clarification, e.g. changing this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This method supports named and named ordinal parameters.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;to this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This method supports named and named ordinal parameters by supplying such parameters in the &lt;tt&gt;params&lt;/tt&gt; list.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14469651" author="roshandawrani" created="Wed, 30 Jun 2010 05:41:55 +0000"  >&lt;p&gt;Yes. The current javadoc has the following example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sql.rows(&lt;span class=&quot;code-quote&quot;&gt;&quot;select * from PERSON where lastname like ?&quot;&lt;/span&gt;, [&lt;span class=&quot;code-quote&quot;&gt;&apos;%a%&apos;&lt;/span&gt;], metaClosure)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but there is no named parameters example, and the first natural attempt is probably to try &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sql.rows(&lt;span class=&quot;code-quote&quot;&gt;&quot;select * from PERSON where lastname like :alastname&quot;&lt;/span&gt;, [alastname: &lt;span class=&quot;code-quote&quot;&gt;&apos;%a%&apos;&lt;/span&gt;], metaClosure)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but what the current method selection logic requires is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sql.rows(&lt;span class=&quot;code-quote&quot;&gt;&quot;select * from PERSON where lastname like :alastname&quot;&lt;/span&gt;, [[alastname: &lt;span class=&quot;code-quote&quot;&gt;&apos;%a%&apos;&lt;/span&gt;]], metaClosure)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think this point/example needs to come in the javadoc - as it suits best.&lt;/p&gt;</comment>
                            <comment id="14469685" author="paulk" created="Wed, 30 Jun 2010 08:05:04 +0000"  >&lt;p&gt;Comment updated.&lt;/p&gt;

&lt;p&gt;Wondering whether we can do some smarts to detect when a (meta) closure is the last param for the Object[] case. And allow that method to also support named and ordinal params.&lt;/p&gt;</comment>
                            <comment id="14469764" author="roshandawrani" created="Wed, 30 Jun 2010 08:38:44 +0000"  >&lt;p&gt;Wondering whether we will then want to go beyond the last param and do smarts for detecting the following method as well, for example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, List, Closure, Closure){...}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479896" author="paulk" created="Sat, 5 May 2012 00:24:34 +0000"  >&lt;p&gt;The fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5405&quot; title=&quot;Named parameters for groovy.sql.Sql&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5405&quot;&gt;&lt;del&gt;GROOVY-5405&lt;/del&gt;&lt;/a&gt; should also fix this issue. Let me know if you have any further problems.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 29 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bxwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>