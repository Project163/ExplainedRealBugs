<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:24:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11325] @NamedVariant self referential default values are not correctly resolved when calculations are involved</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11325</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This is a follow-up of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10561&quot; title=&quot;@NamedVariant self referential default values are not correctly resolved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10561&quot;&gt;&lt;del&gt;GROOVY-10561&lt;/del&gt;&lt;/a&gt;. The fix didn&apos;t handle the case when the default value included any kind of calculation. Example in the &lt;a href=&quot;https://gwc-experiment.appspot.com/?g=groovy_4_0&amp;amp;codez=eNp9j8EKwjAMhu99ip9RmHNjLK2nQsEn8Oi9sk122Dq6UlDx3c1EUBEMgfDBlz9kGGcfIs7B-3SpY3DT0vsw1lshxP7gxq49ujC4KYq263Fy180wRSSCxU5VeIJiSFTSC_WKqqQCN2SSVcmGTDrDXbhl6fjcmpPIgJoC1iKnBkQglf8KFWcZqLeouOmPyFMb6K8F3eT8Dz7qAcyNP7Y&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GroovyWebConsole&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
@NamedVariant baz(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; v1 = 42, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; v2 = v1+1, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; v3 = v2+1) { &lt;span class=&quot;code-quote&quot;&gt;&quot;$v1 $v2 $v3&quot;&lt;/span&gt; }
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz() == &lt;span class=&quot;code-quote&quot;&gt;&apos;42 43 44&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(10) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 11 12&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(10, 20) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 20 21&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(10, 20, 30) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 20 30&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(v1: 10) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 11 12&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(v1: 10, v2: 20) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 20 21&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; baz(v1: 10, v2: 20, v3: 30) == &lt;span class=&quot;code-quote&quot;&gt;&apos;10 20 30&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The generated code looks like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
public java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; baz(@groovy.transform.NamedParams(value = [
  @groovy.transform.NamedParam(value = &lt;span class=&quot;code-quote&quot;&gt;&apos;v1&apos;&lt;/span&gt;, type = &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, required = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;),
  @groovy.transform.NamedParam(value = &lt;span class=&quot;code-quote&quot;&gt;&apos;v2&apos;&lt;/span&gt;, type = &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, required = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;),
  @groovy.transform.NamedParam(value = &lt;span class=&quot;code-quote&quot;&gt;&apos;v3&apos;&lt;/span&gt;, type = &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, required = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
]) java.util.Map namedArgs) {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == namedArgs ) {
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.lang.IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&apos;Named parameter map cannot be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt;)
&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; namedArgKey : namedArgs.keySet()) {
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; [&lt;span class=&quot;code-quote&quot;&gt;&apos;v1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;v2&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;v3&apos;&lt;/span&gt;].contains( namedArgKey ) : &lt;span class=&quot;code-quote&quot;&gt;&apos;Unrecognized namedArgKey: &apos;&lt;/span&gt; + namedArgKey
        }
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.baz(
            namedArgs.containsKey(&lt;span class=&quot;code-quote&quot;&gt;&apos;v1&apos;&lt;/span&gt;) ? namedArgs.v1 : 42,
            namedArgs.containsKey(&lt;span class=&quot;code-quote&quot;&gt;&apos;v2&apos;&lt;/span&gt;) ? namedArgs.v2 : v1 + 1,
            namedArgs.containsKey(&lt;span class=&quot;code-quote&quot;&gt;&apos;v3&apos;&lt;/span&gt;) ? namedArgs.v3 : v2 + 1)
&#160; &#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;IMHO, it would be easiest to extract the map entries into local variables, then the references would be valid and would also work for cascading references.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13569880">GROOVY-11325</key>
            <summary>@NamedVariant self referential default values are not correctly resolved when calculations are involved</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="leonard84">Leonard Br&#252;nings</reporter>
                        <labels>
                            <label>named-parameters</label>
                    </labels>
                <created>Mon, 26 Feb 2024 18:36:40 +0000</created>
                <updated>Tue, 5 Mar 2024 01:53:27 +0000</updated>
                            <resolved>Mon, 26 Feb 2024 20:09:52 +0000</resolved>
                                    <version>2.5.23</version>
                    <version>3.0.20</version>
                    <version>4.0.17</version>
                                    <fixVersion>4.0.19</fixVersion>
                    <fixVersion>5.0.0-alpha-6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17820843" author="emilles" created="Mon, 26 Feb 2024 20:09:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/1f4f2a775bc6988d0194cb0ffc10eb0ee4512321&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/1f4f2a775bc6988d0194cb0ffc10eb0ee4512321&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17821742" author="leonard84" created="Wed, 28 Feb 2024 16:14:15 +0000"  >&lt;p&gt;The tests seem to pass.&lt;/p&gt;

&lt;p&gt;I can&apos;t say anything about the newly generated code. &lt;br/&gt;
Spock has adopted &lt;a href=&quot;https://github.com/spockframework/spock/blob/9aa0d5a6825d66645b28273c6c4f8ac653d641a1/spock-specs/src/test/groovy/org/spockframework/smoke/ast/CleanupBlocksAstSpec.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AST tests&lt;/a&gt; that compare the generated code to a &lt;a href=&quot;https://github.com/spockframework/spock/blob/9aa0d5a6825d66645b28273c6c4f8ac653d641a1/spock-specs/src/test/resources/org/spockframework/smoke/ast/CleanupBlocksAstSpec/cleanup_rewrite_keeps_correct_method_reference.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;snapshot version&lt;/a&gt;, &lt;br/&gt;
this way it is easier to assess the effect of the AST transformation.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13436646">GROOVY-10561</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13515946">GROOVY-10889</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nmjs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>