<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:31:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5874] Groovyc: BUG! exception in phase &apos;class generation&apos; in source unit </title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5874</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@CompileStatic
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args)
    {
        def list = [1, 2, 3]

        def sum = 0
        list.each { &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i -&amp;gt; sum += i }
        println(sum)

        sum = list.inject(0, { &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; y -&amp;gt; x + y })
        println(sum)
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;creates this error message:&lt;/p&gt;

&lt;p&gt;Groovyc: BUG! exception in phase &apos;class generation&apos; in source unit &apos;C:\Users\Oliver\IdeaProjects\GroovyForEachSum\src\org\objectscape\LambdaTestStatic.groovy&apos; At line 20 column 30&lt;br/&gt;
On receiver: sum with message: plus and arguments: i&lt;br/&gt;
This method should not have been called. Please try to create a simple example reproducing this error and filea bug report at &lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY&lt;/a&gt;&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.sc.StaticTypesCallSiteWriter.makeSingleArgumentCall(StaticTypesCallSiteWriter.java:535)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.InvocationWriter.makeSingleArgumentCall(InvocationWriter.java:482)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.BinaryExpressionHelper.evaluateBinaryExpression(BinaryExpressionHelper.java:504)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.BinaryExpressionMultiTypeDispatcher.evaluateBinaryExpression(BinaryExpressionMultiTypeDispatcher.java:216)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.BinaryExpressionMultiTypeDispatcher.doAssignmentToLocalVariable(BinaryExpressionMultiTypeDispatcher.java:362)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.BinaryExpressionMultiTypeDispatcher.evaluateBinaryExpressionWithAssignment(BinaryExpressionMultiTypeDispatcher.java:346)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.BinaryExpressionHelper.eval(BinaryExpressionHelper.java:146)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitBinaryExpression(AsmClassGenerator.java:527)&lt;br/&gt;
	at org.codehaus.groovy.ast.expr.BinaryExpression.visit(BinaryExpression.java:49)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.StatementWriter.writeReturn(StatementWriter.java:582)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitReturnStatement(AsmClassGenerator.java:505)&lt;br/&gt;
	at org.codehaus.groovy.ast.stmt.ReturnStatement.visit(ReturnStatement.java:47)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.StatementWriter.writeBlockStatement(StatementWriter.java:81)&lt;br/&gt;
	at org.codehaus.groovy.classgen.asm.sc.StaticTypesStatementWriter.writeBlockStatement(StaticTypesStatementWriter.java:49)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitBlockStatement(AsmClassGenerator.java:455)&lt;br/&gt;
	at org.codehaus.groovy.ast.stmt.BlockStatement.visit(BlockStatement.java:69)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitClassCodeContainer(ClassCodeVisitorSupport.java:101)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitConstructorOrMethod(ClassCodeVisitorSupport.java:112)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitStdMethod(AsmClassGenerator.java:319)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitConstructorOrMethod(AsmClassGenerator.java:276)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitMethod(ClassCodeVisitorSupport.java:123)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitMethod(AsmClassGenerator.java:396)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassNode.visitContents(ClassNode.java:1059)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitClass(ClassCodeVisitorSupport.java:50)&lt;br/&gt;
	at org.codehaus.groovy.classgen.AsmClassGenerator.visitClass(AsmClassGenerator.java:180)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit$14.call(CompilationUnit.java:786)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit$14.call(CompilationUnit.java:803)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.applyToPrimaryClassNodes(CompilationUnit.java:1027)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.doPhaseOperation(CompilationUnit.java:564)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.processPhaseOperations(CompilationUnit.java:542)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:519)&lt;br/&gt;
	at org.jetbrains.groovy.compiler.rt.GroovyCompilerWrapper.compile(GroovyCompilerWrapper.java:44)&lt;br/&gt;
	at org.jetbrains.groovy.compiler.rt.GroovycRunner.main(GroovycRunner.java:129)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:601)&lt;br/&gt;
	at com.intellij.rt.execution.CommandLineWrapper.main(CommandLineWrapper.java:112)&lt;/p&gt;

&lt;p&gt;Also happens without @CompileStatic:&lt;/p&gt;

&lt;p&gt;def list = &lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;def sum = 0&lt;br/&gt;
list.each &lt;/p&gt;
{ sum += it }
&lt;p&gt;println(sum)&lt;/p&gt;

&lt;p&gt;sum = list.inject(0, &lt;/p&gt;
{ x, y -&amp;gt; x + y }
&lt;p&gt;)&lt;br/&gt;
println(sum)&lt;/p&gt;</description>
                <environment>IDEA 12.0 with groovy 2.0.6</environment>
        <key id="12818203">GROOVY-5874</key>
            <summary>Groovyc: BUG! exception in phase &apos;class generation&apos; in source unit </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="oliver_plow">Oliver Plow</reporter>
                        <labels>
                            <label>iterators</label>
                            <label>list</label>
                    </labels>
                <created>Thu, 3 Jan 2013 05:35:07 +0000</created>
                <updated>Sat, 12 Jan 2013 20:40:02 +0000</updated>
                            <resolved>Tue, 8 Jan 2013 09:04:07 +0000</resolved>
                                    <version>2.0.6</version>
                                    <fixVersion>2.1.0-rc-1</fixVersion>
                    <fixVersion>2.0.7</fixVersion>
                                    <component>Static compilation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14473777" author="melix" created="Mon, 7 Jan 2013 08:48:15 +0000"  >&lt;p&gt;The problem goes away if you comment out the &quot;sum = list.inject&quot; part. The reason is that the compiler infers a return type of &lt;tt&gt;Object&lt;/tt&gt; in that case, so &lt;tt&gt;sum&lt;/tt&gt; becomes a potential &lt;tt&gt;Object&lt;/tt&gt;. As it&apos;s a closure shared variable, it should have, then, refused to let you do a &quot;plus&quot; on an &lt;tt&gt;Object&lt;/tt&gt;. So there are probably two problems in one here:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;closure shared variables tests are not done if using binary expressions instead of method calls (a+b instead of a.plus(b))&lt;/li&gt;
	&lt;li&gt;inject call should &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; infer a return type of Integer&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14473869" author="melix" created="Tue, 8 Jan 2013 09:04:07 +0000"  >&lt;p&gt;The issue which is fixed here is the fact that a closure shared variable is not rechecked if it is used in a binary expression.&lt;/p&gt;

&lt;p&gt;The fact that &lt;tt&gt;inject&lt;/tt&gt; infers an &lt;tt&gt;Object&lt;/tt&gt; instead of an integer here is covered by the linked issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12816646">GROOVY-5893</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c52n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>