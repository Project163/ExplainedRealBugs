<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:20:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8243] SAM trait coercion via middle interface</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8243</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;trait T {
    &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; def foo(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i)

    def bar(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; j) {
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;bar $j&quot;&lt;/span&gt;
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; F &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; T {}

F t = { println &lt;span class=&quot;code-quote&quot;&gt;&quot;closure $it&quot;&lt;/span&gt; }
t.foo(42) &lt;span class=&quot;code-comment&quot;&gt;// `closure 42`
&lt;/span&gt;t.bar(43) &lt;span class=&quot;code-comment&quot;&gt;// `closure 43.0`; should be `bar 43.0`&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Changing variable type to &lt;tt&gt;T&lt;/tt&gt; works as expected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13083831">GROOVY-8243</key>
            <summary>SAM trait coercion via middle interface</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="daniilo">Daniil Ovchinnikov</reporter>
                        <labels>
                            <label>trait</label>
                            <label>traits</label>
                    </labels>
                <created>Fri, 30 Jun 2017 15:50:56 +0000</created>
                <updated>Wed, 12 Oct 2022 18:31:56 +0000</updated>
                            <resolved>Mon, 21 Mar 2022 04:48:25 +0000</resolved>
                                    <version>2.4.10</version>
                                    <fixVersion>3.0.11</fixVersion>
                    <fixVersion>4.0.2</fixVersion>
                    <fixVersion>2.5.19</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16070345" author="daniilo" created="Fri, 30 Jun 2017 16:11:55 +0000"  >&lt;p&gt;If traits are not SAM candidates, please  throw GroovyCastException on assignment.&lt;/p&gt;</comment>
                            <comment id="17509328" author="emilles" created="Sat, 19 Mar 2022 19:35:43 +0000"  >&lt;p&gt;The trait presents as this interface to the JVM:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; T {
  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; foo(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i);
  &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; bar(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; j);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So when &lt;tt&gt;java.lang.reflect.Proxy&lt;/tt&gt; is created for the closure and interface &lt;tt&gt;F&lt;/tt&gt;, both &lt;tt&gt;foo(int)&lt;/tt&gt; and &lt;tt&gt;bar(double)&lt;/tt&gt; are routed to the closure.&lt;/p&gt;

&lt;p&gt;If &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8299&quot; title=&quot;Generate bytecode for interface with default, private and static methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8299&quot;&gt;&lt;del&gt;GROOVY-8299&lt;/del&gt;&lt;/a&gt; is completed, it is possible that non-abstract, public trait methods could be implemented as native default interface methods.  However, that ticket is about interfaces and may or may not affect traits.  &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10000&quot; title=&quot;Traits should be able to hold constants&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10000&quot;&gt;GROOVY-10000&lt;/a&gt; is another ticket that suggests to me that some consistency between interfaces and traits for static finals and non-private, non-static methods is expected.&lt;/p&gt;</comment>
                            <comment id="17509509" author="emilles" created="Sun, 20 Mar 2022 19:52:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/pull/1704&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1704&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If there is more than one abstract method, then the coerce will still work the way described in the problem since it falls to the Java &lt;tt&gt;Proxy&lt;/tt&gt; path.  In that case, you can use a map with more than one closure, like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
F f = [foo: { ... }, baz: { ... }]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17509600" author="paulk" created="Mon, 21 Mar 2022 04:48:25 +0000"  >&lt;p&gt;Proposed PR merged, thanks!&lt;/p&gt;</comment>
                            <comment id="17574402" author="chessami92" created="Tue, 2 Aug 2022 21:19:26 +0000"  >&lt;p&gt;Not sure if this is the appropriate ticket, but as of 3.0.11 the below code no longer works; it now prints out &lt;tt&gt;null&lt;/tt&gt; instead of&#160;&lt;tt&gt;string b&lt;/tt&gt;. Seems like it is relying on the native object instead of the &lt;tt&gt;$closure$delegate$map&lt;/tt&gt;?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
&#160; &#160; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; b
}

def a = [getB: { &lt;span class=&quot;code-quote&quot;&gt;&apos;string b&apos;&lt;/span&gt; }] as A
println a.b
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17574403" author="emilles" created="Tue, 2 Aug 2022 21:30:33 +0000"  >&lt;p&gt;Please create a new ticket.  You can link-to/reference any others you think are relevant.&lt;/p&gt;</comment>
                            <comment id="17574934" author="emilles" created="Wed, 3 Aug 2022 21:32:42 +0000"  >&lt;p&gt;Map to type coercion is briefly described here, but there is no mention of what happens if the type supplies some methods. &lt;a href=&quot;https://groovy-lang.org/semantics.html#_map_to_type_coercion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://groovy-lang.org/semantics.html#_map_to_type_coercion&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17575395" author="chessami92" created="Thu, 4 Aug 2022 18:29:22 +0000"  >&lt;p&gt;Created&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-10717&quot; title=&quot;Map to type coercion not working on abstract classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-10717&quot;&gt;&lt;del&gt;GROOVY-10717&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 14 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3gyif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>