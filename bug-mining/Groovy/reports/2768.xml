<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:43:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3457] GStringTemplateEngine fails to work with &gt;64K strings</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3457</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I am initialising the GStringTemplate with the contens of a large (&amp;gt;64K)&lt;br/&gt;
file and getting the following error:&lt;br/&gt;
java.lang.ClassFormatError: Unknown constant tag 121 in class file&lt;br/&gt;
groovy/tmp/templates/GStringTemplateScript11$_getTemplate_closure1&lt;/p&gt;

&lt;p&gt;I am using the following Groovy script step with code:&lt;br/&gt;
import groovy.text.*&lt;/p&gt;

&lt;p&gt;def binding = &lt;span class=&quot;error&quot;&gt;&amp;#91;wid: &amp;quot;123123123&amp;quot;&amp;#93;&lt;/span&gt;&lt;br/&gt;
def engine = new GStringTemplateEngine()&lt;br/&gt;
def template = engine.createTemplate(new&lt;br/&gt;
File(&quot;test_message1.xml&quot;)).make(binding)&lt;br/&gt;
println template.toString()&lt;/p&gt;

&lt;p&gt;The message is attached as well.&lt;/p&gt;</description>
                <environment>JRE 1.6 Windows&lt;br/&gt;
Groovy 1.5.7 and 1.6.1</environment>
        <key id="12814610">GROOVY-3457</key>
            <summary>GStringTemplateEngine fails to work with &gt;64K strings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="mchayat">Michael Chayat</reporter>
                        <labels>
                            <label>ClassFormatError</label>
                    </labels>
                <created>Tue, 7 Apr 2009 19:06:46 +0000</created>
                <updated>Sun, 22 May 2022 16:06:04 +0000</updated>
                            <resolved>Wed, 5 Nov 2014 08:19:11 +0000</resolved>
                                    <version>1.5.6</version>
                    <version>1.6.1</version>
                                    <fixVersion>2.4.0-beta-4</fixVersion>
                                    <component>Templating</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14467139" author="roshandawrani" created="Wed, 3 Jun 2009 11:49:59 +0000"  >&lt;p&gt;The ClassFormatError reported in this JIRA has been fixed as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2382&quot; title=&quot;64K limit on strings -- Caught: java.lang.ClassFormatError: Unknown constant tag 84 in class file test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2382&quot;&gt;&lt;del&gt;GROOVY-2382&lt;/del&gt;&lt;/a&gt;. Prior to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2382&quot; title=&quot;64K limit on strings -- Caught: java.lang.ClassFormatError: Unknown constant tag 84 in class file test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2382&quot;&gt;&lt;del&gt;GROOVY-2382&lt;/del&gt;&lt;/a&gt; fix, the groovy compiler did not complain about strings &amp;gt; 64K and generated invalid class files.&lt;/p&gt;

&lt;p&gt;Even though groovy still does not support strings &amp;gt; 64K, now the compiler rejects the code with such long strings with an appropriate error message.&lt;/p&gt;

&lt;p&gt;So, the thing to solve for this JIRA is adding support for for strings &amp;gt; 64K and not the ClassFormatError. Just wanted to make a note of it here.&lt;/p&gt;

&lt;p&gt;It was discussed on the mailing list at &lt;a href=&quot;http://www.nabble.com/Re%3A--jira--Created%3A-%28GROOVY-3457%29-GStringTemplateEngine-fails-to-work--with-%3E64K-strings-td23830275.html#a23854673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Re%3A--jira--Created%3A-%28GROOVY-3457%29-GStringTemplateEngine-fails-to-work--with-%3E64K-strings-td23830275.html#a23854673&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14467160" author="mchayat" created="Wed, 3 Jun 2009 19:08:52 +0000"  >&lt;p&gt;Thanks for the clarification. I was also wondering what is the process to get it assigned to somebody to look at. &lt;/p&gt;</comment>
                            <comment id="14467056" author="roshandawrani" created="Wed, 3 Jun 2009 19:53:38 +0000"  >&lt;p&gt;Hi Michael,&lt;br/&gt;
From what I have seen of Groovy project, it, mostly, works the other way around. Development team members pick up the issues on their own.&lt;/p&gt;

&lt;p&gt;Leaving a comment on the JIRA is a good way to highlight it again, though. &lt;/p&gt;

&lt;p&gt;Jochen, Guillaume, Paul, etc respond to such comments quite actively, from what I have seen.&lt;/p&gt;

&lt;p&gt;rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14473956" author="pschumacher" created="Fri, 18 Jan 2013 14:58:12 +0000"  >&lt;p&gt;Should we just add this limitation to the groovy doc and close this issue?&lt;/p&gt;</comment>
                            <comment id="14475499" author="mbjarland" created="Tue, 11 Feb 2014 05:38:40 +0000"  >&lt;p&gt;The following alternative template engine works with larger strings (including the example attached to this ticket): &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mbjarland/groovy-streaming-template-engine&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mbjarland/groovy-streaming-template-engine&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the following code demonstrates this: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@GrabResolver(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;groovy-template&apos;&lt;/span&gt;, root=&lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//artifacts.iteego.com/artifactory/&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;-release-local&apos;&lt;/span&gt;)
&lt;/span&gt;@Grab(&lt;span class=&quot;code-quote&quot;&gt;&apos;org.codehaus.groovy:groovy-streaming-template-engine:2.1.9-SNAPSHOT&apos;&lt;/span&gt;)
&lt;span class=&quot;code-comment&quot;&gt;//@Grab(&lt;span class=&quot;code-quote&quot;&gt;&apos;org.codehaus.groovy:groovy-templates:2.1.6&apos;&lt;/span&gt;)
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.text.StreamingTemplateEngine
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.text.*

def binding = [wid: &lt;span class=&quot;code-quote&quot;&gt;&quot;123123123&quot;&lt;/span&gt;]

def engine = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamingTemplateEngine()
def template = engine.createTemplate(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_message1.xml&quot;&lt;/span&gt;)).make(binding)
println template.toString()

println &lt;span class=&quot;code-quote&quot;&gt;&quot;Streaming works...&quot;&lt;/span&gt;

def engine2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GStringTemplateEngine()
&lt;span class=&quot;code-comment&quot;&gt;// ...the below &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; exceptions
&lt;/span&gt;def template2 = engine2.createTemplate(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_message1.xml&quot;&lt;/span&gt;)).make(binding)
println template2.toString()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should I bother reformatting the code for a pull request?&lt;/p&gt;</comment>
                            <comment id="14475359" author="melix" created="Wed, 12 Feb 2014 08:19:40 +0000"  >&lt;p&gt;@Matias: Yes, it would be a nice addition. Funny that you are doing this right now, as I am also working on an alternative template engine for Groovy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14476112" author="ldaley" created="Wed, 2 Jul 2014 19:32:34 +0000"  >&lt;p&gt;This has become a problem for us in Gradle.&lt;/p&gt;

&lt;p&gt;Can this 64k limit be removed? Or should we look at using Matias&apos;s impl?&lt;/p&gt;</comment>
                            <comment id="14476208" author="melix" created="Thu, 3 Jul 2014 02:43:10 +0000"  >&lt;p&gt;No, the limit is at the JVM level. Would be nice if Matias could come up with a pull request. I am curious about how it impacts Gradle.&lt;/p&gt;</comment>
                            <comment id="14476169" author="ldaley" created="Thu, 3 Jul 2014 03:09:27 +0000"  >&lt;p&gt;See &lt;a href=&quot;http://forums.gradle.org/gradle/topics/cannot_filter_files_bigger_than_64k&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forums.gradle.org/gradle/topics/cannot_filter_files_bigger_than_64k&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476190" author="blackdrag" created="Thu, 3 Jul 2014 06:10:51 +0000"  >&lt;p&gt;One idea to fix the problem could be to try to calculate the estimated bytecode size of the string and then rather than having it as a single string, split it into several string, that then are concatenated. We actually have something similar for list literals&lt;/p&gt;</comment>
                            <comment id="14476407" author="etienne" created="Tue, 12 Aug 2014 06:20:18 +0000"  >&lt;p&gt;Btw, Matias&apos; implementation is currently licensed under GNU.&lt;/p&gt;</comment>
                            <comment id="14480712" author="paulk" created="Wed, 13 Aug 2014 04:08:10 +0000"  >&lt;p&gt;Looked like it was Apache 2 license to me?&lt;/p&gt;</comment>
                            <comment id="14476361" author="mbjarland" created="Wed, 13 Aug 2014 10:50:57 +0000"  >&lt;p&gt;Sorry for the confusion. I had some old cut-and-pasted text in build.gradle (the actual source files were referring to the Apache license). This has now been corrected, appropriate readme text etc has been added, and it should now be more obvious that the project is under the Apache license. &lt;/p&gt;

&lt;p&gt;For those new to this conversation, we are talking about an additional template engine which can be found here &lt;a href=&quot;https://github.com/mbjarland/groovy-streaming-template-engine&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mbjarland/groovy-streaming-template-engine&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476230" author="mbjarland" created="Wed, 13 Aug 2014 12:49:04 +0000"  >&lt;p&gt;Reformatted the code and added a pull request which adds the StreamingTemplateEngine and relevant support and unit test classes to groovy-core at: &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/groovy/groovy-core/pull/503&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/503&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14476337" author="etienne" created="Thu, 14 Aug 2014 01:38:58 +0000"  >&lt;p&gt;Thanks for resolving the confusion on the licensing. It would be great to see your pull request accepted into groovy-core!&lt;/p&gt;</comment>
                            <comment id="14476636" author="melix" created="Wed, 5 Nov 2014 08:19:11 +0000"  >&lt;p&gt;Implemented through &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/503&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/503&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476567" author="etienne" created="Fri, 7 Nov 2014 01:27:07 +0000"  >&lt;p&gt;I don&apos;t think this issue is resolved until the $var notation is supported. Or was this missing feature added when the new template engine was merged into the Groovy code base?&lt;/p&gt;</comment>
                            <comment id="14476702" author="melix" created="Fri, 7 Nov 2014 03:40:56 +0000"  >&lt;p&gt;It&apos;s a new template engine, so there&apos;s no regression at all. Note that not supporting the $var notation is a limitation of this one, but it&apos;s not a blocker. Last but not least, with the markup template engine, you can easily workaround the 64k limit by performing includes or layouts.&lt;/p&gt;</comment>
                            <comment id="14476655" author="ldaley" created="Fri, 7 Nov 2014 03:46:04 +0000"  >&lt;p&gt;Cedric: can it be made to support it? Or is there something inherent in its implementation that means it can never support it?&lt;/p&gt;</comment>
                            <comment id="14476727" author="melix" created="Fri, 7 Nov 2014 07:01:56 +0000"  >&lt;p&gt;I think it can be made to support it. I didn&apos;t investigate much, but since ${var} is supported, $var could be easily supported thanks to an AST xform that converts from $var to ${var}.&lt;/p&gt;
</comment>
                            <comment id="14476743" author="pschumacher" created="Fri, 7 Nov 2014 16:30:11 +0000"  >&lt;p&gt;Matias Bjarland submitted a new &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pull request&lt;/a&gt; which adds the $var notation to the new StreamingTemplateEngine.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722037" name="test_message1.xml" size="145784" author="mchayat" created="Tue, 7 Apr 2009 19:06:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bo47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>