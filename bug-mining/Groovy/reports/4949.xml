<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:26:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11614] Enums in switch/case statements that are not fully qualified will cause a groovy compile error but Java requires enums to &quot;not&quot; be fully qualified</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11614</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This is a difference in Java vs Groovy behaviour. Enums must be fully qualified in Groovy while Java requires them to not be fully qualified.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;This was supposedly fixed, but does not seem to work in 4.0.24. Not sure where it broke.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
void test(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State ts) {
  &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (ts) {
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State.NEW: &lt;span class=&quot;code-comment&quot;&gt;// cannot remove &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State.&quot;&lt;/span&gt; without @CompileStatic
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13615098">GROOVY-11614</key>
            <summary>Enums in switch/case statements that are not fully qualified will cause a groovy compile error but Java requires enums to &quot;not&quot; be fully qualified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="chavan77">Saravanan</reporter>
                        <labels>
                    </labels>
                <created>Sun, 13 Apr 2025 07:24:09 +0000</created>
                <updated>Tue, 8 Jul 2025 19:02:22 +0000</updated>
                            <resolved>Sat, 26 Apr 2025 13:12:59 +0000</resolved>
                                    <version>4.0.24</version>
                    <version>5.0.0-alpha-12</version>
                                    <fixVersion>5.0.0-beta-1</fixVersion>
                    <fixVersion>4.0.27</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17943919" author="paulk" created="Sun, 13 Apr 2025 12:49:57 +0000"  >&lt;p&gt;As per &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8444&quot; title=&quot;Support unqualified enum constants in switch cases (like Java)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8444&quot;&gt;&lt;del&gt;GROOVY-8444&lt;/del&gt;&lt;/a&gt;, the enum type can be elided when TypeChecked/CompileStatic is used,&lt;br/&gt;
but it seems like switch statements only and not switch expressions currently:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Letter { A, B, C, D }

@groovy.transform.TypeChecked
def method(Letter x) {
    &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;(x) {
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; A: println &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; B: println &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;:
            println &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;(x) {
                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; C -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;
                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; D -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;d&apos;&lt;/span&gt;
            }
    }
}

method(Letter.A)
method(Letter.B)
method(Letter.C)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;a
b
Exception thrown
groovy.lang.MissingPropertyException: No such property: C
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="17944705" author="paulk" created="Tue, 15 Apr 2025 12:47:55 +0000"  >&lt;p&gt;We can extend the current functionality (elide enum type when type checking) to switch expressions fairly easily:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/src/main/java/org/codehaus/groovy/control/CompilationUnit.java b/src/main/java/org/codehaus/groovy/control/CompilationUnit.java
--- a/src/main/java/org/codehaus/groovy/control/CompilationUnit.java	(revision daabca58aafc64f42cf6a4679e57e66f66354889)
+++ b/src/main/java/org/codehaus/groovy/control/CompilationUnit.java	(date 1744720585502)
@@ -31,6 +31,7 @@
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.InnerClassNode;
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.ModuleNode;
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.expr.Expression;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.expr.MethodCallExpression;
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.ast.expr.VariableExpression;
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.classgen.AsmClassGenerator;
 &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.codehaus.groovy.classgen.ClassCompletionVerifier;
@@ -372,6 +373,9 @@
                             setSourcePosition(propertyExpression, expression);
                             &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; propertyExpression;
                         }
+                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (expression &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; MethodCallExpression) {
+                        expression.visit(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
+                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; expression;
                     }
                     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; expression;
                 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It might be an expensive operation though. It might be better to place a marker on switch expressions at the point of creation:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/java/org/apache/groovy/parser/antlr4/AstBuilder.java#L983&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/master/src/main/java/org/apache/groovy/parser/antlr4/AstBuilder.java#L983&lt;/a&gt;&lt;br/&gt;
And do the visit only when we find the marker.&lt;/p&gt;</comment>
                            <comment id="17945241" author="githubbot" created="Thu, 17 Apr 2025 06:16:15 +0000"  >&lt;p&gt;paulk-asert opened a new pull request, #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &#8230;ified will cause a groovy compile error for switch expressions even with type checking enabled&lt;/p&gt;

</comment>
                            <comment id="17945254" author="githubbot" created="Thu, 17 Apr 2025 06:41:15 +0000"  >&lt;p&gt;codecov-commenter commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2811947062&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2811947062&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Codecov&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2199?dropdown=coverage&amp;amp;src=pr&amp;amp;el=h1&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2199?dropdown=coverage&amp;amp;src=pr&amp;amp;el=h1&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) Report&lt;br/&gt;
   All modified and coverable lines are covered by tests :white_check_mark:&lt;br/&gt;
   &amp;gt; Project coverage is 68.9408%. Comparing base &lt;span class=&quot;error&quot;&gt;&amp;#91;(`b7711d8`)&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/commit/b7711d8511da7d9eb55af7a4a9a66e736cc8b914?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/commit/b7711d8511da7d9eb55af7a4a9a66e736cc8b914?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) to head &lt;span class=&quot;error&quot;&gt;&amp;#91;(`3b05487`)&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/commit/3b054877c219b3db7200a83e07e32e15f38a3315?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/commit/3b054877c219b3db7200a83e07e32e15f38a3315?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;).&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;   &amp;lt;details&amp;gt;&amp;lt;summary&amp;gt;Additional details and impacted files&amp;lt;/summary&amp;gt;&lt;/p&gt;


&lt;p&gt;   [!&lt;span class=&quot;error&quot;&gt;&amp;#91;Impacted file tree graph&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2199/graphs/tree.svg?width=650&amp;amp;height=150&amp;amp;src=pr&amp;amp;token=1r45138NfQ&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache)](https://app.codecov.io/gh/apache/groovy/pull/2199?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2199/graphs/tree.svg?width=650&amp;amp;height=150&amp;amp;src=pr&amp;amp;token=1r45138NfQ&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache)](https://app.codecov.io/gh/apache/groovy/pull/2199?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   ```diff&lt;br/&gt;
   @@                Coverage Diff                 @@&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;master      #2199        +/-   ##&lt;br/&gt;
   ==================================================&lt;br/&gt;
   + Coverage     68.9403%   68.9408%   +0.0005%     &lt;br/&gt;
   + Complexity      29552      29550         -2     &lt;br/&gt;
   ==================================================&lt;br/&gt;
     Files            1423       1423                &lt;br/&gt;
     Lines          113900     113905         +5     &lt;br/&gt;
     Branches        19752      19754         +2     &lt;br/&gt;
   ==================================================&lt;br/&gt;
   + Hits            78523      78527         +4     &lt;br/&gt;
     Misses          28776      28776                &lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Partials         6601       6602         +1&lt;br/&gt;
   ```&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Files with missing lines&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2199?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2199?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Coverage &#916; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;...a/org/codehaus/groovy/control/CompilationUnit.java&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2199?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fcontrol%2FCompilationUnit.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NvbnRyb2wvQ29tcGlsYXRpb25Vbml0LmphdmE=&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2199?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fcontrol%2FCompilationUnit.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NvbnRyb2wvQ29tcGlsYXRpb25Vbml0LmphdmE=&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; `80.6794% &amp;lt;100.0000%&amp;gt; (+0.2073%)` &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; :arrow_up: &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;   ... and &lt;span class=&quot;error&quot;&gt;&amp;#91;4 files with indirect coverage changes&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2199/indirect-changes?src=pr&amp;amp;el=tree-more&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2199/indirect-changes?src=pr&amp;amp;el=tree-more&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   &amp;lt;/details&amp;gt;&lt;br/&gt;
   &amp;lt;details&amp;gt;&amp;lt;summary&amp;gt; :rocket: New features to boost your workflow: &amp;lt;/summary&amp;gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;:snowflake: &lt;span class=&quot;error&quot;&gt;&amp;#91;Test Analytics&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.codecov.com/docs/test-analytics):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.codecov.com/docs/test-analytics):&lt;/a&gt; Detect flaky tests, report on failures, and find test suite problems.&lt;/li&gt;
	&lt;li&gt;:package: &lt;span class=&quot;error&quot;&gt;&amp;#91;JS Bundle Analysis&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.codecov.com/docs/javascript-bundle-analysis):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.codecov.com/docs/javascript-bundle-analysis):&lt;/a&gt; Save yourself from yourself by tracking and limiting bundle sizes in JS merges.&lt;br/&gt;
   &amp;lt;/details&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


</comment>
                            <comment id="17945389" author="githubbot" created="Thu, 17 Apr 2025 13:21:49 +0000"  >&lt;p&gt;eric-milles commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2812884480&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2812884480&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Can you explain the design of this one?  I don&apos;t quite follow.  I think this plays into the reason we limited the previous fix to STC.&lt;/p&gt;

</comment>
                            <comment id="17945400" author="githubbot" created="Thu, 17 Apr 2025 13:43:23 +0000"  >&lt;p&gt;paulk-asert commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2812980365&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2812980365&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &amp;gt; Can you explain the design of this one? I don&apos;t quite follow. I think this plays into the reason we limited the previous fix to STC.&lt;/p&gt;

&lt;p&gt;   This just applies the previous fix (so only STC) to Switch Expressions as well as Switch Statements. The ClassCodeExpressionTransformer for the previous fix doesn&apos;t normally traverse deeply. We &quot;create&quot; a Switch Expression by wrapping a Switch Statement into a Closure. The change here just causes it to traverse deeper into the wrapped code. I did try adding some additional marker metadata to make traversal even more selective, but it was transformed away before it gets to where we&apos;d look it up. We could try to track down where that happens and make it preserve the metadata, but looking inside for the Closure expression should eliminate many traversal paths.&lt;/p&gt;

</comment>
                            <comment id="17945554" author="githubbot" created="Fri, 18 Apr 2025 00:45:43 +0000"  >&lt;p&gt;daniellansun commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2814267260&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2814267260&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   LGTM.&lt;/p&gt;

&lt;p&gt;   P.S. It&apos;s better to add some marker to limit visiting further.&lt;/p&gt;

</comment>
                            <comment id="17945704" author="githubbot" created="Fri, 18 Apr 2025 15:39:03 +0000"  >&lt;p&gt;eric-milles commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2815666933&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2815666933&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Is it possible for the switch expression closure to delegate to the enum class?  Would that be safe to do?&lt;/p&gt;

</comment>
                            <comment id="17945809" author="githubbot" created="Sat, 19 Apr 2025 05:27:11 +0000"  >&lt;p&gt;daniellansun commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2816547275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2816547275&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   If switch expression closure delegates to the enum class, switch expression and switch statement will be different. As a result, it&apos;s hard for users to understand if they do not know the delegating.&lt;/p&gt;

</comment>
                            <comment id="17945981" author="githubbot" created="Sun, 20 Apr 2025 15:58:15 +0000"  >&lt;p&gt;eric-milles commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2817232959&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2817232959&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   They are already different.  Switch statement supports unqualified enum constants under STC.  Switch expression does not.  The expression case could be made to work with delegation, in my estimation.  It could be limited to STC as well for the initial cut.  Any other differences in behavior could be listed.&lt;/p&gt;

</comment>
                            <comment id="17945984" author="githubbot" created="Sun, 20 Apr 2025 17:00:11 +0000"  >&lt;p&gt;daniellansun commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2817255442&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2817255442&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   If delegation applied, method calls within switch expression can also be delegated to enum class. But switch statement treats the method calls as invalid.&lt;/p&gt;

</comment>
                            <comment id="17946133" author="emilles" created="Mon, 21 Apr 2025 13:45:31 +0000"  >&lt;p&gt;If the delegation policy is &quot;owner first&quot; then the outer scope will get first crack at any variable or method invocation.  Not sure how to limit to the cases.  Just an idea.&lt;/p&gt;</comment>
                            <comment id="17946238" author="githubbot" created="Mon, 21 Apr 2025 21:57:01 +0000"  >&lt;p&gt;daniellansun merged PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17946239" author="githubbot" created="Mon, 21 Apr 2025 21:57:25 +0000"  >&lt;p&gt;daniellansun commented on PR #2199:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2199#issuecomment-2819582901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2199#issuecomment-2819582901&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Merged. Thanks.&lt;/p&gt;

</comment>
                            <comment id="17946496" author="emilles" created="Tue, 22 Apr 2025 17:58:11 +0000"  >&lt;p&gt;Changes so far bring switch statement and expression into alignment for STC and SC.  Unqualified enum const names still fail for dynamic mode.&lt;/p&gt;</comment>
                            <comment id="17946543" author="paulk" created="Tue, 22 Apr 2025 20:34:11 +0000"  >&lt;p&gt;Yes, that was the intent of the PR. I think that is worth doing for consistency of the current behavior. If we also want to explore an option for dynamic Groovy, I&apos;d suggest cloning the issue. I believe the current changes are safe for GROOVY_4_0_X. But a change to the delegation policy would be a breaking change and would be 5 only. On this issue, we still have an optional optimization we could do to limit walking the AST more than needed but the obvious fix doesn&apos;t work. We can make that another issue too.&lt;/p&gt;</comment>
                            <comment id="17995763" author="chavan77" created="Fri, 4 Jul 2025 13:03:47 +0000"  >&lt;p&gt;Hi Paul, I am still seeing this error on 5.0.0.beta.1&lt;/p&gt;

&lt;p&gt;Not sure if this is specific to some condition&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;RecordTesting {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Thing{
        ME,
        YOU
    };

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; create(Thing a) {

        &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (a) {
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; ME: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;STR&quot;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; YOU: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;YOU&quot;&lt;/span&gt;; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &quot;&quot;
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Causes a compile error (I am using @CompileStatic)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:
testdata/plugins/records/RecordTesting.java: -1: Access to com.Records.RecordTesting#ME is forbidden @ line -1, column -1.
testdata/plugins/records/RecordTesting.java: -1: Access to com.Records.RecordTesting#YOU is forbidden @ line -1, column -1.
2 errors
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17997754" author="paulk" created="Sat, 5 Jul 2025 10:47:10 +0000"  >&lt;p&gt;The following script works for me (on master):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;RecordTesting {
    &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Thing {
        ME,
        YOU
    }

    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; create(Thing a) {
        &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (a) {
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; ME: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;STR&quot;&lt;/span&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; YOU: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;YOU&quot;&lt;/span&gt;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &quot;&quot;
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RecordTesting().create(RecordTesting.Thing.ME) == &lt;span class=&quot;code-quote&quot;&gt;&apos;STR&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do you have an AST transform that might be altering the AST to be something different from what Groovy is expecting?&lt;/p&gt;

&lt;p&gt;When I run this in the GroovyConsole and invoke Script -&amp;gt; Inspect AST, I see the transformed code that looks like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; RecordTesting$Thing.ME:
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;STR&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do you see something different in your environment?&lt;/p&gt;</comment>
                            <comment id="17997761" author="chavan77" created="Sat, 5 Jul 2025 11:37:09 +0000"  >&lt;p&gt;I think the difference between your code and mine is that you have @CompileStatic on the class while I am applying it on the compiler configuration like this (Excuse the kotlin code style). I am adding a compilation customizer to apply CompileStatic to all classes&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
GroovyClassLoader(
    TestRecordsPlugin::&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;java.classLoader,
    CompilerConfiguration().also {
        it.setTargetDirectory(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/groovy/&quot;&lt;/span&gt;)
        it.addCompilationCustomizers(ASTTransformationCustomizer(CompileStatic::&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;java))
    }
).also {
    it.parseClass(File(&lt;span class=&quot;code-quote&quot;&gt;&quot;testdata/plugins/records/RecordTesting.java&quot;&lt;/span&gt;))
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Sure enough if I add CompileStatic to the class, it works as expected. How do I continue to apply CompileStatic for everything?&lt;/p&gt;</comment>
                            <comment id="17998269" author="emilles" created="Sat, 5 Jul 2025 13:04:35 +0000"  >&lt;p&gt;Direct annotation and compiler config application should work the same. We&#8217;ll need to check why there is a behavior difference. &lt;/p&gt;</comment>
                            <comment id="18003872" author="emilles" created="Tue, 8 Jul 2025 19:02:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/81098ecb525b55455fb6490a9fe0ceed5218233c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/81098ecb525b55455fb6490a9fe0ceed5218233c&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13130239">GROOVY-8444</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vc2g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>