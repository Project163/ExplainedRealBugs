<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:16:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6837] String[] + String[] gives Object[]</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6837</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def a1 = [&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;] as &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[], a2 = [&lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;d&quot;&lt;/span&gt;] as &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[];
def concatenated = a1 + a2;
java.nio.file.Paths.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;parent&quot;&lt;/span&gt;, concatenated)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;==&amp;gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;groovy.lang.MissingMethodException: No signature of method: static java.nio.file.Paths.get() is applicable for argument types: (java.lang.String, [Ljava.lang.Object;) values: [parent, [a, b, c, d]]
Possible solutions: get(java.lang.String, [Ljava.lang.String;), get(java.net.URI), grep(), getAt(java.lang.String), wait(), any()
	at groovy.lang.MetaClassImpl.invokeStaticMissingMethod(MetaClassImpl.java:1373)
	at groovy.lang.MetaClassImpl.invokeStaticMethod(MetaClassImpl.java:1359)
	at org.codehaus.groovy.runtime.callsite.StaticMetaClassSite.call(StaticMetaClassSite.java:50)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:45)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:120)
	at ideaGroovyConsole.run(ideaGroovyConsole.groovy:4)
	at groovy.lang.GroovyShell.runScriptOrMainOrTestOrRunnable(GroovyShell.java:258)
	at groovy.lang.GroovyShell.run(GroovyShell.java:502)
	at groovy.lang.GroovyShell.run(GroovyShell.java:481)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:166)
	at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.call(PogoMetaMethodSite.java:68)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:120)
	at console.run(console.txt:25)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12818312">GROOVY-6837</key>
            <summary>String[] + String[] gives Object[]</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="dmovchinn">Dmitry Ovchinnikov</reporter>
                        <labels>
                            <label>breaking</label>
                    </labels>
                <created>Thu, 29 May 2014 08:06:06 +0000</created>
                <updated>Tue, 23 Jan 2024 22:25:28 +0000</updated>
                            <resolved>Fri, 14 Jan 2022 02:38:11 +0000</resolved>
                                    <version>2.3.1</version>
                                    <fixVersion>4.0.0</fixVersion>
                    <fixVersion>3.0.21</fixVersion>
                                    <component>groovy-runtime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="14480538" author="paulk" created="Thu, 29 May 2014 16:10:25 +0000"  >&lt;p&gt;Looking at the DGM#plus code, it always returns Object[] from toArray() despite the wishful thinking cast:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(T[] left, T[] right) {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (T[]) plus(toList(left), toList(right)).toArray();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We could use &lt;tt&gt;Array.newInstance()&lt;/tt&gt; to fix the returned type but we&apos;d need to calculate the least upper bound types for the left and right component types (or give preference to say the left component type and potentially have a non-commutative operator). We do calculate LUB on class nodes in the static compiler but pretty sure we don&apos;t currently have that exposed as a runtime method (and we couldn&apos;t expose as rich a version as we use in the static compiler in any case).&lt;/p&gt;

&lt;p&gt;In the meantime, you&apos;ll have to use &apos;as String[]&apos; as the workaround.&lt;/p&gt;</comment>
                            <comment id="14480588" author="paulk" created="Thu, 29 May 2014 17:44:35 +0000"  >&lt;p&gt;We could possibly change &lt;tt&gt;plus&lt;/tt&gt; to something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(T[] left, T[] right) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; plus(toList(left), toList(right)).toArray((T[])Array.newInstance(poormansLUB(left.getClass().getComponentType(), right.getClass().getComponentType()), left.length + right.length));
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; poormansLUB(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; leftType, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; rightType) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (leftType.equals(rightType)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; leftType;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (leftType.isAssignableFrom(rightType)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; leftType;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rightType.isAssignableFrom(leftType)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; rightType;
        Comparator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; comparator = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Comparator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt;() {
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; o1, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; o2) {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o1.getSuperclass().equals(o2) ? -1 : o2.getSuperclass().equals(o1) ? 1 : 0;
            }
        };
        Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; commonSupers = intersect(superClasses(leftType), superClasses(rightType));
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!commonSupers.isEmpty()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; first(sort((Iterable&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt;)commonSupers, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, comparator));
        }
        Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; commonInterfaces = intersect(Arrays.asList(leftType.getInterfaces()), Arrays.asList(rightType.getInterfaces()));
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!commonInterfaces.isEmpty()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; first(sort((Iterable&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt;)commonInterfaces, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, comparator));
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.class;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; superClasses(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; clazz) {
        List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; results = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt;();
        &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; next = clazz.getSuperclass();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;equals(next)) {
            results.add(next);
            next = next.getSuperclass();
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; results;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14475915" author="melix" created="Fri, 30 May 2014 10:26:32 +0000"  >&lt;p&gt;I expect such a change to have a significant impact on performance.&lt;/p&gt;</comment>
                            <comment id="14480554" author="paulk" created="Fri, 30 May 2014 14:58:19 +0000"  >&lt;p&gt;There will be a performance hit. Array.newInstance cops a reflection hit. We could put in a check to avoid that for the common Object[] case. Searching through super classes or interfaces would also slow things down but would be fairly rare I would have thought. And I would have thought usage of array plus was much less common than List plus.&lt;/p&gt;

&lt;p&gt;I guess it boils down to what we think is correct behavior. It seems to me we should either change the signature of the DGM method to return Object[] or do something like above.&lt;/p&gt;</comment>
                            <comment id="17470114" author="emilles" created="Thu, 6 Jan 2022 18:34:41 +0000"  >&lt;p&gt;Currently, &quot;Class[] types = []; types += String&quot; creates the Object[] in plus, then a collection followed by the proper Class[] in DefaultTypeTransformation#castToType, so I&apos;m not so sure it would be a performance hit to create the proper array type up front.&lt;/p&gt;</comment>
                            <comment id="17470117" author="emilles" created="Thu, 6 Jan 2022 18:37:03 +0000"  >&lt;p&gt;Also, &lt;tt&gt;DefaultGroovyMethods#plus(T[], ...)&lt;/tt&gt; is not usable from Java (or other JVM language) since it does not return the expected type (except for T is Object).&lt;/p&gt;</comment>
                            <comment id="17474491" author="paulk" created="Wed, 12 Jan 2022 12:44:40 +0000"  >&lt;p&gt;I think the LUB idea is too fancy in this scenario. Our current behavior is as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.test.GroovyAssert.shouldFail

&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] words = [&lt;span class=&quot;code-quote&quot;&gt;&apos;ant&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bee&apos;&lt;/span&gt;]
&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[] nums = [5, 10]

def result = words + nums           &lt;span class=&quot;code-comment&quot;&gt;// (1)
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[]
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result*.class == [&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;] &lt;span class=&quot;code-comment&quot;&gt;// [&lt;span class=&quot;code-quote&quot;&gt;&apos;ant&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bee&apos;&lt;/span&gt;, 5, 10]
&lt;/span&gt;words = words + nums                 &lt;span class=&quot;code-comment&quot;&gt;// (2)
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; words.class == &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; words*.class == [&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;] &lt;span class=&quot;code-comment&quot;&gt;// [&lt;span class=&quot;code-quote&quot;&gt;&apos;ant&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bee&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;5&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;10&apos;&lt;/span&gt;] due to coercion
&lt;/span&gt;
result = nums + [&lt;span class=&quot;code-quote&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dog&apos;&lt;/span&gt;]         &lt;span class=&quot;code-comment&quot;&gt;// (3)
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[]
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result*.class == [&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;]
shouldFail(ClassCastException) {
    nums = nums + [&lt;span class=&quot;code-quote&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dog&apos;&lt;/span&gt;]     &lt;span class=&quot;code-comment&quot;&gt;// (4) no auto coercion
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t think it is easy to justify why (1) and (2) provide different behavior given the RHS is the same in both. Ditto for (3) and (4). I think the behavior offered in (2) and (4) should be what &lt;tt&gt;plus&lt;/tt&gt; always provides.&lt;/p&gt;

&lt;p&gt;I think we can provide an additional (set of) method(s) named &lt;tt&gt;addAll&lt;/tt&gt; (or &lt;tt&gt;merge&lt;/tt&gt; or &lt;tt&gt;union&lt;/tt&gt; or similar) that returns &lt;tt&gt;Object[]&lt;/tt&gt; and provides the current behavior shown in (1) and (3). One could imagine overloaded variants even allowing the array return type/component type to be specified, though I wouldn&apos;t go that far to start with until we see such a need.&lt;/p&gt;</comment>
                            <comment id="17474647" author="emilles" created="Wed, 12 Jan 2022 15:59:36 +0000"  >&lt;p&gt;For (1) &quot;words = words + nums&quot;, there are two steps, first an Object[] is created like in case (1) then the assignment of Object[] to String[] runs through DefaultTypeTransformation#castToType. This second step is where you get strings &apos;5&apos; and &apos;10&apos; in the result. If &lt;tt&gt;DefaultGroovyMethods#plus(T[],T[])&lt;/tt&gt; is altered not to produce an Object[] internally, is the expectation still that numbers are converted to strings?&lt;/p&gt;

&lt;p&gt;I think the Java inference engine has a different type for T for a call &quot;String[] x; Integer[] y; plus(x,y);&quot;. I was pondering this when looking over the plus methods. I&apos;m not sure there is a type-safe way to provide &quot;def &amp;lt;T&amp;gt; T[] plus(T[] a, T[] b)&quot;. The second array may need to be Object[] so that T remains set by the first argument (left operand in &quot;a+b&quot;).&lt;/p&gt;

&lt;p&gt;Maybe &quot;def &amp;lt;T, U extends T&amp;gt; T[] plus(T[] a, U[] b)&quot; is the way to state it...&#160; Update: looks like java still uses both operands to determine T.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13038687/13038687_image-2022-01-12-10-43-14-275.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17474715" author="emilles" created="Wed, 12 Jan 2022 17:07:44 +0000"  >&lt;p&gt;&#160;This is what I have so far.  It is efficient, but the type parameters are not true to the runtime behavior.  The simplest solution would be to have all the array plus methods return &lt;tt&gt;Object[]&lt;/tt&gt;.  Another option is to have the right operand be of type &lt;tt&gt;Object[]&lt;/tt&gt; and just describe the array store exception or provide inline coercion.&lt;/p&gt;

&lt;p&gt;I looked for an example in Java and the closest I found was Arrays#fill, which is declared this way (possibly for the same reasons): &lt;tt&gt;void fill(Object[] a,Object v)&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**
     * Create an array as a union of two arrays.
     * &amp;lt;pre class=&lt;span class=&quot;code-quote&quot;&gt;&quot;groovyTestCase&quot;&lt;/span&gt;&amp;gt;
     * &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[] a = [1, 2, 3]
     * &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[] b = [4, 5, 6]
     * def result = a + b
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]{1, 2, 3, 4, 5, 6}
     *
     * &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;[] c = [-1, 0.0, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]
     * result = c + a
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;[]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;[]{-1, 0.0, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 1, 2, 3}
     * &lt;span class=&quot;code-comment&quot;&gt;// improper type arguments; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; doesn&apos;t extend &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;
&lt;/span&gt;     * groovy.test.GroovyAssert.shouldFail(ArrayStoreException) { a + c }
     * &amp;lt;/pre&amp;gt;
     *
     * @param left  the left Array
     * @param right the right Array
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; array containing right appended to left.
     * @since 1.8.7
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T[] left, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T[] right) {
        T[] result = Arrays.copyOf(left, left.length + right.length);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.arraycopy(right, 0, result, left.length, right.length);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
    }

    /**
     * Create an array containing elements from an original array plus an additional appended element.
     * &amp;lt;pre class=&lt;span class=&quot;code-quote&quot;&gt;&quot;groovyTestCase&quot;&lt;/span&gt;&amp;gt;
     * &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[] a = [1, 2, 3]
     * def result = a + 4
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]{1, 2, 3, 4}
     *
     * &lt;span class=&quot;code-comment&quot;&gt;// improper type arguments; &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; doesn&apos;t extend &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;
&lt;/span&gt;     * groovy.test.GroovyAssert.shouldFail(ArrayStoreException) { a + 5d }
     * &amp;lt;/pre&amp;gt;
     *
     * @param left  the array
     * @param right the value to append
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; array containing left with right appended to it.
     * @since 1.8.7
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T[] left, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T right) {
        T[] result = Arrays.copyOf(left, left.length + 1);
        result[left.length] = right;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
    }

    /**
     * Create an array containing elements from an original array plus those from a Collection.
     * &amp;lt;pre class=&lt;span class=&quot;code-quote&quot;&gt;&quot;groovyTestCase&quot;&lt;/span&gt;&amp;gt;
     * &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[] a = [1, 2, 3]
     * def result = a + [4, 5]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;[]{1, 2, 3, 4, 5}
     * &amp;lt;/pre&amp;gt;
     *
     * @param left  the array
     * @param right a Collection to be appended
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; array containing left with right appended to it.
     * @since 1.8.7
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T[] left, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Collection&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; T&amp;gt; right) {
        T[] result = Arrays.copyOf(left, left.length + right.size());
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = left.length;
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (T t : right) {
            result[i] = t;
            i += 1;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
    }

    /**
     * Create an array containing elements from an original array plus those from an Iterable.
     * &amp;lt;pre class=&lt;span class=&quot;code-quote&quot;&gt;&quot;groovyTestCase&quot;&lt;/span&gt;&amp;gt;
     * &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AbcIterable &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Iterable&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; {
     *     Iterator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; iterator() { &lt;span class=&quot;code-quote&quot;&gt;&quot;abc&quot;&lt;/span&gt;.iterator() }
     * }
     * &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] array = [&lt;span class=&quot;code-quote&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;y&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;z&apos;&lt;/span&gt;]
     * def result = array + &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AbcIterable()
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result.class == &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]
     * &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;y&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;}
     * &amp;lt;/pre&amp;gt;
     *
     * @param left  the array
     * @param right an Iterable to be appended
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; array containing elements from left with those from right appended.
     * @since 1.8.7
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] plus(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T[] left, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Iterable&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; T&amp;gt; right) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; plus(left, toList(right));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17475099" author="paulk" created="Thu, 13 Jan 2022 04:12:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=emilles&quot; class=&quot;user-hover&quot; rel=&quot;emilles&quot;&gt;emilles&lt;/a&gt; I built upon your previous comment but followed the second option you mentioned of having the second param type be Object:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/pull/1675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/1675&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17475522" author="emilles" created="Thu, 13 Jan 2022 16:31:27 +0000"  >&lt;p&gt;The PR looks good &amp;#8211; I did not look at the union methods.  In &lt;tt&gt;plus(T[],Collection)&lt;/tt&gt;, the &lt;tt&gt;left.getClass().getComponentType()&lt;/tt&gt; should be performed once outside the loop.&lt;/p&gt;</comment>
                            <comment id="17475901" author="paulk" created="Fri, 14 Jan 2022 02:38:11 +0000"  >&lt;p&gt;The change is breaking for those folks relying on the old behaviour. See the release notes for suggestions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13038687" name="image-2022-01-12-10-43-14-275.png" size="37997" author="emilles" created="Wed, 12 Jan 2022 16:43:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2brin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>