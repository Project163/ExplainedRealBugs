<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:15:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4038] Closure meta class respondsTo(closure, &quot;doCall&quot;) does not work</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4038</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When running the following code:&lt;/p&gt;

&lt;p&gt;Closure test = &lt;/p&gt;
{String x -&amp;gt; println x}
&lt;p&gt;;&lt;br/&gt;
println test.metaClass.respondsTo(test, &quot;doCall&quot;);&lt;/p&gt;

&lt;p&gt;The resulting output is: []&lt;/p&gt;

&lt;p&gt;Which is incorrect, since the MOP for respondsTo(Object, String) states:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; if the implementing MetaClass responds to a method with the given name &lt;b&gt;regardless&lt;/b&gt; of arguments.&lt;br/&gt;
But the Closure does respond to doCall(String), which can easily be verified using this code:&lt;/p&gt;

&lt;p&gt;println test.metaClass.respondsTo(test, &quot;doCall&quot;, &quot;Hello&quot;);&lt;/p&gt;

&lt;p&gt;which will output something similar to: &lt;span class=&quot;error&quot;&gt;&amp;#91;public MyClass$_myMethod_closure1.doCall(java.lang.String)&amp;#93;&lt;/span&gt;&lt;br/&gt;
which tells us, that the closure does respond to doCall(String).&lt;/p&gt;

&lt;p&gt;Hence, this meta method, and all other meta methods named doCall - &lt;b&gt;regardless&lt;/b&gt; of their parameters - aswell, should also be included in the list returned by respondsTo(Object,String).&lt;/p&gt;</description>
                <environment>Only tested for Groovy 1.5.7 and 1.5.8 since i am unable to compile the project with groovy 1.8.0</environment>
        <key id="12815065">GROOVY-4038</key>
            <summary>Closure meta class respondsTo(closure, &quot;doCall&quot;) does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="misterd">Joscha Drechsler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Feb 2010 06:42:21 +0000</created>
                <updated>Wed, 7 Apr 2010 23:45:11 +0000</updated>
                            <resolved>Wed, 3 Mar 2010 10:48:28 +0000</resolved>
                                    <version>1.5.7</version>
                    <version>1.5.8</version>
                                    <fixVersion>1.7.2</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14469007" author="roshandawrani" created="Wed, 3 Mar 2010 02:21:11 +0000"  >&lt;p&gt;In fact, ClosureMetaClass does not handle &quot;respondTo&quot; call for any method name. For ex, even the following does not go through&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;closureObj.metaClass.respondsTo(closureObj, &lt;span class=&quot;code-quote&quot;&gt;&quot;setResolveStrategy&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is happening because ClosureMetaClass does not do super.initialize() and hence its metaMethodIndex is always empty for any closure. So, all &quot;respondTo&quot; calls fail to find the matching method.&lt;/p&gt;

&lt;p&gt;Anyone sees any issues if we start initializing with closure class info popoulated? Will it hit the performance significantly?&lt;/p&gt;

&lt;p&gt;If it is not to be supported, may be, MetaObjectProtocol#respondsTo() documentation can be updated to tell that ClosureMetaClass do not support this call.&lt;/p&gt;</comment>
                            <comment id="14468941" author="guillaume" created="Wed, 3 Mar 2010 02:36:27 +0000"  >&lt;p&gt;As a first step, I would say it&apos;d be good to check if it has a significant (negative) impact on performance.&lt;/p&gt;</comment>
                            <comment id="14469017" author="blackdrag" created="Wed, 3 Mar 2010 03:21:34 +0000"  >&lt;p&gt;The initialize call is what makes a MetaClass expensive in memory and in computing time. So given a test with low memory, were the MetaClass of the Closure is recreated constantly would show that. I think it might be more wise to do the initialization on demand instead. That means if respondsTo is called, it should call initialize, if that has not be done yet.&lt;/p&gt;</comment>
                            <comment id="14468968" author="roshandawrani" created="Wed, 3 Mar 2010 03:26:23 +0000"  >&lt;p&gt;I like Jochen&apos;s idea. Filling it in advance may not be worth it, as respondsTo() is not something that will be frequently done.&lt;/p&gt;</comment>
                            <comment id="14469030" author="guillaume" created="Wed, 3 Mar 2010 03:36:14 +0000"  >&lt;p&gt;Yup, very good point, better do it lazily if really needed, but not in advance as this is costly.&lt;/p&gt;</comment>
                            <comment id="14468958" author="roshandawrani" created="Wed, 3 Mar 2010 04:35:50 +0000"  >&lt;p&gt;Attaching a patch for review.&lt;/p&gt;</comment>
                            <comment id="14469018" author="blackdrag" created="Wed, 3 Mar 2010 06:21:20 +0000"  >&lt;p&gt;Why did you make the applyPropertyDescriptors method protected (from private)? As for the loadMetaInfo() method... why not remove that method and isntead call initiliaze()?&lt;/p&gt;</comment>
                            <comment id="14469048" author="roshandawrani" created="Wed, 3 Mar 2010 06:28:19 +0000"  >&lt;p&gt;loadMetaInfo() had to be introduced because by the time respondsTo() is called, ClosureMetaClass initialized flag is set to true. So, if I simply call super.initialize(), it won&apos;t do anything because ClosureMetaClass#isInitialized() will return true. loadMetaInfo() temporarily sets initialized to false and then calls super.initialize() so that it does the meta-filling.&lt;/p&gt;

&lt;p&gt;applyPropertyDescriptors() had to be made protected, because MetaClassImpl#applyPropertyDescriptors() calls addMetaBeanProperty(), for which ClosureMetaClass throws UnsupportedOperationException.&lt;/p&gt;</comment>
                            <comment id="14469031" author="blackdrag" created="Wed, 3 Mar 2010 08:07:27 +0000"  >&lt;p&gt;ok then&lt;/p&gt;</comment>
                            <comment id="14468987" author="roshandawrani" created="Wed, 3 Mar 2010 10:48:28 +0000"  >&lt;p&gt;Fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722266" name="4038_v18x_Patch.txt" size="2665" author="roshandawrani" created="Wed, 3 Mar 2010 04:35:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ck4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>