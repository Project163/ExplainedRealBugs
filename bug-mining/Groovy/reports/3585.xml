<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:01:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-9153] StaticInvocationWriter modifies shared global node ConstantExpression.NULL</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-9153</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;In the case of a static groovy method call like &lt;tt&gt;File.createTempDir()&lt;/tt&gt; when &lt;tt&gt;@CompileStatic&lt;/tt&gt; is applied, &lt;tt&gt;StaticInvocationWriter&lt;/tt&gt;&apos;s &lt;tt&gt;writeDirectMethodCall&lt;/tt&gt; and &lt;tt&gt;loadArguments&lt;/tt&gt; mutate the shared global constant node &lt;tt&gt;ConstantExpression.NULL&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Relevant bits:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; writeDirectMethodCall(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MethodNode target, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; implicitThis, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression receiver, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; TupleExpression args) {
        ...
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (target &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; ExtensionMethodNode) {
            ...
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (emn.isStaticExtension()) {
                &lt;span class=&quot;code-comment&quot;&gt;// it&apos;s a &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; extension method
&lt;/span&gt;                argumentList.add(0, ConstantExpression.NULL);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                ....
            }

            Parameter[] parameters = node.getParameters();
            loadArguments(argumentList, parameters);
...
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void loadArguments(List&amp;lt;Expression&amp;gt; argumentList, Parameter[] para) {
        ...
                &lt;span class=&quot;code-comment&quot;&gt;// This is repeated 3 times in the method:
&lt;/span&gt;                Expression expression = argumentList.get(i);
                expression.putNodeMetaData(PARAMETER_TYPE, para[i].getType());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13236536">GROOVY-9153</key>
            <summary>StaticInvocationWriter modifies shared global node ConstantExpression.NULL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="emilles">Eric Milles</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 May 2019 16:43:36 +0000</created>
                <updated>Tue, 6 Aug 2019 11:19:39 +0000</updated>
                            <resolved>Tue, 4 Jun 2019 10:51:34 +0000</resolved>
                                                    <fixVersion>2.5.8</fixVersion>
                    <fixVersion>3.0.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16852297" author="emilles" created="Thu, 30 May 2019 20:00:55 +0000"  >&lt;p&gt;To protect the global constant expressions, you could do something like the attached.  It&apos;s missing an override of addAnnotation.&lt;/p&gt;</comment>
                            <comment id="16855367" author="daniel_sun" created="Tue, 4 Jun 2019 06:15:27 +0000"  >&lt;p&gt;The proposed PR was merged into master and will be merged into 2_5_X later.&lt;/p&gt;</comment>
                            <comment id="16855571" author="paulk" created="Tue, 4 Jun 2019 10:51:34 +0000"  >&lt;p&gt;merged into 2_5_X&lt;/p&gt;</comment>
                            <comment id="16899724" author="emilles" created="Mon, 5 Aug 2019 02:24:10 +0000"  >&lt;p&gt;It is still quite possible for &lt;tt&gt;StaticInvocationWriter&lt;/tt&gt; to modify one of the shared &lt;tt&gt;ConstantExpression&lt;/tt&gt; definitions.  One example is AutoClone, which creates invokeMethod calls with ConstantExpression.NULL arguments.  The test CanonicalComponentsTransformTest hits this case.&lt;/p&gt;</comment>
                            <comment id="16900910" author="paulk" created="Tue, 6 Aug 2019 11:19:39 +0000"  >&lt;p&gt;This commit should fix off most remaining cases:&lt;br/&gt;
73314d6291ff64a00e91fd3cf351cd7ef69cf7cd&lt;/p&gt;

&lt;p&gt;Some of these aren&apos;t strictly needed right now&#160;but there is no harm in handling the extra cases and we are now somewhat more evolution proof.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12970379" name="ConstantExpression.java" size="7025" author="emilles" created="Thu, 30 May 2019 20:00:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z038m8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>