<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:25:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5170]  GroovyRowResult and GroovyResultSet are Inconsistent with each other when using a postgres driver</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5170</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Basically, the root problem seams to be that the postgres (driver?) folds unquoted object identifiers to lower case.  This behavior is transparent to the api when using sql.eachRow, but not when sql.firstRow. This appears to be related to how eachRow uses a GroovyResultSet which delegates the getObject(property) to the driver, but firstRow uses a GroovyRowResult which does not.&lt;/p&gt;

&lt;p&gt;	String query = &quot;SELECT * FROM $table&quot;;&lt;br/&gt;
	sql.eachRow(query)&lt;/p&gt;
{ row -&amp;gt;
		def eValue = row[column]
		println &quot;each row found $eValue&quot;;
	}
&lt;p&gt;	def fValue = sql.firstRow(query)&lt;span class=&quot;error&quot;&gt;&amp;#91;column&amp;#93;&lt;/span&gt;&lt;br/&gt;
	println &quot;firstRow found $fValue&quot;&lt;/p&gt;

&lt;p&gt;I saw code in GroovyRowResult#getProperty(String) currently checks the exact case, then tries folding the property name to upper-case (as is more common).  This is not adequate for postgres behavior which folds to lower-case.&lt;/p&gt;

&lt;p&gt;Attached is a script which demonstrates this, an example invocation would be&lt;br/&gt;
`bug.groovy --url jdbc:postgresql://example.com:5432/catalog --user postgres --pass postgres --schema public --driver org.postgresql.Driver TABLE ID`&lt;br/&gt;
It requires a postgres database with a table and column (create using unquoted and/or lowercase names) exist with at least one row.&lt;/p&gt;</description>
                <environment>Groovy with a postgres database</environment>
        <key id="12816012">GROOVY-5170</key>
            <summary> GroovyRowResult and GroovyResultSet are Inconsistent with each other when using a postgres driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="jwadamson">Jeffrey Adamson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Dec 2011 15:21:34 +0000</created>
                <updated>Sun, 12 Feb 2012 04:03:09 +0000</updated>
                            <resolved>Mon, 6 Feb 2012 02:39:25 +0000</resolved>
                                    <version>1.8.4</version>
                                    <fixVersion>1.8.6</fixVersion>
                    <fixVersion>2.0-beta-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14472126" author="jwadamson" created="Mon, 5 Dec 2011 17:13:45 +0000"  >&lt;p&gt;I posted this to &quot;GroovyDev&quot; &amp;lt;dev@groovy.codehaus.org&amp;gt; for feedback first, but now I realize I probably wasn&apos;t sending from a registered address.  So please forgive me if this a duplicate or &quot;works as expected&quot;.&lt;/p&gt;</comment>
                            <comment id="14472440" author="jwagenleitner" created="Sat, 4 Feb 2012 02:56:32 +0000"  >&lt;p&gt;Just wanted to add a note that the same problem can also occur with MySQL since the driver returns column labels in the same case used in the create table statement.  The &lt;tt&gt;ResultSet&lt;/tt&gt; seems to handle the names case insensitively which as pointed out is not the case for the &lt;tt&gt;GroovyRowResult&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;In Oracle, Hsqldb and H2 the column names are in uppercase so they don&apos;t have this problem.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.sql.*

def sql = Sql.newInstance(&lt;span class=&quot;code-quote&quot;&gt;&apos;jdbc:mysql:&lt;span class=&quot;code-comment&quot;&gt;//localhost/groovy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;groovy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;com.mysql.jdbc.Driver&apos;&lt;/span&gt;)
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    sql.execute(&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;&apos;DROP TABLE IF EXISTS foo&apos;&lt;/span&gt;&apos;&apos;)
    sql.execute(&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;&apos;create table foo (name varchar(30), Title varchar(30))&apos;&lt;/span&gt;&apos;&apos;)
    sql.execute(&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos;&apos;insert into foo (name, title) values (&apos;&lt;/span&gt;foo&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;bar&lt;span class=&quot;code-quote&quot;&gt;&apos;)&apos;&lt;/span&gt;&apos;&apos;) 
    
    sql.eachRow(&lt;span class=&quot;code-quote&quot;&gt;&apos;select * from foo&apos;&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; == it.nAmE
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; == it.NAME
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt; == it.title
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt; == it.TITLE 
    }

    def row = sql.firstRow(&lt;span class=&quot;code-quote&quot;&gt;&apos;select * from foo&apos;&lt;/span&gt;)
    &lt;span class=&quot;code-comment&quot;&gt;// These will fail
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt; == row.NAME
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt; == row.title
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt; == row.TITLE
} &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
    sql.close()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14472459" author="jwagenleitner" created="Sat, 4 Feb 2012 03:12:02 +0000"  >&lt;p&gt;I have submitted a github pull request (&lt;a href=&quot;https://github.com/groovy/groovy-core/pull/21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/21&lt;/a&gt;) for this issue.&lt;/p&gt;</comment>
                            <comment id="14472337" author="blackdrag" created="Sat, 4 Feb 2012 04:23:57 +0000"  >&lt;p&gt;Javadoc of ResultSet says this: &quot;Column names used as input to getter methods are case insensitive. When a getter method is called with a column name and several columns have the same name, the value of the first matching column will be returned. &quot;&lt;br/&gt;
Going by that it should be ok to do this change&lt;/p&gt;</comment>
                            <comment id="14479795" author="paulk" created="Sun, 5 Feb 2012 02:17:39 +0000"  >&lt;p&gt;John, I tried to apply your pull request but received this error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Applying: GROOVY-5170: GroovyRowResult and GroovyResultSet are Inconsistent
error: patch failed: src/test/groovy/sql/GroovyRowResultTest.groovy:1
error: src/test/groovy/sql/GroovyRowResultTest.groovy: patch does not apply
Patch failed at 0001 GROOVY-5170: GroovyRowResult and GroovyResultSet are Inconsistent
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I haven&apos;t had time to investigate further but applied the patch with some tweaks manually.&lt;/p&gt;

&lt;p&gt;John and Jeffrey, if you could test the latest snapshots, that would be great.&lt;/p&gt;

&lt;p&gt;Thanks, Paul.&lt;/p&gt;</comment>
                            <comment id="14472429" author="jwagenleitner" created="Sun, 5 Feb 2012 20:34:13 +0000"  >&lt;p&gt;I tested using the latest snapshot with a project I have that uses MySQL and it&apos;s working great (am grateful to no longer have to remember the exact mixed casing of the column names).&lt;/p&gt;

&lt;p&gt;I also did a quick test with Postgresql and that also seems to work fine (though I&apos;m not as familiar with Postresql).&lt;/p&gt;</comment>
                            <comment id="14479810" author="paulk" created="Mon, 6 Feb 2012 02:39:25 +0000"  >&lt;p&gt;Thanks John. Resolving for now. Jeffrey, if you spot any problems please reopen or create a new issue.&lt;/p&gt;</comment>
                            <comment id="14472394" author="jwadamson" created="Thu, 9 Feb 2012 09:27:52 +0000"  >&lt;p&gt;My basic test work great using. Thanks.&lt;/p&gt;

&lt;p&gt;( using local groovy build from f51879debc47c1a0088f2bbbc6ec9062406045b9 of GROOVY_1_8_6_RC )&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722642" name="bug.groovy" size="4680" author="jwadamson" created="Mon, 5 Dec 2011 15:21:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cbrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>