<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:13:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2886] Wrong method is called when using default arguments</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2886</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following script:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def meth(Closure cl = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
  println &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;
  meth([:], cl)
}

def meth(Map args, Closure cl = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    println &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;
    println args
}

meth()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;prints&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2
null
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12814260">GROOVY-2886</key>
            <summary>Wrong method is called when using default arguments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="hans_d">Hans Dockter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Jun 2008 09:28:47 +0000</created>
                <updated>Wed, 30 Sep 2009 16:54:11 +0000</updated>
                            <resolved>Wed, 30 Sep 2009 16:54:11 +0000</resolved>
                                    <version>1.5.6</version>
                                    <fixVersion>1.6.5</fixVersion>
                    <fixVersion>1.7-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14465912" author="roshandawrani" created="Fri, 12 Dec 2008 12:33:48 +0000"  >&lt;p&gt;Just wanted to add some details after looking into what is causing the issue:&lt;/p&gt;

&lt;p&gt;For the code snippet given, the following 4 methods are generated to support default types:&lt;br/&gt;
1) meth() {&lt;br/&gt;
     meth(null)&lt;br/&gt;
} &lt;br/&gt;
2) meth(Closure cl) {&lt;br/&gt;
    println &quot;1&quot;&lt;br/&gt;
    ....&lt;br/&gt;
}&lt;br/&gt;
3) meth (Map args)  {&lt;br/&gt;
    meth(args, null)&lt;br/&gt;
}&lt;br/&gt;
4) meth(Map args, Closure cl) {&lt;br/&gt;
     println &quot;2&quot;&lt;br/&gt;
     println args&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The problem is that meth(null) in case 1 can potentially map to both meth(Closure) and meth(Map) as the value null is type-less. In this case, it is picking up meth(Map), which delegates to meth(Map, Closure) in turn and ends up printing the output it is printing, which is wrong because looking at the original source code, meth() should have delegated to meth(Closure). &lt;/p&gt;

&lt;p&gt;If the default value is not null, it carries the type information at run-time and then the method resolution seems to be fine.&lt;/p&gt;</comment>
                            <comment id="14465960" author="blackdrag" created="Sat, 13 Dec 2008 13:37:37 +0000"  >&lt;p&gt;IMHO this is not a method resolution error. In Groovy a null argument can be mapped to many types and since we do not have the static information we need to decide what to call. So we decided to call the most general type. Would you have added a method(Object) here, then that one would have been called from meth(). In Groovy interfaces are also preferred over classes, so the Map wins, exactly as it should. The error here could be, that Verifier is creating &quot;meth(null)&quot; were it should have created &quot;method(Closure(null))&quot;. In this case a static will be transported along with the null value and the method selection process becomes the hint that it should prefer the Closure method instead.  &lt;/p&gt;</comment>
                            <comment id="14465879" author="roshandawrani" created="Sat, 13 Dec 2008 20:20:50 +0000"  >&lt;p&gt;I didn&apos;t understand the meaning of &quot;method(Closure(null))&quot;. Did you mean &quot;method((Closure) null)&quot;?&lt;/p&gt;

&lt;p&gt;Anyway, the call that is made is of the form:&lt;br/&gt;
ScriptBytecodeAdapter.invokeMethodOnCurrentN(localClass1, this, &quot;meth&quot;, new Object[] &lt;/p&gt;
{ null }
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;And before trying to change its form to ScriptBytecodeAdapter.invokeMethodOnCurrentN(localClass1, this, &quot;meth&quot;, new Object[] &lt;/p&gt;
{ (Closure) null }
&lt;p&gt;), I was trying it in Java but noticed that it does not help there either (like in code below):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
		List nil = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] objs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] { nil };
		m(objs[0]); &lt;span class=&quot;code-comment&quot;&gt;// Roshan -&amp;gt; it does not invoke m(List), it still invokes m(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
&lt;/span&gt;
                &lt;span class=&quot;code-comment&quot;&gt;// This calls the m(List) but how &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; it in ScriptBytecodeAdapter.&amp;lt;&amp;gt;() calls 
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// as we only use &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] to send args there and not their &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; type information
&lt;/span&gt;                m((List)objs[0]); 
	}
	&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void m(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; p){
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;[&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;] called&quot;&lt;/span&gt;);
	}
	&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void m(List p){
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;[List] called&quot;&lt;/span&gt;);
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14465775" author="blackdrag" created="Sun, 14 Dec 2008 07:16:35 +0000"  >&lt;p&gt;&quot;method((Closure) null)&quot; yes, sorry. Of course the call is made with ScriptBytecodeAdapter.invokeMethodOnCurrentN, because for one, that is what the compiler produced and second... even with the cast it would use that method. The difference would be found only in new Object[] &lt;/p&gt;
{ null }
&lt;p&gt;, which would be then a wrapper object instead. The place to fix his issue is in Verifier.&lt;/p&gt;</comment>
                            <comment id="14467898" author="blackdrag" created="Wed, 30 Sep 2009 16:54:11 +0000"  >&lt;p&gt;fixed by using a cast for the method call implementation of the additional method&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cptb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>