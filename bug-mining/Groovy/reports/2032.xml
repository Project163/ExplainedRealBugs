<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:30:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5835] Few @CompileStatic bugs</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5835</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;There are multiple issues illustrated by the code below:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler can not infer the type when iterating with each() over vararg argument. Iteration using for-in works fine.&lt;/li&gt;
	&lt;li&gt;When using explicit return from a closure inside the method, the compiler checks the method return type, rather than the closure&apos;s declared return type&lt;/li&gt;
	&lt;li&gt;Certain types of overloading blow the compiler&apos;s stack - compare transform(mappers) with filter(predicates)&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test&amp;lt;T&amp;gt; {

    Test&amp;lt;T&amp;gt; transform(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; passThroughNulls=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, Closure&amp;lt;T&amp;gt; mapper) { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; }

    &lt;span class=&quot;code-comment&quot;&gt;/*@CompileStatic*/&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// blows the compiler stack
&lt;/span&gt;    Test&amp;lt;T&amp;gt; transform(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; passThroughNulls=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, Closure&amp;lt;T&amp;gt;... mappers) {
        mappers.each { Closure&amp;lt;T&amp;gt; it -&amp;gt; transform passThroughNulls, it }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
    }


    @CompileStatic
    Test&amp;lt;T&amp;gt; filter(Closure&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;&amp;gt; predicate) {
        transform { T it -&amp;gt; 
            def retval = predicate(it) ? it : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
            &lt;span class=&quot;code-comment&quot;&gt;/*&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;*/&lt;/span&gt; retval &lt;span class=&quot;code-comment&quot;&gt;// compiler thinks &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;&apos;&lt;/span&gt; is &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the enclosing method
&lt;/span&gt;        }  
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
    }

    @CompileStatic
    Test&amp;lt;T&amp;gt; filter(Closure&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;&amp;gt;... predicates) {
        predicates.each { Closure&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;&amp;gt; it -&amp;gt; &lt;span class=&quot;code-comment&quot;&gt;// compiler can not infer the type of &lt;span class=&quot;code-quote&quot;&gt;&apos;it&apos;&lt;/span&gt; even we are iterating over plain array 
&lt;/span&gt;            filter it 
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12818202">GROOVY-5835</key>
            <summary>Few @CompileStatic bugs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="ddimitrov">Dimitar Dimitrov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Dec 2012 20:27:52 +0000</created>
                <updated>Sat, 22 Dec 2012 01:10:49 +0000</updated>
                            <resolved>Tue, 4 Dec 2012 03:37:36 +0000</resolved>
                                    <version>2.0.5</version>
                                    <fixVersion>2.0.6</fixVersion>
                                    <component>Static compilation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14473482" author="melix" created="Tue, 4 Dec 2012 03:14:40 +0000"  >&lt;p&gt;Thanks for the report. A few remarks/questions though:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;it&apos;s better to create separate bug reports for each bug as is makes isolating issues easier&lt;/li&gt;
	&lt;li&gt;I can reproduce issue n&#176;1 (stack overflow) using 2.0.5, but it doesn&apos;t appear on &lt;tt&gt;master&lt;/tt&gt; or &lt;tt&gt;2.0.X branch&lt;/tt&gt; so I think it&apos;s already fixed&lt;/li&gt;
	&lt;li&gt;I can reproduce issue n&#176;2 with a separate example (below) in 2.0.5, already fixes in both &lt;tt&gt;master&lt;/tt&gt; and &lt;tt&gt;2.0.X&lt;/tt&gt; so I just added a unit test
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@TypeChecked
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; enclosingMethod() {
   def cl = { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&apos;&lt;/span&gt; } &lt;span class=&quot;code-comment&quot;&gt;// should not think it&apos;s a &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the enclosing method
&lt;/span&gt;   1
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;last issue doesn&apos;t look like a bug, but a known limitation, if I understand well what you mean. You are expecting the compiler to understand that the &lt;tt&gt;it&lt;/tt&gt; parameter of the closure, since it&apos;s called on &lt;tt&gt;each&lt;/tt&gt;, is of type &lt;tt&gt;Closure&amp;lt;Boolean&lt;/tt&gt;. Unfortunately, the signature of &lt;tt&gt;DefaultGroovyMethods#each&lt;/tt&gt; doesn&apos;t have enough type information for the compiler to infer that. There are open discussions about how to fix that in future versions of Groovy.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14473541" author="ddimitrov" created="Tue, 4 Dec 2012 03:33:34 +0000"  >&lt;p&gt;Thanks, in this case you may resolve. Will submit separate issues next time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bpxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>