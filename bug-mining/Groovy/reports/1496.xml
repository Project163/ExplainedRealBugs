<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:19:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4827] @EqualsAndHashCode.excludes doesn&apos;t work correctly with class inheritance</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4827</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I cannot inherit exclusions of EqualsAndHashCode, I have to duplicate exclusions in every child class.&lt;br/&gt;
Please see the tescase, only testA() and testE() pass.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;EqualsTest {
    @EqualsAndHashCode(excludes = &lt;span class=&quot;code-quote&quot;&gt;&apos;a1&apos;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
        def a1, a2;
    }

    @Test
    void testA() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; A(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; A(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// ok
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; A(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;diff&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; A(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;erent&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// ok
&lt;/span&gt;    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
        def b
    }

    @Test
    void testB() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; B(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;diff&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, b: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; B(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;erent&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, b: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;)
        &lt;span class=&quot;code-comment&quot;&gt;// failed! Shouldn&apos;t equals() be inherited from A?
&lt;/span&gt;    }

    &lt;span class=&quot;code-comment&quot;&gt;//ok. let&apos;s &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to specify explicitly that we call &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.equals()
&lt;/span&gt;    @EqualsAndHashCode(callSuper = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
        def c
    }

    @Test
    void testC() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;diff&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, c: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;erent&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, c: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;)
        &lt;span class=&quot;code-comment&quot;&gt;// failed!
&lt;/span&gt;    }

    &lt;span class=&quot;code-comment&quot;&gt;//hm. what about excluding it again in the child class?
&lt;/span&gt;    @EqualsAndHashCode(callSuper = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, excludes = &lt;span class=&quot;code-quote&quot;&gt;&apos;a1&apos;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;D &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
        def d
    }

    @Test
    void testD() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; D(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;diff&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, d: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; D(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;erent&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, d: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;)
        &lt;span class=&quot;code-comment&quot;&gt;// failed!
&lt;/span&gt;    }

    &lt;span class=&quot;code-comment&quot;&gt;//hm. should I forget about inheritance??
&lt;/span&gt;    @EqualsAndHashCode(excludes = &lt;span class=&quot;code-quote&quot;&gt;&apos;a1&apos;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;E &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
        def e
    }

    @Test
    void testE() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; E(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;diff&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, e: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; E(a1: &lt;span class=&quot;code-quote&quot;&gt;&apos;erent&apos;&lt;/span&gt;, a2: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;, e: &lt;span class=&quot;code-quote&quot;&gt;&apos;same&apos;&lt;/span&gt;)
        &lt;span class=&quot;code-comment&quot;&gt;// YES :(
&lt;/span&gt;    }

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </description>
                <environment></environment>
        <key id="12818082">GROOVY-4827</key>
            <summary>@EqualsAndHashCode.excludes doesn&apos;t work correctly with class inheritance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="pawlom">Pavlo Morgunyuk</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 May 2011 13:04:12 +0000</created>
                <updated>Thu, 21 Jul 2011 19:06:38 +0000</updated>
                            <resolved>Sun, 29 May 2011 05:18:18 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>1.8.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14479569" author="paulk" created="Wed, 25 May 2011 04:48:09 +0000"  >&lt;p&gt;There is no intention to allow exclusions from properties inherited from super classes. By using &apos;callSuper&apos; you get to decide whether the identity as defined in the base class (already specified by its equals and hashCode methods) are important to you or not. Having said that, your examples reveal a bug in how callSuper is working. This came about when we made the implementation of equals stricter to ensure that the equals contract was always fulfilled evening when using inheritance. We will probably alter the implementation to use a canEqual method ala project Lombok 0.10+ or Scala case classes - so that it will work properly for inheritance but also for JPA proxy classes which also use inheritance but only as an implementation detail. We might make this an option or configurable to some extent.&lt;/p&gt;

&lt;p&gt;Reference to an explanation of what we would probably implement:&lt;br/&gt;
&lt;a href=&quot;http://www.artima.com/lejava/articles/equality.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.artima.com/lejava/articles/equality.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We would probably have a &quot;useCanEqual&quot; flag which defaults to true and results in a public &quot;canEqual&quot; method being defined as per the above article (and project lombok 0.10+ and recent scala case classes). If you set the &quot;useCanEqual&quot; flag to false you will get the current implementation which compares getClass() and you won&apos;t pollute the class with a &quot;canEqual&quot; method but the following won&apos;t return true (and ditto for JPA proxy instances) which most people would expect to work:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Canonical &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Point { def x, y }
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Point(1, 2) == &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Point(1, 1) { def getY() { 2 } }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479566" author="paulk" created="Sun, 29 May 2011 05:18:18 +0000"  >&lt;p&gt;This should be fixed. Thanks for spotting this. Please let me know if you observe any strange behavior with this functionality.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722851" name="equalsExcludes.groovy" size="1616" author="pawlom" created="Mon, 16 May 2011 13:04:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bx9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>