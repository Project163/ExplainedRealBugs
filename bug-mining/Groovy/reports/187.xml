<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:56:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-886] each(){} throws NPE when called on a Java Object[], that contains String[]&apos;s with null entries</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-886</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Say you have a Java Class like&lt;/p&gt;

&lt;p&gt;public class SomeClass {&lt;br/&gt;
    public Object[] anArrayOfStringArraysWorkaround(){&lt;br/&gt;
        return new Object[]{ new String[]{&quot;whatever&quot;,null}};&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;then the following Groovy code fails with NPE&lt;/p&gt;

&lt;p&gt;public class MultiDimArraysTest extends GroovyTestCase {&lt;br/&gt;
    void testCallTwoDimStringArrayWorkaroundWithNull(){&lt;br/&gt;
        def someArrayOfStringArrays =  new SomeClass().anArrayOfStringArraysWorkaround()&lt;br/&gt;
        assert 1 == someArrayOfStringArrays.size()&lt;br/&gt;
        assert &quot;whatever&quot; == someArrayOfStringArrays&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        someArrayOfStringArrays.each()&lt;/p&gt;
{ assert it}
&lt;p&gt;                // throws NPE !!&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;while the iteration with &quot;for&quot; works:&lt;/p&gt;

&lt;p&gt;public class MultiDimArraysTest extends GroovyTestCase {&lt;br/&gt;
    void testCallTwoDimStringArrayWorkaround(){&lt;br/&gt;
        def someArrayOfStringArrays =  new SomeClass().anArrayOfStringArraysWorkaround()&lt;br/&gt;
        assert 1 == someArrayOfStringArrays.size()&lt;br/&gt;
        assert &quot;whatever&quot; == someArrayOfStringArrays&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        for (i in 0..&amp;lt;someArrayOfStringArrays.size()) &lt;/p&gt;
{
            assert someArrayOfStringArrays[i]
        }
&lt;p&gt;    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The above TestCase will be committed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12812900">GROOVY-886</key>
            <summary>each(){} throws NPE when called on a Java Object[], that contains String[]&apos;s with null entries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phkim">Kim, Pilho</assignee>
                                    <reporter username="codevise">Dierk K&#246;nig</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Jun 2005 05:18:59 +0000</created>
                <updated>Sat, 16 Jul 2005 15:21:56 +0000</updated>
                            <resolved>Sat, 16 Jul 2005 15:21:56 +0000</resolved>
                                    <version>1.0-JSR-1</version>
                                    <fixVersion>1.0-JSR-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14461084" author="blackdrag" created="Tue, 14 Jun 2005 06:14:44 +0000"  >&lt;p&gt;the reason for both problems is the same... the strange array handling in closures&lt;/p&gt;</comment>
                            <comment id="14461032" author="blackdrag" created="Tue, 14 Jun 2005 07:20:33 +0000"  >&lt;p&gt;is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-886&quot; title=&quot;each(){} throws NPE when called on a Java Object[], that contains String[]&amp;#39;s with null entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-886&quot;&gt;&lt;del&gt;GROOVY-886&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14461083" author="phkim" created="Tue, 14 Jun 2005 09:10:40 +0000"  >&lt;p&gt;Here is a workaround.&lt;/p&gt;

&lt;p&gt;public class MultiDimArraysTest extends GroovyTestCase { &lt;br/&gt;
    void testCallTwoDimStringArrayWorkaroundWithNull() { &lt;br/&gt;
        def someArrayOfStringArrays = new SomeClass().anArrayOfStringArraysWorkaround() &lt;br/&gt;
        assert 1 == someArrayOfStringArrays.size() &lt;br/&gt;
        assert &quot;whatever&quot; == someArrayOfStringArrays&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;br/&gt;
        someArrayOfStringArrays.each()&lt;/p&gt;
{ Object[] it -&amp;gt; assert it}
&lt;p&gt;    // Use a typed parameter here!&lt;br/&gt;
    } &lt;br/&gt;
} &lt;/p&gt;
</comment>
                            <comment id="14461082" author="wangbin" created="Sat, 18 Jun 2005 06:31:04 +0000"  >&lt;p&gt;This is because Clourse#call(final Object arguments)  can&apos;t distingish the array parameter from multi parameters. We should provide a way to handle this case.  The simple way is add a method &lt;br/&gt;
Closure#CallWithOneParam(Object arg) {&lt;br/&gt;
    doCall(arg);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;and Modify GroovyDefaultMethod#each(Object, Clousre) like below&lt;br/&gt;
    public static void each(Object self, Closure closure) {&lt;br/&gt;
        for (Iterator iter = InvokerHelper.asIterator(self); iter.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;
{
            closure.callWithOne(iter.next());   //NOTE
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;This problem can fix&lt;/p&gt;

&lt;p&gt;In general, The Groovy framework should can distinguish one array param from multi parameters.&lt;/p&gt;</comment>
                            <comment id="14461223" author="wangbin" created="Sat, 18 Jun 2005 20:35:01 +0000"  >&lt;p&gt;We should rewrite Closure, especailly the call(Object) method. This method should can distinguish array parameter from multi-parameter. So I think a class named ParametersWrapper can fix it.&lt;br/&gt;
like below&lt;br/&gt;
public Object call(final Object arg) {&lt;br/&gt;
	boolean isWrapper = arg instanceOf ParametersWrapper;&lt;br/&gt;
	if (! isWrapper) &lt;/p&gt;
{
		//handle one parameter, regardless of the arg type (List, Array,etc)
		return doCall(arg);
	}

&lt;p&gt;	// handle multi paramters&lt;br/&gt;
	...&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;I&apos;ve read the source code of Closure, and we should refactor or even redesgin it. I bet it really worth us to do it.&lt;/p&gt;

&lt;p&gt;One more thing,&lt;/p&gt;

&lt;p&gt;If we do so, when we call a Closure with more than 2 parameters, we must wrap them at first. Of course, we can provide a method &lt;br/&gt;
call(Object o1, Object o2, Object o3) to handle this case. If so, users only need to wrap the parameters if they are more than 3. e.g.&lt;br/&gt;
ParametersWrapper wrapper = new parametersWrapper();&lt;br/&gt;
wrapper.AddParameter(o1);&lt;br/&gt;
wrapper.AddParameter(02);&lt;br/&gt;
wrapper.AddParameter(o3);&lt;br/&gt;
wrapper.AddParameter(04);&lt;br/&gt;
myclousre.call(wrapper);&lt;/p&gt;

&lt;p&gt;Of course, it is also easy to handle varargs (the arg numebers isnot constant).&lt;/p&gt;</comment>
                            <comment id="14461200" author="wangbin" created="Sat, 18 Jun 2005 21:19:29 +0000"  >&lt;p&gt;This implementation ONLY affect the the code of groovy framework and will NOT affect the groovy scirpt. For groovy script, users still can write script like &lt;br/&gt;
c = &lt;/p&gt;
{ a,b,c,d,e -&amp;gt; ...}
&lt;p&gt;x = c.call(&quot;a&quot;, &quot;b&quot;, &apos;c&apos;,&apos;d&apos;,&apos;e&apos;);&lt;br/&gt;
users need not wrapper these parameter&lt;/p&gt;</comment>
                            <comment id="14461112" author="phkim" created="Sat, 2 Jul 2005 12:34:14 +0000"  >&lt;p&gt;// filename: testMethodAndClosure.groovy &lt;br/&gt;
def someFn(a, b, c, d, e) {&lt;br/&gt;
    println a + b + c + d + e&lt;br/&gt;
}&lt;br/&gt;
someFn(&apos;foo&apos;, &quot;bar&quot;)     // MME expected, but prints out &quot;foobarnullnullnull&quot;&lt;br/&gt;
someFn(&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;foo&amp;#39;, &amp;quot;bar&amp;quot;&amp;#93;&lt;/span&gt;)    // MME expected, but prints out &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;foo, bar, null, null, null, null&amp;#93;&lt;/span&gt;&quot;&lt;/p&gt;

&lt;p&gt;def someClos = &lt;/p&gt;
{ a, b, c, d, e -&amp;gt; println a + b + c + d + e }
&lt;p&gt;someClos(&apos;foo&apos;, &quot;bar&quot;)     // MME expected, but prints out &quot;foobarnullnullnull&quot;&lt;br/&gt;
someClos(&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;foo&amp;#39;, &amp;quot;bar&amp;quot;&amp;#93;&lt;/span&gt; as Object[])     // MME expected, but prints out &quot;foobarnullnullnull&quot;&lt;/p&gt;</comment>
                            <comment id="14461362" author="phkim" created="Sat, 16 Jul 2005 15:21:56 +0000"  >&lt;p&gt;This has been fixed in 1.0-JSR-3. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12812695">GROOVY-584</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12816331">GROOVY-888</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12812789">GROOVY-764</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 20 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bsc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>