<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:23:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5101] GroovyCastException occurs since 1.8.3</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5101</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;GroovyServ 0.9 doesn&apos;t work with Groovy 1.8.3. Surely, it still works well with Groovy 1.8.2.&lt;/p&gt;

&lt;p&gt;Stacktrace on starting-up of GroovyServ:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 2011/10/25 18:17:01.121 ---&amp;gt; org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; object &lt;span class=&quot;code-quote&quot;&gt;&apos;groovy.lang.Reference@464693f9&apos;&lt;/span&gt; with class &lt;span class=&quot;code-quote&quot;&gt;&apos;groovy.lang.Reference&apos;&lt;/span&gt; to class &lt;span class=&quot;code-quote&quot;&gt;&apos;java.lang.&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;&apos;&lt;/span&gt;
 2011/10/25 18:17:01.121         at org.jggug.kobo.groovyserv.RequestWorker$2.&amp;lt;init&amp;gt;(RequestWorker.groovy)
 2011/10/25 18:17:01.121         at org.jggug.kobo.groovyserv.RequestWorker.newTaskFor(RequestWorker.groovy:85)
 2011/10/25 18:17:01.121         at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:77)
 2011/10/25 18:17:01.121         at java_util_concurrent_ExecutorService$submit.callCurrent(Unknown Source)
 2011/10/25 18:17:01.121         at org.jggug.kobo.groovyserv.RequestWorker.start(RequestWorker.groovy:67)
 ...(snip)...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At line 85 of RequestWorker:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FutureTask(runnable, defaultValue) { &lt;span class=&quot;code-comment&quot;&gt;// anonymous &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; class
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() { runnable.id }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I tried to fix it as following, it worked well even with groovy 1.8.3.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FutureTask(runnable, defaultValue)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m sorry. I wanted to report the sample code which is independent on GroovyServ, but the problem didn&apos;t occur on the simplified sample code.&lt;/p&gt;

&lt;p&gt;This might be the same problem as &lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY-5077&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY-5077&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;GroovyServ: &lt;a href=&quot;http://kobo.github.com/groovyserv/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://kobo.github.com/groovyserv/&lt;/a&gt;&lt;br/&gt;
RequestWorker&apos;s full source code: &lt;a href=&quot;https://github.com/kobo/groovyserv/blob/master/src/main/groovy/org/jggug/kobo/groovyserv/RequestWorker.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kobo/groovyserv/blob/master/src/main/groovy/org/jggug/kobo/groovyserv/RequestWorker.groovy&lt;/a&gt;&lt;/p&gt;</description>
                <environment>MacOSX: 10.6&lt;br/&gt;
Groovy Version: 1.8.3&lt;br/&gt;
JVM: 1.6.0_26</environment>
        <key id="12818108">GROOVY-5101</key>
            <summary>GroovyCastException occurs since 1.8.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="nobeans">Yasuharu Nakano</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Oct 2011 04:50:47 +0000</created>
                <updated>Tue, 20 Dec 2011 09:32:02 +0000</updated>
                            <resolved>Tue, 20 Dec 2011 09:32:02 +0000</resolved>
                                                    <fixVersion>1.8.5</fixVersion>
                    <fixVersion>2.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14472010" author="nobeans" created="Tue, 25 Oct 2011 11:28:48 +0000"  >&lt;p&gt;I&apos;ve found the commit at which the problem occurs by using git bisect at the GROOVY_1_8_x branch of groovy/groovy-core on GitHub:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;fdf212623511fce9d47d3d8ab3954a709d70583f is the first bad commit&lt;br/&gt;
commit fdf212623511fce9d47d3d8ab3954a709d70583f&lt;br/&gt;
Author: Jochen &amp;lt;blackdrag@gmx.org&amp;gt;&lt;br/&gt;
Date:   Fri Sep 9 00:04:39 2011 +0200&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5000&quot; title=&quot;Wrong constructor call generated with AIC + closure usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5000&quot;&gt;&lt;del&gt;GROOVY-5000&lt;/del&gt;&lt;/a&gt;: change aic constructor call to correctly respect references&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;At the master branch of groovy/groovy-core on GitHub:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;commit fa995f14d52d9c0d18c19cffb448d021b29025e9&lt;br/&gt;
Author: Jochen &amp;lt;blackdrag@gmx.org&amp;gt;&lt;br/&gt;
Date:   Fri Sep 9 00:04:39 2011 +0200&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5000&quot; title=&quot;Wrong constructor call generated with AIC + closure usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5000&quot;&gt;&lt;del&gt;GROOVY-5000&lt;/del&gt;&lt;/a&gt;: change aic constructor call to correctly respect references&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I made sure that the problem doesn&apos;t occur at the previous commit of it.&lt;/p&gt;

&lt;p&gt;For your reference, I uploaded the test script which I used for &quot;git bisect run&quot;.&lt;br/&gt;
&lt;a href=&quot;https://gist.github.com/1313324&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/1313324&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14471984" author="nobeans" created="Tue, 25 Oct 2011 21:39:27 +0000"  >&lt;p&gt;the simpler test which the problem occurs&lt;/p&gt;</comment>
                            <comment id="14471973" author="nobeans" created="Tue, 25 Oct 2011 21:53:09 +0000"  >&lt;p&gt;The attached Groovy5101Test.groovy is simple enough to cause the problem, but the API of sample classes is meaningless.&lt;br/&gt;
If you mind that, refer to my gist which has the improved version of test code.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/1315245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/1315245&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14472086" author="nobeans" created="Fri, 25 Nov 2011 03:47:26 +0000"  >&lt;p&gt;I invoked the attached test code on GroovyConsole and analyzed at end of phase &quot;Semantic Analysis&quot; by GroovyASTBrowser.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test_InnerAnonymousClass_UsingArgument() {
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; getClassA = { java.lang.&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; r -&amp;gt;
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Groovy5101Test$3(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, r, r) &lt;span class=&quot;code-comment&quot;&gt;// ---&amp;gt; [1] 2nd and 3rd args are same as &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;!??
&lt;/span&gt;    }
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; getClassA.call(r).getSomething() == r.toString() : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
}


&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy5101Test$3 &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Groovy5101Test$ClassA { 

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; groovy.lang.Reference r 
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Groovy5101Test &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;$0 

    Groovy5101Test$3(Groovy5101Test p0, groovy.lang.Reference p1, java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; p3) { &lt;span class=&quot;code-comment&quot;&gt;// ---[2]
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;( p3 )
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;$0 = p0 
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getSomething() {
        r.toString()
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The second parameter of Groovy5101Test$3 is Reference at &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;, but the instance of Runnable was passed at &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. So GroovyCastException occurred there.&lt;/p&gt;

&lt;p&gt;I guess the cause is around org.codehaus.groovy.classgen.asm.InvocationWriter#writeAICCall().&lt;/p&gt;</comment>
                            <comment id="14472132" author="melix" created="Mon, 28 Nov 2011 03:03:18 +0000"  >&lt;p&gt;As a workaround, replace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ClassA getClassA3(&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; r) {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassA(r) {
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getSomething() { r.toString() }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ClassA getClassA3(&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; r) {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassA(r) {
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getSomething() { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.r.toString() }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14472240" author="blackdrag" created="Tue, 20 Dec 2011 09:32:02 +0000"  >&lt;p&gt;the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5041&quot; title=&quot;Anonymous inner class constructor call referencing a getter caused NPE at compile time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5041&quot;&gt;&lt;del&gt;GROOVY-5041&lt;/del&gt;&lt;/a&gt; is actually almost the fix for this here too, only the wrong method to ask for the closure shared variable was used.&lt;/p&gt;

&lt;p&gt;Anyway, this issue is fixed, the provided est case passes now and is part of the build&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722875" name="Groovy5101Test.groovy" size="1036" author="nobeans" created="Tue, 25 Oct 2011 21:39:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cibr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>