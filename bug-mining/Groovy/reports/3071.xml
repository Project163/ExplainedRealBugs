<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:51:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7637] DefaultTypeTransformation.compareTo not symmetrical</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7637</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;DefaultTypeTransformation.compareTo(Object left, Object right) is being used in plenty of places in Groovy.&lt;/p&gt;

&lt;p&gt;However, for several corner cases, it does not provide symmetry, that is: when compareTo(a, b) returns a value (does not fail), then:&lt;/p&gt;

&lt;p&gt;signum(compareTo(a, b)) == - signum(compareTo(b, a))&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyNumber &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; {
        def n

        MyNumber(n) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.n = n
        }

        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; intValue(){n}
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; longValue(){n}
        &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; floatValue(){n}
        &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; doubleValue(){n}
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; hashCode(){-n}
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; equals(other) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (other &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; MyNumber) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; n==other.n}
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
        }
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {n.toString()}
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyNumberCompareTo &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MyNumber {

        MyNumberCompareTo(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; n) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(n)
        }

        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compareTo(MyNumber other) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; n &amp;lt;=&amp;gt; other.n
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyNumberComparable &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MyNumberCompareTo &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Comparable&amp;lt;MyNumber&amp;gt; {
        MyNumberComparable(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; n) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(n)
        }

        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compareTo(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; other) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; n &amp;lt;=&amp;gt;  (MyNumber) other;
        }
    }

    void testCompareTo() {
        def object1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;()
        def object2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;()
        &lt;span class=&quot;code-comment&quot;&gt;// objects
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) == 0
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(object1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) == 1
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, object1) == -1
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(1, 1) == 0

        shouldFail(GroovyRuntimeException) {
            compareTo(object1, object2)
        }

        &lt;span class=&quot;code-comment&quot;&gt;// chars, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; values 49 and 50
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt; char1 = &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;
        &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt; char2 = &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;
        checkCompareToSymmetricSmallerThan(char1, char2)

        MyNumber number1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumber(49)
        MyNumber number2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumber(50)

        MyNumberCompareTo numCompTo1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumberCompareTo(49)
        MyNumberCompareTo numCompTo2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumberCompareTo(50)

        MyNumberComparable numComp1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumberComparable(49)
        MyNumberComparable numComp2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyNumberComparable(50)

        List lowers = [49, 49L, 49.0, 49.0G, 49.00G, char1, &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;, number1, numCompTo1, numComp1]
        List highers = [50, 50L, 50.0, 50.0G, 50.00G, char2, &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;, number2, numCompTo2, numComp2]

        lowers.each { def lower -&amp;gt;
            &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(lower, lower) == 0
            highers.each { def higher -&amp;gt;
                checkCompareToSymmetricSmallerThan(lower, higher)
            }
        }

        &lt;span class=&quot;code-comment&quot;&gt;// glitch, failing with ClassCastException
&lt;/span&gt;        shouldFail(GroovyRuntimeException) {
            compareTo(1, &lt;span class=&quot;code-quote&quot;&gt;&quot;22&quot;&lt;/span&gt;)
        }
        shouldFail(GroovyRuntimeException) {
            compareTo(&lt;span class=&quot;code-quote&quot;&gt;&quot;22&quot;&lt;/span&gt;, 1)
        }

        &lt;span class=&quot;code-comment&quot;&gt;// strings and chars
&lt;/span&gt;

        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-quote&quot;&gt;&apos;aa1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;) &amp;gt; 0
        &lt;span class=&quot;code-comment&quot;&gt;// bug, classCast exception
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;aa1&apos;&lt;/span&gt;) &amp;lt; 0

        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-quote&quot;&gt;&quot;aa${1}&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;) &amp;gt; 0
        &lt;span class=&quot;code-comment&quot;&gt;// bug, classCast exception
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(&lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;aa${1}&quot;&lt;/span&gt;) &amp;lt; 0

        &lt;span class=&quot;code-comment&quot;&gt;// Strings and GStrings
&lt;/span&gt;        List lowers2 = [&lt;span class=&quot;code-quote&quot;&gt;&apos;aa1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;aa${1}&quot;&lt;/span&gt;]
        List highers2 = [&lt;span class=&quot;code-quote&quot;&gt;&apos;bb2&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b${2}&quot;&lt;/span&gt;]
        lowers2.each { def lower -&amp;gt;
            &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(lower, lower) == 0
            highers2.each { def higher -&amp;gt;
                checkCompareToSymmetricSmallerThan(lower, higher)
            }
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void checkCompareToSymmetricSmallerThan(a, b) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(a, b) &amp;lt; 0
            &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; compareTo(b, a) &amp;gt; 0
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (AssertionError e) {
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.print(a.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;toString() + &lt;span class=&quot;code-quote&quot;&gt;&apos; compared to &apos;&lt;/span&gt; + b.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;toString() )
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; e
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12905947">GROOVY-7637</key>
            <summary>DefaultTypeTransformation.compareTo not symmetrical</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="tkruse">Thibault Kruse</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Oct 2015 14:21:26 +0000</created>
                <updated>Tue, 2 May 2017 02:03:15 +0000</updated>
                            <resolved>Mon, 25 Jul 2016 09:17:05 +0000</resolved>
                                                    <fixVersion>2.5.0-alpha-1</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14963381" author="githubbot" created="Mon, 19 Oct 2015 14:28:47 +0000"  >&lt;p&gt;GitHub user tkruse opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/150&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/150&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    fix &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7637&quot; title=&quot;DefaultTypeTransformation.compareTo not symmetrical&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7637&quot;&gt;&lt;del&gt;GROOVY-7637&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7636&quot; title=&quot;NumberMath.getMath suboptimal choice for custom Numbers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7636&quot;&gt;&lt;del&gt;GROOVY-7636&lt;/del&gt;&lt;/a&gt; issues around Number Comparisons&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tkruse/incubator-groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tkruse/incubator-groovy&lt;/a&gt; groovy-7637-compareTo&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/150.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/150.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #150&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 48767107d824976c19199e7a863d644fd926e7fe&lt;br/&gt;
Author: Thibault Kruse &amp;lt;thibault.kruse@gmx.de&amp;gt;&lt;br/&gt;
Date:   2015-09-07T10:05:26Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7637&quot; title=&quot;DefaultTypeTransformation.compareTo not symmetrical&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7637&quot;&gt;&lt;del&gt;GROOVY-7637&lt;/del&gt;&lt;/a&gt;: Fix inconsistent missing Symmetry in DefaultTypeTransformation.compareTo()&lt;/p&gt;

&lt;p&gt;commit aa5ee3f98d93b22fdb0cdc89f8c3a79e6bc95f98&lt;br/&gt;
Author: Thibault Kruse &amp;lt;thibault.kruse@gmx.de&amp;gt;&lt;br/&gt;
Date:   2015-10-19T13:47:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7636&quot; title=&quot;NumberMath.getMath suboptimal choice for custom Numbers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7636&quot;&gt;&lt;del&gt;GROOVY-7636&lt;/del&gt;&lt;/a&gt;: Fall back to BigDecimalMath for custom Number implementations&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14963383" author="tkruse" created="Mon, 19 Oct 2015 14:29:12 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/150&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/150&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14963390" author="tkruse" created="Mon, 19 Oct 2015 14:33:05 +0000"  >&lt;p&gt;Note all issues found were such where compareTo(a, b) worked, but compareTo(b, a) failed with some exception. I fixed all those by making compareTo(b, a) also work. Arguably those could also have been fixed by also making compareTo(a, b) fail, but I assumed from the code that all such cases of compareTo(a, b) worked intentionally (because &quot;if-conditions&quot; had been written to handle those cases specifically).&lt;/p&gt;</comment>
                            <comment id="14963397" author="tkruse" created="Mon, 19 Oct 2015 14:36:46 +0000"  >&lt;p&gt;Related to &lt;a href=&quot;http://groovy.329449.n5.nabble.com/usage-of-NumberAwareComparator-in-extension-methods-and-number-oddities-a-bit-code-review-td5727501.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy.329449.n5.nabble.com/usage-of-NumberAwareComparator-in-extension-methods-and-number-oddities-a-bit-code-review-td5727501.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15391581" author="githubbot" created="Mon, 25 Jul 2016 09:11:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/150&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/150&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15391587" author="paulk" created="Mon, 25 Jul 2016 09:17:05 +0000"  >&lt;p&gt;PR merged with some minor tweaks. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2n6uv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>