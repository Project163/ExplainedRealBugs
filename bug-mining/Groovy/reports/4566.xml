<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:20:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-10789] Collected TupleConstructor causes internal compiler error</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-10789</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have an in-house annotation collector that applies some of the usual transforms (TupleConstructor, ToString, CompileStatic/POJO). There&apos;s a particular class where I want a no-arg constructor available, and I expected that I could &quot;override&quot; the annotation&apos;s values like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TcBug {
    @AnnotationCollector
    @TupleConstructor(defaults = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
    @&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Collector {}

    @Collector
    @TupleConstructor(defaults = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
    static &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
        &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; value
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, this results in the following error message. I had thought that the above would work; if it isn&apos;t &quot;supposed to&quot;, then a clearer error message (with location) would be helpful.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TcBug.groovy: -1: Unable to compile &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;com.example.TcBug$Foo due to hash collision in constructors @ line -1, column -1.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13485480">GROOVY-10789</key>
            <summary>Collected TupleConstructor causes internal compiler error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="chrylis">Christopher Smith</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Oct 2022 17:22:47 +0000</created>
                <updated>Fri, 10 Feb 2023 21:40:01 +0000</updated>
                            <resolved>Mon, 21 Nov 2022 21:40:32 +0000</resolved>
                                    <version>4.0.5</version>
                                    <fixVersion>4.0.7</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17615344" author="emilles" created="Mon, 10 Oct 2022 20:52:07 +0000"  >&lt;p&gt;You actually get quite a bit of control over how this works by setting the &quot;mode&quot; attribute on &lt;tt&gt;@AnnotationCollector&lt;/tt&gt; in your &lt;tt&gt;Collector&lt;/tt&gt; meta-annotation.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; AnnotationCollectorMode {
    /**
     * Annotations from the annotation collection will always be inserted. After all transforms have been run, it will
     * be an error &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; multiple annotations (excluding those with SOURCE retention) exist.
     */
    DUPLICATE,

    /**
     * Annotations from the collector will be added and any existing annotations with the same name will be removed.
     */
    PREFER_COLLECTOR,

    /**
     * Annotations from the collector will be ignored &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; any existing annotations with the same name are found.
     */
    PREFER_EXPLICIT,

    /**
     * Annotations from the collector will be added and any existing annotations with the same name will be removed but any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; parameters found within existing annotations will be merged into the added annotation.
     */
    PREFER_COLLECTOR_MERGED,

    /**
     * Annotations from the collector will be ignored &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; any existing annotations with the same name are found but any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; parameters on the collector annotation will be added to existing annotations.
     */
    PREFER_EXPLICIT_MERGED
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;For example, &lt;tt&gt;@Canonical&lt;/tt&gt; lets you do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
@Canonical(defaults=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// attribute of TupleConstructor
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
  &lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; foo
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17620517" author="emilles" created="Wed, 19 Oct 2022 19:12:51 +0000"  >&lt;p&gt;The hash error comes from way down where it checks the list of constructors and finds a duplicate.  That is, something generated an extra constructor.  I think you are getting dual application of TupleConstructor.&lt;/p&gt;</comment>
                            <comment id="17636881" author="emilles" created="Mon, 21 Nov 2022 20:52:35 +0000"  >&lt;p&gt;You probably want this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
@AnnotationCollector(mode = AnnotationCollectorMode.PREFER_EXPLICIT_MERGED)
@TupleConstructor(defaults = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
@&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Collector {
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I should be able to handle the &lt;tt&gt;DUPLICATE&lt;/tt&gt; case (the default) gracefully.&lt;/p&gt;</comment>
                            <comment id="17636897" author="emilles" created="Mon, 21 Nov 2022 21:40:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/f8d80b2353867dfe44d95883c4fad50bf611a0a0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/f8d80b2353867dfe44d95883c4fad50bf611a0a0&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13487154">GROOVY-10790</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z198a0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>