<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:41:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6412] CLONE - Incorrect parameter for annotations throws compilation exception with obfuscated message</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6412</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Same issue as below, my test class is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Qualifier
@Retention(RUNTIME)
@Target([FIELD, TYPE, METHOD])
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; @&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; MyAnnotation {
	MyValue value()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note: Did not import package for FIELD, TYPE and METHOD.&lt;br/&gt;
got the error below:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;General error during class generation: org.codehaus.groovy.ast.expr.VariableExpression cannot be cast to org.codehaus.groovy.ast.expr.PropertyExpression

java.lang.ClassCastException: org.codehaus.groovy.ast.expr.VariableExpression cannot be cast to org.codehaus.groovy.ast.expr.PropertyExpression
        at org.codehaus.groovy.vmplugin.v5.Java5.configureAnnotationFromDefinition(Java5.java:227)
        at org.codehaus.groovy.vmplugin.v5.Java5.configureAnnotation(Java5.java:242)
        at org.codehaus.groovy.classgen.AnnotationVisitor.visit(AnnotationVisitor.java:81)
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitAnnotation(ExtendedVerifier.java:154)
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitAnnotations(ExtendedVerifier.java:115)
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitClass(ExtendedVerifier.java:52)
        at org.codehaus.groovy.control.CompilationUnit$15.call(CompilationUnit.java:773)
        at org.codehaus.groovy.control.CompilationUnit.applyToPrimaryClassNodes(CompilationUnit.java:1036)
        at org.codehaus.groovy.control.CompilationUnit.doPhaseOperation(CompilationUnit.java:572)
:services:easervices:groovydoc
        at org.codehaus.groovy.control.CompilationUnit.processPhaseOperations(CompilationUnit.java:550)
        at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:527)
:services:easervices:groovydoc UP-TO-DATE
        at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:506)
        at org.gradle.api.internal.tasks.compile.ApiGroovyCompiler.execute(ApiGroovyCompiler.java:118)
        at org.gradle.api.internal.tasks.compile.ApiGroovyCompiler.execute(ApiGroovyCompiler.java:39)
:common:persistence:persistence-utility:processResources
        at org.gradle.api.internal.tasks.compile.daemon.CompilerDaemonServer.execute(CompilerDaemonServer.java:52)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(Reflectioch.java:35)
        at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
        at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:355)
        at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:66)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
:common:persistence:persistence-utility:processResources UP-TO-DATE
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:724)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;---- From original Jira&lt;/p&gt;

&lt;p&gt;Test class below.  The problem is simple, and it should have been found immediately on compilation.  Instead, a completely cryptic message is given from the exception thrown from the AnnotationVisitor:&lt;/p&gt;

&lt;p&gt;&quot;java.lang.ClassCastException: org.codehaus.groovy.ast.expr.VariableExpression cannot be cast to org.codehaus.groovy.ast.expr.PropertyExpression&quot;&lt;/p&gt;

&lt;p&gt;Expected behavior (best case) should give the file name, annotation, and line number of the offense.  In Grails this problem is especially bad because the stack traces are exceptionally long making this even more difficult to deal with.&lt;/p&gt;

&lt;p&gt;The following class will cause this issue, when compiled:&lt;/p&gt;

&lt;p&gt;import javax.persistence.*&lt;/p&gt;

&lt;p&gt;@Entity&lt;br/&gt;
class Foo{&lt;/p&gt;

&lt;p&gt;    @Id&lt;br/&gt;
    @GeneratedValue&lt;br/&gt;
    long id&lt;/p&gt;

&lt;p&gt;    @Temporal(DATE)&lt;br/&gt;
    Date testDate&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;When compiled it will produce this stack trace (to avoid the stack trace, change DATE above to TemporalType.DATE):&lt;/p&gt;

&lt;p&gt;org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed, General error during class generation: org.codehaus.groovy.ast.expr.VariableExpression cannot be cast to org.codehaus.groovy.ast.expr.PropertyExpression&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: org.codehaus.groovy.ast.expr.VariableExpression cannot be cast to org.codehaus.groovy.ast.expr.PropertyExpression&lt;br/&gt;
        at org.codehaus.groovy.classgen.AnnotationVisitor.visitExpression(AnnotationVisitor.java:137)&lt;br/&gt;
        at org.codehaus.groovy.classgen.AnnotationVisitor.visit(AnnotationVisitor.java:97)&lt;br/&gt;
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitAnnotation(ExtendedVerifier.java:108)&lt;br/&gt;
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitAnnotations(ExtendedVerifier.java:90)&lt;br/&gt;
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitField(ExtendedVerifier.java:59)&lt;br/&gt;
        at org.codehaus.groovy.ast.ClassNode.visitContents(ClassNode.java:842)&lt;br/&gt;
        at org.codehaus.groovy.classgen.ExtendedVerifier.visitClass(ExtendedVerifier.java:51)&lt;br/&gt;
        at org.codehaus.groovy.control.CompilationUnit$10.call(CompilationUnit.java:669)&lt;br/&gt;
        at org.codehaus.groovy.control.CompilationUnit.applyToPrimaryClassNodes(CompilationUnit.java:8&lt;br/&gt;
85)&lt;br/&gt;
        at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:436)&lt;br/&gt;
        at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:417)&lt;br/&gt;
        at org.codehaus.groovy.tools.FileSystemCompiler.compile(FileSystemCompiler.java:56)&lt;br/&gt;
        at org.codehaus.groovy.tools.FileSystemCompiler.main(FileSystemCompiler.java:220)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:101)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)&lt;/p&gt;</description>
                <environment>JDK 1.7, Windows 7</environment>
        <key id="12817078">GROOVY-6412</key>
            <summary>CLONE - Incorrect parameter for annotations throws compilation exception with obfuscated message</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="aljacinto">Alex Jacinto</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Oct 2013 08:17:43 +0000</created>
                <updated>Wed, 11 Jun 2014 14:25:24 +0000</updated>
                            <resolved>Thu, 29 May 2014 04:44:09 +0000</resolved>
                                    <version>2.1.2</version>
                                    <fixVersion>2.3.3</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14480553" author="paulk" created="Thu, 29 May 2014 04:44:09 +0000"  >&lt;p&gt;Your example now gives the following compilation error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;3 compilation errors:

Expected enum value for attribute value in @java.lang.annotation.Target
 at line: 7, column: 10

Expected enum value for attribute value in @java.lang.annotation.Target
 at line: 7, column: 17

Expected enum value for attribute value in @java.lang.annotation.Target
 at line: 7, column: 23
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ccav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>