<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:56:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-980] SimpleTemplateEngine fails when enclose expression dosn&apos;t immediately evaluate to a String</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-980</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;    void todo_testWithMarkupBuilder(){&lt;br/&gt;
    def text = &apos;&apos;&apos;&amp;lt;%&lt;br/&gt;
        builder = new groovy.xml.MarkupBuilder(out)&lt;br/&gt;
        &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;.each&lt;/p&gt;
{ count -&amp;gt;
            out.print(1)
        }
&lt;p&gt;    %&amp;gt;&apos;&apos;&apos;&lt;br/&gt;
    assertEquals(&apos;111&apos;, simpleCall(text))&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;produces&lt;/p&gt;

&lt;p&gt;&amp;lt;getAt&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&amp;lt;/getAt&amp;gt;11111&lt;/p&gt;

&lt;p&gt;while everything was fine in Groovy classic.&lt;/p&gt;

&lt;p&gt;I will commit more tests in groovy.text.SimpleTemplateEngineText.groovy&lt;/p&gt;</description>
                <environment></environment>
        <key id="12812932">GROOVY-980</key>
            <summary>SimpleTemplateEngine fails when enclose expression dosn&apos;t immediately evaluate to a String</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sormuras">sormuras</assignee>
                                    <reporter username="codevise">Dierk K&#246;nig</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Jul 2005 06:45:41 +0000</created>
                <updated>Fri, 22 Jul 2005 05:06:40 +0000</updated>
                            <resolved>Fri, 22 Jul 2005 05:06:40 +0000</resolved>
                                    <version>1.0-JSR-2</version>
                                    <fixVersion>1.0-JSR-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14461278" author="sormuras" created="Thu, 21 Jul 2005 11:02:46 +0000"  >&lt;p&gt;Here is the script source, STE produces running the  &apos;testWithMarkupBuilder()&apos;. Seems like the new lines are eaten to eagerly?&lt;/p&gt;

&lt;p&gt;-&lt;del&gt;before-parsing&lt;/del&gt;-&lt;br/&gt;
/* Generated by SimpleTemplateEngine */&lt;br/&gt;
out.print(&quot;&quot;);        builder = new groovy.xml.MarkupBuilder(out)        &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;.each&lt;/p&gt;
{ count -&amp;gt;            out.print(1)        }
&lt;p&gt;    ;&lt;br/&gt;
out.print(&quot;&quot;);&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
------------- ---------------- ---------------&lt;br/&gt;
Testcase: testWithMarkupBuilder(groovy.text.SimpleTemplateTest):	FAILED&lt;br/&gt;
expected:&amp;lt;...&amp;gt; but was:&amp;lt;&amp;lt;getAt&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&amp;lt;/getAt&amp;gt;11...&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14461385" author="sormuras" created="Thu, 21 Jul 2005 11:08:28 +0000"  >&lt;p&gt;Insert a &apos;;&apos; before the &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;-block make the test green... I bet, if you load the test source from a file, it&apos;ll go green as well. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;    def text = &apos;&apos;&apos;&amp;lt;%&lt;br/&gt;
        builder = new groovy.xml.MarkupBuilder(out);&lt;br/&gt;
        &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;.each&lt;/p&gt;
{ count -&amp;gt;
            out.print(1)
        }
&lt;p&gt;    %&amp;gt;&apos;&apos;&apos; &lt;/p&gt;</comment>
                            <comment id="14461356" author="sormuras" created="Thu, 21 Jul 2005 11:33:54 +0000"  >&lt;p&gt;Or use the GStringTemplateEngine, which knows how to handle those &apos;&apos;&apos;...&apos;&apos;&apos;-inlined strings.&lt;/p&gt;

&lt;p&gt;    String bindingCall(binding, input)&lt;/p&gt;
{
        def eng = new GStringTemplateEngine().createTemplate(input)
        return eng.make(binding).toString()
    }

&lt;p&gt;NOTE! Using the GStringTE, this test has to be removed as it throws an error:&lt;/p&gt;

&lt;p&gt;    void todo_testExpressionEval() {&lt;br/&gt;
        assertEquals(&apos;1&apos;, simpleCall(&apos;&amp;lt;%print(1)%&amp;gt;&apos;))&lt;br/&gt;
        assertEquals(&apos;01&apos;, simpleCall(&apos;&amp;lt;%for(i in 0..1)&lt;/p&gt;
{print(i)}
&lt;p&gt;%&amp;gt;&apos;))&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;The stacktrace reads:&lt;/p&gt;

&lt;p&gt;Testsuite: UberTestCase4&lt;br/&gt;
Tests run: 9, Failures: 0, Errors: 1, Time elapsed: 2,14 sec&lt;/p&gt;

&lt;p&gt;Testcase: testExpressionEval(groovy.text.SimpleTemplateTest):	Caused an ERROR&lt;br/&gt;
No signature of method groovy.lang.Binding.rint() is applicable for argument types: (java.lang.Integer) values: &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
groovy.lang.MissingMethodException: No signature of method groovy.lang.Binding.rint() is applicable for argument types: (java.lang.Integer) values: &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at groovy.lang.MetaClass.invokeMethod(MetaClass.java:326)&lt;br/&gt;
	at groovy.lang.MetaClass.invokeMethod(MetaClass.java:296)&lt;br/&gt;
	at groovy.lang.GroovyObjectSupport.invokeMethod(GroovyObjectSupport.java:73)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:171)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
	at groovy.lang.Closure.invokeMethod(Closure.java:166)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:152)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethod(ScriptBytecodeAdapter.java:85)&lt;br/&gt;
	at groovy.tmp.templates.C$_getTemplate_closure1.doCall(Unknown Source)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at groovy.lang.Closure.callViaReflection(Closure.java:431)&lt;br/&gt;
	at groovy.lang.Closure.call(Closure.java:323)&lt;br/&gt;
	at groovy.lang.Closure$WritableClosure.call(Closure.java:585)&lt;br/&gt;
	at groovy.text.GStringTemplateEngine$GStringTemplate$2.writeTo(GStringTemplateEngine.java:257)&lt;br/&gt;
	at groovy.text.GStringTemplateEngine$GStringTemplate$2.toString(GStringTemplateEngine.java:269)&lt;br/&gt;
	at gjdk.groovy.text.GStringTemplateEngine$GStringTemplate$2_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
	at groovy.lang.MetaMethod.invoke(MetaMethod.java:110)&lt;br/&gt;
	at groovy.lang.MetaClass.doMethodInvoke(MetaClass.java:1448)&lt;br/&gt;
	at groovy.lang.MetaClass.invokeMethod(MetaClass.java:311)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:145)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethod(ScriptBytecodeAdapter.java:85)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeNoArgumentsMethod(ScriptBytecodeAdapter.java:154)&lt;br/&gt;
	at groovy.text.SimpleTemplateTest.bindingCall(Unknown Source)&lt;br/&gt;
	at gjdk.groovy.text.SimpleTemplateTest_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
	at groovy.lang.MetaMethod.invoke(MetaMethod.java:110)&lt;br/&gt;
	at groovy.lang.MetaClass.doMethodInvoke(MetaClass.java:1448)&lt;br/&gt;
	at groovy.lang.MetaClass.invokeMethod(MetaClass.java:311)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:165)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethod(ScriptBytecodeAdapter.java:85)&lt;br/&gt;
	at groovy.text.SimpleTemplateTest.simpleCall(Unknown Source)&lt;br/&gt;
	at gjdk.groovy.text.SimpleTemplateTest_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
	at groovy.lang.MetaMethod.invoke(MetaMethod.java:110)&lt;br/&gt;
	at groovy.lang.MetaClass.doMethodInvoke(MetaClass.java:1448)&lt;br/&gt;
	at groovy.lang.MetaClass.invokeMethod(MetaClass.java:311)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:165)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:104)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethod(ScriptBytecodeAdapter.java:85)&lt;br/&gt;
	at groovy.text.SimpleTemplateTest.testExpressionEval(Unknown Source)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;/p&gt;</comment>
                            <comment id="14461295" author="sormuras" created="Thu, 21 Jul 2005 11:41:48 +0000"  >&lt;p&gt;Added a semicolon and activated the failing test.&lt;/p&gt;</comment>
                            <comment id="14461177" author="codevise" created="Fri, 22 Jul 2005 02:15:10 +0000"  >&lt;p&gt;I don&apos;t agree to mark this as fixed.&lt;br/&gt;
Adding the semicolon is a workaround, but not a fix.&lt;br/&gt;
I should be able to place valid Groovy inside the markers&lt;br/&gt;
like I could do before the latest changes.&lt;/p&gt;

&lt;p&gt;Changing the test to make it run is also&lt;br/&gt;
a bit problematic IMHO as it masks a known &lt;br/&gt;
deficiency. &lt;br/&gt;
It would be better to have a second, activated version&lt;br/&gt;
that includes the semicolon.&lt;/p&gt;</comment>
                            <comment id="14461357" author="sormuras" created="Fri, 22 Jul 2005 02:37:29 +0000"  >&lt;p&gt;&amp;gt; Adding the semicolon is a workaround, but not a fix. &lt;/p&gt;

&lt;p&gt;It&apos;s a valid syntax fix for me.&lt;/p&gt;

&lt;p&gt;&amp;gt; I should be able to place valid Groovy inside the markers&lt;br/&gt;
&amp;gt; like I could do before the latest changes.&lt;/p&gt;

&lt;p&gt;Hmmm... but when using &apos;&apos;&apos;...&apos;&apos;&apos; (GString) as input, you should use the correct template engine, namely the GStringTemplateEngine. (...) Sometimes, I really long for a new name for GString like Gring or something to separate it from (Java) String. Or am I missing s/t here?&lt;/p&gt;

&lt;p&gt;&amp;gt; It would be better to have a second, activated version&lt;br/&gt;
&amp;gt; that includes the semicolon.&lt;/p&gt;

&lt;p&gt;Ok. Lets write 3 test cases, which all take the correct input:&lt;/p&gt;

&lt;p&gt; o GString -&lt;br/&gt;
 o Simple -  TemplateEngineTest.java&lt;br/&gt;
 o Xml - &lt;/p&gt;

&lt;p&gt;Those 3 should replace the 2 we have at the moment:&lt;/p&gt;

&lt;p&gt; o TemplateTest.java (coping with GString, Simple and Xml)&lt;br/&gt;
 o SimpleTemplateTest.groovy&lt;/p&gt;</comment>
                            <comment id="14461397" author="sormuras" created="Fri, 22 Jul 2005 02:41:37 +0000"  >&lt;p&gt;Looking at &lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY-399&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY-399&lt;/a&gt; - we should write the test cases asap - before refactoring the whole parser stuff. After a first glimpse, it could help with all those char-by-char parser short-comings.&lt;/p&gt;</comment>
                            <comment id="14461384" author="codevise" created="Fri, 22 Jul 2005 03:16:15 +0000"  >&lt;p&gt;How is GStringTemplate supposed to be different than SimpleTemplateEngine?&lt;br/&gt;
Is there a difference in what you can do with it?&lt;br/&gt;
If so, where is the testcase (or doc?) that reveals it?&lt;/p&gt;

&lt;p&gt;I supposed they were two different implementations with the same behaviour,&lt;br/&gt;
unless for &apos;lazy evaluation&apos; of GStringTemplate.&lt;/p&gt;

&lt;p&gt;BTW: SimpleTemplateTest.groovy is only a start and needs to be completed&lt;br/&gt;
with more border cases like two &apos;inclusions&apos; that share variables etc.&lt;/p&gt;</comment>
                            <comment id="14461279" author="sormuras" created="Fri, 22 Jul 2005 04:27:58 +0000"  >&lt;p&gt;Now, both test cases are &apos;green&apos;:&lt;/p&gt;

&lt;p&gt;&amp;#8211; script source &amp;#8211;&lt;br/&gt;
/* Generated by SimpleTemplateEngine */&lt;br/&gt;
out.print(&quot;&quot;);&lt;br/&gt;
        builder = new groovy.xml.MarkupBuilder(out)&lt;br/&gt;
        &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;.each&lt;/p&gt;
{ count -&amp;gt;
            out.print(1)
        }
&lt;p&gt;    ;&lt;br/&gt;
out.print(&quot;&quot;);&lt;/p&gt;

&lt;p&gt;&amp;#8211; script end &amp;#8211;&lt;/p&gt;


&lt;p&gt;&amp;#8211; script source &amp;#8211;&lt;br/&gt;
/* Generated by SimpleTemplateEngine */&lt;br/&gt;
out.print(&quot;&quot;);&lt;br/&gt;
        builder = new groovy.xml.MarkupBuilder(out);&lt;br/&gt;
        &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,3&amp;#93;&lt;/span&gt;.each&lt;/p&gt;
{ count -&amp;gt;
            out.print(1);
        }
&lt;p&gt;    ;&lt;br/&gt;
out.print(&quot;&quot;);&lt;/p&gt;
</comment>
                            <comment id="14461218" author="codevise" created="Fri, 22 Jul 2005 05:06:40 +0000"  >&lt;p&gt;cool job!&lt;br/&gt;
thanx a lot&lt;br/&gt;
Mittie&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12812549">GROOVY-399</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c2a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>