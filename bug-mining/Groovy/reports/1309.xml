<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4163] Groovyc is unable to compile a class which implements interface and uses @Delegate annotation</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4163</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Groovy source file is attached.&lt;/p&gt;

&lt;p&gt;I am trying to compile this file with the command:&lt;br/&gt;
groovy Temp.groovy&lt;/p&gt;

&lt;p&gt;Compiler&apos;s output is as follows:&lt;/p&gt;

&lt;p&gt;org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:&lt;br/&gt;
Temp.groovy: 4: Can&apos;t have an abstract method in a non-abstract class. The class &apos;Temp&apos; must be declared abstract or the method &apos;void run()&apos; must be implemented.&lt;br/&gt;
 @ line 4, column 1.&lt;br/&gt;
   class Temp implements Runnable {&lt;br/&gt;
   ^&lt;/p&gt;

&lt;p&gt;1 error&lt;/p&gt;</description>
                <environment>linux x86_64 - Fedora 12,&lt;br/&gt;
Groovy 1.7.2 (also 1.7.1)&lt;br/&gt;
Java 1.6.0_18 (64-bit)</environment>
        <key id="12815155">GROOVY-4163</key>
            <summary>Groovyc is unable to compile a class which implements interface and uses @Delegate annotation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="pdolega">Pawel Dolega</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Apr 2010 19:27:09 +0000</created>
                <updated>Thu, 22 Jul 2010 17:32:27 +0000</updated>
                            <resolved>Fri, 25 Jun 2010 19:22:33 +0000</resolved>
                                    <version>1.7.1</version>
                    <version>1.7.2</version>
                                    <fixVersion>1.7.4</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14469295" author="blackdrag" created="Mon, 12 Apr 2010 12:22:39 +0000"  >&lt;p&gt;This could be solved if @Delegate runs before that check is done... only question is, if that is possible. &lt;/p&gt;</comment>
                            <comment id="14469287" author="pdolega" created="Mon, 12 Apr 2010 12:36:43 +0000"  >&lt;p&gt;Well, it compiles with no problem under Eclipse...&lt;br/&gt;
I need to compile groovy sources in my Gradle build, so Eclipse build is of no help to me actually but I thought it may be useful to look how guys are doing the compilation there. &lt;/p&gt;

&lt;p&gt;Thanks !&lt;/p&gt;</comment>
                            <comment id="14469261" author="blackdrag" created="Mon, 12 Apr 2010 16:26:16 +0000"  >&lt;p&gt;the eclipse plugin in is not the reference. They do what they need to do and sometimes their solution is good for eclipse, but not for Groovy. Also their are largely using the normal compiler. So if it works there now, there is no guarantee it will work there tomorrow too.&lt;/p&gt;</comment>
                            <comment id="14469603" author="roshandawrani" created="Thu, 24 Jun 2010 09:29:29 +0000"  >&lt;p&gt;Jochen, regarding your 1st comment here - @Delegate does already run before(canonicalization) the check takes place (classgen).&lt;/p&gt;</comment>
                            <comment id="14469621" author="blackdrag" created="Thu, 24 Jun 2010 10:23:20 +0000"  >&lt;p&gt;then why is there no run method?&lt;/p&gt;</comment>
                            <comment id="14469666" author="roshandawrani" created="Thu, 24 Jun 2010 10:32:46 +0000"  >&lt;p&gt;Explanation in the comments inline:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DelegateASTTransformation -&amp;gt; 
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void addDelegateMethod(...Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, MethodNode&amp;gt; ownMethods, 
    Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, MethodNode&amp;gt; e, ...) {
    MethodNode method = e.getValue();

    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!method.isPublic() || method.isStatic() || 0 != (method.getModifiers () &amp;amp; Opcodes.ACC_SYNTHETIC))
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;

    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!method.getAnnotations(DEPRECATED_TYPE).isEmpty() &amp;amp;&amp;amp; !deprecated)
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;

    MethodNode existingNode = ownMethods.get(e.getKey());

    /*
        Roshan: the following condition is not met &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; run() and hence it is not added
        as a delegate method

        ownMethods collection here is filled up &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Temp&apos;s interfaces, superclasses and itself
        and hence has run() already from java.lang.&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;
    */
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (existingNode == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || existingNode.getCode() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-comment&quot;&gt;// add the delegate method
&lt;/span&gt;    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469691" author="blackdrag" created="Thu, 24 Jun 2010 15:35:13 +0000"  >&lt;p&gt;I think the test for getCode()==null is wrong. Every method from a precompiled class will have that being abstract or not. If the method really is from Runnable and not from Thread, then this test should be replaced with a test for abstract instead. Because then the runnable method should be ignored and Thread#run method should be used. Of course, if for some reason the Threadd#run method does not even appear, that is yet another part of this bug&lt;/p&gt;</comment>
                            <comment id="14469708" author="roshandawrani" created="Thu, 24 Jun 2010 15:45:16 +0000"  >&lt;p&gt;Precompiled classes never seem to have getCode()==null. org.codehaus.groovy.vmplugin.v5.Java5#setMethodDefaultValue() ensures that all the methods of precompiled classes have getCode() != null.&lt;/p&gt;

&lt;p&gt;I already tried adding existingNode.isAbstract() in there. That helped in this case but broke other cases because then methods of GroovyObject (getMetaClass()/setMetaClass(), etc) also started coming in loop (DelegateAstTransformation comes before Verifier - so by the time @Delegate is happening, if we add isAbstract() check, then this adds getMetaClass()/setMetaClass() delegate methods as well, which interferes with what Verifier tries to do later - provide the standard getMetaClass()/setMetaClass(), etc)&lt;/p&gt;</comment>
                            <comment id="14469650" author="blackdrag" created="Thu, 24 Jun 2010 16:36:43 +0000"  >&lt;p&gt;I didn&apos;t mean to add it if abstract, I did mean to ignore it if abstract. This way an interface method should not be added ever. There should be an addition of the run method only because of an existing run method in Thread.&lt;/p&gt;</comment>
                            <comment id="14469734" author="roshandawrani" created="Thu, 24 Jun 2010 17:06:34 +0000"  >&lt;p&gt;No, no that is opposite of how it should be. In DelegateASTTransformation#addDelegateMethod(), it is looping over java.lang.Thread&apos;s method. It does not add Thread&apos;s run() to class Temp because it sees an existing run() on Temp (coming from Temp implementing Runnable). So what ends up being is that when it comes to ClassCompletionVerifier, it sees that Temp has an abstract run() (Runnable&apos;s) but no implementation of run() (because Thread&apos;s run() didn&apos;t get added to it).&lt;/p&gt;

&lt;p&gt;The solution will be to add the delegate run() to Temp&apos;s method in DelegateASTTransformation#addDelegateMethod() and not ignore it.&lt;/p&gt;

&lt;p&gt;Currently it is being ignored already and that is what is raising the issue in the first place. And it is being ignored because existingNode != null and existingNode.getCode() != null for run().&lt;/p&gt;

&lt;p&gt;And the getCode() != null because of that stupid org.codehaus.groovy.vmplugin.v5.Java5#setMethodDefaultValue() adding a return statement even to abstract methods of precompiled interfaces.&lt;/p&gt;</comment>
                            <comment id="14469676" author="blackdrag" created="Thu, 24 Jun 2010 17:41:15 +0000"  >&lt;p&gt;it does not add Thread#run, because there is an existing run method? The code was &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.lang.Delegate;


&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Temp &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; {
	@Delegate 
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; runnable
	
	def &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args) {
		def thread = &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread();
		def temp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Temp(runnable: thread)
	}
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you now imply that the &quot;implements Runnable&quot; is causing a run method to appear on Temp, then this is clearly not the intention. Unless the method is declared in Temp itself, the method should be override-able through the delegate. This of course creates a problem for GroovyObject implementing Java classes. @Delegate would then have to skip those special groovy methods.&lt;/p&gt;</comment>
                            <comment id="14469722" author="roshandawrani" created="Thu, 24 Jun 2010 17:48:04 +0000"  >&lt;p&gt;ownMethods collection that addDelegateMethod() uses for the following check comes from ClassNode#getDeclaredMethodsMap() and it has methods from all its interfaces too. So, when Temp doesn&apos;t provide an implementation, the above collection will still have a run() coming from Runnable. Looking at that, DelegateASTTransformation doesn&apos;t add the overriding run() that comes from Thread - causing ClassCompletionVerifier to see it as an abstract method whose implementation has not been provided.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        MethodNode existingNode = ownMethods.get(e.getKey());

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (existingNode == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || existingNode.getCode() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469638" author="blackdrag" created="Thu, 24 Jun 2010 18:03:47 +0000"  >&lt;p&gt;and I think that getDelcaredMethodsMap is maybe the wrong way, Either it should be only all non abstract methods or only the methods implemented in the current class that are used for this check. So for sure abstract methods originating from interfaces should be filtered out or other means to get the methods we need should be used... for example only getMethods(). Of yourse the later would mean a delegate would be overriding a method defined in the superclass if I am not wrong. Actually we need first discuss on the lists if this is correct behavior. Judging from backwards compatibility it surely is not. So in the end filtering our the &quot;abstract methods not declared in the delegate using class&quot; should be the way to go.&lt;/p&gt;</comment>
                            <comment id="14469748" author="roshandawrani" created="Thu, 24 Jun 2010 18:08:24 +0000"  >&lt;p&gt;Yes, now it seems on the right track - only that I don&apos;t know how to explain it all on the mailing list &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Someone with more background of current Delegate design can better ask that - like, what all it is designed to let the user override, etc (super class methods, for ex, as you point out)&lt;/p&gt;</comment>
                            <comment id="14479200" author="paulk" created="Thu, 24 Jun 2010 22:07:35 +0000"  >&lt;p&gt;The workaround for this case is to leave out the &lt;em&gt;implements&lt;/em&gt; clause, e.g.:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Temp {
    @Delegate
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; runnable
    
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args) {
        def thread = &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread()
        def temp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Temp(runnable: thread)
    }
}

&lt;span class=&quot;code-comment&quot;&gt;//println Temp.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;interfaces&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The Delegate transform will add in any interfaces found on the delegates class unless &quot;interfaces=false&quot; is provided as a param to the annotation.&lt;/p&gt;</comment>
                            <comment id="14469667" author="paulk" created="Thu, 24 Jun 2010 23:46:05 +0000"  >&lt;p&gt;Potential patch - but breaks GroovyShellTestCase which uses @Delegate with a protected field - investigating that now.&lt;/p&gt;</comment>
                            <comment id="14469692" author="roshandawrani" created="Fri, 25 Jun 2010 00:20:20 +0000"  >&lt;p&gt;Y&apos;day I tried multiple ways of fixing it too, but all got stuck with that @Delegate use in GroovyShellTestCase &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Sometimes it couldn&apos;t find setUp() on NullObject, other times, some interference started happening with those special methods of GroovyObject and its getMetaClass(), etc started getting affected.&lt;/p&gt;

&lt;p&gt;Then only I resorted to discussing it with Jochen. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14479229" author="paulk" created="Fri, 25 Jun 2010 01:07:22 +0000"  >&lt;p&gt;Yes, not much doco and poor test coverage in this territory! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Revised attached patch is better.&lt;br/&gt;
We&apos;ll have to make coverage testing more visible and maybe GSoC spec project can help us in spec area.&lt;/p&gt;</comment>
                            <comment id="14479208" author="paulk" created="Fri, 25 Jun 2010 02:31:04 +0000"  >&lt;p&gt;Possibly it would be better to skip methods from Object too - or at least prohibit Object from being the delegate type, i.e. give a warning if you leave out the type.&lt;/p&gt;</comment>
                            <comment id="14469675" author="roshandawrani" created="Fri, 25 Jun 2010 02:34:17 +0000"  >&lt;p&gt;That seems like a harmless restriction and makes sense too, but what is the issue if Object methods are not filtered?&lt;/p&gt;</comment>
                            <comment id="14479202" author="paulk" created="Fri, 25 Jun 2010 03:53:36 +0000"  >&lt;p&gt;Stops this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;You are not allowed to override the final method wait(long) from class &apos;java.lang.Object&apos;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469772" author="roshandawrani" created="Fri, 25 Jun 2010 04:01:04 +0000"  >&lt;p&gt;But doesn&apos;t that point to the breaking change that Jochen was pointing to? That after this change we will start overriding methods of super classes (because we now use ClassNode.getMethods() and not getDeclaredMethodMap())&lt;/p&gt;

&lt;p&gt;What if we filter out Object but we still have a structure like below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
     &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; def foo(){}
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
     @Delegate C c
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
     def foo(){}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now you have a base class A that provides the final method foo() that that base class is not Object. How do we take care of it? I think that is the breaking change Jochen was pointing to.&lt;/p&gt;</comment>
                            <comment id="14479231" author="paulk" created="Fri, 25 Jun 2010 04:53:50 +0000"  >&lt;p&gt;Revised patch - this one gives supplied method (direct or inherited) precedence over delegated method.&lt;/p&gt;</comment>
                            <comment id="14469687" author="paulk" created="Fri, 25 Jun 2010 19:22:34 +0000"  >&lt;p&gt;Patch applied&lt;/p&gt;</comment>
                            <comment id="14469782" author="roshandawrani" created="Sat, 26 Jun 2010 00:11:03 +0000"  >&lt;p&gt;I was testing the example from my last comment, but made a typo and it highlighted an issue that has been introduced.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;A.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
     &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; def foo(){}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;B.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
     @Delegate C c = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C()
     &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args){
        c.foo()
     }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;C.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
     def foo(){}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Expected error&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Apparent variable &lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt; was found in a &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; scope but doesn&apos;t refer to a local variable, &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; field or class.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Actual error&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caught: java.lang.VerifyError: (class: B, method: main signature: ([Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)V) Incompatible type &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; getting or setting field
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479232" author="paulk" created="Sat, 26 Jun 2010 01:20:50 +0000"  >&lt;p&gt;Does the fragment below also fail for you? Doesn&apos;t seem related to @Delegate if that is the case.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B {
  def c = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;()
  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args) {
    c.foo()
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I suspect it was introduced when we split out StaticVerifier and we mustn&apos;t have coverage for that case. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14469784" author="paulk" created="Sat, 26 Jun 2010 01:36:04 +0000"  >&lt;p&gt;OK, found the issue. It was a missing line from &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4228&quot; title=&quot;Groovy should have a mechanism to create class-level fields in Scripts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4228&quot;&gt;&lt;del&gt;GROOVY-4228&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14469747" author="paulk" created="Sat, 26 Jun 2010 01:46:32 +0000"  >&lt;p&gt;Can you try again?&lt;/p&gt;</comment>
                            <comment id="14469694" author="roshandawrani" created="Sat, 26 Jun 2010 03:39:00 +0000"  >&lt;p&gt;Seems fine now.&lt;/p&gt;</comment>
                            <comment id="14469781" author="roshandawrani" created="Sat, 26 Jun 2010 05:02:43 +0000"  >&lt;p&gt;Possibly one more issue here. The check introduced before deciding whether to add a delegate a method or not is based on type descriptor of the method alone and that may not be sufficient.&lt;/p&gt;

&lt;p&gt;In the code below, shouldn&apos;t the call from B#main() go to C#foo()?&lt;/p&gt;

&lt;p&gt;So, if for a delegate candidate method (which can only be an instance method), if in DelegateASTTransformation#addDelegateMethod(), a match(existingNode) is found but is static, it should be ignored.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;A.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
     &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; foo(){println &lt;span class=&quot;code-quote&quot;&gt;&quot;A-&amp;gt;foo()&quot;&lt;/span&gt;}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;B.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;B &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; A {
     @Delegate C c = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C()
     &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; main(args){
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; B().foo()
     }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;C.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
     def foo(){println &lt;span class=&quot;code-quote&quot;&gt;&quot;C-&amp;gt;foo()&quot;&lt;/span&gt;}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469695" author="roshandawrani" created="Sat, 26 Jun 2010 05:26:11 +0000"  >&lt;p&gt;I just checked that the static/instance issue last raised is present in 1.7.3 too.&lt;/p&gt;

&lt;p&gt;Should I open a new issue? I am not doing it right away to also check if others see it is a valid issue.&lt;/p&gt;</comment>
                            <comment id="14479240" author="paulk" created="Sat, 26 Jun 2010 06:42:34 +0000"  >&lt;p&gt;A new issue might be best&lt;/p&gt;</comment>
                            <comment id="14469774" author="roshandawrani" created="Sat, 26 Jun 2010 08:51:13 +0000"  >&lt;p&gt;Raised &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4265&quot; title=&quot;@Delegate&amp;#39;s dealing with static methods seems incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4265&quot;&gt;&lt;del&gt;GROOVY-4265&lt;/del&gt;&lt;/a&gt; for the issue related to @Delegate wrongly dealing with static matches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722560" name="Temp.groovy" size="218" author="pdolega" created="Sun, 11 Apr 2010 19:27:09 +0000"/>
                            <attachment id="12722681" name="groovy4163_delegateWithImplementsC.patch" size="7056" author="paulk" created="Fri, 25 Jun 2010 04:53:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bujb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>