<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:28:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5187] Groovy Script Engine creates new classes for each script and doesn&apos;t get garbage collected</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5187</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;New classes are created for each script:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/jsr223/GroovyScriptEngineImpl.java#L109&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/jsr223/GroovyScriptEngineImpl.java#L109&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Which are added to the classMap, which grows and old classes don&apos;t get garbage collected:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/jsr223/GroovyScriptEngineImpl.java#L338&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/blob/master/src/main/org/codehaus/groovy/jsr223/GroovyScriptEngineImpl.java#L338&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This results in PermGen errors:&lt;/p&gt;

&lt;p&gt;Rexster Groovy Script Engine&lt;br/&gt;
&lt;a href=&quot;https://github.com/tinkerpop/rexster/issues/143&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tinkerpop/rexster/issues/143&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Neo4j Server Groovy Script Engine&lt;br/&gt;
&lt;a href=&quot;http://neo4j-community-discussions.438527.n3.nabble.com/Neo4j-Feedback-after-evaluation-tp3569774p3574520.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://neo4j-community-discussions.438527.n3.nabble.com/Neo4j-Feedback-after-evaluation-tp3569774p3574520.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There is no public way of removing older scripts and the HashMap is not a LinkedHashMap with LRU enabled for storing them. Right now the Neo4j workaround is to recreated the GSE every 500 requests.&lt;/p&gt;



</description>
                <environment></environment>
        <key id="12815976">GROOVY-5187</key>
            <summary>Groovy Script Engine creates new classes for each script and doesn&apos;t get garbage collected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="espeed">James Thornton</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Dec 2011 16:36:04 +0000</created>
                <updated>Sat, 22 Dec 2012 01:10:46 +0000</updated>
                            <resolved>Mon, 17 Dec 2012 08:41:55 +0000</resolved>
                                    <version>1.8.4</version>
                    <version>2.0-beta-1</version>
                                    <fixVersion>2.0.6</fixVersion>
                    <fixVersion>1.8.9</fixVersion>
                                    <component>GroovyScriptEngine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14473186" author="blackdrag" created="Tue, 14 Aug 2012 08:39:09 +0000"  >&lt;p&gt;I made the map a soft reference based one. It can now forget entries over time. OOME can still happen of course, since class unloading is not always done as it should by the JVM, but the cases are very much reduced. This solution is kind of a middle ground. A LRU could still cause OOME, on the other hand the engine is originally not created to forget classes.&lt;/p&gt;</comment>
                            <comment id="14473321" author="blackdrag" created="Mon, 17 Sep 2012 09:42:24 +0000"  >&lt;p&gt;Because of me taking the wrong map &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5706&quot; title=&quot;JSR 223 invokeFunction broken in 2.0.2 - regression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5706&quot;&gt;&lt;del&gt;GROOVY-5706&lt;/del&gt;&lt;/a&gt; was filled and that has a major effect on the fix released in 1.8.8 and 2.0.2, till the point the jsr223 module my not really work anymore. Thus a new fix was required, changing the fix version for this issue&lt;/p&gt;</comment>
                            <comment id="14473575" author="blackdrag" created="Mon, 17 Dec 2012 08:41:56 +0000"  >&lt;p&gt;As there have been a conflict with &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5786&quot; title=&quot;methods defined by one eval are &amp;#39;lost&amp;#39; over time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5786&quot;&gt;&lt;del&gt;GROOVY-5786&lt;/del&gt;&lt;/a&gt; this feature now has to be activated. that means the engine will by default not forget global functions and attached classes. See &lt;a href=&quot;http://groovy.codehaus.org/JSR+223+Scripting+with+Groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy.codehaus.org/JSR+223+Scripting+with+Groovy&lt;/a&gt; for how to activate it&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bphb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>