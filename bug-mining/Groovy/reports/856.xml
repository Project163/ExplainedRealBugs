<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:10:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2605] Incorrect parsing</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2605</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;For the following script the toplevel expression should be cast. Currently groovy parses this as call on cast result.&lt;/p&gt;

&lt;p&gt;(String) {-&amp;gt; print &quot;&quot;}.call()&lt;/p&gt;</description>
                <environment></environment>
        <key id="12814043">GROOVY-2605</key>
            <summary>Incorrect parsing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="ven">Eugene Vigdorchik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Feb 2008 05:15:41 +0000</created>
                <updated>Thu, 15 Oct 2009 17:17:14 +0000</updated>
                            <resolved>Thu, 1 Jan 2009 00:43:01 +0000</resolved>
                                                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>ast builder</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14464282" author="ven" created="Fri, 15 Feb 2008 05:16:31 +0000"  >&lt;p&gt;Seems a rather serious bug to me.&lt;/p&gt;</comment>
                            <comment id="14465410" author="blackdrag" created="Mon, 13 Oct 2008 10:23:13 +0000"  >&lt;p&gt;so basically the call should bind stronger than the cast. The cast is not forgotten, it just happens not where you expect it.&lt;/p&gt;</comment>
                            <comment id="14465356" author="blackdrag" created="Mon, 13 Oct 2008 10:24:05 +0000"  >&lt;p&gt;if we want to fix this, then a change to the parser is required to prefer the cast over the method call. Or we decide to not to fix this.&lt;/p&gt;</comment>
                            <comment id="14465917" author="blackdrag" created="Fri, 19 Dec 2008 10:57:50 +0000"  >&lt;p&gt;hmm... after looking at groovy.g for quite some time I still have no idea how to change this. I guess the parser recognizes {-&amp;gt; print &quot;&quot;} as expression and then stops there. We probably would have to turn oon the greedy option.. but it is not working like that&lt;/p&gt;</comment>
                            <comment id="14466007" author="guillaume" created="Fri, 19 Dec 2008 11:46:48 +0000"  >&lt;p&gt;I guess we should postpone that issue to a later version as it&apos;s not really trivial.&lt;/p&gt;</comment>
                            <comment id="14465969" author="blackdrag" created="Fri, 19 Dec 2008 15:03:27 +0000"  >&lt;p&gt;Also I think someone else  should have a look at the issue, because I currently have no idea how to fix this. Maybe I oversee something and someone else will see it. Maybe Paul or Roshan have an idea. But I think it is too short for 1.6 rc1, so postponing it is something we really should do&lt;/p&gt;</comment>
                            <comment id="14466036" author="guillaume" created="Fri, 19 Dec 2008 15:10:10 +0000"  >&lt;p&gt;I&apos;m rescheduling it to &quot;just&quot; Groovy 1.7 for the moment.&lt;br/&gt;
When we get to that point, we&apos;ll see if we want to bring that back to the 1.5.x and 1.6.x line.&lt;/p&gt;</comment>
                            <comment id="14466060" author="roshandawrani" created="Wed, 24 Dec 2008 15:52:02 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
    Attaching a patch to groovy.g to fix this issue. With the fix, the following test goes through (also verified by running the existing 1.7 branch&apos;s tests):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; gls.syntax

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ParsingTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; gls.CompilableTestSupport {
    void testExpressionParsingWithCastingInFrontOfAClosure() {
        shouldCompile &quot;&quot;&quot;
            (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) {-&amp;gt; print &quot;&quot;}.call()
        &quot;&quot;&quot;
    
        def testObj = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Groovy2605()

        def val1 = {-&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; testObj}.call()
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; val1 &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Groovy2605
        
        def val2 = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;){-&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; testObj}.call()
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; val2 &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; val2 == &lt;span class=&quot;code-quote&quot;&gt;&quot;[A Groovy2605 object]&quot;&lt;/span&gt;
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy2605 {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString(){
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;[A Groovy2605 object]&quot;&lt;/span&gt;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the fix looks ok, I can commit the changes. Please let me know.&lt;/p&gt;

&lt;p&gt;rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14466012" author="guillaume" created="Thu, 25 Dec 2008 03:39:48 +0000"  >&lt;p&gt;Looks good to me.&lt;br/&gt;
Jochen, what do you think?&lt;br/&gt;
I guess we could reschedule that issue for Groovy 1.6 as well then.&lt;/p&gt;</comment>
                            <comment id="14466021" author="roshandawrani" created="Thu, 25 Dec 2008 03:49:16 +0000"  >&lt;p&gt;Attaching a slightly improved version of the earlier patch and the test-case modified accordingly.&lt;/p&gt;

&lt;p&gt;The previous patch did not handle casting to built-in types like in&lt;/p&gt;

&lt;p&gt;(int) {-&amp;gt; print 0}.call(), or&lt;/p&gt;

&lt;p&gt;(int[]) {-&amp;gt; print null}.call()&lt;/p&gt;

&lt;p&gt;Now it handles casting to built-in types as well.&lt;/p&gt;</comment>
                            <comment id="14466090" author="blackdrag" created="Thu, 25 Dec 2008 07:59:04 +0000"  >&lt;p&gt;ah, now I see why I couldn&apos;t it... I did look at the wrong rule... we have another place that handles casts. Do we need that as well? It would be good if we could remove them&lt;/p&gt;</comment>
                            <comment id="14466001" author="roshandawrani" created="Thu, 25 Dec 2008 08:12:42 +0000"  >&lt;p&gt;Both the other occurances of TYPECAST are under the rule unaryExpressionNotPlusMinus but it seems to be handling 2 sub-rules differently there - one for builtInTypeSpec and other for classTypeSpec, whereas in the current fix, it is one combined cast scenario of typeSpec that is being used.&lt;/p&gt;

&lt;p&gt;I don&apos;t understand it well enough to understand the side-effects of removing the casting subrules from under unaryExpressionNotPlusMinus. Is it really necessary to try to remove them right now?&lt;/p&gt;</comment>
                            <comment id="14466047" author="roshandawrani" created="Tue, 30 Dec 2008 21:01:42 +0000"  >&lt;p&gt;Shall I apply this fix? I yes, on what all branches? Trunk and 1.6 or 1.5.8 too?&lt;/p&gt;</comment>
                            <comment id="14466109" author="blackdrag" created="Tue, 30 Dec 2008 21:55:21 +0000"  >&lt;p&gt;I think we should apply it only to 1.7. Also I think testing if the removal of the two subrules does break anything. If not, then they should be added to the patch. &lt;/p&gt;</comment>
                            <comment id="14466048" author="roshandawrani" created="Thu, 1 Jan 2009 00:43:01 +0000"  >&lt;p&gt;Fixed (on trunk)&lt;/p&gt;</comment>
                            <comment id="14466094" author="blackdrag" created="Thu, 1 Jan 2009 07:47:04 +0000"  >&lt;p&gt;but you did not try to remove the surplus rules, did you?&lt;/p&gt;</comment>
                            <comment id="14466026" author="roshandawrani" created="Thu, 1 Jan 2009 09:10:36 +0000"  >&lt;p&gt;I tried removing one of those sub-rules but it started throwing compilation errors. So I thought they might not be as surplus as they first looked and went ahead and applied the original patch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722020" name="Groovy2605.diff" size="2182" author="roshandawrani" created="Thu, 25 Dec 2008 03:49:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c0if:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>