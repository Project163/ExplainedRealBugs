<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:45:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7385] Invalid Integer &amp; Long literals compile when they shouldn&apos;t</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7385</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;2147483648I should be an invalid Integer literal.&lt;br/&gt;
9223372036854775808L should be an invalid Long literal.&lt;/p&gt;

&lt;p&gt;Both currently compile (and produce an unexpected value &amp;#8211; well, it would be the expected value in 2&apos;s complement math)&lt;/p&gt;

&lt;p&gt;I created some unit tests to show the problem &amp;#8211; not sure if I put them in the right place, but they do fail as I expect them to.&lt;/p&gt;

&lt;p&gt;The Github PR is here: &lt;br/&gt;
&lt;a href=&quot;https://github.com/groovy/groovy-core/pull/657&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/657&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The build output is here:&lt;br/&gt;
&lt;a href=&quot;http://ci.groovy-lang.org/viewLog.html?buildId=16410&amp;amp;buildTypeId=Groovy_Jdk7Build&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ci.groovy-lang.org/viewLog.html?buildId=16410&amp;amp;buildTypeId=Groovy_Jdk7Build&lt;/a&gt;&lt;/p&gt;</description>
                <environment>Mac OS X</environment>
        <key id="12820357">GROOVY-7385</key>
            <summary>Invalid Integer &amp; Long literals compile when they shouldn&apos;t</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="msgilligan">Sean Gilligan</reporter>
                        <labels>
                    </labels>
                <created>Sun, 12 Apr 2015 02:05:36 +0000</created>
                <updated>Tue, 13 Jun 2017 04:09:26 +0000</updated>
                            <resolved>Sun, 7 Aug 2016 07:22:14 +0000</resolved>
                                    <version>2.4.3</version>
                                    <fixVersion>2.5.0-alpha-1</fixVersion>
                                    <component>syntax</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14491298" author="msgilligan" created="Sun, 12 Apr 2015 02:07:05 +0000"  >&lt;p&gt;p.s. In the Github PR, I referenced the Java Language Specification section that is being violated.&lt;/p&gt;</comment>
                            <comment id="14492082" author="blackdrag" created="Mon, 13 Apr 2015 08:50:13 +0000"  >&lt;p&gt;Won&apos;t fix, since Groovy is not Java and Groovy does this on purpose&lt;/p&gt;</comment>
                            <comment id="14492447" author="msgilligan" created="Mon, 13 Apr 2015 14:23:39 +0000"  >&lt;p&gt;One of the major selling points of Groovy is that is Java-like (and almost a pure superset of Java) where possible. Why would Groovy do this on purpose?&lt;/p&gt;

&lt;p&gt;It results in undesirable behavior like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    assert 2147483648I == -2147483648I
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;being satisfied&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    assert 9223372036854775808L == -9223372036854775808L
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;results in:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caught: java.lang.NoSuchFieldError: $const$0
java.lang.NoSuchFieldError: $const$0
	at test.run(test.groovy:2)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which could be a different problem altogether, but seems related.&lt;/p&gt;</comment>
                            <comment id="14492710" author="msgilligan" created="Mon, 13 Apr 2015 17:38:16 +0000"  >&lt;p&gt;I didn&apos;t realize that I could re-open the issue, but I posted a comment 3 hours ago providing more information and asking for clarification.&lt;/p&gt;</comment>
                            <comment id="14506690" author="blackdrag" created="Wed, 22 Apr 2015 09:10:28 +0000"  >&lt;p&gt;ok, makes sense&lt;/p&gt;</comment>
                            <comment id="14506982" author="blackdrag" created="Wed, 22 Apr 2015 12:26:32 +0000"  >&lt;p&gt;it looks like there is an overlap of this issue with &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-5583&quot; title=&quot;Parsing problem of number literal 0x8000000000000000L&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-5583&quot;&gt;&lt;del&gt;GROOVY-5583&lt;/del&gt;&lt;/a&gt;. Simply checking if the given number fits in int or long is getting difficult if the number is not given as a base 10 literal. For example 0x8000_0000_0000_0000L is supposed to be a valid long, but it will be an overflow case. Same for 010_0000_0000_0000_0000_0000L, and 0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000L&lt;/p&gt;</comment>
                            <comment id="14508152" author="msgilligan" created="Wed, 22 Apr 2015 23:30:04 +0000"  >&lt;p&gt;I haven&apos;t looked at the source code for the parser, but it seems the values could be parsed into a &lt;tt&gt;BigInteger&lt;/tt&gt; and then range checked for any explicit literal type. Similar logic should probably use for floating point: parse into &lt;tt&gt;BigDecimal&lt;/tt&gt; then try to convert to &lt;tt&gt;Double&lt;/tt&gt; or &lt;tt&gt;Float&lt;/tt&gt; if explicit type is specified.&lt;/p&gt;

&lt;p&gt;If a literal value with an explicit type won&apos;t fit in that type, it should be a compile time error.&lt;/p&gt;

&lt;p&gt;Then there&apos;s also the above &lt;tt&gt;java.lang.NoSuchFieldError: $const$0&lt;/tt&gt; error which only seems to happen for that exact value.&lt;/p&gt;
</comment>
                            <comment id="14508212" author="blackdrag" created="Thu, 23 Apr 2015 00:25:23 +0000"  >&lt;p&gt;0x8000_0000_0000_0000L is legal in Java. But if I do a range check with the BigInteger based logic, then the resulting number is bigger than the long max value. 0x7FFF_FFFF_FFFF_FFFFL is the long max value and 0xFFFF_FFFF_FFFF_FFFFL is -1 and 0x8000_0000_0000_0000L is the smalles negative long value. So is a hex value &amp;gt;0x7FFF_FFFF_FFFF_FFFFL supposed to be legal? If yes, then it cannot be simply done using BigInteger. I currently have it, that only the base 10 version is checked.&lt;/p&gt;

&lt;p&gt;As for floating point numbers... I think that can&apos;t be done. when it comes to float or double, then their range varies not only in the maximum numbers, but also in the precision. Something like 0.2 can already not be represented exactly by those types. &lt;/p&gt;</comment>
                            <comment id="14508268" author="msgilligan" created="Thu, 23 Apr 2015 01:25:06 +0000"  >&lt;p&gt;Good, point &amp;#8211; I read that in the Java Language Spec, but forgot about it in my last comment. What Java is doing makes sense &amp;#8211; when specifying numbers in hex, programmers are treating them as unsigned and would expect 0x8000_0000_0000_0000L to be negative. So yes, the checking needs to be different for Base 10 vs the other bases.&lt;/p&gt;

&lt;p&gt;It looks like &lt;tt&gt;Numbers.java&lt;/tt&gt; throws &lt;tt&gt;NumberFormatException&lt;/tt&gt; when floating point literals are out of range. It would be friendly, I think, to not allow something like &lt;tt&gt;0.100000001f&lt;/tt&gt; to compile (i.e. the user has explicitly specified precision greater than supported), but (my understanding of) &lt;a href=&quot;http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.10.2. Floating-Point Literals&lt;/a&gt; says that this is allowed:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A compile-time error does not occur if a non-zero floating-point literal has a small value that, on rounded conversion to its internal representation, becomes a non-zero denormalized number.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However a compile time error is required if a number rounds to zero:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It is a compile-time error if a non-zero floating-point literal is too small, so that, on rounded conversion to its internal representation, it becomes a zero.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The nice thing about Groovy is that you can use &lt;tt&gt;BigDecimal&lt;/tt&gt; literals just by removing the type suffix from the end. But it seems that anything with a type suffix that won&apos;t compile in Java should not compile in Groovy, as well.&lt;/p&gt;
</comment>
                            <comment id="14508277" author="msgilligan" created="Thu, 23 Apr 2015 01:33:06 +0000"  >&lt;p&gt;I&apos;m doing work with (digital) currency and am seeking to avoid any rounding or truncation, so am looking at everything with an eagle eye. Note that JSR-354 (Java Money) include a subclass of &lt;tt&gt;Number&lt;/tt&gt; called &lt;a href=&quot;https://github.com/JavaMoney/jsr354-api/blob/master/src/main/java/javax/money/NumberValue.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;NumberValue&lt;/a&gt; that adds methods named &lt;tt&gt;longValueExact()&lt;/tt&gt;, &lt;tt&gt;doubleValueExact()&lt;/tt&gt;, etc. that throw &lt;tt&gt;ArithmeticException&lt;/tt&gt; if truncation would have occurred.&lt;/p&gt;</comment>
                            <comment id="15393404" author="githubbot" created="Tue, 26 Jul 2016 08:14:04 +0000"  >&lt;p&gt;GitHub user msgilligan opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/373&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Add tests for valid and invalid integer literals (shouldCompile/shouldNotCompile)&lt;/p&gt;

&lt;p&gt;    Add tests for integer literals that `shouldCompile` and `shouldNotCompile`.&lt;/p&gt;

&lt;p&gt;    Some of these tests currently fail because of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7385&quot; title=&quot;Invalid Integer &amp;amp; Long literals compile when they shouldn&amp;#39;t&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7385&quot;&gt;&lt;del&gt;GROOVY-7385&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7385&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/GROOVY-7385&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;    I&apos;m not sure what the right way is to submit failing tests, so please let me know if I should change things up. This PR was submitted earlier, but was lost when &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7385&quot; title=&quot;Invalid Integer &amp;amp; Long literals compile when they shouldn&amp;#39;t&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7385&quot;&gt;&lt;del&gt;GROOVY-7385&lt;/del&gt;&lt;/a&gt; was closed &amp;#8211; before it was reopened.&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/msgilligan/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/msgilligan/groovy&lt;/a&gt; msgilligan-integer-literal-tests-take2&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/373.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/373.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #373&lt;/p&gt;

&lt;hr /&gt;

&lt;hr /&gt;</comment>
                            <comment id="15410845" author="githubbot" created="Sun, 7 Aug 2016 07:17:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/373&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15410846" author="jwagenleitner" created="Sun, 7 Aug 2016 07:19:32 +0000"  >&lt;p&gt;Merged PR with the tests. Thanks.&lt;/p&gt;

&lt;p&gt;Looks like this was fixed by commit &lt;a href=&quot;https://github.com/apache/groovy/commit/a258a3d026ebefc411797b2f69915fe1860262db&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/a258a3d026ebefc411797b2f69915fe1860262db&lt;/a&gt;.  Fix should be in 2.5 once released.&lt;/p&gt;</comment>
                            <comment id="15410847" author="jwagenleitner" created="Sun, 7 Aug 2016 07:22:14 +0000"  >&lt;p&gt;I&apos;m going to go ahead and mark as resolved for 2.5 since tests all pass on master.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/groovy/groovy-core/pull/657]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d5f3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>