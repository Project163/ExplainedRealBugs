<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:07:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2786] ObservableMap doesn&apos;t fire Property Change Event upon removal</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2786</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Taking the example from doc&lt;/p&gt;

&lt;p&gt;def map = &lt;span class=&quot;error&quot;&gt;&amp;#91;one: 1, two: 2&amp;#93;&lt;/span&gt; as ObservableMap&lt;br/&gt;
map.addPropertyChangeListener({evt -&amp;gt;     println &quot;${evt.propertyName}: ${evt.oldValue} -&amp;gt; ${evt.newValue}&quot;} as PropertyChangeListener)&lt;/p&gt;

&lt;p&gt;map.remove(&quot;one&quot;)&lt;/p&gt;

&lt;p&gt;nothing is printed. Other operations like put, replace element do work without problem.&lt;/p&gt;


&lt;p&gt;map.clear() also do nth. as putAll() does fire events, i think clear() should do so. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12814131">GROOVY-2786</key>
            <summary>ObservableMap doesn&apos;t fire Property Change Event upon removal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aalmiray">Andres Almiray</assignee>
                                    <reporter username="mingfai">Mingfai Ma</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 Apr 2008 16:30:09 +0000</created>
                <updated>Sun, 12 Oct 2008 08:49:44 +0000</updated>
                            <resolved>Mon, 7 Jul 2008 15:35:02 +0000</resolved>
                                    <version>1.5.6</version>
                                    <fixVersion>1.6-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14464634" author="alpe" created="Mon, 28 Apr 2008 09:42:43 +0000"  >&lt;p&gt;I took a look at the remove and clear method. they do not fire any  property change event. &lt;br/&gt;
but is this really a bug or should more documentation explain the behaviour?&lt;/p&gt;

&lt;p&gt;PropertyChangeEvent requires an oldValue and newValue. &lt;br/&gt;
When i remove a key from the map what values should the event carry?&lt;/p&gt;

</comment>
                            <comment id="14464607" author="guillaume" created="Mon, 28 Apr 2008 09:52:40 +0000"  >&lt;p&gt;I think it&apos;s designed that way.&lt;br/&gt;
But Andres may shade some more light on this?&lt;/p&gt;</comment>
                            <comment id="14464687" author="aalmiray" created="Mon, 28 Apr 2008 12:45:42 +0000"  >&lt;p&gt;As Guillaume noted, it is designed that way, the intention of ObservableMap is to mimic an observable bean, you can&apos;t remove properties from a bean, can you? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;On the other hand I see the benefit of having OM publish events when an element or all elements are removed, but the event triggered should not be a PropertyChangeEvent. This may be confusing as OM currently sends a PCE when a &apos;new&quot; property is &quot;added&quot;, so it should trigger a PropertyAddedEvent instead, but in a sense OM holds &lt;b&gt;every&lt;/b&gt; property possible from the start (again if trying to mimic an observable bean).&lt;/p&gt;

&lt;p&gt;Two questions remain then:&lt;br/&gt;
a) should PropertyRemovedEvent/PropertiesClearedEvent be added to OM ?&lt;br/&gt;
b) if a) should PropertyAddedEvent be triggered when a &quot;new&quot; property is added to the map ?&lt;/p&gt;</comment>
                            <comment id="14464717" author="mingfai" created="Mon, 28 Apr 2008 18:17:09 +0000"  >&lt;p&gt;I guess we agree it&apos;s necessary to fire removal event. Otherwise, the Observable Map is somehow useless. &lt;/p&gt;

&lt;p&gt;&amp;gt;PropertyChangeEvent requires an oldValue and newValue.&lt;br/&gt;
&amp;gt;When i remove a key from the map what values should the event carry?&lt;/p&gt;

&lt;p&gt;If an entry is removed, I expect it to return:&lt;br/&gt;
assert( evt.newValue == null )&lt;/p&gt;</comment>
                            <comment id="14464725" author="aalmiray" created="Mon, 28 Apr 2008 18:45:54 +0000"  >&lt;p&gt;Alright, then I think the best course of action would be to subclass PCE to add a type &lt;span class=&quot;error&quot;&gt;&amp;#91;add|remove|change|clear&amp;#93;&lt;/span&gt; and continue using PropertyChangeListener. If a client would like to know more about the event then it can read the type field.&lt;/p&gt;</comment>
                            <comment id="14464744" author="aalmiray" created="Wed, 14 May 2008 13:24:44 +0000"  >&lt;p&gt;Added the following detail to fired events&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;ObservableMap.PropertyAddedEvent - a new property is added to the map&lt;/li&gt;
	&lt;li&gt;ObservableMap.PropertyRemovedEvent - a property is removed from the map&lt;/li&gt;
	&lt;li&gt;ObservableMap.PropertyUpdatedEvent - a property changes value (same as regular PropertyChangeEvent)&lt;/li&gt;
	&lt;li&gt;ObservableMap.PropertyClearedEvent - all properties have been removed from the map&lt;/li&gt;
	&lt;li&gt;ObservableMap.MultiPropertyAddedEvent - triggered by calling map.putAll(), contains Added|Updated events&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14464731" author="aalmiray" created="Wed, 14 May 2008 13:40:17 +0000"  >&lt;p&gt;Backported to 1.5.x&lt;/p&gt;</comment>
                            <comment id="14465055" author="mingfai" created="Sat, 5 Jul 2008 12:11:38 +0000"  >&lt;p&gt;I just tried 1.5.0-branch&lt;/p&gt;

&lt;p&gt;script&lt;br/&gt;
map.key = &apos;value&apos;  // prints key: null -&amp;gt; value&lt;br/&gt;
map.key = &apos;Groovy&apos; // prints key: value -&amp;gt; Groovy&lt;br/&gt;
map.remove(&apos;key&apos;)&lt;/p&gt;


&lt;p&gt;result:&lt;/p&gt;

&lt;p&gt;key: java.lang.Object@2565a3c2 -&amp;gt; value&lt;br/&gt;
key: value -&amp;gt; Groovy&lt;br/&gt;
key: Groovy -&amp;gt; java.lang.Object@2937d090&lt;/p&gt;</comment>
                            <comment id="14465028" author="mingfai" created="Sat, 5 Jul 2008 12:15:59 +0000"  >&lt;p&gt;for the 1.5.0-branch / 1.5.7, &lt;/p&gt;

&lt;p&gt;key: Groovy -&amp;gt; java.lang.Object@2937d090&lt;/p&gt;

&lt;p&gt;should be:&lt;br/&gt;
key: Groovy -&amp;gt; null&lt;/p&gt;

&lt;p&gt;null becomes an object that cannot be identified.&lt;/p&gt;</comment>
                            <comment id="14465077" author="mingfai" created="Sat, 5 Jul 2008 19:26:09 +0000"  >&lt;p&gt;tested the 1.6-beta-2-SNAPSHOT with the Observable Maps example in the documentation page as well. the result is the same. &lt;/p&gt;

&lt;p&gt;groovy&amp;gt; map.key = &apos;value&apos;  // prints key: null -&amp;gt; value&lt;/p&gt;

&lt;p&gt;key: java.lang.Object@4ecd200f -&amp;gt; value&lt;/p&gt;</comment>
                            <comment id="14465078" author="aalmiray" created="Mon, 7 Jul 2008 15:35:02 +0000"  >&lt;p&gt;Fixed oldValue when a property is added (should be null now)&lt;br/&gt;
Also backported to 1.5.x branch&lt;/p&gt;</comment>
                            <comment id="14465068" author="mingfai" created="Thu, 24 Jul 2008 05:41:09 +0000"  >&lt;p&gt;it works perfectly. thank you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cq5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>