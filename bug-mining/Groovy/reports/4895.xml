<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:25:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11524] Error with circular loading of installed providers when using transitive dependency groovy 4.0.23 in docker</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11524</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;We faced an error when migrating spring-boot-starter-thymeleaf with version 3.3.4, that did not occur in the previous 3.3.3 version. The difference in both versions is the groovy version that is provided as transitive dependency which was migrated from 4.0.22 to 4.0.23. When loading a template that uses the layout decorate functionality, a &lt;tt&gt;Circular loading of installed providers detected&lt;/tt&gt; occurs, when the application runs inside an our docker container.&lt;/p&gt;

&lt;p&gt;We already contacted the Spring Boot support. Due to the workaround (see below), they asked us to place the issue directly at groovy.&lt;/p&gt;

&lt;p&gt;We are using the following versions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Version of Thymeleaf&lt;/b&gt;: spring-boot-starter-thymeleaf:3.3.4 (embedded groovy version 4.0.23)&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Environment&lt;/b&gt;: Spring Boot 3.3.4&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Docker base image&lt;/b&gt;: public.ecr.aws/docker/library/amazoncorretto:21-alpine-jdk (we just copy the JAR into the docker container and set an entry point)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The stack trace looks like the following:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Stacktrace:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.Error: Circular loading of installed providers detected java.base/java.nio.file.spi.FileSystemProvider.installedProviders(FileSystemProvider.java: 198)
java.base/java.nio.file.FileSystems.newFileSystem(FileSystems.java: 336)
java.base/java.nio.file.FileSystems.newFileSystem(FileSystems.java: 288)
org.codehaus.groovy.vmplugin.v9.ClassFinder.maybeNewFileSystem(ClassFinder.java: 177)
org.codehaus.groovy.vmplugin.v9.ClassFinder.find(ClassFinder.java:122)
org.codehaus.groovy.vmplugin.v9.ClassFinder.find(ClassFinder.java: 109)
org.codehaus.groovy.vmplugin.v9.Java9.doFindClasses(Java9.java: 120)
org.codehaus.groovy.vmplugin.v9.Java9.getDefaultImportClasses(Java9.java: 107)
org.codehaus.groovy.control.ResolveVisitor.&amp;lt;clinit&amp;gt;(ResolveVisitor.java: 550)
org.codehaus.groovy.runtime.FormatHelper.&amp;lt;clinit&amp;gt;(FormatHelper.java: 71)
org.codehaus.groovy.runtime.InvokerHelper.matchRegex(InvokerHelper.java: 339)
org.codehaus.groovy.runtime.ScriptBytecodeAdapter.matchRegex(ScriptBytecodeAdapter.java: 895)
nz.net.ultraq.thymeleaf.expressionprocessor.ExpressionProcessor.parseFragmentExpression(ExpressionProcessor.groovy: 73)
org.codehaus.groovy.vmplugin.v8.IndyInterface.fromCache(IndyInterface.java: 321)
nz.net.ultraq.thymeleaf.layoutdialect.decorators.DecorateProcessor.doProcess(DecorateProcessor.groovy:115)
org.thymeleaf.processor.element.AbstractAttributeModelProcessor.doProcess(AbstractAttributeModelProcessor.java: 77)
org.thymeleaf.processor.element.AbstractElementModelProcessor.process(AbstractElementModelProcessor.java: 98)
org.thymeleaf.util.ProcessorConfigurationUtils$ElementModelProcessorWrapper.process(ProcessorConfigurationUtils.java: 649)
org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java: 1510)
org.thymeleaf.engine.OpenElementTag.beHandled(OpenElementTag.java: 205)
org.thymeleaf.engine.Model.process(Model.java: 282)
org.thymeleaf.engine.Model.process(Model.java: 290)
org.thymeleaf.engine.GatheringModelProcessable.process(GatheringModelProcessable.java: 78)
org.thymeleaf.engine.ProcessorTemplateHandler.handleCloseElement(ProcessorTemplateHandler.java: 1640)
org.thymeleaf.engine.CloseElementTag.beHandled(CloseElementTag.java:139)
org.thymeleaf.engine.TemplateModel.process(TemplateModel.java: 136)
org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java: 661)
org.thymeleaf.TemplateEngine.process(TemplateEngine.java: 1103)
org.thymeleaf.TemplateEngine.process(TemplateEngine.java: 1064)
org.thymeleaf.TemplateEngine.process(TemplateEngine.java: 1053)
de.otto.core.WarmupService.warmupDetailsTemplate(WarmupService.kt: 266)
de.otto.core.WarmupService.warmupTemplates(WarmupService.kt: 68)
de.otto.core.WarmupService.warmup(WarmupService.kt: 62)
de.otto.core.WarmupService.warmup$&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;(WarmupService.kt: 60)
de.otto.core.WarmupService.run(WarmupService.kt:360)
org.springframework.boot.SpringApplication.lambda$callRunner$4(SpringApplication.java: 786)
org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java: 83)
org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java: 60)
org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java: 88)
org.springframework.boot.SpringApplication.callRunner(SpringApplication.java: 798)
org.springframework.boot.SpringApplication.callRunner(SpringApplication.java: 786)
org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java: 774)
java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java: 184)
java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java: 357)
java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java: 499)
java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java: 151)
java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java: 174)
java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java: 234)
java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java: 596)
org.springframework.boot.SpringApplication.callRunners(SpringApplication.java: 774)
org.springframework.boot.SpringApplication.run(SpringApplication.java: 342)
org.springframework.boot.SpringApplication.run(SpringApplication.java: 1363)
org.springframework.boot.SpringApplication.run(SpringApplication.java: 1352)
de.otto.ApplicationKt.main(Application.kt:36){{}} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Workaround&lt;/b&gt;:&lt;br/&gt;
We have found that when we are pinning the groovy version that is delivered within the thymeleaf library to version 4.0.22 instead of using version 4.0.23 that was delivered with the new 3.3.4 version of thymeleaf spring boot starter, the error does not occur anymore. That works for the moment, of course for further releases this could raise other isssues.&lt;/p&gt;

&lt;p&gt;We would be very thankful, if you could help us to fix the issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13599887">GROOVY-11524</key>
            <summary>Error with circular loading of installed providers when using transitive dependency groovy 4.0.23 in docker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="l3nn4rd">Lennard Wolf</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Nov 2024 10:36:02 +0000</created>
                <updated>Mon, 27 Jan 2025 23:32:16 +0000</updated>
                            <resolved>Wed, 27 Nov 2024 16:38:16 +0000</resolved>
                                    <version>4.0.23</version>
                                    <fixVersion>5.0.0-alpha-12</fixVersion>
                    <fixVersion>4.0.25</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17901037" author="daniel_sun" created="Tue, 26 Nov 2024 00:11:35 +0000"  >&lt;p&gt;I am not sure if the issue is caused by the following commit:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/commit/02dfe8b78d0b205eaafaa477913743ffaacfbda8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/02dfe8b78d0b205eaafaa477913743ffaacfbda8&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But I could add a try-catch to workaround in the next release, it just impacts the performance of resolving types.&lt;/p&gt;</comment>
                            <comment id="17901038" author="daniel_sun" created="Tue, 26 Nov 2024 00:18:18 +0000"  >&lt;p&gt;ParallelCapable is enabled in 4.0.24, but the issue occurs in 4.0.23&lt;/p&gt;</comment>
                            <comment id="17901041" author="paulk" created="Tue, 26 Nov 2024 00:33:17 +0000"  >&lt;p&gt;It would be interesting to confirm that you see the same issue if you override the Groovy version to 4.0.24.&lt;/p&gt;

&lt;p&gt;Also, any advice on the simplest replicator we could try?&lt;/p&gt;</comment>
                            <comment id="17901230" author="daniel_sun" created="Tue, 26 Nov 2024 15:07:22 +0000"  >&lt;p&gt;As the variable &lt;tt&gt;ignore&lt;/tt&gt; means, the exception could be ignored, but we got a &lt;tt&gt;Error&lt;/tt&gt;, so I changed the type &lt;tt&gt;Exception&lt;/tt&gt; to &lt;tt&gt;Throwable&lt;/tt&gt; to improve the robustness of the code.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/blob/0b7445664bd9df285b178099345b1f5721a1da5b/src/main/java/org/codehaus/groovy/vmplugin/v9/Java9.java#L109&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/0b7445664bd9df285b178099345b1f5721a1da5b/src/main/java/org/codehaus/groovy/vmplugin/v9/Java9.java#L109&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17901233" author="daniel_sun" created="Tue, 26 Nov 2024 15:15:07 +0000"  >&lt;p&gt;Here is the snapshot of the fix ( &lt;a href=&quot;https://github.com/apache/groovy/actions/runs/12033258067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/actions/runs/12033258067&lt;/a&gt; ) :&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/actions/runs/12033258067/artifacts/2239449744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/actions/runs/12033258067/artifacts/2239449744&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please download it and have a try.&lt;/p&gt;</comment>
                            <comment id="17901234" author="JIRAUSER307858" created="Tue, 26 Nov 2024 15:16:12 +0000"  >&lt;p&gt;Thank you very much for the input. I have not tried the upgrade to 4.0.24 but I will check, how the application reacts, if I migrate it. When the error occurs again, I would provide a description how the issue can be replicated.&lt;/p&gt;</comment>
                            <comment id="17901249" author="JIRAUSER307858" created="Tue, 26 Nov 2024 16:08:05 +0000"  >&lt;p&gt;I have tried version 4.0.24 and the error seems to occur again. I will try your fix tomorrow &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daniel_sun&quot; class=&quot;user-hover&quot; rel=&quot;daniel_sun&quot;&gt;daniel_sun&lt;/a&gt;, thanks for the input. I will comment afterwards, if the fix worked.&#160;&lt;/p&gt;</comment>
                            <comment id="17901530" author="JIRAUSER307858" created="Wed, 27 Nov 2024 16:14:42 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daniel_sun&quot; class=&quot;user-hover&quot; rel=&quot;daniel_sun&quot;&gt;daniel_sun&lt;/a&gt; ,&lt;br/&gt;
Thank you for the provided snapshot. When I lookup the changes and compare them with our stacktrace, this could be a fix to our issue, at least the error handling seem to ignore errors thrown at the level at which the application currently crashes when using the affected versions.&lt;/p&gt;

&lt;p&gt;I invoked your snapshot in my local setup. Unfortunately, I was not able to reproduce the error in my local docker setup when using the affected versions. Only within our cloud environment the error seems to appear. Therefore, I could not determine whether the fix solves the issue when including your snapshot locally. May it be possible to invoke the fix within the upcoming groovy release, that I could test it within our cloud environment?&lt;/p&gt;</comment>
                            <comment id="17901532" author="daniel_sun" created="Wed, 27 Nov 2024 16:37:24 +0000"  >&lt;p&gt;Glad to know the fix works.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sqxs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>