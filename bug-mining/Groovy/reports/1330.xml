<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4330] Groovy 1.7.4 wont build from source</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4330</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have just downloaded the Groovy 1.7.4 source and tried to compile on Windows 7 with Sun/Oracle JDK 1.6.0_21.  The build failed while performing the -testAll phase:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running UberTestCaseBugs&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 400, Failures: 0, Errors: 0, Time elapsed: 4.977 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running UberTestCaseGroovySourceCodehausPackages&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 429, Failures: 0, Errors: 0, Time elapsed: 54.605 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running UberTestCaseGroovySourceCodehausPackages_VM6&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.074 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running UberTestCaseGroovySourceRootPackage&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1000, Failures: 0, Errors: 0, Time elapsed: 27.002 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Running UberTestCaseGroovySourceSubPackages&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 1187, Failures: 0, Errors: 1, Time elapsed: 66.116 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test UberTestCaseGroovySourceSubPackages FAILED&lt;/p&gt;

&lt;p&gt;From groovy-1.7.4/target/reports/junit/all-tests.html&lt;/p&gt;

&lt;p&gt;Class: UberTestCaseGroovySourceSubPackages&lt;br/&gt;
Name: testReloadingInterval&lt;br/&gt;
Status: Error&lt;br/&gt;
Type:&lt;/p&gt;

&lt;p&gt;assert gse.run(scriptName, binding) == 3 | | | | | | 23 | | false | | groovy.lang.Binding@1769afe | gse6921152879800224663.groovy groovy.util.GroovyScriptEngine@1b9caa8&lt;/p&gt;

&lt;p&gt;Assertion failed:&lt;/p&gt;

&lt;p&gt;assert gse.run(scriptName, binding) == 3&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 23 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; groovy.lang.Binding@1769afe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; gse6921152879800224663.groovy&lt;br/&gt;
groovy.util.GroovyScriptEngine@1b9caa8&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;at org.codehaus.groovy.runtime.InvokerHelper.assertFailed(InvokerHelper.java:378)&lt;br/&gt;
at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.assertFailed(ScriptBytecodeAdapter.java:662)&lt;br/&gt;
at groovy.util.GroovyScriptEngineTest.testReloadingInterval(GroovyScriptEngineTest.groovy:246)&lt;/p&gt;


&lt;p&gt;I had a quick look at groovy.util.GroovyScriptEngineTest.testReloadingInterval(GroovyScriptEngineTest.groovy:246).  Looks as if the test that is failing was introduced to test previous issues (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2811&quot; title=&quot;GroovyClassLoader.isSourceNewer() fails when url has spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2811&quot;&gt;&lt;del&gt;GROOVY-2811&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4286&quot; title=&quot;GroovyScriptEngine doesn&amp;#39;t recompile updateted script&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4286&quot;&gt;&lt;del&gt;GROOVY-4286&lt;/del&gt;&lt;/a&gt;) - maybe still an issue?&lt;/p&gt;

&lt;p&gt;Kind regards,&lt;br/&gt;
Mike&lt;/p&gt;
</description>
                <environment>Windows 7, Sun/Oracle JDK 1.6.0_21</environment>
        <key id="12818056">GROOVY-4330</key>
            <summary>Groovy 1.7.4 wont build from source</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="guillaume">Guillaume Sauthier</assignee>
                                    <reporter username="mikevines">Mike Vines</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Jul 2010 11:27:15 +0000</created>
                <updated>Wed, 15 Dec 2010 22:19:40 +0000</updated>
                            <resolved>Tue, 27 Jul 2010 05:55:39 +0000</resolved>
                                    <version>1.7.4</version>
                                    <fixVersion>1.7.5</fixVersion>
                    <fixVersion>1.8-beta-2</fixVersion>
                                    <component>GroovyScriptEngine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14469932" author="guillaume" created="Mon, 26 Jul 2010 13:13:06 +0000"  >&lt;p&gt;Is it failing consistently for you?&lt;br/&gt;
The build runs fine for everybody, including our continuous integration servers.&lt;/p&gt;</comment>
                            <comment id="14469849" author="mikevines" created="Mon, 26 Jul 2010 14:22:27 +0000"  >&lt;p&gt;I have run the build twice, and it failed both times. Ican try a few more times in the morning if you wish.&lt;/p&gt;

&lt;p&gt;Mike&lt;/p&gt;</comment>
                            <comment id="14469823" author="guillaume" created="Mon, 26 Jul 2010 14:24:11 +0000"  >&lt;p&gt;also please look at the test reports to see if there&apos;s a bit more information&lt;/p&gt;</comment>
                            <comment id="14469886" author="mikevines" created="Tue, 27 Jul 2010 03:13:27 +0000"  >&lt;p&gt;Full target/reports and target/test-reports directories&lt;/p&gt;</comment>
                            <comment id="14469922" author="mikevines" created="Tue, 27 Jul 2010 03:23:07 +0000"  >&lt;p&gt;Guillaume,&lt;/p&gt;

&lt;p&gt;I have run the build again a few times this morning, and it fails consistently.  I tried a previous Java version (1.6.0_16), but that made no difference.  (Although not really expecting it to make a difference, I also updated to the latest version of ant - still failed).&lt;/p&gt;

&lt;p&gt;As per previous comment, I have attached the full contents of the target/reports and target/test-reports directory.  I was not exactly sure what you wanted to see, so I attachched the lot.  Hopefully I have provided you with everything you need - let me know if there is anything else I should have attached.&lt;/p&gt;

&lt;p&gt;Thanks for your attention,&lt;br/&gt;
Mike&lt;/p&gt;</comment>
                            <comment id="14469901" author="mikevines" created="Tue, 27 Jul 2010 03:31:13 +0000"  >&lt;p&gt;A little further info . . .&lt;/p&gt;

&lt;p&gt;In the method testReloadingInterval(), is the code:&lt;/p&gt;

&lt;p&gt;            f.delete()&lt;br/&gt;
            f &amp;lt;&amp;lt; &quot;2&quot;&lt;br/&gt;
            sleep 1000&lt;br/&gt;
            // the file was updated, and we waited for more than the minRecompilationInterval&lt;br/&gt;
            assert gse.run(scriptName, binding) == 2&lt;/p&gt;

&lt;p&gt;            f.delete()&lt;br/&gt;
            f &amp;lt;&amp;lt; &quot;3&quot;&lt;br/&gt;
            sleep 100&lt;br/&gt;
            // still the old result, as we didn&apos;t wait more than the minRecompilationInterval&lt;br/&gt;
            assert gse.run(scriptName, binding) == 2&lt;/p&gt;

&lt;p&gt;I have now seen that the file mentioned in the error report (gse5373281359525925393.groovy) is present in the target directory.  My expection was that it would contain:&lt;/p&gt;

&lt;p&gt;        3&lt;/p&gt;

&lt;p&gt;But instead it contains&lt;/p&gt;

&lt;p&gt;        23&lt;/p&gt;

&lt;p&gt;So the issue may not be that that the gse has not detected the change, but that the file did not get deleted before &quot;3&quot; was written to the file.&lt;/p&gt;

&lt;p&gt;Mike&lt;/p&gt;</comment>
                            <comment id="14469810" author="guillaume" created="Tue, 27 Jul 2010 04:59:29 +0000"  >&lt;p&gt;I downloaded the sources deliverable, and ran the full clean build again just fine.&lt;br/&gt;
But your analysis is very interesting.&lt;br/&gt;
I&apos;ve read in a few places that File#delete() doesn&apos;t always work reliably across systems.&lt;br/&gt;
And you may be on such a system!&lt;br/&gt;
I&apos;ve seen implementations of custom delete() methods doing some retries till a delete really works.&lt;br/&gt;
So, what you see is probably the exhibit of such behaviour.&lt;br/&gt;
What system are you running?&lt;/p&gt;</comment>
                            <comment id="14469933" author="mikevines" created="Tue, 27 Jul 2010 05:11:14 +0000"  >&lt;p&gt;I&apos;m running Windows 7.  I think that in Unix OS&apos;s you can delete a file that is open (the file just gets removed from the directory structure), and then it is feasible to create a new version of the file.  The process/thread that still has the open file handle can continue happily unaffected.  However in Windows, the delete will not succeed - you cant delete an open file.&lt;/p&gt;

&lt;p&gt;Mike&lt;/p&gt;</comment>
                            <comment id="14469851" author="guillaume" created="Tue, 27 Jul 2010 05:16:32 +0000"  >&lt;p&gt;Windows 7, interesting.&lt;br/&gt;
But the files are closed when doing &amp;lt;&amp;lt;.&lt;br/&gt;
But perhaps it&apos;s kept open a bit longer by the OS.&lt;br/&gt;
Could you please try to introduce some delay here or there, to make the test pass for you?&lt;br/&gt;
You could also look into printing the result of the file deletion (since that returns a boolean), to check that&apos;s what we&apos;re seeing here.&lt;/p&gt;</comment>
                            <comment id="14469824" author="guillaume" created="Tue, 27 Jul 2010 05:22:27 +0000"  >&lt;p&gt;For instance, add a 100ms delay between a delete() and a write &amp;lt;&amp;lt;.&lt;/p&gt;</comment>
                            <comment id="14469915" author="guillaume" created="Tue, 27 Jul 2010 05:33:00 +0000"  >&lt;p&gt;Actually, a better idea would even be to not rely on delete() at all.&lt;br/&gt;
And do the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;f &amp;lt;&amp;lt; &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;
sleep 200
&lt;span class=&quot;code-comment&quot;&gt;// first time, the script is compiled and cached
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; gse.run(scriptName, binding) == 1

f &amp;lt;&amp;lt; &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;
sleep 1000
&lt;span class=&quot;code-comment&quot;&gt;// the file was updated, and we waited &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more than the minRecompilationInterval
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; gse.run(scriptName, binding) == 12

f &amp;lt;&amp;lt; &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;
sleep 100
&lt;span class=&quot;code-comment&quot;&gt;// still the old result, as we didn&apos;t wait more than the minRecompilationInterval
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; gse.run(scriptName, binding) == 12

sleep 1000
&lt;span class=&quot;code-comment&quot;&gt;// we&apos;ve waited enough, so we get the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; output
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; gse.run(scriptName, binding) == 123
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We just keeping on appending to the file.&lt;br/&gt;
So there&apos;s no need for relying on delete() to work consistently on all systems.&lt;/p&gt;</comment>
                            <comment id="14469871" author="guillaume" created="Tue, 27 Jul 2010 05:37:06 +0000"  >&lt;p&gt;And to avoid running the full build each time for each change, you can do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ant -DtestCase=groovy.util.GroovyScriptEngineTest test
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469862" author="guillaume" created="Tue, 27 Jul 2010 05:49:38 +0000"  >&lt;p&gt;I&apos;ve committed my suggested fix, and Paul will also try that test on his Windows 7 box.&lt;/p&gt;</comment>
                            <comment id="14469902" author="guillaume" created="Tue, 27 Jul 2010 05:55:22 +0000"  >&lt;p&gt;Seems to be working on Windows 7 now &amp;#8211; thanks Paul for checking this for me.&lt;br/&gt;
I&apos;ll close the issue for now, Mike. Please re-open it in case it still doesn&apos;t work for you.&lt;/p&gt;</comment>
                            <comment id="14469923" author="mikevines" created="Tue, 27 Jul 2010 06:17:10 +0000"  >&lt;p&gt;Thanks - that has sorted it for me.  Builds OK now.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Mike&lt;/p&gt;</comment>
                            <comment id="14469811" author="guillaume" created="Tue, 27 Jul 2010 06:27:17 +0000"  >&lt;p&gt;Now that you&apos;re fully setup to work on the Groovy code base, I&apos;ll warmly welcome your code contributions &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722686" name="reports.zip" size="627920" author="mikevines" created="Tue, 27 Jul 2010 03:13:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cgyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>