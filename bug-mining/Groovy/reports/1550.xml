<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:22:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4711] Standalone stub generation task fails resolving classes</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4711</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;If you create a Java class (Foo) and a Groovy class (Bar extends Foo), and then run the stub generation Ant task (GenerateStubsTask), it&apos;ll fail because it now does all the phases up to semantic analysis which attempts to resolve all class references. AFAIU the stub generation is supposed to be run before Javac. So it should be prepared that some Java classes the Groovy code depends on aren&apos;t compiled yet.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815531">GROOVY-4711</key>
            <summary>Standalone stub generation task fails resolving classes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="gromopetr">Peter Gromov</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Mar 2011 04:55:23 +0000</created>
                <updated>Sun, 5 Apr 2015 14:44:09 +0000</updated>
                            <resolved>Tue, 26 Jul 2011 09:08:44 +0000</resolved>
                                    <version>1.7.8</version>
                                    <fixVersion>1.8.2</fixVersion>
                    <fixVersion>1.9-beta-3</fixVersion>
                    <fixVersion>1.7.11</fixVersion>
                                    <component>Stub generator / Joint compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14470920" author="blackdrag" created="Sun, 6 Mar 2011 07:57:22 +0000"  >&lt;p&gt;but joint compilation using groovyc works, or not?&lt;/p&gt;</comment>
                            <comment id="14470952" author="roshandawrani" created="Sun, 6 Mar 2011 08:53:25 +0000"  >&lt;p&gt;Since no other information is provided, if I just try:&lt;/p&gt;

&lt;p&gt;Foo.java&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and Bar.groovy:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Bar &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Foo {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and compile as&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;groovyc *
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;then the joint compilation goes through just fine (using groovy 1.7.5).&lt;/p&gt;</comment>
                            <comment id="14470797" author="roshandawrani" created="Sun, 6 Mar 2011 09:01:56 +0000"  >&lt;p&gt;With groovyc 1.7.8, it works too.&lt;/p&gt;</comment>
                            <comment id="14471005" author="gromopetr" created="Sun, 6 Mar 2011 11:56:51 +0000"  >&lt;p&gt;The problem is that we need stub generation as a separate step, our (IntelliJ IDEA) build is a quite complex process, it consists of many stages and stub generation and javac/groovyc happen to be on different stages.&lt;/p&gt;

&lt;p&gt;The joint compilation works indeed, because the stub generation there happens twice: once during conversion and the other time during semantic analysis. The stub generated in conversion gets immediately compiled by Javac (see JavaAwareCompilationUnit), and so it is available for resolve during the semantic analysis. In a separate standalone stub generator (GenerateStubsTask, JavaStubCompilationUnit) semantic analysis also happens, but nobody has generated and compiled the stubs together with the Java sources before that, so the resolve fails.&lt;/p&gt;
</comment>
                            <comment id="14470935" author="guillaume" created="Mon, 7 Mar 2011 05:44:51 +0000"  >&lt;p&gt;Peter, perhaps you could explain a bit more concretely what you would like to see? What would help IntelliJ IDEA? That everything runs in CONVERSION phase, or something like that?&lt;/p&gt;</comment>
                            <comment id="14471016" author="gromopetr" created="Mon, 7 Mar 2011 06:33:08 +0000"  >&lt;p&gt;It would help if the resolve process didn&apos;t fail the compilation. This can be achieved by making the standalone stub generation not run it (i.e. to work only up to the conversion phase) or just ignore the unresolved references during the semantic analysis. The first alternative means even wider gap between joint compilation and just stub generation, the second one looks a bit like a hack. But both would work for us.&lt;/p&gt;</comment>
                            <comment id="14471002" author="blackdrag" created="Mon, 7 Mar 2011 07:33:37 +0000"  >&lt;p&gt;I attached a patch. It aligns the stub task with our joint compilation more in such that it moves the stub generation to the conversion phase and also does the VariableScopeVisitor and JavaAwareResolveVisitor runs before. Since this is a bigger change to the stub generator task we will include that only after 1.8.0&lt;/p&gt;

&lt;p&gt;But before this can be really included we absolutely need some tests I think&lt;/p&gt;</comment>
                            <comment id="14470981" author="blackdrag" created="Mon, 7 Mar 2011 07:36:47 +0000"  >&lt;p&gt;Peter if you would test that patch it would surely help us&lt;/p&gt;</comment>
                            <comment id="14471032" author="gromopetr" created="Wed, 9 Mar 2011 15:05:04 +0000"  >&lt;p&gt;Jochen,&lt;/p&gt;

&lt;p&gt;Unfortunately I don&apos;t have much time now to build Groovy and try it, but from the first shallow glance the patch looks good. And I&apos;d include this into 1.7.x for the following reason: JavaStubCompilationUnit is used only from the commented out generatestubs task, and currently this will definitely fail (when doing clean build) when there&apos;s at least one Groovy file referencing at least one Java class. As no one but me came with this problem, I assume we&apos;re the only clients of this task. So nothing should break except possibly for us, which in turn shouldn&apos;t happen. And I agree that having a test would be great.&lt;/p&gt;</comment>
                            <comment id="14471550" author="gromopetr" created="Tue, 26 Jul 2011 05:36:47 +0000"  >&lt;p&gt;Jochen, I&apos;ve built Groovy with this patch and it works. You&apos;ve promised me you&apos;ll apply it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14471604" author="blackdrag" created="Tue, 26 Jul 2011 09:08:44 +0000"  >&lt;p&gt;Peter, sorry for not appllying the patch earlier, now it is done.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722830" name="generateStubs.patch" size="2229" author="blackdrag" created="Mon, 7 Mar 2011 07:34:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cotr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>