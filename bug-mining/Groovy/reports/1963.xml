<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:29:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5729] Delegation to an  interface with deprecated methods shows a compile error</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5729</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Given an interface:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; DeprecatedMethods {

    @Deprecated
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setHeight(&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; height);

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and a delegating class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DelegateDeprecated {
	
    @Delegate	
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DeprecatedMethods delegate
	
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then the compiler shows a compilation error:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;$ groovyc DelegateDeprecated.groovy &lt;br/&gt;
org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:&lt;br/&gt;
DelegateDeprecated.groovy: 15: Can&apos;t have an abstract method in a non-abstract class. The class &apos;DelegateDeprecated&apos; must be declared abstract or the method &apos;void setHeight(float)&apos; must be implemented.&lt;br/&gt;
 @ line 15, column 1.&lt;br/&gt;
   class DelegateDeprecated {&lt;br/&gt;
   ^&lt;/p&gt;

&lt;p&gt;1 error&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This happens from the command line and Eclipse, and can be made to go away by removing the @Deprecated annotation.&lt;/p&gt;
</description>
                <environment>Max OS X 10.6.8, Mac Java, Eclipse 3.7</environment>
        <key id="12811960">GROOVY-5729</key>
            <summary>Delegation to an  interface with deprecated methods shows a compile error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="prajnainc">Paul Bennett</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Sep 2012 07:36:50 +0000</created>
                <updated>Thu, 4 Oct 2012 17:02:56 +0000</updated>
                            <resolved>Sun, 30 Sep 2012 02:15:07 +0000</resolved>
                                    <version>1.8.6</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>2.1.0-beta-1</fixVersion>
                    <fixVersion>1.8.9</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14480009" author="paulk" created="Sat, 29 Sep 2012 02:26:51 +0000"  >&lt;p&gt;So unless I hear otherwise, I will change the implementation and doco to indicate that the &quot;deprecated&quot; annotation member will be ignored if the delegation type is an interface and the &quot;interfaces&quot; member is not false.&lt;/p&gt;

&lt;p&gt;As an aside (for a different issue/discussion) I wonder whether the &quot;types&quot; and &quot;excludes&quot; options provided by project Lombok&apos;s @Delegate would give additional finer grained control of delegated methods.&lt;/p&gt;</comment>
                            <comment id="14473329" author="blackdrag" created="Sat, 29 Sep 2012 03:28:45 +0000"  >&lt;p&gt;Paul, does that mean you want the example above to pass compilation or not?&lt;/p&gt;</comment>
                            <comment id="14480020" author="paulk" created="Sat, 29 Sep 2012 04:50:02 +0000"  >&lt;p&gt;There are four obvious solutions that I can see:&lt;br/&gt;
(1) leave implementation as is and improve the doco so such errors are perhaps less confusing&lt;br/&gt;
(2) make above case fail but with an improved error message; though we currently don&apos;t verify until a later stage so this could be tricky and/or involve duplicating checks&lt;br/&gt;
(3) make the above case pass by always ignoring the &quot;deprecated&quot; setting for interfaces (but perhaps we would need another flag to really turn it off when not required, i.e. when not implementing the interfaces)&lt;br/&gt;
(4) make the above case pass by ignoring the &quot;deprecated&quot; setting for interfaces but only when implementing the interface, i.e. don&apos;t ignore if interfaces=false has been set.&lt;/p&gt;

&lt;p&gt;I am proposing (4) which would make the above pass and have the deprecated method (as well as implementing the interface). If you set interfaces=false it would also pass and not have the deprecated method. If you set interfaces=false and deprecated=true it would also pass, not implement the interface but would have the method. You would still get the existing error message if you set interfaces=false, didn&apos;t set deprecated=true and manually implemented the interface - but that seems to me to be less unexpected in that case because hopefully someone using those options would be very familiar with the various options and how they interact.&lt;/p&gt;</comment>
                            <comment id="14480027" author="paulk" created="Sat, 29 Sep 2012 07:27:56 +0000"  >&lt;p&gt;Proposed patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;--- src/main/org/codehaus/groovy/transform/DelegateASTTransformation.java	(revision 489913f60f5e9b1504aed1898e9b9ead84f62489)
+++ src/main/org/codehaus/groovy/transform/DelegateASTTransformation.java	(revision )
@@ -77,7 +77,9 @@
                 fieldMethods.addAll(getAllMethods(next));
             }
             &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression deprecatedElement = node.getMember(&lt;span class=&quot;code-quote&quot;&gt;&quot;deprecated&quot;&lt;/span&gt;);
-            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; deprecated = hasBooleanValue(deprecatedElement, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
+            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression interfacesElement = node.getMember(&lt;span class=&quot;code-quote&quot;&gt;&quot;interfaces&quot;&lt;/span&gt;);
+            &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; skipInterfaces = hasBooleanValue(interfacesElement, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
+            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; deprecated = hasBooleanValue(deprecatedElement, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) || (type.isInterface() &amp;amp;&amp;amp; !skipInterfaces);
 
             &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;MethodNode&amp;gt; ownerMethods = getAllMethods(owner);
             &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (MethodNode mn : fieldMethods) {
@@ -92,8 +94,7 @@
                 addSetterIfNeeded(fieldNode, owner, prop, name);
             }
 
-            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Expression interfacesElement = node.getMember(&lt;span class=&quot;code-quote&quot;&gt;&quot;interfaces&quot;&lt;/span&gt;);
-            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hasBooleanValue(interfacesElement, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (skipInterfaces) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
 
             &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;ClassNode&amp;gt; allInterfaces = getInterfacesAndSuperInterfaces(type);
             &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;ClassNode&amp;gt; ownerIfaces = owner.getAllInterfaces();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;plus doco/tests&lt;/p&gt;</comment>
                            <comment id="14473285" author="prajnainc" created="Sat, 29 Sep 2012 17:53:49 +0000"  >&lt;p&gt;Paul, to confirm, (4) is exactly the behavior I would expect. Thanks for the swift response&lt;/p&gt;</comment>
                            <comment id="14473369" author="paulk" created="Sun, 30 Sep 2012 02:15:07 +0000"  >&lt;p&gt;Option (4) applied. Thanks for raising the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cu7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>