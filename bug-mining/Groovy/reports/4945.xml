<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:26:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4721] variable declared in try block is in scope in finally block</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4721</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This code should fail because &apos;x&apos; is out of scope in the finally block. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyClass {
    def myMethod() {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            def x = &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;
            println x
        }
        &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
            println x
        }
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyClass().myMethod()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Instead it prints &apos;foo&apos; twice. &lt;/p&gt;

&lt;p&gt;if myMethod is static then it shows the behavior I expect. &lt;/p&gt;

&lt;p&gt;Could be something wrong with VariableScope somewhere? &lt;/p&gt;

&lt;p&gt;This example is from the Groovy codebase. We have code that relies on this behavior (although it is easy to find and fix, just run the UnusedVariable codenarc inspection, which is how I found it)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815547">GROOVY-4721</key>
            <summary>variable declared in try block is in scope in finally block</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daniel_sun">Daniel Sun</assignee>
                                    <reporter username="hamletdrc">Hamlet D&apos;Arcy</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Mar 2011 03:10:12 +0000</created>
                <updated>Wed, 4 Jun 2025 14:45:18 +0000</updated>
                            <resolved>Thu, 10 Apr 2025 14:25:13 +0000</resolved>
                                    <version>2.4.0-rc-1</version>
                                    <fixVersion>5.0.0-beta-1</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14470968" author="melix" created="Tue, 15 Mar 2011 16:13:38 +0000"  >&lt;p&gt;Surprisingly, throwing an exception resolves the scoping problem :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyClass {
    def myMethod() {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            def x = &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;
            println x
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException()
        }
        &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
            println x
        }
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyClass().myMethod()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;results in &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;groovy.lang.MissingPropertyException: No such property: x &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; class: MyClass
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:50)
	at org.codehaus.groovy.runtime.callsite.GetEffectivePogoPropertySite.getProperty(GetEffectivePogoPropertySite.java:86)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGroovyObjectGetProperty(AbstractCallSite.java:231)
	at MyClass.myMethod(ConsoleScript15:9)
	at MyClass$myMethod.call(Unknown Source)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
	at ConsoleScript15.run(ConsoleScript15:13)
	at groovy.lang.GroovyShell.runScriptOrMainOrTestOrRunnable(GroovyShell.java:255)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15885321" author="daniel_sun" created="Mon, 27 Feb 2017 08:08:29 +0000"  >&lt;p&gt;We can investigate the range(start, end) in the the following code and try to fix it:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/org/codehaus/groovy/classgen/asm/CompileStack.java#L370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/master/src/main/org/codehaus/groovy/classgen/asm/CompileStack.java#L370&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Iterator iterator = usedVariables.iterator(); iterator.hasNext();) {
                BytecodeVariable v = (BytecodeVariable) iterator.next();
                ClassNode t = v.getType();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (v.isHolder()) t = ClassHelper.REFERENCE_TYPE;
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; type = BytecodeHelper.getTypeDescription(t);
                Label start = v.getStartLabel();
                Label end = v.getEndLabel();
                mv.visitLocalVariable(v.getName(), type, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, start, end, v.getIndex());
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15886030" author="daniel_sun" created="Mon, 27 Feb 2017 16:09:54 +0000"  >&lt;p&gt;Here is my test code, which I expect to fail:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;groovy source code:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m() {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; str = &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; str;
    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(str);
    }
}

m()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;bytecode:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-comment&quot;&gt;// access flags 0x1
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; m()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;
    TRYCATCHBLOCK L0 L1 L2 &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
    TRYCATCHBLOCK L3 L4 L2 &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
   L5
    INVOKESTATIC script1488211656663.$getCallSiteArray ()[Lorg/codehaus/groovy/runtime/callsite/CallSite;
    ASTORE 1
   L0
    LINENUMBER 3 L0
    LDC &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;
    ASTORE 2
   L6
    ALOAD 2
    POP
   L7
    LINENUMBER 4 L7
    ALOAD 2
    ASTORE 3
    NOP
   L1
    LINENUMBER 6 L1
    ALOAD 1
    LDC 2
    AALOAD
    ALOAD 1
    LDC 3
    AALOAD
    LDC Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;;.class
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.callGetProperty (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    ALOAD 2
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.call (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    POP
    NOP
   L3
    ALOAD 3
    ARETURN
   L8
    GOTO L4
   L4
    ALOAD 1
    LDC 4
    AALOAD
    ALOAD 1
    LDC 5
    AALOAD
    LDC Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;;.class
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.callGetProperty (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    ALOAD 1
    LDC 6
    AALOAD
    ALOAD 0
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.callGroovyObjectGetProperty (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.call (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    POP
    NOP
    GOTO L9
   L2
    ASTORE 4
    ALOAD 1
    LDC 7
    AALOAD
    ALOAD 1
    LDC 8
    AALOAD
    LDC Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;;.class
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.callGetProperty (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    ALOAD 1
    LDC 9
    AALOAD
    ALOAD 0
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.callGroovyObjectGetProperty (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    INVOKEINTERFACE org/codehaus/groovy/runtime/callsite/CallSite.call (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    POP
    ALOAD 4
    ATHROW
   L9
    ACONST_NULL
    ARETURN
    LOCALVARIABLE &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; Lscript1488211656663; L5 L9 0
    LOCALVARIABLE str Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;; L6 L8 2
    MAXSTACK = 4
    MAXLOCALS = 5
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15886057" author="daniel_sun" created="Mon, 27 Feb 2017 16:20:41 +0000"  >&lt;p&gt;The issue is similiar to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8085&quot; title=&quot;Exception in &amp;quot;finally&amp;quot; not caught by outer &amp;quot;try&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8085&quot;&gt;&lt;del&gt;GROOVY-8085&lt;/del&gt;&lt;/a&gt;, the two issues are both related to return statement and finally block.&lt;/p&gt;

&lt;p&gt;The following code will fail because &lt;tt&gt;System.out.println(str);&lt;/tt&gt; accesses variable &lt;tt&gt;str&lt;/tt&gt; which is out of its scope. &lt;b&gt;Notice:&lt;/b&gt; no explicit/implicit return statement in the try block.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m() {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; str = &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;;
    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(str);
    }
    
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;123&apos;&lt;/span&gt;
}

m()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15889394" author="daniel_sun" created="Wed, 1 Mar 2017 02:45:51 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m() {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; str = &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;;
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; str;
        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt;);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Java will compile the above method into the following bytecode. As we can see, local variable &lt;tt&gt;str&lt;/tt&gt;&apos;s range &lt;tt&gt;[L3, L2)&lt;/tt&gt; covers &lt;tt&gt;L1&lt;/tt&gt;, so the finally block of nomal execution flow can access &lt;tt&gt;str&lt;/tt&gt; on the bytecode level. I guess Java control the access before generating bytecodes.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-comment&quot;&gt;// access flags 0x0
&lt;/span&gt;  m()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;
    TRYCATCHBLOCK L0 L1 L2 &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
   L0
    LINENUMBER 13 L0
    LDC &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;
    ASTORE 1
   L3
    LINENUMBER 14 L3
    ALOAD 1
    ASTORE 2
   L1
    LINENUMBER 16 L1
    GETSTATIC java/lang/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out : Ljava/io/PrintStream;
    LDC &lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt;
    INVOKEVIRTUAL java/io/PrintStream.println (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)V
   L4
    LINENUMBER 14 L4
    ALOAD 2
    ARETURN
   L2
    LINENUMBER 16 L2
   FRAME SAME1 java/lang/Throwable
    ASTORE 3
    GETSTATIC java/lang/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out : Ljava/io/PrintStream;
    LDC &lt;span class=&quot;code-quote&quot;&gt;&quot;world&quot;&lt;/span&gt;
    INVOKEVIRTUAL java/io/PrintStream.println (Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)V
    ALOAD 3
    ATHROW
   L5
    LOCALVARIABLE str Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;; L3 L2 1
    LOCALVARIABLE &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; Lcom/groovyhelp/bytecodelab/TryCatchFinally; L0 L5 0
    MAXSTACK = 2
    MAXLOCALS = 4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15889661" author="daniel_sun" created="Wed, 1 Mar 2017 07:11:21 +0000"  >&lt;p&gt;We can try to analyze variable scopes and add some check(e.g. the variable &lt;tt&gt;str&lt;/tt&gt; in the finally block has not been declared) in the VariableScopeVisitor.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/groovy/blob/master/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/master/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17940410" author="githubbot" created="Wed, 2 Apr 2025 16:57:41 +0000"  >&lt;p&gt;daniellansun opened a new pull request, #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/GROOVY-4721&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17940411" author="githubbot" created="Wed, 2 Apr 2025 17:02:20 +0000"  >&lt;p&gt;codecov-commenter commented on PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#issuecomment-2773198131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#issuecomment-2773198131&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Codecov&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=h1&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=h1&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) Report&lt;br/&gt;
   Attention: Patch coverage is `87.50000%` with `1 line` in your changes missing coverage. Please review.&lt;br/&gt;
   &amp;gt; Project coverage is 68.8448%. Comparing base &lt;span class=&quot;error&quot;&gt;&amp;#91;(`6ce967f`)&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/commit/6ce967f8019f175e589e71873f025b0a16bb0a13?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/commit/6ce967f8019f175e589e71873f025b0a16bb0a13?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) to head &lt;span class=&quot;error&quot;&gt;&amp;#91;(`9413b2d`)&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/commit/9413b2dd224b1928270e69e6b5e6f57d42230b67?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/commit/9413b2dd224b1928270e69e6b5e6f57d42230b67?dropdown=coverage&amp;amp;el=desc&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;).&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Files with missing lines&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Patch % &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Lines &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;.../codehaus/groovy/classgen/asm/StatementWriter.java&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fclassgen%2Fasm%2FStatementWriter.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NsYXNzZ2VuL2FzbS9TdGF0ZW1lbnRXcml0ZXIuamF2YQ==&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fclassgen%2Fasm%2FStatementWriter.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NsYXNzZ2VuL2FzbS9TdGF0ZW1lbnRXcml0ZXIuamF2YQ==&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 87.5000% &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0 Missing and 1 partial :warning: &amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;   &amp;lt;details&amp;gt;&amp;lt;summary&amp;gt;Additional details and impacted files&amp;lt;/summary&amp;gt;&lt;/p&gt;


&lt;p&gt;   [!&lt;span class=&quot;error&quot;&gt;&amp;#91;Impacted file tree graph&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172/graphs/tree.svg?width=650&amp;amp;height=150&amp;amp;src=pr&amp;amp;token=1r45138NfQ&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache)](https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172/graphs/tree.svg?width=650&amp;amp;height=150&amp;amp;src=pr&amp;amp;token=1r45138NfQ&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache)](https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   ```diff&lt;br/&gt;
   @@                Coverage Diff                 @@&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;master      #2172        +/-   ##&lt;br/&gt;
   ==================================================&lt;br/&gt;
   + Coverage     68.8443%   68.8448%   +0.0005%     &lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Complexity      29533      29535         +2&lt;br/&gt;
   ==================================================&lt;br/&gt;
     Files            1421       1421                &lt;br/&gt;
     Lines          113424     113429         +5     &lt;br/&gt;
     Branches        19644      19644                &lt;br/&gt;
   ==================================================&lt;br/&gt;
   + Hits            78086      78090         +4     &lt;/li&gt;
	&lt;li&gt;Misses          28754      28755         +1&lt;br/&gt;
     Partials         6584       6584                &lt;br/&gt;
   ```&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Files with missing lines&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?dropdown=coverage&amp;amp;src=pr&amp;amp;el=tree&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Coverage &#916; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8212;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;.../codehaus/groovy/classgen/asm/StatementWriter.java&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fclassgen%2Fasm%2FStatementWriter.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NsYXNzZ2VuL2FzbS9TdGF0ZW1lbnRXcml0ZXIuamF2YQ==&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172?src=pr&amp;amp;el=tree&amp;amp;filepath=src%2Fmain%2Fjava%2Forg%2Fcodehaus%2Fgroovy%2Fclassgen%2Fasm%2FStatementWriter.java&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache#diff-c3JjL21haW4vamF2YS9vcmcvY29kZWhhdXMvZ3Jvb3Z5L2NsYXNzZ2VuL2FzbS9TdGF0ZW1lbnRXcml0ZXIuamF2YQ==&lt;/a&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; `96.8927% &amp;lt;87.5000%&amp;gt; (-0.2420%)` &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; :arrow_down: &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;   ... and &lt;span class=&quot;error&quot;&gt;&amp;#91;5 files with indirect coverage changes&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://app.codecov.io/gh/apache/groovy/pull/2172/indirect-changes?src=pr&amp;amp;el=tree-more&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.codecov.io/gh/apache/groovy/pull/2172/indirect-changes?src=pr&amp;amp;el=tree-more&amp;amp;utm_medium=referral&amp;amp;utm_source=github&amp;amp;utm_content=comment&amp;amp;utm_campaign=pr+comments&amp;amp;utm_term=apache&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;   &amp;lt;/details&amp;gt;&lt;br/&gt;
   &amp;lt;details&amp;gt;&amp;lt;summary&amp;gt; :rocket: New features to boost your workflow: &amp;lt;/summary&amp;gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;:snowflake: &lt;span class=&quot;error&quot;&gt;&amp;#91;Test Analytics&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.codecov.com/docs/test-analytics):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.codecov.com/docs/test-analytics):&lt;/a&gt; Detect flaky tests, report on failures, and find test suite problems.&lt;/li&gt;
	&lt;li&gt;:package: &lt;span class=&quot;error&quot;&gt;&amp;#91;JS Bundle Analysis&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://docs.codecov.com/docs/javascript-bundle-analysis):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.codecov.com/docs/javascript-bundle-analysis):&lt;/a&gt; Save yourself from yourself by tracking and limiting bundle sizes in JS merges.&lt;br/&gt;
   &amp;lt;/details&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


</comment>
                            <comment id="17940956" author="githubbot" created="Fri, 4 Apr 2025 12:04:48 +0000"  >&lt;p&gt;paulk-asert commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2028683776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2028683776&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   This isn&apos;t the existing behavior of groovysh with interpreterMode set.&lt;/p&gt;

&lt;p&gt;   &amp;gt; groovy:000&amp;gt; :set interpreterMode&lt;br/&gt;
   &amp;gt; groovy:000&amp;gt; int x = 3&lt;br/&gt;
   &amp;gt; ===&amp;gt; 3&lt;br/&gt;
   &amp;gt; groovy:000&amp;gt; x&lt;br/&gt;
   &amp;gt; ===&amp;gt; 3&lt;br/&gt;
   &amp;gt; groovy:000&amp;gt; int a, b, c&lt;br/&gt;
   &amp;gt; ===&amp;gt; 0&lt;br/&gt;
   &amp;gt; groovy:000&amp;gt; b&lt;br/&gt;
   &amp;gt; ===&amp;gt; 0&lt;/p&gt;



</comment>
                            <comment id="17940965" author="githubbot" created="Fri, 4 Apr 2025 13:03:42 +0000"  >&lt;p&gt;paulk-asert commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2028777348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2028777348&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   I would like to fix the original issue, but it would be good to not break interpreterMode. I&apos;ll try to find time to investigate a little more. &lt;/p&gt;


</comment>
                            <comment id="17941050" author="githubbot" created="Fri, 4 Apr 2025 18:36:52 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2029274400&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2029274400&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   &lt;a href=&quot;https://github.com/apache/groovy/blob/87390561659f50e5a117bebb697731e8666f97b3/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/Groovysh.groovy#L294&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/87390561659f50e5a117bebb697731e8666f97b3/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/Groovysh.groovy#L294&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Groovysh will try to collect variables in the `finally` block, but variables declared in `try` block can not be accessed in `finally` after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed.&lt;/p&gt;


</comment>
                            <comment id="17941051" author="githubbot" created="Fri, 4 Apr 2025 18:38:02 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2029274400&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2029274400&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   &lt;a href=&quot;https://github.com/apache/groovy/blob/87390561659f50e5a117bebb697731e8666f97b3/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/Groovysh.groovy#L294&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/87390561659f50e5a117bebb697731e8666f97b3/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/Groovysh.groovy#L294&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Groovysh will try to collect variables in the `finally` block, but variables declared in `try` block can not be accessed in `finally` block after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed.&lt;/p&gt;


</comment>
                            <comment id="17941537" author="githubbot" created="Mon, 7 Apr 2025 10:59:27 +0000"  >&lt;p&gt;paulk-asert commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2030997973&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2030997973&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   I added the change to StatementWriter and changed groovysh to just have the &quot;variableBlocks&quot; execute directly after &quot;current&quot; (i.e. just removed the try...finally) then interpreterMode still seemed to work. The current test suite and the new tests all passed. There could be variations that we don&apos;t have coverage for in our test suite that may become broken with that change.&lt;/p&gt;


</comment>
                            <comment id="17941558" author="githubbot" created="Mon, 7 Apr 2025 12:02:58 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2031095137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2031095137&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   if the code of `current` throws an exception, the variables will still fail to collect.&lt;/p&gt;


</comment>
                            <comment id="17942037" author="githubbot" created="Wed, 9 Apr 2025 00:21:36 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   We can wrap the `current` with `try-finally` to guarantee the variables will be collected eventually.&lt;/p&gt;


</comment>
                            <comment id="17942038" author="githubbot" created="Wed, 9 Apr 2025 00:23:47 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   We can wrap the `current` with `try-finally` to guarantee the variables will be collected eventually.&lt;/p&gt;

&lt;p&gt;   I will polish the PR tonight.&lt;/p&gt;


</comment>
                            <comment id="17942255" author="githubbot" created="Wed, 9 Apr 2025 18:11:34 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2034205488&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   We can wrap the `current` with `try-finally` to guarantee the variables will be collected eventually.&lt;/p&gt;

&lt;p&gt;   I will polish the PR tonight.&lt;/p&gt;


</comment>
                            <comment id="17942256" author="githubbot" created="Wed, 9 Apr 2025 18:13:09 +0000"  >&lt;p&gt;daniellansun commented on code in PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172#discussion_r2035885431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172#discussion_r2035885431&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/GroovyshTest.groovy:&lt;br/&gt;
##########&lt;br/&gt;
@@ -392,17 +394,34 @@ class GroovyshInterpreterModeTest extends GroovyshTest {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    // groovy:000&amp;gt; int x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // Unknown property: x&lt;br/&gt;
+    // groovy:000&amp;gt; x = 3&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt; x&lt;br/&gt;
+    // ===&amp;gt; 3&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
     void testBoundVar() &lt;/p&gt;
{
         Groovysh groovysh = createGroovysh()
 
-        groovysh.execute(&apos;int x = 3&apos;)
+        groovysh.execute(&apos;x = 3&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
         groovysh.execute(&apos;x&apos;)
         assert mockOut.toString().length() &amp;gt; 0
         assert &apos; 3\n&apos; == mockOut.toString().normalize()[-3..-1]
     }

&lt;p&gt;+    // collecting variables relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt;, e.g. accessing variable declared in try block is in scope in finally block&lt;br/&gt;
+    // but after &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; is fixed, this test will fail, but it is aligned with the behavior of the groovySh:&lt;br/&gt;
+    // groovy:000&amp;gt; int x, y, z&lt;br/&gt;
+    // ===&amp;gt; 0&lt;br/&gt;
+    // groovy:000&amp;gt; y&lt;br/&gt;
+    // Unknown property: y&lt;br/&gt;
+    // groovy:000&amp;gt;&lt;br/&gt;
+    @NotYetImplemented&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   @paulk-asert I&apos;ve polished the PR as you suggested:&lt;br/&gt;
   &lt;a href=&quot;https://github.com/apache/groovy/pull/2172/commits/fef0b8cf6a6e7c4a472afa207808d091fdac354d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172/commits/fef0b8cf6a6e7c4a472afa207808d091fdac354d&lt;/a&gt;&lt;/p&gt;


</comment>
                            <comment id="17943236" author="githubbot" created="Thu, 10 Apr 2025 14:22:21 +0000"  >&lt;p&gt;daniellansun merged PR #2172:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/groovy/pull/2172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/2172&lt;/a&gt;&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2crcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>