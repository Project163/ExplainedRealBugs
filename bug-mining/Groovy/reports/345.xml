<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:59:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-1904] Iterators do not close streams</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-1904</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;iterator() methods for File, Reader, InputStream, and DataInputStream return iterators that do not close their underlying streams. They should do this, to be consistent with iterative closure methods like eachLine() etc. A solution must take in account that a loop can be broken by an exception inside the loop, that is not caused by a resource read operation. Also in this case the resource must be closed.&lt;/p&gt;

&lt;p&gt;See discussion at &lt;a href=&quot;http://www.nabble.com/File-Iterator-leaves-Reader-open-tf3782079.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/File-Iterator-leaves-Reader-open-tf3782079.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To clarify problem a JUnit test case will is attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12813651">GROOVY-1904</key>
            <summary>Iterators do not close streams</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="jstaudemeyer">J&#246;rg Staudemeyer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 May 2007 09:33:00 +0000</created>
                <updated>Sun, 1 Jul 2007 14:16:12 +0000</updated>
                            <resolved>Sun, 1 Jul 2007 14:16:12 +0000</resolved>
                                    <version>1.0</version>
                    <version>1.1-beta-1</version>
                                    <fixVersion>1.1-beta-2</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14462758" author="jstaudemeyer" created="Tue, 22 May 2007 05:01:55 +0000"  >&lt;p&gt;According to the results of the mentioned discussion following modifications shall be applied to DefaultGroovyMethods:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;New overloaded each() methods on File, Reader, InputStream, and ObjectInputStream close their resources on EOF and when an exception occurs. In some cases they may simple delegate to specialized each-methods (like eachLine()).&lt;/li&gt;
	&lt;li&gt;The iterator() methods on Reader, InputStream, and ObjectInputStream return iterators that close their underlying resource on EOF or IOException.&lt;/li&gt;
	&lt;li&gt;The iterator() method on File throws an groovy.lang.DeprecationException stating &quot;Iterators on files are not supported any more. Use File.eachLine() instead. Alternatively you can use FileReader.iterator() and provide your own exception handling.&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This results in the following consequences for application programmers:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;each() loops on streams and readers can be used safely, streams and readers will be closed, no matter what happens inside the loops.&lt;/li&gt;
	&lt;li&gt;For-loops on streams and readers close their streams and readers on normal execution but not necessarily when an exception occurs. So such loops must always be enclosed in try blocks with a finally block that closes the resource.&lt;/li&gt;
	&lt;li&gt;For-loops on files do not work anymore, since there is no way to handle exceptions. They can be easily replaced by File.each() or - more expressive - by File.eachLine().&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All test methods that relate to handling of exceptions inside the loop can be removed from the attached JUnit file.&lt;/p&gt;</comment>
                            <comment id="14462757" author="jstaudemeyer" created="Thu, 24 May 2007 10:07:23 +0000"  >&lt;p&gt;Attached patch file for DefaultGroovyMethods. Further directives are written directly to the file.&lt;/p&gt;

&lt;p&gt;Attached also an updated unit testcase reflecting the actual requirements.&lt;/p&gt;</comment>
                            <comment id="14462806" author="blackdrag" created="Sun, 1 Jul 2007 14:16:12 +0000"  >&lt;p&gt;I close this issue now because I have deprecated File#iterator. &lt;/p&gt;

&lt;p&gt;The solution with the Iterator was discussed, but not approved... it is a pattern too hidden from the user - it is difficult to know then if it will close or not. &lt;/p&gt;

&lt;p&gt;I will also not change/add the &quot;each&quot; Methods on File, Reader and InputStream... One good example here is DataInputStream where people usually expect mixed, not only raw bytes. And using eachLine as &quot;each&quot; for File... We already have eachLine, eachObject and eachByte and they fit exactly the needs here.. I think it is not of much help to provide here an alias to existing methods that might do what they expect for one, but not for the other.&lt;/p&gt;

&lt;p&gt;That means Object#each will be used which tries not to make them into arrays, lists or other collections and just iterators over a one element list containing the object we operate on. That might be not of much use, but it is also not harmful&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721254" name="DefaultGroovyMethods-Patch.txt" size="5783" author="jstaudemeyer" created="Thu, 24 May 2007 10:07:23 +0000"/>
                            <attachment id="12721732" name="DefaultGroovyMethodsFileIteratorTest.groovy" size="4548" author="jstaudemeyer" created="Thu, 24 May 2007 10:07:23 +0000"/>
                            <attachment id="12721306" name="DefaultGroovyMethodsFileIteratorTest.groovy" size="5294" author="jstaudemeyer" created="Mon, 21 May 2007 09:33:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 22 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bpbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>