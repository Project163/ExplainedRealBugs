<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4222] @Lazy has incorrect behavior for static fields</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4222</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The fragment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Lazy &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Type myField
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is transformed into a static private field &lt;tt&gt;$myField&lt;/tt&gt; but an instance method &lt;tt&gt;getMyField()&lt;/tt&gt;. The method should be static and in the case of synchronization, would need to synch on the class not &apos;&lt;tt&gt;this&lt;/tt&gt;&apos;. But there is also a question as to whether double checked locking is best for static, perhaps holder class idiom is better.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12811683">GROOVY-4222</key>
            <summary>@Lazy has incorrect behavior for static fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="paulk">Paul King</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 May 2010 08:08:25 +0000</created>
                <updated>Tue, 7 Apr 2015 19:07:20 +0000</updated>
                            <resolved>Tue, 25 May 2010 21:22:34 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.3</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14479093" author="paulk" created="Mon, 24 May 2010 08:41:37 +0000"  >&lt;p&gt;Proposed patch if we just want to fix the bug and leave DCL in place for the static case even though it strictly isn&apos;t needed - and might be improved using holder class idiom&lt;/p&gt;</comment>
                            <comment id="14469433" author="blackdrag" created="Mon, 24 May 2010 10:14:58 +0000"  >&lt;p&gt;from the patch alone it is quite difficult to get what you actually changed. I suggest to split the patch in a refactoring and in an actual patch. Because I think the actual pach is not much more than one line, but this here has a lot of lines&lt;/p&gt;</comment>
                            <comment id="14479155" author="paulk" created="Mon, 24 May 2010 17:06:14 +0000"  >&lt;p&gt;Updated patch without refactoring&lt;/p&gt;</comment>
                            <comment id="14479129" author="paulk" created="Mon, 24 May 2010 17:16:21 +0000"  >&lt;p&gt;The other general question I have is what preference we have for the performance of the generated code. Currently we have traditional DCL code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Lazy &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; T x
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;becomes&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; T $x

T getX() {
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ($x != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; $x
   &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {
         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ($x == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            $x = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; T()
         }
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; $x
      }
   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but Effective Java suggests:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; T $x

T getX() {
   T result = $x
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (result == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
      &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {
         result = $x
         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (result == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            $x = result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; T()
         }
      }
   }
   &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Claim in Effective Java is that use of local variable &lt;tt&gt;result&lt;/tt&gt; means that &lt;tt&gt;$x&lt;/tt&gt; is read once in common case which can be 25% faster.&lt;/p&gt;

&lt;p&gt;I wonder whether other Groovy processing means this claim isn&apos;t applicable?&lt;/p&gt;</comment>
                            <comment id="14479122" author="paulk" created="Mon, 24 May 2010 21:00:44 +0000"  >&lt;p&gt;fix to static issues applied in trunk but I think for static fields, a solution using the class holder idiom is still worth exploring&lt;/p&gt;</comment>
                            <comment id="14479145" author="paulk" created="Tue, 25 May 2010 11:28:31 +0000"  >&lt;p&gt;attached is working patch (includes a few minor refactoring changes too) - now uses holder class idiom if soft flag not set and static modifier is used&lt;/p&gt;</comment>
                            <comment id="14479114" author="paulk" created="Tue, 25 May 2010 21:22:34 +0000"  >&lt;p&gt;Optimization added&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722627" name="groovy4222_lazy_static.patch" size="2506" author="paulk" created="Mon, 24 May 2010 17:06:14 +0000"/>
                            <attachment id="12722626" name="groovy4222_lazy_static_holder.patch" size="8201" author="paulk" created="Tue, 25 May 2010 11:28:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cfsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>