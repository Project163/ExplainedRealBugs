<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:20:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7025] Static member in enum class definition not initialized before enums created</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7025</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have a static member being initialized inside an enum:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
  ...
  &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Bar {
    FIRST(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)
    ...
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; barNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;()
    ...
    Bar(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
      barNames.add(name)
      ...
    }
    ...
  }
  ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, when the code above executes, barNames is null inside the constructor, i.e., the static member of the enum class is not initialized before the enums themselves are initialized. This may not be a bug, but it seems to me there should be some documentation and/or a compiler warning if you do this.&lt;/p&gt;

&lt;p&gt;Instead, I had to move the set outside the enum to the enclosing class.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12815764">GROOVY-7025</key>
            <summary>Static member in enum class definition not initialized before enums created</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="mitsu">Mitsu Hadeishi</reporter>
                        <labels>
                            <label>enum</label>
                    </labels>
                <created>Thu, 14 Aug 2014 13:40:04 +0000</created>
                <updated>Fri, 10 Feb 2023 21:39:59 +0000</updated>
                            <resolved>Thu, 3 Nov 2022 17:38:18 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>3.0.14</fixVersion>
                    <fixVersion>2.5.20</fixVersion>
                    <fixVersion>4.0.7</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14477067" author="chrylis" created="Thu, 26 Mar 2015 06:32:58 +0000"  >&lt;p&gt;I&apos;m seeing the same issue in 2.4.3, and I disagree that it&apos;s minor; lookup tables are a common idiom, and this breaks them completely. Static blocks are also run after constructors, so there&apos;s no clean workaround. The behavior is clearly incorrect.&lt;/p&gt;</comment>
                            <comment id="14480812" author="mitsu" created="Thu, 26 Mar 2015 13:52:44 +0000"  >&lt;p&gt;I agree, but I don&apos;t think that anyone on the project has even seen this bug. No one has commented on it. Maybe I should up the severity.&lt;/p&gt;</comment>
                            <comment id="14477048" author="blackdrag" created="Thu, 26 Mar 2015 15:20:07 +0000"  >&lt;p&gt;if you try something like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; a = []
    Foo(x){a&amp;lt;&amp;lt;x}
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(1)
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(2)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; Foo.a == [1,2]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;you will see, that the problem is special to enums&lt;/p&gt;</comment>
                            <comment id="14477012" author="mitsu" created="Thu, 26 Mar 2015 15:23:21 +0000"  >&lt;p&gt;Yes, it&apos;s clearly a mistake, and should be fixed, I agree. Hopefully my upping the severity will get someone&apos;s attention. I guess we could go into the source code and figure this out and submit a patch. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14480814" author="paulk" created="Fri, 27 Mar 2015 04:54:44 +0000"  >&lt;p&gt;The static init part of the generated code for your enum above is roughly:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; { 
        FIRST = Foo$Bar.$INIT(&lt;span class=&quot;code-quote&quot;&gt;&apos;FIRST&apos;&lt;/span&gt;, 0, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;)
        MIN_VALUE = FIRST
        MAX_VALUE = FIRST
        $VALUES = [FIRST]
        barNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.util.HashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;()
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The barNames assignment line should come first.&lt;/p&gt;</comment>
                            <comment id="14477137" author="paulk" created="Fri, 27 Mar 2015 05:09:30 +0000"  >&lt;p&gt;And expanding Jochen&apos;s example to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; { println a.size() }
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; a = []
    Foo(x){a&amp;lt;&amp;lt;x}
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(1)
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(2)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; Foo.a == [1, 2]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we do indeed seem to reorder things for that case:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; { 
        a = []
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.println(a.size())
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="14480818" author="paulk" created="Fri, 27 Mar 2015 06:04:15 +0000"  >&lt;p&gt;OK, it looks like the ordering was changed to &quot;fix&quot; &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3161&quot; title=&quot;Wrong initialization order for static fields in enums&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3161&quot;&gt;&lt;del&gt;GROOVY-3161&lt;/del&gt;&lt;/a&gt;. So, perhaps we need something a little more sophisticated than the current or pre &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-3161&quot; title=&quot;Wrong initialization order for static fields in enums&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-3161&quot;&gt;&lt;del&gt;GROOVY-3161&lt;/del&gt;&lt;/a&gt; behaviors, e.g. for this example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
  &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Bar {
    FIRST(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;Bar&amp;gt; specialBars = [FIRST]
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; barNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;()
    Bar(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
      barNames.add(name)
    }
  }
}

println Foo.Bar
println Foo.Bar.specialBars
println Foo.Bar.barNames
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The static init code would need to be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; { 
    barNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.util.HashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;()
    FIRST = Foo$Bar.$INIT(&lt;span class=&quot;code-quote&quot;&gt;&apos;FIRST&apos;&lt;/span&gt;, 0, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;)
    MIN_VALUE = FIRST
    MAX_VALUE = FIRST
    $VALUES = [ FIRST ]
    specialBars = [ FIRST ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It would need some quite smart logic. Not even sure it is possible to detect in the general case. It&apos;s easy to see why Java prohibits access to static fields like &lt;tt&gt;barNames&lt;/tt&gt; in enum constructors and instance init blocks.&lt;/p&gt;</comment>
                            <comment id="14477139" author="chrylis" created="Tue, 31 Mar 2015 18:20:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;It&apos;s easy to see why Java prohibits access to static fields like barNames in enum constructors and instance init blocks.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Citation? I do this all the time in Java for initializing lookup maps.&lt;/p&gt;</comment>
                            <comment id="14480820" author="paulk" created="Tue, 31 Mar 2015 19:44:49 +0000"  >&lt;p&gt;I was just using the supplied example and converting to Java. See attached screenshot and error below:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; javac Foo.java
Foo.java:10: error: illegal reference to static field from initializer
            barNames.add(name);
            ^
1 error
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17628382" author="emilles" created="Thu, 3 Nov 2022 15:32:19 +0000"  >&lt;p&gt;&quot;It is a compile-time error to refer to a static field of an enum type from a constructor, instance initializer, or instance variable initializer of the enum type, unless the field is a constant variable (&#167;4.12.4).&quot;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/specs/jls/se11/html/jls-8.html#jls-8.9.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/specs/jls/se11/html/jls-8.html#jls-8.9.2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17628444" author="emilles" created="Thu, 3 Nov 2022 17:38:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/389bb26d11be5ec3178cff7d96afafaa35b1a353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/389bb26d11be5ec3178cff7d96afafaa35b1a353&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13476192">GROOVY-10721</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12723247" name="enum_in_class.png" size="11455" author="paulk" created="Tue, 31 Mar 2015 19:44:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bz2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>