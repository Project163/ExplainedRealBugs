<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4293] BUG! exception in phase &apos;parsing&apos; in source unit &apos;Script1.groovy&apos; null</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4293</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I am encountering another parser &quot;bug&quot;&lt;/p&gt;

&lt;p&gt;does not work:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Expando()
params.newValue = 23
def trendMap = [&lt;span class=&quot;code-quote&quot;&gt;&apos;worsening&apos;&lt;/span&gt;: (-2), &lt;span class=&quot;code-quote&quot;&gt;&apos;slightly worsening&apos;&lt;/span&gt;:(-1), &lt;span class=&quot;code-quote&quot;&gt;&apos;neutral&apos;&lt;/span&gt;:0 ,&lt;span class=&quot;code-quote&quot;&gt;&apos;slightly improving&apos;&lt;/span&gt;: 1,&lt;span class=&quot;code-quote&quot;&gt;&apos;improving&apos;&lt;/span&gt;:2]

def obj = []
def el = [obj]
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!el[1]) el[1] = &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;

Eval.x(el[0],&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ el[2] ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger() )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;changing the last line to include brackets makes it work&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Eval.x(el[0],&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ (el[2] ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger()) )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Exception thrown&lt;/p&gt;

&lt;p&gt;BUG! exception in phase &apos;parsing&apos; in source unit &apos;Script1.groovy&apos; null&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval.me(Eval.java:50)&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval.x(Eval.java:60)&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval$x.call(Unknown Source)&lt;/p&gt;

&lt;p&gt;	at ConsoleScript24.run(ConsoleScript24:9)&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;	at java.io.StringReader.&amp;lt;init&amp;gt;(StringReader.java:33)&lt;/p&gt;

&lt;p&gt;	... 4 more&lt;br/&gt;
Result: 23 &lt;br/&gt;
Exception thrown&lt;/p&gt;

&lt;p&gt;BUG! exception in phase &apos;parsing&apos; in source unit &apos;Script1.groovy&apos; null&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval.me(Eval.java:50)&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval.x(Eval.java:60)&lt;/p&gt;

&lt;p&gt;	at groovy.util.Eval$x.call(Unknown Source)&lt;/p&gt;

&lt;p&gt;	at ConsoleScript26.run(ConsoleScript26:9)&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;	at java.io.StringReader.&amp;lt;init&amp;gt;(StringReader.java:33)&lt;/p&gt;

&lt;p&gt;	... 4 more&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12811855">GROOVY-4293</key>
            <summary>BUG! exception in phase &apos;parsing&apos; in source unit &apos;Script1.groovy&apos; null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="livelock">Andr&#233;</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jul 2010 07:43:25 +0000</created>
                <updated>Thu, 22 Jul 2010 17:32:27 +0000</updated>
                            <resolved>Wed, 7 Jul 2010 21:48:34 +0000</resolved>
                                    <version>1.7.3</version>
                                    <fixVersion>1.7.4</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14469756" author="roshandawrani" created="Wed, 7 Jul 2010 05:21:05 +0000"  >&lt;p&gt;The only improvement I can think of making here is giving a proper exception when the script is null instead of letting it go further in compilation and fail with a BUG! message.&lt;/p&gt;

&lt;p&gt;Apart from that, the behavior you are seeing is same as the behavior of &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Eval.x(1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, the Eval.x() is receiving null as the script because the + operator has higher precedence than ?:&lt;/p&gt;

&lt;p&gt;So, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ el[2] ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger()
becomes
(&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ el[2]) ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger()
which becomes
(&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ el[2]) ? trendMap[23] : 23
which results in &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; because &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; expression is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; and trendMap[23] is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To get the operators right as per their precedence order, you need to use () as you have used and make it&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ (el[2] ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469769" author="roshandawrani" created="Wed, 7 Jul 2010 07:27:49 +0000"  >&lt;p&gt;Proposed patch attached.&lt;/p&gt;

&lt;p&gt;After the patch&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Test.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Expando()
params.newValue = 23
def trendMap = [&lt;span class=&quot;code-quote&quot;&gt;&apos;worsening&apos;&lt;/span&gt;: (-2), &lt;span class=&quot;code-quote&quot;&gt;&apos;slightly worsening&apos;&lt;/span&gt;:(-1), &lt;span class=&quot;code-quote&quot;&gt;&apos;neutral&apos;&lt;/span&gt;:0 ,&lt;span class=&quot;code-quote&quot;&gt;&apos;slightly improving&apos;&lt;/span&gt;: 1,&lt;span class=&quot;code-quote&quot;&gt;&apos;improving&apos;&lt;/span&gt;:2]

def obj = []
def el = [obj]
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!el[1]) el[1] = &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;

Eval.x(el[0],&lt;span class=&quot;code-quote&quot;&gt;&quot;x[1]=&quot;&lt;/span&gt;+ el[2] ? trendMap[params.newValue.toInteger()] : params.newValue.toInteger() )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fails with&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caught: java.lang.IllegalArgumentException: Script text to compile cannot be null!
	at Test.run(Test.groovy:9)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469704" author="blackdrag" created="Wed, 7 Jul 2010 11:15:50 +0000"  >&lt;p&gt;looks good&lt;/p&gt;</comment>
                            <comment id="14469770" author="roshandawrani" created="Wed, 7 Jul 2010 21:48:34 +0000"  >&lt;p&gt;Fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722326" name="4293_v17x.patch" size="993" author="roshandawrani" created="Wed, 7 Jul 2010 07:27:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c2kf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>