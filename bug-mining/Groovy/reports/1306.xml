<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4246] Issue with incrementing array when using Random number generation</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4246</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have found an issue with array incrementation, when using randomly generated number as array index.&lt;br/&gt;
The idea was to randomly increment one of the indexes.&lt;br/&gt;
For array of size = 3 and 10 incrementations I can see array was modified like this &lt;span class=&quot;error&quot;&gt;&amp;#91;example from system.out&amp;#93;&lt;/span&gt;:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0, 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 0, 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 0, 1&amp;#93;&lt;/span&gt; should be &lt;span class=&quot;error&quot;&gt;&amp;#91;1,0,1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 1&amp;#93;&lt;/span&gt; should be &lt;span class=&quot;error&quot;&gt;&amp;#91;1,1,1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 3, 1&amp;#93;&lt;/span&gt; should be &lt;span class=&quot;error&quot;&gt;&amp;#91;2,1,1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 2, 1&amp;#93;&lt;/span&gt; now I&apos;m puzzled as the digit is decremented!&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 2, 1&amp;#93;&lt;/span&gt; what was incremented? no one knows! ;]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 2, 2&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 2, 3&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 3, 3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;See the code attached.&lt;/p&gt;

&lt;p&gt;Additional info:&lt;br/&gt;
When the randomiser invocation is moved to assign value to a variable, and then variable is used as array index it works fine.&lt;/p&gt;</description>
                <environment>Windows 7 64 bit</environment>
        <key id="12815222">GROOVY-4246</key>
            <summary>Issue with incrementing array when using Random number generation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="krstn">Krystian Szczesny</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Jun 2010 05:24:43 +0000</created>
                <updated>Thu, 22 Jul 2010 17:32:25 +0000</updated>
                            <resolved>Wed, 23 Jun 2010 12:39:51 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.4</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14469541" author="blackdrag" created="Fri, 11 Jun 2010 06:08:37 +0000"  >&lt;p&gt;after playing around a bit I think that the call to rand() is done multiple times... I added a simple counter to the method and found, that rand() is called 30 here. I think that a&lt;span class=&quot;error&quot;&gt;&amp;#91;exp&amp;#93;&lt;/span&gt;++ is converted into: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;a.putAt(exp, a.getAt(exp).next())
a.getAt(exp)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while the correct code should look more like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;tmp = exp
a.putAt(tmp,a.getAt(tmp).next())
a.getAt(tmp)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;arguably the code could be improved further to do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;tmp = exp
res = a.getAt(tmp).next()
a.putAt(tmp,res)
res
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This would save one more getAt call, increasin performance a little.&lt;/p&gt;</comment>
                            <comment id="14469594" author="roshandawrani" created="Fri, 11 Jun 2010 06:10:13 +0000"  >&lt;p&gt;The given code consistently works if I change &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;arr[rand()]++
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; x = rand()
arr[x]++
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;More after some more investigation.&lt;/p&gt;</comment>
                            <comment id="14469612" author="roshandawrani" created="Fri, 11 Jun 2010 06:11:44 +0000"  >&lt;p&gt;Simultaneous posts. Looks like Jochen already investigated the cause.&lt;/p&gt;</comment>
                            <comment id="14469690" author="roshandawrani" created="Wed, 23 Jun 2010 00:42:22 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;Attaching here a patch for review. Here is how the bytecode looks like after applying the patch for the postfix evaluation part of &quot;arr&lt;span class=&quot;error&quot;&gt;&amp;#91;exp&amp;#93;&lt;/span&gt;++&quot;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; tmp = exp;
&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; localObject1 = &lt;span class=&quot;code-quote&quot;&gt;&quot;getAt&quot;&lt;/span&gt;.call(arr, tmp);
&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; localObject2 = &lt;span class=&quot;code-quote&quot;&gt;&quot;next&quot;&lt;/span&gt;.call(localObject1);
&lt;span class=&quot;code-quote&quot;&gt;&quot;putAt&quot;&lt;/span&gt;.call(arr, tmp, localObject2); 
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; localObject1;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As captured in the test, the rand() expression is now correctly evaluated only 10 times instead of 30.&lt;/p&gt;</comment>
                            <comment id="14469665" author="blackdrag" created="Wed, 23 Jun 2010 10:09:49 +0000"  >&lt;p&gt;good work&lt;/p&gt;</comment>
                            <comment id="14469733" author="roshandawrani" created="Wed, 23 Jun 2010 12:39:51 +0000"  >&lt;p&gt;Thanks Jochen. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14469649" author="krstn" created="Wed, 23 Jun 2010 14:25:41 +0000"  >&lt;p&gt;Thanks guys. Looking forward to stable release with this fix.&lt;br/&gt;
Groovy will become groovier.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722436" name="4246_v18x.patch" size="4945" author="roshandawrani" created="Wed, 23 Jun 2010 00:42:22 +0000"/>
                            <attachment id="12722441" name="Bug.groovy" size="326" author="krstn" created="Fri, 11 Jun 2010 05:24:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cm5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>