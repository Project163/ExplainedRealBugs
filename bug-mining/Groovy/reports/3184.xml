<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:54:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8069] Annotation based logging of complex expression in closure throws GroovyCastException when statically compiled</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8069</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@groovy.util.logging.Log
@groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    void bar() {
        def callable = {
            log.info(&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt; + 1)
        }
        callable.call()
    }
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo().bar()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The log statement in the code above results in the following runtime exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; object &lt;span class=&quot;code-quote&quot;&gt;&apos;Foo@14ec4505&apos;&lt;/span&gt; with class &lt;span class=&quot;code-quote&quot;&gt;&apos;Foo&apos;&lt;/span&gt; to class &lt;span class=&quot;code-quote&quot;&gt;&apos;java.util.logging.Logger&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The case where the closure is in a static method is similar; the object being cast to a Logger is a Class instead. &lt;/p&gt;

&lt;p&gt;This appears to be due to the implicitThis field being set incorrectly on the guard method call expression (log.isLoggable(Level) in the default case) created in implementations of LoggingStrategy.wrapLoggingMethodCall.&lt;/p&gt;

&lt;p&gt;Prior to Groovy 2.4.8, log statements inside closures were not guarded (&lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-6932&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/GROOVY-6932&lt;/a&gt;), so this bug wasn&apos;t visible. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13039755">GROOVY-8069</key>
            <summary>Annotation based logging of complex expression in closure throws GroovyCastException when statically compiled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shils">Shil Sinha</assignee>
                                    <reporter username="shils">Shil Sinha</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Feb 2017 06:34:21 +0000</created>
                <updated>Wed, 8 Mar 2017 08:17:17 +0000</updated>
                            <resolved>Thu, 2 Feb 2017 14:35:01 +0000</resolved>
                                    <version>2.4.8</version>
                                    <fixVersion>2.4.9</fixVersion>
                                    <component>Static compilation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15849542" author="githubbot" created="Thu, 2 Feb 2017 07:05:01 +0000"  >&lt;p&gt;GitHub user shils opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/487&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/487&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8069&quot; title=&quot;Annotation based logging of complex expression in closure throws GroovyCastException when statically compiled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8069&quot;&gt;&lt;del&gt;GROOVY-8069&lt;/del&gt;&lt;/a&gt;: Annotation based logging of complex expression in closur&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;e throws GroovyCastException with SC.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/shils/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/shils/groovy&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8069&quot; title=&quot;Annotation based logging of complex expression in closure throws GroovyCastException when statically compiled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8069&quot;&gt;&lt;del&gt;GROOVY-8069&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/487.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/487.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #487&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e0be19e84308100e1a9b60a44c6458d33b071d84&lt;br/&gt;
Author: Shil Sinha &amp;lt;shils@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-02-02T06:48:01Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8069&quot; title=&quot;Annotation based logging of complex expression in closure throws GroovyCastException when statically compiled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8069&quot;&gt;&lt;del&gt;GROOVY-8069&lt;/del&gt;&lt;/a&gt;: Annotation based logging of complex expression in closure throws GroovyCastException with SC&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15849940" author="githubbot" created="Thu, 2 Feb 2017 14:05:45 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/487&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/487&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39ijz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>