<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:31:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5801] sql.firstRow() fetches all rows of query</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5801</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;We were trying to use &quot;sql.firstRow(...)&quot; but had to switch to the other sql calls because firstRow is so efficient. Looking at the code (&lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/subprojects/groovy-sql/src/main/java/groovy/sql/Sql.java#L2109&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/blob/master/subprojects/groovy-sql/src/main/java/groovy/sql/Sql.java#L2109&lt;/a&gt;) implies it could be quickly improved:&lt;/p&gt;

&lt;p&gt;current code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; GroovyRowResult firstRow(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sql) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
    List&amp;lt;GroovyRowResult&amp;gt; rows = rows(sql);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rows.isEmpty()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (rows.get(0));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;suggested code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; GroovyRowResult firstRow(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sql) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
    List&amp;lt;GroovyRowResult&amp;gt; rows = rows(sql, 1, 1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rows.isEmpty()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (rows.get(0));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This would avoid first loading all of the rows into memory, just to grab the first one and throw the rest away. For large tables, this causes us to run out of memory.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12816599">GROOVY-5801</key>
            <summary>sql.firstRow() fetches all rows of query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pschumacher">Pascal Schumacher</assignee>
                                    <reporter username="samp">Sam Perman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Nov 2012 08:57:40 +0000</created>
                <updated>Thu, 15 Oct 2015 18:16:10 +0000</updated>
                            <resolved>Wed, 18 Sep 2013 11:41:35 +0000</resolved>
                                                    <fixVersion>2.2.0-beta-1</fixVersion>
                                    <component>SQL processing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14473468" author="samp" created="Fri, 16 Nov 2012 10:27:37 +0000"  >&lt;p&gt;Oops... I meant &quot;firstRow is so inefficient&quot; ...&lt;/p&gt;</comment>
                            <comment id="14480036" author="paulk" created="Sat, 17 Nov 2012 01:24:46 +0000"  >&lt;p&gt;The main reason this hasn&apos;t been done previously was that several of the older database drivers we tested with in the past threw a &lt;tt&gt;SQLFeatureNotSupportedException&lt;/tt&gt; when &lt;tt&gt;ResultSet#absolute(int)&lt;/tt&gt; was called, so we favored the conservative approach which will work for those drivers although it is slower. I guess we should test this again and see what the current situation is. At the moment the burden is on you to use rows(sql, 1, 1, null) to make things faster but if enough of the drivers are working correctly now, then we could put that burden on the old driver users.&lt;/p&gt;</comment>
                            <comment id="14473470" author="samp" created="Mon, 19 Nov 2012 08:04:42 +0000"  >&lt;p&gt;Cool. Thanks. If some drivers still don&apos;t support this, maybe something like this would work:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; GroovyRowResult firstRow(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sql) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
    List&amp;lt;GroovyRowResult&amp;gt; rows = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        rows = rows(sql, 1, 1, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SQLFeatureNotSupportedException e) {
        rows = rows(sql);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rows.isEmpty()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (rows.get(0));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14474045" author="jwagenleitner" created="Thu, 7 Feb 2013 13:26:18 +0000"  >&lt;p&gt;+1 for adding a try/catch block and making the method faster for those with drivers that support it while letting those with drivers that don&apos;t pay a slight performance penalty with the generated exception.&lt;/p&gt;</comment>
                            <comment id="14474141" author="pschumacher" created="Sun, 10 Feb 2013 07:42:25 +0000"  >&lt;p&gt;I agree and therefore created a &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pull request&lt;/a&gt; out of Sams suggestion.&lt;/p&gt;</comment>
                            <comment id="14474069" author="pschumacher" created="Mon, 11 Feb 2013 02:59:29 +0000"  >&lt;p&gt;Merged the pull request. Thanks to everybody who contributed to solving this issue. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12817138">GROOVY-6353</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c0hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>