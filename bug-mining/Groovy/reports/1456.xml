<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:18:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4704] Error with null parameter in prepared statements with old DB2 driver</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4704</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The DB2 JDBC driver throws an exception when setting null as parameter for a prepared statement.&lt;/p&gt;

&lt;p&gt;Stack trace (line numbers are wrong):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: com.ibm.db2.jcc.c.SqlException: Invalid data conversion: Parameter object type is invalid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; requested conversion.
        at com.ibm.db2.jcc.c.uf.setObject(uf.java:1215)
        at groovy.sql.Sql.setObject(Sql.java:2124)
        at groovy.sql.Sql.setParameters(Sql.java:2090)
        at groovy.sql.Sql.getPreparedStatement(Sql.java:2318)
        at groovy.sql.Sql.getPreparedStatement(Sql.java:2324)
        at groovy.sql.Sql.execute(Sql.java:1113)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please use PreparedStatement.setNull() instead of setObject() in the last line of Method groovy.sql.Sql.setObject() when value is null.&lt;/p&gt;

&lt;p&gt;Also see JavaDoc comment for setObject() about null values.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull(int&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://download.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull(int&lt;/a&gt;, int)&lt;br/&gt;
&lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setObject(int,%20java.lang.Object&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://download.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setObject(int,%20java.lang.Object&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</description>
                <environment>IBM DB2 9.1 with old DB2 JDBC driver db2jcc.jar</environment>
        <key id="12817713">GROOVY-4704</key>
            <summary>Error with null parameter in prepared statements with old DB2 driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="kaklakariada">Christoph Pirkl</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Mar 2011 02:41:45 +0000</created>
                <updated>Sat, 12 Mar 2011 00:47:01 +0000</updated>
                            <resolved>Sun, 6 Mar 2011 17:19:18 +0000</resolved>
                                    <version>1.7.8</version>
                                    <fixVersion>1.8-rc-2</fixVersion>
                    <fixVersion>1.7.9</fixVersion>
                                    <component>SQL processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14479464" author="paulk" created="Fri, 4 Mar 2011 06:15:56 +0000"  >&lt;p&gt;Does using the sanctioned &lt;tt&gt;InParameter&lt;/tt&gt; and &lt;tt&gt;OutParameter&lt;/tt&gt; wrappers, e.g. use &lt;tt&gt;Sql.VARCHAR(value)&lt;/tt&gt; instead of &lt;tt&gt;value&lt;/tt&gt;, not work for you?&lt;/p&gt;</comment>
                            <comment id="14470795" author="kaklakariada" created="Fri, 4 Mar 2011 06:25:04 +0000"  >&lt;p&gt;I didn&apos;t think of this, used another workaround. I will try using InParameter wrapper. Nevertheless it would be great to see it fixed, as other people will have the same problem, too.&lt;/p&gt;</comment>
                            <comment id="14479455" author="paulk" created="Fri, 4 Mar 2011 14:09:59 +0000"  >&lt;p&gt;Well, the underlying API doesn&apos;t have a setNull without a type parameter. Do you have a suggestion for setting the type? The &lt;tt&gt;InParameter&lt;/tt&gt; wrapper is our current strategy for dealing with that. The alternatives of guessing based on Java types or having an expensive query on database metadata both have serious drawbacks. Did you have something else in mind?&lt;/p&gt;</comment>
                            <comment id="14470933" author="kaklakariada" created="Sat, 5 Mar 2011 00:46:31 +0000"  >&lt;p&gt;Good argument, I didn&apos;t think about this.&lt;br/&gt;
The most secure and user friendly solution would be to catch and re-throw the SqlException thrown by setObject. When the argument was null, you could wrap the SqlException and add a meaningful exception message like &quot;Maybe the JDBC driver does not support null arguments for setObject. Try using InParameter.&quot;.&lt;br/&gt;
This way, the user at least knows how to work around the JDBC driver restrictions without digging into the Code.&lt;/p&gt;</comment>
                            <comment id="14470972" author="paulk" created="Sun, 6 Mar 2011 06:23:56 +0000"  >&lt;p&gt;Good sugestion&lt;/p&gt;</comment>
                            <comment id="14470973" author="paulk" created="Sun, 6 Mar 2011 17:19:18 +0000"  >&lt;p&gt;Change to error message added&lt;/p&gt;</comment>
                            <comment id="14479472" author="paulk" created="Tue, 8 Mar 2011 04:30:47 +0000"  >&lt;p&gt;Christoph, if there is any chance you could test a snapshot version of the jar in your project that would be great to confirm the improvement works for you prior to our next release which is happening shortly. Thanks.&lt;/p&gt;</comment>
                            <comment id="14470966" author="kaklakariada" created="Wed, 9 Mar 2011 01:17:14 +0000"  >&lt;p&gt;Your changes work as expected: Executing the following code&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;db.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;insert into tn24_werk values (?, ?)&quot;&lt;/span&gt;, [&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;results in this warning (when running it using the groovy ant task):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[groovy] 09.03.2011 08:16:20 groovy.sql.Sql execute
[groovy] WARNUNG: Failed to execute: insert into tn24_werk values (?, ?) because: Your JDBC driver may not support null arguments for setObject. Consider using Groovy&apos;s InParameter feature. (CAUSE: Invalid data conversion: Parameter object type is invalid for requested conversion.)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tested with &lt;a href=&quot;http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.8.0-rc-2-SNAPSHOT/groovy-all-1.8.0-rc-2-SNAPSHOT.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.8.0-rc-2-SNAPSHOT/groovy-all-1.8.0-rc-2-SNAPSHOT.jar&lt;/a&gt; and DB2 JDBC driver version 2.10.52&lt;/p&gt;

&lt;p&gt;Thank you for the quick fix!&lt;/p&gt;</comment>
                            <comment id="14479473" author="paulk" created="Wed, 9 Mar 2011 02:11:10 +0000"  >&lt;p&gt;Excellent, thank you for the suggestion and the quick feedback!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 37 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bron:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>