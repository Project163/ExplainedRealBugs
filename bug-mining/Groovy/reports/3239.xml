<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:55:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8056] GroovyCodeSource(URL) can leak a file handler</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8056</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When &lt;tt&gt;GroovyCodeSource&lt;/tt&gt; is created from a &lt;tt&gt;URL&lt;/tt&gt; it calls &lt;tt&gt;url.openConnection.getContentEncoding()&lt;/tt&gt;. When it&apos;s a &lt;tt&gt;file:&lt;/tt&gt; URL, this causes a &lt;tt&gt;FileInputStream&lt;/tt&gt; to be opened and never closed. The stack trace for it being opened is:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;at java.io.FileInputStream.&amp;lt;init&amp;gt;(Unknown Source)
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(Unknown Source)
	at sun.net.www.protocol.file.FileURLConnection.connect(Unknown Source)
	at sun.net.www.protocol.file.FileURLConnection.initializeHeaders(Unknown Source)
	at sun.net.www.protocol.file.FileURLConnection.getHeaderField(Unknown Source)
	at java.net.URLConnection.getContentEncoding(Unknown Source)
	at groovy.lang.GroovyCodeSource.&amp;lt;init&amp;gt;(GroovyCodeSource.java:176)
	at groovy.text.markup.MarkupTemplateEngine$MarkupTemplateMaker.&amp;lt;init&amp;gt;(MarkupTemplateEngine.java:222)
	at groovy.text.markup.MarkupTemplateEngine.createTemplateByPath(MarkupTemplateEngine.java:145)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I believe that keeping a local reference to the &lt;tt&gt;URLConnection&lt;/tt&gt; and then calling &lt;tt&gt;getInputStream().close()&lt;/tt&gt; on it will fix the problem.&lt;/p&gt;

&lt;p&gt;For reference &lt;a href=&quot;https://github.com/spring-projects/spring-boot/issues/7892&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; is the Spring Boot issues where the problem was originally reported.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035839">GROOVY-8056</key>
            <summary>GroovyCodeSource(URL) can leak a file handler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jwagenleitner">John Wagenleitner</assignee>
                                    <reporter username="awilkinson">Andy Wilkinson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Jan 2017 10:21:56 +0000</created>
                <updated>Tue, 6 Mar 2018 23:14:45 +0000</updated>
                            <resolved>Sat, 3 Jun 2017 15:53:01 +0000</resolved>
                                    <version>2.4.8</version>
                                    <fixVersion>2.4.12</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15828042" author="blackdrag" created="Wed, 18 Jan 2017 13:29:14 +0000"  >&lt;p&gt;Yes, this should not happen... I hope that this then really solves the problem on the spring-boot side, since Windows tends to not close file handles right away and just because we close may not mean windows closes it at that time too. But anyway, this needs to be fixed&lt;/p&gt;</comment>
                            <comment id="15833694" author="jwagenleitner" created="Sun, 22 Jan 2017 20:50:28 +0000"  >&lt;p&gt;I think &lt;tt&gt;getContentEncoding()&lt;/tt&gt; is not correct since we are looking for a charset but it returns how the content is compressed (i.e., gzip, deflate) that is specified in the &lt;a href=&quot;https://tools.ietf.org/html/rfc7231#section-3.1.2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Content-Encoding HTTP Header&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To obtain a charset it&apos;s the &lt;tt&gt;getContentType()&lt;/tt&gt; value and it&apos;s in the form (when it&apos;s present) &lt;tt&gt;text/html; charset=UTF-8&lt;/tt&gt;.  Futher, I think we could skip this call completely if &lt;tt&gt;&quot;file&quot;.equals(url.getProtocol())&lt;/tt&gt; since no Content-Type header will be available.&lt;/p&gt;</comment>
                            <comment id="15873376" author="githubbot" created="Sun, 19 Feb 2017 00:26:05 +0000"  >&lt;p&gt;GitHub user jwagenleitner opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/500&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/500&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8056&quot; title=&quot;GroovyCodeSource(URL) can leak a file handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8056&quot;&gt;&lt;del&gt;GROOVY-8056&lt;/del&gt;&lt;/a&gt;: GroovyCodeSource(URL) can leak a file handler&lt;/p&gt;

&lt;p&gt;    URLConnect.getContentEncoding returns the Content-Encoding&lt;br/&gt;
    HTTP Header &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; which is not a charset.  Since this method would&lt;br/&gt;
    have either returned null or an invalid charset, the code path&lt;br/&gt;
    specifying the encoding would normally not have been executed.&lt;br/&gt;
    The charset may be contained in the Content-Type header, but&lt;br/&gt;
    rather than attempt to parse that string which would require&lt;br/&gt;
    closing the connection, this fix avoids opening the connection&lt;br/&gt;
    and relies on the default charset.&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jwagenleitner/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jwagenleitner/groovy&lt;/a&gt; groovy8056-content-encoding&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/500.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/500.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #500&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 29a641ccc212d397bdc11d3a995763b88dfe34b5&lt;br/&gt;
Author: John Wagenleitner &amp;lt;jwagenleitner@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-02-19T00:22:49Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8056&quot; title=&quot;GroovyCodeSource(URL) can leak a file handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8056&quot;&gt;&lt;del&gt;GROOVY-8056&lt;/del&gt;&lt;/a&gt;: GroovyCodeSource(URL) can leak a file handler&lt;/p&gt;

&lt;p&gt;    URLConnect.getContentEncoding returns the Content-Encoding&lt;br/&gt;
    HTTP Header &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; which is not a charset.  Since this method would&lt;br/&gt;
    have either returned null or an invalid charset, the code path&lt;br/&gt;
    specifying the encoding would normally not have been executed.&lt;br/&gt;
    The charset may be contained in the Content-Type header, but&lt;br/&gt;
    rather than attempt to parse that string which would require&lt;br/&gt;
    closing the connection, this fix avoids opening the connection&lt;br/&gt;
    and relies on the default charset.&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16035986" author="githubbot" created="Sat, 3 Jun 2017 14:56:02 +0000"  >&lt;p&gt;GitHub user jwagenleitner opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/557&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8056&quot; title=&quot;GroovyCodeSource(URL) can leak a file handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8056&quot;&gt;&lt;del&gt;GROOVY-8056&lt;/del&gt;&lt;/a&gt;: GroovyCodeSource(URL) can leak a file handler&lt;/p&gt;

&lt;p&gt;    A safer fix in terms of compatibility compared to PR #500. &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jwagenleitner/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jwagenleitner/groovy&lt;/a&gt; 8056-urlcon-leak&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/557.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/557.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #557&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d99ff70a729448d75d3ca5b98c70733ba1ca428a&lt;br/&gt;
Author: John Wagenleitner &amp;lt;jwagenleitner@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-06-03T14:50:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8056&quot; title=&quot;GroovyCodeSource(URL) can leak a file handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8056&quot;&gt;&lt;del&gt;GROOVY-8056&lt;/del&gt;&lt;/a&gt;: GroovyCodeSource(URL) can leak a file handler&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16035993" author="githubbot" created="Sat, 3 Jun 2017 15:12:55 +0000"  >&lt;p&gt;Github user jwagenleitner closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/500&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/500&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16036000" author="githubbot" created="Sat, 3 Jun 2017 15:50:44 +0000"  >&lt;p&gt;Github user jwagenleitner closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/557&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16036002" author="jwagenleitner" created="Sat, 3 Jun 2017 15:53:01 +0000"  >&lt;p&gt;Thanks for reporting the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38v9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>