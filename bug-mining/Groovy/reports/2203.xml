<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:32:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6012] GroovyScriptEngine uses UTF-8 on initial compilation, system file.encoding on recompilation</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6012</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The first time a file is complied by GSE it is always taken as UTF-8. After a change to the script the recompliation uses file.encoding system property instead. This is critical especially on Windows environments where the JVM default file.encoding to Cp1252 (or other 8-bit regional flavors).&lt;/p&gt;</description>
                <environment>JDK 1.6.0.37, Windows 32 bit</environment>
        <key id="12816799">GROOVY-6012</key>
            <summary>GroovyScriptEngine uses UTF-8 on initial compilation, system file.encoding on recompilation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="eddelplus">Jochen Eddelbuettel</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Feb 2013 01:38:45 +0000</created>
                <updated>Sat, 16 Nov 2013 10:55:09 +0000</updated>
                            <resolved>Fri, 4 Oct 2013 09:41:21 +0000</resolved>
                                    <version>2.1.1</version>
                                    <fixVersion>2.1.8</fixVersion>
                                    <component>GroovyScriptEngine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14474054" author="blackdrag" created="Thu, 21 Feb 2013 05:49:34 +0000"  >&lt;p&gt;a possible patch&lt;/p&gt;</comment>
                            <comment id="14474237" author="eddelplus" created="Thu, 4 Apr 2013 15:50:28 +0000"  >&lt;p&gt;Patch prepared by Blackdrag looked like the right fix to apply. Any chance to get this into 2.1.3, please?&lt;/p&gt;</comment>
                            <comment id="14474229" author="melix" created="Thu, 4 Apr 2013 16:01:56 +0000"  >&lt;p&gt;Jochen, since you wrote that patch, any reason why you didn&apos;t apply it? Not sure about the fix?&lt;/p&gt;</comment>
                            <comment id="14474338" author="eddelplus" created="Thu, 4 Apr 2013 16:38:07 +0000"  >&lt;p&gt;Reminder: Don&apos;t forget to explicitly set the source encoding in the compiler configuration to UTF-8 in order to maintain compatibility with the previous behavior (at least for scripts only compiled once). That was the only thing missing in the patch.&lt;/p&gt;</comment>
                            <comment id="14474296" author="blackdrag" created="Fri, 5 Apr 2013 15:55:45 +0000"  >&lt;p&gt;the reason I did not apply the patch is that for one tests are missing and for two I have not yet an idea how correctly resolve the UTF-8 enconding default problem. It is legal to change the default configuration and the encoding there. But we have no way of later finding out if that had been done. If now someone wants to use the default configuration to set the encoding, it would not be reflected in GSE, since all GSE could do is set UTF-8 blindly, till somebody calls setConfig(CompilerConfiguration.DEFAULT)... which looks strange. &lt;/p&gt;

&lt;p&gt;Jochen and Cedric, what do you think?&lt;/p&gt;</comment>
                            <comment id="14474339" author="eddelplus" created="Fri, 5 Apr 2013 16:27:03 +0000"  >&lt;p&gt;Well the fact is, that the current code will always apply UTF-8 on initial compilation, because that is already hard coded. Scripts not undergoing active changes will never be treated to anything else but UTF-8. So yes, purely by the book CompilerConfiguration.DEFAULT should somehow apply to GSE as well. But practically it has not done so for quite a while. I was able to find the setConfig() method in a futile attempt to resolve my problem, because the configuration set did not even affect the actual compiler at all. I&apos;d value compatibility over purity and give the config, which does have an effect now, a hard coded initial encoding of UTF-8. Add a line in the JavaDoc under setConfig to convey this default behavior and suggest using that method to change it, if anybody wants or needs it differently. As for testing: Guillaume could probably deploy some bigger Gaelyk site based on the new code and not notice a difference.&lt;/p&gt;</comment>
                            <comment id="14474331" author="melix" created="Wed, 24 Apr 2013 09:41:45 +0000"  >&lt;p&gt;I wouldn&apos;t change the default compiler configuration to UTF-8. It would break a lot of code running, for example, on Windows, because the default compiler configuration uses the system encoding. An idea could be that if the &lt;tt&gt;GroovyScriptEngine&lt;/tt&gt; is created with &lt;tt&gt;CompilerConfiguration.DEFAULT&lt;/tt&gt;, then we create a new &lt;tt&gt;CompilerConfiguration&lt;/tt&gt; instead, which would make the changes to &lt;tt&gt;CompilerConfiguration.DEFAULT&lt;/tt&gt; invisible (note that I think it&apos;s a bad practice to change the default configuration instance).&lt;/p&gt;</comment>
                            <comment id="14474399" author="eddelplus" created="Wed, 24 Apr 2013 10:11:25 +0000"  >&lt;p&gt;Cedric,&lt;br/&gt;
I&apos;m not suggesting to change the default for all instances of CompilerConfiguration. The GSE creates an instance of CompilerConfiguration in its constructor. The problem was, that that instance wasn&apos;t passed to the compiler at all, so there was no way to configure anything. The patch utilizes the CompilerConfiguration instance now. To maintain compatibility in the scope of the GSE, not in any other compiler related stuff, the GSE constructor needs to set UTF-8 on its private CompilerConfiguration. That is just replacing another hard coded UTF-8 setting in the current code.&lt;br/&gt;
Jochen&lt;/p&gt;</comment>
                            <comment id="14474387" author="melix" created="Wed, 24 Apr 2013 10:13:15 +0000"  >&lt;p&gt;I see, makes sense.&lt;/p&gt;</comment>
                            <comment id="14474346" author="melix" created="Thu, 25 Apr 2013 05:07:42 +0000"  >&lt;p&gt;I created a pull-request: &lt;a href=&quot;https://github.com/groovy/groovy-core/pull/172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/pull/172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I suggest we switch over there for further comments in order to improve the fix. I had to restore the &lt;tt&gt;public ScriptClassLoader(GroovyClassLoader loader)&lt;/tt&gt; constructor or GSEs created using a GroovyClassLoader wouldn&apos;t use the right compiler configuration.&lt;/p&gt;</comment>
                            <comment id="14474959" author="eddelplus" created="Sat, 16 Nov 2013 10:55:09 +0000"  >&lt;p&gt;Glad this finally made it into a release. More so that it got into a 2.1.x bug fix. Groovy 2.1.9 looks like the rock-solid tool that I like to depend on. Keep up the good work!!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12815592">GROOVY-6013</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12723160" name="GSEProblem.java" size="1481" author="eddelplus" created="Thu, 21 Feb 2013 01:38:45 +0000"/>
                            <attachment id="12722935" name="UTF8Script.groovy" size="201" author="eddelplus" created="Thu, 21 Feb 2013 01:38:46 +0000"/>
                            <attachment id="12722381" name="a.patch" size="2023" author="blackdrag" created="Thu, 21 Feb 2013 05:49:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 1 week, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bxd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>