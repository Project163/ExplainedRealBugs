<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:04:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2585] Can not insert nulls into the table using Sql.execute</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2585</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Running this script:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.sql.Sql

Sql sql = Sql.newInstance(&lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:oracle:oci:@???, &quot;&lt;/span&gt;???&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;???&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;oracle.jdbc.driver.OracleDriver&quot;)

sql.execute &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE TEST (A INT, B INT)&quot;&lt;/span&gt;

sql.execute &lt;span class=&quot;code-quote&quot;&gt;&quot; insert into test (A,B) values (?,?)&quot;&lt;/span&gt;,         [10, 20]     &lt;span class=&quot;code-comment&quot;&gt;// works OK
&lt;/span&gt;sql.execute &lt;span class=&quot;code-quote&quot;&gt;&quot; insert into test (A,B) values (?,?)&quot;&lt;/span&gt;,         [10, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]  &lt;span class=&quot;code-comment&quot;&gt;// fails&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Results in:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-none&quot;&gt;Caught: java.sql.SQLException: ORA-01008: not all variables bound
	at test.run(test.groovy:11)
	at test.main(test.groovy)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;AFAIK, th problem lies with the following code (groovy.sql.Sql.java: 1390)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (value != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                setObject(statement, i++, value);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think it should be &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (value != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                setObject(statement, i++, value);
          &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                 statement.setNull(i, in.getType());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment>Windows XP</environment>
        <key id="12813983">GROOVY-2585</key>
            <summary>Can not insert nulls into the table using Sql.execute</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="pganelin">Pavel Ganelin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Feb 2008 15:27:25 +0000</created>
                <updated>Wed, 5 Nov 2008 19:55:26 +0000</updated>
                            <resolved>Fri, 8 Feb 2008 17:12:14 +0000</resolved>
                                    <version>1.5.4</version>
                                    <fixVersion>1.5.5</fixVersion>
                    <fixVersion>1.6-beta-1</fixVersion>
                                    <component>SQL processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14477877" author="paulk" created="Wed, 6 Feb 2008 16:09:55 +0000"  >&lt;p&gt;Looks similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2146&quot; title=&quot;Can&amp;#39;t insert null values into database&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2146&quot;&gt;&lt;del&gt;GROOVY-2146&lt;/del&gt;&lt;/a&gt;, perhaps the previous fixes weren&apos;t as generic as they needed to be. We should try to test on e.g. Oracle, hsql and mysql this time.&lt;/p&gt;</comment>
                            <comment id="14477945" author="paulk" created="Wed, 6 Feb 2008 16:11:23 +0000"  >&lt;p&gt;Add code tags&lt;/p&gt;</comment>
                            <comment id="14477910" author="paulk" created="Wed, 6 Feb 2008 16:12:02 +0000"  >&lt;p&gt;Your suggested fix appears correct at first glance. I will try to apply and test when I get a chance.&lt;/p&gt;</comment>
                            <comment id="14477967" author="paulk" created="Fri, 8 Feb 2008 06:50:00 +0000"  >&lt;p&gt;OK, the patch I just applied seems ot work with hsql, oracle and mysql. Please reopen if you have further problems.&lt;/p&gt;</comment>
                            <comment id="14477922" author="paulk" created="Fri, 8 Feb 2008 16:01:09 +0000"  >&lt;p&gt;I am reopening until I perform all my earlier tests across all three databases. Our automated test (and CI) environment only does hsql so this has to be done manually.&lt;/p&gt;</comment>
                            <comment id="14477857" author="paulk" created="Fri, 8 Feb 2008 17:12:14 +0000"  >&lt;p&gt;Improved solution (previous change would have caused a regression) and now tested on hsql, oracle and mysql for both GString and String variations&lt;/p&gt;</comment>
                            <comment id="14464436" author="philwalk9" created="Sun, 2 Mar 2008 14:16:42 +0000"  >&lt;p&gt;groovy version 1.5.4  JVM: 10.0-b19 still has a problem with Postgresql 8.3&lt;/p&gt;

&lt;p&gt;The script above results in the following error message:&lt;/p&gt;

&lt;p&gt;Caught: org.postgresql.util.PSQLException: No value specified for parameter 2.&lt;br/&gt;
	at test.run(test.groovy:11)&lt;br/&gt;
	at test.main(test.groovy)&lt;/p&gt;


</comment>
                            <comment id="14464424" author="philwalk9" created="Sun, 2 Mar 2008 18:52:30 +0000"  >&lt;p&gt;verified fix by testing with groovy 1.6 beta code and postgresql 8.3&lt;/p&gt;</comment>
                            <comment id="14478011" author="paulk" created="Sun, 2 Mar 2008 21:16:22 +0000"  >&lt;p&gt;Great! Thanks for testing that. This has been merged onto 1_5_X branch so should appear in 1.5.5 too.&lt;/p&gt;</comment>
                            <comment id="14465554" author="nicolasb" created="Wed, 5 Nov 2008 05:44:09 +0000"  >&lt;p&gt;Hi, &lt;/p&gt;

&lt;p&gt;I don&apos;t think this is already fixed. I am using Sybase and Groovy 1.5.6 and I still get the following:&lt;/p&gt;

&lt;p&gt;Caught: java.sql.SQLException: JZ0SE: Invalid object type (or null object) specified for setObject(). &lt;/p&gt;

&lt;p&gt;I use code below but if any one of the fields is null, I get the error.&lt;/p&gt;

&lt;p&gt;dest.executeUpdate(insertSql, [&lt;br/&gt;
srcData.system_code,&lt;br/&gt;
srcData.ext_exec_id,&lt;br/&gt;
srcData.ext_msg_id,&lt;br/&gt;
srcData.priority,&lt;br/&gt;
srcData.sink_id,&lt;br/&gt;
srcData.time_stamp,&lt;br/&gt;
srcData.hldAcct,&lt;br/&gt;
srcData.hldTrader,&lt;br/&gt;
srcData.hldGroup,&lt;br/&gt;
srcData.hldCust,&lt;br/&gt;
srcData.hldCurr,&lt;br/&gt;
srcData.hldSecId,&lt;br/&gt;
srcData.hldSecName,&lt;br/&gt;
srcData.ordExch,&lt;br/&gt;
srcData.ordComment,&lt;br/&gt;
srcData.ordBlotter,&lt;br/&gt;
srcData.ordSystem,&lt;br/&gt;
srcData.ordTrader,&lt;br/&gt;
srcData.ordBSCode,&lt;br/&gt;
srcData.execPrice,&lt;br/&gt;
srcData.execQty,&lt;br/&gt;
srcData.execSettleDt,&lt;br/&gt;
srcData.execTradeDt, &lt;br/&gt;
srcData.execTradeTm,&lt;br/&gt;
srcData.execQuotePrice,&lt;br/&gt;
srcData.execComment,&lt;br/&gt;
srcData.hldLegalEntity,&lt;br/&gt;
srcData.location,&lt;br/&gt;
srcData.cancel, &lt;br/&gt;
srcData.appType,&lt;br/&gt;
srcData.ordBroker,&lt;br/&gt;
srcData.execStringID,&lt;br/&gt;
srcData.orderStringID&lt;br/&gt;
])&lt;/p&gt;</comment>
                            <comment id="14465513" author="blackdrag" created="Wed, 5 Nov 2008 06:19:31 +0000"  >&lt;p&gt;Nicolas, I suggest that you fill a new issue if none of your objects is a InParameter instance. Because in this case setNull is not used. This issue was for InParameters. The problem is that, if it is no InParameter we do not know the type we have to give to the setNull call. Therefor it would be good if you could show as how you would do that in plain jdbc java.  If you do not want to use InParamerter then we would have to query the database for the column type and use that type in the setNull call. But that is quite slow.&lt;/p&gt;</comment>
                            <comment id="14465561" author="nicolasb" created="Wed, 5 Nov 2008 18:28:41 +0000"  >&lt;p&gt;Hi Jochen,&lt;/p&gt;

&lt;p&gt;Thanks for the reply but I don&apos;t actually get you when you said that none of my objects is an InParameter instance. I am trying to execute code similar to the problem description:&lt;/p&gt;

&lt;p&gt;sql.execute &quot; insert into test (A,B) values (?,?)&quot;,         &lt;span class=&quot;error&quot;&gt;&amp;#91;10, null&amp;#93;&lt;/span&gt;  // fails&lt;/p&gt;
</comment>
                            <comment id="14465487" author="blackdrag" created="Wed, 5 Nov 2008 19:47:43 +0000"  >&lt;p&gt;InParameter is an inner class of groovy.sql.Sql and is used to have a type even if the value is null. The problem is that PreparedStatement#setNull normally expects a type. In many databases a simple setObject(x,null) would fail and Sybase is one of these. So the usage of setNull is required. This also requires a type argument and I think there are about 3 variants. Types.OTHER, Types.NULL and the real type. AFAIK the first two fail in some databases and in others not. It depends much on the jdbc driver. And sadly there are those drivers that allow neither setObject with null, nor setNull without type and even the possible types for setNull are different.  So the code fails, yes, but not really because of a bug in Groovy itself. &lt;/p&gt;</comment>
                            <comment id="14465573" author="nicolasb" created="Wed, 5 Nov 2008 19:55:26 +0000"  >&lt;p&gt;Ok, everything is clear now. As an alternative, I tried the normal format similar to the following and now works.&lt;/p&gt;

&lt;p&gt;sql.execute &quot;insert into test (A,B) values (${a},${b})&quot; &lt;/p&gt;

&lt;p&gt;Thanks a lot Jochen.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12813776">GROOVY-2146</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2crhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>