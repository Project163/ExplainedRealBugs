<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:03:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-1637] String minus() fails in case of regex chars in operand [minor breaking change]</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-1637</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The current implementation of String.minus fails if the operand contains regular expression special characters.  The current implementation looks like this:&lt;br/&gt;
 /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Remove a part of a String&lt;br/&gt;
     *&lt;/li&gt;
	&lt;li&gt;@param left  a String&lt;/li&gt;
	&lt;li&gt;@param value a String part to remove&lt;/li&gt;
	&lt;li&gt;@return a String minus the part to be removed&lt;br/&gt;
     */&lt;br/&gt;
    public static String minus(String left, Object value) 
{
        String text = toString(value);
        return left.replaceFirst(text, &quot;&quot;);
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I would suggest to escape all regex special characters in the &quot;text&quot; String or to choose a different implementation.&lt;br/&gt;
Examples of wrong or strange behaviour:&lt;br/&gt;
groovy&amp;gt; println &quot;asd&quot; - &quot;a&lt;br class=&quot;atl-forced-newline&quot; /&gt;c&quot;&lt;br/&gt;
groovy&amp;gt; go&lt;br/&gt;
Caught: java.util.regex.PatternSyntaxException: Illegal control escape sequence near index 2&lt;br/&gt;
a\c&lt;br/&gt;
  ^&lt;br/&gt;
        at gjdk.java.lang.String_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
        at CommandLine.run(CommandLine.groovy:1)&lt;/p&gt;

&lt;p&gt;groovy&amp;gt;  println &quot;should_not_match_but_matches&quot;-&quot;should_...&lt;em&gt;match&lt;/em&gt;&quot;&lt;br/&gt;
groovy&amp;gt; go&lt;br/&gt;
but_matches&lt;/p&gt;

&lt;p&gt;groovy&amp;gt; println &quot;asd&quot;-&quot;a&lt;br class=&quot;atl-forced-newline&quot; /&gt;ud&quot;&lt;br/&gt;
groovy&amp;gt; go&lt;br/&gt;
Caught: java.util.regex.PatternSyntaxException: Illegal Unicode escape sequence near index 4&lt;br/&gt;
a\ud&lt;br/&gt;
    ^&lt;br/&gt;
        at gjdk.java.lang.String_GroovyReflector.invoke(Unknown Source)&lt;br/&gt;
        at CommandLine.run(CommandLine.groovy:1)&lt;/p&gt;
</description>
                <environment>all</environment>
        <key id="12813481">GROOVY-1637</key>
            <summary>String minus() fails in case of regex chars in operand [minor breaking change]</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ace">Andreas Sahlbach</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Jan 2007 14:10:48 +0000</created>
                <updated>Fri, 25 Jan 2008 11:34:21 +0000</updated>
                            <resolved>Fri, 25 Jan 2008 11:34:21 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.5.2</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                                                            <comments>
                            <comment id="14462449" author="ace" created="Thu, 4 Jan 2007 14:19:42 +0000"  >&lt;p&gt;hmm...some of my examples above are messed up, because Jira replaces my double-backslashes with newlines. So here they come again:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;groovy&amp;gt; println &quot;asd&quot; - &quot;a\\c&quot;
groovy&amp;gt; go
Caught: java.util.regex.PatternSyntaxException: Illegal control escape sequence near index 2
a\c
^
at gjdk.java.lang.String_GroovyReflector.invoke(Unknown Source)
at CommandLine.run(CommandLine.groovy:1)

groovy&amp;gt; println &quot;should_not_match_but_matches&quot;-&quot;should_...match&quot;
groovy&amp;gt; go
but_matches

groovy&amp;gt; println &quot;asd&quot;-&quot;a\\ud&quot;
groovy&amp;gt; go
Caught: java.util.regex.PatternSyntaxException: Illegal Unicode escape sequence near index 4
a\ud
^
at gjdk.java.lang.String_GroovyReflector.invoke(Unknown Source)
at CommandLine.run(CommandLine.groovy:1)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14477697" author="paulk" created="Sat, 29 Dec 2007 20:18:58 +0000"  >&lt;p&gt;Now escapes regex meta-characters.&lt;/p&gt;</comment>
                            <comment id="14464078" author="jimwhite" created="Sun, 13 Jan 2008 10:43:12 +0000"  >&lt;p&gt;I just found this issue because of a report by a user discovering the unexpected regex behavior of minus(String, Object).&lt;/p&gt;

&lt;p&gt;I object to making a breaking change to the behavior of this (or any) public API at a bug fix release level (like 1.5.2).  At a minimum this type of change must wait until a minor release like 1.6.&lt;/p&gt;

&lt;p&gt;But I&apos;m not sure I&apos;d agree with this change at all.  I do agree that this behavior is at first a surprise, but I suspect the original implementor intended this and it is consistent with Groovy&apos;s support of regex.  Certainly it has been this way since 1.0 and is documented (although the &quot;see also&quot; makes the assumption that  the reader is a Java expert or will click the link).&lt;/p&gt;

&lt;p&gt;I do believe the documentation should be updated to make the current behavior clearer.  And if it were to change in the future, then the release notes are going to need to make a big notice about this breaking change.&lt;/p&gt;

&lt;p&gt;And lastly, if you&apos;re gonna yank the regex behavior, don&apos;t use String.replaceFirst at all since it is the worst possible performance (quote a regex pattern, compile the pattern, then do regex replacement)!  If you want to string literal replacement you use String.indexOf(String).&lt;/p&gt;</comment>
                            <comment id="14464192" author="paulk" created="Mon, 14 Jan 2008 06:56:40 +0000"  >&lt;p&gt;In Groovy 1.0, the Javadoc made no mention of the regex-style handling under the covers for the DGM#minus(String, Object) method (nor did GinA as far as I can find). In 1.5.0 and 1.5.1, the Javadoc is not very clear but mentions this regex behavior. We should clarify this doco in 1.5.2 if we can. The proposed behavior for 1.6.0 is that if the remove target is a pattern, regex-like behavior will occur. If target is not a pattern, the text will simply be literally removed from the String. This results in the following behavior:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;abcda.ce&apos;&lt;/span&gt; - /a.c/ == &lt;span class=&quot;code-quote&quot;&gt;&apos;abcde&apos;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;abcda.ce&apos;&lt;/span&gt; - ~/a.c/ == &lt;span class=&quot;code-quote&quot;&gt;&apos;da.ce&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14477736" author="paulk" created="Mon, 14 Jan 2008 06:58:43 +0000"  >&lt;p&gt;Reopened until we decide what to do for 1.5.2/1.6. For 1.5.2 we need at least some doco/clarification and not merge any 1.6 only behavior on to that branch.&lt;/p&gt;</comment>
                            <comment id="14477812" author="paulk" created="Thu, 17 Jan 2008 06:57:03 +0000"  >&lt;p&gt;Leaving this issue to cover just the 1.5.2 case, the 1.6 case is now covered in a subtask.&lt;br/&gt;
Just to summarize options at this stage:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;leave code on branch as is but remove misleading &apos;@see String#replaceFirst(String,String)&apos; from javadoc as this is unintentionally leaking implementation (update this issue as won&apos;t fix for 1.5.2 - leaves desired behavior ambiguous for 1.5.x)&lt;/li&gt;
	&lt;li&gt;include r10049 and r10349 on branch (close this issue - minor breaking change will be noted in release notes - another minor breaking change will be noted in 1.6 release notes)&lt;/li&gt;
	&lt;li&gt;include r10350 on branch (builds on previous two which will also be added) (close this issue - minor breaking change will be noted in release notes and 1.5.2 behavior will be aligned with 1.6+ behavior). This is my preferred solution.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14464212" author="oarmand" created="Mon, 21 Jan 2008 12:33:36 +0000"  >&lt;p&gt;Browsing those patches, I found that  &lt;em&gt;RegexUtils.quote&lt;/em&gt; seems to have an incorrect behavior in some cases.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(RegexUtils.quote(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;// ouputs \Q\\E
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(RegexUtils.quote(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\\\E&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;// outputs \Q\\E\\E\Q\E&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14464186" author="jimwhite" created="Mon, 21 Jan 2008 14:01:15 +0000"  >&lt;p&gt;Those are the same results as Pattern.quote:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;monospaced&lt;/tt&gt;&lt;br/&gt;
import java.util.regex.Pattern&lt;/p&gt;

&lt;p&gt;assert Pattern.quote(&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;) == /\Q&lt;br class=&quot;atl-forced-newline&quot; /&gt;E/&lt;br/&gt;
assert Pattern.quote(&apos;\\\\E&apos;) == /\Q\\E\\E\Q\E/&lt;/p&gt;

&lt;p&gt;println Pattern.quote(&apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;)&lt;br/&gt;
println Pattern.quote(&quot;\\\\E&quot;)&lt;br/&gt;
&lt;tt&gt;monospaced&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;And speaking of RegexUtils it also needs to implement quoteReplacement for Matcher.quoteReplacement.  But I guess that&apos;s for another JIRA...&lt;/p&gt;</comment>
                            <comment id="14464225" author="oarmand" created="Mon, 21 Jan 2008 15:00:15 +0000"  >&lt;p&gt;You&apos;re right, forget my comment.&lt;/p&gt;</comment>
                            <comment id="14464252" author="guillaume" created="Fri, 25 Jan 2008 11:34:21 +0000"  >&lt;p&gt;Should be fixed after the merge of trunk into the branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12814030">GROOVY-2511</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bp0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>