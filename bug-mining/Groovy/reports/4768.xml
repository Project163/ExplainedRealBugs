<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:23:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-11117] return first nested interface when GroovyClassLoader.parseClass parse interfaces with nested interfaces</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-11117</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When I have a groovy file:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; A {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; B { }
&#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; C { }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I use classLoader to parse this file, I only get the interface &lt;tt&gt;B&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; gcl = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GroovyClassLoader()
&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; just get the &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; B, Something Do I missed?
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; loadedClass = gcl.parseClass(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;xxxx&quot;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;my version:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;jdk:18.0.1&lt;/li&gt;
	&lt;li&gt;groovy: 4.0.2&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13541881">GROOVY-11117</key>
            <summary>return first nested interface when GroovyClassLoader.parseClass parse interfaces with nested interfaces</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="shihai1991">Hai Shi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jun 2023 04:00:00 +0000</created>
                <updated>Tue, 5 Mar 2024 01:53:28 +0000</updated>
                            <resolved>Sun, 14 Jan 2024 20:49:53 +0000</resolved>
                                                    <fixVersion>5.0.0-alpha-5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17738644" author="blackdrag" created="Thu, 29 Jun 2023 16:39:28 +0000"  >&lt;p&gt;parseClass is made to return a single class, in most cases a script. If you want to use GroovyClassLoader for this you could extend it by overriding createClassCollector to return a modified ClassCollector in which onClassNode is overwritten, then you can keep a complete list.&lt;/p&gt;</comment>
                            <comment id="17738845" author="JIRAUSER301127" created="Fri, 30 Jun 2023 01:53:23 +0000"  >&lt;p&gt;Thanks for your comment.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt; parseClass is made to return a single class, in most cases a script.&lt;/p&gt;

&lt;p&gt;If this function is limited in parsing single class, I guess the docs should be updated or throw a exception when we using this function to parse the single class.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt; If you want to use GroovyClassLoader for this you could extend it by overriding createClassCollector to return a modified ClassCollector in which onClassNode is overwritten, then you can keep a complete list.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for your suggestion. I will try this idea.&lt;/p&gt;</comment>
                            <comment id="17739848" author="JIRAUSER301127" created="Tue, 4 Jul 2023 08:56:11 +0000"  >&lt;p&gt;&amp;gt; Thanks for your suggestion. I will try this idea.&lt;/p&gt;

&lt;p&gt;This suggestion can help me collect the nested class/interface. But it will import another issue: import wrong modules when I run another scripts.&lt;/p&gt;

&lt;p&gt;I got this error info:&lt;/p&gt;

&lt;p&gt;Caused by: groovy.lang.MissingPropertyException: No such property&lt;/p&gt;

&lt;p&gt;Because in the running script, I want import interfaceA, but the interfaceA is interfaceA.$interfaceSubA in fact. So I can&apos;t get the right module.&lt;/p&gt;</comment>
                            <comment id="17740056" author="blackdrag" created="Wed, 5 Jul 2023 07:32:28 +0000"  >&lt;p&gt;Could you maybe describe your use-case a bit more? I have the feeling that GroovyClassLoader is not the right place for you.&lt;/p&gt;</comment>
                            <comment id="17780227" author="JIRAUSER301127" created="Fri, 27 Oct 2023 08:15:44 +0000"  >&lt;p&gt;Sorry for my delayed reply:&lt;/p&gt;

&lt;p&gt;My use case: We use the interface or the sub-interface to define some common objects which can be used in DSL. We use groovy&apos;s DSL ability to describe our software architecture, so there have many common objects and sub-objects: apis, dbs, and so on.&lt;/p&gt;</comment>
                            <comment id="17806497" author="emilles" created="Sun, 14 Jan 2024 17:06:40 +0000"  >&lt;p&gt;&lt;tt&gt;AstBuilder#visitClassDeclaration&lt;/tt&gt; is doing this when it parses source.  In your case, the outer class is an interface so it is not added to &lt;tt&gt;classNodeList&lt;/tt&gt; until after its body is processed, so the inner class is added first.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// we put the &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;already in output to avoid the most &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; classes
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// will be used as first &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;later in the loader. The first class
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// there determines what GCL#parseClass &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; example will &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;, so we
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// have here to ensure it won&apos;t be the &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; class
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (asBoolean(ctx.CLASS()) || asBoolean(ctx.TRAIT())) {
            classNodeList.add(classNode);
        }

        classNodeStack.push(classNode);
        ctx.classBody().putNodeMetaData(CLASS_DECLARATION_CLASS_NODE, classNode);
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.visitClassBody(ctx.classBody());
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isRecord) {
            classNode.getFields().stream().filter(f -&amp;gt; !isTrue(f, IS_RECORD_GENERATED) &amp;amp;&amp;amp; !f.isStatic()).findFirst()
                    .ifPresent(fn -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.createParsingFailedException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Instance field is not allowed in `record`&quot;&lt;/span&gt;, fn));
        }
        classNodeStack.pop();

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(asBoolean(ctx.CLASS()) || asBoolean(ctx.TRAIT()))) {
            classNodeList.add(classNode);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17806549" author="emilles" created="Sun, 14 Jan 2024 20:49:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/1fe3186a5927d18ed4eb110887d522ff71529637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/1fe3186a5927d18ed4eb110887d522ff71529637&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17806613" author="JIRAUSER301127" created="Mon, 15 Jan 2024 03:59:29 +0000"  >&lt;p&gt;Get it. Thanks, Eric.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>groovy</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1iv3s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>