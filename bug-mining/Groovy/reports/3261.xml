<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:56:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8186] Builder ExternalStrategy constructors have trouble with private fields</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8186</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;An undocumented feature of @Builder is that the builder&apos;s constructor can set default values for the fields. See &lt;a href=&quot;http://stackoverflow.com/questions/35066664/default-values-in-groovy-builder-ast&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/35066664/default-values-in-groovy-builder-ast&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I tried creating an ExternalStrategy @Builder annotation for &lt;a href=&quot;http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/client/BaseClientDetails.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BaseClientDetails&lt;/a&gt; with a constructor that set a default scope. I received a MissingMethodException exception, which I thought was odd.&lt;/p&gt;

&lt;p&gt;I added some tests to BuilderTransformTest that demonstrate apparent problems using the external builder in two situations:&lt;br/&gt;
1) A groovy class with private fields and manually defined setters.&lt;br/&gt;
2) A java class with a private Set field and a setter that takes a Collection&lt;/p&gt;

&lt;p&gt;The tests are here: &lt;a href=&quot;https://github.com/jterhune/groovy/commit/5b2eb74cc8184235b5235b7fd4c80b241799bbc5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jterhune/groovy/commit/5b2eb74cc8184235b5235b7fd4c80b241799bbc5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I noticed this in 2.4.x. My tests fail in the 2.5.x branch also.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13071298">GROOVY-8186</key>
            <summary>Builder ExternalStrategy constructors have trouble with private fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="jktw">Jason Terhune-Wold</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 May 2017 18:51:15 +0000</created>
                <updated>Tue, 6 Mar 2018 23:25:48 +0000</updated>
                            <resolved>Tue, 29 Aug 2017 06:22:04 +0000</resolved>
                                    <version>2.4.x</version>
                    <version>2.5.x</version>
                                    <fixVersion>2.5.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16009898" author="paulk" created="Mon, 15 May 2017 01:19:34 +0000"  >&lt;p&gt;For case (1), which is when the builder class and buildee class are in the same compilation unit, you are correct that JavaBean properties aren&apos;t considered, just standard Groovy properties. We probably should change this. I suspect what we do for &lt;tt&gt;@ToString&lt;/tt&gt;, where the underlying transform calls &lt;tt&gt;BeanUtils.getAllProperties&lt;/tt&gt; to get the complete set of properties, is the way to go.&lt;/p&gt;

&lt;p&gt;For case (2), it isn&apos;t really Groovy vs Java but whether the class is pre-compiled or not. When pre-compiled, &lt;tt&gt;@Builder&lt;/tt&gt; uses standard JavaBean introspection to find the properties. If the parameter type of the setter doesn&apos;t match with the return type of the getter, the property is deemed read-only from a JavaBean perspective (and there just happens to be a setter-like named method also existing with a different parameter type):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def personClass = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GroovyShell().evaluate &apos;&apos;&apos;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;GroovyPerson {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; pets
    &lt;span class=&quot;code-comment&quot;&gt;//Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getPets() { pets }
&lt;/span&gt;    Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getPets() { pets }
    &lt;span class=&quot;code-comment&quot;&gt;//void setPets(Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; pets) {
&lt;/span&gt;    void setPets(Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; pets) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.pets = pets == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? Collections.emptySet() : &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedHashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;(pets)
    }
}
GroovyPerson
&apos;&apos;&apos;
java.beans.Introspector.getBeanInfo(personClass).propertyDescriptors.each { pd -&amp;gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (![&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;metaClass&apos;&lt;/span&gt;].contains(pd.name))
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;$pd.name $pd.propertyType.name $pd.writeMethod&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The null &lt;tt&gt;writeMethod&lt;/tt&gt; indicates a read-only property. Uncomment either of the commented out lines (and remove the appropriate existing line) to see the property reappear.&lt;br/&gt;
I suspect we don&apos;t want to change that but I haven&apos;t checked what case (1) does in that situation yet - if we were to fix it as per above.&lt;/p&gt;</comment>
                            <comment id="16020639" author="githubbot" created="Tue, 23 May 2017 04:18:59 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/547&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/547&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8186&quot; title=&quot;Builder ExternalStrategy constructors have trouble with private fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8186&quot;&gt;&lt;del&gt;GROOVY-8186&lt;/del&gt;&lt;/a&gt;: Builder ExternalStrategy constructors have trouble with &#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;private fields&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/groovy&lt;/a&gt; groovy8186&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/547.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/547.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #547&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fa56fca09203e1e70963a79d309a55a058d439f6&lt;br/&gt;
Author: paulk &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2017-05-23T04:17:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8186&quot; title=&quot;Builder ExternalStrategy constructors have trouble with private fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8186&quot;&gt;&lt;del&gt;GROOVY-8186&lt;/del&gt;&lt;/a&gt;: Builder ExternalStrategy constructors have trouble with private fields&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16144805" author="githubbot" created="Tue, 29 Aug 2017 06:17:58 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/547&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/547&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16144812" author="paulk" created="Tue, 29 Aug 2017 06:22:04 +0000"  >&lt;p&gt;I extended the proposed PR to handle both ExternalStrategy and DefaultStrategy and merged it. Thanks for the suggestion.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3euwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>