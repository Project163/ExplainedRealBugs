<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:11:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3311] NPE on Groovy 1.6-RC2: Cannot invoke method times() on null object</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3311</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code breaks Groovy 1.6 with NPE, while passes fine on Groovy 1.5.7:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;br/&gt;
--------- test.gr --------------&lt;br/&gt;
public class Day extends Date {&lt;/p&gt;

&lt;p&gt;    static sdf = new java.text.SimpleDateFormat(&quot;dd.MM.yyyy&quot;)&lt;/p&gt;

&lt;p&gt;    public static Day get(_date) &lt;/p&gt;
{
        return new Day(sdf.parse(_date))
    }

&lt;p&gt;    def hours = []&lt;/p&gt;

&lt;p&gt;    public Day(Date _date) {&lt;br/&gt;
        super(_date.time)&lt;br/&gt;
        def time = getTime()&lt;br/&gt;
        24.times &lt;/p&gt;
{
            hour -&amp;gt;
            hours &amp;lt;&amp;lt; new Date(time + hour*1000*60*60)
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;    public String toString() &lt;/p&gt;
{
        sdf.format(this)
    }

&lt;p&gt;    static def period = (1..3).toList().collect { get &quot;1${it}.11.2007&quot; }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;println new Day(new Date())&lt;br/&gt;
--------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/code&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; groovy-1.6-RC2/bin/groovy test.gr&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caught: java.lang.ExceptionInInitializerError&lt;br/&gt;
java.lang.ExceptionInInitializerError&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Class.java:169)&lt;br/&gt;
. . .&lt;br/&gt;
Caused by: java.lang.NullPointerException: Cannot invoke method times() on null object&lt;br/&gt;
	at org.codehaus.groovy.runtime.NullObject.invokeMethod(NullObject.java:77)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokePogoMethod(InvokerHelper.java:743)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:720)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.NullCallSite.call(NullCallSite.java:17)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:43)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:124)&lt;br/&gt;
	at Day.&amp;lt;init&amp;gt;(test.gr:14)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
. . .	&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/code&amp;#93;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12817974">GROOVY-3311</key>
            <summary>NPE on Groovy 1.6-RC2: Cannot invoke method times() on null object</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="san">Alexander Kleymenov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Jan 2009 02:39:43 +0000</created>
                <updated>Thu, 12 Feb 2009 03:35:32 +0000</updated>
                            <resolved>Sat, 31 Jan 2009 08:51:06 +0000</resolved>
                                    <version>1.6-beta-2</version>
                    <version>1.6-rc-1</version>
                    <version>1.6-rc-2</version>
                                    <fixVersion>1.6-rc-3</fixVersion>
                    <fixVersion>1.6.1</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14466399" author="blackdrag" created="Mon, 26 Jan 2009 09:00:29 +0000"  >&lt;p&gt;the code can be reduced to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Day  {
  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; period = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Day()
  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; period2 = 24
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Day() {
   println 24
  }
}
println Day.period2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; If you execute the above, then you will get the output that 24 is first null and then the normal 24. I assume that since we use predefined constants in static fields, that the constant is not initialized when period gets its value. But something prevents period2 from getting null too. Either that number is not cached in a field or some special ordering happens.&lt;/p&gt;</comment>
                            <comment id="14466401" author="roshandawrani" created="Fri, 30 Jan 2009 10:43:06 +0000"  >&lt;p&gt;Looks like an ordering related thing, which even Java suffers from (or may be it is as designed). The code in the groovy example above (Day class) becomes equivalent of this Java code because of synthetic constant fields introduced by Groovy compiler for numbers/characters.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Main {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args){
    	Test t2 = Test.t; &lt;span class=&quot;code-comment&quot;&gt;// trigger the &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; code&apos;s execution in Test class
&lt;/span&gt;    }
}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Test {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Test t = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Test();
	&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; f = 1;
	Test() {
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(f); &lt;span class=&quot;code-comment&quot;&gt;//prints 0 and not 1
&lt;/span&gt;	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14466358" author="roshandawrani" created="Fri, 30 Jan 2009 10:49:00 +0000"  >&lt;p&gt;The de-compiled code for the Day class in the example provided looks like below, which is similar to Java example above:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Day &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; GroovyObject {
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; period;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Day()
  {
    ....
    println($&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt;$0);
    ....
  }

  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;
  {
     Day.period = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Day();
     $&lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt;$0 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;(24); &lt;span class=&quot;code-comment&quot;&gt;// constant is getting set only now but used in the constructor call invoked above
&lt;/span&gt;     ...
  }
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14466347" author="blackdrag" created="Fri, 30 Jan 2009 11:08:51 +0000"  >&lt;p&gt;normally the static intializer is run before the constructor can be invoked, But in this case here the static initializer runs the constructor. The compiler has to ensure that all constants are intialized by that time. so changing the order should solve the problem&lt;/p&gt;</comment>
                            <comment id="14466369" author="roshandawrani" created="Fri, 30 Jan 2009 11:13:39 +0000"  >&lt;p&gt;Yes, changing the order should solve the problem. &lt;/p&gt;

&lt;p&gt;Out of curiosity, what is the use of creating synthetic fields for such numbers/characters used in groovy classes? Do they help much somewhere?&lt;/p&gt;</comment>
                            <comment id="14466464" author="blackdrag" created="Fri, 30 Jan 2009 12:20:32 +0000"  >&lt;p&gt;think of code like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;1000.times {
  i = 24
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;before that change we created 1000 Integer instances with the value 24. Now we reuse 1 instance and do a simple assignment here. So it can improve performance very much&lt;/p&gt;</comment>
                            <comment id="14466357" author="roshandawrani" created="Sat, 31 Jan 2009 08:51:06 +0000"  >&lt;p&gt;I have fixed on 1.6.1 and 1.7-beta-1.&lt;/p&gt;

&lt;p&gt;IMO, it should be fixed on 1.6 too. It would seem silly if (24 != null) didn&apos;t evaluate to true in the latest groovy in the usage below, which is not very uncommon.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy3311Bug &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; GroovyTestCase  {
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; period = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Groovy3311Bug()
    def Groovy3311Bug() {
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; (24 != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
    }

    def void testStaticInit() {
        println Groovy3311Bug.class / trigger the &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; init
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14466402" author="guillaume" created="Sat, 31 Jan 2009 11:50:05 +0000"  >&lt;p&gt;Yes, you&apos;re right, I agree, this is the kind of bug that deserves being committed to our new 1.6.0 branch.&lt;/p&gt;</comment>
                            <comment id="14466438" author="roshandawrani" created="Sat, 31 Jan 2009 11:51:58 +0000"  >&lt;p&gt;I am not familiar with merging from one branch to another branch. Can I do the usual check-in to 1.6.0 branch?&lt;/p&gt;</comment>
                            <comment id="14466502" author="guillaume" created="Sat, 31 Jan 2009 12:00:39 +0000"  >&lt;p&gt;I must confess I usually rarely use the svn merge command, and instead create patches I reapply to other branches &amp;#8211; not the best practice I guess, but one I&apos;m used to do anyway.&lt;br/&gt;
I think you need a commit after an svn merge anyway, so you should be able to try it safely locally, if I&apos;m not mistaken.&lt;br/&gt;
You may also copy&apos;n paste back the areas where you made changes, as a workaround.&lt;/p&gt;</comment>
                            <comment id="14466419" author="roshandawrani" created="Sat, 31 Jan 2009 12:04:50 +0000"  >&lt;p&gt;I know about the delta code that I applied and I can safely apply it on 1.6.0.&lt;/p&gt;

&lt;p&gt;Shall I go ahead and make this change on 1.6.0 then?&lt;/p&gt;</comment>
                            <comment id="14466489" author="guillaume" created="Sat, 31 Jan 2009 12:20:40 +0000"  >&lt;p&gt;As suggested by Jochen on the list, we should discuss any commit on the mailing-list first.&lt;br/&gt;
So bring that again on the list, and Jochen will confirm if it&apos;s okay.&lt;br/&gt;
But I think we should bring it in 1.6.0 as well.&lt;/p&gt;</comment>
                            <comment id="14466370" author="roshandawrani" created="Sat, 31 Jan 2009 14:55:17 +0000"  >&lt;p&gt;Fixed the issue on 1.6.0 branch too.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 43 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ckf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>