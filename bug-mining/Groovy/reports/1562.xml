<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:22:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4965] shim classes generated incorrectly in 1.8.1 (was fine in 1.8.0) for some static inner-class usages</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4965</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Static inner classes that are imported into Groovy scripts just fine in 1.8 are causing compilation issues in 1.8.1&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;br/&gt;
1) Java class Foo.Bar where Bar is public static within Foo.&lt;br/&gt;
2) Groovy script references the Foo.Bar as a type with an arglist to a method.&lt;/p&gt;

&lt;p&gt;3) Groovy/Maven/Shim compiler puts a $ in the generated Java source name instead of a dot.&lt;/p&gt;

&lt;p&gt;As I said, all that changed between working and not working is the version of Groovy.  This worked in 1.8.0 and at least some recent 1.7.x versions.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12815636">GROOVY-4965</key>
            <summary>shim classes generated incorrectly in 1.8.1 (was fine in 1.8.0) for some static inner-class usages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="paul">Paul Hammant</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2011 12:42:26 +0000</created>
                <updated>Fri, 16 Sep 2011 18:10:35 +0000</updated>
                            <resolved>Fri, 16 Sep 2011 18:08:18 +0000</resolved>
                                    <version>1.8.1</version>
                                    <fixVersion>1.8.2</fixVersion>
                    <fixVersion>1.9-beta-3</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14479670" author="paulk" created="Sun, 7 Aug 2011 04:46:57 +0000"  >&lt;p&gt;I suspect this was fixed as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4939&quot; title=&quot;groovyc compilation problem for return values with generics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4939&quot;&gt;&lt;del&gt;GROOVY-4939&lt;/del&gt;&lt;/a&gt;. Any chance you could try a snapshot, otherwise a better example would be good because the one I just created according to above appears to work in trunk. Thanks.&lt;/p&gt;</comment>
                            <comment id="14471712" author="paul" created="Mon, 8 Aug 2011 11:28:59 +0000"  >&lt;p&gt;I&apos;m, trying to run the Groovy build and it barfs foe me: some plexus classCastException issue, and I&apos;m timing out on this.&lt;/p&gt;

&lt;p&gt;I&apos;ll wait for a formal release of 1.8.2 and report then what it feels like. &lt;/p&gt;</comment>
                            <comment id="14471637" author="paul" created="Mon, 8 Aug 2011 11:37:42 +0000"  >&lt;p&gt;The uploaded 1.8.2-SNAPSHOT (dated 30th July) still exhibits the same defect.&lt;/p&gt;</comment>
                            <comment id="14471669" author="pniederw" created="Mon, 8 Aug 2011 14:25:31 +0000"  >&lt;p&gt;I ran into the same problem when trying to upgrade Gradle to Groovy 1.8. I tried with with latest rev. 22728 (July 30th). Here is the generated method:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;  java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; assertSetContains(org.gradle.api.file.FileCollection set, java.util.Set&amp;lt;java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; filenames, java.lang.Iterable&amp;lt;org.gradle.api.file.FileCollection$AntType&amp;gt; types, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;FileCollection.AntType is an inner enum written in Java. Again notice the &lt;tt&gt;$&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14471606" author="guillaume" created="Mon, 8 Aug 2011 17:26:17 +0000"  >&lt;p&gt;With the following test, I couldn&apos;t reproduce the problem experienced in Gradle, neither with trunk nor 1.8.x:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
 * GROOVY-4965: shim classes generated incorrectly in 1.8.1 (was fine in 1.8.0) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; some &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt;-&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;usages
 * 
 * @author Guillaume Laforge
 */
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;InterfaceInnerEnumUsedAsGenericsParamTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; StringSourcesStubTestCase {

    Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; provideSources() {
        [
                &lt;span class=&quot;code-quote&quot;&gt;&apos;org/gradle/api/file/FileCollection.java&apos;&lt;/span&gt;: &apos;&apos;&apos;
                    &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.gradle.api.file;

                    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; FileCollection {
                        &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; AntType {
                            MatchingTask, FileSet, ResourceCollection
                        }
                    }
                &apos;&apos;&apos;,

                &lt;span class=&quot;code-quote&quot;&gt;&apos;org/gradle/api/tasks/AntBuilderAwareUtil.groovy&apos;&lt;/span&gt;: &apos;&apos;&apos;
                    &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.gradle.api.tasks

                    &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.gradle.api.file.FileCollection

                    &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AntBuilderAwareUtil {
                        &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; def assertSetContains(FileCollection set, Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; filenames, Iterable&amp;lt;FileCollection.AntType&amp;gt; types, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt; = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
                            &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
                        }
                    }
                &apos;&apos;&apos;
        ]
    }

    void verifyStubs() {
        println stubJavaSourceFor(&lt;span class=&quot;code-quote&quot;&gt;&apos;org.gradle.api.tasks.AntBuilderAwareUtil&apos;&lt;/span&gt;)
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14471654" author="paul" created="Tue, 9 Aug 2011 09:02:36 +0000"  >&lt;p&gt;I&apos;ve managed to build trunk using ant, commenting out the hanging tests, ignoring the maven-deploy stage, then doing a manual install later.  &lt;/p&gt;

&lt;p&gt;The bug is still there with a TRUNK checkout from moments ago.&lt;/p&gt;

&lt;p&gt;Can someone direct me to the class that writes shim classnames?  I&apos;ll add a .replace(&quot;$&quot;,&quot;.&quot;) where appropriate, and report back.&lt;/p&gt;</comment>
                            <comment id="14471564" author="guillaume" created="Tue, 9 Aug 2011 10:44:06 +0000"  >&lt;p&gt;Hi Paul, you can look at org.codehaus.groovy.tools.javac.JavaStubGenerator.&lt;br/&gt;
And you can look at the printParams() method, which is most probably where the action takes place &amp;#8211; if it&apos;s in the types of the parameters of your methods that the problem arises.&lt;br/&gt;
Ideally, it would be good to have a reproducable test case like the one I pasted in my previous comment, so that we know it won&apos;t happen again once fixed.&lt;/p&gt;</comment>
                            <comment id="14471618" author="paul" created="Tue, 9 Aug 2011 12:42:53 +0000"  >&lt;p&gt;Thanks Guillaume, &lt;/p&gt;

&lt;p&gt;Line 589 or so, genericsTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;.toString() should be genericsTypes&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;.toString().replace(&quot;$&quot;,&quot;.&quot;)&lt;br/&gt;
Either that or reuse/recurse into printType(..) as the  same replacement is done elsewhere in the code, but not for this particular path.&lt;/p&gt;

&lt;p&gt;I can confirm, that my issue with live client code (hence it&apos;s not so easy to share) disappeared.&lt;/p&gt;</comment>
                            <comment id="14471670" author="blackdrag" created="Tue, 9 Aug 2011 12:58:56 +0000"  >&lt;p&gt;Paul, you made me delete a very long comment &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; You are obviously right that printType should be reused here. Can you make a patch that works for you Paul?&lt;/p&gt;</comment>
                            <comment id="14471607" author="paul" created="Tue, 9 Aug 2011 14:17:59 +0000"  >&lt;p&gt;Sounds like y&apos;all are on the cusp of a change that doesn&apos;t lower test coverage &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;However, answering the questions posed in the deleted comment:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;genericsTypes[i].getType().isGenericsGenericsPlaceHolder() is false.
genericsTypes[i].toString() looks like so my.package.MyClass$MyInnerClass
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the one-liner diff, that aims at reuse of existing logic (that does the right thing).  Tested of course:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Index: src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
===================================================================
--- src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java    (revision 22747)
+++ src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java    (working copy)
@@ -589,7 +589,7 @@
         out.print(&apos;&amp;lt;&apos;);
         for (int i = 0; i &amp;lt; genericsTypes.length; i++) {
             if (i != 0) out.print(&quot;, &quot;);
-            out.print(genericsTypes[i].toString());
+            printTypeName(out, genericsTypes[i].getType());
         }
         out.print(&apos;&amp;gt;&apos;);
     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479666" author="paulk" created="Sun, 4 Sep 2011 14:17:35 +0000"  >&lt;p&gt;I have been unable to replicate an error case yet but the latest snapshot (I believe) should have the &quot;replace&quot; patch in place - the &quot;printTypeName&quot; patch broke some other behavior so I didn&apos;t go that way. It would be interesting to see if the latest snapshot fixes your issue.&lt;/p&gt;</comment>
                            <comment id="14471676" author="paul" created="Sun, 4 Sep 2011 16:54:31 +0000"  >&lt;p&gt;close this issue. i moved my inner class to outer.&lt;/p&gt;</comment>
                            <comment id="14471792" author="paulk" created="Fri, 16 Sep 2011 06:09:08 +0000"  >&lt;p&gt;Just waiting feedback from Peter to see if this is still a problem for Gradle. If not I will close the issue.&lt;/p&gt;</comment>
                            <comment id="14471766" author="pniederw" created="Fri, 16 Sep 2011 17:52:15 +0000"  >&lt;p&gt;I eventually worked around it like Paul (converted the nested class to a top-level class). If you are interested, the groovy-1.8 branch of Gradle is available on GitHub.&lt;/p&gt;</comment>
                            <comment id="14471786" author="paulk" created="Fri, 16 Sep 2011 18:08:18 +0000"  >&lt;p&gt;Fix to replace &apos;$&apos; with &apos;.&apos; was added but no test case could reproduce the original problem. Assuming fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cf7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>