<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:54:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8019] Strange performance issue using if(true) versus if(1==1)</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8019</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;While using a Groovy script we came across a strange performance anomaly.  Having the bulk of our script wrapped in an  if( true ){}  statement as opposed to an  if( 1==1 ){}  statement severely degrades performance of the inner part of the script.  Multi-threaded performance is most severely affected.  There appeared to be much more contention running the same script on a 48 core box with the  &quot;if(true)&quot;.  (took about 100x longer to run 48 copies of these scripts on their own threads). &lt;/p&gt;

&lt;p&gt;The curious aspect of this, is that the &apos;if&apos; statement is not in the nested loops, but somehow has negatively affected the compilation / optimization / byte-code.&lt;/p&gt;

&lt;p&gt;Running a Single copy of this script on a 8 core i7 shows quite a performance hit too...  (5000ms vs. 200ms)&lt;/p&gt;

&lt;p&gt;The (effective) code to run the script is as follows...&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	compiledScript = ((Compilable)engine).compile(scriptString);
	result = compiledScript.eval(bindings);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the script...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// $script_engine_name=groovy
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; sum = 0;
&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; m = 1;

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; ) {

	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println( &lt;span class=&quot;code-quote&quot;&gt;&quot;START&quot;&lt;/span&gt;);
	&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; t0 = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();

	&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; j=0; j&amp;lt;1000; j++ ) {
	  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i&amp;lt;100000; i++ ) {
  		sum = sum + i;
  		m = m*i;
	  }
	}

	&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; t1 = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println( &lt;span class=&quot;code-quote&quot;&gt;&quot;END - &quot;&lt;/span&gt; + (t1-t0)+&lt;span class=&quot;code-quote&quot;&gt;&quot;ms&quot;&lt;/span&gt;);
}

&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println( &lt;span class=&quot;code-quote&quot;&gt;&quot;Done: &quot;&lt;/span&gt;+sum+&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;+m );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Groovy Script Engine in a Java app running on Windows 7 and Windows Server 2012</environment>
        <key id="13027236">GROOVY-8019</key>
            <summary>Strange performance issue using if(true) versus if(1==1)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="cwhite102">Craig White</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Dec 2016 03:14:59 +0000</created>
                <updated>Wed, 1 Feb 2017 23:18:44 +0000</updated>
                            <resolved>Sun, 11 Dec 2016 22:21:15 +0000</resolved>
                                    <version>2.4.4</version>
                    <version>2.4.7</version>
                                    <fixVersion>2.4.8</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15740454" author="blackdrag" created="Sun, 11 Dec 2016 22:21:17 +0000"  >&lt;p&gt;the problem was that if an if-block does not contain only optimizable code, it did forbid others (the for-loops here) to be optimized. Now this is no longer the case, thus the performance is much better again and the problem should be solved&lt;/p&gt;</comment>
                            <comment id="15746044" author="cwhite102" created="Tue, 13 Dec 2016 19:37:34 +0000"  >&lt;p&gt;Thanks for the quick investigation!&lt;br/&gt;
I just added Groovy-8020 as there seems to be a similar issue with While() statements that likely wasn&apos;t addressed by the fix here.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13027883">GROOVY-8020</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37g0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>