<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:32:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5449] NullPointerException in compiler when using @Immutable</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5449</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;When using @Immutable with a certain combination of properties, I get a NullPointerException as shown in the stack trace below.&lt;/p&gt;

&lt;p&gt;The most basic way I&apos;ve found to reproduce this is with the two classes.  Note that if I remove the &apos;final&apos; keyword from properties, or don&apos;t include an implementation of toString() in the TestBean class, then the error goes away.&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.codehaus.groovy.ast.CodeVisitorSupport.visitBlockStatement(CodeVisitorSupport.java:35)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitBlockStatement(ClassCodeVisitorSupport.java:179)&lt;br/&gt;
	at org.codehaus.groovy.ast.stmt.BlockStatement.visit(BlockStatement.java:69)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeExpressionTransformer.visitIfElse(ClassCodeExpressionTransformer.java:80)&lt;br/&gt;
	at org.codehaus.groovy.ast.stmt.IfStatement.visit(IfStatement.java:41)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitClassCodeContainer(ClassCodeVisitorSupport.java:102)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitConstructorOrMethod(ClassCodeVisitorSupport.java:113)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeExpressionTransformer.visitConstructorOrMethod(ClassCodeExpressionTransformer.java:50)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitConstructor(ClassCodeVisitorSupport.java:120)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassNode.visitContents(ClassNode.java:1166)&lt;br/&gt;
	at org.codehaus.groovy.ast.ClassCodeVisitorSupport.visitClass(ClassCodeVisitorSupport.java:51)&lt;br/&gt;
	at org.codehaus.groovy.control.OptimizerVisitor.visitClass(OptimizerVisitor.java:49)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit$6.call(CompilationUnit.java:778)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.applyToPrimaryClassNodes(CompilationUnit.java:1122)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.doPhaseOperation(CompilationUnit.java:594)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.processPhaseOperations(CompilationUnit.java:572)&lt;br/&gt;
	at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:549)&lt;br/&gt;
	at org.codehaus.jdt.groovy.internal.compiler.ast.GroovyCompilationUnitDeclaration.processToPhase(GroovyCompilationUnitDeclaration.java:171)&lt;br/&gt;
	at org.codehaus.jdt.groovy.internal.compiler.ast.GroovyCompilationUnitDeclaration.generateCode(GroovyCompilationUnitDeclaration.java:1526)&lt;br/&gt;
	at org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:831)&lt;br/&gt;
	at org.eclipse.jdt.internal.compiler.ProcessTaskManager.run(ProcessTaskManager.java:137)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:680)&lt;/p&gt;</description>
                <environment>Mac OS/X Lion, Java 1.6.0_29</environment>
        <key id="12816215">GROOVY-5449</key>
            <summary>NullPointerException in compiler when using @Immutable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="jans70">Jan Stette</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2012 14:40:59 +0000</created>
                <updated>Sat, 1 Jun 2013 06:11:53 +0000</updated>
                            <resolved>Thu, 25 Apr 2013 08:41:11 +0000</resolved>
                                    <version>1.8.6</version>
                                    <fixVersion>2.1.4</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14479899" author="paulk" created="Mon, 14 May 2012 18:54:26 +0000"  >&lt;p&gt;Can you provide a few more details on how you are invoking the compiler?&lt;/p&gt;

&lt;p&gt;Running the following script in groovyConsole seemed fine:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; bug

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.Immutable

@Immutable &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestBean {
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; OtherBean other
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() { &lt;span class=&quot;code-quote&quot;&gt;&quot;Something&quot;&lt;/span&gt; }
}

@Immutable &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;OtherBean {
    &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Type { One, Two, Three }
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; value
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Type type
}

println &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestBean(&lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OtherBean(30, OtherBean.Type.One))
&lt;span class=&quot;code-comment&quot;&gt;// =&amp;gt; Something&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also, running:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; groovyc bug/TestBean.groovy
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Seemed to work fine using your two source files.&lt;/p&gt;

&lt;p&gt;So far I have just tried Groovy 1.8.6 and Java 1.6.0_31 (32-bit) on Windows.&lt;/p&gt;</comment>
                            <comment id="14472844" author="jans70" created="Tue, 15 May 2012 02:05:35 +0000"  >&lt;p&gt;I was compiling this in Eclipse (3.7,1), using the Groovy plugin (2.6.1.xx-20120301-1000-e37-RELEASE).&lt;/p&gt;</comment>
                            <comment id="14479931" author="paulk" created="Tue, 15 May 2012 03:56:30 +0000"  >&lt;p&gt;Any chance you can also try on the command line or groovyConsole? That would help us narrow down our search. Thanks.&lt;/p&gt;</comment>
                            <comment id="14472771" author="jans70" created="Tue, 15 May 2012 14:30:43 +0000"  >&lt;p&gt;I&apos;ve tried both the command line and groovyConsole as well and they work fine.  But I can still reproduce this consistently when compiling in Eclipse.  I realise now that it&apos;s behaving strangely - when I get the error, I can change something insignificant, i.e. the string returned trom TestBean.toString(), and then the error goes away.  When I try to do another insignificant change and build again, the error happens again.&lt;/p&gt;

&lt;p&gt;Does this mean it&apos;s actually a bug in the groovy plugin&apos;s interaction with the compiler?&lt;/p&gt;

&lt;p&gt;FWIW I have no such problems after changing my classes to use @Canonical instead of @Immutable.&lt;/p&gt;</comment>
                            <comment id="14472879" author="hulabula" created="Tue, 22 May 2012 07:47:57 +0000"  >&lt;p&gt;I&apos;m experiencing the same issue here. Spring STS 2.9, Groovy 1.8.6 and Java 7 (OpenJDK) on Ubuntu.&lt;br/&gt;
Adding @Immutable results in a NullPointerException and Eclipse shows an error in another groovy-class that&apos;s annotated with @ToString and @Validateable (grails).&lt;br/&gt;
Removing @Immutable lets everything work as normal again. Using other annotations (e.g. @Canonical) works fine..&lt;/p&gt;</comment>
                            <comment id="14480118" author="paulk" created="Thu, 17 Jan 2013 15:58:28 +0000"  >&lt;p&gt;Can anyone try with the latest versions of Eclipse/STS? Thanks.&lt;/p&gt;</comment>
                            <comment id="14480226" author="paulk" created="Tue, 26 Mar 2013 05:42:48 +0000"  >&lt;p&gt;Is anyone still facing this problem or should I close it?&lt;/p&gt;</comment>
                            <comment id="14480228" author="paulk" created="Sat, 30 Mar 2013 07:25:41 +0000"  >&lt;p&gt;Please reopen if you can reproduce this error - preferably standalone but with Eclipse if that is the only way. Ideally also with recent versions of Groovy and Eclipse.&lt;/p&gt;</comment>
                            <comment id="14474395" author="youribonnaffe" created="Thu, 25 Apr 2013 08:19:46 +0000"  >&lt;p&gt;It is seems to be reproducible with Groovy Version: 2.1.3 JVM: 1.7.0_21 Vendor: Oracle Corporation OS: Linux&lt;br/&gt;
A sample snippet to reproduce it &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@groovy.transform.Immutable
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Person {
    def name
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It was tested in demo by Guillaume Laforge himself &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14474358" author="melix" created="Thu, 25 Apr 2013 08:41:11 +0000"  >&lt;p&gt;Good catch. The NPE occurred when the type of a field is considered mutable (here, &lt;tt&gt;def&lt;/tt&gt; is &lt;tt&gt;Object&lt;/tt&gt; and the compiler cannot consider it immutable).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12723024" name="OtherBean.groovy" size="168" author="jans70" created="Mon, 14 May 2012 14:41:01 +0000"/>
                            <attachment id="12722918" name="TestBean.groovy" size="195" author="jans70" created="Mon, 14 May 2012 14:41:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c8db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>