<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:08:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2836] Misleading MissingMethodException thrown when this() is called inside a constructor</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2836</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    Foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) {}

    Foo(Date d) {
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;call to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;() must be the first statement of a ctor&quot;&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;(d.toString())
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Date())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the snippet above, I&apos;m calling this() after a println call.&lt;br/&gt;
But in Java, it is mandatory that calls to this() or super() inside a constructor are the first statements of the block.&lt;br/&gt;
Here I get the following stacktrace:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;groovy.lang.MissingMethodException: No signature of method: Foo.call() is applicable &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; argument types: (java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) values: {Fri May 16 23:48:20 CEST 2008}
	at Foo.invokeMethod(Script35)
	at Foo.&amp;lt;init&amp;gt;(Script35:6)
	at Script35.run(Script35:10)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The compiler should check that calls to this() or super() are done as the first statement, and not afterwards.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12814194">GROOVY-2836</key>
            <summary>Misleading MissingMethodException thrown when this() is called inside a constructor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="guillaume">Guillaume Sauthier</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 May 2008 16:54:32 +0000</created>
                <updated>Tue, 23 Dec 2008 05:58:05 +0000</updated>
                            <resolved>Wed, 3 Dec 2008 22:11:26 +0000</resolved>
                                    <version>1.5.6</version>
                    <version>1.6-beta-1</version>
                                    <fixVersion>1.6-rc-1</fixVersion>
                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                    <component>command line processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14465845" author="roshandawrani" created="Tue, 2 Dec 2008 14:59:56 +0000"  >&lt;p&gt;(This bug was work in progress and also I haven&apos;t yet gone through the new guidelines, so just attaching the patches one more time.)&lt;/p&gt;

&lt;p&gt;Attaching the patches for versions 1.5.8, 1.6-RC-1, 1.7-beta-1. One existing testcase also needed to be patched as it was in conflict with the requirement of this JIRA.&lt;/p&gt;

&lt;p&gt;The fix done is &quot;throwing a compilation error when this(..) / super(..) when not on 1st statement&quot;&lt;/p&gt;

&lt;p&gt;&quot;groovy.g&quot; makes sure that constructor calls on first statement (this(..) / super(..)) are captured explicitly by marking their AST node types as CTOR_CALL / SUPER_CTOR_CALL. Later, AntlrParserPlugin converts such captured calls into ConstructorCallExpression.&lt;/p&gt;

&lt;p&gt;But if this(..)/super(..) comes after the first statement, it is turned into a MethodCallExpression representing this.call(..)/super.call(..), which causes failures as noted in the current bug (&quot;No signature of method: Foo.call() is applicable....&quot;).&lt;/p&gt;

&lt;p&gt;The change is made to AntlrParserPlugin.methodCallExpression(), which now rejects the this()/super() kind of calls with a compilation error saying &quot;Constructor call must be the first statement in a constructor.&quot;&lt;/p&gt;

&lt;p&gt;Here is one testcase to show the new behavior:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;void testThisConstructorCallNotOnFirstStmt() {
    def scriptStr = &quot;&quot;&quot;
        &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ThisConstructorCall {
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ThisConstructorCall() {
                println &lt;span class=&quot;code-quote&quot;&gt;&apos;dummy first statement&apos;&lt;/span&gt;
                &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;(19)
            }
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ThisConstructorCall(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; b) {
                println &lt;span class=&quot;code-quote&quot;&gt;&quot;another dummy statement&quot;&lt;/span&gt;
            }
        }
        1
    &quot;&quot;&quot;
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        assertScript scriptStr
        fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;The script compilation should have failed as it calls constructor on 2nd statement&quot;&lt;/span&gt;)
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(MultipleCompilationErrorsException mcee) {
        def text = mcee.toString();
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; text.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;Constructor call must be the first statement in a constructor.&quot;&lt;/span&gt;)
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14465860" author="blackdrag" created="Tue, 2 Dec 2008 15:20:25 +0000"  >&lt;p&gt;your test case is trying to test if something does compile or not.. I suggest you put the test instead in gls.invocation and use CompilableTestSupport. This has a method shouldNotCompile and shouldCompile, both taking Strings containing the script&lt;/p&gt;</comment>
                            <comment id="14465719" author="roshandawrani" created="Tue, 2 Dec 2008 22:08:42 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
    I have moved the new tests into gls/invocation/ConstructorDelegationTest.groovy and am attaching the 3 revised patches.&lt;br/&gt;
rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14465847" author="blackdrag" created="Wed, 3 Dec 2008 08:07:39 +0000"  >&lt;p&gt;looks good to me now... one more small thing, that you don&apos;t have to do for this one... I prefer the style &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;shouldNotCompile &quot;&quot;&quot;
  ...
&quot;&quot;&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;without additional local variable.&lt;/p&gt;</comment>
                            <comment id="14465721" author="roshandawrani" created="Wed, 3 Dec 2008 22:09:57 +0000"  >&lt;p&gt;Updating the fix versions as issue was found in all 3 branches.&lt;/p&gt;</comment>
                            <comment id="14465791" author="roshandawrani" created="Wed, 3 Dec 2008 22:11:26 +0000"  >&lt;p&gt;Fixed the issue by throwing a compilation error if constructor is invoked after 1st statement.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722019" name="Set2_2836Patches.zip" size="3384" author="roshandawrani" created="Tue, 2 Dec 2008 22:08:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cjmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>