<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:18:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2914] LoadConfiguration fails to load *.jar</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2914</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;In my project I have a starter config like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
# load project resources
    load *.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;which causes groovy to fail with the following exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; configuring main &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;loader:
java.lang.StringIndexOutOfBoundsException: &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; index out of range: -1
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.substring(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:1768)
        at org.codehaus.groovy.tools.LoaderConfiguration.loadFilteredPath(LoaderConfiguration.java:193)
        at org.codehaus.groovy.tools.LoaderConfiguration.configure(LoaderConfiguration.java:113)
        at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:81)
        at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This can be fixed in LoaderConfiguration.java as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
  * load a possible filtered path. Filters are defined
  * by using the * wildcard like in any shell
  */
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void loadFilteredPath(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; filter) {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter==&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; starIndex = filter.indexOf(WILDCARD);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (starIndex == -1) {
      addFile(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(filter));
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; recursive = filter.indexOf(ALL_WILDCARD) != -1;
        
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startDir = starIndex == 0 ? &lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt; : filter.substring(0, starIndex - 1);
    File root = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(startDir);

    filter = RegexUtils.quote(filter);
    filter = filter.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;+WILDCARD+&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;+WILDCARD, MATCH_ALL);
    filter = filter.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt; + WILDCARD, MATCH_FILE_NAME);
    Pattern pattern = Pattern.compile(filter);

    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; File[] files = root.listFiles();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (files != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      findMatchingFiles(files, pattern, recursive);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In the above method implementation the line&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startDir = filter.substring(0, starIndex - 1);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which caused the mentioned exception, was changed to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startDir = starIndex == 0 ? &lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt; : filter.substring(0, starIndex - 1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;as you see.&lt;/p&gt;</description>
                <environment>Windows XP, Groovy 1.5.6</environment>
        <key id="12811606">GROOVY-2914</key>
            <summary>LoadConfiguration fails to load *.jar</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="guillaume">Guillaume Sauthier</assignee>
                                    <reporter username="klaus.kopruch@materna.de">Klaus Kopruch</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jun 2008 03:49:53 +0000</created>
                <updated>Thu, 17 Feb 2011 09:06:49 +0000</updated>
                            <resolved>Thu, 17 Feb 2011 09:06:49 +0000</resolved>
                                    <version>1.5.6</version>
                                    <fixVersion>1.8-rc-1</fixVersion>
                    <fixVersion>1.7.9</fixVersion>
                    <fixVersion>1.9-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14478216" author="klaus.kopruch@materna.de" created="Fri, 20 Jun 2008 08:07:07 +0000"  >&lt;p&gt;I&apos;m sorry, I was a little bit too fast with my solution! I just tested my proposed solution and I diagnosed that it only solved the exception, but files are still not loaded from the current directory. So, I build Groovy 1.5.6 using the source distribution (it works extremely simple), inserted the following test case into &lt;tt&gt;LoaderConfigurationTest.groovy&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  void testLoadFilesWithWildcardAtPositionZero() {
    def txt = &lt;span class=&quot;code-quote&quot;&gt;&apos;load *.xml&apos;&lt;/span&gt;
    
    def config = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LoaderConfiguration()
    config.requireMain = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
    config.configure(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringBufferInputStream(txt))
    
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; config.classPathUrls.toString().contains(&lt;span class=&quot;code-quote&quot;&gt;&apos;build.xml&apos;&lt;/span&gt;)  
    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; config.classPathUrls.toString().contains(&lt;span class=&quot;code-quote&quot;&gt;&apos;pom.xml&apos;&lt;/span&gt;)  
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and had to change method &lt;tt&gt;LoaderConfiguration.loadFilteredPath&lt;/tt&gt; in &lt;tt&gt;LoaderConfiguration.java&lt;/tt&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /**
     * load a possible filtered path. Filters are defined
     * by using the * wildcard like in any shell
     */
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void loadFilteredPath(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; filter) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter==&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; starIndex = filter.indexOf(WILDCARD);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (starIndex == -1) {
            addFile(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(filter));
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (starIndex == 0) {
          starIndex = 2;        
          filter = &lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt; + filter;
        }
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; recursive = filter.indexOf(ALL_WILDCARD) != -1;
        
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startDir = filter.substring(0, starIndex - 1);
        File root = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(startDir);

        filter = RegexUtils.quote(filter);
        filter = filter.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;+WILDCARD+&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt;+WILDCARD, MATCH_ALL);
        filter = filter.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt; + WILDCARD, MATCH_FILE_NAME);
        Pattern pattern = Pattern.compile(filter);

        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; File[] files = root.listFiles();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (files != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            findMatchingFiles(files, pattern, recursive);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After that, it was possible to load jar files from the current directory using &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    load */jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;in the starter configuration file.&lt;/p&gt;</comment>
                            <comment id="14478204" author="paulk" created="Mon, 23 Jun 2008 06:05:44 +0000"  >&lt;p&gt;I tried the patch and it seems to work fine. Any objections to me adding this? Or is there some benefit to having a scheme that encourages (forces?) the use of absolute paths?&lt;/p&gt;</comment>
                            <comment id="14478227" author="klaus.kopruch@materna.de" created="Tue, 24 Jun 2008 04:07:01 +0000"  >&lt;p&gt;If I use a project starter conf which comes together with the script(s) and the additional JARs in one directory, it&apos;s helpful to have relative paths as &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;load *.jar&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;On the other hand, for the global starter conf in ${groovy.home}/conf relative paths do not make so much sense.&lt;/p&gt;

&lt;p&gt;Putting it all together, I suggest to allow relative paths in starter conf. Using it in a global starter conf or not, should be left to the decision of the person who installs Groovy on that system.&lt;/p&gt;</comment>
                            <comment id="14465025" author="blackdrag" created="Thu, 26 Jun 2008 09:11:33 +0000"  >&lt;p&gt;I am not sure that this patch does what it should. The code above is clearly designed to use absolute paths only and the change has a small flaw.... The change transforms &quot;&lt;b&gt;.jar&quot; to &quot;./&lt;/b&gt;.jar&quot; and then a pattern will be created, which is more or less like &quot;./&amp;lt;&lt;b&gt;&amp;gt;.jar&quot;, where the &quot;.&quot; are no regexp (because of quote&quot; and &amp;lt;&lt;/b&gt;&amp;gt; is what I used in short for matching a file name. Anyway, what will the filename we use to test this pattern against? Is it safe to assume that new File(&quot;build.xml&quot;) will create a file, with a name like &quot;./build.xml&quot;? Because if this name is not what will be produced, then the pattern is not safe. Instead we would have to create canonical paths and also replace &quot;./&quot; with the conical path for the current directory.. or is there anywhere a specification that File#getPath &lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/io/File.html#getPath(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/io/File.html#getPath(&lt;/a&gt;) will always return the relative path?&lt;/p&gt;</comment>
                            <comment id="14478254" author="klaus.kopruch@materna.de" created="Fri, 27 Jun 2008 04:01:19 +0000"  >&lt;p&gt;Ok, if the original code is designed to use absolute paths only then at first it should be made clear if relative paths should be supported by the load command in the starter config.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If yes, we should specify and test this new feature.&lt;/li&gt;
	&lt;li&gt;If no, we should change &lt;tt&gt;loadFilteredPath()&lt;/tt&gt; in that way that it does not crash with an exception if one types &lt;tt&gt;load *.jar&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14470761" author="blackdrag" created="Thu, 17 Feb 2011 08:31:10 +0000"  >&lt;p&gt;since there is the system property &quot;user.dir&quot; this one can be used to do relative paths. For example ${user.dir}/*.jar. So what is really left here is changing javadoc&lt;/p&gt;</comment>
                            <comment id="14470806" author="guillaume" created="Thu, 17 Feb 2011 09:06:49 +0000"  >&lt;p&gt;Fixed JavaDoc.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c90v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>