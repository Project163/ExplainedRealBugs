<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:53:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7933] Incorrect boxing of boolean primitive types</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7933</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;A boolean primitive type seems to be boxed for no apparent reason. See the example below. The problem disappear when using @CompileStatic or if explicitly casting to (boolean).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void a(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; a){
       &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&quot;&lt;/span&gt;);
   }

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void a(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; a){
       &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; was called&quot;&lt;/span&gt;);
   }

}
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Groovy {
   &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
       def demo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo()
       demo.a(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Output:&lt;/b&gt;&lt;br/&gt;
Object was called&lt;/p&gt;</description>
                <environment></environment>
        <key id="13004164">GROOVY-7933</key>
            <summary>Incorrect boxing of boolean primitive types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jwagenleitner">John Wagenleitner</assignee>
                                    <reporter username="henri">Henri Tremblay</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Sep 2016 17:43:25 +0000</created>
                <updated>Wed, 1 Feb 2017 23:19:05 +0000</updated>
                            <resolved>Sun, 25 Sep 2016 21:15:51 +0000</resolved>
                                    <version>2.4.7</version>
                                    <fixVersion>2.4.8</fixVersion>
                                    <component>groovy-runtime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15483838" author="blackdrag" created="Mon, 12 Sep 2016 11:22:18 +0000"  >&lt;p&gt;I am not able to reproduce this&lt;/p&gt;</comment>
                            <comment id="15484616" author="jwagenleitner" created="Mon, 12 Sep 2016 16:53:48 +0000"  >&lt;p&gt;I am able to reproduce and also find that, as reported, adding CompileStatic or casting makes it pass.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; a) {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&apos;&lt;/span&gt;
   }

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; a) {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; was called&apos;&lt;/span&gt;
   }

   &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args) {
       &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a((&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&apos;&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;//pass
&lt;/span&gt;       &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&apos;&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;//fail
&lt;/span&gt;   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15484673" author="henri" created="Mon, 12 Sep 2016 17:16:39 +0000"  >&lt;p&gt;Great. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jwagenleitner&quot; class=&quot;user-hover&quot; rel=&quot;jwagenleitner&quot;&gt;jwagenleitner&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Do you confirm this is not the intended behavior?&lt;/p&gt;</comment>
                            <comment id="15484960" author="blackdrag" created="Mon, 12 Sep 2016 18:54:12 +0000"  >&lt;p&gt;no idea what went wrong, but now I can reproduce the behaviour. What is to be expected is that if a method call is done and there is an exact matching method to the argument types, that this method is called. so a(true) should call a(boolean) before a(Boolean) and also before a(Object)&lt;/p&gt;</comment>
                            <comment id="15485152" author="joseignacio.acinpozo@gmail.com" created="Mon, 12 Sep 2016 20:11:56 +0000"  >&lt;p&gt;That would be the expected method resolution. In Java.&lt;/p&gt;

&lt;p&gt;Groovy documentation says otherwise, as the method resolution works in different way, because primitives are autowrapped:&lt;br/&gt;
&lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/core-object-orientation.html#_primitive_types&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.groovy-lang.org/latest/html/documentation/core-object-orientation.html#_primitive_types&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/core-differences-java.html#_primitives_and_wrappers&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.groovy-lang.org/latest/html/documentation/core-differences-java.html#_primitives_and_wrappers&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So in Groovy the order for calling &quot;a(true)&quot; should be something like: a(Boolean), a(Object) and last but not least a(boolean).&lt;/p&gt;

&lt;p&gt;You can test this behaviour by extending the code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; a) {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&apos;&lt;/span&gt;
   }

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; a) {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; was called&apos;&lt;/span&gt;
   }

   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; a) {
        &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; was called&apos;&lt;/span&gt;
   }

   &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args) {
       &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a((&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;)&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; was called&apos;&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;//pass
&lt;/span&gt;       &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; was called&apos;&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;//fail
&lt;/span&gt;   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I am happy to be corrected, but I have used Groovy for a long time, and learned this the hard way. If this is actually a bug, then the documentation is very wrong.&lt;/p&gt;
</comment>
                            <comment id="15485196" author="jwagenleitner" created="Mon, 12 Sep 2016 20:26:21 +0000"  >&lt;p&gt;I think the issue here is that in the absence of a method taking Boolean, the call should be unboxed and the &lt;tt&gt;boolean&lt;/tt&gt; method called over the one taking &lt;tt&gt;Object&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15485229" author="jwagenleitner" created="Mon, 12 Sep 2016 20:41:48 +0000"  >&lt;p&gt;It seems to work as expected for all primitives except for &lt;tt&gt;boolean&lt;/tt&gt; and &lt;tt&gt;char&lt;/tt&gt;.  Looks like those primitive types are not taken into account when calculating the method parameter distances which is causing the method taking an &lt;tt&gt;Object&lt;/tt&gt; to be selected first.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/blob/53b99ebb460ae26fd8483bc894cc3703cd7af48f/src/main/org/codehaus/groovy/runtime/MetaClassHelper.java#L206-L231&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/blob/53b99ebb460ae26fd8483bc894cc3703cd7af48f/src/main/org/codehaus/groovy/runtime/MetaClassHelper.java#L206-L231&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Both &lt;tt&gt;boolean&lt;/tt&gt; and &lt;tt&gt;char&lt;/tt&gt; do not seem to be eligible for conversion to other types which may explain why they are missing from the distance table.  But perhaps they should be added and have a distance to the other types set to -1 except for their associated wrapper class and Object or maybe handled specially in the &lt;tt&gt;getPrimitiveDistance(Class from, Class to)&lt;/tt&gt; method so as not to complicate the distance tables.&lt;/p&gt;</comment>
                            <comment id="15485289" author="joseignacio.acinpozo@gmail.com" created="Mon, 12 Sep 2016 21:03:56 +0000"  >&lt;p&gt;Fair enough. &lt;/p&gt;

&lt;p&gt;I always went my way by doing defensive coding to avoid these situations, so seeing now that there are two exceptions for &quot;boolean&quot; and &quot;char&quot; while the rest work correctly feels very confusing. &lt;/p&gt;

&lt;p&gt;I also think this should be documented somewhere very clearly, as the mantra &quot;Groovy uses Objects for everything&quot; is pretty much everywhere in documentation, with special mentions when talking about method resolution and primitives autowrapping. &lt;/p&gt;

&lt;p&gt;If this behaviour is changed to satisfy &quot;boolean&quot; and &quot;char&quot; primitives as well, then, the method resolution should be something like this: a(Boolean) &amp;gt; a(boolean) &amp;gt; a(Object). Primitives like Integer should be something like: a(Integer) &amp;gt; a(int) &amp;gt; a(Number) &amp;gt; a(Object). In summary: Unboxed &amp;gt; Boxed &amp;gt; More concrete subclass or implementation (if any) &amp;gt; Object. Am I correct?&lt;/p&gt;</comment>
                            <comment id="15485343" author="jwagenleitner" created="Mon, 12 Sep 2016 21:29:42 +0000"  >&lt;p&gt;If the methods are called in the same class it works, it&apos;s only when the sender/receiver are different.  So a script like this works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; b) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&apos;&lt;/span&gt; }
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&apos;&lt;/span&gt; }

&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = a(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and one like this fails:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; b) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&apos;&lt;/span&gt; }
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&apos;&lt;/span&gt; }
}
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo().a(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15485443" author="jwagenleitner" created="Mon, 12 Sep 2016 22:10:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;Primitives like Integer should be something like: a(Integer) &amp;gt; a(int) &amp;gt; a(Number) &amp;gt; a(Object). In summary: Unboxed &amp;gt; Boxed &amp;gt; More concrete subclass or implementation (if any) &amp;gt; Object. Am I correct?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For Integer I believe the resolution is:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Integer &amp;gt; int &amp;gt; long &amp;gt; Long &amp;gt; BigInteger &amp;gt; float &amp;gt; Float &amp;gt; double &amp;gt; Double &amp;gt; BigDecimal &amp;gt; Number &amp;gt; Object&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;However, there seems to be a difference between which of the first 2 are resolved (Integer vs int) depending on where the call originates.  For example, if you run the following it will fail in the &lt;tt&gt;test()&lt;/tt&gt; instance method (sender/receiver are the same):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {

    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt; }
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; bigI) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt; }

    void test() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = a(42)
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a(42)
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt;
        
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().test()
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sorry, getting a little off-topic for this particular reported issue, but this doesn&apos;t seem right to me.  This is not just the case for Integer but also for the other boxed primitive types.  It looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7850&quot; title=&quot;Documentation on primitives and wrappers is misleading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7850&quot;&gt;GROOVY-7850&lt;/a&gt; has noted this inconsistency as well.&lt;/p&gt;</comment>
                            <comment id="15485466" author="joseignacio.acinpozo@gmail.com" created="Mon, 12 Sep 2016 22:20:19 +0000"  >&lt;p&gt;Of course, your resolution makes more sense. I was not taking into account the widening possibility, just the boxed/unboxed possibilities for an Integer.&lt;/p&gt;

&lt;p&gt;I think you meant:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&#8203;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Demo {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt; }
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; bigI) { &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt; }

    void test() {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = a(42)
        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt; instead of &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(args) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().a(42)
        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; result == &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&apos;&lt;/span&gt;
        
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Demo().test()
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This behaviour is way too confusing and I wonder how it went unnoticed for so many years, or if there was a real reason indeed for doing it this way and it is just not documented/explained properly.&lt;/p&gt;

</comment>
                            <comment id="15486048" author="henri" created="Tue, 13 Sep 2016 02:50:31 +0000"  >&lt;p&gt;It think it should be fixed indeed. At least for one reason: Right now you have a different behavior between @CompileStatic and interpreted code. That doesn&apos;t make sense.&lt;/p&gt;

&lt;p&gt;On my side, the issue would currently force me to add an overload dedicated to Groovy. Normally, in Java we need `foo(boolean)` and `foo(Object)`. This would also for me to add a `foo(Boolean)` to please Groovy. It seems sad for interoperability.&lt;/p&gt;</comment>
                            <comment id="15486826" author="joseignacio.acinpozo@gmail.com" created="Tue, 13 Sep 2016 09:56:15 +0000"  >&lt;p&gt;This is probably a bit off-topic for this particular issue, but should @CompileStatic and interpreted behaviour actually be different? I think it sort of makes sense as @CompileStatic methods should be chosen at compile time(like Java does) instead of runtime (like Groovy does):&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;http://groovy-lang.org/differences.html#_multi_methods&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy-lang.org/differences.html#_multi_methods&lt;/a&gt; :&lt;/p&gt;

&lt;p&gt;&quot;In Groovy, the methods which will be invoked are chosen at runtime. This is called runtime dispatch or multi-methods. It means that the method will be chosen based on the types of the arguments at runtime. In Java, this is the opposite: methods are chosen at compile time, based on the declared types.&quot;&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/gapi/groovy/transform/CompileStatic.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.groovy-lang.org/latest/html/gapi/groovy/transform/CompileStatic.html&lt;/a&gt; :&lt;/p&gt;

&lt;p&gt;&quot;This will let the Groovy compiler use compile time checks in the style of Java then perform static compilation, thus bypassing the Groovy meta object protocol. When a class is annotated, all methods, properties, files, inner classes, etc. of the annotated class will be type checked.&quot;&lt;/p&gt;

&lt;p&gt;Also more info taken from here &lt;a href=&quot;http://java-performance.info/static-code-compilation-groovy-2-0/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java-performance.info/static-code-compilation-groovy-2-0/&lt;/a&gt; :&lt;/p&gt;

&lt;p&gt;&quot;Both these features are connected, because you need a type inference in order to statically choose the best matching method at compile time. Static type checking allows you to check your Groovy code for type safety as well as for absence of typos in the method/property names.&quot;&lt;/p&gt;

&lt;p&gt;&quot;Static compilation allows Groovy 2.0 to generate direct method calls, which are no longer using Groovy runtime as an intermediary. This feature actually allows you to avoid going into the Groovy runtime for the huge share of methods &#8211; think how many overloaded methods do you usually have in your code &#8211; non-overloaded methods could always be safely converted into the normal method calls.&quot;&lt;/p&gt;</comment>
                            <comment id="15492946" author="blackdrag" created="Thu, 15 Sep 2016 10:22:15 +0000"  >&lt;p&gt;ah... I get a feeling I know the problem this is coming from. when doing a(foo), we may be able to do a direct method call in some cases. If foo is a boolean, then there must be a a(boolean) exist to work. If we do x.a(foo), then this is in dynamic Groovy never a direct call. To relialize the method call foo will be wrapped in an Object[] at some point and the type taken for the dispatch is the one out of this array. Which means foo will be Boolean instead. For Groovy with indy, this is different. Here foo will be the primitive type. And there is also the problem of MOP methods. For example an a(foo) in a Closure. This will cause method dispatch to go through an invokeMethod somewhere, or the MetaClass system, which too takes only an Object[] and not possibly known types from the callsite. So here again a(foo) would prefer a(Boolean). Using a cast helps carrying the information over, but only to the first MetaClass. After that, the information might get lost.&lt;/p&gt;

&lt;p&gt;Not sure what way we should go to fix this. For indy there is actually nothing to fix here, if we ignore the MOP. And I am not sure it is really worth fixing it for non-indy Groovy. &lt;/p&gt;</comment>
                            <comment id="15494232" author="henri" created="Thu, 15 Sep 2016 18:58:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt; But then, if I understand correctly, why does it work with Byte, Integer, Double, Float and Long?&lt;/p&gt;</comment>
                            <comment id="15494474" author="blackdrag" created="Thu, 15 Sep 2016 20:41:27 +0000"  >&lt;p&gt;Actually I think I made a mistake once more in misunderstanding some of the comments here, plus mixing up plans and what is done.. the code part I was thinking of does actually not activate for overloaded methods at all.. I am sorry for causing confusion here.&lt;/p&gt;

&lt;p&gt;Ok, let us first assess again what we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def types = [
  [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt; , &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;], [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;],
  [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;],  [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Short&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;],
  [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;], [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Character&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;&quot;&lt;/span&gt;],
  [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;], [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Float&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;]
]

types.each {
  def code = &quot;&quot;&quot;
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a(${it[0]} a) { 0 }
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a(${it[1]} a) { 1 }
     ${it[0]} val = ${it[2]}
     &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a(val) == 1
  &quot;&quot;&quot;
  println code
  Eval.me code
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this will test all primitives (unless I forgot one) against an overloaded a method with on version taking the primitive and the other the wrapper. In all cases the wrapper version will chosen. This is regardless of if the call is done from the same class or not. That this codes must behave like this, is because of the arguments being wrapped at one point before doing the method selection. And while consistent, it is not what Java would do. @CompileStatic orientates itself more on Java here, since it does not support multi methods of any kind and differs from normal Groovy.&lt;/p&gt;

&lt;p&gt;Now, the more interesting part is that of primitive vs. Object. Now in the method selection algorithm we calculate the distance between argument and parameter type. Let us say going one level in inheritance is a distance of 2, then going from the wrapper to the primitive or from the primitive to the wrapper only 1.  So a call a(1), will be done using an Integer, but the distance to Object is 2, while the distance to int is only 1, resulting in a(int) to be chosen over a(Object).&lt;/p&gt;

&lt;p&gt;And yes, boolean and char behave different, and yes, I consider that wrong. I assume we overlooked them because the code responsible for the half steps is actually only considering widening related types and char and boolean are not taking part in widening. So &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jwagenleitner&quot; class=&quot;user-hover&quot; rel=&quot;jwagenleitner&quot;&gt;jwagenleitner&lt;/a&gt; was absolutely right with &lt;tt&gt;Integer &amp;gt; int &amp;gt; long &amp;gt; Long &amp;gt; BigInteger &amp;gt; float &amp;gt; Float &amp;gt; double &amp;gt; Double &amp;gt; BigDecimal &amp;gt; Number &amp;gt; Object&lt;/tt&gt; though for a call with int, what is supposed to be used is actually &lt;tt&gt;int &amp;gt; Integer &amp;gt; long &amp;gt; Long &amp;gt; BigInteger &amp;gt; float &amp;gt; Float &amp;gt; double &amp;gt; Double &amp;gt; BigDecimal &amp;gt; Number &amp;gt; Object&lt;/tt&gt; and the first chain only applies because of boxing. Since there are no calls with int, but only with Integer, this case actually never happens.&lt;/p&gt;

&lt;p&gt;So, yes, boolean and char behaviour should be fixed&lt;/p&gt;</comment>
                            <comment id="15494628" author="paulk" created="Thu, 15 Sep 2016 21:55:15 +0000"  >&lt;p&gt;Jochen, when you run this, do you get what you expect:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a) { 0 }
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; a(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; a) { 1 }
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; val = 2
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a(val) == 1
def x = a(val)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; x == 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15494827" author="blackdrag" created="Thu, 15 Sep 2016 23:23:32 +0000"  >&lt;p&gt;Paul you are right, something is not quite right. Looking at the byte I see primopts being active in this, thus there exists a call to a(int). The ValueRecorder of the powerassert on the other hand prevents using the primitive directly and then you get the call using Integer. Sigh... So here primopts diverge from indy and normal non-primopts Groovy.&lt;/p&gt;</comment>
                            <comment id="15500336" author="githubbot" created="Sun, 18 Sep 2016 05:49:35 +0000"  >&lt;p&gt;GitHub user jwagenleitner opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/424&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7933&quot; title=&quot;Incorrect boxing of boolean primitive types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7933&quot;&gt;&lt;del&gt;GROOVY-7933&lt;/del&gt;&lt;/a&gt;: fix method selection for boolean and char primitives&lt;/p&gt;

&lt;p&gt;    boolean and char were not factored into the primitive distance tables which&lt;br/&gt;
    would cause methods with Object to be selected in preference to those&lt;br/&gt;
    with boolean/char and their respective Wrapper.&lt;/p&gt;

&lt;p&gt;    Inserted `boolean` and `char` (and their wrappers) in the distance table and kept all distances the same for the existing classes in the table (adding boolean and char as the farthest dist from the existing classes).&lt;/p&gt;

&lt;p&gt;    Had to fix one test because `HashCodeHelper` has overloaded methods and prior to this change it was selecting the method with `Object` instead of `boolean`.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jwagenleitner/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jwagenleitner/groovy&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7933&quot; title=&quot;Incorrect boxing of boolean primitive types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7933&quot;&gt;&lt;del&gt;GROOVY-7933&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/424.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/424.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #424&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 156d3f72db9e80db6f62bdc3829f2d3767c9544e&lt;br/&gt;
Author: John Wagenleitner &amp;lt;jwagenleitner@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-09-18T05:41:06Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7933&quot; title=&quot;Incorrect boxing of boolean primitive types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7933&quot;&gt;&lt;del&gt;GROOVY-7933&lt;/del&gt;&lt;/a&gt;: fix method selection for boolean and char primitives&lt;/p&gt;

&lt;p&gt;    boolean and char were not factored into the primitive distance tables which&lt;br/&gt;
    would cause methods with Object to be selected in preference to those&lt;br/&gt;
    with boolean/char and their respective Wrapper.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15521379" author="githubbot" created="Sun, 25 Sep 2016 20:35:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/424&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15521431" author="jwagenleitner" created="Sun, 25 Sep 2016 21:15:52 +0000"  >&lt;p&gt;Thanks for reporting the issue.&lt;/p&gt;</comment>
                            <comment id="15521683" author="henri" created="Mon, 26 Sep 2016 00:37:32 +0000"  >&lt;p&gt;Awesome. Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33huv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>