<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:23:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8145] Cross-project @Log + static import issue</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8145</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I have discovered a situation in which doing a static import of all members of a class causes a compilation error as the compiler incorrectly infers that the code is attempting to use a private static member on the imported class.&lt;/p&gt;

&lt;p&gt;There appears to be a very specific combination of factors that causes this to occur.  Specifically, the class that&apos;s doing the static import must be statically compiled using the &lt;tt&gt;@CompileStatic&lt;/tt&gt; annotation, and both classes must share a logger variable with the same name from &lt;tt&gt;@Log&lt;/tt&gt; (or &lt;tt&gt;@Slf4j&lt;/tt&gt;, etc.).  Furthermore, the classes cannot be compiled at the same time (for instance, the one could be in a jar or a sub-build in Gradle).&lt;/p&gt;

&lt;p&gt;The following is a specific Gradle example that produces the issue.&lt;/p&gt;

&lt;p&gt;First, the build structure:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;import-static-issue
  src/main/groovy/test
    build.gradle
    settings.gradle
    Importer.groovy
    SameProjectImported.groovy
  subproject
    src/main/groovy/test/DifferentProjectImported.groovy
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the relevant files:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;build.gradle&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;group &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;
version &lt;span class=&quot;code-quote&quot;&gt;&apos;1.0-SNAPSHOT&apos;&lt;/span&gt;

allprojects {
  apply plugin: &lt;span class=&quot;code-quote&quot;&gt;&apos;groovy&apos;&lt;/span&gt;
  apply plugin: &lt;span class=&quot;code-quote&quot;&gt;&apos;java&apos;&lt;/span&gt;

  sourceCompatibility = 1.8

  repositories {
    mavenCentral()
  }

  dependencies {
    compile &lt;span class=&quot;code-quote&quot;&gt;&apos;org.codehaus.groovy:groovy-all:2.4.10&apos;&lt;/span&gt;
  }
}

dependencies {
  compile project(&lt;span class=&quot;code-quote&quot;&gt;&apos;:subproject&apos;&lt;/span&gt;)
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;settings.gradle&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;include &lt;span class=&quot;code-quote&quot;&gt;&apos;subproject&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Importer.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; test

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.util.logging.Log

&lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; test.SameProjectImported.* //Using &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; one instead won&apos;t trigger the issue
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; test.DifferentProjectImported.*

@Log
@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Importer {
  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
    log.info &lt;span class=&quot;code-quote&quot;&gt;&apos;This will cause a compilation failure&apos;&lt;/span&gt;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;SameProjectImported.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; test

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.util.logging.Log

@Log
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SameProjectImported {
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;DifferentProjectImported.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; test

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.util.logging.Log

@Log
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DifferentProjectImported {
  &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; java.util.logging.Logger log // Using &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; instead of @Log will also cause the error
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Compiling this code via Gradle (e.g. &quot;gradle compileGroovy&quot;) produces the following error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/[...]/import-static-issue/src/main/groovy/test/Importer.groovy: -1: Access to test.DifferentProjectImported#log is forbidden @ line -1, column -1.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have confirmed the issue in Groovy 2.4.10.  I have also confirmed that this issue appears to have been present for the whole Groovy 2.x series.&lt;/p&gt;

&lt;p&gt;It doesn&apos;t occur if you manually create the private static field in the importing class instead of using the &lt;tt&gt;@Log&lt;/tt&gt; AST transformation.  It will occur if you manually create the static &quot;log&quot; field in the statically imported class but use &lt;tt&gt;@Log&lt;/tt&gt; in the importing class.  It doesn&apos;t occur if the importing class doesn&apos;t use &lt;tt&gt;@CompileStatic&lt;/tt&gt;.  It doesn&apos;t occur if the importing class and the imported class are in the same Gradle project.  The issue also occurs if you statically import just the &quot;log&quot; field and not &quot;*&quot; (though practically speaking, you should never actually try to do that).&lt;/p&gt;

&lt;p&gt;I ran across this issue when I was migrating some code into a shared library and was statically importing a number of fields for a class that was being moved.  Manually declaring the fields to be statically imported would work, but my IDE settings would fold it back into &quot;*&quot; if the imports are ever optimized for the class, so this isn&apos;t a workable solution for me (if nothing else, it would be supremely confusing for any developers down the road).&lt;/p&gt;

&lt;p&gt;Edit: Upon further investigation, there is a different but related issue if the importing class is not annotated with &lt;tt&gt;@CompileStatic&lt;/tt&gt;.  If it&apos;s not statically compiled, rather than throwing a compilation failure, it will instead use the imported private log variable, not its own.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13061460">GROOVY-8145</key>
            <summary>Cross-project @Log + static import issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="mjjustin">M. Justin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Apr 2017 15:48:37 +0000</created>
                <updated>Tue, 19 Sep 2023 18:27:30 +0000</updated>
                            <resolved>Tue, 11 Jul 2023 17:27:52 +0000</resolved>
                                    <version>2.4.10</version>
                                    <fixVersion>5.0.0-alpha-1</fixVersion>
                                    <component>Compiler</component>
                    <component>Static compilation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17742065" author="emilles" created="Tue, 11 Jul 2023 15:14:24 +0000"  >&lt;p&gt;&lt;tt&gt;StaticImportVisitor&lt;/tt&gt; runs before the &lt;tt&gt;Log&lt;/tt&gt; AST transform (and others).  If it sees &quot;log&quot; in your code it replaces the dynamic variable with &quot;DifferentProjectImported.log&quot;.  This same thing could happen for a field or property of any visibility from the imported class when the local resolution of a name is delayed until after a transform supplies the required element (the &quot;log&quot; field in this case).&lt;/p&gt;</comment>
                            <comment id="17742073" author="emilles" created="Tue, 11 Jul 2023 15:27:32 +0000"  >&lt;p&gt;You can stop the static import substitution by using &quot;this.log&quot; within &lt;tt&gt;Importer&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17742112" author="emilles" created="Tue, 11 Jul 2023 17:27:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/3785147d2f7ae43a994f6949eb4a7fd96b79c66c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/3785147d2f7ae43a994f6949eb4a7fd96b79c66c&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13551264">GROOVY-11180</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3d6uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>