<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:59:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2105] Groovy category support is broken in multi-threaded environment</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2105</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;We&apos;re using Groovy to write controllers in Spring MVC environment. But we often see a &quot;MissingPropertyException&quot;  for ModelAndView.viewName property. We investigated it, and found, that org.codehaus.groovy.runtime.GroovyCategorySupport#categoriesInUse counter was not zero, and we were not using any categories in that line! Thus, Groovy tried to fetch a setter from an object, then from a category, and &amp;lt;as we had no active category at the moment, it got null for the setter, and overwrote the valid setter from real ModelAndView. This behaviour (overriding real setter with null setter from category) was fixed in 1.1 beta. But these were only sympthoms -  the real problem is the counter. It&apos;s incrementing/decrementing methods lack synchronization. There is no synchronization at all!&lt;br/&gt;
The methods in question are org.codehaus.groovy.runtime.GroovyCategorySupport#newScope, org.codehaus.groovy.runtime.GroovyCategorySupport#endScope and org.codehaus.groovy.runtime.GroovyCategorySupport#hasCategoryInAnyThread. Each one uses one static long variable, and it will break almost for sure.&lt;/p&gt;

&lt;p&gt;So, we&apos;ve written a testcase for that. It&apos;s attached to the issue.&lt;br/&gt;
Sometimes we get &lt;br/&gt;
groovy.lang.MissingMethodException: No signature of method: java.lang.String.test() is applicable for argument types: (java.lang.String) values: &lt;/p&gt;
{&quot; bar&quot;}
&lt;p&gt;	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:572)&lt;br/&gt;
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:450)&lt;br/&gt;
	at org.codehaus.groovy.runtime.Invoker.invokeMethod(Invoker.java:119)&lt;br/&gt;
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:111)&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodN(ScriptBytecodeAdapter.java:187)&lt;br/&gt;
	at Test$_run_closure1_closure3_closure4.doCall(Test.groovy:12)&lt;/p&gt;

&lt;p&gt;After adding &quot;synchronized&quot; to these three methods signatures, we got no exceptions.&lt;br/&gt;
This bug is similar to &lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY-1883&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY-1883&lt;/a&gt; , but I have a bit simpler testcase and a patch proposal for that, so I opened one more issue.&lt;/p&gt;</description>
                <environment>Windows XP, jdk 1.5.0_11</environment>
        <key id="12817222">GROOVY-2105</key>
            <summary>Groovy category support is broken in multi-threaded environment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="max.ishchenko">Max Ishchenko</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Sep 2007 08:15:27 +0000</created>
                <updated>Thu, 13 Sep 2007 16:03:17 +0000</updated>
                            <resolved>Thu, 13 Sep 2007 16:03:17 +0000</resolved>
                                    <version>1.0</version>
                    <version>1.1-beta-1</version>
                    <version>1.1-beta-2</version>
                                    <fixVersion>1.1-beta-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14463150" author="blackdrag" created="Thu, 13 Sep 2007 16:03:17 +0000"  >&lt;p&gt;fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721740" name="Test.groovy" size="313" author="max.ishchenko" created="Fri, 7 Sep 2007 08:15:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cnf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>