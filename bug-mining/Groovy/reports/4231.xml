<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:15:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-10314] finally block produces long sequence of nop instructions</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-10314</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Consider the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-groovy&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;def&lt;/span&gt; test() {
  &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    print &lt;span class=&quot;code-quote&quot;&gt;&apos;hello&apos;&lt;/span&gt;
  } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
    print &lt;span class=&quot;code-quote&quot;&gt;&apos; world&apos;&lt;/span&gt;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For any non-void method where the &lt;tt&gt;try&lt;/tt&gt;/&lt;tt&gt;finally&lt;/tt&gt; is part of the return value, a long sequence of &lt;tt&gt;nop&lt;/tt&gt; bytecode instructions is produced. The sample code from &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4721&quot; title=&quot;variable declared in try block is in scope in finally block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4721&quot;&gt;&lt;del&gt;GROOVY-4721&lt;/del&gt;&lt;/a&gt; produces 18 &lt;tt&gt;nop&lt;/tt&gt; in a row.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-comment&quot;&gt;// Method descriptor #42 ()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// Stack: 2, Locals: 3
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; test();
     0  aload_0 [&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;]
     1  ldc &amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;&amp;gt; [47]
     3  invokedynamic 1 invoke(Scratch, java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) : java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; [53]
     8  astore_1
     9  nop
    10  aload_0 [&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;]
    11  ldc &amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot; world&quot;&lt;/span&gt;&amp;gt; [55]
    13  invokedynamic 1 invoke(Scratch, java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) : java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; [53]
    18  pop
    19  nop
    20  aload_1
    21  areturn
    22  nop
    23  nop
    24  athrow
    25  nop
    26  nop
    27  nop
    28  nop
    29  nop
    30  nop
    31  nop
    32  nop
    33  athrow
    34  nop
    35  nop
    36  athrow
    37  astore_2
    38  aload_0 [&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;]
    39  ldc &amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot; world&quot;&lt;/span&gt;&amp;gt; [55]
    41  invokedynamic 1 invoke(Scratch, java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) : java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; [53]
    46  pop
    47  aload_2
    48  athrow
    49  nop
    50  athrow
      Exception Table:
        [pc: 0, pc: 10] -&amp;gt; 37 when : any
        [pc: 20, pc: 22] -&amp;gt; 37 when : any
      Line numbers:
        [pc: 0, line: 3]
        [pc: 10, line: 5]
        [pc: 49, line: 7]
      Local variable table:
        [pc: 0, pc: 49] local: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; index: 0 type: Scratch
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13406901">GROOVY-10314</key>
            <summary>finally block produces long sequence of nop instructions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="emilles">Eric Milles</assignee>
                                    <reporter username="emilles">Eric Milles</reporter>
                        <labels>
                            <label>bytecode</label>
                    </labels>
                <created>Sat, 16 Oct 2021 13:47:02 +0000</created>
                <updated>Thu, 3 Feb 2022 22:32:05 +0000</updated>
                            <resolved>Sat, 16 Oct 2021 20:58:12 +0000</resolved>
                                                    <fixVersion>4.0.0-beta-2</fixVersion>
                                    <component>class generator</component>
                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17429573" author="emilles" created="Sat, 16 Oct 2021 15:03:17 +0000"  >&lt;p&gt;I think ASM has determined these are dead parts of the bytecode and reduced them to &quot;nop ... areturn&quot; or &quot;nop ... athrow&quot;.&lt;/p&gt;</comment>
                            <comment id="17429602" author="daniel_sun" created="Sat, 16 Oct 2021 18:09:18 +0000"  >&lt;p&gt;I compiled the script via groovyc and decompiled with javap, here is what groovyc generated for &lt;tt&gt;test&lt;/tt&gt; method. As we could see, ASM does not optimize the bytecode for us, there are still many &lt;tt&gt;nop&lt;/tt&gt; in the bytecode.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; test();
    descriptor: ()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=2, locals=3, args_size=1
         0: aload_0
         1: ldc           #47                 &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hello
&lt;/span&gt;         3: invokedynamic #53,  0             &lt;span class=&quot;code-comment&quot;&gt;// InvokeDynamic #1:invoke:(LTestGroovy10314;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
&lt;/span&gt;         8: astore_1
         9: nop
        10: aload_0
        11: ldc           #55                 &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;  world
&lt;/span&gt;        13: invokedynamic #53,  0             &lt;span class=&quot;code-comment&quot;&gt;// InvokeDynamic #1:invoke:(LTestGroovy10314;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
&lt;/span&gt;        18: pop
        19: nop
        20: aload_1
        21: areturn
        22: nop
        23: nop
        24: athrow
        25: nop
        26: nop
        27: nop
        28: nop
        29: nop
        30: nop
        31: nop
        32: nop
        33: athrow
        34: nop
        35: nop
        36: athrow
        37: astore_2
        38: aload_0
        39: ldc           #55                 &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;  world
&lt;/span&gt;        41: invokedynamic #53,  0             &lt;span class=&quot;code-comment&quot;&gt;// InvokeDynamic #1:invoke:(LTestGroovy10314;Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;)Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
&lt;/span&gt;        46: pop
        47: aload_2
        48: athrow
        49: nop
        50: athrow
      Exception table:
         from    to  target type
             0    10    37   any
            20    22    37   any
      StackMapTable: number_of_entries = 5
        frame_type = 255 &lt;span class=&quot;code-comment&quot;&gt;/* full_frame */&lt;/span&gt;
          offset_delta = 22
          locals = []
          stack = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java/lang/Throwable ]
        frame_type = 66 &lt;span class=&quot;code-comment&quot;&gt;/* same_locals_1_stack_item */&lt;/span&gt;
          stack = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java/lang/Throwable ]
        frame_type = 72 &lt;span class=&quot;code-comment&quot;&gt;/* same_locals_1_stack_item */&lt;/span&gt;
          stack = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java/lang/Throwable ]
        frame_type = 255 &lt;span class=&quot;code-comment&quot;&gt;/* full_frame */&lt;/span&gt;
          offset_delta = 2
          locals = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestGroovy10314 ]
          stack = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java/lang/Throwable ]
        frame_type = 255 &lt;span class=&quot;code-comment&quot;&gt;/* full_frame */&lt;/span&gt;
          offset_delta = 11
          locals = []
          stack = [ &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java/lang/Throwable ]
      LineNumberTable:
        line 3: 0
        line 5: 10
        line 7: 49
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0      49     0  &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;   LTestGroovy10314;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17429617" author="emilles" created="Sat, 16 Oct 2021 20:58:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/groovy/commit/11d8e65751ae4b6556dd0da13e5997e5ff36e4d7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/commit/11d8e65751ae4b6556dd0da13e5997e5ff36e4d7&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17429621" author="daniel_sun" created="Sat, 16 Oct 2021 21:51:22 +0000"  >&lt;p&gt;Nice&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vwjc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>