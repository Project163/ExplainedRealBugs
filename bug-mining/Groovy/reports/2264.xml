<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:34:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6085] Annotation for inner interface in Java stub should not use dollar notation</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6085</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;From looking at the code, this issue appears to affect all versions after 1.7.3, but I&apos;ve only tested a few.&lt;/p&gt;

&lt;p&gt;As with many other places in the code, printAnnotation needs to replace &apos;$&apos; with &apos;.&apos; in inner interface class names.  Otherwise a &quot;cannot find symbol&quot; error occurs during java compilation.&lt;/p&gt;

&lt;p&gt;In 1.7.4, the patch is:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java b/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
index eff3ac1..7a1e92e 100644
--- a/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
+++ b/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
@@ -591,7 +591,7 @@ public class JavaStubGenerator
     private void printAnnotations(PrintWriter out, AnnotatedNode annotated) {
         if (!java5) return;
         for (AnnotationNode annotation : annotated.getAnnotations()) {
-            out.print(&quot;@&quot; + annotation.getClassNode().getName() + &quot;(&quot;);
+            out.print(&quot;@&quot; + annotation.getClassNode().getName().replace(&apos;$&apos;, &apos;.&apos;) + &quot;(&quot;);
             boolean first = true;
             Map&amp;lt;String, Expression&amp;gt; members = annotation.getMembers();
             for (String key : members.keySet()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In master, it would be:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java b/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
index 1e8f585..42fc5e2 100644
--- a/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
+++ b/src/main/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
@@ -716,7 +716,7 @@ public class JavaStubGenerator {
     }
 
     private void printAnnotation(PrintWriter out, AnnotationNode annotation) {
-        out.print(&quot;@&quot; + annotation.getClassNode().getName() + &quot;(&quot;);
+        out.print(&quot;@&quot; + annotation.getClassNode().getName().replace(&apos;$&apos;, &apos;.&apos;) + &quot;(&quot;);
         boolean first = true;
         Map&amp;lt;String, Expression&amp;gt; members = annotation.getMembers();
         for (String key : members.keySet()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12818232">GROOVY-6085</key>
            <summary>Annotation for inner interface in Java stub should not use dollar notation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="agrimm">Andy Grimm</reporter>
                        <labels>
                    </labels>
                <created>Sun, 7 Apr 2013 19:12:48 +0000</created>
                <updated>Sun, 5 Apr 2015 14:44:18 +0000</updated>
                            <resolved>Thu, 4 Jul 2013 03:12:02 +0000</resolved>
                                    <version>1.7.4</version>
                    <version>1.7.11</version>
                    <version>1.8.8</version>
                                    <fixVersion>2.1.6</fixVersion>
                    <fixVersion>2.2.0-beta-1</fixVersion>
                                    <component>Stub generator / Joint compiler</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14480287" author="paulk" created="Sat, 11 May 2013 06:36:29 +0000"  >&lt;p&gt;Andy, do you have a small example which currently fails?&lt;/p&gt;</comment>
                            <comment id="14474523" author="agrimm" created="Sat, 11 May 2013 14:01:26 +0000"  >&lt;p&gt;Hi, Paul, thanks for responding.  I have an example, but it&apos;s unfortunately not small.  I ran into this problem while compiling eucalyptus, and I have since moved on to other projects.  I will try to make another attempt.  For now, I can point you to where the inner interface is defined, and the reference to it which fails.&lt;/p&gt;

&lt;p&gt;First, the interface:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/msgs/src/main/java/com/eucalyptus/component/ComponentId.java#L141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/msgs/src/main/java/com/eucalyptus/component/ComponentId.java#L141&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Then, the reference:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/reporting/src/main/java/com/eucalyptus/reporting/service/ReportingMessages.groovy#L30&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/reporting/src/main/java/com/eucalyptus/reporting/service/ReportingMessages.groovy#L30&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The compilation of the latter, which is being compiled using a groovyc task in ant, is defined here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/module-inc.xml#L206&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eucalyptus/eucalyptus/blob/master/clc/modules/module-inc.xml#L206&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and fails with:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  [groovyc] /tmp/groovy-generated-5530094202277916256-java-source/com/eucalyptus/reporting/service/ReportingMessage.java:11: error: cannot find symbol
  [groovyc] @com.eucalyptus.component.ComponentId$ComponentMessage(value=Reporting.class) public class ReportingMessage
  [groovyc]                          ^
  [groovyc]   symbol:   class ComponentId$ComponentMessage
  [groovyc]   location: package com.eucalyptus.component
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sorry, that&apos;s not a great test case for you.  I&apos;ll try to prune it down.&lt;/p&gt;</comment>
                            <comment id="14474478" author="agrimm" created="Sat, 11 May 2013 14:27:36 +0000"  >&lt;p&gt;Also, FWIW, related links:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://eucalyptus.atlassian.net/browse/EUCA-2993&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://eucalyptus.atlassian.net/browse/EUCA-2993&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=949352&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugzilla.redhat.com/show_bug.cgi?id=949352&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We&apos;ve already applied this patch to groovy in Fedora.&lt;/p&gt;</comment>
                            <comment id="14480262" author="paulk" created="Sat, 11 May 2013 23:04:02 +0000"  >&lt;p&gt;Any chance you could try with some recent versions of Groovy? Adding your change certainly doesn&apos;t fail any existing test in our test suite but my attempts to reproduce the error have failed so far. Calling getName() seems to be currently returning the &apos;.&apos; version. I haven&apos;t traced it through to see if there was an underlying change that caused this fix by accident but none of the Jira issues for Java stubs over the last 12 months seem to indicate they did such a change.&lt;/p&gt;</comment>
                            <comment id="14474611" author="esword" created="Wed, 19 Jun 2013 09:58:22 +0000"  >&lt;p&gt;Here is a tiny project that shows the problem when using gradle to build, though the problem occurs with ant as well.  I am hitting the problem in a real project that is using the Jackson JsonInclude annotation, but simplified the sample project so it is entirely self contained.  I reproduced the issue with with groovy 1.8.4, 2.1.4, 2.1.5, and the 2.1.6 and 2.2.0 snapshot releases as of last night.&lt;/p&gt;

&lt;p&gt;I tried all sorts of combinations for writing the annotation - full class path, import statics, etc.  The stub is always generated wrong.&lt;/p&gt;

&lt;p&gt;Note that Intellij and Eclipse both seem to work fine.  I checked the stubs from intellij and it just leaves out the annotations, so that may be why.&lt;/p&gt;

&lt;p&gt;This is killing us.  May have to move a ton of class from groovy to java just to work around this unless anyone has another idea?  Like can I slip a step into the gradle build that would let me hack the stub and change the $ to a .?&lt;/p&gt;</comment>
                            <comment id="14480307" author="paulk" created="Fri, 21 Jun 2013 06:22:46 +0000"  >&lt;p&gt;Erik and Andy, once the CI builds have done there thing (over the next hour or two), can you check the 2.1.6 and 2.2.0 snapshot releases. I just pushed a fix. Tests to follow but if you can confirm whether it is fixed for you, that would be great. Thanks.&lt;/p&gt;</comment>
                            <comment id="14480296" author="paulk" created="Fri, 21 Jun 2013 06:28:25 +0000"  >&lt;p&gt;Erik, even after the latest changes, your gradle build still failed for me - not sure whether gradle uses its own version of groovy for stub generation or whether there was some snapshot jar caching going on. Anyway, this worked from the commandline (shown for windows):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; C:\groovy-github\target\install\bin\groovyc -j --sourcepath src\main\java;src\main\groovy src\main\groovy\example\AnnotatedClass.groovy src\main\java\example\annot\TestAnnot.java src\main\groovy\example\sub\SomethingThatUsesAnnotatedClass.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14474565" author="esword" created="Fri, 21 Jun 2013 10:03:23 +0000"  >&lt;p&gt;Paul - thanks for the fast response.  I used gradle to pull the 2.1.6 snapshot about 90 minutes ago and verified it was the same as the latest on the download site - groovy-all-2.1.6-20130621.110245-3.jar.  As you said, the gradle build still failed.  Looking at the debug log output (build16.log in the new zip I have attached), I see an older version of groovy (1.8.6) listed in some of the classpath statements, but I can&apos;t tell if that really interferes or not.&lt;/p&gt;

&lt;p&gt;I also tried a simple ant build (also included in the new zip) and got strange results.  The first time I do a compile, it works.  The second time I compile, it fails, and it will continue to fail until I do a clean and then build again.  (See ant.log file.)  Very odd.  I couldn&#226;&#128;&#153;t find docs for an option to force it to keep the stub files after compilation was done, so I couldn&#226;&#128;&#153;t verify that the stubs were being generated correctly one time and incorrectly the next.&lt;/p&gt;

&lt;p&gt;The new zip does not have the groovy jar in the lib dir for the ant build since I didn&#226;&#128;&#153;t want to push up a 6M file.  Let me know if you want it to have a complete set up.&lt;/p&gt;</comment>
                            <comment id="14474644" author="pschumacher" created="Fri, 21 Jun 2013 14:40:39 +0000"  >&lt;p&gt;Hello Eric,&lt;/p&gt;

&lt;p&gt;the build with the Pauls (partial) fix for this issue did hang on the buildserver. I restarted it and finished just a few minutes ago. If you have the time can you give this build a try?&lt;/p&gt;

&lt;p&gt;Edit: Please disregard my comment, as I can not find the new jar in the repository yet. Sorry!&lt;/p&gt;</comment>
                            <comment id="14480312" author="paulk" created="Sun, 23 Jun 2013 05:16:09 +0000"  >&lt;p&gt;Eric,&lt;/p&gt;

&lt;p&gt;When placing the latest groovy-all snapshot jar in your lib directory (groovy-all-2.2.0-20130621.195639-198.jar) the ant build seems to consistently build OK. It would be great if you could confirm.&lt;/p&gt;

&lt;p&gt;P.S. If you want to keep the stubs, check out the comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-4432&quot; title=&quot;Provide a way to see generated stub code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-4432&quot;&gt;&lt;del&gt;GROOVY-4432&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14474546" author="esword" created="Sat, 29 Jun 2013 11:41:43 +0000"  >&lt;p&gt;Confirmed with the 2.1.6 SNAPSHOT this morning - no more compile errors.  I think this bug is fixed.  Sorry for the delay in checking it.  Been fighting another issue with groovy and proxy problems with spring security annotations.  I&apos;ll likely be filing something with that soon, though most likely with the spring team I think.&lt;/p&gt;</comment>
                            <comment id="14474550" author="dream_brother" created="Thu, 4 Jul 2013 02:57:47 +0000"  >&lt;p&gt;I cannot use Jackson polymorphic types in Groovy, because of this issue.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@JsonSubTypes.Type&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; is transformed to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@org.codehaus.jackson.annotate.JsonSubTypes$Type&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[ERROR] /home/nik/repos/web_client/target/generated-sources/groovy-stubs/main/ru/round/domain/payments/requisites/PaymentRequisites.java:[10,1378] cannot find symbol
[ERROR] symbol:   &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;JsonSubTypes$Type
[ERROR] location: &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.codehaus.jackson.annotate
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14474628" author="guillaume" created="Thu, 4 Jul 2013 03:11:23 +0000"  >&lt;p&gt;This should be fixed in the next 2.1.6 release.&lt;/p&gt;</comment>
                            <comment id="14474719" author="guillaume" created="Thu, 4 Jul 2013 05:29:50 +0000"  >&lt;p&gt;I&apos;ve added a test for non-regression.&lt;br/&gt;
But even removing the &lt;tt&gt;replace(&apos;$&apos;, &apos;.&apos;)&lt;/tt&gt; doesn&apos;t make the test fail.&lt;br/&gt;
We might have fixed the ClassNode&apos;s name upper the chain.&lt;/p&gt;</comment>
                            <comment id="14480320" author="paulk" created="Fri, 5 Jul 2013 22:13:03 +0000"  >&lt;p&gt;Thanks Guillaume.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722387" name="groovy-annots.zip" size="51080" author="esword" created="Wed, 19 Jun 2013 09:58:22 +0000"/>
                            <attachment id="12722658" name="groovy-annots2.zip" size="126981" author="esword" created="Fri, 21 Jun 2013 10:03:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c6lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>