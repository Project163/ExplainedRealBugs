<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:25:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5294] This reference is null during construction of object of abstract class implemented as closure map</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5294</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;The following code produces NPE when the second object is created:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; f(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o);

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void g(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val) { 
        println f(val) &lt;span class=&quot;code-comment&quot;&gt;// NPE when &lt;span class=&quot;code-quote&quot;&gt;&apos;y&apos;&lt;/span&gt; is created !!!
&lt;/span&gt;    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; C() {&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;DEF&apos;&lt;/span&gt;)}

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; C(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val) { g(val) }
}

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;D &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; C {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; f(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; o ? &lt;span class=&quot;code-quote&quot;&gt;&apos;Not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;Is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt; }
}

def x = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; D()

def y = [ &lt;span class=&quot;code-quote&quot;&gt;&apos;f&apos;&lt;/span&gt; : { it -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;123&apos;&lt;/span&gt; + it } ] as C
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Somehow &apos;this&apos; becomes null when &apos;f&apos; is invoked in &apos;g&apos;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12816118">GROOVY-5294</key>
            <summary>This reference is null during construction of object of abstract class implemented as closure map</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="almo">Alexander Monakhov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Feb 2012 05:39:57 +0000</created>
                <updated>Sun, 13 May 2012 03:30:08 +0000</updated>
                            <resolved>Thu, 16 Feb 2012 08:02:28 +0000</resolved>
                                    <version>1.8.6</version>
                                    <fixVersion>2.0-beta-3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14472469" author="melix" created="Thu, 16 Feb 2012 02:36:40 +0000"  >&lt;p&gt;I fear we cannot fix that in 1.8.x. Groovy 2.0 provides a new proxy generator which will be capable of handling this though. Let me explain, in 1.x, proxies are generated using a code template. In this case, the code looks like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;C_groovyProxy &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; C {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; closureMap
    C_groovyProxy(map) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;()
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.closureMap = map
    }
    java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; f(java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; p0) { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.@closureMap[&lt;span class=&quot;code-quote&quot;&gt;&apos;f&apos;&lt;/span&gt;] (p0)    }
}
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; C_groovyProxy(map)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is that we call &lt;tt&gt;super()&lt;/tt&gt; before setting the closure delegate map. The &lt;tt&gt;super&lt;/tt&gt; call will eventually reach the &lt;tt&gt;g&lt;/tt&gt; method which will lookup the implementation of &lt;tt&gt;f&lt;/tt&gt; into the map. At this point, the map is still null, leading to the error you&apos;ve seen. We would need a way of setting the closure delegate map before calling &lt;tt&gt;super&lt;/tt&gt;. This is not allowed in Java, nor in Groovy. However, we can do this in bytecode, which explains why a fix could be made available in 2.0. Meanwhile, if possible, I&apos;d recommand not using calls to delegated methods in the construction of the object.&lt;/p&gt;</comment>
                            <comment id="14472548" author="almo" created="Thu, 16 Feb 2012 02:42:01 +0000"  >&lt;p&gt;I see. Thanks for the explanation. I&apos;ve alerady refactored methods so they are not invoked in constructor.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ch4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>