<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:04:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2548] -cp include  in bash script startGroovy do not include all needed jars</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2548</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I install &amp;amp; set groovy, but I always get:&lt;br/&gt;
&amp;gt; groovy&lt;br/&gt;
java.lang.NoClassDefFoundError: org/apache/commons/cli/CommandLineParser&lt;br/&gt;
        at java.lang.Class.getDeclaredMethods0(Native Method)&lt;br/&gt;
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)&lt;br/&gt;
        at java.lang.Class.getMethod0(Class.java:2670)&lt;br/&gt;
        at java.lang.Class.getMethod(Class.java:1603)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:92)&lt;br/&gt;
        at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)&lt;/p&gt;

&lt;p&gt;I looked into script and find out that it do not include all needed  jar files. This diff worked for me&lt;/p&gt;

&lt;p&gt;&amp;gt; diff -u /usr/bin/startGroovy.orig /usr/bin/startGroovy&lt;br/&gt;
&amp;#8212; /usr/bin/startGroovy.orig   2008-01-27 22:24:09.000000000 +0100&lt;br/&gt;
+++ /usr/bin/startGroovy        2008-01-27 22:26:04.000000000 +0100&lt;br/&gt;
@@ -115,7 +115,11 @@&lt;br/&gt;
 if [ -z &quot;$GROOVY_CONF&quot; ] ; then&lt;br/&gt;
     GROOVY_CONF=&quot;$GROOVY_HOME/conf/groovy-starter.conf&quot;&lt;br/&gt;
 fi&lt;br/&gt;
-STARTER_CLASSPATH=&quot;$GROOVY_HOME/lib/groovy-1.5.1.jar&quot;&lt;br/&gt;
+#STARTER_CLASSPATH=&quot;$GROOVY_HOME/lib/groovy-1.5.1.jar&quot;&lt;br/&gt;
+STARTER_CLASSPATH=$(ls $GROOVY_HOME/lib | awk -v PRE=&quot;$GROOVY_HOME/lib/&quot; &apos;\&lt;br/&gt;
+        BEGIN&lt;/p&gt;
{result=&quot;.&quot;}
&lt;p&gt;+        &lt;/p&gt;
{result=result &quot;:&quot; PRE $0}
&lt;p&gt;+        END&lt;/p&gt;
{ print result}
&lt;p&gt;&apos;)&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Create the final classpath. Setting a classpath using the -cp or -classpath option means not to use the&lt;/li&gt;
	&lt;li&gt;global classpath. Groovy behaves then the same as the java interpreter&lt;br/&gt;
thidney@deepblue:~/Desktop&amp;gt;                                                &lt;/li&gt;
&lt;/ol&gt;

</description>
                <environment>Linux 32b (openSuse 10.3)&lt;br/&gt;
Mac OS X 10.4.11</environment>
        <key id="12812114">GROOVY-2548</key>
            <summary>-cp include  in bash script startGroovy do not include all needed jars</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="thidney">thidney</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 Jan 2008 15:30:02 +0000</created>
                <updated>Sun, 5 Apr 2015 14:44:00 +0000</updated>
                            <resolved>Sun, 20 Apr 2008 07:45:35 +0000</resolved>
                                    <version>1.5.1</version>
                                    <fixVersion>1.5.6</fixVersion>
                    <fixVersion>1.6-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14464181" author="russel" created="Wed, 30 Jan 2008 04:38:54 +0000"  >&lt;p&gt;I think the problem is actually with your installation and not the script.  The script simply bootstraps the Groovy runtime system which then loads the jars in $GROOVY_HOME/lib.  The change to the script that you propose is not and should not be needed.&lt;/p&gt;

&lt;p&gt;Clearly we need to find out why you are having this problem but this issue will almost certainly have to be marked as &quot;Won&apos;t Fix&quot;.&lt;/p&gt;</comment>
                            <comment id="14464242" author="blackdrag" created="Wed, 30 Jan 2008 04:42:27 +0000"  >&lt;p&gt;I agree. We need to find the error in your installation, because this exact setup usually works. btw, $GROOVY_HOME/conf/groovy-starter.conf contains the additional classpath entries, so you should maybe take a look at this. Maybe that file was modified or is even empty. In that case it won&apos;t work.&lt;/p&gt;</comment>
                            <comment id="14478092" author="paulk" created="Fri, 18 Apr 2008 18:28:49 +0000"  >&lt;p&gt;No further feedback. Assuming environmental problems have been solved. Please reopen if you have further problems.&lt;/p&gt;</comment>
                            <comment id="14464663" author="craigwblake" created="Fri, 18 Apr 2008 23:35:59 +0000"  >&lt;p&gt;I see the same behavior with a fresh install of the Groovy 1.5.5 RPM on a CentOS 5.1 system.  I set GROOVY_HOME to be &quot;/usr/share/java/groovy/&quot; and when I run &quot;groovy&quot; I get the listed exception.  The &quot;groovy-starter.conf&quot; file appears to be present (copy attached).&lt;/p&gt;

&lt;p&gt;CMD&amp;gt; echo $GROOVY_HOME &lt;br/&gt;
/usr/share/java/groovy/&lt;/p&gt;

&lt;p&gt;CMD&amp;gt; ls $GROOVY_HOME/conf/&lt;br/&gt;
groovy-starter.conf&lt;/p&gt;

&lt;p&gt;CMD&amp;gt; groovy&lt;br/&gt;
java.lang.NoClassDefFoundError: org/apache/commons/cli/CommandLineParser&lt;br/&gt;
	at java.lang.Class.getDeclaredMethods0(Native Method)&lt;br/&gt;
	at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)&lt;br/&gt;
	at java.lang.Class.getMethod0(Class.java:2670)&lt;br/&gt;
	at java.lang.Class.getMethod(Class.java:1603)&lt;br/&gt;
	at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:92)&lt;br/&gt;
	at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:130)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: org.apache.commons.cli.CommandLineParser&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:200)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)&lt;br/&gt;
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:276)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:251)&lt;br/&gt;
	at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)&lt;br/&gt;
	... 6 more&lt;/p&gt;
</comment>
                            <comment id="14464576" author="craigwblake" created="Fri, 18 Apr 2008 23:46:31 +0000"  >&lt;p&gt;CMD&amp;gt; java -version&lt;br/&gt;
java version &quot;1.6.0_05&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_05-b13)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 10.0-b19, mixed mode)&lt;/p&gt;
</comment>
                            <comment id="14464598" author="craigwblake" created="Fri, 18 Apr 2008 23:53:06 +0000"  >&lt;p&gt;After experimenting a bit I was able to work around the error by setting the path to the lib dir in &quot;groovy-starter.conf&quot; explicitly.  I replaced:&lt;/p&gt;

&lt;p&gt;load !&lt;/p&gt;
{groovy.home}
&lt;p&gt;/lib/*.jar&lt;/p&gt;

&lt;p&gt;with:&lt;/p&gt;

&lt;p&gt;load /usr/share/java/groovy/lib/*.jar&lt;/p&gt;

&lt;p&gt;after which Groovy runs properly.&lt;/p&gt;</comment>
                            <comment id="14478109" author="paulk" created="Sat, 19 Apr 2008 00:09:38 +0000"  >&lt;p&gt;What happens if you remove the trailing slash on GROOVY_HOME but leave the conf file in its original form?&lt;/p&gt;</comment>
                            <comment id="14464560" author="craigwblake" created="Sat, 19 Apr 2008 00:13:31 +0000"  >&lt;p&gt;Yep, that fixes it.  Probably worth a mention on the Getting Started page.&lt;/p&gt;</comment>
                            <comment id="14478061" author="paulk" created="Sat, 19 Apr 2008 00:33:45 +0000"  >&lt;p&gt;On Windows we now remove the trailing slash if found (for both JAVA_HOME and GROOVY_HOME). I guess that would be the thing to do here too.&lt;/p&gt;</comment>
                            <comment id="14478110" author="paulk" created="Sun, 20 Apr 2008 07:45:35 +0000"  >&lt;p&gt;startGroovy now removes a trailing slash on GROOVY_HOME if it finds it. Tested on Ubuntu.&lt;/p&gt;</comment>
                            <comment id="14464640" author="adarshns" created="Wed, 23 Apr 2008 13:56:53 +0000"  >&lt;p&gt;It did&apos;nt work for me on RedHat. Maybe the patch is not released yet ?&lt;/p&gt;</comment>
                            <comment id="14478103" author="paulk" created="Wed, 23 Apr 2008 17:33:38 +0000"  >&lt;p&gt;The fix verson for this issue is 1.5.6 which is due for release in a few days time. You can try a snapshot here:&lt;br/&gt;
&lt;a href=&quot;http://snapshots.dist.codehaus.org/groovy/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://snapshots.dist.codehaus.org/groovy/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14466410" author="reikiman" created="Wed, 11 Feb 2009 10:24:23 +0000"  >&lt;p&gt;I don&apos;t see how to reopen this &amp;#8211; However, I found that if GROOVY_HOME had a double slash in it there would be a similar failure.&lt;/p&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;p&gt;export HOME=/Users/david/&lt;br/&gt;
export GROOVY_HOME=${HOME}/groovy-1.6-RC-3&lt;br/&gt;
export PATH=${GROOVY_HOME}/bin:${PATH}&lt;/p&gt;

&lt;p&gt;Results in the same NoClassDefFoundError .. The above makes GROOVY_HOME=/Users/david//groovy-1.6-RC-3 (note two slashes) and if I change HOME to not have its trailing slash then it works fine.&lt;/p&gt;
</comment>
                            <comment id="14466532" author="blackdrag" created="Wed, 11 Feb 2009 11:42:06 +0000"  >&lt;p&gt;a trailing slash is one thing, but a double slash in between... I think we can&apos;t work around all possible usage errors... what we maybe could do is to test if GROOVY_HOME exists as file if set and to give an error message if it does not exist as file. That would resolve your issue. If you want to have that I suggest opening a new JIRA issue, a feature request.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721656" name="groovy-starter.conf" size="895" author="craigwblake" created="Fri, 18 Apr 2008 23:38:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cnbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>