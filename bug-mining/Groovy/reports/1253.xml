<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:15:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-1034] running groovy.bat does not return exit status on windows</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-1034</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Running groovy from within another script does not give the real exit value of the groovy process. Try any of the following:&lt;/p&gt;

&lt;p&gt;perl -e &quot;system(&apos;groovy -e \&quot;System.exit(1)\&quot;&apos;);print $?&amp;gt;&amp;gt;8&quot;&lt;br/&gt;
ruby -e &quot;system(&apos;groovy.bat -e \&quot;System.exit(1)\&quot;&apos;);print $?&amp;gt;&amp;gt;8&quot;&lt;br/&gt;
groovy -e &quot;p=&apos;groovy.bat -e \&quot;System.exit(1)\&quot;&apos;.execute();p.waitFor();println p.exitValue()&quot;&lt;/p&gt;

&lt;p&gt;To see that the above examples are correct in catching the exit code, try e.g.&lt;/p&gt;

&lt;p&gt;ruby -e &quot;system(&apos;ruby -e \&quot;exit(2)\&quot;&apos;);print $?&amp;gt;&amp;gt;8&quot;&lt;br/&gt;
groovy -e &quot;def p=&apos;ruby -e \&quot;exit(2)\&quot;&apos;.execute();;p.waitFor();println p.exitValue()&quot;&lt;/p&gt;

&lt;p&gt;Adding &lt;/p&gt;

&lt;p&gt;exit %ERROR_LEVEL%&lt;/p&gt;

&lt;p&gt; to the end of groovy.bat solves the problem but is not usable as it causes command prompt to exit if running groovy directly (i.e. not via some other script).&lt;/p&gt;</description>
                <environment>win xp sp2, java 1.4.2_09</environment>
        <key id="12814535">GROOVY-1034</key>
            <summary>running groovy.bat does not return exit status on windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="antti.karanta@napa.fi">Antti Karanta</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Sep 2005 06:49:51 +0000</created>
                <updated>Wed, 7 Apr 2010 23:45:11 +0000</updated>
                            <resolved>Mon, 5 Apr 2010 07:33:15 +0000</resolved>
                                    <version>1.0-JSR-3</version>
                                    <fixVersion>1.7.2</fixVersion>
                    <fixVersion>1.6.9</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14461513" author="blackdrag" created="Thu, 1 Sep 2005 11:26:40 +0000"  >&lt;p&gt;can you please test &quot;exit /b %ERROR_LEVEL%&quot; ?&lt;/p&gt;</comment>
                            <comment id="14477163" author="antti.karanta@napa.fi" created="Fri, 2 Sep 2005 00:47:52 +0000"  >&lt;p&gt;I already did, I just forgot to include a comment about that in the bug report. Sorry.&lt;br/&gt;
It does not work, either.&lt;/p&gt;

&lt;p&gt;I also tried both spellings ERROR_LEVEL and ERRORLEVEL. The first should be correct (as it works when using exit %ERROR_LEVEL%), but the latter form appears in the documentation you get by typing &lt;br/&gt;
exit /?&lt;/p&gt;
</comment>
                            <comment id="14477172" author="antti.karanta@napa.fi" created="Fri, 2 Sep 2005 04:16:55 +0000"  >&lt;p&gt;I inspected other Java apps that start via .bat files and noticed that at least ajc (the aspectj compiler, www.eclipse.org/aspectj) does manage to return the correct exit code:&lt;/p&gt;

&lt;p&gt;C:\Temp&amp;gt;groovy -e &quot;def p=&apos;ajc.bat&apos;.execute();def t=p.err.text;p.waitFor();println p.exitValue()&quot;&lt;br/&gt;
-1&lt;/p&gt;

&lt;p&gt;// had to read the messages in the err stream, otherwise p.waitFor() does not return&lt;/p&gt;

&lt;p&gt;I looked at ajc.bat and noticed that running the Java class is on the last line. I experimented a little and noticed this also works w/ groovy.bat. This is quite fragile - the lines after running the Java class may contain only whitespace - not even comments.&lt;/p&gt;

&lt;p&gt;To emphasize: the return code is correct if the last line of the groovy.bat is&lt;br/&gt;
&quot;%JAVA_EXE%&quot; %JAVA_OPTS% -classpath &quot;%CP%&quot; %CLASSWORLDS_MAIN_CLASS% groovy %CMD_LINE_ARGS%&lt;/p&gt;

&lt;p&gt;I hope this is of some help.&lt;/p&gt;
</comment>
                            <comment id="14463900" author="guillaume" created="Sun, 23 Dec 2007 06:17:32 +0000"  >&lt;p&gt;Is it still the case that the return value is not correct?&lt;/p&gt;</comment>
                            <comment id="14477692" author="antti.karanta@napa.fi" created="Thu, 27 Dec 2007 03:21:04 +0000"  >&lt;p&gt;Yes, the return value is still always 0. I think the importance of this is now quite small as the native launcher behaves correctly and is included in the windows installer (which I would believe most windows users will use).&lt;/p&gt;

&lt;p&gt;A weird thing though is that &lt;/p&gt;

&lt;p&gt;groovy -e &quot;p=&apos;groovy.bat -e \&quot;System.exit(1)\&quot;&apos;.execute();p.waitFor();println p.exitValue()&quot;&lt;/p&gt;

&lt;p&gt;does not work any more. It prints &quot;255&quot;, but it seems that the problem is that groovy.bat (that is invoked in the one-liner) is not executed at all for some reason.&lt;/p&gt;

&lt;p&gt;The ruby version of the test works fine:&lt;/p&gt;

&lt;p&gt;C:\Documents and Settings\nak&amp;gt;ruby -e &quot;system(&apos;groovy.bat -e \&quot;System.exit(1)\&quot;&apos;);print $?&amp;gt;&amp;gt;8&quot;&lt;br/&gt;
0&lt;br/&gt;
C:\Documents and Settings\nak&amp;gt;ruby -e &quot;system(&apos;groovy.exe -e \&quot;System.exit(1)\&quot;&apos;);print $?&amp;gt;&amp;gt;8&quot;&lt;br/&gt;
1&lt;/p&gt;
</comment>
                            <comment id="14466475" author="huybrechts" created="Tue, 10 Feb 2009 05:59:04 +0000"  >&lt;p&gt;This is still a problem, but it can be fixed by using this as the last line in both groovy.bat and startGroovy.bat&lt;/p&gt;

&lt;p&gt;CMD /C EXIT /B %ERRORLEVEL%&lt;/p&gt;

&lt;p&gt;(copied from mvn.bat)&lt;/p&gt;

&lt;p&gt;any chance this can still be fixed in 1.6-RC ?&lt;/p&gt;</comment>
                            <comment id="14466446" author="blackdrag" created="Tue, 10 Feb 2009 06:44:12 +0000"  >&lt;p&gt;as last line you mean inclusive the CMD /C? that could prevent one or two problems if the bat file is called with command.com instead of cmd.exe&lt;/p&gt;</comment>
                            <comment id="14466490" author="huybrechts" created="Wed, 11 Feb 2009 13:00:22 +0000"  >&lt;p&gt;Yes, the full line, including CMD /C.&lt;/p&gt;

&lt;p&gt;In 1.5.7, the same problem existed, but you could fix it by adding this line to only groovy.bat.&lt;/p&gt;

&lt;p&gt;In Maven, the &apos;CMD /C&apos; was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/MNG-3651&quot; title=&quot;mvn.bat returns an incorrect error code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MNG-3651&quot;&gt;&lt;del&gt;MNG-3651&lt;/del&gt;&lt;/a&gt;. Not sure what problem it fixes.&lt;/p&gt;

&lt;p&gt;And for command.com, I hadn&apos;t heard about that since my Win98 days &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14467218" author="pjenvey" created="Fri, 3 Jul 2009 17:38:35 +0000"  >&lt;p&gt;For portability you can do %COMSPEC% /c instead of CMD /c (this is what we&apos;ve done for jython.bat)&lt;/p&gt;</comment>
                            <comment id="14469199" author="artemp" created="Wed, 31 Mar 2010 11:21:35 +0000"  >&lt;p&gt;Sorry, very new to this project. Any reason not to submit a patch for this? I am running 1.8.0 and still have the problem &amp;#8211; I added this to my gant.bat and startGroovy.bat scripts as suggested and this fixed it.&lt;/p&gt;

&lt;p&gt;@rem Fix the problem that Gant does not return correct error code as documented in&lt;br/&gt;
@rem &lt;a href=&quot;http://jira.codehaus.org/browse/GROOVY-1034&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/GROOVY-1034&lt;/a&gt;&lt;br/&gt;
cmd /C exit /B %ERRORLEVEL%&lt;/p&gt;</comment>
                            <comment id="14479035" author="paulk" created="Mon, 5 Apr 2010 07:33:15 +0000"  >&lt;p&gt;I added the following to all .bat files and it seemed to work for me in various tests:&lt;br/&gt;
%COMSPEC% /C exit /B %ERRORLEVEL%&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721082" name="groovy_process_exitvalue_bug.groovy" size="582" author="" created="Thu, 1 Sep 2005 06:49:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bu8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>