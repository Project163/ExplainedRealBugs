<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:33:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-6153] SecureASTCustomizer using whitelist does not work deterministically</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-6153</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;We are using a GSE with &lt;tt&gt;SecureASTCustomizer&lt;/tt&gt; to restrict use of certain classes. In my experiment, it does not work with a very simple test case: some classes in the package &quot;java.lang&quot; simply circumvent the restriction even without the use of reflection.&lt;/p&gt;

&lt;p&gt;Here&apos;s how I set it up:&lt;br/&gt;
I used both import whitelist and receive whilelist, they are the same and contains actaully just two classes: java.lang.Object and test.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;		
		&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] WHITE_CLASSES = {&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;};				
		List&amp;lt;java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; classWhiteList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();
		classWhiteList.addAll(Arrays.asList(WHITE_CLASSES));
		
		&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SecureASTCustomizer secure = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SecureASTCustomizer();
		secure.setIndirectImportCheckEnabled(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
		secure.setImportsWhitelist(classWhiteList);
		secure.setReceiversWhiteList(classWhiteList);
		secure.setPackageAllowed(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
		secure.setClosuresAllowed(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
		secure.setMethodDefinitionAllowed(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);

		CompilerConfiguration cc = gse.getConfig();
		cc.addCompilationCustomizers(secure);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I expect that the above setting will complain the use of &quot;java.lang.Long&quot; &amp;amp; &quot;java.lang.System&quot;. Howerver, the following script runs without any problem.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; lo = 5.6;
java.lang.&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;run &quot;&lt;/span&gt;);		
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I went on to the following, it starts complaining the Math class.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; lo = 5.6;
java.lang.&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;run &quot;&lt;/span&gt; + java.lang.&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(lo));		
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I tried also java.lang.Thread, and it gets complained too. Is there any special exceptions to the whitelist?&lt;/p&gt;</description>
                <environment>Windows</environment>
        <key id="12818517">GROOVY-6153</key>
            <summary>SecureASTCustomizer using whitelist does not work deterministically</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="melix">C&#233;dric Champeau</assignee>
                                    <reporter username="yimingdu">Yiming Du</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 May 2013 14:16:46 +0000</created>
                <updated>Sat, 1 Jun 2013 06:11:56 +0000</updated>
                            <resolved>Wed, 29 May 2013 09:17:39 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.1.4</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14480275" author="yimingdu" created="Mon, 13 May 2013 14:24:08 +0000"  >&lt;p&gt;I tried to explicitly blacklist the System class, and it does not work either. It seems that some classes (also including java.lang.String)are just immune to the check.&lt;/p&gt;
</comment>
                            <comment id="14480270" author="yimingdu" created="Mon, 13 May 2013 15:29:29 +0000"  >&lt;p&gt;More experiments:&lt;/p&gt;

&lt;p&gt;After I changed&lt;br/&gt;
java.lang.Long lo = 5.6;&lt;/p&gt;

&lt;p&gt;to &lt;br/&gt;
java.lang.Long lo = new Long(5.6);&lt;/p&gt;

&lt;p&gt;I got the expected SecurityException, seemingly autoboxing tricked the check process.&lt;/p&gt;

&lt;p&gt;Also, after I changed &lt;br/&gt;
java.lang.System.out.println(&quot;run &quot;); &lt;/p&gt;

&lt;p&gt;to&lt;br/&gt;
java.lang.System.getenv(&quot;test&quot;);&lt;br/&gt;
I got the SecurityException. Does it have to do with static import here? or field access instead of methods?&lt;/p&gt;




</comment>
                            <comment id="14474530" author="melix" created="Wed, 29 May 2013 08:50:57 +0000"  >&lt;p&gt;Formatting tags&lt;/p&gt;</comment>
                            <comment id="14474501" author="melix" created="Wed, 29 May 2013 09:03:03 +0000"  >&lt;p&gt;There are two things in one here. First, a bug in &lt;tt&gt;SecureASTCustomizer&lt;/tt&gt; which forgets to check that the receiver of a property expression is allowed:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&apos;run&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where &lt;tt&gt;System.out&lt;/tt&gt; is a &lt;tt&gt;PropertyExpression&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The second point is whether you want to prevent people from &lt;b&gt;declaring&lt;/b&gt; types too, which is not checked currently:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; x = ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14474465" author="melix" created="Wed, 29 May 2013 09:17:39 +0000"  >&lt;p&gt;Fixed now. Note that to prevent the use of declaration types, you have to use the constant types white/blacklist.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ctvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>