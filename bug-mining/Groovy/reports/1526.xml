<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:21:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4884] Calling a method overwritten via metaClass from another method uses the original (non-overwritten) method</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4884</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Having the following code...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;A {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m1() { println &lt;span class=&quot;code-quote&quot;&gt;&apos;called m1&apos;&lt;/span&gt;; &lt;span class=&quot;code-quote&quot;&gt;&apos;m1&apos;&lt;/span&gt; }
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m2() { println &lt;span class=&quot;code-quote&quot;&gt;&apos;called m2&apos;&lt;/span&gt;; println m1(); &lt;span class=&quot;code-quote&quot;&gt;&apos;m2&apos;&lt;/span&gt; }
}
a = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; A()                                                                                                   
a.metaClass.m1 = { -&amp;gt; println &lt;span class=&quot;code-quote&quot;&gt;&apos;pwned m1&apos;&lt;/span&gt;; &lt;span class=&quot;code-quote&quot;&gt;&apos;o-m1&apos;&lt;/span&gt; }                                                            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Calling a.m2() shows...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;called m2
called m1
m1
===&amp;gt; m2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...but expected is this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;called m2
pwned m1
o-m1
===&amp;gt; m2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The correct output is shown in Groovy 1.7.x, only Groovy 1.8.0 shows the wrong one.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12815719">GROOVY-4884</key>
            <summary>Calling a method overwritten via metaClass from another method uses the original (non-overwritten) method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="rene.scheibe">Ren&#233; Scheibe</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jun 2011 05:23:45 +0000</created>
                <updated>Tue, 26 Jul 2011 19:44:02 +0000</updated>
                            <resolved>Thu, 14 Jul 2011 11:54:03 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>1.8.1</fixVersion>
                                    <component>primtive opts</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14471329" author="tim_yates" created="Thu, 16 Jun 2011 05:30:33 +0000"  >&lt;p&gt;Oddly, works as expected on the Groovy Web Console (which I believe is running 1.8.0?)...&lt;/p&gt;</comment>
                            <comment id="14471380" author="guillaume" created="Thu, 16 Jun 2011 05:47:44 +0000"  >&lt;p&gt;Groovy Web Console indeed runs 1.8.0.&lt;/p&gt;</comment>
                            <comment id="14471470" author="jason@bobberinteractive.com" created="Tue, 28 Jun 2011 16:59:32 +0000"  >&lt;p&gt;We appear to be hitting this in our tests...  Upgrading from 1.7.5 to 1.8.0 broke tests that verified values by overriding m1()-type methods and checking what m2() was passing in.&lt;/p&gt;

&lt;p&gt;We&apos;ve tried the 1.8.1 snapshot, but our tests still fail.  &lt;/p&gt;

&lt;p&gt;I&apos;d be happy to attach an example, but it doesn&apos;t vary much from Rene&apos;s code.  Please let me know if there&apos;s anything I can do to help! &lt;/p&gt;</comment>
                            <comment id="14471426" author="blackdrag" created="Thu, 14 Jul 2011 11:54:03 +0000"  >&lt;p&gt;should be fixed now&lt;/p&gt;</comment>
                            <comment id="14471513" author="jason@bobberinteractive.com" created="Mon, 25 Jul 2011 22:24:42 +0000"  >&lt;p&gt;Hi Jochen,&lt;/p&gt;

&lt;p&gt;Rene&apos;s example works, and more of our tests pass with 1.8.1, but we&apos;re still having problems with what looks like a variant of the problem.&lt;/p&gt;

&lt;p&gt;This is a stripped-down version of a test that passes with 1.7.6 but fails with 1.8.1:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BreakingExample_NoMetaclassOverride {
   @Test
   void testNotOverriden() {
      def list = []
      ClassUnderTest cut = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClassUnderTest()
      cut.metaClass.getRemoteObject = { -&amp;gt;
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; [method: {obj -&amp;gt; 
            list &amp;lt;&amp;lt; obj
         }] as RemoteObject
      }
      
      &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; val = &lt;span class=&quot;code-quote&quot;&gt;&quot;Value&quot;&lt;/span&gt; 
      cut.someMethod(val)
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; list == [val]
   }
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ClassUnderTest {
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; def someMethod(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; someValue) {
      RemoteObject object = getRemoteObject()
      object.method(someValue)
   }
   &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; RemoteObject getRemoteObject() {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RemoteObject()
   }
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;RemoteObject {
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void method(obj) { &lt;span class=&quot;code-comment&quot;&gt;/* Something */&lt;/span&gt; }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is this a bug or a change in how the metaClass works?&lt;/p&gt;

&lt;p&gt;Thank you!&lt;br/&gt;
Jason&lt;/p&gt;</comment>
                            <comment id="14471468" author="blackdrag" created="Tue, 26 Jul 2011 04:18:44 +0000"  >&lt;p&gt;your code works for me in trunk. &lt;/p&gt;</comment>
                            <comment id="14471585" author="jwb" created="Tue, 26 Jul 2011 11:23:17 +0000"  >&lt;p&gt;Seems we either need another issue to track the fix into 1.8.x or re-open this issue. If it&apos;s not appropriate to re-open this, we can make a new report for the problem Jason identified in 1.8.1.&lt;/p&gt;</comment>
                            <comment id="14471536" author="blackdrag" created="Tue, 26 Jul 2011 16:37:45 +0000"  >&lt;p&gt;please open a new issue&lt;/p&gt;</comment>
                            <comment id="14471615" author="jason@bobberinteractive.com" created="Tue, 26 Jul 2011 19:44:02 +0000"  >&lt;p&gt;Looks like Eclipse and/or I messed up the build order...  The Groovy-Eclipse plugin (currently) comes with Groovy 1.8.0.  Once I made sure I had groovy-all-1.8.1.jar ahead of &quot;Groovy Libraries&quot; in the Order and Export list, the example I posted worked.&lt;/p&gt;

&lt;p&gt;The test it came from still fails in Eclipse, but that looks like further Eclipse wackiness...  The failing test passes by cleaning, building and testing from command-line Ant using only 1.8.1.&lt;/p&gt;

&lt;p&gt;Thanks for taking a look, Jochen!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bsj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>