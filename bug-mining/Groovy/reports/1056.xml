<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:13:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3731] Faulty generic declaration accepted but generates illegal bytecode</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3731</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;In case of a faulty type declaration of a field in a Groovy class, illegal bytecode can result. For example:&lt;/p&gt;

&lt;p&gt;Map&amp;lt;Aclass&amp;gt; aMap = new HashMap&amp;lt;Aclass&amp;gt;()&lt;/p&gt;

&lt;p&gt;Clearly, the map generics require two classes to be valid. However, the faulty generic declaration is happily accepted by Groovy and is put into the bytecode. Now, if one actually performs introspection on the compiled class, a java.lang.reflect.MalformedParameterizedTypeException occurs. This can actually happen, depending on compile order, at compile time when any dependent class is compiled as the ant groovyc task for joint Groovy/Java compilation does rely on introspection of previously compiled classes.&lt;/p&gt;

&lt;p&gt;The attached file is a small example where the java.lang.reflect.MalformedParameterizedTypeException is provoked by introspection. Note that the first call to xstream.toXML always works, it is the call to xstream.processAnnotations that fails. If the Map is declared with two generic arguments the code works, if only one argument is present it compiles into bytecode but fails at introspection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12814836">GROOVY-3731</key>
            <summary>Faulty generic declaration accepted but generates illegal bytecode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="pera">Per Andersson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Sep 2009 10:16:46 +0000</created>
                <updated>Thu, 15 Oct 2009 17:15:32 +0000</updated>
                            <resolved>Sun, 13 Sep 2009 22:41:54 +0000</resolved>
                                    <version>1.6.4</version>
                                    <fixVersion>1.6.5</fixVersion>
                    <fixVersion>1.7-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14467630" author="roshandawrani" created="Wed, 9 Sep 2009 11:58:26 +0000"  >&lt;p&gt;Trying to understand what is causing the issue.&lt;/p&gt;

&lt;p&gt;Is the problem there because GenericsVisitor visits only the class right now and not fields, their initial values, etc?&lt;/p&gt;

&lt;p&gt;If that is the case, and it is possible for such generic issues to exist anywhere and not only class/interface definitions, does it mean that GenericsVisitor need to do visits everywhere?&lt;/p&gt;

&lt;p&gt;Is it a conscious decision that it does not do it currently - for compilation time, etc, etc?&lt;/p&gt;</comment>
                            <comment id="14467734" author="blackdrag" created="Wed, 9 Sep 2009 16:41:40 +0000"  >&lt;p&gt;is it possible for such issues to exist everywhere? yes. Important are only the types of fields and method signatures. Seems that we have to check them too. generics used in any kind of expression (including declarations in method blocks) are simply ignored.&lt;/p&gt;</comment>
                            <comment id="14467701" author="roshandawrani" created="Thu, 10 Sep 2009 20:45:01 +0000"  >&lt;p&gt;Attaching a patch for review.&lt;/p&gt;

&lt;p&gt;GenericsVisitor now visits MethodNode/FieldNode and does the generics check on the&lt;br/&gt;
type of the field as well on method parameter types and its return value type.&lt;/p&gt;

&lt;p&gt;The RHS expressions for fields and parameters have not been visited,&lt;br/&gt;
because that may mean visiting various types of expressions. It&apos;s only field type, &lt;br/&gt;
parameter types, and return type have been generics-checked now.&lt;/p&gt;

&lt;p&gt;Is that ok?&lt;/p&gt;

&lt;p&gt;Loading ClassNode of java.lang.Class class with generics info has caused one &lt;br/&gt;
failure in AstBuilder tests, which I am trying to take Hamlet&apos;s help on.&lt;/p&gt;

&lt;p&gt;Does the rest of it look ok to go ahead?&lt;/p&gt;</comment>
                            <comment id="14467661" author="hamletdrc" created="Sun, 13 Sep 2009 08:47:24 +0000"  >&lt;p&gt;This patch fixes the issue with AstBuilder gaining new generics information. See mailing list for details. &lt;/p&gt;</comment>
                            <comment id="14467722" author="roshandawrani" created="Sun, 13 Sep 2009 13:35:21 +0000"  >&lt;p&gt;Fixed on trunk. &lt;/p&gt;

&lt;p&gt;1.6.5 fix has run into an issue, so it is pending yet.&lt;/p&gt;</comment>
                            <comment id="14467693" author="roshandawrani" created="Sun, 13 Sep 2009 22:41:54 +0000"  >&lt;p&gt;Fixed - with help from Hamlet and Jochen. Thanks guys.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722349" name="17x_Patch.txt" size="3539" author="roshandawrani" created="Thu, 10 Sep 2009 20:45:01 +0000"/>
                            <attachment id="12722053" name="A.groovy" size="518" author="pera" created="Tue, 8 Sep 2009 10:16:46 +0000"/>
                            <attachment id="12722285" name="AstBUilder_changes_to_support_JIRA_3731.patch" size="2442" author="hamletdrc" created="Sun, 13 Sep 2009 08:47:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cmk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>