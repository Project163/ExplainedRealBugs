<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:42:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7054] Read Only Property not resolved correctly at runtime (w/CompileDynamic)</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7054</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I hit an issue where I was getting a MissingPropertyException if I used @CompileDynamic, but the exception went away with @CompileStatic.  Below is a simple junit test that isolates the behavior, and the underlying issue is how a read-only private property (via getter) of a parent class is resolved at runtime by @CompileDynamic versus @CompileStatic.  The CompileDynamicParentPrivateTest.testCDPrivate() test throws a runtime MissingPropertyException when a method in the parent class tries to access the the parent class&apos;s private property &apos;foo&apos; (as opposed to via getFoo())&lt;/p&gt;

&lt;p&gt;One possible explanation - it appears that the groovy &apos;foo&apos; property is resolved dynamically when using @CompileDynamic, and as the property is private within the parent class the resolution on the child instance fails (however, why does getFoo() succeed then?).  When @CompileStatic is used, the normal (java) lexical scoping rules apply, and the parent private property can be resolved correctly within the parent method.&lt;/p&gt;

&lt;p&gt;1. Is this a bug, or an expected difference in behavior for @CompileStatic / @CompileDynamic?&lt;br/&gt;
2. And is my explanation correct as to what is happening?&lt;br/&gt;
3. And how can getFoo() succeed, but &apos;foo&apos; fail, when using @CompileDynamic?  Shouldn&apos;t they always behave the same?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Brad&lt;/p&gt;

&lt;p&gt;-----------------------------------&lt;br/&gt;
Groovy 2.3.4&lt;/p&gt;

&lt;p&gt;testCSPrivate succeeds, while second test (testCDPrivate) fails with following exception on second println statement:&lt;br/&gt;
groovy.lang.MissingPropertyException: No such property: foo for class: myBugReport.bug2.CDChild&lt;br/&gt;
	at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:50)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.GetEffectivePogoPropertySite.getProperty(GetEffectivePogoPropertySite.java:84)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGroovyObjectGetProperty(AbstractCallSite.java:231)&lt;br/&gt;
	at myBugReport.bug2.CDParent.printWhichAccessesPrivatePropOfParent(CompileDynamicParentPrivateTest.groovy:53)&lt;br/&gt;
	at myBugReport.bug2.CDParent$printWhichAccessesPrivatePropOfParent.call(Unknown Source)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:45)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)&lt;br/&gt;
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)&lt;br/&gt;
	at myBugReport.bug2.CompileDynamicParentPrivateTest.testCDPrivate(CompileDynamicParentPrivateTest.groovy:22)&lt;/p&gt;


&lt;p&gt;-----------------------------------&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; myBugReport.bug2

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileDynamic
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; groovy.transform.CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test

&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CompileDynamicParentPrivateTest
{
  &lt;span class=&quot;code-comment&quot;&gt;// This test SUCCEEDS as CompileStatic parent &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;can access &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; read-only property &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;
&lt;/span&gt;  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCSPrivate()
  {
    CSChild csChild = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CSChild()
    csChild.printWhichAccessesPrivatePropOfParent()
  }

  &lt;span class=&quot;code-comment&quot;&gt;// This test FAILS as CompileDynamic parent &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;can NOT access &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; read-only property &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;
&lt;/span&gt;  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCDPrivate()
  {
    CDChild cdChild = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CDChild()
    cdChild.printWhichAccessesPrivatePropOfParent()
  }
}

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CSParent
{
  &lt;span class=&quot;code-comment&quot;&gt;// Read-only property where only the getter is defined (without a backing field)
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getFoo() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt; }

  void printWhichAccessesPrivatePropOfParent()
  {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Current value of getFoo() is: &quot;&lt;/span&gt; + getFoo())    &lt;span class=&quot;code-comment&quot;&gt;// works
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Current value of foo is: &quot;&lt;/span&gt; + foo)       &lt;span class=&quot;code-comment&quot;&gt;// works with CompileStatic only
&lt;/span&gt;  }
}

@CompileStatic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CSChild &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CSParent
{
}

@CompileDynamic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CDParent
{
  &lt;span class=&quot;code-comment&quot;&gt;// Read-only property where only the getter is defined (without a backing field)
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getFoo() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt; }

  void printWhichAccessesPrivatePropOfParent()
  {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Current value of getFoo() is: &quot;&lt;/span&gt; + getFoo())    &lt;span class=&quot;code-comment&quot;&gt;// works
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Current value of foo is: &quot;&lt;/span&gt; + foo)       &lt;span class=&quot;code-comment&quot;&gt;// foo breaks with CompileDynamic only
&lt;/span&gt;  }
}

@CompileDynamic
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CDChild &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CDParent
{
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Windows</environment>
        <key id="12811961">GROOVY-7054</key>
            <summary>Read Only Property not resolved correctly at runtime (w/CompileDynamic)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="ilbmiller">Brad Miller</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Sep 2014 16:29:37 +0000</created>
                <updated>Wed, 17 Dec 2014 13:25:41 +0000</updated>
                            <resolved>Wed, 3 Sep 2014 07:33:19 +0000</resolved>
                                    <version>2.3.4</version>
                                    <fixVersion>2.3.7</fixVersion>
                    <fixVersion>2.4.0-beta-4</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14476376" author="blackdrag" created="Wed, 3 Sep 2014 07:33:19 +0000"  >&lt;p&gt;thanks for pointing this bug out. It is easy to be mistaken as &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2433&quot; title=&quot;Closure in base class unable to call private methods when invoked from derived class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2433&quot;&gt;&lt;del&gt;GROOVY-2433&lt;/del&gt;&lt;/a&gt;, but it is indeed different. Fixed&lt;/p&gt;</comment>
                            <comment id="14476415" author="blackdrag" created="Wed, 3 Sep 2014 07:39:41 +0000"  >&lt;p&gt;A note... while reading the property is now possible, setting it still is not. For this the current MOP is missing some parts&lt;/p&gt;</comment>
                            <comment id="14476492" author="blackdrag" created="Wed, 3 Sep 2014 09:32:18 +0000"  >&lt;p&gt;Since I did not really answer your question... Groovy keeps meta information with every property request and method call, that contain for example the static origin class of the call. This is then used to make private methods visible in child classes. So if a child class calls a method from the parent class this method will see all public methods visible in the child (this is different to Java) and all private methods of the parent.&lt;/p&gt;

&lt;p&gt;Now the Groovy MOP was done before such a meta information was added. Whenever we go through a GroovyObject method we loose the meta information. While the logic for invokeMethod is usually to be called quite late and thus allows us to largely bypass the MOP, getProperty is called early on. We can still bypass it in some cases, but many of them just do not allow it.  &lt;/p&gt;

&lt;p&gt;In general we bypass it if the method has been added by the compiler. This is the case here, thus we it can be done. In case of a Closure for example this is not the case, hence &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-2433&quot; title=&quot;Closure in base class unable to call private methods when invoked from derived class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-2433&quot;&gt;&lt;del&gt;GROOVY-2433&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14476475" author="blackdrag" created="Wed, 3 Sep 2014 09:34:10 +0000"  >&lt;p&gt;As for @CompileStatic. It uses basically the same scoping rules as Groovy, but only static scopes, no dynamic ones. And then it produces direct calls instead of runtime method selection. So as long as the compiler can see it and determines it visible for the scope, it exists.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cimf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>