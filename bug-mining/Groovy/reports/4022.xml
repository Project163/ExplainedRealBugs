<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:10:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-3422] unable to reference one static closure from another without class name prefix</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-3422</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I&apos;ve hit an issue in groovy 1.6 where one statically defined closure can&apos;t seem to access another static closure in the same class without prefixing the actual name of the class on the call to the closure.&lt;/p&gt;

&lt;p&gt;This test case demonstrates the issue:&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;#! /usr/bin/env groovy&lt;/p&gt;

&lt;p&gt;class Foo {&lt;br/&gt;
    static first = &lt;/p&gt;
{ val -&amp;gt; &quot;first $val&quot; }
&lt;p&gt;    // works as expected&lt;br/&gt;
    static second = &lt;/p&gt;
{ Foo.first( &quot;second&quot; ) }
&lt;p&gt;    // doesn&apos;t work, apparently &quot;first&quot; is not in scope, is this expected behavior?&lt;br/&gt;
    static third = &lt;/p&gt;
{ first( &quot;third&quot; ) }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;assert &quot;first second&quot; == Foo.second()  // OK in 1.6&lt;br/&gt;
assert &quot;first third&quot; == Foo.third()  // blows up in 1.6!&lt;/p&gt;</description>
                <environment>groovy 1.6 java 1.6</environment>
        <key id="12814604">GROOVY-3422</key>
            <summary>unable to reference one static closure from another without class name prefix</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tednaleid">Ted Naleid</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Mar 2009 10:08:45 +0000</created>
                <updated>Sun, 2 May 2021 09:18:28 +0000</updated>
                            <resolved>Thu, 4 Mar 2021 19:50:09 +0000</resolved>
                                    <version>1.6</version>
                    <version>2.4.3</version>
                                    <fixVersion>4.0.0-alpha-3</fixVersion>
                                    <component>Compiler</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14466768" author="blackdrag" created="Sat, 21 Mar 2009 13:08:03 +0000"  >&lt;p&gt;Roshan, I am assigning this issue to you, because I think you recently resolved something compareable. If you are not ok with that, then assign the issue to me.&lt;/p&gt;</comment>
                            <comment id="14466681" author="roshandawrani" created="Tue, 24 Mar 2009 06:58:18 +0000"  >&lt;p&gt;Jochen, any initial opinion/input on whether it is better to try to resolve this unqualified call to static closure at compile-time or at run-time (meta-class infrastructure)?&lt;/p&gt;</comment>
                            <comment id="14466708" author="blackdrag" created="Tue, 24 Mar 2009 07:51:32 +0000"  >&lt;p&gt;the same program in a non static variant works, so I would say it should work both times in the same style.&lt;/p&gt;</comment>
                            <comment id="14466786" author="roshandawrani" created="Thu, 26 Mar 2009 13:11:12 +0000"  >&lt;p&gt;Hi Jochen, I am a little tied up in my job for some days and am not able to give it sufficient time. So, I am assigning it back to you for now but I will try it as soon as I can. I don&apos;t want to hold it with me unnecessarily if it can be resolved much faster by you in the meanwhile.&lt;/p&gt;

&lt;p&gt;rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14466723" author="roshandawrani" created="Wed, 1 Apr 2009 14:12:37 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
    I am attaching a patch that fixes the reported issue. Right now, the patch is based on 1.5.x branch. I wanted to have it reviewed before also trying the same approach on 1.6.x and trunk.&lt;/p&gt;

&lt;p&gt;So, basically the fix is that when a closure&apos;s delegate/owner is a class, it was only looking for static meta method. After the patch, if a static meta method is not found, it checks if it has a static closure property of the same name and if it finds it, it maps the call to that closure&apos;s doCall() method and also changes the object (on which this doCall() should be called) to the closure instance.&lt;/p&gt;

&lt;p&gt;Please let me know if the fix looks ok. The patch has a test case and all existing tests have gone through.&lt;/p&gt;

&lt;p&gt;rgds,&lt;br/&gt;
Roshan&lt;/p&gt;</comment>
                            <comment id="14466736" author="roshandawrani" created="Sat, 4 Apr 2009 01:07:14 +0000"  >&lt;p&gt;Jochen, did you get a chance to review the patch?&lt;/p&gt;

&lt;p&gt;Shall I go ahead using it to fix the issue?&lt;/p&gt;</comment>
                            <comment id="14466808" author="blackdrag" created="Mon, 6 Apr 2009 06:42:27 +0000"  >&lt;p&gt;I don&apos;t like that array solution very much... Since we do a static call can&apos;t we use the declaration class of the meta method to set the call class?&lt;/p&gt;</comment>
                            <comment id="14466738" author="roshandawrani" created="Mon, 6 Apr 2009 06:55:02 +0000"  >&lt;p&gt;I am not sure about that. I can&apos;t confirm as I don&apos;t have the source in front of me right now. But mapping of the call to static closure is being done to doCall() of the closure instance. So that closure instance is being put into the array element in being returned in this particular scenario. It is not the call class that is needed, it is the call object, which I don&apos;t think can be retrieved from the MetaMethod, can it?&lt;/p&gt;

&lt;p&gt;Yes, the array solution does not look very clean. I can introduce a small helper class to combine the meta method and the call object and return them together. I think it is private method anyway.&lt;/p&gt;</comment>
                            <comment id="14466792" author="blackdrag" created="Mon, 6 Apr 2009 07:01:34 +0000"  >&lt;p&gt;oh, you are right about the call object.. A helper class is not needed, if it is only to wrap the result.But I prefer to that you return the array instead of giving it in from outside. The it is at last clear that more than one value is returned. The array values do need comments of course and one more thing.. I think MetaClassImpl is duplicating the logic, so you should look there too. Best is if you repeat the test with using MetaClassImpl as MetaClass for the Closure&lt;/p&gt;</comment>
                            <comment id="14466871" author="roshandawrani" created="Mon, 6 Apr 2009 07:05:56 +0000"  >&lt;p&gt;All is clear and I will look at the duplicated logic that you have pointed to.&lt;/p&gt;

&lt;p&gt;But I did not understand what you mean by &quot;repeat the test with using MetaClassImpl as MetaClass for the Closure&quot;. Can you explain that a bit please? Thanks.&lt;/p&gt;</comment>
                            <comment id="14466881" author="blackdrag" created="Mon, 6 Apr 2009 07:21:24 +0000"  >&lt;p&gt;the default meta class of a closure is ClosureMetaClass. In case that ExpandoMetaClass#enableGlobally() is called the closures will not get ClosureMetaClass as default, they will get ExpandoMetaClass as default. And that one is based on MetaClassImpl. so as the metaclass system is as of now tis means that ClosureMetaClass and MetaClassImpl will have to have both logic to handle closures. ClosureMetaClass is optimizing same cases, MetaClassImpl is not. So I suggest you do closure.metaClass = ... for every closure you test and then run the test again&lt;/p&gt;</comment>
                            <comment id="14474882" author="blackdrag" created="Wed, 21 Aug 2013 06:19:04 +0000"  >&lt;p&gt;The issue has the problematic point, that closure needs to do a property lookup from within method lookup on something else than itself. This is something possibly influencing the MOP, thus I set a new fix version. For example we have to discuss if that should be done, and what helper methods should be used if it is done. Currently it is not done at all here&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721996" name="3422_v15X.txt" size="7834" author="roshandawrani" created="Wed, 1 Apr 2009 14:12:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2c9fr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>