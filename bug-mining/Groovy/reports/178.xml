<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:56:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-835] GroovyClassloader doesn&apos;t use CompilerConfiguration for classpath</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-835</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I&apos;m looking to try and pass a classpath into GroovyClassLoader and found little documentation, so I looked at the source and found that while you can set a classpath on the CompilerConfiguration object that you pass to GroovyClassLoader the classpath specified in the configuration object is not actually used by the classloader.  Instead it always looks at the system property java.class.path.  See GroovyClassLoader.getClassPath(), line 380, and note that searchPaths is not assigned anywhere else.  This makes it rather difficult to change the path that is searched by such a classloader.&lt;/p&gt;

&lt;p&gt;This should be rather trivial to fix and would make things easier to debug and more consistent.&lt;/p&gt;</description>
                <environment>Linux, JDK 1.5.0</environment>
        <key id="12812784">GROOVY-835</key>
            <summary>GroovyClassloader doesn&apos;t use CompilerConfiguration for classpath</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="franck_rasolo">Franck Rasolo</assignee>
                                    <reporter username="jpschewe">Jon Schewe</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 May 2005 16:08:08 +0000</created>
                <updated>Fri, 5 Aug 2005 06:52:26 +0000</updated>
                            <resolved>Fri, 24 Jun 2005 16:17:23 +0000</resolved>
                                    <version>1.0-JSR-1</version>
                                    <fixVersion>1.0-JSR-3</fixVersion>
                                    <component>groovy-jdk</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="14460961" author="jpschewe" created="Thu, 5 May 2005 17:03:28 +0000"  >&lt;p&gt;Here is the modified getClassPath method that I created in a subclass of GroovyClassLoader to get around this problem.&lt;br/&gt;
  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Mirror the value in the superclass since it&apos;s private and we need to&lt;/li&gt;
	&lt;li&gt;access it for the classpath.&lt;br/&gt;
   */&lt;br/&gt;
  private final CompilerConfiguration _config;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Mirror the value in the superclass since it&apos;s private and we need to&lt;/li&gt;
	&lt;li&gt;access it for the classpath.&lt;br/&gt;
   */&lt;br/&gt;
  private String[] _searchPaths;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Workaround for Groovy-835&lt;br/&gt;
   */&lt;br/&gt;
  protected String[] getClassPath() {&lt;br/&gt;
    if (null == _searchPaths) {&lt;br/&gt;
      final String classpath;&lt;br/&gt;
      if(null != _config &amp;amp;&amp;amp; null != _config.getClasspath()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {        //there&amp;#39;s probably a better way to do this knowing the internals of        //Groovy, but it works for now        final List paths = _config.getClasspath();        final StringBuffer sb = new StringBuffer();        for(Iterator iter = paths.iterator(); iter.hasNext(); ) {
          sb.append(iter.next().toString());
          sb.append(File.pathSeparatorChar);
        }        //remove extra path separator        sb.deleteCharAt(sb.length()-1);        classpath = sb.toString();      }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else &lt;/p&gt;
{
        classpath = System.getProperty(&quot;java.class.path&quot;, &quot;.&quot;);
      }
&lt;p&gt;      final List pathList = new ArrayList();&lt;br/&gt;
      expandClassPath(pathList, null, classpath);&lt;br/&gt;
      _searchPaths = new String&lt;span class=&quot;error&quot;&gt;&amp;#91;pathList.size()&amp;#93;&lt;/span&gt;;&lt;br/&gt;
      _searchPaths = (String[]) pathList.toArray(_searchPaths);&lt;br/&gt;
    }&lt;br/&gt;
    return _searchPaths;&lt;br/&gt;
  }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14461037" author="guillaume" created="Wed, 11 May 2005 15:00:18 +0000"  >&lt;p&gt;Jon, could you provide a full patch of your modifications? I know you&apos;ve created a derived class, but I guess you could make the modification on GCL itself. Thanks in advance.&lt;/p&gt;</comment>
                            <comment id="14460932" author="guillaume" created="Wed, 11 May 2005 15:13:29 +0000"  >&lt;p&gt;No need for a full patch, I&apos;ve applied your changes.&lt;br/&gt;
Thanks Jon!&lt;/p&gt;</comment>
                            <comment id="14460852" author="jpschewe" created="Wed, 11 May 2005 15:16:38 +0000"  >&lt;p&gt;Here&apos;s the patch file that will work.  I&apos;ve also updated some comments on the related functions.  It might be made more efficient if CompilerConfiguration did the expansion that GroovyClassLoader does and then the code wouldn&apos;t have to build up the classpath as a single string and then break it down again.&lt;/p&gt;</comment>
                            <comment id="14461017" author="guillaume" created="Wed, 11 May 2005 15:36:39 +0000"  >&lt;p&gt;I made the modification before seeing your patch, but I think I made the correct changes.&lt;br/&gt;
If you want, you can check against CVS Head to see if it&apos;s okay with you.&lt;br/&gt;
Thanks a lot for your very quick feedback!&lt;/p&gt;</comment>
                            <comment id="14460996" author="jpschewe" created="Fri, 13 May 2005 20:02:36 +0000"  >&lt;p&gt;That should work.  One change I made in the patch was to use space instead of File.seaparatorChar.  According to the comments in expandClassPath this is more correct.&lt;/p&gt;</comment>
                            <comment id="14461146" author="jpschewe" created="Wed, 22 Jun 2005 12:45:19 +0000"  >&lt;p&gt;This wasn&apos;t quite implemented correctly.  I went and grabbed the JSR-02 release and see that you&apos;ve got searchPaths AND _searchPaths.  As my comments state, I&apos;ve created _searchPaths because searchPaths is private in GroovyClassLoader and I can&apos;t access it.  You should replace all instances of _searchPaths with searchPaths in your code.&lt;/p&gt;</comment>
                            <comment id="14461205" author="jpschewe" created="Wed, 22 Jun 2005 13:13:02 +0000"  >&lt;p&gt;In addition, the functionality used here seems to have been removed from the JSR-02 release.  I have come to find that the findClass implementation in GroovyClassLoader has been commented out (line 278). Therefore groovy scripts referenced from another groovy script will not be found anyway.&lt;/p&gt;</comment>
                            <comment id="14461093" author="jpschewe" created="Wed, 22 Jun 2005 13:28:28 +0000"  >&lt;p&gt;OK, strike my last comment.  I&apos;ve got it working without the findClass implementation.  Although, you still need to remove the extra searchPaths references, otherwise addClasspath won&apos;t work properly.&lt;/p&gt;</comment>
                            <comment id="14461247" author="franck_rasolo" created="Fri, 24 Jun 2005 16:17:22 +0000"  >&lt;p&gt;Jon, I&apos;ve removed _searchPaths as you originally requested. Thanks again for the patch!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721541" name="GroovyClassloader.java.patch" size="1932" author="jpschewe" created="Wed, 11 May 2005 15:16:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cdvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>