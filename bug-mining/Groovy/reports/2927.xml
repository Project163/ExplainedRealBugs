<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:46:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7522] TupleConstructor overwrites declared constructors</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7522</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;&lt;tt&gt;@TupleConstructor&lt;/tt&gt; should not overwrite existing empty default constructors.  For example, this should work, but doesn&apos;t currently&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Cat(&lt;span class=&quot;code-quote&quot;&gt;&quot;Mr. Bigglesworth&quot;&lt;/span&gt;).name == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// fails
&lt;/span&gt;
@groovy.transform.TupleConstructor
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Cat {
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name
  &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; age
  Cat(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Granted, this is an edge case.  But unexpected behavior, nonetheless.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12848730">GROOVY-7522</key>
            <summary>TupleConstructor overwrites declared constructors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="keegan">Keegan Witt</reporter>
                        <labels>
                            <label>breaking_change</label>
                    </labels>
                <created>Thu, 23 Jul 2015 23:11:10 +0000</created>
                <updated>Mon, 21 Nov 2022 17:16:08 +0000</updated>
                            <resolved>Thu, 6 Aug 2015 03:12:12 +0000</resolved>
                                                    <fixVersion>2.5.0-alpha-1</fixVersion>
                                    <component>xforms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14639689" author="keegan" created="Thu, 23 Jul 2015 23:55:50 +0000"  >&lt;p&gt;In theory, this could break someone&apos;s existing code if they were relying on the overwriting happening.  This could be avoided by adding a Boolean to control this behavior.&lt;/p&gt;</comment>
                            <comment id="14639804" author="keegan" created="Fri, 24 Jul 2015 01:46:01 +0000"  >&lt;p&gt;This seems to be happening because &lt;tt&gt;TupleConstructorASTTransformation.createConstructor()&lt;/tt&gt; has&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (constructors.size() &amp;gt; 1 &amp;amp;&amp;amp; !force) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; foundEmpty = constructors.size() == 1 &amp;amp;&amp;amp; constructors.get(0).getFirstStatement() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (constructors.size() == 1 &amp;amp;&amp;amp; !foundEmpty &amp;amp;&amp;amp; !force) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, actually my example is an edge condition.  You only run into the problem if you provided 1 constructor and it was empty.  Unless I&apos;m misunderstanding.&lt;/p&gt;</comment>
                            <comment id="14639816" author="keegan" created="Fri, 24 Jul 2015 02:19:42 +0000"  >&lt;p&gt;So I guess the questions are&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Do we want to write just the missing constructors instead of having a no-op when existing constructors are encountered?&lt;/li&gt;
	&lt;li&gt;If not, could we safely change to &lt;tt&gt;&amp;gt; 0&lt;/tt&gt; instead of &lt;tt&gt;&amp;gt; 1&lt;/tt&gt;?  Or is that unavoidable because of the possibility of stubs bringing in an extraneous constructor?&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;If we decide to leave as-is, maybe we&apos;ll re-purpose this Jira for documenting this edge case.&lt;/p&gt;</comment>
                            <comment id="14641533" author="paulk" created="Sat, 25 Jul 2015 10:48:10 +0000"  >&lt;p&gt;Your understanding is correct that this is an edge case; the problem occurs because you are providing one empty constructor. You are also correct in your assessment that we can&apos;t change from &lt;tt&gt;&amp;gt; 1&lt;/tt&gt; to &lt;tt&gt;&amp;gt; 0&lt;/tt&gt; because of stubs.&lt;/p&gt;

&lt;p&gt;In theory, we could make it smarter to write as you say &quot;just the missing constructors&quot;. But it turns out to be a little more complex than you might expect. The tuple constructor generated makes use of Groovy&apos;s optional args. Then, in later compilation phases such constructors are replaced by the multiple equivalent Java constructors. E.g.:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@TupleConstructor
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Person { &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; first, last; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; age }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;would get this chain of generated constructors:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Person(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; first, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; last, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; age)
Person(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; first, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; last)
Person(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; first)
Person()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To work out what the missing ones are, you&apos;d have to pre-calculate all of the final list of generated constructors for not only the @TupleConstructor generated one but any existing explicit ones using default parameters. Then there is the added complication of when there is a chain with an explicit duplicate in the middle. It&apos;s not clear whether the code generated for the missing variant(s) should call the code within the explicitly provided variant(s) or behave more like what the original tuple generated version would behave? Often, using &lt;tt&gt;force&lt;/tt&gt; can help in some of the edge cases but not yours - it does the opposite of what you&apos;d want.&lt;/p&gt;

&lt;p&gt;This annotation was written prior to annotation aliases. Another potential solution to making such transforms smarter is to split it into two parts which run in different phases of the compiler. TupleConstructor would then become the alias to the other two parts. Having said that, I can&apos;t think of an obvious split that would help here.&lt;/p&gt;

&lt;p&gt;So my recommendation is to take up your &quot;re-purpose&quot; option and improve the documentation for this edge case.&lt;/p&gt;</comment>
                            <comment id="14641849" author="keegan" created="Sun, 26 Jul 2015 05:14:23 +0000"  >&lt;p&gt;Okie dokie.  Any other edge cases you can think of that I missed?&lt;/p&gt;</comment>
                            <comment id="14641852" author="paulk" created="Sun, 26 Jul 2015 05:44:04 +0000"  >&lt;p&gt;Actually, thinking about it a bit more, perhaps we could change the stub code to use node metadata to indicate that it added an empty default constructor. That could allow a better workaround.&lt;/p&gt;</comment>
                            <comment id="14641985" author="keegan" created="Sun, 26 Jul 2015 15:08:54 +0000"  >&lt;p&gt;Sorry for the spam of multiple edits, was having browser issues.&lt;/p&gt;</comment>
                            <comment id="14644384" author="githubbot" created="Tue, 28 Jul 2015 13:47:14 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/75&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7522&quot; title=&quot;TupleConstructor overwrites declared constructors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7522&quot;&gt;&lt;del&gt;GROOVY-7522&lt;/del&gt;&lt;/a&gt;: TupleConstructor overwrites empty default constructors&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/incubator-groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/incubator-groovy&lt;/a&gt; groovy7522&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/75.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/75.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #75&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 891aaa2f7f11afc4a62f0501ccae550f23c4ff05&lt;br/&gt;
Author: Paul King &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2015-07-28T13:45:14Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7522&quot; title=&quot;TupleConstructor overwrites declared constructors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7522&quot;&gt;&lt;del&gt;GROOVY-7522&lt;/del&gt;&lt;/a&gt;: TupleConstructor overwrites empty default constructors&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14646238" author="keegan" created="Wed, 29 Jul 2015 15:07:23 +0000"  >&lt;p&gt;I updated the Jira, based on our conversation.&lt;/p&gt;</comment>
                            <comment id="14659400" author="paulk" created="Thu, 6 Aug 2015 03:13:42 +0000"  >&lt;p&gt;Since this is a breaking change - only for the very specific edge case of an explicit empty includes - I am leaving in just the 2.5 stream.&lt;/p&gt;</comment>
                            <comment id="14659420" author="githubbot" created="Thu, 6 Aug 2015 03:28:03 +0000"  >&lt;p&gt;Github user paulk-asert closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-groovy/pull/75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/incubator-groovy/pull/75&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13487154">GROOVY-10790</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hv9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>