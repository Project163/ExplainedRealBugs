<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:56:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-8200] Shorthand |= results in NPE</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-8200</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;I&apos;ve stumbled across some curious behaviour for the shorthand assignment operator in Groovy v2.3.11 (symptom also present in Groovy v2.4.9).&lt;/p&gt;

&lt;p&gt;The following &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12869454/12869454_shorthand_or_symptom.groovy&quot; title=&quot;shorthand_or_symptom.groovy attached to GROOVY-8200&quot;&gt;boolean or logic&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;, unexpectedly throws &lt;tt&gt;NullPointerException&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; x = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;

&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt; hand unrolled:  x = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || x
&lt;/span&gt;
x |= &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;// -&amp;gt; unexpected NullPointerException
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !x&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The same approach for &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12869453/12869453_shorthand_and.groovy&quot; title=&quot;shorthand_and.groovy attached to GROOVY-8200&quot;&gt;boolean and logic&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;, performs as expected.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; x = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;

&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt; hand unrolled:  x = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; x
&lt;/span&gt;
x &amp;amp;= &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;

&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !x&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s possible to work around the issue with explicit cast.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;x |= &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Groovy Version: 2.3.11 JVM: 1.7.0_80 Vendor: Oracle Corporation OS: Linux&lt;br/&gt;
&lt;br/&gt;
java version &amp;quot;1.7.0_80&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0_80-b15)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 24.80-b11, mixed mode)</environment>
        <key id="13074190">GROOVY-8200</key>
            <summary>Shorthand |= results in NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="dleh">Daniel Hammer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 May 2017 12:54:05 +0000</created>
                <updated>Tue, 6 Mar 2018 23:25:34 +0000</updated>
                            <resolved>Sun, 24 Sep 2017 10:55:23 +0000</resolved>
                                    <version>2.3.11</version>
                                    <fixVersion>2.5.0-beta-2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16021635" author="blackdrag" created="Tue, 23 May 2017 18:46:01 +0000"  >&lt;p&gt;x|=null is x=x|null, which results in x.or(null). You will see here that the expanded version and shorthand work the same. x=x||null will first convert x to boolean and depending on true or false we will also convert the null. Similar for the logic and binary and.&lt;/p&gt;</comment>
                            <comment id="16022473" author="dleh" created="Wed, 24 May 2017 07:51:37 +0000"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt;, I&apos;m sorry but it seems my explanation wasn&apos;t clear enough. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;... Similar for the logic and binary and.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;By executing the attached examples you&apos;ll be able to confirm that &lt;tt&gt;x |= null&lt;/tt&gt; throws NPE and &lt;tt&gt;x &amp;amp;= null&lt;/tt&gt; adheres to Groovy truth.&lt;br/&gt;
That&apos;s an inconsistency regarding null-handling in the |= shorthand notation and violates the &lt;a href=&quot;https://en.wikipedia.org/wiki/Principle_of_least_astonishment&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;principle of least astonishment&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16022505" author="dleh" created="Wed, 24 May 2017 08:18:08 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12869598/12869598_shorthand_xor_symptom.groovy&quot; title=&quot;shorthand_xor_symptom.groovy attached to GROOVY-8200&quot;&gt;Exclusive or&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;tt&gt;x ^= null&lt;/tt&gt; also throws NPE, same as &lt;tt&gt;x |= null&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16022813" author="blackdrag" created="Wed, 24 May 2017 12:33:21 +0000"  >&lt;p&gt;ah, ok, there is indeed a misunderstanding.  For &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; x = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;  
x &amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will NPE, but if you set x to false (the boolean sight on null) It does not NPE. That is imho because not both sides are evaluated. This is wrong and should be fixed. The inconsistency though is in the handling of &amp;amp; and &amp;amp;= not in the others. &lt;/p&gt;</comment>
                            <comment id="16023180" author="dleh" created="Wed, 24 May 2017 16:31:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt;, thank you for revisiting this issue, it&apos;s much appreciated.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;...&lt;br/&gt;
This is wrong and should be fixed.&lt;br/&gt;
...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree, consistency above all.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;...&lt;br/&gt;
The inconsistency though is in the handling of &amp;amp; and &amp;amp;= not in the others.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;But from a usability view, I think that having &lt;tt&gt;null&lt;/tt&gt; adhere to Groovy truth is the convention I would expect Groovy to follow.&lt;br/&gt;
Ie. it would be preferable to avoid explicit cast ex.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; success = method1(...)
success |= methodMightReturnNull(...) as &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; is disturbing the groove
&lt;/span&gt;success |= x == y
...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My point is; having the NPE thrown is unexpected as Groovy usually handles the conversion from &lt;tt&gt;null&lt;/tt&gt; to Groovy truth transparently and consistently.&lt;br/&gt;
Deviating from that convention introduces risk when using the shorthand notation, because then an extra manual step is required by the developer in-order to avoid a hidden NPE.&lt;/p&gt;</comment>
                            <comment id="16023385" author="blackdrag" created="Wed, 24 May 2017 18:21:31 +0000"  >&lt;p&gt;I think you are let astray a bit by the fact, that we are talking about booleans. But those binary operators are not specific to booleans at all. I can do for example &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;X {
  def foo
  def or(X x) {&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(foo:foo+&lt;span class=&quot;code-quote&quot;&gt;&quot; or &quot;&lt;/span&gt;+x.foo)}
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString(){foo}
}

def a = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(foo:&lt;span class=&quot;code-quote&quot;&gt;&quot;to be&quot;&lt;/span&gt;)
def b = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; X(foo:&lt;span class=&quot;code-quote&quot;&gt;&quot;not to be ...&quot;&lt;/span&gt;)
println a|b
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and I would get &quot;to be or not to be&quot;.&lt;/p&gt;

&lt;p&gt;Now, what would you expect as result in this if a is null, or b is null or if both are null? And why is it different for boolean?&lt;/p&gt;

&lt;p&gt;Also please do not forget, that Groovy truth is applied automatically only in very certain well known cases. null||x works, because the compiler enforces a boolean case for the operands. Then does x||null and even null||null. It does not matter what type x is here, because of this enforcement. But this also means not having a method behind this operator. This is completely extended by the compiler in exactly one way and only this way. The same goes for example for &quot;if &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;...&quot;. Here we do know again we require a boolean and the compiler will cause a boolean cast to ensure this.&lt;/p&gt;</comment>
                            <comment id="16028400" author="dleh" created="Mon, 29 May 2017 14:22:17 +0000"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blackdrag&quot; class=&quot;user-hover&quot; rel=&quot;blackdrag&quot;&gt;blackdrag&lt;/a&gt;; ahh, I see, I had forgotten Groovys support for operator-overload, this complicates matters a bit.&lt;br/&gt;
On one hand I see the use-case for meta-programming support, and on the other hand I appreciate the simplicity of Groovys truth convention and boolean operators as-is.&lt;/p&gt;

&lt;p&gt;I know which approach I would prefer, but I&apos;m unable to fully comprehend the consequences of either.&lt;/p&gt;

&lt;p&gt;Quite the conundrum &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16031729" author="githubbot" created="Wed, 31 May 2017 19:01:50 +0000"  >&lt;p&gt;GitHub user noamt opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/555&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8200&quot; title=&quot;Shorthand |= results in NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8200&quot;&gt;&lt;del&gt;GROOVY-8200&lt;/del&gt;&lt;/a&gt; - Shorthand |= results in NPE&lt;/p&gt;

&lt;p&gt;    Fixing the NPE with an explicit test and assignment of the right-hand boolean operator.&lt;br/&gt;
    Assigning a primitive boolean variable with null, like `boolean x = null`, will end up as `false`.&lt;br/&gt;
    I think it only makes sense to apply the same behavior to the right hand operator.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/noamt/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/noamt/groovy&lt;/a&gt; GroovyGROOVY-8200&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/555.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/555.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #555&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 11a0b159d8d04f3c1e518613566a1b459ecda44d&lt;br/&gt;
Author: noamt &amp;lt;noam@10ne.org&amp;gt;&lt;br/&gt;
Date:   2017-05-31T18:57:04Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-8200&quot; title=&quot;Shorthand |= results in NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-8200&quot;&gt;&lt;del&gt;GROOVY-8200&lt;/del&gt;&lt;/a&gt; - Shorthand |= results in NPE:&lt;br/&gt;
    Fixing the NPE with an explicit test and assignment of the right-hand boolean operator.&lt;br/&gt;
    Assigning a primitive boolean variable with null, like `boolean x = null`, will end up as `false`.&lt;br/&gt;
    I think it only makes sense to apply the same behavior to the right hand operator.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16178139" author="githubbot" created="Sun, 24 Sep 2017 10:10:57 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/555&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16178151" author="paulk" created="Sun, 24 Sep 2017 10:55:24 +0000"  >&lt;p&gt;I agree with Jochen&apos;s comment that we don&apos;t want any special treatment of the expansion into the &lt;tt&gt;or&lt;/tt&gt; method in this case for the &lt;tt&gt;|=&lt;/tt&gt; shorthand. I also agree with John&apos;s assessment in the PR that the implementation of &lt;tt&gt;or&lt;/tt&gt; could handle this case for &lt;tt&gt;Boolean&lt;/tt&gt; only. Proposed PR merged but only from 2.5.0-beta-2 onwards which allows us some time to re-consider before 2.5.0 final comes out.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12869453" name="shorthand_and.groovy" size="235" author="dleh" created="Tue, 23 May 2017 12:54:05 +0000"/>
                            <attachment id="12869454" name="shorthand_or_symptom.groovy" size="235" author="dleh" created="Tue, 23 May 2017 12:54:05 +0000"/>
                            <attachment id="12869598" name="shorthand_xor_symptom.groovy" size="220" author="dleh" created="Wed, 24 May 2017 08:18:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fcpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>