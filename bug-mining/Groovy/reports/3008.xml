<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:48:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-7530] disjoint() does not work correctly if objects don&apos;t implement Comparable</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-7530</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name

    Foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.name = name
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; equals(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; == o) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || getClass() != o.getClass()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
        Foo that = (Foo) o
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Objects.equals(name, that.name)
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; hashCode() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Objects.hash(name)
    }

}

def a = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]
def b = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]    
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !a.disjoint(b)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If disjoint() is used on a list with objects not implementing Comparable the wrong result is returned.&lt;br/&gt;
intersect() shows the same wrong behavior.&lt;/p&gt;

&lt;p&gt;It&apos;s looks like the NumberAwareComparator not implementing the equals case as of commit 286532c is the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12850207">GROOVY-7530</key>
            <summary>disjoint() does not work correctly if objects don&apos;t implement Comparable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="tahlers">Tobias Ahlers</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jul 2015 10:16:07 +0000</created>
                <updated>Sun, 12 Jun 2016 08:45:14 +0000</updated>
                            <resolved>Thu, 3 Mar 2016 12:27:02 +0000</resolved>
                                    <version>2.4.4</version>
                                    <fixVersion>2.4.7</fixVersion>
                                    <component>groovy-runtime</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14728573" author="jeegar12" created="Thu, 3 Sep 2015 06:38:08 +0000"  >&lt;p&gt;Please would you make this Fix ASAP, as this is causing vulnerability issues in our project.&lt;/p&gt;</comment>
                            <comment id="14728582" author="blackdrag" created="Thu, 3 Sep 2015 06:56:20 +0000"  >&lt;p&gt;If it is non-static Groovy code calling the method, you can provide your own extension module to provide this method by yourself and overwrite the version in the runtime as at quick fix. As for the vulnerability, it would be nice to have explained how. Because otherwise a fix of this (if done), may not fix your problem.&lt;/p&gt;</comment>
                            <comment id="14729668" author="kekekevin" created="Thu, 3 Sep 2015 19:52:46 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;compare.groovy&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name

    Foo(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.name = name
    }

    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; equals(o) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.is(o)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getClass() != o.class) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;

        Foo that = (Foo) o

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (name != that.name) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
    }

    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; hashCode() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Objects.hash(name)
    }

}


def a = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]
def b = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)] as &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[]

a.removeAll(b)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !a

def c = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]
def d = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)] as &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[]

c.retainAll(d)
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; c
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Seems like this will also fail for certain implementations of removeAll and retainAll.  Since NumberAwareComparator seems to be the root cause of this issue, there could be quite a few extension methods required to workaround this issue.  Would you happen to know if there are additional instances where NumberAwareComparator is the only source of comparison?&lt;/p&gt;

&lt;p&gt;Also, while it may be possible to implement Comparable on objects in which I control the source, any objects that are imported are beyond my control.&lt;/p&gt;</comment>
                            <comment id="14954456" author="jeegar12" created="Tue, 13 Oct 2015 06:04:00 +0000"  >&lt;p&gt;I agree with Kevin on this! &lt;br/&gt;
Can we get this fixed at the base class level?&lt;/p&gt;</comment>
                            <comment id="15081857" author="apreston" created="Mon, 4 Jan 2016 21:36:35 +0000"  >&lt;p&gt;Hi Tobias - would you be able to raise this fix for priority?  We need to remediate vulnerability issues asap.&lt;/p&gt;</comment>
                            <comment id="15082047" author="paulk" created="Mon, 4 Jan 2016 23:58:15 +0000"  >&lt;p&gt;I&apos;m still keen to understand if there is a vulnerability issue. Jeegar can you elaborate further? Do you mean security vulnerability? Or just that it doesn&apos;t behave as you expected?&lt;/p&gt;</comment>
                            <comment id="15082995" author="blackdrag" created="Tue, 5 Jan 2016 12:46:17 +0000"  >&lt;p&gt;if there is an issue about talking about the security problem per se, then I suggest mailing either us directly by mail or to use the apache security infrastructure through &lt;a href=&quot;http://www.apache.org/security/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/security/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15083434" author="apreston" created="Tue, 5 Jan 2016 17:37:17 +0000"  >&lt;p&gt;Paul/Jochen - apologies for the lack of clarity.  In order to mitigate a security vulernability with Groovy 1.7.0 through 2.4.3 (CVE-2015-3253) we attempted to upgrade to 2.4.4 where we are running into this disjoint not working properly.  I will defer to Jeegar to clarify his comment.&lt;/p&gt;</comment>
                            <comment id="15085307" author="blackdrag" created="Wed, 6 Jan 2016 09:39:31 +0000"  >&lt;p&gt;Ok, thanks for the clarification. We had been very very much irritated by this code causing a vulnerability issue. It is not out of question, since the example exploit for CVE-2015-3253 you mentioned actually does misuse a sorting structure in Java for the exploit. so I could not totally exclude such a possibility.&lt;/p&gt;

&lt;p&gt;Anyway... back to the problem.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def a = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]
def b = [&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)]    
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; !a.disjoint(b)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The basic problem is as follows.. if the objects are somehow comparable, then you can do disjoint in O(nlogn), by first sorting one and then checking against the other. If the objects are not comparable and if I can only check for equality, then I am required to use an O(n*n) approach, by checking each elements of one list, against each of the other.. well it is more like n*n/2, but that does not matter when looking at the complexity. So in older versions we first did check both lists if all elements are Comparable, to then later decide on the strategy and go with the nlogn of the n*n variant. But this approach did also not get the desired results, as can be seen in the test in 286532c &lt;/p&gt;

&lt;p&gt;But I am wondering now... maybe the better approach is to add one more check like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (o1.getClass()==o2.getClass() &amp;amp;&amp;amp; (o1.equals(o2)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But I wonder what we are supposed to return if equals gives false. If we say we return only 0, we could also think about removing the class check. or we keep the class check and return -1 in case of equals returning false.&lt;/p&gt;</comment>
                            <comment id="15090052" author="kekekevin" created="Fri, 8 Jan 2016 22:22:49 +0000"  >&lt;p&gt;The additional check you have outlined makes sense to me, but I think you might be able to drop the class check and defer that responsibility to equals().  If equals() returns false then return -1 would seem safe.&lt;/p&gt;</comment>
                            <comment id="15090090" author="kekekevin" created="Fri, 8 Jan 2016 22:35:52 +0000"  >&lt;p&gt;Hm another consideration would be for the scenario in which the equals() is an expensive operation is that this additional check might only be warranted if the hashCodes are equal.&lt;/p&gt;</comment>
                            <comment id="15090961" author="blackdrag" created="Sun, 10 Jan 2016 09:47:56 +0000"  >&lt;p&gt;yes, also a good idea... I do like this more, because it preserves that hashcode order in case of unrelated objects&lt;/p&gt;</comment>
                            <comment id="15174654" author="apreston" created="Tue, 1 Mar 2016 23:58:46 +0000"  >&lt;p&gt;All - I see the fix version was removed.  Is there a future release date targeted for this fix? &lt;/p&gt;</comment>
                            <comment id="15174884" author="paulk" created="Wed, 2 Mar 2016 02:16:55 +0000"  >&lt;p&gt;We use the fix date to record the actual version in which it was fixed not the target one - unless it is a blocker when the two should coincide.&lt;/p&gt;</comment>
                            <comment id="15175474" author="githubbot" created="Wed, 2 Mar 2016 11:40:48 +0000"  >&lt;p&gt;GitHub user paulk-asert opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/276&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7530&quot; title=&quot;disjoint() does not work correctly if objects don&amp;#39;t implement Comparable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7530&quot;&gt;&lt;del&gt;GROOVY-7530&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7602&quot; title=&quot;Intersect returns an empty list when the contents of the compared Collections are Maps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7602&quot;&gt;&lt;del&gt;GROOVY-7602&lt;/del&gt;&lt;/a&gt;: intersect and disjoint broken for non-Co&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;mparable objects (closes #276)&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/paulk-asert/groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/paulk-asert/groovy&lt;/a&gt; groovy7530&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/276.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/276.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #276&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d3692554fc6792b6e59dc9691dfbc1add168c86c&lt;br/&gt;
Author: paulk &amp;lt;paulk@asert.com.au&amp;gt;&lt;br/&gt;
Date:   2016-03-02T11:37:07Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7530&quot; title=&quot;disjoint() does not work correctly if objects don&amp;#39;t implement Comparable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7530&quot;&gt;&lt;del&gt;GROOVY-7530&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/GROOVY-7602&quot; title=&quot;Intersect returns an empty list when the contents of the compared Collections are Maps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;GROOVY-7602&quot;&gt;&lt;del&gt;GROOVY-7602&lt;/del&gt;&lt;/a&gt;: intersect and disjoint broken for non-Comparable objects (closes #276)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15175478" author="paulk" created="Wed, 2 Mar 2016 11:42:23 +0000"  >&lt;p&gt;If I understood all the earlier comments, PR#276 should be what we require.&lt;/p&gt;</comment>
                            <comment id="15177730" author="githubbot" created="Thu, 3 Mar 2016 12:13:54 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/groovy/pull/276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/groovy/pull/276&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15177746" author="paulk" created="Thu, 3 Mar 2016 12:27:02 +0000"  >&lt;p&gt;merged PR&lt;/p&gt;</comment>
                            <comment id="15284768" author="apreston" created="Mon, 16 May 2016 16:02:33 +0000"  >&lt;p&gt;Hi All - &lt;/p&gt;

&lt;p&gt;I see this is merged to fix version 2.4.7 - can you confirm when this will be released and available for download?&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Andre&lt;/p&gt;</comment>
                            <comment id="15286274" author="paulk" created="Tue, 17 May 2016 09:19:39 +0000"  >&lt;p&gt;There is no date set at this stage. There are over twenty bug fixes already, so it would be good if we can do another release not too far down the track. You can grab snapshot artifacts in the meantime if you want.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12895938">GROOVY-7602</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i45z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>