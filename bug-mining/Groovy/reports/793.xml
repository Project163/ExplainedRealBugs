<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:08:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-2933] List Parameter in Enum constructor with misbehavior</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-2933</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;This one&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; MyEnum {
   ONE ([1,2]),
   TWO  ([3,4]);
   &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List myList
   MyEnum (List myList) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.myList=myList
    }
}
MyEnum.ONE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;leads to &quot;groovy.lang.GroovyRuntimeException: Could not find matching constructor for: MyEnum(java.lang.String, java.lang.Integer, java.lang.Integer, java.lang.Integer)&quot;&lt;/p&gt;

&lt;p&gt;Adding &quot;as List&quot;  to the List declaration works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; MyEnum {
   ONE ([1,2] as List),
   TWO  ([3,4] as List);
   &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List myList
   MyEnum (List myList) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.myList=myList
    }
}
MyEnum.ONE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;Why isn&apos;t &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;x,y,z&amp;#93;&lt;/span&gt;&quot; interpreted as a List in construction of enum instances? &lt;br/&gt;
Bug or a feature? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;-----------&lt;br/&gt;
blackdrag: &quot;looks like a bug for me.. please fill a report in JIRA&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12814210">GROOVY-2933</key>
            <summary>List Parameter in Enum constructor with misbehavior</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blackdrag">Jochen Theodorou</assignee>
                                    <reporter username="mos">M.Oliver Scheele</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jun 2008 02:41:34 +0000</created>
                <updated>Wed, 26 Nov 2008 11:45:42 +0000</updated>
                            <resolved>Wed, 26 Nov 2008 11:45:42 +0000</resolved>
                                    <version>1.5.6</version>
                                    <fixVersion>1.6-rc-1</fixVersion>
                    <fixVersion>1.5.8</fixVersion>
                    <fixVersion>1.7-beta-1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14465543" author="roshandawrani" created="Thu, 13 Nov 2008 20:49:15 +0000"  >&lt;p&gt;Just adding some details related to the issue that I looked into.&lt;/p&gt;

&lt;p&gt;When an enum constructor is invoked with a list as &quot;TWO(&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;)&quot; (enum definition below), the AST&lt;br/&gt;
that is being generated seems to be wrong (The problem might be in the CST itself from which AST gets created, but I couldn&apos;t understand the CST down/right details well enough to be sure).&lt;/p&gt;

&lt;p&gt;In the AST, the initialValueExpression that is created for the enum value field node in this case is having multiple, individual org.codehaus.groovy.ast.expr.ConstantExpression (one for each list member) instead of being one org.codehaus.groovy.ast.expr.ListExpression that wraps ConstantExpression(s) inside.&lt;/p&gt;

&lt;p&gt;As a result, what is happening is that the instead of passing &lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt; as one argument of type list, it is passing 2 argumements - each of type int.&lt;/p&gt;

&lt;p&gt;The code demonstrating it is below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Counter{
    ONE([1:&lt;span class=&quot;code-quote&quot;&gt;&quot;One&quot;&lt;/span&gt;, 2:&lt;span class=&quot;code-quote&quot;&gt;&quot;Two&quot;&lt;/span&gt;]), &lt;span class=&quot;code-comment&quot;&gt;/* AST &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Map has no issue, so &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; map gets passed correctly as a single argument */&lt;/span&gt;
    TWO([1, 2]), &lt;span class=&quot;code-comment&quot;&gt;/* instead of a list of 2 elements, it gets passed as 2 individual &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; args */&lt;/span&gt;
    THREE([10, 20, 30]); &lt;span class=&quot;code-comment&quot;&gt;/* instead of a list of 3 elements, it gets passed as 3 individual &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; args */&lt;/span&gt;

    &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; myValList = []

    Counter(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg1){
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;Enum constructor called with 1 argument&quot;&lt;/span&gt;
        myValList &amp;lt;&amp;lt; arg1
    }
    Counter(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg1, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg2){
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;Enum constructor called with 2 arguments&quot;&lt;/span&gt;
        myValList &amp;lt;&amp;lt; arg1
        myValList &amp;lt;&amp;lt; arg2
    }

    Counter(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg1, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg2, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; arg3){
        println &lt;span class=&quot;code-quote&quot;&gt;&quot;Enum constructor called with 3 arguments&quot;&lt;/span&gt;
        myValList &amp;lt;&amp;lt; arg1
        myValList &amp;lt;&amp;lt; arg2
        myValList &amp;lt;&amp;lt; arg3
    }

    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
        myValList
    }
}

println &lt;span class=&quot;code-quote&quot;&gt;&quot;Counter.ONE = ${Counter.ONE}&quot;&lt;/span&gt;
println &lt;span class=&quot;code-quote&quot;&gt;&quot;Counter.TWO = ${Counter.TWO}&quot;&lt;/span&gt;
println &lt;span class=&quot;code-quote&quot;&gt;&quot;Counter.THREE = ${Counter.THREE}&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When explicit cast &quot;as List&quot; is used, then enum&apos;s initialValueExpression correctly gets a CastExpression that wraps a ListExpression that wraps multiple ConstantExpression(s). Without the cast, ConstantExpression(s) do not get wrapped in ListExpression, which is causing the problem.&lt;/p&gt;</comment>
                            <comment id="14465502" author="roshandawrani" created="Thu, 13 Nov 2008 23:16:18 +0000"  >&lt;p&gt;Just to briefly summarize it in much fewer lines - the initial value expression in AST is:&lt;/p&gt;

&lt;p&gt;1) With casting (TWO(&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt; as List)) - CastExpression (ListExpression (ConstantExpression(1), ConstantExpression(2))) - works correctly.&lt;/p&gt;

&lt;p&gt;2) Without casting (TWO(&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;)) - (ConstantExpression(1), ConstantExpression(2)) - Does not work because it should be ListExpression (ConstantExpression(1), ConstantExpression(2))&lt;/p&gt;</comment>
                            <comment id="14465578" author="roshandawrani" created="Sat, 15 Nov 2008 00:48:11 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
    Attaching the patches that fix this issue in branches 1.5.8, 1.6-RC-1, 1.7-beta-1.&lt;/p&gt;

&lt;p&gt;In case of enum constructor being passed only one list argument, the CST was being formed correctly but AST conversion had an issue in handling the list expression.&lt;/p&gt;

&lt;p&gt;I have modified 2 files in the supplied patch:&lt;/p&gt;

&lt;p&gt;1)  org/codehaus/groovy/antlr/AntlrParserPlugin.java - Corrected the issue in handling enum taking only one list argument.&lt;/p&gt;

&lt;p&gt;2)  gls/enums/vm5/EnumTest.groovy - Added a test for this scenario.&lt;/p&gt;

&lt;p&gt;Hope it helps.&lt;/p&gt;

&lt;p&gt;Roshan&lt;/p&gt;</comment>
                            <comment id="14465738" author="blackdrag" created="Wed, 26 Nov 2008 10:17:45 +0000"  >&lt;p&gt;hmm... at last your 1.7 patch seems to be incomplete, because it fails here with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.ExceptionInInitializerError
at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName0(Native Method)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:186)
at Script1.class$(Script1.groovy)
at Script1.$get$$&lt;span class=&quot;code-keyword&quot;&gt;class$&lt;/span&gt;ListEnum1(Script1.groovy)
at Script1.run(Script1.groovy:9)
at groovy.lang.GroovyShell.evaluate(GroovyShell.java:561)
at groovy.lang.GroovyShell.evaluate(GroovyShell.java:536)
at groovy.lang.GroovyShell$evaluate.call(Unknown Source)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:43)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:124)
at gls.enums.vm5.EnumTest.testEnumWithSingleListInConstructor(EnumTest.groovy:126)
Caused by: groovy.lang.GroovyRuntimeException: Could not find matching constructor &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: ListEnum1(java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
at groovy.lang.MetaClassImpl.selectConstructorAndTransformArguments(MetaClassImpl.java:1347)
at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.selectConstructorAndTransformArguments(ScriptBytecodeAdapter.java:237)
at ListEnum1.$INIT(Script1.groovy)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:86)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:234)
at org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite.invoke(StaticMetaMethodSite.java:43)
at org.codehaus.groovy.runtime.callsite.StaticMetaMethodSite.callStatic(StaticMetaMethodSite.java:99)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallStatic(CallSiteArray.java:51)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callStatic(AbstractCallSite.java:166)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callStatic(AbstractCallSite.java:186)
at ListEnum1.(Script1.groovy)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14465758" author="blackdrag" created="Wed, 26 Nov 2008 10:20:41 +0000"  >&lt;p&gt;imho the exception tells me the list is still unwrapped&lt;/p&gt;</comment>
                            <comment id="14465713" author="blackdrag" created="Wed, 26 Nov 2008 10:22:46 +0000"  >&lt;p&gt;ah, ok, I made an error when applying the patch...&lt;/p&gt;</comment>
                            <comment id="14465682" author="blackdrag" created="Wed, 26 Nov 2008 11:45:42 +0000"  >&lt;p&gt;patch applied&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12721709" name="2933Patch.zip" size="2552" author="roshandawrani" created="Sat, 15 Nov 2008 00:48:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bqgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>