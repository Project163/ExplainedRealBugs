<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:16:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-4227] Grails 1.3.1 groovysh render incorrect char encoding in prompt and messages</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-4227</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Hi, the issue is related to appearance. In the output there are chars in a incorrect encoding i think:&lt;/p&gt;

&lt;p&gt;&amp;#8592;[32mGroovy Shell&amp;#8592;[m (1.7.2, JVM: 1.6.0_18)&lt;br/&gt;
Type &apos;&amp;#8592;[1mhelp&amp;#8592;[m&apos; or &apos;&amp;#8592;[1m\h&amp;#8592;[m&apos; for help.&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
&amp;#8592;[1mgroovy:&amp;#8592;[m000&amp;#8592;[1m&amp;gt;&amp;#8592;[m help&lt;/p&gt;

&lt;p&gt;For information about &amp;#8592;[32mGroovy&amp;#8592;[m, visit:&lt;br/&gt;
    &amp;#8592;[36mhttp://groovy.codehaus.org&amp;#8592;[m&lt;/p&gt;

&lt;p&gt;Available commands:&lt;br/&gt;
  &amp;#8592;[1mhelp    &amp;#8592;[m  (&amp;#8592;[1m\h &amp;#8592;[m) Display this help message&lt;br/&gt;
  &amp;#8592;[1m?       &amp;#8592;[m  (&amp;#8592;[1m&amp;#63; &amp;#8592;[m) Alias to: &amp;#8592;[1mhelp&amp;#8592;[m&lt;br/&gt;
  &amp;#8592;[1mexit    &amp;#8592;[m  (&amp;#8592;[1m\x &amp;#8592;[m) Exit the shell&lt;br/&gt;
  &amp;#8592;[1mquit    &amp;#8592;[m  (&amp;#8592;[1m\q &amp;#8592;[m) Alias to: &amp;#8592;[1mexit&amp;#8592;[m&lt;br/&gt;
  &amp;#8592;[1mimport  &amp;#8592;[m  (&amp;#8592;[1m\i &amp;#8592;[m) Import a class into the namespace&lt;br/&gt;
  &amp;#8592;[1mdisplay &amp;#8592;[m  (&amp;#8592;[1m\d &amp;#8592;[m) Display the current buffer&lt;br/&gt;
  &amp;#8592;[1mclear   &amp;#8592;[m  (&amp;#8592;[1m\c &amp;#8592;[m) Clear the buffer&lt;br/&gt;
  &amp;#8592;[1mshow    &amp;#8592;[m  (&amp;#8592;[1m\S &amp;#8592;[m) Show variables, classes or imports&lt;br/&gt;
  &amp;#8592;[1minspect &amp;#8592;[m  (&amp;#8592;[1m\n &amp;#8592;[m) Inspect a variable or the last result with the G&lt;br/&gt;
UI object browser&lt;br/&gt;
  &amp;#8592;[1mpurge   &amp;#8592;[m  (&amp;#8592;[1m\p &amp;#8592;[m) Purge variables, classes, imports or preferences&lt;/p&gt;

&lt;p&gt;  &amp;#8592;[1medit    &amp;#8592;[m  (&amp;#8592;[1m\e &amp;#8592;[m) Edit the current buffer&lt;br/&gt;
  &amp;#8592;[1mload    &amp;#8592;[m  (&amp;#8592;[1m\l &amp;#8592;[m) Load a file or URL into the buffer&lt;br/&gt;
  &amp;#8592;[1m.       &amp;#8592;[m  (&amp;#8592;[1m\. &amp;#8592;[m) Alias to: &amp;#8592;[1mload&amp;#8592;[m&lt;br/&gt;
  &amp;#8592;[1msave    &amp;#8592;[m  (&amp;#8592;[1m\s &amp;#8592;[m) Save the current buffer to a file&lt;br/&gt;
  &amp;#8592;[1mrecord  &amp;#8592;[m  (&amp;#8592;[1m\r &amp;#8592;[m) Record the current session to a file&lt;br/&gt;
  &amp;#8592;[1mhistory &amp;#8592;[m  (&amp;#8592;[1m\H &amp;#8592;[m) Display, manage and recall edit-line history&lt;br/&gt;
  &amp;#8592;[1malias   &amp;#8592;[m  (&amp;#8592;[1m\a &amp;#8592;[m) Create an alias&lt;br/&gt;
  &amp;#8592;[1mset     &amp;#8592;[m  (&amp;#8592;[1m\= &amp;#8592;[m) Set (or list) preferences&lt;br/&gt;
  &amp;#8592;[1mregister&amp;#8592;[m  (&amp;#8592;[1m\rc&amp;#8592;[m) Registers a new command with the shell&lt;/p&gt;

&lt;p&gt;For help on a specific command type:&lt;br/&gt;
    help &amp;#8592;[1mcommand&amp;#8592;[m&lt;/p&gt;

&lt;p&gt;-Some system properties could be util:&lt;/p&gt;

&lt;p&gt;grails.version=1.3.1&lt;br/&gt;
sun.boot.library.path=C:\Program Files\Java\jdk1.6.0_18\jre\bin&lt;br/&gt;
java.vm.version=16.0-b13&lt;br/&gt;
grails.env=development&lt;br/&gt;
java.vm.name=Java HotSpot(TM) Client VM&lt;br/&gt;
file.encoding.pkg=sun.io&lt;br/&gt;
user.country=ES&lt;br/&gt;
sun.os.patch.level=Service Pack 2&lt;br/&gt;
java.runtime.version=1.6.0_18-b07&lt;br/&gt;
grails.env.set=true&lt;br/&gt;
user.variant=&lt;br/&gt;
os.name=Windows Vista&lt;br/&gt;
tools.jar=C:\Program Files\Java\jdk1.6.0_18\lib\tools.jar&lt;br/&gt;
sun.jnu.encoding=Cp1252&lt;br/&gt;
disable.grails.plugin.transform=false&lt;br/&gt;
os.version=6.0&lt;br/&gt;
user.timezone=Europe/Paris&lt;br/&gt;
file.encoding=UTF-8&lt;br/&gt;
java.specification.version=1.6&lt;br/&gt;
grails.env.default=true&lt;br/&gt;
java.vm.specification.version=1.0&lt;br/&gt;
sun.arch.data.model=32&lt;br/&gt;
user.language=es&lt;br/&gt;
java.specification.vendor=Sun Microsystems Inc.&lt;br/&gt;
awt.toolkit=sun.awt.windows.WToolkit&lt;br/&gt;
java.version=1.6.0_18&lt;br/&gt;
sun.io.unicode.encoding=UnicodeLittle&lt;br/&gt;
groovy.starter.conf=\Users\atreyu\dev\java\grails\grails-1.3.1\conf\groovy-start&lt;br/&gt;
er.conf&lt;/p&gt;</description>
                <environment>Windows vista SP 2&lt;br/&gt;
Grails 1.3.1&lt;br/&gt;
</environment>
        <key id="12818050">GROOVY-4227</key>
            <summary>Grails 1.3.1 groovysh render incorrect char encoding in prompt and messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roshandawrani">Roshan Dawrani</assignee>
                                    <reporter username="jneira">Javier Neira Sanchez</reporter>
                        <labels>
                    </labels>
                <created>Sun, 30 May 2010 16:19:04 +0000</created>
                <updated>Wed, 23 Jun 2010 15:44:59 +0000</updated>
                            <resolved>Thu, 3 Jun 2010 21:22:14 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.3</fixVersion>
                    <fixVersion>1.8-beta-1</fixVersion>
                                    <component>Groovysh</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14479164" author="paulk" created="Mon, 31 May 2010 02:30:19 +0000"  >&lt;p&gt;Not sure this is a bug per se. Groovysh is assuming you are using a ansi compatible terminal.&lt;br/&gt;
So, it there is a bug it is in detection logic/defaults.&lt;br/&gt;
You can override terminal settings manually as per the doco here:&lt;br/&gt;
&lt;a href=&quot;http://groovy.codehaus.org/Groovy+Shell&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy.codehaus.org/Groovy+Shell&lt;/a&gt;&lt;br/&gt;
In particular you can do things like:&lt;br/&gt;
groovysh --terminal=none&lt;br/&gt;
Or if running under cygwin see the special notes.&lt;br/&gt;
Not sure whether the grails wrapping of groovysh keeps all command line options.&lt;/p&gt;</comment>
                            <comment id="14469477" author="jneira" created="Mon, 31 May 2010 12:10:41 +0000"  >&lt;p&gt;Thanks for the point, the fact is with older grails+groovy versions in same environment the character encoding works fine. So yes it seems the problem can be in detection of env.&lt;/p&gt;

&lt;p&gt;In the script under &quot;grails shell&quot; i have seen this lines:&lt;/p&gt;

&lt;p&gt;def shell = new Groovysh(classLoader,b, new IO(System.in, System.out, System.err))&lt;br/&gt;
	shell.run([] as String[])&lt;/p&gt;

&lt;p&gt;i cannt find the  Groovysh constructor declaration in google to indentify the String[] argument &lt;br/&gt;
i try to shell.run  (&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;--terminal=none&amp;quot;&amp;#93;&lt;/span&gt; asString[]) just in case but i get a kilometric stacktrace .-(&lt;/p&gt;

&lt;p&gt;PD: I configure groovysh.bat to use the grails installation libs (jansi,jline,commons-cli,groovy-all) and the shell show chars correctly&lt;/p&gt;</comment>
                            <comment id="14469499" author="roshandawrani" created="Wed, 2 Jun 2010 05:26:19 +0000"  >&lt;p&gt;I don&apos;t think you can pass options like &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;--terminal=none&amp;quot;&amp;#93;&lt;/span&gt; directly to Groovy.sh. To achieve the equivalent of &quot;--terminal=none&quot; with the usage like below, you may set the system property &quot;jline.terminal&quot; to &quot;jline.UnsupportedTerminal&quot;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def shell = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Groovysh(classLoader,b, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IO(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.in, &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out, &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err))
shell.run([] as &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14469444" author="jneira" created="Wed, 2 Jun 2010 10:04:00 +0000"  >&lt;p&gt;Thanks for you proposal. i have added the property in startGrails.bat&lt;br/&gt;
set JAVA_OPTS=%JAVA_OPTS% -Djline.terminal=&quot;jline.UnsupportedTerminal&quot;&lt;br/&gt;
and i get the value in shell with System.getProperty (&quot;jline.terminal&quot;) but  &lt;br/&gt;
i am afraid the change dont fix the problem.&lt;br/&gt;
Therefore the console executed by groovysh.bat with same libraries and env render&lt;br/&gt;
the character set fine :-/&lt;/p&gt;

&lt;p&gt;Well at the end i have found the javadoc of groovy shell package&lt;br/&gt;
in &lt;a href=&quot;http://groovy.codehaus.org/gapi/org/codehaus/groovy/tools/shell/Main.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://groovy.codehaus.org/gapi/org/codehaus/groovy/tools/shell/Main.html&lt;/a&gt;&lt;br/&gt;
there is a static method setTerminalType (String)&lt;br/&gt;
with this adding in Shell.groovy i have fixed the problem:&lt;/p&gt;

&lt;p&gt;Main.setTerminalType (&quot;none&quot;)&lt;br/&gt;
def shell = new Groovysh(classLoader,b, new IO(System.in, System.out, System.err))&lt;br/&gt;
shell.run(&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;&amp;quot;&amp;#93;&lt;/span&gt; as String[]);&lt;/p&gt;

&lt;p&gt;But i dont know if i have to close the issue cause the detection of console still not working&lt;/p&gt;

&lt;p&gt;I see a org.codehaus.groovy.tools.shell.AnsiDetector and it could be there the problem with&lt;br/&gt;
non-ansi autodetection problem.&lt;/p&gt;

</comment>
                            <comment id="14469387" author="roshandawrani" created="Wed, 2 Jun 2010 10:17:38 +0000"  >&lt;p&gt;I am just comparing here what happens in usual groovysh case and what you are doing - there is one more thing that you may want to try - in addition to the system property that you have set, can you also set &quot;Ansi.enabled = false&quot; (org.fusesource.jansi.Ansi)&lt;/p&gt;

&lt;p&gt;If that also does not work, we will need others to share more inputs - as far as setting the &quot;terminal to none&quot; idea was concerned, that has been tried here after the current suggestion (&quot;Ansi.enabled = false&quot;)&lt;/p&gt;</comment>
                            <comment id="14469490" author="roshandawrani" created="Wed, 2 Jun 2010 10:52:40 +0000"  >&lt;p&gt;Well, Main.setTerminalType(none) does those 2 things only - sets the system property and sets Ansi.enabled = false - that is where my inputs were coming from. So, doing them via or not via Main.setTerminalType() - either way achieves the same thing.&lt;/p&gt;

&lt;p&gt;So, happy to note that with those 2 things it is working for you.&lt;/p&gt;</comment>
                            <comment id="14469407" author="roshandawrani" created="Wed, 2 Jun 2010 11:20:33 +0000"  >&lt;p&gt;Did you try calling &quot;Ansi.setDetector(new AnsiDetector())&quot; before new Groovysh(...) to see if it helps with the auto-detection?&lt;/p&gt;</comment>
                            <comment id="14469491" author="jneira" created="Wed, 2 Jun 2010 14:13:15 +0000"  >&lt;p&gt;thanks for your feedback! i have tried &lt;br/&gt;
org.fusesource.jansi.Ansi.setDetector(new AnsiDetector());&lt;br/&gt;
and i am afraid dont work &lt;/p&gt;

&lt;p&gt;PD: with  Main.setTerminalType (&quot;win&quot;) the characters are correct&lt;/p&gt;</comment>
                            <comment id="14469518" author="jneira" created="Wed, 2 Jun 2010 14:45:57 +0000"  >&lt;p&gt;OK i have revised the code of org.codehaus.groovy.tools.shell.Main (it was clear that the console with Main works and with Groovysh not) and&lt;br/&gt;
there is a static block:&lt;br/&gt;
static &lt;/p&gt;
{
        // Install the system adapters
        AnsiConsole.systemInstall()

        // Register jline ansi detector
        Ansi.setDetector(new AnsiDetector())
    }
&lt;p&gt;One of them you previous porposal. I added both to the shell.groovy and works fine&lt;br/&gt;
I think the fix could be add this static block to Groovysh class (statically or not)&lt;/p&gt;</comment>
                            <comment id="14469469" author="roshandawrani" created="Wed, 2 Jun 2010 22:45:44 +0000"  >&lt;p&gt;Hi. I have made the change. Could you please try the snapshot available at &lt;a href=&quot;http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.7.3-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.7.3-SNAPSHOT/&lt;/a&gt; and let me know if it works for you?&lt;/p&gt;</comment>
                            <comment id="14469502" author="jneira" created="Thu, 3 Jun 2010 16:13:01 +0000"  >&lt;p&gt;perfect! thanks for your interest and feedback, &lt;/p&gt;</comment>
                            <comment id="14469543" author="roshandawrani" created="Thu, 3 Jun 2010 21:22:14 +0000"  >&lt;p&gt;Done.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2couf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>