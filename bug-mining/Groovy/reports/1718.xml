<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:24:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5257] Node.ReplaceNode method fails cannot remove itself</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5257</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;Perhaps this is not a frequent operation, but replaceNode method fails because of a nullpointer exception. The case corresponds to removing a root node from a xml document. This node has no parent (parent==null) and that is the point where the error is triggered. This may be considered a bad programming, but, anyway, the code should return something different from an exception.&lt;/p&gt;</description>
                <environment>ubuntu 11.04, eclipse 3.6, groovy eclipse plugin2.6.0.xx-20111212-0800-e36-RELEASE</environment>
        <key id="12815900">GROOVY-5257</key>
            <summary>Node.ReplaceNode method fails cannot remove itself</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="escalope">Jorge Gomez</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Jan 2012 02:46:14 +0000</created>
                <updated>Sun, 12 Feb 2012 04:03:05 +0000</updated>
                            <resolved>Thu, 2 Feb 2012 03:02:03 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>1.8.6</fixVersion>
                    <fixVersion>2.0-beta-3</fixVersion>
                                    <component>XML Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="14472328" author="paulk" created="Sat, 21 Jan 2012 06:01:57 +0000"  >&lt;p&gt;It might be appropriate to return an Exception but probably not the NPE currently seen - possibly an &lt;tt&gt;UnsupportedOerationException&lt;/tt&gt; with a clearer message. Incidentally, just noticed that the same applies to the &lt;tt&gt;plus(Closure)&lt;/tt&gt; method as well.&lt;/p&gt;</comment>
                            <comment id="14472330" author="escalope" created="Sun, 22 Jan 2012 02:53:04 +0000"  >&lt;p&gt;I agree. A minimum should be an exception signalling &quot;you cannot remove the document&apos;s root node&quot;. Nevertheless, this restriction may constraint too much the kind of traversal you make over a DOM tree.&lt;/p&gt;

&lt;p&gt;In my example, I removed the node. However, if one intends to modify the root node, the same exception happens. Then, operations like removing an attribute or adding an attribute to a DOM tree cannot be programmed if they imply to modify the root node. &lt;/p&gt;

&lt;p&gt;I think it is possible a more generic still robust solution, but need to study further the sources.&lt;/p&gt;</comment>
                            <comment id="14472217" author="escalope" created="Sun, 22 Jan 2012 02:54:21 +0000"  >&lt;p&gt;Sorry, when I meant &quot;adding an attribute&quot; I should have said &quot;replacing the node by another having different attributes&quot; which is what the replaceNode is for. &lt;/p&gt;</comment>
                            <comment id="14479783" author="paulk" created="Mon, 23 Jan 2012 05:23:27 +0000"  >&lt;p&gt;Given that attempting to &quot;replace&quot; the root node currently fails, I am inclined to return an UnsupportedOperationException for now until some better semantics is defined.&lt;/p&gt;

&lt;p&gt;It would certainly be possible to define the semantics for XmlParser and probably the DOM Category as well so that if the building closure returned a single node that it was returned as a &quot;root&quot; node. However, given that in other cases the replaceNode method mutates some existing data structure whereas the new semantics would just return a new node in the case of being a root node, then it might be a little unexpected.&lt;/p&gt;

&lt;p&gt;Just on the use case of changing a node&apos;s attributes, for both XmlParser and XmlSlurper you can get access to the attributes() map and make changes that way. For XmlSlurper this is actually kind of cheating because for nearly all other cases we treat the tree as mostly immutable and have changes kept as a tree of closure updates - so we may fix that hole in a future version of XmlSlurper.&lt;/p&gt;</comment>
                            <comment id="14472362" author="escalope" created="Mon, 23 Jan 2012 06:06:56 +0000"  >&lt;p&gt;You are more than right. &lt;/p&gt;

&lt;p&gt;I am not a groovy expert, but the behavior I suggested may contradict the replaceNode semantics when the root node is regarded. ReplaceNode requests are delivered because a there is a reference to the DOM root you are using. It replaceNode creates a new node for root, then the reference to the root node you were using becomes invalid and it is not possible to retrieve by regular means unless some additional programming is inserted. This happens as well with intermediate nodes, but those cases are not extreme since references to the new nodes can always be retrieved if there is a reference to the DOM root node. &lt;/p&gt;

&lt;p&gt;Thus, it makes sense to warn developers that, when replaceNode affects a root node of a DOM, an exception will be raised and make this the default behaviour in the API. &lt;/p&gt;</comment>
                            <comment id="14479776" author="paulk" created="Thu, 2 Feb 2012 03:02:03 +0000"  >&lt;p&gt;This is fixed for XmlParser and DOMCategory (and the underlying groovy.util.Node) by returning an &lt;tt&gt;UnsupportedOperationException&lt;/tt&gt; but not so for XmlSlurper which attempts to allow you to create XML fragments at any place including (conceptually) the root.&lt;/p&gt;

&lt;p&gt;Arguably, replaceNode should actually return the replaced node not the last node added while replacing - but that should be raised as a separate issue with appropriate feedback from the mailing list.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12722646" name="RemoveNodeFailureTest.groovy" size="433" author="escalope" created="Sat, 21 Jan 2012 02:46:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2brpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>