<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 00:26:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[GROOVY-5361] XmlParser and XmlSlurper should support XML Schema validation</title>
                <link>https://issues.apache.org/jira/browse/GROOVY-5361</link>
                <project id="12318123" key="GROOVY">Groovy</project>
                    <description>&lt;p&gt;XmlSlurper and XmlParser both support a validation capability, but this only works for DTDs. It should work for XMLSchemas as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12816179">GROOVY-5361</key>
            <summary>XmlParser and XmlSlurper should support XML Schema validation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="paulk">Paul King</assignee>
                                    <reporter username="russel">Dr. Russel Winder</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Mar 2012 12:14:58 +0000</created>
                <updated>Tue, 22 Jan 2013 16:33:16 +0000</updated>
                            <resolved>Tue, 22 Jan 2013 16:33:09 +0000</resolved>
                                    <version>2.0-beta-2</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>XML Processing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14472596" author="paulk" created="Tue, 13 Mar 2012 07:05:54 +0000"  >&lt;p&gt;They both do support XML Schema validation. So for clarification, my understanding is that you want simpler configuration when turning on such validation rather than configuring your own SAXParser.&lt;/p&gt;</comment>
                            <comment id="14479843" author="paulk" created="Tue, 13 Mar 2012 07:49:11 +0000"  >&lt;p&gt;So basically we currently have this for validating against internal XSDs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def factory = SAXParserFactory.newInstance()
factory.validating = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
factory.namespaceAware = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
SAXParser sax = factory.newSAXParser()
sax.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//java.sun.com/xml/jaxp/properties/schemaLanguage&quot;&lt;/span&gt;, XMLConstants.W3C_XML_SCHEMA_NS_URI)
&lt;/span&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(sax)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which could be shortened to something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(XmlUtil.defaultSchemaValidatingParser())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Incidentally, we still need an error handler in either case:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;parser.errorHandler = { e -&amp;gt; println e.message } as ErrorHandler
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479836" author="paulk" created="Tue, 13 Mar 2012 07:54:17 +0000"  >&lt;p&gt;For validating against an external XSD we currently have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI)
def factory = SAXParserFactory.newInstance()
factory.validating = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
factory.namespaceAware = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
factory.schema = schemaFactory.newSchema([&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.xsd&quot;&lt;/span&gt;)] as Source[])
def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(factory.newSAXParser())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which might become something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(XmlUtil.schemaValidatingParserFromSources(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.xsd&quot;&lt;/span&gt;)))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With DTD validation off, this doesn&apos;t need a special error handler - the default one when not validating just sends error messages to &lt;tt&gt;System.err&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14479849" author="paulk" created="Tue, 13 Mar 2012 07:57:35 +0000"  >&lt;p&gt;Or we could provide a Map style constructor:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(validating: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, schemaValidation: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, schemaSources:[&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.xsd&quot;&lt;/span&gt;)])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Or something like that - though it won&apos;t necessarily support easy IDE completion.&lt;/p&gt;</comment>
                            <comment id="14472600" author="russel" created="Tue, 13 Mar 2012 11:16:19 +0000"  >&lt;p&gt;I did indeed mean that using an XML Schema should be easier.  The above proposal seem to take us on the right direction.  Without trying the out, it is difficult to say more.&lt;/p&gt;

&lt;p&gt;Why does there have to be explicit mention of an error handler?&lt;/p&gt;

&lt;p&gt;What about folks using Relax NG?&lt;/p&gt;</comment>
                            <comment id="14472571" author="russel" created="Tue, 13 Mar 2012 11:22:40 +0000"  >&lt;p&gt;I didn&apos;t have to specify an error handler using the first segment, it just worked.&lt;/p&gt;</comment>
                            <comment id="14479821" author="paulk" created="Tue, 13 Mar 2012 16:00:49 +0000"  >&lt;p&gt;Re: &quot;I didn&apos;t have to specify an error handler using the first segment, it just worked.&quot;&lt;/p&gt;

&lt;p&gt;If I have validating set to true I get the warning to stderr you mentioned on the mailing list:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Warning: validation was turned on but an org.xml.sax.ErrorHandler was not
set, which is probably not what is desired.  Parser will use a default
ErrorHandler to print the first 10 errors.  Please call
the &apos;setErrorHandler&apos; method to fix this.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you are not seeing it perhaps it is JVM version specific.&lt;/p&gt;</comment>
                            <comment id="14479852" author="paulk" created="Tue, 13 Mar 2012 16:54:34 +0000"  >&lt;p&gt;For relaxng, with Jing in my classpath I needed the following as the long-hand for an external schema source (couldn&apos;t get the internal one working in the time I had available):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// Jing jar doesn&apos;t seem to have META-INF to be found automatically by JAXP
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// so manually set it here - pick one of compact or xml syntax variants
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty(SchemaFactory.name + &lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt; + RELAXNG_NS_URI,
&lt;span class=&quot;code-comment&quot;&gt;//    &lt;span class=&quot;code-quote&quot;&gt;&quot;com.thaiopensource.relaxng.jaxp.CompactSyntaxSchemaFactory&quot;&lt;/span&gt;)
&lt;/span&gt;    &lt;span class=&quot;code-quote&quot;&gt;&quot;com.thaiopensource.relaxng.jaxp.XMLSyntaxSchemaFactory&quot;&lt;/span&gt;)

SchemaFactory schemaFactory = SchemaFactory.newInstance(RELAXNG_NS_URI)
def factory = SAXParserFactory.newInstance()
factory.validating = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
factory.namespaceAware = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
factory.schema = schemaFactory.newSchema([&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.rng&quot;&lt;/span&gt;)] as Source[])
def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(factory.newSAXParser())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so perhaps this could become:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// I&apos;d propose leaving the ugly &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty here as it is Jing specific
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// and hopefully will go away in &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; versions of the library anyway
&lt;/span&gt;
def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(XmlUtil.schemaValidatingParserFromSources(RELAXNG_NS_URI, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.rng&quot;&lt;/span&gt;)))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and if we don&apos;t default to XML Schema, then the earlier example for XML Schema might need to become:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(XmlUtil.schemaValidatingParserFromSources(W3C_XML_SCHEMA_NS_URI, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;mySchema.xsd&quot;&lt;/span&gt;)))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14472587" author="russel" created="Wed, 14 Mar 2012 09:30:11 +0000"  >&lt;p&gt;&quot;If you are not seeing it perhaps it is JVM version specific.&quot;&lt;/p&gt;

&lt;p&gt;I see the error message when I set the validate parameter true in the XmlParser constructor call but I don&apos;t have a DTD.  When I use the SAX parser constructor to XmlParser I do not see the error message.  This would imply the error message comes from the default DTD validating SAX parser used by XmlParser.  Since this is not used when specifying a given SAX parser the default error handler is clearly fine?&lt;/p&gt;</comment>
                            <comment id="14472617" author="russel" created="Wed, 14 Mar 2012 09:31:43 +0000"  >&lt;p&gt;I agree with the thinking about support for RelaxNG except that there should be a way of allowing the incoming document to specify the schema against which validation happens.&lt;/p&gt;</comment>
                            <comment id="14479844" author="paulk" created="Thu, 15 Mar 2012 07:40:24 +0000"  >&lt;p&gt;@Russel&lt;/p&gt;

&lt;p&gt;Re: &quot;the default error handler is clearly fine&quot;. Yes, when creating your own SAX parser, if you don&apos;t tell it to also validate against DTDs - which you don&apos;t need to in your examples from what you have said, then the default is fine AFAIK.&lt;/p&gt;

&lt;p&gt;Re: &quot;there should be a way of allowing the incoming document to specify the schema against which validation happens&quot;. Agreed! But I haven&apos;t found anything definitive on how to do this long hand in Java - hence providing a Groovy shorthand currently evades me.&lt;/p&gt;</comment>
                            <comment id="14479853" author="paulk" created="Thu, 15 Mar 2012 07:41:49 +0000"  >&lt;p&gt;An example with imports etc. in case anyone is trying to actually run the snippets above:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.Source
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.stream.StreamSource
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.validation.SchemaFactory
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.XMLConstants
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.parsers.SAXParserFactory

def xml_g = &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;person&amp;gt;&amp;lt;first&amp;gt;James&amp;lt;/first&amp;gt;&amp;lt;last&amp;gt;Kirk&amp;lt;/last&amp;gt;&amp;lt;/person&amp;gt;&apos;&lt;/span&gt;
def xml_b = &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;person&amp;gt;&amp;lt;first&amp;gt;James&amp;lt;/first&amp;gt;&amp;lt;middle&amp;gt;T.&amp;lt;/middle&amp;gt;&amp;lt;last&amp;gt;Kirk&amp;lt;/last&amp;gt;&amp;lt;/person&amp;gt;&apos;&lt;/span&gt;
def xsd = &apos;&apos;&apos;&amp;lt;xs:schema xmlns:xs=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.w3.org/2001/XMLSchema&quot;&lt;/span&gt;&amp;gt;
&lt;/span&gt;  &amp;lt;xs:element name=&lt;span class=&quot;code-quote&quot;&gt;&quot;person&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;xs:complexType&amp;gt;
      &amp;lt;xs:sequence&amp;gt;
        &amp;lt;xs:element name=&lt;span class=&quot;code-quote&quot;&gt;&quot;first&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;xs:NCName&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;xs:element name=&lt;span class=&quot;code-quote&quot;&gt;&quot;last&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;xs:NCName&quot;&lt;/span&gt;/&amp;gt;
      &amp;lt;/xs:sequence&amp;gt;
    &amp;lt;/xs:complexType&amp;gt;
  &amp;lt;/xs:element&amp;gt;
&amp;lt;/xs:schema&amp;gt;&apos;&apos;&apos;
def schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI)
def factory = SAXParserFactory.newInstance()
factory.validating = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
factory.namespaceAware = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
factory.schema = schemaFactory.newSchema([&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(xsd))] as Source[])
def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(factory.newSAXParser())
[xml_g, xml_b].each {
    def p = parser.parseText(it)
    println &lt;span class=&quot;code-quote&quot;&gt;&quot;${p.last.text()}, ${p.first.text()}&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14479862" author="paulk" created="Thu, 15 Mar 2012 16:28:35 +0000"  >&lt;p&gt;Here is what I propose to add to XmlUtil:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; SAXParser schemaParser(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; schemaLanguage, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; namespaceAware, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; validating, File schema)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; SAXParser schemaParser(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; schemaLanguage, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; namespaceAware, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; validating, URL schema)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; SAXParser schemaParser(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; schemaLanguage, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; namespaceAware, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; validating, Source... schemas)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, the above example becomes (assuming the xsd is in a local file called &apos;person.xsd&apos;):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; javax.xml.XMLConstants.*
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; groovy.xml.XmlUtil.*

def xml_g = &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;person&amp;gt;&amp;lt;first&amp;gt;James&amp;lt;/first&amp;gt;&amp;lt;last&amp;gt;Kirk&amp;lt;/last&amp;gt;&amp;lt;/person&amp;gt;&apos;&lt;/span&gt;
def xml_b = &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;person&amp;gt;&amp;lt;first&amp;gt;James&amp;lt;/first&amp;gt;&amp;lt;middle&amp;gt;T.&amp;lt;/middle&amp;gt;&amp;lt;last&amp;gt;Kirk&amp;lt;/last&amp;gt;&amp;lt;/person&amp;gt;&apos;&lt;/span&gt;
def parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlParser(schemaParser(W3C_XML_SCHEMA_NS_URI, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;person.xsd&apos;&lt;/span&gt; as File))
[xml_g, xml_b].each {
    def p = parser.parseText(it)
    println &lt;span class=&quot;code-quote&quot;&gt;&quot;${p.last.text()}, ${p.first.text()}&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I guess we could also create variants with default values for the booleans - I&apos;d go with validating=false and namespaceAware=true as per our defaults for XmlSlurper and XmlParser.&lt;/p&gt;

&lt;p&gt;We could also have a default schema language but (despite the poor support for RelaxNG on the JVM at present) I am inclined not to at this stage - it can always be added later.&lt;/p&gt;</comment>
                            <comment id="14479822" author="paulk" created="Thu, 15 Mar 2012 16:35:05 +0000"  >&lt;p&gt;There is also the question of the best name for the utility methods. I have used &quot;schemaParser&quot; above but perhaps &quot;newSAXParser&quot; is better.&lt;/p&gt;

&lt;p&gt;And also the question of whether it is worth back-porting to 1.8.7? It doesn&apos;t alter any existing API, so I don&apos;t see the harm. It depends on how kind we want to be to stragglers in the Groovy ecosystem.&lt;/p&gt;</comment>
                            <comment id="14472597" author="paulk" created="Thu, 15 Mar 2012 17:40:31 +0000"  >&lt;p&gt;added as newSAXParser with and w/o boolean variants and backported to 1.8.7&lt;/p&gt;</comment>
                            <comment id="14472633" author="russel" created="Thu, 15 Mar 2012 18:59:27 +0000"  >&lt;p&gt;On the one hand I am a huge fan of debug releases, i.e. changes in the z of the x.y.z, only having bug fixes. On the other hand this could be considered a bug fix &amp;#8211; and Groovy does have a history of slipping in some new bits as bug fixes. So as long as there are no breaking changes 1.8.6 -&amp;gt; 1.8.7 I am content to see this stuff in.&lt;/p&gt;

&lt;p&gt;I wonder if &quot;validatingParser&quot; rather than &quot;schemaParser&quot; would be more descriptive.&lt;/p&gt;

&lt;p&gt;I guess we still need to work on a validating parser that reads the schema specification from the root node rather than being given it separately.&lt;/p&gt;</comment>
                            <comment id="14479838" author="paulk" created="Thu, 15 Mar 2012 19:09:10 +0000"  >&lt;p&gt;Re: the name: I ended up going with &quot;newSAXParser&quot; which is a little lower level than I would normally like but with a view to making it obvious that you are producing something which feeds into the SAXParser constructor of XmlParser/Slurper. I didn&apos;t go with &quot;validatingParser&quot; since you could create one with the (DTD) validating flag set to false and that might be counter-intuitive at first glance. And if the eventual goal is to have a higher-level API over the top, then all of this would be hidden anyway.&lt;/p&gt;

&lt;p&gt;Re: autodetecting the schema language: yes, that would be much nicer. It should really be fixed at the JVM-library level but if that looks unlikely to happen any time soon, Groovy could try to value add in the meantime.&lt;/p&gt;</comment>
                            <comment id="14479878" author="paulk" created="Thu, 15 Mar 2012 19:31:31 +0000"  >&lt;p&gt;Example of usage can be seen in XmlUtilTest#testSchemaValidationUtilityMethod:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/test/groovy/xml/XmlUtilTest.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/groovy/groovy-core/blob/master/src/test/groovy/xml/XmlUtilTest.groovy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The test doesn&apos;t use a file which looks neater but on the other hand, the test is self-contained.&lt;/p&gt;</comment>
                            <comment id="14472606" author="russel" created="Fri, 23 Mar 2012 11:24:23 +0000"  >&lt;p&gt;Just a note that:&lt;/p&gt;

&lt;p&gt;XMLConstants&lt;/p&gt;

&lt;p&gt;but:&lt;/p&gt;

&lt;p&gt;XmlUtils&lt;/p&gt;

&lt;p&gt;the inconsistency really is annoying.&lt;/p&gt;</comment>
                            <comment id="14472702" author="russel" created="Fri, 23 Mar 2012 12:42:15 +0000"  >&lt;p&gt;It seems that the default behaviour of XmlUtil.newSAXParser is not to validate even though it is required to provide a schema.  Or have I missed something?&lt;/p&gt;</comment>
                            <comment id="14472635" author="russel" created="Fri, 23 Mar 2012 12:51:08 +0000"  >&lt;p&gt;XmlParser reports trimWhitespace as the property to set to control whitespace, it has the wrong default of true.  XmlParser reports keepWhitespace as the property to control whitespace, it has the wrong default of false.&lt;/p&gt;</comment>
                            <comment id="14479868" author="paulk" created="Fri, 23 Mar 2012 17:21:32 +0000"  >&lt;p&gt;Re: XMLConstants vs XmlUtils: XMLConstants, SAXParser, SQLException etc. come from Java. XmlParser, XmlSlurper, XmlUtil, JsonBuilder, Sql, etc. come from Groovy. Not nice but there has been a history behind both - unfortunate that sometimes the Java apis leak through to the Groovy ones. I guess in theory we could always hide them but ...&lt;/p&gt;</comment>
                            <comment id="14479877" author="paulk" created="Fri, 23 Mar 2012 17:28:00 +0000"  >&lt;p&gt;Re: default behaviour is to not validate: yes, the defaults are the same as for XmlSlurper and XmlParser and that flag is related to DTD validation only. Schema validation will be on. Perhaps the doco needs a bit of finessing to make that clearer?&lt;/p&gt;</comment>
                            <comment id="14479901" author="paulk" created="Fri, 23 Mar 2012 17:45:52 +0000"  >&lt;p&gt;Re: trimWhitespace vs keepWhitespace: it turns out the XmlSlurper&apos;s keepWhitespace and XmlParser&apos;s trimWhitespace are totally different beasts/concepts!&lt;/p&gt;

&lt;p&gt;Firstly, XmlParser&apos;s trimWhitespace: it causes &quot;.trim()&quot; to be called on element text values (but not attributes!). It really does have the wrong default value but would break legacy code if we changed it. I would nearly support changing it anyway as a breaking change in 2.0. But given that we want to put a new api over the top (and potentially rework some of the internals) do we break user&apos;s code once or twice? It is well documented and easy to turn off - so the current thinking is to leave it until we make the api changes - but feel free to debate further - though it isn&apos;t really part of this issue per say.&lt;/p&gt;

&lt;p&gt;Secondly, XmlSlurper&apos;s keepWhitespace: this is about preserving layout of XML documents. So if we have this XML fragment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;...
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;foo&amp;gt;&lt;/span&gt;content&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/foo&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bar&amp;gt;&lt;/span&gt;content&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bar&amp;gt;&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;when the flag is off, parsing this will return two elements, &quot;foo&quot; and &quot;bar&quot;. When the flag is on, this will return a &quot;foo&quot; element, then a &quot;text node&quot; containing a newline and 4 spaces, then the &quot;bar&quot; element. If you want to process the document content, the &quot;whitespace text nodes&quot; are just unwanted noise. But if you want to preserve the original layout of the document after making some changes to the content, then keeping the flag on can be useful. From memory, XmlSlurper may not allow full round-tripping anyway as it may not keep everything intact, e.g. processing instructions, XML comments etc. (but I haven&apos;t checked the code just now so don&apos;t quote me on this - we have made it cover more of these things over time)&lt;/p&gt;</comment>
                            <comment id="14472673" author="russel" created="Sat, 24 Mar 2012 04:29:10 +0000"  >&lt;p&gt;Re: XMLConstants vs XmlUtils: I think the Groovy naming is inconsistent with the policy for Groovy properties where getXMLThingy ( ) goes to XMLThingy in order to preserve the upper caseness.  No matter the history, it would be good for Groovy to have a consistent approach to acronym case.&lt;/p&gt;</comment>
                            <comment id="14472703" author="russel" created="Sat, 24 Mar 2012 04:30:50 +0000"  >&lt;p&gt;Re validation.  I found that using the two parameter newSAXParser (note not newSaxParser, see above &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I did not get any XML Schema validation, I had to switch it on by using the four parameter version.&lt;/p&gt;</comment>
                            <comment id="14472648" author="russel" created="Sat, 24 Mar 2012 04:32:27 +0000"  >&lt;p&gt;Re XmlParser&apos;s trimWhiteSpace: I suggest that the default is wrong and that Groovy 2 should have the right default.  Legacy code should expect breaking changes 1.8 -&amp;gt; 2.0. Perhaps take this back to the mailing list to get wider debate?&lt;/p&gt;</comment>
                            <comment id="14472607" author="russel" created="Sat, 24 Mar 2012 04:35:50 +0000"  >&lt;p&gt;Re XmlSlurper keepWhitespace: It seems that the use case you are explaining has little to do with the one we started with &amp;#8211; unless I am missing something. Is it that XmlSlurper is using the same flag for multiple disjoint purposes? If so then a new flag should be introduced to cover the second case.&lt;/p&gt;

&lt;p&gt;If XmlSlurper cannot round-trip then isn&apos;t it broken?&lt;/p&gt;</comment>
                            <comment id="14479903" author="paulk" created="Sat, 24 Mar 2012 23:19:36 +0000"  >&lt;p&gt;Re XmlSlurper keepWhitespace and XmlParser trimWhitespace: yes, they are totally different use cases with totally different flags that unfortunately overlap by 10 common characters. Perhaps they should have different names (breaking change): preserveWhitespace, autoTrimElementText&lt;/p&gt;</comment>
                            <comment id="14479916" author="paulk" created="Sat, 24 Mar 2012 23:25:08 +0000"  >&lt;p&gt;Re newSAXParser vs newSaxParser: SAXParser is a Java class that leaks through the Groovy api. When thinking of Groovy as value add to Java, I don&apos;t mind these differences too much. If you want to treat Groovy as a Java replacement then such differences are annoying. Don&apos;t think the getXMLThingy is relevant since xmlThingy would be the property for XmlThingy?&lt;/p&gt;</comment>
                            <comment id="14479902" author="paulk" created="Sat, 24 Mar 2012 23:30:00 +0000"  >&lt;p&gt;Re flipping trimWhitespace default: feel free to continue debate in user mailing list - if there is unanimous support I will be happy to help implement the change - if there is a wide divergence of opinion, I don&apos;t have heaps of time at present to contribute to persuading the masses - what little time I do have I&apos;d prefer to invest in a future XML module with quite a few things fixed. But agree with you that the current default is very anti common practice.&lt;/p&gt;</comment>
                            <comment id="14472712" author="paulk" created="Sat, 24 Mar 2012 23:32:52 +0000"  >&lt;p&gt;Re two param vs four param newSAXParser: does XmlUtilTest#testSchemaValidationUtilityMethod work for you? It uses the two param version and seems to work?&lt;/p&gt;</comment>
                            <comment id="14479913" author="paulk" created="Sun, 1 Apr 2012 21:52:37 +0000"  >&lt;p&gt;Russel, does &lt;tt&gt;XmlUtilTest#testSchemaValidationUtilityMethod&lt;/tt&gt; not work for you? Or did you reopen this in relation to the &lt;tt&gt;keepWhitespace&lt;/tt&gt; / &lt;tt&gt;trimWhitespace&lt;/tt&gt; issue? I guess it is working for me with the test cases I have so I am looking for another example. Thanks.&lt;/p&gt;</comment>
                            <comment id="14480098" author="paulk" created="Sat, 5 Jan 2013 20:07:09 +0000"  >&lt;p&gt;Russel, I have lost track of what else you require for this issue to be closed? Can you remember?&lt;/p&gt;</comment>
                            <comment id="14480151" author="paulk" created="Tue, 22 Jan 2013 16:33:09 +0000"  >&lt;p&gt;I am going to mark this as closed as I believe the Schema Validation part has been adequately addressed. If we need to tweak other defaults, we should use a fresh issue to create more focus around any required changes/discussion.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2cmnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>