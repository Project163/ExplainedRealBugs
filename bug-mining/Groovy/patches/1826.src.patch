diff --git a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
index 6645462a98..eebb32f7e2 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
@@ -816,7 +816,11 @@ public class BinaryExpressionHelper {
         controller.getOperandStack().replace(common, 2);        
         
     }
-    
+
+    private static boolean isNullConstant(Expression expression) {
+        return expression instanceof ConstantExpression && ((ConstantExpression) expression).getValue()==null;
+    }
+
     private void evaluateNormalTernary(TernaryExpression expression) {
         MethodVisitor mv = controller.getMethodVisitor();
         OperandStack operandStack = controller.getOperandStack();
@@ -828,8 +832,17 @@ public class BinaryExpressionHelper {
         
         ClassNode truePartType = typeChooser.resolveType(truePart, controller.getClassNode());
         ClassNode falsePartType = typeChooser.resolveType(falsePart, controller.getClassNode());
-        ClassNode common = WideningCategories.lowestUpperBound(truePartType, falsePartType);
-        
+        ClassNode common;
+        if (isNullConstant(truePart) && isNullConstant(falsePart)) {
+            common = ClassHelper.OBJECT_TYPE;
+        } else if (isNullConstant(truePart)) {
+            common = falsePartType;
+        } else if (isNullConstant(falsePart)) {
+            common = truePartType;
+        } else {
+            common = WideningCategories.lowestUpperBound(truePartType, falsePartType);
+        }
+
         // we compile b?x:y as 
         //      boolean(b)?S(x):S(y), S = common super type of x,y
         // so we load b, do boolean conversion. 
diff --git a/src/main/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java b/src/main/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
index ea4c8bdc74..968a49eecc 100644
--- a/src/main/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
+++ b/src/main/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
@@ -52,17 +52,17 @@ public class BinaryExpressionTransformer {
 
     Expression transformBinaryExpression(final BinaryExpression bin) {
         Object[] list = (Object[]) bin.getNodeMetaData(BINARY_EXP_TARGET);
-        if (list != null) {
-            Token operation = bin.getOperation();
-            int operationType = operation.getType();
-            if (operationType==Types.COMPARE_EQUAL || operationType == Types.COMPARE_NOT_EQUAL) {
-                // let's check if one of the operands is the null constant
-                if (isNullConstant(bin.getLeftExpression())) {
-                    return new CompareToNullExpression(staticCompilationTransformer.transform(bin.getRightExpression()), operationType==Types.COMPARE_EQUAL);
-                } else if (isNullConstant(bin.getRightExpression())) {
-                    return new CompareToNullExpression(staticCompilationTransformer.transform(bin.getLeftExpression()), operationType==Types.COMPARE_EQUAL);
-                }
+        Token operation = bin.getOperation();
+        int operationType = operation.getType();
+        if (operationType==Types.COMPARE_EQUAL || operationType == Types.COMPARE_NOT_EQUAL) {
+            // let's check if one of the operands is the null constant
+            if (isNullConstant(bin.getLeftExpression())) {
+                return new CompareToNullExpression(staticCompilationTransformer.transform(bin.getRightExpression()), operationType==Types.COMPARE_EQUAL);
+            } else if (isNullConstant(bin.getRightExpression())) {
+                return new CompareToNullExpression(staticCompilationTransformer.transform(bin.getLeftExpression()), operationType==Types.COMPARE_EQUAL);
             }
+        }
+        if (list != null) {
             if (operationType == Types.COMPARE_TO) {
                 StaticTypesTypeChooser typeChooser = staticCompilationTransformer.getTypeChooser();
                 ClassNode classNode = staticCompilationTransformer.getClassNode();
@@ -151,7 +151,7 @@ public class BinaryExpressionTransformer {
         return staticCompilationTransformer.superTransform(bin);
     }
 
-    private static boolean isNullConstant(final Expression expression) {
+    protected static boolean isNullConstant(final Expression expression) {
         return expression instanceof ConstantExpression && ((ConstantExpression) expression).getValue()==null;
     }
 
diff --git a/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy b/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
index a0fb93c79e..2d3b0928bc 100644
--- a/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
+++ b/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
@@ -112,5 +112,15 @@ class BugsStaticCompileTest extends BugsSTCTest {
         test()
         '''
     }
+
+    // GROOVY-5536
+    void testShouldNotThrowVerifyErrorWithNullDereferenceInIf() {
+        assertScript '''
+                boolean getDescriptorForPlugin(File pluginDir) {
+                    if (pluginDir?.exists()) { true } else { false }
+                }
+                assert getDescriptorForPlugin(null) == false
+        '''
+    }
 }
 
