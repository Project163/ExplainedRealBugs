diff --git a/src/main/org/codehaus/groovy/control/ResolveVisitor.java b/src/main/org/codehaus/groovy/control/ResolveVisitor.java
index 6e2c04d91f..2087897f68 100644
--- a/src/main/org/codehaus/groovy/control/ResolveVisitor.java
+++ b/src/main/org/codehaus/groovy/control/ResolveVisitor.java
@@ -282,12 +282,24 @@ public class ResolveVisitor extends ClassCodeExpressionTransformer {
         // and there is a nested class A$X. we want to be able 
         // to access that class directly, so A becomes a valid
         // name in X.
-        String name = currentClass.getName()+"$"+type.getName();
-        ClassNode val = ClassHelper.make(name);
-        if (resolveFromCompileUnit(val)) {
-            type.setRedirect(val);
-            return true;
-        }
+    	// GROOVY-4043: Do this check up the hierarchy, if needed
+    	Map<String, ClassNode> hierClasses = new LinkedHashMap<String, ClassNode>();
+    	ClassNode val;
+        String name;
+    	for(ClassNode classToCheck = currentClass; classToCheck != ClassHelper.OBJECT_TYPE; 
+    		classToCheck = classToCheck.getSuperClass()) {
+    		if(classToCheck == null || hierClasses.containsKey(classToCheck.getName())) break;
+            hierClasses.put(classToCheck.getName(), classToCheck);
+    	}
+    	
+    	for (ClassNode classToCheck : hierClasses.values()) {
+            name = classToCheck.getName()+"$"+type.getName();
+            val = ClassHelper.make(name);
+            if (resolveFromCompileUnit(val)) {
+                type.setRedirect(val);
+                return true;
+            }
+    	}
         
         // another case we want to check here is if we are in a
         // nested class A$B$C and want to access B without
diff --git a/src/test/groovy/bugs/Groovy4043Bug.groovy b/src/test/groovy/bugs/Groovy4043Bug.groovy
new file mode 100644
index 0000000000..ec2157c3f5
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy4043Bug.groovy
@@ -0,0 +1,17 @@
+package groovy.bugs
+
+import gls.CompilableTestSupport
+
+class Groovy4043Bug extends CompilableTestSupport {
+    void testResolveInnerClsDefByAParent() {
+        shouldCompile """
+            class A4043 {
+                static class B4043 {}
+            }
+            
+            class C4043 extends A4043 {
+                B4043 b
+            }
+        """        
+    }
+}
\ No newline at end of file
