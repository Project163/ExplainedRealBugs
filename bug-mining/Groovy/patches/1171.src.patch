diff --git a/src/main/groovy/util/GroovyScriptEngine.java b/src/main/groovy/util/GroovyScriptEngine.java
index 04c95459e9..df640edd9a 100644
--- a/src/main/groovy/util/GroovyScriptEngine.java
+++ b/src/main/groovy/util/GroovyScriptEngine.java
@@ -36,6 +36,7 @@ import java.util.Set;
 import java.util.concurrent.ConcurrentHashMap;
 
 import org.codehaus.groovy.ast.ClassNode;
+import org.codehaus.groovy.ast.InnerClassNode;
 import org.codehaus.groovy.classgen.GeneratorContext;
 import org.codehaus.groovy.control.CompilationFailedException;
 import org.codehaus.groovy.control.CompilationUnit;
@@ -152,6 +153,9 @@ public class GroovyScriptEngine implements ResourceConnector {
                 public void call(final SourceUnit source, GeneratorContext context, ClassNode classNode) 
                     throws CompilationFailedException 
                 {   
+                	// GROOVY-4013: If it is an inner class, tracking its dependencies doesn't really
+                	// serve any purpose and also interferes with the caching done to track dependencies
+                	if(classNode instanceof InnerClassNode) return;
                     DependencyTracker dt = new DependencyTracker(source,cache);
                     dt.visitClass(classNode);
                 }
diff --git a/src/test/groovy/util/GroovyScriptEngineTest.groovy b/src/test/groovy/util/GroovyScriptEngineTest.groovy
index 0e69d61add..b63ce0eea5 100644
--- a/src/test/groovy/util/GroovyScriptEngineTest.groovy
+++ b/src/test/groovy/util/GroovyScriptEngineTest.groovy
@@ -17,8 +17,9 @@ class GroovyScriptEngineTest extends GroovyTestCase {
 	private File makeMe
 	private File helperIntf
 	private File helper
+    private File bug4013
 
-    private List allFiles = [currentDir, srcDir, script, company, util, makeMeSuper, makeMe, helperIntf, helper]
+    private List allFiles = [currentDir, srcDir, script, company, util, makeMeSuper, makeMe, helperIntf, helper, bug4013]
 
     /**
     * Here we have inheritance and delegation-- where the delegate implements an
@@ -89,6 +90,24 @@ class GroovyScriptEngineTest extends GroovyTestCase {
 		       }
 		    }    
 		 """
+         
+        bug4013 = new File(srcDir, "Groovy4013Helper.groovy")
+        bug4013.delete()
+        bug4013 << """
+            import java.awt.event.*
+            import java.awt.*
+            
+            class Groovy4013Helper
+            {
+               def initPanel()
+               {
+                    def b = new Button('click me')
+                    b.addActionListener( new ActionListener(){
+                        public void actionPerformed(ActionEvent e) {}
+                    })
+               }
+            }
+         """
     }
 	
 	public void tearDown(){
@@ -149,6 +168,22 @@ class GroovyScriptEngineTest extends GroovyTestCase {
         }
     }
 
+    //GROOVY-4013
+    void testGSENoCachingOfInnerClasses() {
+        def klazz, gse
+        
+        String[] roots = new String[1]
+        roots[0] = srcDir.getAbsolutePath()
+
+        gse = new GroovyScriptEngine(roots)
+        
+        klazz = gse.loadScriptByName('Groovy4013Helper.groovy')
+        assert klazz.name == 'Groovy4013Helper'
+        
+        klazz = gse.loadScriptByName('Groovy4013Helper.groovy')
+        assert klazz.name == 'Groovy4013Helper' // we should still get the outer class, not inner one
+    }
+    
 	/*
 	 * The script passes the className of the class it's supposed to
 	 * instantiate to this method, expecting a newly instantiated object
