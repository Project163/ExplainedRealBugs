diff --git a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index a9e578ee4b..05d921019e 100644
--- a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -649,7 +649,7 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
             if (enclosingClosure != null) {
                 switch (name) {
                   case "delegate":
-                    DelegationMetadata dm = getDelegationMetadata(enclosingClosure.getClosureExpression());
+                    var dm = getDelegationMetadata(enclosingClosure.getClosureExpression());
                     if (dm != null) {
                         vexp.putNodeMetaData(INFERRED_TYPE, dm.getType());
                         return;
@@ -3797,20 +3797,31 @@ out:                if (mn.size() != 1) {
                         visitMethodCallArguments(chosenReceiver.getType(), argumentList, true, targetMethod); functorsVisited = true;
 
                         ClassNode returnType = getType(targetMethod);
-                        if (isUsingGenericsOrIsArrayUsingGenerics(returnType)) {
+                        // GROOVY-5470, GROOVY-6091, GROOVY-9604, GROOVY-11399:
+                        if (isThisObjectExpression && call.isImplicitThis() && typeCheckingContext.getEnclosingClosure() != null
+                                && (targetMethod == GET_DELEGATE || targetMethod == GET_OWNER || targetMethod == GET_THISOBJECT)) {
+                            switch (name) {
+                              case "getDelegate":
+                                var dm = getDelegationMetadata(typeCheckingContext.getEnclosingClosure().getClosureExpression());
+                                if (dm != null) {
+                                    returnType = dm.getType();
+                                    break;
+                                }
+                                // falls through
+                              case "getOwner":
+                                if (typeCheckingContext.getEnclosingClosureStack().size() > 1) {
+                                    returnType = CLOSURE_TYPE.getPlainNodeReference();
+                                    break;
+                                }
+                                // falls through
+                              case "getThisObject":
+                                returnType = makeThis();
+                            }
+                        } else if (isUsingGenericsOrIsArrayUsingGenerics(returnType)) {
                             ClassNode irtg = inferReturnTypeGenerics(chosenReceiver.getType(), targetMethod, callArguments, call.getGenericsTypes());
                             if (irtg != null && implementsInterfaceOrIsSubclassOf(irtg, returnType))
                                 returnType = irtg;
                         }
-                        // GROOVY-6091: use of "delegate" or "getDelegate()" does not make use of @DelegatesTo metadata
-                        if (targetMethod == GET_DELEGATE && typeCheckingContext.getEnclosingClosure() != null) {
-                            DelegationMetadata md = getDelegationMetadata(typeCheckingContext.getEnclosingClosure().getClosureExpression());
-                            if (md != null) {
-                                returnType = md.getType();
-                            } else {
-                                returnType = typeCheckingContext.getEnclosingClassNode();
-                            }
-                        }
                         // GROOVY-7106, GROOVY-7274, GROOVY-8909, GROOVY-8961, GROOVY-9734, GROOVY-9844, GROOVY-9915, et al.
                         Parameter[] parameters = targetMethod.getParameters();
                         if (chosenReceiver.getType().getGenericsTypes() != null && !targetMethod.isStatic() && !(targetMethod instanceof ExtensionMethodNode)) {
@@ -5116,10 +5127,12 @@ trying: for (ClassNode[] signature : signatures) {
         if (type != null) {
             return type;
         }
+
         if (node instanceof ClassExpression) {
             type = ((ClassExpression) node).getType();
             return makeClassSafe0(CLASS_Type, new GenericsType(type));
         }
+
         if (node instanceof VariableExpression) {
             VariableExpression vexp = (VariableExpression) node;
             type = isTraitSelf(vexp);
@@ -5159,18 +5172,16 @@ trying: for (ClassNode[] signature : signatures) {
             }
             return vexp.getOriginType();
         }
+
         if (node instanceof Parameter || node instanceof FieldNode || node instanceof PropertyNode) {
             return ((Variable) node).getOriginType();
         }
 
         if (node instanceof MethodNode) {
-            if ((node == GET_DELEGATE || node == GET_OWNER || node == GET_THISOBJECT)
-                    && typeCheckingContext.getEnclosingClosure() != null) {
-                return typeCheckingContext.getEnclosingClassNode();
-            }
             type = ((MethodNode) node).getReturnType();
             return Optional.ofNullable(getInferredReturnType(node)).orElse(type);
         }
+
         if (node instanceof MethodCall) {
             if (node instanceof ConstructorCallExpression) {
                 return ((ConstructorCallExpression) node).getType();
@@ -5180,6 +5191,7 @@ trying: for (ClassNode[] signature : signatures) {
                 return getType(target);
             }
         }
+
         if (node instanceof ClosureExpression) {
             type = CLOSURE_TYPE.getPlainNodeReference();
             ClassNode returnType = getInferredReturnType(node);
@@ -5198,9 +5210,11 @@ trying: for (ClassNode[] signature : signatures) {
         if (node instanceof ListExpression) {
             return inferListExpressionType((ListExpression) node);
         }
+
         if (node instanceof MapExpression) {
             return inferMapExpressionType((MapExpression) node);
         }
+
         if (node instanceof RangeExpression) {
             RangeExpression re = (RangeExpression) node;
             ClassNode fromType = getType(re.getFrom());
@@ -5212,19 +5226,24 @@ trying: for (ClassNode[] signature : signatures) {
             }
             return makeClassSafe0(RANGE_TYPE, new GenericsType(type));
         }
+
         if (node instanceof SpreadExpression) {
             type = getType(((SpreadExpression) node).getExpression());
             return inferComponentType(type, null); // for list literal
         }
+
         if (node instanceof UnaryPlusExpression) {
             return getType(((UnaryPlusExpression) node).getExpression());
         }
+
         if (node instanceof UnaryMinusExpression) {
             return getType(((UnaryMinusExpression) node).getExpression());
         }
+
         if (node instanceof BitwiseNegationExpression) {
             return getType(((BitwiseNegationExpression) node).getExpression());
         }
+
         return ((Expression) node).getType();
     }
 
diff --git a/src/test/groovy/transform/stc/BugsSTCTest.groovy b/src/test/groovy/transform/stc/BugsSTCTest.groovy
index 1f2e3d7124..22108a6f89 100644
--- a/src/test/groovy/transform/stc/BugsSTCTest.groovy
+++ b/src/test/groovy/transform/stc/BugsSTCTest.groovy
@@ -243,90 +243,6 @@ class BugsSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
-    void testClosureThisObjectDelegateOwnerProperty() {
-        assertScript '''
-            class C {
-                void m() {
-                    C that = this;
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = thisObject
-                        assert ref == that
-                    }();
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = delegate
-                        assert ref == that
-                    }();
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = owner
-                        assert ref == that
-                    }();
-                }
-            }
-            new C().m()
-        '''
-    }
-
-    void testClosureThisObjectDelegateOwnerAccessor() {
-        assertScript '''
-            class C {
-                void m() {
-                    C that = this;
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = getThisObject()
-                        assert ref == that
-                    }();
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = getDelegate()
-                        assert ref == that
-                    }();
-
-                    { ->
-                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
-                            assert node.getNodeMetaData(INFERRED_TYPE)?.name == 'C'
-                        })
-                        def ref = getOwner()
-                        assert ref == that
-                    }();
-                }
-            }
-            new C().m()
-        '''
-    }
-
-    // GROOVY-9604
-    void testClosureResolveStrategy() {
-        assertScript '''
-            class C {
-                def m() {
-                    return { ->
-                        resolveStrategy + getResolveStrategy()
-                    }();
-                }
-            }
-            assert new C().m() == 0
-        '''
-    }
-
     // GROOVY-5616
     void testAssignToGroovyObject() {
         assertScript '''
@@ -407,16 +323,6 @@ class BugsSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
-    // GROOVY-5874
-    void testClosureSharedVariableInBinExp() {
-        shouldFailWithMessages '''
-            def sum = 0
-            def cl1 = { sum = sum + 1 }
-            def cl2 = { sum = new Date() }
-        ''',
-        'The closure shared variable "sum" has been assigned with various types'
-    }
-
     // GROOVY-5870
     void testShouldNotThrowErrorIfTryingToCastToInterface() {
         assertScript '''
diff --git a/src/test/groovy/transform/stc/ClosuresSTCTest.groovy b/src/test/groovy/transform/stc/ClosuresSTCTest.groovy
index 6d541f7d8f..713714d04f 100644
--- a/src/test/groovy/transform/stc/ClosuresSTCTest.groovy
+++ b/src/test/groovy/transform/stc/ClosuresSTCTest.groovy
@@ -442,8 +442,18 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
         'Cannot find matching method (java.io.Serializable & ','#charAt(int)'
     }
 
-    // GROOVY-9516
+    // GROOVY-5874
     void testClosureSharedVariable3() {
+        shouldFailWithMessages '''
+            def sum = 0
+            def cl1 = { sum = sum + 1 }
+            def cl2 = { sum = new Date() }
+        ''',
+        'The closure shared variable "sum" has been assigned with various types'
+    }
+
+    // GROOVY-9516
+    void testClosureSharedVariable4() {
         shouldFailWithMessages '''
             class A {}
             class B extends A { def m() {} }
@@ -460,7 +470,7 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
     }
 
     // GROOVY-10356
-    void testClosureSharedVariable4() {
+    void testClosureSharedVariable5() {
         assertScript '''
             interface A {
                 void m()
@@ -474,7 +484,7 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
     }
 
     // GROOVY-10052
-    void testClosureSharedVariable5() {
+    void testClosureSharedVariable6() {
         assertScript '''
             String x
             def f = { ->
@@ -486,7 +496,7 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
     }
 
     // GROOVY-10052
-    void testClosureSharedVariable6() {
+    void testClosureSharedVariable7() {
         assertScript '''
             def x
             def f = { ->
@@ -974,6 +984,122 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
         'Non-static method Foo#getBaz cannot be called from static context'
     }
 
+    // GROOVY-5470, GROOVY-6091, GROOVY-9604, GROOVY-11399
+    void testClosureThisObjectDelegateOwnerAccessor() {
+        for (meth in ['getThisObject()', 'getDelegate()', 'getOwner()']) {
+            assertScript """
+                class C {
+                    void m() {
+                        C that = this;
+                        { ->
+                            @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                                def type = node.getNodeMetaData(INFERRED_TYPE)?.toString(false)
+                                assert type/*of $meth*/ == 'C'
+                            })
+                            Object ref = $meth
+                            assert ref == that
+                        }()
+                    }
+                }
+                new C().m()
+            """
+            assertScript """
+                class C {
+                    static m() {
+                        { ->
+                            @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                                def type = node.getNodeMetaData(INFERRED_TYPE)?.toString(false)
+                                assert type/*of $meth*/ == 'java.lang.Class<C>'
+                            })
+                            Object ref = $meth
+                            assert ref == C
+                        }()
+                    }
+                }
+                C.m()
+            """
+        }
+        for (meth in ['getDelegate()', 'getOwner()']) {
+            assertScript """
+                def that
+                that = { ->
+                    { ->
+                        @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                            def type = node.getNodeMetaData(INFERRED_TYPE)
+                            assert type/*of $meth*/ == CLOSURE_TYPE
+                        })
+                        Object ref = $meth
+                        assert ref == that
+                    }()
+                }
+                that.call()
+            """
+        }
+        assertScript '''
+            void test(Closure c) {
+                { ->
+                    @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                        def type = node.getNodeMetaData(INFERRED_TYPE)
+                        assert type == OBJECT_TYPE
+                    })
+                    def x = c.getThisObject()
+                }()
+            }
+            test({->})
+        '''
+    }
+
+    // GROOVY-5470, GROOVY-6091, GROOVY-9604, GROOVY-11399
+    void testClosureThisObjectDelegateOwnerProperty() {
+        for (prop in ['thisObject', 'delegate', 'owner']) {
+            assertScript """
+                class C {
+                    void m() {
+                        C that = this;
+                        { ->
+                            @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                                def type = node.getNodeMetaData(INFERRED_TYPE)?.toString(false)
+                                assert type/*of $prop*/ == 'C'
+                            })
+                            Object ref = $prop
+                            assert ref == that
+                        }()
+                    }
+                }
+                new C().m()
+            """
+            assertScript """
+                class C {
+                    static m() {
+                        { ->
+                            @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                                def type = node.getNodeMetaData(INFERRED_TYPE)?.toString(false)
+                                assert type/*of $prop*/ == 'java.lang.Class<C>'
+                            })
+                            Object ref = $prop
+                            assert ref == C
+                        }()
+                    }
+                }
+                C.m()
+            """
+        }
+        assertScript '''
+            def that
+            that = { ->
+                { ->
+                    @ASTTest(phase=INSTRUCTION_SELECTION, value={
+                        def type = node.getNodeMetaData(INFERRED_TYPE)
+                        assert type == CLOSURE_TYPE
+                    })
+                    Object ref = owner
+                    assert ref == that
+                }()
+            }
+            that.call()
+        '''
+    }
+
     // GROOVY-9652
     void testDelegatePropertyAndCharCompareOptimization() {
         ['String', 'Character', 'char'].each { type ->
@@ -1072,4 +1198,18 @@ class ClosuresSTCTest extends StaticTypeCheckingTestCase {
             foo()
         '''
     }
+
+    // GROOVY-9604
+    void testClosureResolveStrategy() {
+        assertScript '''
+            class C {
+                def m() {
+                    return { ->
+                        resolveStrategy + getResolveStrategy()
+                    }();
+                }
+            }
+            assert new C().m() == 0
+        '''
+    }
 }
