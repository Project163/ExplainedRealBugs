diff --git a/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/util/PackageHelperImpl.groovy b/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/util/PackageHelperImpl.groovy
index 490f5c7a4b..6a98b8f518 100644
--- a/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/util/PackageHelperImpl.groovy
+++ b/subprojects/groovy-groovysh/src/main/groovy/org/apache/groovy/groovysh/util/PackageHelperImpl.groovy
@@ -25,6 +25,7 @@ import org.codehaus.groovy.tools.shell.util.Logger
 import org.codehaus.groovy.tools.shell.util.Preferences
 
 import java.nio.file.InvalidPathException
+import java.nio.file.Paths
 import java.util.jar.JarEntry
 import java.util.jar.JarFile
 import java.util.prefs.PreferenceChangeEvent
@@ -243,7 +244,7 @@ Files.walkFileTree(fs.getPath('modules'),
      * Returns all package names found at URL; accepts jar files and folders.
      */
     static Collection<String> getPackageNames(URL url) {
-        File urlFile = new File(URLDecoder.decode(url.file, 'UTF-8'))
+        File urlFile = Paths.get(url.toURI()).toFile()
 
         if (urlFile.isDirectory()) {
             return new HashSet<String>().tap {
diff --git a/subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/util/PackageHelperImplTest.groovy b/subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/util/PackageHelperImplTest.groovy
index 34d8f6e47b..db3e0760ff 100644
--- a/subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/util/PackageHelperImplTest.groovy
+++ b/subprojects/groovy-groovysh/src/test/groovy/org/apache/groovy/groovysh/util/PackageHelperImplTest.groovy
@@ -20,6 +20,12 @@ package org.apache.groovy.groovysh.util
 
 import groovy.test.GroovyTestCase
 
+import java.nio.file.Files
+import java.nio.file.Path
+import java.util.jar.JarEntry
+import java.util.jar.JarOutputStream
+import java.util.jar.Manifest
+
 /**
  * Unit tests for the {@link PackageHelperImpl} class.
  */
@@ -58,4 +64,64 @@ class PackageHelperImplTest extends GroovyTestCase {
         PackageHelperImpl helper = new PackageHelperImpl(null)
         assert [] as Set<String> == helper.getContents('java.util.regex.tools')
     }
+
+    void testGetPackageNamesFromPathWithSign() {
+        Path tempTestDirPath = Files.createTempDirectory(this.getClass().getName())
+        Path folderWithSign = tempTestDirPath.resolve('dummy+folder++1%23%%')
+
+        Path dummyFilePath = folderWithSign.resolve('dummypackage1').resolve('Dummy.class')
+        Files.createDirectories(dummyFilePath.getParent())
+        File dummyFile = dummyFilePath.toFile()
+        try (FileOutputStream fos = new FileOutputStream(dummyFile)) {
+            fos.write(0)
+        }
+        assert dummyFile.exists()
+
+        Path jarWithSignPath = folderWithSign.resolve("dummy+lib++1%23%%.jar")
+        try (FileOutputStream fos = new FileOutputStream(jarWithSignPath.toFile())
+             JarOutputStream jos = new JarOutputStream(fos, new Manifest())) {
+            JarEntry jarEntry = new JarEntry("dummypackage2/Dummy.class")
+            jos.putNextEntry(jarEntry)
+            jos.write(0)
+        }
+        assert jarWithSignPath.toFile().exists()
+
+        PackageHelperImpl helper = new PackageHelperImpl(null)
+
+        Set<String> packageInFolder = helper.getPackageNames(folderWithSign.toUri().toURL())
+        assert packageInFolder.contains("dummypackage1")
+
+        Set<String> packageInJar = helper.getPackageNames(jarWithSignPath.toUri().toURL())
+        assert packageInJar.contains("dummypackage2")
+    }
+
+    void testGetPackageNamesFromPathWithSpace() {
+        Path tempTestDirPath = Files.createTempDirectory(this.getClass().getName())
+        Path folderWithSpacePath = Files.createTempDirectory(tempTestDirPath, 'dummy folder 1')
+
+        Path dummyFilePath = folderWithSpacePath.resolve('dummypackage1').resolve('Dummy.class')
+        Files.createDirectories(dummyFilePath.getParent())
+        File dummyFile = dummyFilePath.toFile()
+        try (FileOutputStream fos = new FileOutputStream(dummyFile)) {
+            fos.write(0)
+        }
+        assert dummyFile.exists()
+
+        Path jarWithSpacePath = folderWithSpacePath.resolve("dummy lib 2.jar")
+        try (FileOutputStream fos = new FileOutputStream(jarWithSpacePath.toFile())
+             JarOutputStream jos = new JarOutputStream(fos, new Manifest())) {
+            JarEntry jarEntry = new JarEntry("dummypackage2/Dummy.class")
+            jos.putNextEntry(jarEntry)
+            jos.write(0)
+        }
+        assert jarWithSpacePath.toFile().exists()
+
+        PackageHelperImpl helper = new PackageHelperImpl(null)
+
+        Set<String> packageInFolder = helper.getPackageNames(folderWithSpacePath.toUri().toURL())
+        assert packageInFolder.contains("dummypackage1")
+
+        Set<String> packageInJar = helper.getPackageNames(jarWithSpacePath.toUri().toURL())
+        assert packageInJar.contains("dummypackage2")
+    }
 }
