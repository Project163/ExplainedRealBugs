diff --git a/src/main/java/org/codehaus/groovy/tools/javac/JavaStubGenerator.java b/src/main/java/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
index 3a7a96ac83..d8abb06d94 100644
--- a/src/main/java/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
+++ b/src/main/java/org/codehaus/groovy/tools/javac/JavaStubGenerator.java
@@ -22,7 +22,6 @@ import org.apache.groovy.ast.tools.ExpressionUtils;
 import org.apache.groovy.io.StringBuilderWriter;
 import org.codehaus.groovy.ast.AnnotatedNode;
 import org.codehaus.groovy.ast.AnnotationNode;
-import org.codehaus.groovy.ast.ClassHelper;
 import org.codehaus.groovy.ast.ClassNode;
 import org.codehaus.groovy.ast.ConstructorNode;
 import org.codehaus.groovy.ast.FieldNode;
@@ -58,6 +57,7 @@ import org.objectweb.asm.Opcodes;
 
 import javax.tools.FileObject;
 import javax.tools.JavaFileObject;
+
 import java.io.File;
 import java.io.FileNotFoundException;
 import java.io.FileOutputStream;
@@ -79,6 +79,8 @@ import java.util.Set;
 import java.util.stream.Stream;
 
 import static org.apache.groovy.ast.tools.ConstructorNodeUtils.getFirstIfSpecialConstructorCall;
+import static org.codehaus.groovy.ast.ClassHelper.getUnwrapper;
+import static org.codehaus.groovy.ast.ClassHelper.isCachedType;
 import static org.codehaus.groovy.ast.ClassHelper.isClassType;
 import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveBoolean;
 import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveByte;
@@ -90,6 +92,7 @@ import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveLong;
 import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveShort;
 import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveType;
 import static org.codehaus.groovy.ast.ClassHelper.isPrimitiveVoid;
+import static org.codehaus.groovy.ast.ClassHelper.isStaticConstantInitializerType;
 import static org.codehaus.groovy.ast.ClassHelper.isStringType;
 import static org.codehaus.groovy.ast.tools.GenericsUtils.correctToGenericsSpec;
 import static org.codehaus.groovy.ast.tools.GenericsUtils.createGenericsSpec;
@@ -503,7 +506,8 @@ public class JavaStubGenerator {
     }
 
     private void printField(PrintWriter out, FieldNode fieldNode, boolean isInterface) {
-        if ((fieldNode.getModifiers() & Opcodes.ACC_PRIVATE) != 0) return;
+        if (fieldNode.isPrivate()) return;
+
         printAnnotations(out, fieldNode);
         if (!isInterface) {
             printModifiers(out, fieldNode.getModifiers());
@@ -512,9 +516,9 @@ public class JavaStubGenerator {
         ClassNode type = fieldNode.getType();
         printType(out, type);
 
-        out.print(" ");
+        out.print(' ');
         out.print(fieldNode.getName());
-        if (isInterface || (fieldNode.getModifiers() & Opcodes.ACC_FINAL) != 0) {
+        if (isInterface || fieldNode.isFinal()) {
             out.print(" = ");
             Expression valueExpr = fieldNode.getInitialValueExpression();
             if (valueExpr instanceof ConstantExpression) {
@@ -522,37 +526,23 @@ public class JavaStubGenerator {
             }
             if (valueExpr instanceof ConstantExpression
                     && fieldNode.isStatic() && fieldNode.isFinal()
-                    && ClassHelper.isStaticConstantInitializerType(valueExpr.getType())
-                    && valueExpr.getType().equals(fieldNode.getType())) {
-                // GROOVY-5150 : Initialize value with a dummy constant so that Java cross compiles correctly
-                if (ClassHelper.STRING_TYPE.equals(valueExpr.getType())) {
-                    out.print(formatString(valueExpr.getText()));
-                } else if (isPrimitiveChar(valueExpr.getType())) {
-                    out.print("'"+valueExpr.getText()+"'");
+                    && fieldNode.getType().equals(valueExpr.getType())
+                    && (isStaticConstantInitializerType(valueExpr.getType()) || isPrimitiveBoolean(valueExpr.getType()))) {
+                printValue(out, (ConstantExpression) valueExpr);
+            } else if (isPrimitiveType(type)) {
+                if (isPrimitiveBoolean(type)) {
+                    out.print("false");
                 } else {
-                    ClassNode constantType = valueExpr.getType();
                     out.print('(');
-                    printType(out, type);
-                    out.print(") ");
-                    out.print(valueExpr.getText());
-                    if (ClassHelper.Long_TYPE.equals(ClassHelper.getWrapper(constantType))) out.print('L');
+                    printTypeName(out, type);
+                    out.print(')');
+                    out.print('0');
                 }
-            } else if (ClassHelper.isPrimitiveType(type)) {
-                String val = isPrimitiveBoolean(type) ? "false" : "0";
-                out.print("new " + ClassHelper.getWrapper(type) + "((" + type + ")" + val + ")");
             } else {
                 out.print("null");
             }
         }
-        out.println(";");
-    }
-
-    private static String formatChar(String ch) {
-        return "'" + escapeSpecialChars("" + ch.charAt(0)) + "'";
-    }
-
-    private static String formatString(String s) {
-        return "\"" + escapeSpecialChars(s) + "\"";
+        out.println(';');
     }
 
     private void printConstructor(PrintWriter out, ClassNode clazz, ConstructorNode constructorNode) {
@@ -778,37 +768,50 @@ public class JavaStubGenerator {
         return Traits.isTrait(methodNode.getDeclaringClass()) && Traits.hasDefaultImplementation(methodNode);
     }
 
-    private static void printValue(PrintWriter out, Expression re, boolean assumeClass) {
+    private void printValue(final PrintWriter out, final Expression exp, final boolean assumeClass) {
         if (assumeClass) {
-            if (re.getType().getName().equals("groovy.lang.Closure")) {
+            if (exp.getType().getName().equals("groovy.lang.Closure")) {
                 out.print("groovy.lang.Closure.class");
                 return;
             }
-            String className = re.getText();
+            String className = exp.getText();
             out.print(className);
             if (!className.endsWith(".class")) {
                 out.print(".class");
             }
+        } else if (exp instanceof ConstantExpression) {
+            printValue(out, (ConstantExpression) exp);
         } else {
-            if (re instanceof ConstantExpression) {
-                ConstantExpression ce = (ConstantExpression) re;
-                Object value = ce.getValue();
-                if (ClassHelper.STRING_TYPE.equals(ce.getType())) {
-                    out.print(formatString((String)value));
-                } else if (ClassHelper.char_TYPE.equals(ce.getType()) || ClassHelper.Character_TYPE.equals(ce.getType())) {
-                    out.print(formatChar(value.toString()));
-                } else if (ClassHelper.long_TYPE.equals(ce.getType())) {
-                    out.print("" + value + "L");
-                } else if (ClassHelper.float_TYPE.equals(ce.getType())) {
-                    out.print("" + value + "f");
-                } else if (ClassHelper.double_TYPE.equals(ce.getType())) {
-                    out.print("" + value + "d");
-                } else {
-                    out.print(re.getText());
-                }
-            } else {
-                out.print(re.getText());
+            out.print(exp.getText());
+        }
+    }
+
+    private void printValue(final PrintWriter out, final ConstantExpression ce) {
+        ClassNode type = getUnwrapper(ce.getType());
+        if (isPrimitiveChar(type)) {
+            out.print("'");
+            out.print(escapeSpecialChars(ce.getText().substring(0, 1)));
+            out.print("'");
+        } else if (isStringType(type)) {
+            out.print('"');
+            out.print(escapeSpecialChars(ce.getText()));
+            out.print('"');
+        } else if (isPrimitiveDouble(type)) {
+            out.print(ce.getText());
+            out.print('d');
+        } else if (isPrimitiveFloat(type)) {
+            out.print(ce.getText());
+            out.print('f');
+        } else if (isPrimitiveLong(type)) {
+            out.print(ce.getText());
+            out.print('L');
+        } else {
+            if (!isPrimitiveInt(type) && !isPrimitiveBoolean(type)) {
+                out.print('(');
+                printType(out, type);
+                out.print(')');
             }
+            out.print(ce.getText());
         }
     }
 
@@ -849,7 +852,7 @@ public class JavaStubGenerator {
     }
 
     private void printTypeName(PrintWriter out, ClassNode type) {
-        if (ClassHelper.isPrimitiveType(type)) {
+        if (isPrimitiveType(type)) {
             if (isPrimitiveBoolean(type)) {
                 out.print("boolean");
             } else if (isPrimitiveChar(type)) {
@@ -880,8 +883,7 @@ public class JavaStubGenerator {
 
     private void printGenericsBounds(PrintWriter out, ClassNode type, boolean skipName) {
         if (!skipName) printTypeName(out, type);
-        if (!java5) return;
-        if (!ClassHelper.isCachedType(type)) {
+        if (java5 && !isCachedType(type)) {
             printGenericsBounds(out, type.getGenericsTypes());
         }
     }
diff --git a/src/test/groovy/bugs/Groovy5260Bug.groovy b/src/test/groovy/bugs/Groovy5260Bug.groovy
index 610118fa7f..b193651421 100644
--- a/src/test/groovy/bugs/Groovy5260Bug.groovy
+++ b/src/test/groovy/bugs/Groovy5260Bug.groovy
@@ -19,22 +19,25 @@
 package groovy.bugs
 
 import groovy.test.GroovyTestCase
+import groovy.transform.AutoFinal
+import org.codehaus.groovy.ast.ClassHelper
 import org.codehaus.groovy.ast.ClassNode
 import org.codehaus.groovy.ast.CompileUnit
 import org.codehaus.groovy.ast.ModuleNode
 import org.codehaus.groovy.tools.javac.JavaStubGenerator
-import org.objectweb.asm.Opcodes
-import org.codehaus.groovy.ast.ClassHelper
-import org.codehaus.groovy.ast.FieldNode
-import org.codehaus.groovy.ast.expr.ConstantExpression
 
-class Groovy5260Bug extends GroovyTestCase implements Opcodes {
-    File outputDir
+import static org.codehaus.groovy.ast.tools.GeneralUtils.constX
+import static org.objectweb.asm.Opcodes.*
+
+@AutoFinal
+final class Groovy5260Bug extends GroovyTestCase {
+
+    private File outputDir
 
     @Override
     protected void setUp() {
         super.setUp()
-        outputDir = File.createTempFile("stub","groovy")
+        outputDir = File.createTempFile('stub', 'groovy')
         outputDir.mkdirs()
     }
 
@@ -44,78 +47,74 @@ class Groovy5260Bug extends GroovyTestCase implements Opcodes {
         outputDir.delete()
     }
 
-    private void checkConstant(ConstantExpression constant, String expectation) {
-        ClassNode cn = new ClassNode("Foo", ACC_PUBLIC, ClassHelper.OBJECT_TYPE)
-        ModuleNode module = new ModuleNode(new CompileUnit(null,null))
-        cn.setModule(module)
-        cn.addField(new FieldNode("constant", ACC_PUBLIC+ACC_STATIC+ACC_FINAL, constant.type, cn, constant))
-        StringWriter wrt = new StringWriter()
-        PrintWriter out = new PrintWriter(wrt)
-        JavaStubGenerator generator = new StringJavaStubGenerator(outputDir, out)
-        generator.generateClass(cn)
-
-        String stub = wrt.toString()
-        assert (stub =~ expectation)
+    void testIntConstant() {
+        checkConstant(ClassHelper.int_TYPE, 666, /final int constant = 666;/)
     }
 
     void testLongConstant() {
-        def constant = new ConstantExpression(666, true)
-        constant.type = ClassHelper.long_TYPE
-        checkConstant(constant, /\(long\) 666L/)
+        checkConstant(ClassHelper.long_TYPE, 666, 'final long constant = 666L;')
     }
 
-    void testIntConstant() {
-        def constant = new ConstantExpression(666, true)
-        constant.type = ClassHelper.int_TYPE
-        checkConstant(constant, /\(int\) 666/)
+    void testFloatConstant() {
+        checkConstant(ClassHelper.float_TYPE, 3.14f, 'final float constant = 3.14f;')
     }
 
     void testByteConstant() {
-        def constant = new ConstantExpression(123, true)
-        constant.type = ClassHelper.byte_TYPE
-        checkConstant(constant, /\(byte\) 123/)
+        checkConstant(ClassHelper.byte_TYPE, 123, /final byte constant = \(byte\)123;/)
     }
 
     void testBooleanConstant() {
-        def constant = new ConstantExpression(false, true)
-        constant.type = ClassHelper.boolean_TYPE
-        // boolean type is not optimized yet
-        checkConstant(constant, /new java.lang.Boolean\(\(boolean\)false\)/)
+        checkConstant(ClassHelper.boolean_TYPE, true, 'final boolean constant = true;')
+    }
+
+    void testCharConstant() {
+        checkConstant(ClassHelper.char_TYPE, 'c', 'final char constant = \'c\';')
     }
 
     void testStringConstant() {
-        def constant = new ConstantExpression('foo', true)
-        constant.type = ClassHelper.STRING_TYPE
-        checkConstant(constant, /"foo"/)
+        checkConstant(ClassHelper.STRING_TYPE, 'foo', 'final java.lang.String constant = "foo";')
+    }
+
+    //--------------------------------------------------------------------------
+
+    private void checkConstant(ClassNode type, Object value, String expectation) {
+        def constant = constX(value, true)
+        constant.type = type
+
+        ClassNode cn = new ClassNode('script', ACC_PUBLIC, ClassHelper.OBJECT_TYPE)
+        cn.addField('constant', ACC_PUBLIC | ACC_STATIC | ACC_FINAL, constant.type, constant)
+        ModuleNode module = new ModuleNode(new CompileUnit(null, null))
+        cn.setModule(module)
+
+        StringWriter wrt = new StringWriter()
+        PrintWriter out = new PrintWriter(wrt)
+        JavaStubGenerator generator = new StringJavaStubGenerator(outputDir, out)
+        generator.generateClass(cn)
+
+        String stub = wrt.toString()
+        assert (stub =~ expectation)
     }
 
     /**
      * Helper class, which generates code in a string instead of an output file.
      */
     private static final class StringJavaStubGenerator extends JavaStubGenerator {
+
         PrintWriter out
+
         StringJavaStubGenerator(File outFile, PrintWriter out) {
             super(outFile)
             this.out = out
         }
-        public void generateClass(ClassNode classNode) throws FileNotFoundException {
-
 
-            try {
+        public void generateClass(ClassNode classNode) throws FileNotFoundException {
+            try (out) {
                 String packageName = classNode.getPackageName();
                 if (packageName != null) {
                     out.println("package " + packageName + ";\n");
                 }
-
                 super.printImports(out, classNode);
                 super.printClassContents(out, classNode);
-
-            } finally {
-                try {
-                    out.close();
-                } catch (Exception e) {
-                    // ignore
-                }
             }
         }
     }
diff --git a/src/test/org/codehaus/groovy/tools/stubgenerator/AnnotationDefaultValuesStubTest.groovy b/src/test/org/codehaus/groovy/tools/stubgenerator/AnnotationDefaultValuesStubTest.groovy
index d4d038cff0..6b34a22c7e 100644
--- a/src/test/org/codehaus/groovy/tools/stubgenerator/AnnotationDefaultValuesStubTest.groovy
+++ b/src/test/org/codehaus/groovy/tools/stubgenerator/AnnotationDefaultValuesStubTest.groovy
@@ -21,7 +21,7 @@ package org.codehaus.groovy.tools.stubgenerator
 /**
  * Checks that default values from annotation definitions appear within stubs.
  */
-class AnnotationDefaultValuesStubTest extends StringSourcesStubTestCase {
+final class AnnotationDefaultValuesStubTest extends StringSourcesStubTestCase {
 
     Map<String, String> provideSources() {
         [
@@ -73,8 +73,8 @@ class AnnotationDefaultValuesStubTest extends StringSourcesStubTestCase {
         assert stubSource.contains('float f() default 3.0f;')
         assert stubSource.contains('double d() default 3.0d;')
         assert stubSource.contains('long l() default 3L;')
-        assert stubSource.contains('byte me() default 3;')
-        assert stubSource.contains('short s() default 3;')
+        assert stubSource.contains('byte me() default (byte)3;')
+        assert stubSource.contains('short s() default (short)3;')
         assert stubSource.contains("char c1() default 'A';")
         assert stubSource.contains("char c2() default 'A';")
         assert stubSource.contains("char c3() default 'A';")
diff --git a/src/test/org/codehaus/groovy/tools/stubgenerator/Groovy10299.groovy b/src/test/org/codehaus/groovy/tools/stubgenerator/Groovy10299.groovy
new file mode 100644
index 0000000000..750c300fdf
--- /dev/null
+++ b/src/test/org/codehaus/groovy/tools/stubgenerator/Groovy10299.groovy
@@ -0,0 +1,49 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one
+ *  or more contributor license agreements.  See the NOTICE file
+ *  distributed with this work for additional information
+ *  regarding copyright ownership.  The ASF licenses this file
+ *  to you under the Apache License, Version 2.0 (the
+ *  "License"); you may not use this file except in compliance
+ *  with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing,
+ *  software distributed under the License is distributed on an
+ *  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ *  KIND, either express or implied.  See the License for the
+ *  specific language governing permissions and limitations
+ *  under the License.
+ */
+package org.codehaus.groovy.tools.stubgenerator
+
+final class Groovy10299 extends StringSourcesStubTestCase {
+
+    @Override
+    Map<String, String> provideSources() {
+        [
+            'Pogo.groovy': '''
+                class Pogo {
+                    public final boolean must_init
+                }
+            ''',
+            'Main.java': '''
+                public class Main {
+                    public static void main(String[] args) {
+                        new Pogo();
+                    }
+                }
+            ''',
+        ]
+    }
+
+    @Override
+    void verifyStubs() {
+        String name = this.class.name
+        String stub = stubJavaSourceFor('Pogo')
+        assert stub.contains('must_init = false;')
+        assert !stub.contains('boolean -> boolean')
+        assert !stub.contains('new java.lang.Boolean')
+    }
+}
