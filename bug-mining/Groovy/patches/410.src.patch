diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index 9e31ea9ef0..6214d1e584 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -3144,41 +3144,6 @@ public class DefaultGroovyMethods {
         return true;
     }
 
-    public static boolean equals(Object[] left, Object[] right) {
-        if (left == null) {
-            return right == null;
-        }
-        if (right == null) {
-            return false;
-        }
-        if (left.length != right.length) {
-            return false;
-        }
-        final NumberAwareComparator numberAwareComparator = new NumberAwareComparator();
-        for (int i = left.length - 1; i >= 0; i--) {
-            final Object o1 = left[i];
-            final Object o2 = right[i];
-            if (o1 == null) {
-                if (o2 != null) return false;
-            } else {
-                if (o1 instanceof Number) {
-                    if (!(o2 instanceof Number && numberAwareComparator.compare(o1, o2) == 0)) {
-                        return false;
-                    }
-                } else {
-                    // Use this way of calling equals in case the element is a List
-                    // or any other type which has an equals in DGM
-                    if (!invokeEquals(o1, o2)) return false;
-                }
-            }
-        }
-        return true;
-    }
-
-    private static boolean invokeEquals(Object o1, Object o2) {
-        return ((Boolean) InvokerHelper.invokeMethod(o1, "equals", new Object[]{o2})).booleanValue();
-    }
-
     public static boolean equals(Object[] left, List right) {
         return coercedEquals(left, right);
     }
@@ -3209,9 +3174,7 @@ public class DefaultGroovyMethods {
                         return false;
                     }
                 } else {
-                    // Use this way of calling equals in case the element is a List
-                    // or any other type which has an equals in DGM
-                    if (!invokeEquals(o1, o2)) return false;
+                    if (!DefaultTypeTransformation.compareEqual(o1, o2)) return false;
                 }
             }
         }
@@ -3250,9 +3213,7 @@ public class DefaultGroovyMethods {
                         return false;
                     }
                 } else {
-                    // Use this way of calling equals in case the element is a List
-                    // or any other type which has an equals in DGM
-                    if (!invokeEquals(o1, o2)) return false;
+                    if (!DefaultTypeTransformation.compareEqual(o1, o2)) return false;
                 }
             }
         }
diff --git a/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java b/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
index 197cc403c3..c8746d4ead 100644
--- a/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
+++ b/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
@@ -450,7 +450,11 @@ public class DefaultTypeTransformation {
         int size = Array.getLength(array);
         List list = new ArrayList(size);
         for (int i = 0; i < size; i++) {
-            list.add(Array.get(array, i));
+            Object item = Array.get(array, i);
+            if (item.getClass().isArray() && item.getClass().getComponentType().isPrimitive()) {
+                item = primitiveArrayToList(item);
+            }
+            list.add(item);
         }
         return list;
     }
@@ -508,19 +512,18 @@ public class DefaultTypeTransformation {
         if (left instanceof Comparable) {
             return compareTo(left, right) == 0;
         }
-        // handle int[] on both sides as special case for efficiency
-        if (left instanceof int[] && right instanceof int[]) {
-            return DefaultGroovyMethods.equals((int[]) left, (int[]) right);
+        // handle arrays on both sides as special case for efficiency
+        Class leftClass = left.getClass();
+        Class rightClass = right.getClass();
+        if (leftClass.isArray() && rightClass.isArray()) {
+            return compareArrayEqual(left, right);
         }
-        if (left.getClass().isArray() && left.getClass().getComponentType().isPrimitive()) {
+        if (leftClass.isArray() && leftClass.getComponentType().isPrimitive()) {
             left = primitiveArrayToList(left);
         }
-        if (right.getClass().isArray() && right.getClass().getComponentType().isPrimitive()) {
+        if (rightClass.isArray() && rightClass.getComponentType().isPrimitive()) {
             right = primitiveArrayToList(right);
         }
-        if (left instanceof Object[] && right instanceof Object[]) {
-            return DefaultGroovyMethods.equals((Object[]) left, (Object[]) right);
-        }
         if (left instanceof Object[] && right instanceof List) {
             return DefaultGroovyMethods.equals((Object[]) left, (List) right);
         }
@@ -532,7 +535,25 @@ public class DefaultTypeTransformation {
         }
         return left.equals(right);
     }
-    
+
+    public static boolean compareArrayEqual(Object left, Object right) {
+        if (left == null) {
+            return right == null;
+        }
+        if (right == null) {
+            return false;
+        }
+        if (Array.getLength(left) != Array.getLength(right)) {
+            return false;
+        }
+        for (int i = 0; i < Array.getLength(left); i++) {
+            Object l = Array.get(left, i);
+            Object r = Array.get(right, i);
+            if (!compareEqual(l, r)) return false;
+        }
+        return true;
+    }
+
     /**
      * @return true if the given value is a valid character string (i.e. has length of 1)
      */
@@ -551,7 +572,6 @@ public class DefaultTypeTransformation {
      * @param type component type of the array
      */
     public static Object[] convertPrimitiveArray(Object a, Class type) {
-//        System.out.println("a.getClass() = " + a.getClass());
         Object[] ans = null;
         String elemType = type.getName();
         if (elemType.equals("int")) {
@@ -847,5 +867,5 @@ public class DefaultTypeTransformation {
             return a;
         }
     }
-    
+
 }
diff --git a/src/test/groovy/ArrayTest.groovy b/src/test/groovy/ArrayTest.groovy
index 773789f89f..b561f5c561 100644
--- a/src/test/groovy/ArrayTest.groovy
+++ b/src/test/groovy/ArrayTest.groovy
@@ -113,6 +113,10 @@ class ArrayTest extends GroovyTestCase {
         assert arr1 == list1
         assert list1 == primarr1
         assert primarr1 == list1
+        boolean[] bools1 = [true, true, false]
+        boolean[] bools2 = [true, true, false]
+        assert bools1 == bools2
+        assert bools1 == [true, true, false] as boolean[]
     }
 
     void testComplexArrayEquals() {
@@ -123,8 +127,19 @@ class ArrayTest extends GroovyTestCase {
         def x = [[1,2] as Integer[]]
         Object[] y = [[1,2]]
         assert y == x
-        //TODO: make this work; currently throws ClassCastException
-        //assert [[1,2],[3,4]] as int[][] == [[1,2],[3,4]] as int[][]
+        assert [[1,2],[3,4]] as int[][] == [[1,2],[3,4]] as int[][]
+        assert [[[5,6],[7,8]]] as int[][][] == [[[5,6],[7,8]]] as int[][][]
+        assert [[1,2],[3,4]] as long[][] == [[1,2],[3,4]] as long[][]
+        assert [[1,2],[3,4]] as long[][] == [[1,2],[3,4]] as Long[][]
+        assert [[1,2],[3,4]] as long[][] == [[1,2],[3,4]]
+        assert [[1,2],[3,4]] as long[][] == [[1,2] as short[], [3,4] as short[]]
+        int[][] intsA = [[1,2],[3,4]]
+        assert intsA == [[1,2],[3,4]] as int[][]
+        int[][] intsB = [[1,2],[3,4]]
+        assert intsA == intsB
+        boolean[][] boolsA = [[true, true], [false, true], [false]]
+        boolean[][] boolsB = [[true, true], [false, true], [false]]
+        assert boolsA == boolsB
     }
 
 }
