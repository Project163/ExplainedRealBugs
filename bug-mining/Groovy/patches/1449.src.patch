diff --git a/src/main/org/codehaus/groovy/classgen/asm/InvocationWriter.java b/src/main/org/codehaus/groovy/classgen/asm/InvocationWriter.java
index 8b5b7d2b6b..625b7ccc09 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/InvocationWriter.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/InvocationWriter.java
@@ -84,6 +84,7 @@ public class InvocationWriter {
             boolean safe, boolean spreadSafe, boolean implicitThis
     ) {
         ClassNode cn = controller.getClassNode();
+        if (controller.isInClosure() && !implicitThis && AsmClassGenerator.isThisExpression(receiver)) cn=cn.getOuterClass();
         makeCall(origin, new ClassExpression(cn), receiver, message, arguments,
                 adapter, safe, spreadSafe, implicitThis);
     }
diff --git a/src/test/gls/invocation/MethodSelectionTest.groovy b/src/test/gls/invocation/MethodSelectionTest.groovy
index b51b700022..f70a467367 100644
--- a/src/test/gls/invocation/MethodSelectionTest.groovy
+++ b/src/test/gls/invocation/MethodSelectionTest.groovy
@@ -175,6 +175,24 @@ public class MethodSelectionTest extends CompilableTestSupport {
     } 
   }
   
+  void testPrivateMethodSelectionFromClosure(){
+      assertScript """
+          class I1 {
+              private foo() {1}
+              def bar(){
+                def x = "foo"
+                return {this."\$x"()}
+              }
+          }
+          class I2 extends I1 {
+              def foo(){2}
+          }
+          def i = new I2()
+          assert i.bar()() == 1
+      
+      """
+  }
+  
   void testBDandBIToFloatAutoConversionInMethodSelection() {
     def foo = new Foo3977()
     
diff --git a/src/test/groovy/lang/ExpandoMetaClassTest.groovy b/src/test/groovy/lang/ExpandoMetaClassTest.groovy
index 80d448174f..dfc80e23a8 100644
--- a/src/test/groovy/lang/ExpandoMetaClassTest.groovy
+++ b/src/test/groovy/lang/ExpandoMetaClassTest.groovy
@@ -745,9 +745,29 @@ class ExpandoMetaClassTest extends GroovyTestCase {
         try {
             assert ExpandoMetaClass.class.metaClass instanceof MetaClass
         } finally {
-            GroovySystem.metaClassRegistry.setMetaClass(ExpandoMetaClass.class,null)
+            GroovySystem.metaClassRegistry.removeMetaClass(ExpandoMetaClass.class)
         }
-     
+    }
+    
+    void testDynamicAddedMethodWithGStringCall() {
+        // GROOVY-4691
+        assertScript """
+          class A {
+            def bar(x) {
+              return {this."\$x"()}
+            }
+          }
+          try {
+            A.metaClass.foo = {->1}
+            A.metaClass.methodMissing = { method, args -> 2}
+          
+            def a = new A()
+            assert a.bar("foo")() == 1
+            assert a.x() == 2
+          } finally {
+            GroovySystem.metaClassRegistry.removeMetaClass(A);
+          }
+        """
     }
 }
 
