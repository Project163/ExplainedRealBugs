diff --git a/src/main/org/codehaus/groovy/classgen/InnerClassVisitor.java b/src/main/org/codehaus/groovy/classgen/InnerClassVisitor.java
index 12285c9cfd..376bb0dfde 100644
--- a/src/main/org/codehaus/groovy/classgen/InnerClassVisitor.java
+++ b/src/main/org/codehaus/groovy/classgen/InnerClassVisitor.java
@@ -149,6 +149,13 @@ public class InnerClassVisitor extends InnerClassVisitorHelper implements Opcode
         }
 
         InnerClassNode innerClass = (InnerClassNode) call.getType();
+        ClassNode outerClass = innerClass.getOuterClass();
+        ClassNode superClass = innerClass.getSuperClass();
+        if (superClass instanceof InnerClassNode
+                && !superClass.isInterface()
+                && !(superClass.isStaticClass()||((superClass.getModifiers()&ACC_STATIC)==ACC_STATIC))) {
+            insertThis0ToSuperCall(call, innerClass);
+        }
         if (!innerClass.getDeclaredConstructors().isEmpty()) return;
         if ((innerClass.getModifiers() & ACC_STATIC) != 0) return;
 
@@ -191,7 +198,7 @@ public class InnerClassVisitor extends InnerClassVisitorHelper implements Opcode
         pCount = 0;
         expressions.add(pCount, VariableExpression.THIS_EXPRESSION);
         boolean isStatic = isStaticThis(innerClass,scope);
-        ClassNode outerClassType = getClassNode(innerClass.getOuterClass(), isStatic);
+        ClassNode outerClassType = getClassNode(outerClass, isStatic);
         if (!isStatic && inClosure) outerClassType = ClassHelper.CLOSURE_TYPE;
         outerClassType = outerClassType.getPlainNodeReference();
         Parameter thisParameter = new Parameter(outerClassType, "p" + pCount);
@@ -262,7 +269,11 @@ public class InnerClassVisitor extends InnerClassVisitorHelper implements Opcode
             }
             return;
         }
+        insertThis0ToSuperCall(call, cn);
+
+    }
 
+    private void insertThis0ToSuperCall(final ConstructorCallExpression call, final ClassNode cn) {
         // calculate outer class which we need for this$0
         ClassNode parent = classNode;
         int level = 0;
diff --git a/src/test/groovy/bugs/Groovy6811Bug.groovy b/src/test/groovy/bugs/Groovy6811Bug.groovy
new file mode 100644
index 0000000000..0cb681b233
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy6811Bug.groovy
@@ -0,0 +1,52 @@
+/*
+ * Copyright 2003-2014 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+
+
+package groovy.bugs
+
+class Groovy6811Bug extends GroovyTestCase {
+    void testShouldAllowAnonymousInnerClassFromNonStaticInnerClass() {
+        assertScript '''class CreatePaymentPanel {
+    def foo() { new SomeFragment() {} }
+
+    class SomeFragment {}
+}
+
+new CreatePaymentPanel().foo()
+'''
+    }
+
+    void testShouldNotIntroduceThis0InSuperCallIfSuperIsInterface() {
+        assertScript '''
+class Outer {
+interface ForTestInterface extends Comparable {
+        void forTestMethod()
+    }
+    void m() {
+     new ForTestInterface(){
+            @Override
+            void forTestMethod() {}
+
+            @Override
+            int compareTo(Object o) {return 0}
+        }
+    }
+}
+new Outer().m()
+'''
+    }
+}
diff --git a/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy b/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
index a113841f88..739f4afdad 100644
--- a/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
+++ b/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
@@ -95,7 +95,6 @@ class AnonymousInnerClassSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
-    @NotYetImplemented
     void testAICIntoClass() {
         assertScript '''
             class Outer {
