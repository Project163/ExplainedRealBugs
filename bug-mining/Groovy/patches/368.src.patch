diff --git a/src/main/groovy/util/slurpersupport/FilteredNodeChildren.java b/src/main/groovy/util/slurpersupport/FilteredNodeChildren.java
index 0435caa771..33bdc67137 100644
--- a/src/main/groovy/util/slurpersupport/FilteredNodeChildren.java
+++ b/src/main/groovy/util/slurpersupport/FilteredNodeChildren.java
@@ -36,19 +36,17 @@ public class FilteredNodeChildren extends NodeChildren {
 
     public Iterator iterator() {
         return new Iterator() {
-        final Iterator iter = FilteredNodeChildren.this.parent.iterator();
-        Object next = null;
+            final Iterator iter = FilteredNodeChildren.this.parent.iterator();
+            Object next = null;
 
             public boolean hasNext() {
                 while (this.iter.hasNext()) {
-                final Object childNode = this.iter.next();
-                
+                    final Object childNode = this.iter.next();
                     if (closureYieldsTrueForNode(childNode)) {
                         this.next = childNode;
                         return true;
                     }
                 }
-                
                 return false;
             }
 
@@ -66,8 +64,7 @@ public class FilteredNodeChildren extends NodeChildren {
         return new NodeIterator(this.parent.nodeIterator()) {
             protected Object getNextNode(final Iterator iter) {
                 while (iter.hasNext()) {
-                final Object node = iter.next();
-                
+                    final Object node = iter.next();
                     if (closureYieldsTrueForNode(new NodeChild((Node) node, FilteredNodeChildren.this.parent, FilteredNodeChildren.this.namespaceTagHints))) {
                         return node;
                     }
@@ -80,5 +77,4 @@ public class FilteredNodeChildren extends NodeChildren {
     private boolean closureYieldsTrueForNode(Object childNode) {
         return DefaultTypeTransformation.castToBoolean(FilteredNodeChildren.this.closure.call(new Object[]{childNode}));
     }
-
 }
diff --git a/src/main/groovy/util/slurpersupport/NodeChildren.java b/src/main/groovy/util/slurpersupport/NodeChildren.java
index f536ddd06e..05da65b126 100644
--- a/src/main/groovy/util/slurpersupport/NodeChildren.java
+++ b/src/main/groovy/util/slurpersupport/NodeChildren.java
@@ -64,32 +64,31 @@ class NodeChildren extends GPathResult {
 
     public Iterator childNodes() {
         return new Iterator() {
-            private final Iterator iter = NodeChildren.this.parent.childNodes();
+            private final Iterator iter = parent.childNodes();
             private Iterator childIter = nextChildIter();
 
             /* (non-Javadoc)
             * @see java.util.Iterator#hasNext()
             */
             public boolean hasNext() {
-                return this.childIter != null;
+                return childIter != null;
             }
 
             /* (non-Javadoc)
             * @see java.util.Iterator#next()
             */
             public Object next() {
-                while (this.childIter != null) {
+                while (childIter != null) {
                     try {
-                        if (this.childIter.hasNext()) {
-                            return this.childIter.next();
+                        if (childIter.hasNext()) {
+                            return childIter.next();
                         }
                     } finally {
-                        if (!this.childIter.hasNext()) {
-                            this.childIter = nextChildIter();
+                        if (!childIter.hasNext()) {
+                            childIter = nextChildIter();
                         }
                     }
                 }
-
                 return null;
             }
 
@@ -101,22 +100,19 @@ class NodeChildren extends GPathResult {
             }
 
             private Iterator nextChildIter() {
-                while (this.iter.hasNext()) {
-                    final Node node = (Node) this.iter.next();
-
-                    if (NodeChildren.this.name.equals(node.name())) {
+                while (iter.hasNext()) {
+                    final Node node = (Node) iter.next();
+                    if (name.equals(node.name()) || name.equals("*")) {
                         final Iterator result = node.childNodes();
-
                         if (result.hasNext()) {
-                            if ("*".equals(NodeChildren.this.namespacePrefix) ||
-                                    ("".equals(NodeChildren.this.namespacePrefix) && "".equals(node.namespaceURI())) ||
-                                    node.namespaceURI().equals(NodeChildren.this.namespaceMap.get(NodeChildren.this.namespacePrefix))) {
+                            if ("*".equals(namespacePrefix) ||
+                                    ("".equals(namespacePrefix) && "".equals(node.namespaceURI())) ||
+                                    node.namespaceURI().equals(namespaceMap.get(namespacePrefix))) {
                                 return result;
                             }
                         }
                     }
                 }
-
                 return null;
             }
         };
@@ -124,14 +120,14 @@ class NodeChildren extends GPathResult {
 
     public Iterator iterator() {
         return new Iterator() {
-        final Iterator iter = nodeIterator();
+            final Iterator iter = nodeIterator();
 
             public boolean hasNext() {
-                return this.iter.hasNext();
+                return iter.hasNext();
             }
 
             public Object next() {
-                return new NodeChild((Node) this.iter.next(), NodeChildren.this.parent, NodeChildren.this.namespaceTagHints);
+                return new NodeChild((Node) iter.next(), parent, namespaceTagHints);
             }
 
             public void remove() {
@@ -141,26 +137,24 @@ class NodeChildren extends GPathResult {
     }
 
     public Iterator nodeIterator() {
-        if ("*".equals(this.name)) {
-            return this.parent.childNodes();
+        if ("*".equals(name)) {
+            return parent.childNodes();
         } else {
-            return new NodeIterator(this.parent.childNodes()) {
+            return new NodeIterator(parent.childNodes()) {
                 /* (non-Javadoc)
                 * @see org.codehaus.groovy.sandbox.util.slurpersupport.NodeIterator#getNextNode(java.util.Iterator)
                 */
                 protected Object getNextNode(Iterator iter) {
                     while (iter.hasNext()) {
                         final Node node = (Node) iter.next();
-
-                        if (NodeChildren.this.name.equals(node.name())) {
-                            if ("*".equals(NodeChildren.this.namespacePrefix) ||
-                                    ("".equals(NodeChildren.this.namespacePrefix) && "".equals(node.namespaceURI())) ||
-                                    node.namespaceURI().equals(NodeChildren.this.namespaceMap.get(NodeChildren.this.namespacePrefix))) {
+                        if (name.equals(node.name())) {
+                            if ("*".equals(namespacePrefix) ||
+                                    ("".equals(namespacePrefix) && "".equals(node.namespaceURI())) ||
+                                    node.namespaceURI().equals(namespaceMap.get(namespacePrefix))) {
                                 return node;
                             }
                         }
                     }
-
                     return null;
                 }
             };
@@ -175,56 +169,47 @@ class NodeChildren extends GPathResult {
     public synchronized int size() {
         if (this.size == -1) {
             final Iterator iter = iterator();
-
             this.size = 0;
             while (iter.hasNext()) {
                 iter.next();
                 this.size++;
             }
         }
-
         return this.size;
     }
 
     public String text() {
-    final StringBuffer buf = new StringBuffer();
-    final Iterator iter = nodeIterator();
-
+        final StringBuffer buf = new StringBuffer();
+        final Iterator iter = nodeIterator();
         while (iter.hasNext()) {
             buf.append(((Node) iter.next()).text());
         }
-
         return buf.toString();
     }
 
     public GPathResult find(final Closure closure) {
-    final Iterator iter = iterator();
-
+        final Iterator iter = iterator();
         while (iter.hasNext()) {
             final Object node = iter.next();
-
             if (DefaultTypeTransformation.castToBoolean(closure.call(new Object[]{node}))) {
                 return (GPathResult) node;
             }
         }
-
-        return new NoChildren(this, this.name, this.namespaceTagHints);
+        return new NoChildren(this, this.name, namespaceTagHints);
     }
 
     public GPathResult findAll(final Closure closure) {
-        return new FilteredNodeChildren(this, closure, this.namespaceTagHints);
+        return new FilteredNodeChildren(this, closure, namespaceTagHints);
     }
 
     public void build(final GroovyObject builder) {
         final Iterator iter = nodeIterator();
-
         while (iter.hasNext()) {
             final Object next = iter.next();
-
             if (next instanceof Buildable) {
                 ((Buildable) next).build(builder);
             } else {
-                ((Node) next).build(builder, this.namespaceMap, this.namespaceTagHints);
+                ((Node) next).build(builder, namespaceMap, namespaceTagHints);
             }
         }
     }
@@ -233,38 +218,33 @@ class NodeChildren extends GPathResult {
     * @see groovy.lang.Writable#writeTo(java.io.Writer)
     */
     public Writer writeTo(final Writer out) throws IOException {
-    final Iterator iter = nodeIterator();
-
+        final Iterator iter = nodeIterator();
         while (iter.hasNext()) {
             ((Node) iter.next()).writeTo(out);
         }
-
         return out;
     }
 
     protected void replaceNode(final Closure newValue) {
-    final Iterator iter = iterator();
-
+        final Iterator iter = iterator();
         while (iter.hasNext()) {
-        final NodeChild result = (NodeChild)iter.next();
+            final NodeChild result = (NodeChild) iter.next();
             result.replaceNode(newValue);
         }
     }
 
     protected void replaceBody(final Object newValue) {
-    final Iterator iter = iterator();
-
+        final Iterator iter = iterator();
         while (iter.hasNext()) {
-        final NodeChild result = (NodeChild)iter.next();
+            final NodeChild result = (NodeChild) iter.next();
             result.replaceBody(newValue);
         }
     }
 
     protected void appendNode(final Object newValue) {
-    final Iterator iter = iterator();
-
+        final Iterator iter = iterator();
         while (iter.hasNext()) {
-        final NodeChild result = (NodeChild)iter.next();
+            final NodeChild result = (NodeChild) iter.next();
             result.appendNode(newValue);
         }
     }
diff --git a/src/test/groovy/util/XmlParserTest.groovy b/src/test/groovy/util/XmlParserTest.groovy
index a38f8fcf51..680713ccd0 100644
--- a/src/test/groovy/util/XmlParserTest.groovy
+++ b/src/test/groovy/util/XmlParserTest.groovy
@@ -31,6 +31,7 @@ class XmlParserTest extends GroovyTestCase {
     void testNavigation() {
         GpathSyntaxTestSupport.checkChildren(getRoot)
         GpathSyntaxTestSupport.checkParent(getRoot)
+        GpathSyntaxTestSupport.checkNestedSizeExpressions(getRoot)
     }
 
     void testTraversal() {
diff --git a/src/test/groovy/util/XmlSlurperTest.groovy b/src/test/groovy/util/XmlSlurperTest.groovy
index 7125c5cf7f..a483c98783 100644
--- a/src/test/groovy/util/XmlSlurperTest.groovy
+++ b/src/test/groovy/util/XmlSlurperTest.groovy
@@ -52,6 +52,7 @@ class XmlSlurperTest extends GroovyTestCase {
     void testNavigation() {
         GpathSyntaxTestSupport.checkChildren(getRoot)
         GpathSyntaxTestSupport.checkParent(getRoot)
+        GpathSyntaxTestSupport.checkNestedSizeExpressions(getRoot)
     }
 
     void testTraversal() {
diff --git a/src/test/groovy/xml/GpathSyntaxTestSupport.groovy b/src/test/groovy/xml/GpathSyntaxTestSupport.groovy
index 43a48376c1..468cb01b07 100644
--- a/src/test/groovy/xml/GpathSyntaxTestSupport.groovy
+++ b/src/test/groovy/xml/GpathSyntaxTestSupport.groovy
@@ -15,6 +15,15 @@ class GpathSyntaxTestSupport {
     <urlValue>http://example.org/</urlValue>
     <empty/>
 </characters>
+'''
+
+    private static def nestedXml = '''
+<root>
+    <a><z/><z/><y/></a>
+    <b><z/></b>
+    <c><x/></c>
+    <d></d>
+</root>
 '''
 
     static void checkElement(Closure getRoot) {
@@ -63,6 +72,18 @@ class GpathSyntaxTestSupport {
         assert answer == "cheese"
     }
 
+    static void checkNestedSizeExpressions(Closure getRoot) {
+        def root = getRoot(nestedXml)
+        assert root.'*'.size() == 4, "Expected size 4 but was ${root.'*'.size()}"
+        assert root.'a'.'z'.size() == 2
+        assert root.'*'.'*'.size() == 5
+        assert root.a.'*'.size() == 3
+        assert root.'*'.z.size() == 3
+        assert root.'*'.'*'.collect{it.name()} == ["z", "z", "y", "z", "x"]
+        assert root.a.'*'.collect{it.name()} == ["z", "z", "y"]
+        assert root.'*'.findAll{ it.z.size() > 0 }.collect{it.name()} == ["a", "b"]
+    }
+
     static void checkElementTypes(Closure getRoot) {
         def root = getRoot(sampleXml)
         def numericValue = root.numericValue[0]
diff --git a/src/test/groovy/xml/dom/DOMCategoryTest.groovy b/src/test/groovy/xml/dom/DOMCategoryTest.groovy
index 56d56a7c6a..f9b8067c88 100644
--- a/src/test/groovy/xml/dom/DOMCategoryTest.groovy
+++ b/src/test/groovy/xml/dom/DOMCategoryTest.groovy
@@ -39,6 +39,7 @@ class DOMCategoryTest extends GroovyTestCase {
         use(DOMCategory) {
             GpathSyntaxTestSupport.checkChildren(getRoot)
             GpathSyntaxTestSupport.checkParent(getRoot)
+            GpathSyntaxTestSupport.checkNestedSizeExpressions(getRoot)
         }
     }
 
