diff --git a/src/main/java/org/codehaus/groovy/classgen/asm/indy/InvokeDynamicWriter.java b/src/main/java/org/codehaus/groovy/classgen/asm/indy/InvokeDynamicWriter.java
index 70fbbc5d05..74aee3209d 100644
--- a/src/main/java/org/codehaus/groovy/classgen/asm/indy/InvokeDynamicWriter.java
+++ b/src/main/java/org/codehaus/groovy/classgen/asm/indy/InvokeDynamicWriter.java
@@ -41,6 +41,7 @@ import java.lang.invoke.MethodHandles.Lookup;
 import java.lang.invoke.MethodType;
 import java.util.List;
 
+import static org.apache.groovy.ast.tools.ExpressionUtils.isThisExpression;
 import static org.codehaus.groovy.ast.ClassHelper.OBJECT_TYPE;
 import static org.codehaus.groovy.ast.ClassHelper.boolean_TYPE;
 import static org.codehaus.groovy.ast.ClassHelper.getWrapper;
@@ -158,8 +159,8 @@ public class InvokeDynamicWriter extends InvocationWriter {
     private static int getMethodCallFlags(final MethodCallerMultiAdapter adapter, final boolean safe, final boolean spread) {
         int flags = 0;
         if (safe)                           flags |= SAFE_NAVIGATION;
-        if (adapter==invokeMethodOnCurrent) flags |= THIS_CALL;
         if (spread)                         flags |= SPREAD_CALL;
+        if (adapter==invokeMethodOnCurrent) flags |= THIS_CALL;
 
         return flags;
     }
@@ -169,18 +170,13 @@ public class InvokeDynamicWriter extends InvocationWriter {
         makeIndyCall(invokeMethod, receiver, false, safe, message, arguments);
     }
 
-    private static int getPropertyFlags(final boolean safe, final boolean implicitThis, final boolean groovyObject) {
+    protected void writeGetProperty(final Expression receiver, final String propertyName, final boolean safe, final boolean implicitThis, final boolean groovyObject) {
+        var descriptor = prepareIndyCall(receiver, implicitThis) + ")Ljava/lang/Object;";
         int flags = 0;
-        if (implicitThis) flags |= IMPLICIT_THIS;
-        if (groovyObject) flags |= GROOVY_OBJECT;
         if (safe)         flags |= SAFE_NAVIGATION;
-
-        return flags;
-    }
-
-    protected void writeGetProperty(final Expression receiver, final String propertyName, final boolean safe, final boolean implicitThis, final boolean groovyObject) {
-        String descriptor = prepareIndyCall(receiver, implicitThis) + ")Ljava/lang/Object;";
-        int flags = getPropertyFlags(safe,implicitThis,groovyObject);
+        if (groovyObject) flags |= GROOVY_OBJECT;
+        if (implicitThis) flags |= IMPLICIT_THIS;
+        else if (isThisExpression(receiver)) flags |= THIS_CALL; // GROOVY-6335
         finishIndyCall(BSM, GET.getCallSiteName(), descriptor, 1, propertyName, flags);
     }
 
diff --git a/src/main/java/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java b/src/main/java/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java
index a17ae83247..f17ea3c82b 100644
--- a/src/main/java/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java
+++ b/src/main/java/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java
@@ -498,7 +498,6 @@ public class ScriptBytecodeAdapter {
 
     public static void setProperty(Object messageArgument, Class senderClass, Object receiver, String messageName) throws Throwable {
         try {
-            if (receiver == null) receiver = NullObject.getNullObject();
             InvokerHelper.setProperty(receiver, messageName, messageArgument);
         } catch (GroovyRuntimeException gre) {
             throw unwrap(gre);
@@ -522,7 +521,16 @@ public class ScriptBytecodeAdapter {
     //  --------------------------------------------------------
 
     public static Object getGroovyObjectProperty(Class senderClass, GroovyObject receiver, String messageName) throws Throwable {
-        return receiver.getProperty(messageName);
+        try {
+            return receiver.getProperty(messageName);
+        } catch (GroovyRuntimeException gre) {
+            /* TODO
+            if (gre instanceof MissingPropertyException && senderClass!=receiver.getClass() && senderClass.isInstance(receiver)) {
+                return receiver.getMetaClass().getProperty(senderClass, receiver, messageName, false, false);
+            }
+            */
+            throw unwrap(gre);
+        }
     }
 
     public static Object getGroovyObjectPropertySafe(Class senderClass, GroovyObject receiver, String messageName) throws Throwable {
@@ -546,7 +554,11 @@ public class ScriptBytecodeAdapter {
     public static void setGroovyObjectProperty(Object messageArgument, Class senderClass, GroovyObject receiver, String messageName) throws Throwable {
         try {
             receiver.setProperty(messageName, messageArgument);
-        } catch (GroovyRuntimeException gre) {
+        } catch (GroovyRuntimeException gre) { // GROOVY-3142: retry with super sender class?
+            if (gre instanceof MissingPropertyException && senderClass != receiver.getClass() && senderClass.isInstance(receiver)) {
+                receiver.getMetaClass().setProperty(senderClass, receiver, messageName, messageArgument, false, false);
+                return;
+            }
             throw unwrap(gre);
         }
     }
diff --git a/src/test/groovy/ClosureTest.groovy b/src/test/groovy/ClosureTest.groovy
index 0fb52ee58f..c8e61c3d5d 100644
--- a/src/test/groovy/ClosureTest.groovy
+++ b/src/test/groovy/ClosureTest.groovy
@@ -608,25 +608,81 @@ final class ClosureTest {
         '''
     }
 
-    // GROOVY-3142
+    // GROOVY-3142, GROOVY-5438, GROOVY-6335
     @Test
     void testClosureAccessToEnclosingClassPrivateField() {
-        assertScript '''
-            class C {
-                private String string = 'foo'
-                def test(List<String> strings) {
-                    strings.collect { this.@string + it }
+        for (who in ['this.@', 'this.']) {
+            assertScript """
+                class C {
+                    String data
+                    C(arg) {
+                        arg.each() { ${who}data = it } // MissingFieldException
+                    }
                 }
-            }
 
-            def result = new C().test(['bar','baz'])
-            assert result == ['foobar','foobaz']
+                class D extends C {
+                    D(arg) {
+                        super(arg)
+                    }
+                }
 
-            class D extends C {
-            }
+                new D(["test"])
+            """
 
-            result = new D().test(['bar','baz'])
-            assert result == ['foobar','foobaz']
-        '''
+            assertScript """
+                class C {
+                    private String data
+                    C(arg) {
+                        arg.each() { ${who}data = it } // ReadOnlyPropertyException
+                    }
+                    String getData() { this.@data }
+                    private void setData(String value) { this.@data = value }
+                }
+
+                class D extends C {
+                    D(arg) {
+                        super(arg)
+                    }
+                }
+
+                new D(["test"])
+            """
+
+            assertScript """
+                class C {
+                    private String string = 'foo'
+                    def test(List<String> strings) {
+                        strings.collect { ${who}string + it }
+                    }
+                }
+
+                def result = new C().test(['bar','baz'])
+                assert result == ['foobar','foobaz']
+
+                class D extends C {
+                }
+
+                result = new D().test(['bar','baz'])
+                assert result == ['foobar','foobaz']
+            """
+
+            assertScript """
+                @groovy.util.logging.Log
+                class C {
+                    void test() {
+                        2.times {
+                            1.times {
+                                ${who}log.info('sth')
+                            }
+                        }
+                    }
+                }
+
+                class D extends C {
+                }
+
+                new D().test()
+            """
+        }
     }
 }
