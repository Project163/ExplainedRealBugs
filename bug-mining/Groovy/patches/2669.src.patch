diff --git a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
index 50020a3de5..c853604e57 100644
--- a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
+++ b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
@@ -884,9 +884,16 @@ public class AsmClassGenerator extends ClassGenerator {
             while (!iterType.equals(type)) {
                 String ownerName = BytecodeHelper.getClassInternalName(iterType);
                 if (iterType.getOuterClass()==null) break;
+                ClassNode thisFieldType = iterType.getField("this$0").getType();
                 iterType = iterType.getOuterClass();
-                String typeName = BytecodeHelper.getTypeDescription(iterType);
-                mv.visitFieldInsn(GETFIELD, ownerName, "this$0", typeName);
+                if (ClassHelper.CLOSURE_TYPE.equals(thisFieldType)) {
+                    mv.visitFieldInsn(GETFIELD, ownerName, "this$0", BytecodeHelper.getTypeDescription(ClassHelper.CLOSURE_TYPE));
+                    mv.visitMethodInsn(INVOKEVIRTUAL, BytecodeHelper.getClassInternalName(ClassHelper.CLOSURE_TYPE), "getThisObject", "()Ljava/lang/Object;", false);
+                    mv.visitTypeInsn(CHECKCAST, BytecodeHelper.getClassInternalName(iterType));
+                } else {
+                    String typeName = BytecodeHelper.getTypeDescription(iterType);
+                    mv.visitFieldInsn(GETFIELD, ownerName, "this$0", typeName);
+                }
             }
             controller.getOperandStack().push(type);
             return;
diff --git a/src/main/org/codehaus/groovy/classgen/InnerClassCompletionVisitor.java b/src/main/org/codehaus/groovy/classgen/InnerClassCompletionVisitor.java
index 3dfa131632..3ad864ac9e 100644
--- a/src/main/org/codehaus/groovy/classgen/InnerClassCompletionVisitor.java
+++ b/src/main/org/codehaus/groovy/classgen/InnerClassCompletionVisitor.java
@@ -38,12 +38,18 @@ import org.objectweb.asm.Opcodes;
 
 import java.util.List;
 
+import static org.codehaus.groovy.ast.ClassHelper.CLOSURE_TYPE;
+
 public class InnerClassCompletionVisitor extends InnerClassVisitorHelper implements Opcodes {
 
     private final SourceUnit sourceUnit;
     private ClassNode classNode;
     private FieldNode thisField = null;
 
+    private static final String
+            CLOSURE_INTERNAL_NAME   = BytecodeHelper.getClassInternalName(CLOSURE_TYPE),
+            CLOSURE_DESCRIPTOR      = BytecodeHelper.getTypeDescription(CLOSURE_TYPE);
+
     public InnerClassCompletionVisitor(CompilationUnit cu, SourceUnit su) {
         sourceUnit = su;
     }
@@ -146,6 +152,17 @@ public class InnerClassCompletionVisitor extends InnerClassVisitorHelper impleme
         setPropertyGetterDispatcher(block, VariableExpression.THIS_EXPRESSION, parameters);
         method.setCode(block);
     }
+
+    private void getThis(MethodVisitor mv, String classInternalName, String outerClassDescriptor, String innerClassInternalName) {
+        mv.visitVarInsn(ALOAD, 0);
+        if (CLOSURE_TYPE.equals(thisField.getType())) {
+            mv.visitFieldInsn(GETFIELD, classInternalName, "this$0", CLOSURE_DESCRIPTOR);
+            mv.visitMethodInsn(INVOKEVIRTUAL, CLOSURE_INTERNAL_NAME, "getThisObject", "()Ljava/lang/Object;", false);
+            mv.visitTypeInsn(CHECKCAST, innerClassInternalName);
+        } else {
+            mv.visitFieldInsn(GETFIELD, classInternalName, "this$0", outerClassDescriptor);
+        }
+    }
     
     private void addDefaultMethods(InnerClassNode node) {
         final boolean isStatic = isStatic(node);
@@ -182,8 +199,7 @@ public class InnerClassCompletionVisitor extends InnerClassVisitorHelper impleme
             block.addStatement(
                     new BytecodeSequence(new BytecodeInstruction() {
                         public void visit(MethodVisitor mv) {
-                            mv.visitVarInsn(ALOAD, 0);
-                            mv.visitFieldInsn(GETFIELD, classInternalName, "this$0", outerClassDescriptor);
+                            getThis(mv,classInternalName,outerClassDescriptor,outerClassInternalName);
                             mv.visitVarInsn(ALOAD, 1);
                             mv.visitVarInsn(ALOAD, 2);
                             mv.visitMethodInsn(INVOKEVIRTUAL, outerClassInternalName, "this$dist$invoke$" + objectDistance, "(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;", false);
@@ -220,8 +236,7 @@ public class InnerClassCompletionVisitor extends InnerClassVisitorHelper impleme
             block.addStatement(
                     new BytecodeSequence(new BytecodeInstruction() {
                         public void visit(MethodVisitor mv) {
-                            mv.visitVarInsn(ALOAD, 0);
-                            mv.visitFieldInsn(GETFIELD, classInternalName, "this$0", outerClassDescriptor);
+                            getThis(mv,classInternalName,outerClassDescriptor,outerClassInternalName);
                             mv.visitVarInsn(ALOAD, 1);
                             mv.visitVarInsn(ALOAD, 2);
                             mv.visitMethodInsn(INVOKEVIRTUAL, outerClassInternalName, "this$dist$set$" + objectDistance, "(Ljava/lang/String;Ljava/lang/Object;)V", false);
@@ -257,8 +272,7 @@ public class InnerClassCompletionVisitor extends InnerClassVisitorHelper impleme
             block.addStatement(
                     new BytecodeSequence(new BytecodeInstruction() {
                         public void visit(MethodVisitor mv) {
-                            mv.visitVarInsn(ALOAD, 0);
-                            mv.visitFieldInsn(GETFIELD, classInternalName, "this$0", outerClassDescriptor);
+                            getThis(mv,classInternalName,outerClassDescriptor,outerClassInternalName);
                             mv.visitVarInsn(ALOAD, 1);
                             mv.visitMethodInsn(INVOKEVIRTUAL, outerClassInternalName, "this$dist$get$" + objectDistance, "(Ljava/lang/String;)Ljava/lang/Object;", false);
                             mv.visitInsn(ARETURN);
diff --git a/src/test/gls/innerClass/InnerClassTest.groovy b/src/test/gls/innerClass/InnerClassTest.groovy
index 4397ead0ec..0d8682683b 100644
--- a/src/test/gls/innerClass/InnerClassTest.groovy
+++ b/src/test/gls/innerClass/InnerClassTest.groovy
@@ -202,6 +202,27 @@ class InnerClassTest extends CompilableTestSupport {
             Foo.x(2)
             assert Foo.foo() == 2
         """
+
+        assertScript """
+            interface X {
+                def m()
+            }
+
+            class A {
+                def pm = "pm"
+
+                def bar(x) {x().m()}
+                def foo() {
+                    bar { ->
+                        return new X() {
+                            def m() { pm }
+                        }
+                    }
+                }
+            }
+            def a = new A()
+            assert "pm" == a.foo()
+        """
     }
 
     void testUsageOfOuterFieldOverriden_FAILS() {
@@ -353,6 +374,26 @@ class InnerClassTest extends CompilableTestSupport {
             assert a.x == 1
             assert b.y == 4
         """
+
+        assertScript """
+            interface X {
+                def m()
+            }
+
+            class A {
+                def foo() {
+                    def c = {
+                        return new X(){def m(){
+                            A.this
+                         } }
+                    }
+                    return c().m()
+                }
+            }
+            class B extends A {}
+            def b = new B()
+            assert b.foo() instanceof B
+        """
     }
     
     void testImplicitThisPassingWithNamedArguments() {
