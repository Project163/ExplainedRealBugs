diff --git a/src/main/groovy/lang/MetaClassImpl.java b/src/main/groovy/lang/MetaClassImpl.java
index 0d6cfed2f2..fb990d6691 100644
--- a/src/main/groovy/lang/MetaClassImpl.java
+++ b/src/main/groovy/lang/MetaClassImpl.java
@@ -2337,8 +2337,10 @@ public class MetaClassImpl implements MetaClass, MutableMetaClass {
             if (Modifier.isFinal(field.getModifiers())) {
                 throw new ReadOnlyPropertyException(name, theClass);
             }
-            field.setProperty(object, newValue);
-            return;
+            if(!(this.isMap && isPrivateOrPkgPrivate(field.getModifiers()))) {
+                field.setProperty(object, newValue);
+                return;
+            }
         }
 
         //----------------------------------------------------------------------
@@ -2397,6 +2399,10 @@ public class MetaClassImpl implements MetaClass, MutableMetaClass {
         invokeMissingProperty(object, name, newValue, false);
     }
 
+    private boolean isPrivateOrPkgPrivate(int mod) {
+    	return !Modifier.isProtected(mod) && !Modifier.isPublic(mod); 
+    }
+    
     private MetaProperty getMetaProperty(Class _clazz, String name, boolean useSuper, boolean useStatic) {
         if (_clazz == theClass)
           return getMetaProperty(name, useStatic);
diff --git a/src/test/groovy/bugs/Groovy3679Bug.groovy b/src/test/groovy/bugs/Groovy3679Bug.groovy
new file mode 100644
index 0000000000..7ec9ea11c3
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy3679Bug.groovy
@@ -0,0 +1,31 @@
+package groovy.bugs
+
+class Groovy3679Bug extends GroovyTestCase {
+    void testMapEntryWinOverPvtAndPkgPrivateClassFields() {
+    	// map entry should win over a package-private field
+    	def map1 = new HashMap()
+    	map1["table"] = "Some table"
+    	assert map1["table"] != null
+    	
+        // map entry should win over a private field
+		def map2 = [:]
+		map2["header"] = "Some header"
+		assert map2["header"] != null
+        
+    	// following is to verify that setting of private fields with .@"$x" syntax is not
+    	// broken by the fix introduced
+    	def x = new X3679()
+    	x.setSomething("foo",2)
+    	assert x.getAFoo() == 2    
+    }
+}
+
+class X3679 extends HashMap {
+    private foo
+    def setSomething(String x,y) {
+        this.@"$x" = y
+    }
+    def getAFoo() {
+        return foo
+    }
+}
\ No newline at end of file
