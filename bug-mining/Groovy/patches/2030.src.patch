diff --git a/subprojects/groovy-servlet/src/main/java/groovy/servlet/AbstractHttpServlet.java b/subprojects/groovy-servlet/src/main/java/groovy/servlet/AbstractHttpServlet.java
index bba0c6de8d..25570ae4b1 100644
--- a/subprojects/groovy-servlet/src/main/java/groovy/servlet/AbstractHttpServlet.java
+++ b/subprojects/groovy-servlet/src/main/java/groovy/servlet/AbstractHttpServlet.java
@@ -22,6 +22,7 @@ import java.io.File;
 import java.io.IOException;
 import java.net.MalformedURLException;
 import java.net.URI;
+import java.net.URISyntaxException;
 import java.net.URL;
 import java.net.URLConnection;
 import java.util.regex.Matcher;
@@ -164,18 +165,40 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
         this.logGROOVY861 = false;
     }
 
-    /**
-     * Interface method for ResourceContainer. This is used by the GroovyScriptEngine.
-     */
-    public URLConnection getResourceConnection(String name) throws ResourceException {
+    private String removeNamePrefix(String name) throws ResourceException {
         URI uri = new File(servletContext.getRealPath("/")).toURI();
         try {
             String basePath = uri.toURL().toExternalForm();
-            if (name.startsWith(basePath)) name = name.substring(basePath.length());
+            if (name.startsWith(basePath)) return name.substring(basePath.length());
         } catch (MalformedURLException e) {
             throw new ResourceException("Malformed URL for base path '"+ uri + "'", e);
         }
+        
+        try {
+            URL res = servletContext.getResource("/"); 
+            if (res!=null) uri = res.toURI();
+        } catch (MalformedURLException e) {
+            // ignore
+        } catch (URISyntaxException e) {
+            // ignore
+        }
 
+        if (uri!=null) {
+            try {
+                String basePath = uri.toURL().toExternalForm();
+                if (name.startsWith(basePath)) return name.substring(basePath.length());
+            } catch (MalformedURLException e) {
+                throw new ResourceException("Malformed URL for base path '"+ uri + "'", e);
+            }
+        }
+        return name;
+    }
+    
+    /**
+     * Interface method for ResourceContainer. This is used by the GroovyScriptEngine.
+     */
+    public URLConnection getResourceConnection(String name) throws ResourceException {
+        name = removeNamePrefix(name);
         name = name.replaceAll("\\\\", "/");
 
         //remove the leading / as we are trying with a leading / now
@@ -193,8 +216,6 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
             }
             if (url == null) {
                 throw new ResourceException("Resource \"" + name + "\" not found!");
-            } else {
-                url = new URL("file", "", servletContext.getRealPath(tryScriptName));
             }
             return url.openConnection();
         } catch (IOException e) {
@@ -202,10 +223,6 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
         }
     }
 
-    private boolean isFile(URL ret) {
-        return ret != null && ret.getProtocol().equals("file");
-    }
-
     /**
      * Returns the include-aware uri of the script or template file.
      *
diff --git a/subprojects/groovy-servlet/src/test/groovy/groovy/servlet/AbstractHttpServletTest.groovy b/subprojects/groovy-servlet/src/test/groovy/groovy/servlet/AbstractHttpServletTest.groovy
index 637b1da6d1..70370f5291 100644
--- a/subprojects/groovy-servlet/src/test/groovy/groovy/servlet/AbstractHttpServletTest.groovy
+++ b/subprojects/groovy-servlet/src/test/groovy/groovy/servlet/AbstractHttpServletTest.groovy
@@ -242,7 +242,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
         def connection = servlet.getResourceConnection(servlet.getScriptUri(request))
         //expecting http://somebar/foo
         def actual = connection.getURL().toExternalForm()
-        def expected = new URL("file:realPath/somebar/foo").toExternalForm()
+        def expected = new URL("http:/somebar/foo").toExternalForm()
         assert actual == expected
     }
 
@@ -279,7 +279,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
         def connection = servlet.getResourceConnection(servlet.getScriptUri(request))
         //expecting http://somebar/foo
         def actual = connection.getURL().toExternalForm()
-        def expected = new URL("file:realPath/somebar/bar").toExternalForm()
+        def expected = new URL("http:/somebar/bar").toExternalForm()
         assert actual == expected
     }
 }
