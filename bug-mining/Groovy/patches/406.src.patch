diff --git a/src/main/org/codehaus/groovy/tools/shell/CommandSupport.groovy b/src/main/org/codehaus/groovy/tools/shell/CommandSupport.groovy
index efe2954506..9151dfc401 100644
--- a/src/main/org/codehaus/groovy/tools/shell/CommandSupport.groovy
+++ b/src/main/org/codehaus/groovy/tools/shell/CommandSupport.groovy
@@ -16,8 +16,6 @@
 
 package org.codehaus.groovy.tools.shell
 
-import java.util.prefs.Preferences
-
 import jline.Completor
 import jline.NullCompletor
 import jline.ArgumentCompletor
@@ -176,8 +174,4 @@ abstract class CommandSupport
     protected GroovyClassLoader getClassLoader() {
         return shell.interp.classLoader
     }
-    
-    protected Preferences getPreferences() {
-        return shell.prefs
-    }
 }
\ No newline at end of file
diff --git a/src/main/org/codehaus/groovy/tools/shell/Groovysh.groovy b/src/main/org/codehaus/groovy/tools/shell/Groovysh.groovy
index 101320d0d2..a6356f3c45 100644
--- a/src/main/org/codehaus/groovy/tools/shell/Groovysh.groovy
+++ b/src/main/org/codehaus/groovy/tools/shell/Groovysh.groovy
@@ -18,8 +18,6 @@ package org.codehaus.groovy.tools.shell
 
 import java.lang.reflect.Method
 
-import java.util.prefs.Preferences
-
 import jline.Terminal
 import jline.History
 
@@ -32,10 +30,12 @@ import org.codehaus.groovy.control.CompilationFailedException
 
 import org.codehaus.groovy.tools.shell.util.MessageSource
 import org.codehaus.groovy.tools.shell.util.ANSI
+import org.codehaus.groovy.tools.shell.util.ANSI.Renderer as AnsiRenderer
 import org.codehaus.groovy.tools.shell.util.HelpFormatter
 import org.codehaus.groovy.tools.shell.util.Logger
 import org.codehaus.groovy.tools.shell.util.XmlCommandRegistrar
 import org.codehaus.groovy.runtime.StackTraceUtils
+import org.codehaus.groovy.tools.shell.util.Preferences
 
 /**
  * An interactive shell for evaluating Groovy code from the command-line (aka. groovysh).
@@ -50,8 +50,6 @@ class Groovysh
     
     private static final MessageSource messages = new MessageSource(Groovysh.class)
     
-    private final Preferences prefs = Preferences.userNodeForPackage(Groovysh.class)
-
     private final BufferManager buffers = new BufferManager()
     
     private final GroovyShell interp
@@ -87,10 +85,11 @@ class Groovysh
     }
     
     private void setLastResult(final Object obj) {
-        boolean showLastResult = io.verbose || prefs.getBoolean('show-last-result', true)
+        boolean showLastResult = !io.quiet && (io.verbose || Preferences.showLastResult)
         
         if (showLastResult) {
-            io.out.println("@|bold ===>| $obj")
+            // Need to use String.valueOf() here to avoid icky exceptions causes by GString coercion
+            io.out.println("@|bold ===>| ${String.valueOf(obj)}")
         }
 
         interp.context['_'] = obj
@@ -106,7 +105,7 @@ class Groovysh
         return interp.context['_']
     }
     
-    private ANSI.Renderer prompt = new ANSI.Renderer()
+    private AnsiRenderer prompt = new AnsiRenderer()
     
     private String renderPrompt() {
         def lineNum = formatLineNumber(buffers.current().size())
@@ -156,7 +155,7 @@ class Groovysh
         switch (status.code) {
             case ParseCode.COMPLETE:
                 // Evaluate the current buffer
-                result = evaluate(current)
+                lastResult = result = evaluate(current)
                 buffers.clearSelected()
                 break
 
@@ -180,7 +179,7 @@ class Groovysh
                 throw new Error("Invalid parse status: $status.code")
         }
         
-        return (lastResult = result)
+        return result
     }
     
     /**
@@ -274,6 +273,7 @@ class Groovysh
                 result = script.run()
             }
 
+            // Need to use String.valueOf() here to avoid icky exceptions causes by GString coercion
             log.debug("Evaluation result: ${String.valueOf(result)} (${result?.class})")
 
             // Keep only the methods that have been defined in the script
@@ -359,7 +359,7 @@ class Groovysh
             log.debug(cause)
         }
         else {
-            boolean sanitize = prefs.getBoolean('sanitize-stack-trace', true)
+            boolean sanitize = Preferences.sanitizeStackTrace
 
             // Sanitize the stack trace unless we are inverbose mode, or the user has request otherwise
             if (!io.verbose && sanitize) {
diff --git a/src/main/org/codehaus/groovy/tools/shell/IO.java b/src/main/org/codehaus/groovy/tools/shell/IO.java
index 42352e7434..8f028cf219 100644
--- a/src/main/org/codehaus/groovy/tools/shell/IO.java
+++ b/src/main/org/codehaus/groovy/tools/shell/IO.java
@@ -25,9 +25,9 @@ import java.io.Reader;
 
 import java.util.prefs.PreferenceChangeEvent;
 import java.util.prefs.PreferenceChangeListener;
-import java.util.prefs.Preferences;
 
 import org.codehaus.groovy.tools.shell.util.ANSI.RenderWriter;
+import org.codehaus.groovy.tools.shell.util.Preferences;
 
 /**
  * Container for input/output handles.
@@ -72,27 +72,24 @@ public class IO
         this.inputStream = inputStream;
         this.outputStream = outputStream;
         this.errorStream = errorStream;
-        
+
         this.in = new InputStreamReader(inputStream);
 
         //
         // TODO: Once all user output is in i18n, then it would be more efficent to have the MessageSource
         //       be ANSI-aware instead of this...
         //
-        
+
         this.out = new RenderWriter(outputStream, true);
         this.err = new RenderWriter(errorStream, true);
 
-
         //
-        // HACK: Hack in some ugly-ass-preferences muck for now... until we can think of a better solution
+        // TODO: Change to verbosity as done in GShell's IO
         //
 
-        Preferences prefs = Preferences.userRoot().node("/org/codehaus/groovy/tools/shell");
-
-        verbose = prefs.getBoolean("verbose", false);
+        verbose = Preferences.verbose;
 
-        prefs.addPreferenceChangeListener(new PreferenceChangeListener() {
+        Preferences.addChangeListener(new PreferenceChangeListener() {
             public void preferenceChange(final PreferenceChangeEvent event) {
                 if (event.getKey().equals("verbose")) {
                     verbose = event.getNode().getBoolean("verbose", false);
@@ -100,9 +97,9 @@ public class IO
             }
         });
 
-        quiet = prefs.getBoolean("quiet", false);
+        quiet = Preferences.quiet;
 
-        prefs.addPreferenceChangeListener(new PreferenceChangeListener() {
+        Preferences.addChangeListener(new PreferenceChangeListener() {
             public void preferenceChange(final PreferenceChangeEvent event) {
                 if (event.getKey().equals("quiet")) {
                     verbose = event.getNode().getBoolean("quiet", false);
diff --git a/src/main/org/codehaus/groovy/tools/shell/commands/PurgeCommand.groovy b/src/main/org/codehaus/groovy/tools/shell/commands/PurgeCommand.groovy
index f191ba0196..78a6fa5903 100644
--- a/src/main/org/codehaus/groovy/tools/shell/commands/PurgeCommand.groovy
+++ b/src/main/org/codehaus/groovy/tools/shell/commands/PurgeCommand.groovy
@@ -18,6 +18,7 @@ package org.codehaus.groovy.tools.shell.commands
 
 import org.codehaus.groovy.tools.shell.ComplexCommandSupport
 import org.codehaus.groovy.tools.shell.Shell
+import org.codehaus.groovy.tools.shell.util.Preferences
 
 /**
  * The 'purge' command.
@@ -31,7 +32,7 @@ class PurgeCommand
     PurgeCommand(final Shell shell) {
         super(shell, 'purge', '\\p')
         
-        this.functions = [ 'variables', 'classes', 'imports', 'buffers', 'all' ]
+        this.functions = [ 'variables', 'classes', 'imports', 'preferences', /*'buffers',*/ 'all' ]
     }
     
     def do_variables = {
@@ -72,7 +73,16 @@ class PurgeCommand
             }
         }
     }
-    
+
+    def do_preferences = {
+        Preferences.clear()
+        
+        if (io.verbose) {
+            io.out.println("Preferences purged") // TODO: i18n
+        }
+    }
+
+    /*
     def do_buffers = {
         buffers.reset()
         
@@ -80,5 +90,6 @@ class PurgeCommand
             io.out.println('All buffers purged') // TODO: i18n
         }
     }
+    */
 }
 
diff --git a/src/main/org/codehaus/groovy/tools/shell/commands/SetCommand.groovy b/src/main/org/codehaus/groovy/tools/shell/commands/SetCommand.groovy
index cb59137892..c15902a1c7 100644
--- a/src/main/org/codehaus/groovy/tools/shell/commands/SetCommand.groovy
+++ b/src/main/org/codehaus/groovy/tools/shell/commands/SetCommand.groovy
@@ -20,9 +20,10 @@ import org.codehaus.groovy.tools.shell.CommandSupport
 import org.codehaus.groovy.tools.shell.Shell
 
 import org.codehaus.groovy.tools.shell.util.SimpleCompletor
+import org.codehaus.groovy.tools.shell.util.Preferences
 
 /**
- * The 'set' command.
+ * The 'set' command, used to set preferences.
  *
  * @version $Id$
  * @author <a href="mailto:jason@planet57.com">Jason Dillon</a>
@@ -38,7 +39,7 @@ class SetCommand
         def loader = {
             def list = []
 
-            def keys = preferences.keys()
+            def keys = Preferences.keys()
 
             keys.each { list << it }
 
@@ -55,16 +56,16 @@ class SetCommand
         assert args != null
         
         if (args.size() == 0) {
-            def keys = preferences.keys()
+            def keys = Preferences.keys()
             
             if (keys.size() == 0) {
-                io.out.println('No preferences are currently set')
+                io.out.println('No preferences are set')
                 return
             }
             else {
                 io.out.println('Preferences:')
                 keys.each {
-                    def value = preferences.get(it, null)
+                    def value = Preferences.get(it, null)
                     println("    $it=$value")
                 }
             }
@@ -87,6 +88,6 @@ class SetCommand
         
         log.debug("Setting preference: $name=$value")
         
-        preferences.put(name, String.valueOf(value))
+        Preferences.put(name, String.valueOf(value))
     }
 }
diff --git a/src/main/org/codehaus/groovy/tools/shell/commands/ShowCommand.groovy b/src/main/org/codehaus/groovy/tools/shell/commands/ShowCommand.groovy
index 69bda1a2ed..f28feb6605 100644
--- a/src/main/org/codehaus/groovy/tools/shell/commands/ShowCommand.groovy
+++ b/src/main/org/codehaus/groovy/tools/shell/commands/ShowCommand.groovy
@@ -20,6 +20,7 @@ import org.codehaus.groovy.runtime.MethodClosure
 
 import org.codehaus.groovy.tools.shell.ComplexCommandSupport
 import org.codehaus.groovy.tools.shell.Shell
+import org.codehaus.groovy.tools.shell.util.Preferences
 
 /**
  * The 'show' command.
@@ -33,7 +34,7 @@ class ShowCommand
     ShowCommand(final Shell shell) {
         super(shell, 'show', '\\S')
         
-        this.functions = [ 'variables', 'classes', 'imports', 'all' ]
+        this.functions = [ 'variables', 'classes', 'imports', 'preferences', 'all' ]
     }
     
     def do_variables = {
@@ -51,8 +52,9 @@ class ShowCommand
                     //
                     value = "method ${value.method}()"
                 }
-                
-                io.out.println("  $key = $value")
+
+                // Need to use String.valueOf() here to avoid icky exceptions causes by GString coercion
+                io.out.println("  $key = ${String.valueOf(value)}")
             }
         }
     }
@@ -84,5 +86,22 @@ class ShowCommand
             }
         }
     }
+
+    def do_preferences = {
+        def keys = Preferences.keys()
+
+        if (keys.size() == 0) {
+            io.out.println('No preferences are set')
+            return
+        }
+        else {
+            io.out.println('Preferences:')
+            keys.each {
+                def value = Preferences.get(it, null)
+                println("    $it=$value")
+            }
+        }
+        return
+    }
 }
 
diff --git a/src/main/org/codehaus/groovy/tools/shell/util/Logger.java b/src/main/org/codehaus/groovy/tools/shell/util/Logger.java
index a970064229..7ef1d033af 100644
--- a/src/main/org/codehaus/groovy/tools/shell/util/Logger.java
+++ b/src/main/org/codehaus/groovy/tools/shell/util/Logger.java
@@ -19,7 +19,6 @@ package org.codehaus.groovy.tools.shell.util;
 import org.codehaus.groovy.tools.shell.IO;
 
 import java.util.prefs.PreferenceChangeListener;
-import java.util.prefs.Preferences;
 import java.util.prefs.PreferenceChangeEvent;
 
 /**
@@ -85,15 +84,9 @@ public final class Logger {
     public static boolean debug;
 
     static {
-        //
-        // HACK: For now put in some ugly preferences API muck until we can find a more elegant solution
-        //
-        
-        Preferences prefs = Preferences.userRoot().node("/org/codehaus/groovy/tools/shell");
-
-        debug = prefs.getBoolean("debug", false);
+        debug = Preferences.debug;
 
-        prefs.addPreferenceChangeListener(new PreferenceChangeListener() {
+        Preferences.addChangeListener(new PreferenceChangeListener() {
             public void preferenceChange(final PreferenceChangeEvent event) {
                 if (event.getKey().equals("debug")) {
                     debug = event.getNode().getBoolean("debug", false);
diff --git a/src/main/org/codehaus/groovy/tools/shell/util/Preferences.java b/src/main/org/codehaus/groovy/tools/shell/util/Preferences.java
new file mode 100644
index 0000000000..af37264d26
--- /dev/null
+++ b/src/main/org/codehaus/groovy/tools/shell/util/Preferences.java
@@ -0,0 +1,65 @@
+/*
+ * Copyright 2003-2007 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.codehaus.groovy.tools.shell.util;
+
+import java.util.prefs.PreferenceChangeListener;
+import java.util.prefs.BackingStoreException;
+
+/**
+ * Container for shell preferences.
+ *
+ * @version $Id$
+ * @author <a href="mailto:jason@planet57.com">Jason Dillon</a>
+ */
+public class Preferences
+{
+    private static final java.util.prefs.Preferences STORE = java.util.prefs.Preferences.userRoot().node("/org/codehaus/groovy/tools/shell");
+
+    public static boolean debug = STORE.getBoolean("debug", false);
+
+    public static boolean verbose = STORE.getBoolean("verbose", false);
+
+    public static boolean quiet = STORE.getBoolean("quiet", false);
+
+    public static boolean showLastResult = STORE.getBoolean("show-last-result", true);
+
+    public static boolean sanitizeStackTrace = STORE.getBoolean("sanitize-stack-trace", true);
+
+    public static String[] keys() throws BackingStoreException {
+        return STORE.keys();
+    }
+
+    public static String get(final String name, final String defaultValue) {
+        return STORE.get(name, defaultValue);
+    }
+
+    public static String get(final String name) {
+        return get(name, null);
+    }
+
+    public static void put(final String name, final String value) {
+        STORE.put(name, value);
+    }
+
+    public static void clear() throws BackingStoreException {
+        STORE.clear();
+    }
+
+    public static void addChangeListener(final PreferenceChangeListener listener) {
+        STORE.addPreferenceChangeListener(listener);
+    }
+}
