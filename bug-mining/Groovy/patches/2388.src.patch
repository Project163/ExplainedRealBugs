diff --git a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
index b47b9af9a4..2a3a4aac97 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
@@ -269,7 +269,14 @@ public class BinaryExpressionHelper {
         // return value of assignment
         rhsValueLoader.visit(controller.getAcg());
     }
-    
+
+    private static boolean isNull(Expression exp) {
+        if (exp instanceof ConstantExpression){
+            return ((ConstantExpression) exp).getValue()==null;
+        } else {
+            return false;
+        }
+    }
 
     public void evaluateEqual(BinaryExpression expression, boolean defineVariable) {
         AsmClassGenerator acg = controller.getAcg();
@@ -277,7 +284,7 @@ public class BinaryExpressionHelper {
         OperandStack operandStack = controller.getOperandStack();
         Expression rightExpression = expression.getRightExpression();
         Expression leftExpression = expression.getLeftExpression();
-        
+
         if (    defineVariable && 
                 rightExpression instanceof EmptyExpression && 
                 !(leftExpression instanceof TupleExpression) )
@@ -287,7 +294,7 @@ public class BinaryExpressionHelper {
             operandStack.loadOrStoreVariable(var, false);
             return;
         }
-        
+
         // let's evaluate the RHS and store the result
         ClassNode rhsType;
         if (rightExpression instanceof EmptyExpression) {
@@ -295,24 +302,26 @@ public class BinaryExpressionHelper {
             loadInitValue(rhsType);
         } else {
             rightExpression.visit(acg);
-            //rhsType = getCastType(rightExpression);
-            rhsType = controller.getOperandStack().getTopOperand();
         }
+        rhsType = operandStack.getTopOperand();
+
         boolean directAssignment = defineVariable && !(leftExpression instanceof TupleExpression);
         int rhsValueId;
         if (directAssignment) {
             VariableExpression var = (VariableExpression) leftExpression;
-            rhsType = controller.getTypeChooser().resolveType(var, controller.getClassNode());
             if (var.isClosureSharedVariable() && ClassHelper.isPrimitiveType(rhsType)) {
                 // GROOVY-5570: if a closure shared variable is a primitive type, it must be boxed
                 rhsType = ClassHelper.getWrapper(rhsType);
+                operandStack.box();
             }
-            if (!(rightExpression instanceof ConstantExpression) || (((ConstantExpression) rightExpression).getValue()!=null)) {
-                operandStack.doGroovyCast(rhsType);
+            ClassNode lhsType = controller.getTypeChooser().resolveType(var, controller.getClassNode());
+            if (!ClassHelper.isPrimitiveType(lhsType) && isNull(rightExpression)) {
+                operandStack.replace(lhsType);
             } else {
-                operandStack.replace(rhsType);
+                operandStack.doGroovyCast(lhsType);
             }
-            rhsValueId = compileStack.defineVariable(var, rhsType, true).getIndex();
+            rhsType = lhsType;
+            rhsValueId = compileStack.defineVariable(var, lhsType, true).getIndex();
         } else {
             rhsValueId = compileStack.defineTemporaryVariable("$rhs", rhsType, true);
         }
diff --git a/src/test/gls/statements/DeclarationTest.groovy b/src/test/gls/statements/DeclarationTest.groovy
index 0fed98e83e..33d6dcb6ce 100644
--- a/src/test/gls/statements/DeclarationTest.groovy
+++ b/src/test/gls/statements/DeclarationTest.groovy
@@ -14,4 +14,12 @@ public class DeclarationTest extends CompilableTestSupport {
       """
   }
   
+  public void testNullAssignmentToPrimitive() {
+      shouldFail (org.codehaus.groovy.runtime.typehandling.GroovyCastException, """
+          int x = null
+      """)
+      assertScript """
+          Integer x = null
+      """
+  }
 }
\ No newline at end of file
