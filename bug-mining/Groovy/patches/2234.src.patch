diff --git a/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java b/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
index f88c4ba7cb..7ad20e6e9b 100644
--- a/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
+++ b/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
@@ -941,7 +941,14 @@ public class SecureASTCustomizer extends CompilationCustomizer {
 
         public void visitPropertyExpression(final PropertyExpression expression) {
             assertExpressionAuthorized(expression);
-            expression.getObjectExpression().visit(this);
+            Expression receiver = expression.getObjectExpression();
+            final String typeName = receiver.getType().getName();
+            if (receiversWhiteList != null && !receiversWhiteList.contains(typeName)) {
+                throw new SecurityException("Property access not allowed on [" + typeName + "]");
+            } else if (receiversBlackList != null && receiversBlackList.contains(typeName)) {
+                throw new SecurityException("Property access not allowed on [" + typeName + "]");
+            }
+            receiver.visit(this);
             final Expression property = expression.getProperty();
             checkConstantTypeIfNotMethodNameOrProperty(property);
         }
@@ -958,7 +965,14 @@ public class SecureASTCustomizer extends CompilationCustomizer {
 
         public void visitAttributeExpression(final AttributeExpression expression) {
             assertExpressionAuthorized(expression);
-            expression.getObjectExpression().visit(this);
+            Expression receiver = expression.getObjectExpression();
+            final String typeName = receiver.getType().getName();
+            if (receiversWhiteList != null && !receiversWhiteList.contains(typeName)) {
+                throw new SecurityException("Attribute access not allowed on [" + typeName + "]");
+            } else if (receiversBlackList != null && receiversBlackList.contains(typeName)) {
+                throw new SecurityException("Attribute access not allowed on [" + typeName + "]");
+            }
+            receiver.visit(this);
             final Expression property = expression.getProperty();
             checkConstantTypeIfNotMethodNameOrProperty(property);
         }
@@ -990,6 +1004,13 @@ public class SecureASTCustomizer extends CompilationCustomizer {
 
         public void visitVariableExpression(final VariableExpression expression) {
             assertExpressionAuthorized(expression);
+            final String type = expression.getType().getName();
+            if (constantTypesWhiteList != null && !constantTypesWhiteList.contains(type)) {
+                throw new SecurityException("Usage of variables of type [" + type + "] is not allowed");
+            }
+            if (constantTypesBlackList != null && constantTypesBlackList.contains(type)) {
+                throw new SecurityException("Usage of variables of type [" + type + "] is not allowed");
+            }
         }
 
         public void visitDeclarationExpression(final DeclarationExpression expression) {
diff --git a/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy b/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
index 25c36314ef..57fccab941 100644
--- a/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
+++ b/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
@@ -407,4 +407,44 @@ class SecureASTCustomizerTest extends GroovyTestCase {
         assert hasSecurityException {shell.evaluate('System.println(1)')}
         assert hasSecurityException {shell.evaluate('def x() { System.println(1) }')}
     }
+
+    // GROOVY-6153
+    void testDeterministicWhitelistBehaviour() {
+        def shell = new GroovyShell(configuration)
+        def classWhiteList = ["java.lang.Object", "test"]
+        customizer.with {
+            setIndirectImportCheckEnabled(true);
+            setImportsWhitelist(classWhiteList);
+            setReceiversWhiteList(classWhiteList);
+            setPackageAllowed(true);
+            setClosuresAllowed(true);
+            setMethodDefinitionAllowed(true);
+        }
+
+        assert hasSecurityException {
+            shell.evaluate '''
+                java.lang.System.out.println("run ")
+            '''
+        }
+    }
+
+    // GROOVY-6153
+    void testDeterministicWhitelistBehaviour2() {
+        def shell = new GroovyShell(configuration)
+        def classWhiteList = ["java.lang.Object", "test"]
+        customizer.with {
+            setIndirectImportCheckEnabled(true);
+            setConstantTypesWhiteList(classWhiteList);
+            setReceiversWhiteList(classWhiteList);
+            setPackageAllowed(true);
+            setClosuresAllowed(true);
+            setMethodDefinitionAllowed(true);
+        }
+
+        assert hasSecurityException {
+            shell.evaluate '''
+                java.lang.Long x = 666L
+            '''
+        }
+    }
 }
