diff --git a/src/main/groovy/servlet/AbstractHttpServlet.java b/src/main/groovy/servlet/AbstractHttpServlet.java
index 135b8bea4c..25e0a85b19 100644
--- a/src/main/groovy/servlet/AbstractHttpServlet.java
+++ b/src/main/groovy/servlet/AbstractHttpServlet.java
@@ -20,7 +20,6 @@ import groovy.util.ResourceException;
 
 import java.io.File;
 import java.io.IOException;
-import java.net.MalformedURLException;
 import java.net.URL;
 import java.net.URLConnection;
 import java.util.regex.Matcher;
@@ -167,18 +166,8 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
      * Interface method for ResourceContainer. This is used by the GroovyScriptEngine.
      */
     public URLConnection getResourceConnection(String name) throws ResourceException {
-        String basePath = servletContext.getRealPath(".");
+        String basePath = servletContext.getRealPath("/");
         if (name.startsWith(basePath)) name = name.substring(basePath.length());
-        String baseVirtualPath = null;
-        try {
-            URL baseVirtualURL = servletContext.getResource("/");
-            if(baseVirtualURL != null) {
-                baseVirtualPath = baseVirtualURL.getPath();
-                if (name.startsWith(baseVirtualPath)) name = name.substring(baseVirtualPath.length());
-            }
-        } catch (MalformedURLException e1) {
-            // ignore and proceed
-        }
         
         /*
          * First, mangle resource name with the compiled pattern.
@@ -196,7 +185,7 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
                 if (verbose) {
                     log("Replaced resource name \"" + name + "\" with \"" + replaced + "\".");
                 }
-                name = replaced;
+                name = replaced; 
             }
         }
 
@@ -204,12 +193,16 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
          * Try to locate the resource and return an opened connection to it.
          */
         try {
-            URL url = servletContext.getResource("/" + name);
+            String tryScriptName = "/" + name;
+            URL url = servletContext.getResource(tryScriptName);
             if (url == null) {
+                tryScriptName = "/WEB-INF/groovy/" + name;
                 url = servletContext.getResource("/WEB-INF/groovy/" + name);
             }
             if (url == null) {
                 throw new ResourceException("Resource \"" + name + "\" not found!");
+            } else {
+                url = new URL("file", "", servletContext.getRealPath(tryScriptName));
             }
             return url.openConnection();
         } catch (IOException e) {
@@ -217,6 +210,10 @@ public abstract class AbstractHttpServlet extends HttpServlet implements Resourc
         }
     }
 
+    private boolean isFile(URL ret) {
+        return ret != null && ret.getProtocol().equals("file");
+    }
+
     /**
      * Returns the include-aware uri of the script or template file.
      * 
diff --git a/src/test/groovy/servlet/AbstractHttpServletTest.groovy b/src/test/groovy/servlet/AbstractHttpServletTest.groovy
index 2564860d2f..b24f66429e 100644
--- a/src/test/groovy/servlet/AbstractHttpServletTest.groovy
+++ b/src/test/groovy/servlet/AbstractHttpServletTest.groovy
@@ -129,7 +129,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
 	* Tests finding resource. 
 	*/ 
 	public void testGetResourceConnection_FoundInCurrentDir() {
-		def urlStub = new java.net.URL("http://foo")
+		def urlStub = new java.net.URL("file:realPath/someresource")
 		def servletContext = [
 		    getRealPath: { arg-> "realPath" + arg}, 
 		    getResource: {arg -> 
@@ -153,7 +153,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
 	* Tests finding resource in web-inf directory. 
 	*/ 
 	public void testGetResourceConnection_FoundInWebInf() {
-		def urlStub = new java.net.URL("http://foo")
+		def urlStub = new java.net.URL("file:realPath/WEB-INF/groovy/someresource")
 		def servletContext = [
 		    getRealPath: { arg-> "realPath" + arg}, 
 		    getResource: {arg -> 
@@ -201,7 +201,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
 		def connection = servlet.getResourceConnection("/somefoo/foo")
 		//expecting http://somebar/foo
 		def actual = connection.getURL().toExternalForm() 
-		def expected = new URL("http://somebar/foo").toExternalForm()
+		def expected = new URL("file:realPath//somebar/foo").toExternalForm()
 		assert actual == expected		
 	}
 
@@ -233,7 +233,7 @@ class AbstractHttpServletTest extends GroovyTestCase {
 		def connection = servlet.getResourceConnection("/somefoo/foo")
 		//expecting http://somebar/foo
 		def actual = connection.getURL().toExternalForm() 
-		def expected = new URL("http://somebar/bar").toExternalForm()
+		def expected = new URL("file:realPath//somebar/bar").toExternalForm()
 		assert actual == expected		
 	}
 }
