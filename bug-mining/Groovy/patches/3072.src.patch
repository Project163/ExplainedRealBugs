diff --git a/src/main/org/codehaus/groovy/runtime/typehandling/NumberMath.java b/src/main/org/codehaus/groovy/runtime/typehandling/NumberMath.java
index c953ffdb18..37fa65f4b1 100644
--- a/src/main/org/codehaus/groovy/runtime/typehandling/NumberMath.java
+++ b/src/main/org/codehaus/groovy/runtime/typehandling/NumberMath.java
@@ -147,6 +147,14 @@ public abstract class NumberMath {
         return number instanceof Integer;
     }
 
+    public static boolean isShort(Number number) {
+        return number instanceof Short;
+    }
+
+    public static boolean isByte(Number number) {
+        return number instanceof Byte;
+    }
+
     public static boolean isLong(Number number) {
         return number instanceof Long;
     }
@@ -179,27 +187,35 @@ public abstract class NumberMath {
      *  F  D  D  D  D  D  D
      *  L bD bI  D  D  L  L
      *  I bD bI  D  D  L  I
-     * 
+     *
      * Note that for division, if either operand isFloatingPoint, the result will be floating.  Otherwise,
      * the result is BigDecimal
      */
     public static NumberMath getMath(Number left, Number right) {
+        // FloatingPointMath wins according to promotion Matrix
         if (isFloatingPoint(left) || isFloatingPoint(right)) {
             return FloatingPointMath.INSTANCE;
         }
-        if (isBigDecimal(left) || isBigDecimal(right)) {
+        NumberMath leftMath = getMath(left);
+        NumberMath rightMath = getMath(right);
+
+        if (leftMath == BigDecimalMath.INSTANCE || rightMath == BigDecimalMath.INSTANCE) {
             return BigDecimalMath.INSTANCE;
         }
-        if (isBigInteger(left) || isBigInteger(right)) {
+        if (leftMath == BigIntegerMath.INSTANCE || rightMath == BigIntegerMath.INSTANCE) {
             return BigIntegerMath.INSTANCE;
         }
-        if (isLong(left) || isLong(right)) {
+        if (leftMath == LongMath.INSTANCE || rightMath == LongMath.INSTANCE) {
             return LongMath.INSTANCE;
         }
-        return IntegerMath.INSTANCE;
+        if (leftMath == IntegerMath.INSTANCE || rightMath == IntegerMath.INSTANCE) {
+            return IntegerMath.INSTANCE;
+        }
+        // also for custom Number implementations
+        return BigDecimalMath.INSTANCE;
     }
 
-    private static NumberMath getMath(Number number) {
+    /* package private */ static NumberMath getMath(Number number) {
         if (isLong(number)) {
             return LongMath.INSTANCE;
         }
@@ -212,7 +228,11 @@ public abstract class NumberMath {
         if (isBigInteger(number)) {
             return BigIntegerMath.INSTANCE;
         }
-        return IntegerMath.INSTANCE;
+        if (isInteger(number) || isShort(number) || isByte(number)) {
+            return IntegerMath.INSTANCE;
+        }
+        // also for custom Number implementations
+        return BigDecimalMath.INSTANCE;
     }
 
     //Subclasses implement according to the type promotion hierarchy rules
diff --git a/src/test/groovy/NumberMathTest.groovy b/src/test/org/codehaus/groovy/runtime/typehandling/NumberMathTest.groovy
similarity index 65%
rename from src/test/groovy/NumberMathTest.groovy
rename to src/test/org/codehaus/groovy/runtime/typehandling/NumberMathTest.groovy
index 686a5eed45..eff11ce36c 100644
--- a/src/test/groovy/NumberMathTest.groovy
+++ b/src/test/org/codehaus/groovy/runtime/typehandling/NumberMathTest.groovy
@@ -1,22 +1,25 @@
 /*
- *  Licensed to the Apache Software Foundation (ASF) under one
- *  or more contributor license agreements.  See the NOTICE file
- *  distributed with this work for additional information
- *  regarding copyright ownership.  The ASF licenses this file
- *  to you under the Apache License, Version 2.0 (the
- *  "License"); you may not use this file except in compliance
- *  with the License.  You may obtain a copy of the License at
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
  *
- *    http://www.apache.org/licenses/LICENSE-2.0
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
  *
- *  Unless required by applicable law or agreed to in writing,
- *  software distributed under the License is distributed on an
- *  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- *  KIND, either express or implied.  See the License for the
- *  specific language governing permissions and limitations
- *  under the License.
  */
-package groovy
+package org.codehaus.groovy.runtime.typehandling
+
+import static org.codehaus.groovy.runtime.typehandling.NumberMath.getMath
 
 /**
  * Basic NumberMath test.
@@ -160,6 +163,55 @@ class NumberMathTest extends GroovyTestCase {
         fail("Should catch an UnsupportedOperationException")
     }
 
+
+    private static class MyNumber extends Number {
+        def n
+
+        MyNumber(n) {
+            this.n = n
+        }
+
+        int intValue() { n }
+
+        long longValue() { n }
+
+        float floatValue() { n }
+
+        double doubleValue() { n }
+
+        int hashCode() { -n }
+
+        boolean equals(other) {
+            if (other instanceof MyNumber) {
+                return n == other.n
+            }
+            return false
+        }
+
+        String toString() { return Double.toString(floatValue()) }
+    }
+
+    void testGetMathCustom() {
+        assert getMath(1G) == BigIntegerMath.INSTANCE;
+        assert getMath(1.0G) == BigDecimalMath.INSTANCE;
+        assert getMath(Long.valueOf(1)) == LongMath.INSTANCE;
+        assert getMath(Integer.valueOf(1)) == IntegerMath.INSTANCE;
+        assert getMath(Short.valueOf("1")) == IntegerMath.INSTANCE;
+        assert getMath(Byte.valueOf("1")) == IntegerMath.INSTANCE;
+        assert getMath(Double.valueOf(1.0)) == FloatingPointMath.INSTANCE;
+        assert getMath(Float.valueOf(1.0f)) == FloatingPointMath.INSTANCE;
+
+        MyNumber num = new MyNumber(42);
+        assert getMath(num) == BigDecimalMath.INSTANCE;
+
+        assert getMath(num, Integer.valueOf(25)) == BigDecimalMath.INSTANCE;
+        assert getMath(num, Double.valueOf(25.0)) == FloatingPointMath.INSTANCE;
+        assert getMath(Integer.valueOf(25), num) == BigDecimalMath.INSTANCE;
+        assert getMath(Double.valueOf(25.0), num) == FloatingPointMath.INSTANCE;
+        assert getMath(num, 25) == BigDecimalMath.INSTANCE;
+        assert getMath(25, num) == BigDecimalMath.INSTANCE;
+    }
+
     void testGetMath() {
         assert 20 == new Short("10") << 1
         assert 2 == new Byte("1") << 1
