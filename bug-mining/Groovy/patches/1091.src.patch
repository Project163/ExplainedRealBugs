diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethodsSupport.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethodsSupport.java
index 52e6f11291..d928b08155 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethodsSupport.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethodsSupport.java
@@ -21,7 +21,6 @@ import org.codehaus.groovy.runtime.typehandling.DefaultTypeTransformation;
 
 import java.io.Closeable;
 import java.io.IOException;
-import java.lang.reflect.Constructor;
 import java.util.*;
 import java.util.logging.Logger;
 
@@ -172,7 +171,7 @@ public class DefaultGroovyMethodsSupport {
 
     protected static <T> Set<T> createSimilarSet(Set<T> orig) {
         if (orig instanceof SortedSet) {
-            return new TreeSet<T>();
+            return new TreeSet<T>(((SortedSet)orig).comparator());
         }
         if (orig instanceof LinkedHashSet) {
             return new LinkedHashSet<T>();
@@ -182,7 +181,7 @@ public class DefaultGroovyMethodsSupport {
 
     protected static <K, V> Map<K, V> createSimilarMap(Map<K, V> orig) {
         if (orig instanceof SortedMap) {
-            return new TreeMap<K, V>();
+            return new TreeMap<K, V>(((SortedMap)orig).comparator());
         }
         if (orig instanceof Properties) {
             return (Map<K, V>) new Properties();
diff --git a/src/test/groovy/bugs/Groovy3818Bug.groovy b/src/test/groovy/bugs/Groovy3818Bug.groovy
new file mode 100644
index 0000000000..27a329154b
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy3818Bug.groovy
@@ -0,0 +1,30 @@
+package groovy.bugs
+
+class Groovy3818Bug extends GroovyTestCase {
+    void testCreatingSimilarSetandMapWithComparator() {
+        def scompare = { a, b -> a.id <=> b.id } as Comparator
+
+        def set = new TreeSet( scompare )
+
+        set << [name: "Han Solo",       id: 1]
+        set << [name: "Luke Skywalker", id: 2]
+        set << [name: "L. Skywalker",   id: 3]
+
+        def result = set.findAll { elt -> elt.name =~ /Sky/ }
+        assert result.size() == 2
+
+        result = set.grep { elt -> elt.name =~ /Sky/ }
+        assert result.size() == 2
+
+        def mcompare = { a, b -> a.id <=> b.id } as Comparator
+
+        def map = new TreeMap( mcompare )
+
+        map[[name: "Han Solo", id: 1]] = "Dummy"
+        map[[name: "Luke Skywalker", id: 2]] = "Dummy"
+        map[[name: "L. Skywalker",   id: 3]] = "Dummy"
+
+        result = map.findAll { elt ->elt.key.name =~ /Sky/ }
+        assert result.size() == 2
+    }
+}
