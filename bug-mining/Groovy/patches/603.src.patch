diff --git a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
index 3048adc7f0..11e4f25934 100644
--- a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
+++ b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
@@ -1669,7 +1669,10 @@ public class AsmClassGenerator extends ClassGenerator {
     public void visitCastExpression(CastExpression expression) {
         ClassNode type = expression.getType();
         visitAndAutoboxBoolean(expression.getExpression());
+        final ClassNode rht = rightHandType;
+        rightHandType = expression.getExpression().getType();
         doConvertAndCast(type, expression.getExpression(), expression.isIgnoringAutoboxing(), false, expression.isCoerce());
+        rightHandType = rht;
     }
 
     public void visitNotExpression(NotExpression expression) {
diff --git a/src/test/groovy/bugs/Groovy2558Bug.groovy b/src/test/groovy/bugs/Groovy2558Bug.groovy
new file mode 100644
index 0000000000..99319c39ae
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy2558Bug.groovy
@@ -0,0 +1,10 @@
+package groovy.bugs
+
+class Groovy2558Bug extends GroovyTestCase {
+    void testMe () {
+        Person person = new Person()
+        String propertyName = 'name'
+        person."$propertyName" = 'peter'
+        assertEquals "peter", person.name
+    }
+}
