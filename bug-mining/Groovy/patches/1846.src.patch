diff --git a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
index eebb32f7e2..8a5ef01bff 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionHelper.java
@@ -301,6 +301,10 @@ public class BinaryExpressionHelper {
         if (directAssignment) {
             VariableExpression var = (VariableExpression) leftExpression;
             rhsType = controller.getTypeChooser().resolveType(var, controller.getClassNode());
+            if (var.isClosureSharedVariable() && ClassHelper.isPrimitiveType(rhsType)) {
+                // GROOVY-5570: if a closure shared variable is a primitive type, it must be boxed
+                rhsType = ClassHelper.getWrapper(rhsType);
+            }
             if (!(rightExpression instanceof ConstantExpression) || (((ConstantExpression) rightExpression).getValue()!=null)) {
                 operandStack.doGroovyCast(rhsType);
             } else {
diff --git a/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy b/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
index e3331ca648..0987c41460 100644
--- a/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
+++ b/src/test/org/codehaus/groovy/classgen/asm/sc/BugsStaticCompileTest.groovy
@@ -131,5 +131,21 @@ class BugsStaticCompileTest extends BugsSTCTest {
             assert squarePlusOne(2) == 5
         '''
     }
+
+    // GROOVY-5570
+    void testShouldNotThrowVerifyErrorRegisterContainsWrongType() {
+        assertScript '''
+                void foo() {
+                boolean idx = false
+                def cl = { idx }
+                }
+            '''
+        assertScript '''
+                void foo() {
+                int idx = 0
+                def cl = { idx }
+                }
+            '''
+    }
 }
 
