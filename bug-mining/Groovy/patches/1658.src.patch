diff --git a/src/main/org/codehaus/groovy/ast/tools/GenericsUtils.java b/src/main/org/codehaus/groovy/ast/tools/GenericsUtils.java
index 2f79c799bc..1793e1827c 100644
--- a/src/main/org/codehaus/groovy/ast/tools/GenericsUtils.java
+++ b/src/main/org/codehaus/groovy/ast/tools/GenericsUtils.java
@@ -20,7 +20,9 @@ import org.codehaus.groovy.ast.ClassNode;
 import org.codehaus.groovy.ast.GenericsType;
 
 import java.util.HashMap;
+import java.util.LinkedHashSet;
 import java.util.Map;
+import java.util.Set;
 
 /**
  * Utility methods to deal with generic types.
@@ -129,10 +131,27 @@ public class GenericsUtils {
      * @return a parameterized interface class node
      */
     public static ClassNode parameterizeInterfaceGenerics(final ClassNode classNode, final ClassNode anInterface) {
+        ClassNode interfaceFromClassNode = null;
+        ClassNode[] interfaces = classNode.getInterfaces();
+        for (ClassNode node : interfaces) {
+            if (node.equals(anInterface)) {
+                interfaceFromClassNode = node;
+                break;
+            } else if (node.implementsInterface(anInterface)) {
+                // ex: classNode = LinkedList<A> , node=List<E> , anInterface = Iterable<T>
+                return parameterizeInterfaceGenerics(parameterizeInterfaceGenerics(classNode, node), anInterface);
+            }
+        }
+        if (interfaceFromClassNode==null && classNode.getUnresolvedSuperClass()!=null) {
+            return parameterizeInterfaceGenerics(classNode.getUnresolvedSuperClass(), anInterface);
+        }
+        if (interfaceFromClassNode==null) {
+            return anInterface;
+        }
         Map<String,GenericsType> parameters = new HashMap<String, GenericsType>();
         extractPlaceholders(classNode, parameters);
-        ClassNode node = anInterface.getPlainNodeReference();
-        GenericsType[] interfaceGTs = anInterface.getGenericsTypes();
+        ClassNode node = interfaceFromClassNode.getPlainNodeReference();
+        GenericsType[] interfaceGTs = interfaceFromClassNode.getGenericsTypes();
         GenericsType[] types = new GenericsType[interfaceGTs.length];
         for (int i = 0; i < interfaceGTs.length; i++) {
             GenericsType interfaceGT = interfaceGTs[i];
diff --git a/src/main/org/codehaus/groovy/ast/tools/WideningCategories.java b/src/main/org/codehaus/groovy/ast/tools/WideningCategories.java
index d5f45332a4..bf21b463d5 100644
--- a/src/main/org/codehaus/groovy/ast/tools/WideningCategories.java
+++ b/src/main/org/codehaus/groovy/ast/tools/WideningCategories.java
@@ -104,7 +104,16 @@ public class WideningCategories {
                 type==double_TYPE   ||  type==Double_TYPE   ||
                 isBigDecCategory(type);
     }
-    
+
+    /**
+     * It is of a floating category, if the provided type is a
+     * a float, double or a wrapper of those. C(type)=double
+     */
+    public static boolean isFloatingCategory(ClassNode type) {
+        return  type==float_TYPE    ||  type==Float_TYPE    ||
+                type==double_TYPE   ||  type==Double_TYPE;
+    }
+
     public static boolean isNumberCategory(ClassNode type) {
         return isBigDecCategory(type) || type.isDerivedFrom(Number_TYPE);
     }
diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
index 1b4ec4ef82..cc1c714bcc 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
@@ -131,7 +131,10 @@ abstract class StaticTypeCheckingSupport {
      */
     private static Map<String, List<MethodNode>> getDGMMethods() {
         Map<String, List<MethodNode>> methods = new HashMap<String, List<MethodNode>>();
-		for (Class dgmLikeClass : DefaultGroovyMethods.DGM_LIKE_CLASSES) {
+        List<Class> classes = new LinkedList<Class>();
+        Collections.addAll(classes, DefaultGroovyMethods.DGM_LIKE_CLASSES);
+        Collections.addAll(classes, DefaultGroovyMethods.additionals);
+		for (Class dgmLikeClass : classes) {
 			ClassNode cn = ClassHelper.makeWithoutCaching(dgmLikeClass, true);
 			for (MethodNode metaMethod : cn.getMethods()) {
 				Parameter[] types = metaMethod.getParameters();
diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index a2c67eff05..3717139964 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -23,6 +23,7 @@ import org.codehaus.groovy.classgen.ReturnAdder;
 import org.codehaus.groovy.classgen.asm.InvocationWriter;
 import org.codehaus.groovy.control.SourceUnit;
 import org.codehaus.groovy.runtime.MetaClassHelper;
+import org.codehaus.groovy.runtime.typehandling.FloatingPointMath;
 import org.codehaus.groovy.transform.StaticTypesTransformation;
 import org.codehaus.groovy.util.ListHashMap;
 import org.objectweb.asm.Opcodes;
@@ -601,14 +602,7 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
         ClassNode componentType = collectionType.getComponentType();
         if (componentType == null) {
             if (collectionType.implementsInterface(ITERABLE_TYPE)) {
-                ClassNode intf = ITERABLE_TYPE;
-                for (ClassNode node : collectionType.getAllInterfaces()) {
-                    if (ITERABLE_TYPE.equals(node)) {
-                        intf = node;
-                        break;
-                    }
-                }
-                intf = GenericsUtils.parameterizeInterfaceGenerics(collectionType, intf);
+                ClassNode intf = GenericsUtils.parameterizeInterfaceGenerics(collectionType, ITERABLE_TYPE);
                 GenericsType[] genericsTypes = intf.getGenericsTypes();
                 componentType = genericsTypes[0].getType();
             } else if (collectionType == ClassHelper.STRING_TYPE) {
@@ -1219,6 +1213,14 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
         if (isShiftOperation(operationName) && isNumberCategory(leftRedirect) && (isIntCategory(rightRedirect) || isLongCategory(rightRedirect))) {
             return leftRedirect;
         }
+
+        // Divisions may produce different results depending on operand types
+        if (DIVIDE==op || DIVIDE_EQUAL==op) {
+            if (isFloatingCategory(leftRedirect) || isFloatingCategory(rightRedirect)) {
+                return Double_TYPE;
+            }
+
+        }
         MethodNode method = findMethodOrFail(expr, leftRedirect, operationName, rightRedirect);
         if (method != null) {
             if (isCompareToBoolean(op)) return boolean_TYPE;
@@ -1504,6 +1506,22 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
                 return result;
             }
         }
+        if (exp instanceof RangeExpression) {
+            ClassNode plain = ClassHelper.RANGE_TYPE.getPlainNodeReference();
+            RangeExpression re = (RangeExpression) exp;
+            ClassNode fromType = getType(re.getFrom());
+            ClassNode toType = getType(re.getTo());
+            if (fromType.equals(toType)) {
+                plain.setGenericsTypes(new GenericsType[] {
+                        new GenericsType(wrapTypeIfNecessary(fromType))
+                });
+            } else {
+                plain.setGenericsTypes(new GenericsType[]{
+                        new GenericsType(wrapTypeIfNecessary(lowestUpperBound(fromType, toType)))
+                });
+            }
+            return plain;
+        }
         return exp instanceof VariableExpression?((VariableExpression) exp).getOriginType():((Expression)exp).getType();
     }
 
diff --git a/src/test/groovy/transform/stc/ArraysAndCollectionsSTCTest.groovy b/src/test/groovy/transform/stc/ArraysAndCollectionsSTCTest.groovy
index e93eebc33a..3b991dbf38 100644
--- a/src/test/groovy/transform/stc/ArraysAndCollectionsSTCTest.groovy
+++ b/src/test/groovy/transform/stc/ArraysAndCollectionsSTCTest.groovy
@@ -205,6 +205,24 @@ class ArraysAndCollectionsSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
+    void testForInLoopWithDefaultListType() {
+        assertScript '''
+            class A {
+                String name
+            }
+            List<A> myList = [new A(name:'Cedric'), new A(name:'Yakari')]
+            for (element in myList) {
+                element.name.toUpperCase()
+            }
+        '''
+    }
+
+    void testForInLoopWithRange() {
+        assertScript '''
+            for (int i in 1..10) { i*2 }
+        '''
+    }
+
     // GROOVY-5177
     void testShouldNotAllowArrayAssignment() {
         shouldFailWithMessages '''
