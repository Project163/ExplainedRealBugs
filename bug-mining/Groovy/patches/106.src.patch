diff --git a/src/main/groovy/lang/GroovyShell.java b/src/main/groovy/lang/GroovyShell.java
index 90ef50d653..d567699ac4 100644
--- a/src/main/groovy/lang/GroovyShell.java
+++ b/src/main/groovy/lang/GroovyShell.java
@@ -113,6 +113,10 @@ public class GroovyShell extends GroovyObjectSupport {
         this(parent, binding, null);
     }
 
+    public GroovyShell(ClassLoader parent) {
+        this(parent, new Binding(), null);
+    }
+
     public GroovyShell(final ClassLoader parent, Binding binding, final CompilerConfiguration config) {
         this.loader = 
             	(GroovyClassLoader) AccessController.doPrivileged(new PrivilegedAction() {
diff --git a/src/main/org/codehaus/groovy/bsf/CachingGroovyEngine.java b/src/main/org/codehaus/groovy/bsf/CachingGroovyEngine.java
index 5b3dd6f132..f371d298c1 100644
--- a/src/main/org/codehaus/groovy/bsf/CachingGroovyEngine.java
+++ b/src/main/org/codehaus/groovy/bsf/CachingGroovyEngine.java
@@ -50,6 +50,7 @@ import org.apache.bsf.BSFException;
 import org.apache.bsf.BSFManager;
 import org.apache.bsf.util.BSFFunctions;
 import org.codehaus.groovy.runtime.InvokerHelper;
+import org.codehaus.groovy.control.CompilerConfiguration;
 
 /**
  * A Caching implementation of the GroovyEngine
@@ -118,16 +119,18 @@ public class CachingGroovyEngine extends GroovyEngine {
     /**
      * Initialize the engine.
      */
-    public void initialize(BSFManager mgr, String lang, Vector declaredBeans) throws BSFException {
+    public void initialize(final BSFManager mgr, String lang, Vector declaredBeans) throws BSFException {
         super.initialize(mgr, lang, declaredBeans);
-        parent = Thread.currentThread().getContextClassLoader();
+        parent = mgr.getClassLoader();
         if (parent == null)
             parent = GroovyShell.class.getClassLoader();
         final ClassLoader finalParent = parent;
         this.loader = 
         	(GroovyClassLoader) AccessController.doPrivileged(new PrivilegedAction() {
         		public Object run() {
-    				return new GroovyClassLoader(finalParent); 
+                    CompilerConfiguration configuration = new CompilerConfiguration();
+                    configuration.setClasspath(mgr.getClassPath());
+                    return new GroovyClassLoader(finalParent, configuration);
         		}
         	});
         execScripts = new HashMap();
diff --git a/src/main/org/codehaus/groovy/bsf/GroovyEngine.java b/src/main/org/codehaus/groovy/bsf/GroovyEngine.java
index 55f98a300e..22f45df2f9 100644
--- a/src/main/org/codehaus/groovy/bsf/GroovyEngine.java
+++ b/src/main/org/codehaus/groovy/bsf/GroovyEngine.java
@@ -175,7 +175,7 @@ public class GroovyEngine extends BSFEngineImpl {
         super.initialize(mgr, lang, declaredBeans);
 
         // create a shell
-        shell = new GroovyShell();
+        shell = new GroovyShell(mgr.getClassLoader());
 
         // register the mgr with object name "bsf"
         shell.setVariable("bsf", new BSFFunctions(mgr, this));
