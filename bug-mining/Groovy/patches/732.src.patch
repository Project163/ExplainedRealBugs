diff --git a/src/main/groovy/xml/MarkupBuilder.java b/src/main/groovy/xml/MarkupBuilder.java
index 41c68fdc9d..24d587f828 100644
--- a/src/main/groovy/xml/MarkupBuilder.java
+++ b/src/main/groovy/xml/MarkupBuilder.java
@@ -132,30 +132,27 @@ public class MarkupBuilder extends BuilderSupport {
     }
 
     public void yield(String value) {
-        if (state == 1) {
-            state = 2;
-            this.nodeIsEmpty = false;
-            out.print(">");
-        }
-        if (state == 2 || state == 3) {
-            out.print(escapeElementContent(value));
-        }
+        yield(value, true);
     }
 
     public void yieldUnescaped(String value) {
+        yield(value, false);
+    }
+
+    private void yield(String value, boolean escaping) {
         if (state == 1) {
             state = 2;
             this.nodeIsEmpty = false;
             out.print(">");
         }
         if (state == 2 || state == 3) {
-            out.print(value);
+            out.print(escaping ? escapeElementContent(value) : value);
         }
     }
 
     protected Object createNode(Object name) {
-        this.nodeIsEmpty = true;
         toState(1, name);
+        this.nodeIsEmpty = true;
         return name;
     }
 
@@ -405,6 +402,11 @@ public class MarkupBuilder extends BuilderSupport {
                 switch (next) {
                     case 1:
                     case 2:
+                        if (!nodeIsEmpty) {
+                            out.println();
+                            out.incrementIndent();
+                            out.printIndent();                            
+                        }
                         out.print("<");
                         print(name);
                         break;
diff --git a/src/test/groovy/xml/MarkupBuilderTest.groovy b/src/test/groovy/xml/MarkupBuilderTest.groovy
index 0c6991a099..172150e76c 100644
--- a/src/test/groovy/xml/MarkupBuilderTest.groovy
+++ b/src/test/groovy/xml/MarkupBuilderTest.groovy
@@ -300,11 +300,20 @@ require escaping. The other characters consist of:
             b('beats')
             mkp.yieldUnescaped ' Spades &amp; Clubs'
         }
-
         assertExpectedXml '''\
 <p><em>Usually</em> Hearts &amp; Diamonds <b>beats</b> Spades &amp; Clubs </p>'''
     }
 
+    void testMixedMarkupWithEmptyNodes() {
+        xml.p {
+            yield 'Red: Hearts & Diamonds'
+            br()
+            yieldUnescaped 'Black: Spades &amp; Clubs'
+        }
+        assertExpectedXml '''\
+<p>Red: Hearts &amp; Diamonds\n  <br/>Black: Spades &amp; Clubs \n</p>'''
+    }
+
     void testCallingMethod() {
        // this test is to ensure compatiblity only
        xml.p {
