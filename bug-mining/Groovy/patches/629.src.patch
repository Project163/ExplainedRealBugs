diff --git a/src/main/groovy/lang/ExpandoMetaClassCreationHandle.java b/src/main/groovy/lang/ExpandoMetaClassCreationHandle.java
index ed3ae36ab8..5784735502 100644
--- a/src/main/groovy/lang/ExpandoMetaClassCreationHandle.java
+++ b/src/main/groovy/lang/ExpandoMetaClassCreationHandle.java
@@ -16,9 +16,9 @@
 package groovy.lang;
 
 import groovy.lang.MetaClassRegistry.MetaClassCreationHandle;
-import org.codehaus.groovy.runtime.metaclass.ConcurrentReaderHashMap;
 
 import java.util.*;
+import java.util.concurrent.ConcurrentHashMap;
 
 /**
  * <p>A handle for the MetaClassRegistry that changes all classes loaded into the Grails VM
@@ -40,7 +40,7 @@ public class ExpandoMetaClassCreationHandle extends MetaClassCreationHandle {
 
     public static final ExpandoMetaClassCreationHandle instance = new ExpandoMetaClassCreationHandle();
 
-	private final Map modifiedExpandos = new ConcurrentReaderHashMap();
+	private final Map<Class,ExpandoMetaClass> modifiedExpandos = new ConcurrentHashMap<Class,ExpandoMetaClass>();
 
 
 	/* (non-Javadoc)
@@ -99,8 +99,10 @@ public class ExpandoMetaClassCreationHandle extends MetaClassCreationHandle {
      * @param emc The EMC
      */
     public void registerModifiedMetaClass(ExpandoMetaClass emc) {
-        modifiedExpandos.put(emc.getJavaClass(), emc);
-	}
+        final Class klazz = emc.getJavaClass();
+        modifiedExpandos.put(klazz, emc);
+        GroovySystem.getMetaClassRegistry().setMetaClass(klazz,emc);
+    }
 
 	public boolean hasModifiedMetaClass(ExpandoMetaClass emc) {
 		return modifiedExpandos.containsKey(emc.getJavaClass());
@@ -115,16 +117,21 @@ public class ExpandoMetaClassCreationHandle extends MetaClassCreationHandle {
     public static void enable() {
         final MetaClassRegistry metaClassRegistry = GroovySystem.getMetaClassRegistry();
         if (metaClassRegistry.getMetaClassCreationHandler() != instance) {
-           instance.modifiedExpandos.clear();
-           metaClassRegistry.setMetaClassCreationHandle(instance);
+            clearModifiedExpandos();
+            metaClassRegistry.setMetaClassCreationHandle(instance);
         }
     }
 
     public static void disable() {
         final MetaClassRegistry metaClassRegistry = GroovySystem.getMetaClassRegistry();
         if (metaClassRegistry.getMetaClassCreationHandler() == instance) {
-            instance.modifiedExpandos.clear();
+            clearModifiedExpandos();
             metaClassRegistry.setMetaClassCreationHandle(new MetaClassCreationHandle());
         }
     }
+
+    private static void clearModifiedExpandos() {
+        final MetaClassRegistry metaClassRegistry = GroovySystem.getMetaClassRegistry();
+        instance.modifiedExpandos.clear();
+    }
 }
diff --git a/src/main/org/codehaus/groovy/reflection/CachedClass.java b/src/main/org/codehaus/groovy/reflection/CachedClass.java
index 5c64d06771..ba5e970211 100644
--- a/src/main/org/codehaus/groovy/reflection/CachedClass.java
+++ b/src/main/org/codehaus/groovy/reflection/CachedClass.java
@@ -335,7 +335,7 @@ public class CachedClass {
         return metaClassForClass;
     }
 
-    public void setMetaClassForClass(MetaClass metaClassForClass, boolean isConst) {
+    public void setMetaClassForClass(MetaClass metaClassForClass) {
         this.metaClassForClass = metaClassForClass;
         setStaticMetaClassField(metaClassForClass);
     }
@@ -352,7 +352,7 @@ public class CachedClass {
         public static final Comparator INSTANCE = new CachedMethodComparatorByName();
 
         public int compare(Object o1, Object o2) {
-            return ((CachedMethod)o1).getName().compareTo(((CachedMethod)o2).getName());
+              return ((CachedMethod)o1).getName().compareTo(((CachedMethod)o2).getName());
         }
     }
 
@@ -360,7 +360,10 @@ public class CachedClass {
         public static final Comparator INSTANCE = new CachedMethodComparatorWithString();
 
         public int compare(Object o1, Object o2) {
-            return ((CachedMethod)o1).getName().compareTo((String)o2);
+            if (o1 instanceof CachedMethod)
+              return ((CachedMethod)o1).getName().compareTo((String)o2);
+            else
+              return ((String)o1).compareTo(((CachedMethod)o2).getName());
         }
     }
 
diff --git a/src/main/org/codehaus/groovy/reflection/ClassInfo.java b/src/main/org/codehaus/groovy/reflection/ClassInfo.java
index ad83f48f66..88f9d28342 100644
--- a/src/main/org/codehaus/groovy/reflection/ClassInfo.java
+++ b/src/main/org/codehaus/groovy/reflection/ClassInfo.java
@@ -16,10 +16,8 @@ public class ClassInfo extends ReentrantLock {
     private MetaClass strongMetaClass;
     SoftReference<CachedClass> cachedClassRef;
     SoftReference<MetaClass> weakMetaClass;
-    private final MultiClassInfoRecord mcir;
 
     public ClassInfo(Class klazz, MultiClassInfoRecord mcir) {
-        this.mcir = mcir;
         cachedClassRef = new SoftRef<CachedClass> (createCachedClass(klazz), mcir);
     }
 
@@ -151,6 +149,7 @@ public class ClassInfo extends ReentrantLock {
 
     public void setStrongMetaClass(MetaClass strongMetaClass) {
         this.strongMetaClass = strongMetaClass;
+        weakMetaClass = null;
     }
 
     public MetaClass getStrongMetaClass() {
@@ -161,7 +160,15 @@ public class ClassInfo extends ReentrantLock {
         return weakMetaClass == null ? null : weakMetaClass.get();
     }
 
+    
+    public MetaClass getMetaClassForClass() {
+        return strongMetaClass != null ? strongMetaClass : weakMetaClass == null ? null : weakMetaClass.get();
+    }
+
+
+
     public void setWeakMetaClass(MetaClass answer) {
+        strongMetaClass = null;
         if (answer == null) {
            weakMetaClass = null;
         }else {
@@ -274,6 +281,7 @@ public class ClassInfo extends ReentrantLock {
                 final ClassInfo res = new ClassInfo(klazz, this);
                 resArr [0] = res;
                 System.arraycopy(d, 0, resArr, 1, d.length);
+                this.data = resArr;
                 return res;
             }
             finally {
diff --git a/src/main/org/codehaus/groovy/runtime/metaclass/MetaClassRegistryImpl.java b/src/main/org/codehaus/groovy/runtime/metaclass/MetaClassRegistryImpl.java
index 08a1ddba6f..1e403a6880 100644
--- a/src/main/org/codehaus/groovy/runtime/metaclass/MetaClassRegistryImpl.java
+++ b/src/main/org/codehaus/groovy/runtime/metaclass/MetaClassRegistryImpl.java
@@ -25,6 +25,7 @@ import java.lang.ref.SoftReference;
 import java.lang.reflect.Constructor;
 import java.lang.reflect.Modifier;
 import java.util.*;
+import java.util.concurrent.atomic.AtomicInteger;
 
 /**
  * A registry of MetaClass instances which caches introspection &
@@ -45,7 +46,7 @@ public class MetaClassRegistryImpl implements MetaClassRegistry{
     private FastArray instanceMethods = new FastArray();
     private FastArray staticMethods = new FastArray();
 
-    private volatile Integer version = new Integer(0);
+    private AtomicInteger version = new AtomicInteger();
 
     /*
        We keep references to meta classes already known to this thread.
@@ -104,7 +105,7 @@ public class MetaClassRegistryImpl implements MetaClassRegistry{
         private MetaClass getFromGlobal(Class theClass) {
             MetaClass answer = getGlobalMetaClass(theClass);
             put(theClass, answer);
-            version = MetaClassRegistryImpl.this.version.intValue();
+            version = MetaClassRegistryImpl.this.version.get();
             return answer;
         }
 
@@ -267,21 +268,13 @@ public class MetaClassRegistryImpl implements MetaClassRegistry{
     private MetaClass getGlobalMetaClass (Class theClass) {
         final ClassInfo info = ClassInfo.getClassInfo(theClass);
 
-        MetaClass answer = info.getStrongMetaClass();
-        if (answer != null)
-          return answer;
-
-        answer = info.getWeakMetaClass();
+        MetaClass answer = info.getMetaClassForClass();
         if (answer != null)
           return answer;
 
         info.lock();
         try {
-            answer = info.getStrongMetaClass();
-            if (answer != null)
-              return answer;
-
-            answer = info.getWeakMetaClass();
+            answer = info.getMetaClassForClass();
             if (answer != null)
               return answer;
 
@@ -295,31 +288,30 @@ public class MetaClassRegistryImpl implements MetaClassRegistry{
             }
             final CachedClass aClass = info.getCachedClass(theClass);
             aClass.setStaticMetaClassField (answer);
-            aClass.setMetaClassForClass(answer, true);
+            aClass.setMetaClassForClass(answer);
             return answer;
         }
         finally {
-            info.unlock();
+            info.unlock();                       
         }
     }
 
     public final MetaClass getMetaClass(Class theClass) {
-        return locallyKnown.getMetaClass(theClass);
+         return locallyKnown.getMetaClass(theClass);
     }
 
     public synchronized void removeMetaClass(Class theClass) {
-        version = new Integer (version.intValue()+1);
+        version.incrementAndGet();
 
         final ClassInfo info = ClassInfo.getClassInfo(theClass);
 
         info.lock();
         try {
             info.setStrongMetaClass(null);
-            info.setWeakMetaClass(null);
 
             final CachedClass aClass = info.getCachedClass(theClass);
             aClass.setStaticMetaClassField (null);
-            aClass.setMetaClassForClass(null, true);
+            aClass.setMetaClassForClass(null);
         }
         finally {
             info.unlock();
@@ -333,18 +325,17 @@ public class MetaClassRegistryImpl implements MetaClassRegistry{
      * @param theMetaClass
      */
     public synchronized void setMetaClass(Class theClass, MetaClass theMetaClass) {
-        version = new Integer (version.intValue()+1);
+        version.incrementAndGet();
 
         final ClassInfo info = ClassInfo.getClassInfo(theClass);
 
         info.lock();
         try {
             info.setStrongMetaClass(theMetaClass);
-            info.setWeakMetaClass(null);
 
             final CachedClass aClass = info.getCachedClass(theClass);
             aClass.setStaticMetaClassField (theMetaClass);
-            aClass.setMetaClassForClass(theMetaClass, true);
+            aClass.setMetaClassForClass(theMetaClass);
         }
         finally {
             info.unlock();
