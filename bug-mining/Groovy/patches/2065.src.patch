diff --git a/src/main/org/codehaus/groovy/runtime/StringGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/StringGroovyMethods.java
index af09360d24..163b93d5dd 100644
--- a/src/main/org/codehaus/groovy/runtime/StringGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/StringGroovyMethods.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2012 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -635,6 +635,46 @@ public class StringGroovyMethods extends DefaultGroovyMethodsSupport {
         return result;
     }
 
+    /**
+     * Iterate through this String a character at a time collecting either the
+     * original character or a transformed replacement String. The {@code transform}
+     * Closure should return {@code null} to indicate that no transformation is
+     * required for the given character.
+     * <p/>
+     * <pre class="groovyTestCase">
+     * assert "Groovy".collectReplacements{ it == 'o' ? '_O_' : null } == 'Gr_O__O_vy'
+     * assert "B&W".collectReplacements{ it == '&' ? '&amp;' : null } == 'B&amp;W'
+     * </pre>
+     *
+     * @param orig the original String
+     * @return A new string in which all characters that require escaping
+     *         have been replaced with the corresponding replacements
+     *         as determined by the {@code transform} Closure.
+     */
+    public static String collectReplacements(String orig, Closure<String> transform) {
+        if (orig == null) return orig;
+
+        StringBuilder sb = null; // lazy create for edge-case efficiency
+        for (int i = 0, len = orig.length(); i < len; i++) {
+            final char ch = orig.charAt(i);
+            final String replacement = transform.call(ch);
+
+            if (replacement != null) {
+                // output differs from input; we write to our local buffer
+                if (sb == null) {
+                    sb = new StringBuilder((int) (1.1 * len));
+                    sb.append(orig.substring(0, i));
+                }
+                sb.append(replacement);
+            } else if (sb != null) {
+                // earlier output differs from input; we write to our local buffer
+                sb.append(ch);
+            }
+        }
+
+        return sb == null ? orig : sb.toString();
+    }
+
     /**
      * Process each regex group matched substring of the given CharSequence. If the closure
      * parameter takes one argument, an array with all match groups is passed to it.
diff --git a/subprojects/groovy-xml/src/main/java/groovy/xml/MarkupBuilder.java b/subprojects/groovy-xml/src/main/java/groovy/xml/MarkupBuilder.java
index 8fda387efa..17cca6cf58 100644
--- a/subprojects/groovy-xml/src/main/java/groovy/xml/MarkupBuilder.java
+++ b/subprojects/groovy-xml/src/main/java/groovy/xml/MarkupBuilder.java
@@ -407,6 +407,7 @@ public class MarkupBuilder extends BuilderSupport {
         return sb == null ? value : sb.toString();
     }
 
+    // TODO: re-write as a closure and consider using StringGroovyMethods.collectReplacements() above?
     private String checkForReplacement(boolean isAttrValue, char ch) {
         switch (ch) {
             case '&':
diff --git a/subprojects/groovy-xml/src/main/java/groovy/xml/XmlUtil.java b/subprojects/groovy-xml/src/main/java/groovy/xml/XmlUtil.java
index 582f1caeae..5848330094 100644
--- a/subprojects/groovy-xml/src/main/java/groovy/xml/XmlUtil.java
+++ b/subprojects/groovy-xml/src/main/java/groovy/xml/XmlUtil.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2010 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -15,12 +15,14 @@
  */
 package groovy.xml;
 
+import groovy.lang.Closure;
 import groovy.lang.GroovyRuntimeException;
 import groovy.lang.Writable;
 import groovy.util.Node;
 import groovy.util.XmlNodePrinter;
 import groovy.util.slurpersupport.GPathResult;
 import org.codehaus.groovy.runtime.InvokerHelper;
+import org.codehaus.groovy.runtime.StringGroovyMethods;
 import org.w3c.dom.Element;
 import org.xml.sax.SAXException;
 
@@ -37,7 +39,7 @@ import java.io.*;
 import java.net.URL;
 
 /**
- * Used for pretty printing XML content.
+ * Used for pretty printing XML content and other XML related utilities.
  *
  * @author Paul King
  */
@@ -313,6 +315,67 @@ public class XmlUtil {
         return newSAXParser(namespaceAware, validating, schemaFactory.newSchema(schema));
     }
 
+    /**
+     * Escape the following characters {@code " ' & < >} with their XML entities, e.g.
+     * {@code "bread" & "butter"} becomes {@code &quot;bread&quot; &amp; &quot;butter&quot}.
+     * Notes:<ul>
+     * <li>Supports only the five basic XML entities (gt, lt, quot, amp, apos)</li>
+     * <li>Does not escape control characters</li>
+     * <li>Does not support DTDs or external entities</li>
+     * <li>Does not treat surrogate pairs specially</li>
+     * <li>Does not perform Unicode validation on its input</li>
+     * </ul>
+     *
+     * @param orig the original String
+     * @return A new string in which all characters that require escaping
+     *         have been replaced with the corresponding XML entities.
+     * @see #escapeControlCharacters(String)
+     */
+    public static String escapeXml(String orig) {
+        return StringGroovyMethods.collectReplacements(orig, new Closure<String>(null) {
+            public String doCall(Character arg) {
+                switch (arg) {
+                    case '&':
+                        return "&amp;";
+                    case '<':
+                        return "&lt;";
+                    case '>':
+                        return "&gt;";
+                    case '"':
+                        return "&quot;";
+                    case '\'':
+                        return "&apos;";
+                }
+                return null;
+            }
+        });
+    }
+
+    /**
+     * Escape control characters (below 0x20) with their XML entities, e.g.
+     * carriage return ({@code Ctrl-M or \r}) becomes {@code &#13;}
+     * Notes:<ul>
+     * <li>Does not escape non-ascii characters above 0x7e</li>
+     * <li>Does not treat surrogate pairs specially</li>
+     * <li>Does not perform Unicode validation on its input</li>
+     * </ul>
+     *
+     * @param orig the original String
+     * @return A new string in which all characters that require escaping
+     *         have been replaced with the corresponding XML entities.
+     * @see #escapeXml(String)
+     */
+    public static String escapeControlCharacters(String orig) {
+        return StringGroovyMethods.collectReplacements(orig, new Closure<String>(null) {
+            public String doCall(Character arg) {
+                if (arg < 31) {
+                        return "&#" + (int) arg + ";";
+                }
+                return null;
+            }
+        });
+    }
+
     private static SAXParser newSAXParser(boolean namespaceAware, boolean validating, Schema schema1) throws ParserConfigurationException, SAXException {
         SAXParserFactory factory = SAXParserFactory.newInstance();
         factory.setValidating(validating);
diff --git a/subprojects/groovy-xml/src/test/groovy/groovy/xml/XmlUtilTest.groovy b/subprojects/groovy-xml/src/test/groovy/groovy/xml/XmlUtilTest.groovy
index 1ce768fd8a..6112128b36 100644
--- a/subprojects/groovy-xml/src/test/groovy/groovy/xml/XmlUtilTest.groovy
+++ b/subprojects/groovy-xml/src/test/groovy/groovy/xml/XmlUtilTest.groovy
@@ -1,5 +1,5 @@
 /*
-* Copyright 2003-2012 the original author or authors.
+* Copyright 2003-2013 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
@@ -22,6 +22,8 @@ import javax.xml.transform.stream.StreamSource
 
 import static groovy.xml.XmlAssert.assertXmlEquals
 import static groovy.xml.XmlUtil.newSAXParser
+import static groovy.xml.XmlUtil.escapeControlCharacters
+import static groovy.xml.XmlUtil.escapeXml
 import static javax.xml.XMLConstants.W3C_XML_SCHEMA_NS_URI
 
 /**
@@ -88,4 +90,10 @@ class XmlUtilTest extends GroovyTestCase {
             Locale.setDefault(dl)
         }
     }
+
+    // GROOVY-5775
+    void testEscaping() {
+      def ans = escapeControlCharacters(escapeXml('"bread" & "butter"\r\n'))
+      assert ans == '&quot;bread&quot; &amp; &quot;butter&quot;&#13;&#10;'
+    }
 }
