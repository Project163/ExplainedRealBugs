diff --git a/src/main/org/codehaus/groovy/transform/BaseScriptASTTransformation.java b/src/main/org/codehaus/groovy/transform/BaseScriptASTTransformation.java
index 81aadb0c11..52d7798f3a 100644
--- a/src/main/org/codehaus/groovy/transform/BaseScriptASTTransformation.java
+++ b/src/main/org/codehaus/groovy/transform/BaseScriptASTTransformation.java
@@ -129,22 +129,26 @@ public class BaseScriptASTTransformation extends AbstractASTTransformation {
         MethodNode runScriptMethod = ClassHelper.findSAM(baseScriptType);
 
         // If they want to use a name other than than "run", then make the change.
-        if (isSuitableAbstractMethod(runScriptMethod)) {
+        if (isCustomScriptBodyMethod(runScriptMethod)) {
             MethodNode defaultMethod = cNode.getDeclaredMethod("run", Parameter.EMPTY_ARRAY);
-            cNode.removeMethod(defaultMethod);
-            MethodNode methodNode = new MethodNode(runScriptMethod.getName(), runScriptMethod.getModifiers() & ~ACC_ABSTRACT
-                    , runScriptMethod.getReturnType(), runScriptMethod.getParameters(), runScriptMethod.getExceptions()
-                    , defaultMethod.getCode());
-            // The AST node metadata has the flag that indicates that this method is a script body.
-            // It may also be carrying data for other AST transforms.
-            methodNode.copyNodeMetaData(defaultMethod);
-            cNode.addMethod(methodNode);
+            // GROOVY-6706: Sometimes an NPE is thrown here.
+            // The reason is that our transform is getting called more than once sometimes.  
+            if (defaultMethod != null) {
+                cNode.removeMethod(defaultMethod);
+                MethodNode methodNode = new MethodNode(runScriptMethod.getName(), runScriptMethod.getModifiers() & ~ACC_ABSTRACT
+                        , runScriptMethod.getReturnType(), runScriptMethod.getParameters(), runScriptMethod.getExceptions()
+                        , defaultMethod.getCode());
+                // The AST node metadata has the flag that indicates that this method is a script body.
+                // It may also be carrying data for other AST transforms.
+                methodNode.copyNodeMetaData(defaultMethod);
+                cNode.addMethod(methodNode);
+            }
         }
     }
 
-    private boolean isSuitableAbstractMethod(MethodNode node) {
+    private boolean isCustomScriptBodyMethod(MethodNode node) {
         return node != null
-                && !(node.getDeclaringClass().equals(ClassHelper.SCRIPT_TYPE)
+            && !(node.getDeclaringClass().equals(ClassHelper.SCRIPT_TYPE)
                 && "run".equals(node.getName())
                 && node.getParameters().length == 0);
     }
diff --git a/src/test/org/codehaus/groovy/transform/BaseScriptTransformTest.groovy b/src/test/org/codehaus/groovy/transform/BaseScriptTransformTest.groovy
index 7a813a86ba..1a39623bb6 100644
--- a/src/test/org/codehaus/groovy/transform/BaseScriptTransformTest.groovy
+++ b/src/test/org/codehaus/groovy/transform/BaseScriptTransformTest.groovy
@@ -106,6 +106,8 @@ class BaseScriptTransformTest extends CompilableTestSupport {
         """
     }
 
+    abstract class MyCustomScript extends Script {}
+
     void testBaseScriptFromCompiler(){
         CompilerConfiguration config = new CompilerConfiguration()
         config.scriptBaseClass = MyCustomScript.name
@@ -259,6 +261,37 @@ class BaseScriptTransformTest extends CompilableTestSupport {
         assert result
     }
 
+    /**
+     * Test GROOVY-6706.  Base script in import (or package) with a SAM.
+     */
+    void testGROOVY_6706() {
+        assertScript '''
+@BaseScript(CustomBase)
+import groovy.transform.BaseScript
+
+assert did_before
+assert !did_after
+
+42
+
+abstract class CustomBase extends Script {
+    boolean did_before = false
+    boolean did_after = false
+
+    def run() {
+        before()
+        def r = internalRun()
+        after()
+        assert r == 42
+    }
+
+    abstract internalRun()
+
+    def before() { did_before = true }
+    def after()  { did_after = true  }
+}'''
+    }
+
     void testBaseScriptOnPackage() {
         def result = new GroovyShell().evaluate('''
             @BaseScript(DeclaredBaseScript)
@@ -315,7 +348,4 @@ class BaseScriptTransformTest extends CompilableTestSupport {
             println 'ok'
         '''
     }
-
 }
-
-abstract class MyCustomScript extends Script {}
\ No newline at end of file
