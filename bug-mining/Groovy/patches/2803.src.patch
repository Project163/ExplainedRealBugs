diff --git a/src/main/groovy/grape/GrapeIvy.groovy b/src/main/groovy/grape/GrapeIvy.groovy
index 21fcbe991f..1d84e1592e 100644
--- a/src/main/groovy/grape/GrapeIvy.groovy
+++ b/src/main/groovy/grape/GrapeIvy.groovy
@@ -292,19 +292,13 @@ class GrapeIvy implements GrapeEngine {
                         metaMethods.each { CachedClass c, List<MetaMethod> methods ->
                             // GROOVY-5543: if a module was loaded using grab, there are chances that subclasses
                             // have their own ClassInfo, and we must change them as well!
-                            def classesToBeUpdated = ClassInfo.allClassInfo.findAll {
-                                boolean found = false
-                                CachedClass current = it.cachedClass
-                                while (!found && current != null) {
-                                    if (current == c || ReflectionCache.isAssignableFrom(c.theClass,current.theClass)) {
-                                        found = true
-                                    }
-                                    current = current.cachedSuperClass
+                            Set<CachedClass> classesToBeUpdated = [c]
+                            ClassInfo.onAllClassInfo { ClassInfo info ->
+                                if (c.theClass.isAssignableFrom(info.cachedClass.theClass)) {
+                                    classesToBeUpdated << info.cachedClass
                                 }
-                                found
-                            }.collect { it.cachedClass }
+                            }
                             classesToBeUpdated*.addNewMopMethods(methods)
-                            c.addNewMopMethods(methods)
                         }
                     }
                 }
diff --git a/src/main/org/codehaus/groovy/reflection/ClassInfo.java b/src/main/org/codehaus/groovy/reflection/ClassInfo.java
index 247be572be..a98732b7b7 100644
--- a/src/main/org/codehaus/groovy/reflection/ClassInfo.java
+++ b/src/main/org/codehaus/groovy/reflection/ClassInfo.java
@@ -132,6 +132,18 @@ public class ClassInfo {
         return localClassInfos != null ? localClassInfos : getAllGlobalClassInfo();
     }
 
+    public static void onAllClassInfo(ClassInfoAction action) {
+        Collection<ClassInfo> localClassInfos = getAllLocalClassInfo();
+        if (localClassInfos!=null) {
+            for (ClassInfo localClassInfo : localClassInfos) {
+                action.onClassInfo(localClassInfo);
+            }
+        }
+        for (ClassInfo classInfo : getAllGlobalClassInfo()) {
+            action.onClassInfo(classInfo);
+        }
+    }
+
     private static Collection<ClassInfo> getAllGlobalClassInfo() {
         return globalClassSet.values();
     }
@@ -524,7 +536,7 @@ public class ClassInfo {
         }
 
         public void finalizeRef() {
-            System.out.println(name + " unloaded " + count.decrementAndGet() + " classes kept");
+            //System.out.println(name + " unloaded " + count.decrementAndGet() + " classes kept");
             super.finalizeReference();
         }
     }
@@ -554,4 +566,8 @@ public class ClassInfo {
     	}
 
     }
+
+    public static interface ClassInfoAction {
+        void onClassInfo(ClassInfo classInfo);
+    }
 }
