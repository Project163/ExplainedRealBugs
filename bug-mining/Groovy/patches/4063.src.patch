diff --git a/src/main/java/org/codehaus/groovy/ast/GenericsType.java b/src/main/java/org/codehaus/groovy/ast/GenericsType.java
index 75ba049a50..953feb9353 100644
--- a/src/main/java/org/codehaus/groovy/ast/GenericsType.java
+++ b/src/main/java/org/codehaus/groovy/ast/GenericsType.java
@@ -155,7 +155,7 @@ public class GenericsType extends ASTNode {
     }
 
     public boolean isResolved() {
-        return (resolved || isPlaceholder());
+        return resolved;
     }
 
     public void setResolved(final boolean resolved) {
@@ -168,6 +168,8 @@ public class GenericsType extends ASTNode {
 
     public void setPlaceholder(final boolean placeholder) {
         this.placeholder = placeholder;
+        this.resolved = resolved || placeholder;
+        this.wildcard = wildcard && !placeholder;
         getType().setGenericsPlaceHolder(placeholder);
     }
 
@@ -177,6 +179,7 @@ public class GenericsType extends ASTNode {
 
     public void setWildcard(final boolean wildcard) {
         this.wildcard = wildcard;
+        this.placeholder = placeholder && !wildcard;
     }
 
     public ClassNode getLowerBound() {
diff --git a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
index 6270dd082a..583a3f6fd3 100644
--- a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
+++ b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
@@ -1592,15 +1592,22 @@ public abstract class StaticTypeCheckingSupport {
                     if (newValue == oldValue) continue;
                     if (newValue == null) {
                         entry.setValue(newValue = applyGenericsContext(connections, oldValue));
-                        checkForMorePlaceholders = checkForMorePlaceholders || !equalIncludingGenerics(oldValue, newValue);
+                        if (!checkForMorePlaceholders) {
+                            checkForMorePlaceholders = !equalIncludingGenerics(oldValue, newValue);
+                        }
                     } else if (!newValue.isPlaceholder() || newValue != resolvedPlaceholders.get(name)) {
                         // GROOVY-6787: Don't override the original if the replacement doesn't respect the bounds otherwise
                         // the original bounds are lost, which can result in accepting an incompatible type as an argument.
                         ClassNode replacementType = extractType(newValue);
                         if (oldValue.isCompatibleWith(replacementType)) {
-                            entry.setValue(newValue.isWildcard() ? new GenericsType(replacementType) : newValue); // GROOVY-9998
-                            if (newValue.isPlaceholder()) {
-                                checkForMorePlaceholders = checkForMorePlaceholders || !equalIncludingGenerics(oldValue, newValue);
+                            if (newValue.isWildcard() && newValue.getLowerBound() == null && newValue.getUpperBounds() == null) {
+                                // GROOVY-9998: apply upper/lower bound for unknown
+                                entry.setValue(new GenericsType(replacementType));
+                            } else {
+                                entry.setValue(newValue);
+                            }
+                            if (!checkForMorePlaceholders && newValue.isPlaceholder()) {
+                                checkForMorePlaceholders = !equalIncludingGenerics(oldValue, newValue);
                             }
                         }
                     }
diff --git a/src/test/groovy/transform/stc/GenericsSTCTest.groovy b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
index b8ee8550c9..015e0bd0ba 100644
--- a/src/test/groovy/transform/stc/GenericsSTCTest.groovy
+++ b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
@@ -2601,22 +2601,63 @@ class GenericsSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
-    void testContravariantMethodResolutionWithImplicitCoercion() {
+    void testContravariantMethodResolutionWithImplicitCoercion1() {
         assertScript '''
-            interface Function<T, R> {
-                R apply(T t)
+            // static <T,E> List<T> collectMany(Iterable<E> it, Closure<? extends Collection<? extends T>> fn)
+            List<String> strings = [1,2,3].collectMany {
+                Collections.emptyList()
             }
+            assert strings.isEmpty()
+        '''
+    }
 
-            public <I, O> void transform(Function<? super I, ? extends O> function) {
-                function.apply('')
-            }
+    void testContravariantMethodResolutionWithImplicitCoercion2() {
+        ['public', 'static'].each { modifier ->
+            assertScript """
+                $modifier <I, O> void transform(java.util.function.Function<? super I, ? extends O> function) {
+                    function.apply('')
+                }
 
-            String result = null
-            transform {
-                result = 'ok'
-            }
-            assert result == 'ok'
-        '''
+                boolean called = false
+                transform {
+                    called = true
+                }
+                assert called
+            """
+        }
+    }
+
+    void testContravariantMethodResolutionWithImplicitCoercion3() {
+        File parentDir = File.createTempDir()
+        config.with {
+            targetDirectory = File.createTempDir()
+            jointCompilationOptions = [stubDir: File.createTempDir()]
+        }
+        try {
+            def a = new File(parentDir, 'Bean.java')
+            a.write '''
+                class Bean {
+                    static Class<? extends CharSequence> getType() { return String.class; }
+                }
+            '''
+            def b = new File(parentDir, 'Main.groovy')
+            b.write '''
+                def <T> T create(Class<T> c) { null }
+                CharSequence cs = create(Bean.type)
+                assert cs == null
+            '''
+
+            def loader = new GroovyClassLoader(this.class.classLoader)
+            def cu = new JavaAwareCompilationUnit(config, loader)
+            cu.addSources(a, b)
+            cu.compile()
+
+            loader.loadClass('Main').main()
+        } finally {
+            parentDir.deleteDir()
+            config.targetDirectory.deleteDir()
+            config.jointCompilationOptions.stubDir.deleteDir()
+        }
     }
 
     // GROOVY-5981
