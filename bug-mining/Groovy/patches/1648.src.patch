diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index 36dd533674..88336fd762 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -653,10 +653,13 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
 
     @Override
     protected void visitConstructorOrMethod(MethodNode node, boolean isConstructor) {
-        this.methodNode = node;
+        MethodNode old = this.methodNode;
+		this.methodNode = node;
         super.visitConstructorOrMethod(node, isConstructor);
-        if (!isConstructor) returnAdder.visitMethod(node);
-        this.methodNode = null;
+        if (!isConstructor) {
+			returnAdder.visitMethod(node);
+		}
+        this.methodNode = old;
     }
 
     @Override
@@ -671,7 +674,10 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
     private ClassNode checkReturnType(final ReturnStatement statement) {
         ClassNode type = getType(statement.getExpression());
         if (methodNode != null) {
-            if (!methodNode.isVoidMethod() && !checkCompatibleAssignmentTypes(methodNode.getReturnType(), type)) {
+            if (!methodNode.isVoidMethod() 
+					&& !type.equals(void_WRAPPER_TYPE) 
+					&& !type.equals(VOID_TYPE)
+					&& !checkCompatibleAssignmentTypes(methodNode.getReturnType(), type)) {
                 addStaticTypeError("Cannot return value of type " + type + " on method returning type " + methodNode.getReturnType(), statement.getExpression());
             }
         }
diff --git a/src/test/groovy/transform/stc/GenericsSTCTest.groovy b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
index 74a80cd178..aa294d8410 100644
--- a/src/test/groovy/transform/stc/GenericsSTCTest.groovy
+++ b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
@@ -238,6 +238,15 @@ class GenericsSTCTest extends StaticTypeCheckingTestCase {
         ''', 'Cannot find matching method FooWithGenerics#say(java.lang.Object)'
     }
 
+    void testVoidReturnTypeInferrence() {
+      assertScript '''
+        Object m() {
+          def s = '1234'
+          println 'Hello'
+        }
+      '''
+    }
+  
     static class MyList extends LinkedList<String> {}
 }
 
