diff --git a/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java b/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
index d9265589ed..285479a619 100644
--- a/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
+++ b/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
@@ -24,6 +24,7 @@ import org.codehaus.groovy.transform.GroovyASTTransformation;
 import org.codehaus.groovy.ast.expr.*;
 import org.codehaus.groovy.ast.stmt.BlockStatement;
 import org.codehaus.groovy.ast.stmt.ExpressionStatement;
+import org.codehaus.groovy.ast.stmt.ForStatement;
 import org.codehaus.groovy.ast.*;
 import org.codehaus.groovy.syntax.SyntaxException;
 import org.objectweb.asm.Opcodes;
@@ -93,6 +94,16 @@ public class CategoryASTTransformation implements ASTTransformation, Opcodes {
                 super.visitDeclarationExpression(expression);
             }
 
+            public void visitForLoop(ForStatement forLoop) {
+            	Expression exp = forLoop.getCollectionExpression();
+            	exp.visit(this);
+            	Parameter loopParam = forLoop.getVariable();
+            	if(loopParam != null) {
+            		varStack.getLast().add(loopParam.getName());
+            	}
+                super.visitForLoop(forLoop);
+            }
+
             public void visitExpressionStatement(ExpressionStatement es) {
             	// GROOVY-3543: visit the declaration expressions so that declaration variables get added on the varStack
             	Expression exp = es.getExpression();
diff --git a/src/test/groovy/CategoryTest.groovy b/src/test/groovy/CategoryTest.groovy
index 84a5ad9024..71e569cb70 100644
--- a/src/test/groovy/CategoryTest.groovy
+++ b/src/test/groovy/CategoryTest.groovy
@@ -130,37 +130,6 @@ class CategoryTest extends GroovyTestCase {
         }
       """
     }
-    
-    void testCategoryMethodsHavingDeclarationStatements() {
-    	// GROOVY-3543: Declaration statements in category class' methods were not being visited by 
-    	// CategoryASTTransformation's expressionTransformer resulting in declaration variables not being 
-    	// defined on varStack resulting in compilation errors later
-    	assertScript """
-	    	@Category(Test)
-	    	class TestCategory {
-	    	    String getSuperName() { 
-	    	        String myname = "" // 
-	    	        return myname + "hi from category" 
-	    	    }
-	    	}
-	
-	    	interface Test { 
-	    	    String getName() 
-	    	}
-	
-	    	class MyTest implements Test {
-	    	    String getName() {
-	    	        return "hi"
-	    	    }
-	    	}
-	
-	    	def onetest = new MyTest()
-	    	assert onetest.getName() == "hi"
-	    	use(TestCategory) { 
-	    	    assert onetest.getSuperName() == "hi from category" 
-	    	}
-    	"""
-    }
 }
 
 class StringCategory {
diff --git a/src/test/groovy/lang/CategoryAnnotationTest.groovy b/src/test/groovy/lang/CategoryAnnotationTest.groovy
index cef96e34c3..27a33278ec 100644
--- a/src/test/groovy/lang/CategoryAnnotationTest.groovy
+++ b/src/test/groovy/lang/CategoryAnnotationTest.groovy
@@ -39,5 +39,48 @@ class CategoryAnnotationTest extends GroovyTestCase {
         """
     }
     
+    void testCategoryMethodsHavingDeclarationStatements() {
+        // GROOVY-3543: Declaration statements in category class' methods were not being visited by 
+        // CategoryASTTransformation's expressionTransformer resulting in declaration variables not being 
+        // defined on varStack resulting in compilation errors later
+        assertScript """
+            @Category(Test)
+            class TestCategory {
+                String getSuperName1() { 
+                    String myname = "" 
+                    return myname + "hi from category" 
+                }
+                // 2nd test case of JIRA
+                String getSuperName2() { 
+			        String myname = this.getName() 
+			        for(int i = 0; i < 5; i++) myname += i 
+			        return myname + "-Post"
+                }
+                // 3rd test case of JIRA
+                String getSuperName3() { 
+                    String myname = this.getName() 
+                    for(i in 0..4) myname += i
+                    return myname + "-Post"
+                }
+            }
+    
+            interface Test { 
+                String getName() 
+            }
+    
+            class MyTest implements Test {
+                String getName() {
+                    return "Pre-"
+                }
+            }
+    
+            def onetest = new MyTest()
+            use(TestCategory) { 
+                assert onetest.getSuperName1() == "hi from category"
+                assert onetest.getSuperName2() == "Pre-01234-Post"
+                assert onetest.getSuperName3() == "Pre-01234-Post"
+            }
+        """
+    }
 }
 
