diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index 5998fba715..8099a3032b 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -8034,6 +8034,9 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
         if (right == null) {
             return false;
         }
+        if (left == right) {
+            return true;
+        }
         if (left.length != right.length) {
             return false;
         }
@@ -8126,6 +8129,9 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
         if (right == null) {
             return false;
         }
+        if (left == right) {
+            return true;
+        }
         if (left.size() != right.size()) {
             return false;
         }
@@ -8152,7 +8158,8 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
      * for example 2 == 2L.  If both sets are <code>null</code>, the result
      * is true; otherwise if either set is <code>null</code>, the result
      * is <code>false</code>. Example usage:
-     * <pre class="groovyTestCase">Set s1 = ["a", 2]
+     * <pre class="groovyTestCase">
+     * Set s1 = ["a", 2]
      * def s2 = [2, 'a'] as Set
      * Set s3 = [3, 'a']
      * def s4 = [2.0, 'a'] as Set
@@ -8167,29 +8174,34 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
      * @return <tt>true</tt> if the contents of both sets are identical
      * @since 1.8.0
      */
-    public static boolean equals(Set self, Set other) {
+    public static <T> boolean equals(Set<T> self, Set<T> other) {
         if (self == null) {
             return other == null;
         }
         if (other == null) {
             return false;
         }
+        if (self == other) {
+            return true;
+        }
         if (self.size() != other.size()) {
             return false;
         }
-        final Iterator it1 = self.iterator();
-        Collection otherItems = new HashSet(other);
+        final Iterator<T> it1 = self.iterator();
+        Collection<T> otherItems = new HashSet<T>(other);
         while (it1.hasNext()) {
             final Object o1 = it1.next();
-            final Iterator it2 = otherItems.iterator();
-            Object foundItem = null;
+            final Iterator<T> it2 = otherItems.iterator();
+            T foundItem = null;
+            boolean found = false;
             while (it2.hasNext() && foundItem == null) {
-                final Object o2 = it2.next();
+                final T o2 = it2.next();
                 if (coercedEquals(o1, o2)) {
                     foundItem = o2;
+                    found = true;
                 }
             }
-            if (foundItem == null) return false;
+            if (!found) return false;
             otherItems.remove(foundItem);
         }
         return otherItems.size() == 0;
@@ -8213,15 +8225,16 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
         if (other == null) {
             return false;
         }
+        if (self == other) {
+            return true;
+        }
         if (self.size() != other.size()) {
             return false;
         }
         if (!self.keySet().equals(other.keySet())) {
             return false;
         }
-        final Iterator it = self.keySet().iterator();
-        while (it.hasNext()) {
-            final Object key = it.next();
+        for (Object key : self.keySet()) {
             if (!coercedEquals(self.get(key), other.get(key))) {
                 return false;
             }
diff --git a/src/test/groovy/ListTest.groovy b/src/test/groovy/ListTest.groovy
index 1170f7bfdf..63906ead9e 100644
--- a/src/test/groovy/ListTest.groovy
+++ b/src/test/groovy/ListTest.groovy
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2009 the original author or authors.
+ * Copyright 2003-2011 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -15,7 +15,6 @@
  */
 package groovy
 
-// TODO: split a couple of Set tests into their own class?
 class ListTest extends GroovyTestCase {
 
     void testList() {
@@ -141,13 +140,6 @@ class ListTest extends GroovyTestCase {
         assert l1 + l2 == l3
     }
 
-    void testSetPlus() {
-        Set s1 = [6, 4, 5, 1, 7, 2]
-        def s2 = [6, 4, 5, 1, 7, [4,5]]
-        def s3 = s1 + s2
-        assert s3 == [1, 2, 4, 5, 6, 7, [4,5]] as Set
-    }
-
     void testPlusOneElement() {
         def l1 = [6, 4, 5, 1, 7, 2]
         def l2 = "erererer"
@@ -178,14 +170,6 @@ class ListTest extends GroovyTestCase {
         assert l1 - l2 == [3, 3, 3, 5, 3, 5] 
     }
 
-    void testSetSimpleMinus() {
-        Set s1 = [1, 1, 2, 2, 3, 3, 3, 4, 5, 3, 5]
-        def s2 = s1 - [1, 4]
-        assert s2 == [2, 3, 5] as Set
-        def s3 = s1 - 4.0
-        assert s3 == [1, 2, 3, 5] as Set
-    }
-
     // GROOVY-1006
     void testMinusDifferentTypes() {
         def l1 = [1, 1, "wrer", 2, 3, 3, "wrewer", 4, 5, "w", "w"]
@@ -240,12 +224,6 @@ class ListTest extends GroovyTestCase {
         def flat = orig.flatten()
         assert flat == [4, 5, 6, 46, 7, "erer", null, 4, 3, 6, 78, 4]
     }
-    
-    void testSetFlatten() {
-        Set orig = [[[4, 5, 6, [46, 7, "erer"] as Set] as Set, 4, [3, 6, 78] as Set] as Set, 4]
-        Set flat = orig.flatten()
-        assert flat == [3, 4, 5, 6, 7, 46, 78, "erer"] as Set
-    }
 
     void testFlattenListOfMaps() {
         def orig = [[a:1, b:2], [c:3, d:4]]
@@ -275,14 +253,6 @@ class ListTest extends GroovyTestCase {
         assert flat == ["a", "b", "c", "d"]
     }
 
-    void testFlattenSetOfMapsWithClosure() {
-        Set orig = [[a:1, b:2], [c:3, d:4]] as Set
-        Set flat = orig.flatten{ it instanceof Map ? it.values() : it }
-        assert flat == [1, 2, 3 ,4] as Set
-        flat = orig.flatten{ it instanceof Map ? it.keySet() : it }
-        assert flat == ["a", "b", "c", "d"] as Set
-    }
-
     void testFlattenWithRanges() {
         def flat = [1, 3, 20..24, 33].flatten()
         assert flat == [1, 3, 20, 21, 22, 23, 24, 33]
diff --git a/src/test/groovy/SetTest.groovy b/src/test/groovy/SetTest.groovy
new file mode 100644
index 0000000000..8dd0fe0a93
--- /dev/null
+++ b/src/test/groovy/SetTest.groovy
@@ -0,0 +1,57 @@
+/*
+ * Copyright 2003-2011 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package groovy
+
+class SetTest extends GroovyTestCase {
+
+    void testSetPlus() {
+        Set s1 = [6, 4, 5, 1, 7, 2]
+        def s2 = [6, 4, 5, 1, 7, [4,5]]
+        def s3 = s1 + s2
+        assert s3 == [1, 2, 4, 5, 6, 7, [4,5]] as Set
+    }
+
+    void testSetSimpleMinus() {
+        Set s1 = [1, 1, 2, 2, 3, 3, 3, 4, 5, 3, 5]
+        def s2 = s1 - [1, 4]
+        assert s2 == [2, 3, 5] as Set
+        def s3 = s1 - 4.0
+        assert s3 == [1, 2, 3, 5] as Set
+    }
+
+    void testSetFlatten() {
+        Set orig = [[[4, 5, 6, [46, 7, "erer"] as Set] as Set, 4, [3, 6, 78] as Set] as Set, 4]
+        Set flat = orig.flatten()
+        assert flat == [3, 4, 5, 6, 7, 46, 78, "erer"] as Set
+    }
+
+    void testFlattenSetOfMapsWithClosure() {
+        Set orig = [[a:1, b:2], [c:3, d:4]] as Set
+        Set flat = orig.flatten{ it instanceof Map ? it.values() : it }
+        assert flat == [1, 2, 3 ,4] as Set
+        flat = orig.flatten{ it instanceof Map ? it.keySet() : it }
+        assert flat == ["a", "b", "c", "d"] as Set
+    }
+
+    void testSetEquality() {
+        def a = [1, 'a', null] as Set
+        def b = ['a', null, 1] as Set
+        assert a == a
+        assert a.equals(a)
+        assert a == b
+        assert a.equals(b)
+    }
+}
