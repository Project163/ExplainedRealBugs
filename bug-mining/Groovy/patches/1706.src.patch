diff --git a/src/main/groovy/json/JsonOutput.groovy b/src/main/groovy/json/JsonOutput.groovy
index 458ee0045e..8704f913f2 100644
--- a/src/main/groovy/json/JsonOutput.groovy
+++ b/src/main/groovy/json/JsonOutput.groovy
@@ -139,10 +139,12 @@ class JsonOutput {
      * @return a JSON object representation for a map
      */
     static String toJson(Map m) {
-        if(m.containsKey(null)) {
-            throw new IllegalArgumentException('Null key for a Map not allowed')
-        }
-        "{" + m.collect { k, v -> toJson(k.toString()) + ':' + toJson(v) }.join(',') + "}"
+        "{" + m.collect { k, v ->
+                if (k == null) {
+                    throw new IllegalArgumentException('Null key for a Map not allowed')
+                }
+                toJson(k.toString()) + ':' + toJson(v)
+        }.join(',') + "}"
     }
 
     /**
diff --git a/src/test/groovy/json/JsonOutputTest.groovy b/src/test/groovy/json/JsonOutputTest.groovy
index 3bf3b7fbe7..6dd1da716b 100644
--- a/src/test/groovy/json/JsonOutputTest.groovy
+++ b/src/test/groovy/json/JsonOutputTest.groovy
@@ -287,6 +287,12 @@ class JsonOutputTest extends GroovyTestCase {
             toJson([(null): 1])
         }
     }
+
+    void testGROOVY5247() {
+        def m = new TreeMap()
+        m.a = 1
+        assert toJson(m) == '{"a":1}'
+    }
 }
 
 @Canonical
