diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index c7ba17ae20..cd21a3150c 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -4322,7 +4322,7 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
         for (Object element : elements) {
             if (element instanceof Collection) {
                 flatten((Collection) element, addTo);
-            } else if (element.getClass().isArray()) {
+            } else if (element != null && element.getClass().isArray()) {
                 flatten(DefaultTypeTransformation.arrayAsCollection(element), addTo);
             } else {
                 // found a leaf
@@ -4351,7 +4351,7 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
         for (Object element : elements) {
             if (element instanceof Collection) {
                 flatten((Collection) element, addTo, flattenUsing);
-            } else if (element.getClass().isArray()) {
+            } else if (element != null && element.getClass().isArray()) {
                 flatten(DefaultTypeTransformation.arrayAsCollection(element), addTo, flattenUsing);
             } else {
                 Object flattened = flattenUsing.call(new Object[]{element});
diff --git a/src/test/groovy/ListTest.groovy b/src/test/groovy/ListTest.groovy
index 46b9ef94eb..9f43bc2da2 100644
--- a/src/test/groovy/ListTest.groovy
+++ b/src/test/groovy/ListTest.groovy
@@ -219,10 +219,11 @@ class ListTest extends GroovyTestCase {
         assert (b == a && a == [1, "foo", (short)3, 4L])
     }
 
+    // incorporates GROOVY-2904 and GROOVY-3102
     void testListFlatten() {
-        def orig = [[[4, 5, 6, [46, 7, "erer"]], 4, [3, 6, 78]], 4]
+        def orig = [[[4, 5, 6, [46, 7, "erer"]], null, 4, [3, 6, 78]], 4]
         def flat = orig.flatten()
-        assert flat == [4, 5, 6, 46, 7, "erer", 4, 3, 6, 78, 4]
+        assert flat == [4, 5, 6, 46, 7, "erer", null, 4, 3, 6, 78, 4]
     }
     
     void testSetFlatten() {
@@ -243,8 +244,9 @@ class ListTest extends GroovyTestCase {
         assert flat == ["o", "n", "e", "t", "w", "o"]
     }
 
+    // incorporates GROOVY-2904 and GROOVY-3102
     void testFlattenListWithSuppliedClosure() {
-        def orig = [[[4, 5, 6, [46, 7, "erer"]], 4, [3, 6, 78]], 4]
+        def orig = [[[4, 5, 6, [46, 7, "erer"]], null, 4, [3, 6, 78]], 4]
         def flat = orig.flatten{ it.iterator().toList() }
         assert flat == [4, 5, 6, 46, 7, "e", "r", "e", "r", 4, 3, 6, 78, 4]
     }
