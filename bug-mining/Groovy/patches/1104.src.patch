diff --git a/src/main/groovy/inspect/swingui/AstBrowser.groovy b/src/main/groovy/inspect/swingui/AstBrowser.groovy
index 2010c1320f..3d84be3b46 100644
--- a/src/main/groovy/inspect/swingui/AstBrowser.groovy
+++ b/src/main/groovy/inspect/swingui/AstBrowser.groovy
@@ -46,10 +46,12 @@ public class AstBrowser {
 
     private inputArea, rootElement
     boolean showScriptFreeForm, showScriptClass
+    GroovyClassLoader classLoader
 
-    AstBrowser(inputArea, rootElement) {
+    AstBrowser(inputArea, rootElement, classLoader) {
         this.inputArea = inputArea
         this.rootElement = rootElement
+        this.classLoader = classLoader
     }
 
     def swing, frame
@@ -64,7 +66,7 @@ public class AstBrowser {
                 println "File $args[0] cannot be found."
             } else {
                 UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); 
-                new AstBrowser(null, null).run({file.text}, file.path)
+                new AstBrowser(null, null, new GroovyClassLoader()).run({file.text}, file.path)
             }
         }
     }
@@ -197,7 +199,7 @@ public class AstBrowser {
 
     void compile(node, swing, String script, int compilePhase) {
         frame.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR))
-        def adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: showScriptFreeForm, showScriptClass: showScriptClass)
+        def adapter = new ScriptToTreeNodeAdapter(classLoader, showScriptFreeForm, showScriptClass)
         node.setRoot(adapter.compile(script, compilePhase))
         frame.setCursor(Cursor.defaultCursor)
     }
diff --git a/src/main/groovy/inspect/swingui/ScriptToTreeNodeAdapter.groovy b/src/main/groovy/inspect/swingui/ScriptToTreeNodeAdapter.groovy
index 1c8257675b..8cda79a7e5 100644
--- a/src/main/groovy/inspect/swingui/ScriptToTreeNodeAdapter.groovy
+++ b/src/main/groovy/inspect/swingui/ScriptToTreeNodeAdapter.groovy
@@ -51,6 +51,7 @@ class ScriptToTreeNodeAdapter {
 
     def static Properties classNameToStringForm
     boolean showScriptFreeForm, showScriptClass
+    final GroovyClassLoader classLoader
 
     static {
         URL url =  ClassLoader.getSystemResource("groovy/inspect/swingui/AstBrowserProperties.groovy")
@@ -68,6 +69,12 @@ class ScriptToTreeNodeAdapter {
             }
         }
     }
+    
+    def ScriptToTreeNodeAdapter(classLoader, showScriptFreeForm, showScriptClass) {
+        this.classLoader = classLoader
+        this.showScriptFreeForm = showScriptFreeForm
+        this.showScriptClass = showScriptClass
+    }
 
     /**
     * Performs the conversion from script to TreeNode.
@@ -79,7 +86,6 @@ class ScriptToTreeNodeAdapter {
     */
     public TreeNode compile(String script, int compilePhase) {
         def scriptName = "script" + System.currentTimeMillis() + ".groovy"
-        GroovyClassLoader classLoader = new GroovyClassLoader()
         GroovyCodeSource codeSource = new GroovyCodeSource(script, scriptName, "/groovy/script")
         CompilationUnit cu = new CompilationUnit(CompilerConfiguration.DEFAULT, codeSource.codeSource, classLoader)
         TreeNodeBuildingNodeOperation operation = new TreeNodeBuildingNodeOperation(this, showScriptFreeForm, showScriptClass)
diff --git a/src/main/groovy/ui/Console.groovy b/src/main/groovy/ui/Console.groovy
index 5833e5d14a..e067b04a56 100644
--- a/src/main/groovy/ui/Console.groovy
+++ b/src/main/groovy/ui/Console.groovy
@@ -645,7 +645,7 @@ class Console implements CaretListener, HyperlinkListener, ComponentListener {
     }
 
     void inspectAst(EventObject evt = null) {
-        new AstBrowser(inputArea, rootElement).run({ inputArea.getText() } )
+        new AstBrowser(inputArea, rootElement, shell.getClassLoader()).run({ inputArea.getText() } )
     }
 
     void largerFont(EventObject evt = null) {
diff --git a/src/test/groovy/inspect/swingui/ScriptToTreeNodeAdapterTest.groovy b/src/test/groovy/inspect/swingui/ScriptToTreeNodeAdapterTest.groovy
index bde888ad0c..00d99dedfe 100644
--- a/src/test/groovy/inspect/swingui/ScriptToTreeNodeAdapterTest.groovy
+++ b/src/test/groovy/inspect/swingui/ScriptToTreeNodeAdapterTest.groovy
@@ -30,13 +30,14 @@ import junit.framework.AssertionFailedError
  */
 public class ScriptToTreeNodeAdapterTest extends GroovyTestCase {
 
+     def classLoader = new GroovyClassLoader()
     /**
      * Asserts that a given script produces the expected tree like
      * structure.
      */
 
      def assertTreeStructure(String script, List<Closure> specification) {
-         ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: true, showScriptClass: true)
+         ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(classLoader, true, true)
          assertTreeStructure(script, specification, adapter)
      }
      
@@ -169,7 +170,7 @@ public class ScriptToTreeNodeAdapterTest extends GroovyTestCase {
 
     public void testNamedArgumentListExpression() {
         def script = "new String(foo: 'bar', baz: 'qux')"
-        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: true, showScriptClass: true)
+        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(classLoader, true, true)
         TreeNode root = adapter.compile(script, Phases.SEMANTIC_ANALYSIS)
 
         def namedArgList = root.children()?.find {
@@ -340,7 +341,7 @@ public class ScriptToTreeNodeAdapterTest extends GroovyTestCase {
     }
 
     public void testScriptWithAdapterThatLoadsClassButNotFreeForm() {
-        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: false, showScriptClass: true)
+        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(classLoader, false, true)
 
         // since free standing script is not being loaded, it should fail
         shouldFail(AssertionFailedError) {
@@ -369,7 +370,7 @@ public class ScriptToTreeNodeAdapterTest extends GroovyTestCase {
     }
 
     public void testScriptWithAdapterThatLoadsFreeFormButNotClass() {
-        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: true, showScriptClass: false)
+        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(classLoader, true, false)
 
         // since free standing script is being loaded, it should go through
         assertTreeStructure(
@@ -398,7 +399,7 @@ public class ScriptToTreeNodeAdapterTest extends GroovyTestCase {
     }
 
     public void testScriptWithAdapterThatLoadsNitherFreeFormNorClass() {
-        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(showScriptFreeForm: false, showScriptClass: false)
+        ScriptToTreeNodeAdapter adapter = new ScriptToTreeNodeAdapter(classLoader, false, false)
 
         // since free standing script is not being loaded, it should fail
         shouldFail(AssertionFailedError) {
