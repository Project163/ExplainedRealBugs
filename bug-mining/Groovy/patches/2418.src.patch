diff --git a/src/main/groovy/grape/GrapeIvy.groovy b/src/main/groovy/grape/GrapeIvy.groovy
index eca2fd173a..b87c13e33c 100644
--- a/src/main/groovy/grape/GrapeIvy.groovy
+++ b/src/main/groovy/grape/GrapeIvy.groovy
@@ -352,17 +352,17 @@ class GrapeIvy implements GrapeEngine {
         addExcludesIfNeeded(args, md)
 
         for (IvyGrabRecord grabRecord : grabRecords) {
-            DefaultDependencyDescriptor dd = new DefaultDependencyDescriptor(md,
-                    grabRecord.mrid, grabRecord.force, grabRecord.changing, grabRecord.transitive)
             def conf = grabRecord.conf ?: ['*']
-            conf.each {dd.addDependencyConfiguration('default', it)}
-            if (grabRecord.classifier || grabRecord.ext) {
-                def dad = new DefaultDependencyArtifactDescriptor(dd,
-                      grabRecord.mrid.name, grabRecord.type ?: 'jar', grabRecord.ext ?: 'jar', null, grabRecord.classifier ? [classifier:grabRecord.classifier] : null)
-                conf.each { dad.addConfiguration(it) }
-                dd.addDependencyArtifact('default', dad)
+            DefaultDependencyDescriptor dd = md.dependencies.find {it.dependencyRevisionId.equals(grabRecord.mrid)}
+            if (dd) {
+                createAndAddDependencyArtifactDescriptor(dd, grabRecord, conf)
+            } else {
+                dd = new DefaultDependencyDescriptor(md, grabRecord.mrid, grabRecord.force,
+                        grabRecord.changing, grabRecord.transitive)
+                conf.each {dd.addDependencyConfiguration('default', it)}
+                createAndAddDependencyArtifactDescriptor(dd, grabRecord, conf)
+                md.addDependency(dd)
             }
-            md.addDependency(dd)
         }
 
        // resolve grab and dependencies
@@ -432,6 +432,15 @@ class GrapeIvy implements GrapeEngine {
         return report
     }
 
+    private void createAndAddDependencyArtifactDescriptor(DefaultDependencyDescriptor dd, IvyGrabRecord grabRecord, List<String> conf) {
+        if (conf[0]!="optional" || grabRecord.classifier) {  // for some unknown reason optional dependencies should not have an artifactDescriptor
+            def dad = new DefaultDependencyArtifactDescriptor(dd,
+                    grabRecord.mrid.name, grabRecord.type ?: 'jar', grabRecord.ext ?: 'jar', null, grabRecord.classifier ? [classifier: grabRecord.classifier] : null)
+            conf.each { dad.addConfiguration(it) }
+            dd.addDependencyArtifact('default', dad)
+        }
+    }
+
     public void uninstallArtifact(String group, String module, String rev) {
         // TODO consider transitive uninstall as an option
         Pattern ivyFilePattern = ~/ivy-(.*)\.xml/ //TODO get pattern from ivy conf
@@ -665,4 +674,5 @@ class IvyGrabRecord {
             && (ext == o.ext)
             && (type == o.type))
     }
+
 }
diff --git a/src/test/groovy/grape/GrapeIvyTest.groovy b/src/test/groovy/grape/GrapeIvyTest.groovy
index 770c2f9066..bd28516a03 100644
--- a/src/test/groovy/grape/GrapeIvyTest.groovy
+++ b/src/test/groovy/grape/GrapeIvyTest.groovy
@@ -302,6 +302,7 @@ class GrapeIvyTest extends CompilableTestSupport {
         assert jars == coreJars + optionalJars
     }
 
+    
     void testTransitiveShorthandControl() {
         // BeanUtils is a transitive dependency for Digester
         assertScript '''
@@ -357,4 +358,31 @@ class GrapeIvyTest extends CompilableTestSupport {
 
         assert Grape.getInstance().ivyInstance.settings.defaultResolver.name == 'downloadGrapes'
     }
+
+    /**
+     * there are some artifacts deployed without *and* with
+     */
+    public void testClassieferAndNonclassifierOnSameArtifact() {
+        GroovyClassLoader loader = new GroovyClassLoader()
+        Grape.grab(groupId:'org.neo4j', artifactId:'neo4j-kernel', version:'2.0.0-RC1', classLoader:loader)
+        Grape.grab(groupId:'org.neo4j', artifactId:'neo4j-kernel', version:'2.0.0-RC1', classifier:'tests', classLoader:loader)
+
+        //Grape.grab(groupId:'org.apache.poi', artifactId:'poi', version:'3.7', classLoader:loader)
+        def jars = loader.getURLs().collect {URL it -> it.getPath().split('/')[-1]}
+        // because poi asks for log4j 1.2.13, but we already have 1.1.3 so it won't be loaded
+        assert jars.contains ("neo4j-kernel-2.0.0-RC1.jar")
+        assert jars.contains ("neo4j-kernel-2.0.0-RC1-tests.jar")
+
+        // different ordering of deps
+        loader = new GroovyClassLoader()
+        Grape.grab(groupId:'org.neo4j', artifactId:'neo4j-kernel', version:'2.0.0-RC1', classifier:'tests', classLoader:loader)
+        Grape.grab(groupId:'org.neo4j', artifactId:'neo4j-kernel', version:'2.0.0-RC1', classLoader:loader)
+
+        //Grape.grab(groupId:'org.apache.poi', artifactId:'poi', version:'3.7', classLoader:loader)
+        jars = loader.getURLs().collect {URL it -> it.getPath().split('/')[-1]}
+        // because poi asks for log4j 1.2.13, but we already have 1.1.3 so it won't be loaded
+        assert jars.contains ("neo4j-kernel-2.0.0-RC1.jar")
+        assert jars.contains ("neo4j-kernel-2.0.0-RC1-tests.jar")
+    }
+
 }
