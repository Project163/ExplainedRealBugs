diff --git a/src/main/java/org/codehaus/groovy/ast/ClassNode.java b/src/main/java/org/codehaus/groovy/ast/ClassNode.java
index 8bb69d8ae1..945eacf7ac 100644
--- a/src/main/java/org/codehaus/groovy/ast/ClassNode.java
+++ b/src/main/java/org/codehaus/groovy/ast/ClassNode.java
@@ -1483,6 +1483,9 @@ public class ClassNode extends AnnotatedNode {
     public GenericsType asGenericsType() {
         if (!isGenericsPlaceHolder()) {
             return new GenericsType(this);
+        } else if (genericsTypes != null
+                && genericsTypes[0].getUpperBounds() != null) {
+            return genericsTypes[0];
         } else {
             ClassNode upper = (redirect != null ? redirect : this);
             return new GenericsType(this, new ClassNode[]{upper}, null);
diff --git a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
index 838b2e5c34..e02a2fa84b 100644
--- a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
+++ b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingSupport.java
@@ -1915,10 +1915,10 @@ public abstract class StaticTypeCheckingSupport {
         }
 
         if (type.getGenericsTypes()[0] != gt[0]) { // convert T to X
-            ClassNode cn = make(gt[0].getName());
-            cn.setRedirect(gt[0].getType());
+            ClassNode cn = make(gt[0].getName()) , erasure = getCombinedBoundType(gt[0]);
             cn.setGenericsPlaceHolder(true);
             cn.setGenericsTypes(gt);
+            cn.setRedirect(erasure);
             return cn;
         }
 
diff --git a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index fdc7b59d60..322a828627 100644
--- a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -3118,7 +3118,7 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
             if (paramTypes == null) {
                 ClassNode targetType = target.getType();
                 if (targetType != null && targetType.isGenericsPlaceHolder())
-                    targetType = getCombinedBoundType(targetType.getGenericsTypes()[0]);
+                    targetType = getCombinedBoundType(targetType.asGenericsType());
                 targetType = applyGenericsContext(context, targetType); // fill place-holders
                 ClassNode[] samParamTypes = GenericsUtils.parameterizeSAM(targetType).getV1();
 
diff --git a/src/test/groovy/transform/stc/MethodReferenceTest.groovy b/src/test/groovy/transform/stc/MethodReferenceTest.groovy
index c0f3df696f..f5510ae3f7 100644
--- a/src/test/groovy/transform/stc/MethodReferenceTest.groovy
+++ b/src/test/groovy/transform/stc/MethodReferenceTest.groovy
@@ -301,6 +301,25 @@ final class MethodReferenceTest {
 
             test(new ArrayDeque<>())
         '''
+
+        assertScript shell, '''
+            @Grab('org.apache.commons:commons-collections4:4.4')
+            import org.apache.commons.collections4.*
+
+            @CompileStatic
+            def test(Iterable<String> x, ArrayDeque<String> y) {
+                CollectionUtils.forAllButLastDo(x,y::addFirst)
+                IterableUtils.forEachButLast(x,y::addFirst)
+                Iterator<String> z = x.iterator()
+                IteratorUtils.forEachButLast(z,y::addFirst)
+            }
+
+            Iterable  <String> x = ['foo','bar','baz']
+            ArrayDeque<String> y = []
+            def z = test(x,y)
+
+            assert y.join('') == 'barfoo'*3 && z == 'baz'
+        '''
     }
 
     @Test // instance::instanceMethod -- GROOVY-9813
