diff --git a/src/main/org/codehaus/groovy/control/SourceUnit.java b/src/main/org/codehaus/groovy/control/SourceUnit.java
index 73e5fb4048..ff4cd3e88d 100644
--- a/src/main/org/codehaus/groovy/control/SourceUnit.java
+++ b/src/main/org/codehaus/groovy/control/SourceUnit.java
@@ -67,8 +67,10 @@ import org.codehaus.groovy.control.messages.SyntaxErrorMessage;
 import org.codehaus.groovy.syntax.*;
 import org.codehaus.groovy.tools.Utilities;
 
+import antlr.CharScanner;
 import antlr.MismatchedTokenException;
 import antlr.NoViableAltException;
+import antlr.NoViableAltForCharException;
 
 import com.thoughtworks.xstream.XStream;
 
@@ -182,34 +184,27 @@ public class SourceUnit extends ProcessingUnit {
      * that returns true if parse() failed with an unexpected EOF.
      */
     public boolean failedWithUnexpectedEOF() {
-        boolean result = false;
+    	// Implementation note - there are several ways for the Groovy compiler
+    	// to report an unexpected EOF. Perhaps this implementation misses some.
+    	// If you find another way, please add it.
         if (getErrorCollector().hasErrors()) {
-            // Classic support
             Message last = (Message) getErrorCollector().getLastError();
+            Throwable cause = null;
             if (last instanceof SyntaxErrorMessage) {
-                SyntaxException cause = ((SyntaxErrorMessage) last).getCause();
-                if (cause instanceof UnexpectedTokenException) {
-                    Token unexpected = ((UnexpectedTokenException) cause).getUnexpectedToken();
-                    if (unexpected.isA(Types.EOF)) {
-                        result = true;
-                    }
-                }
+                cause = ((SyntaxErrorMessage) last).getCause().getCause();
             }
-            // JSR support
-            if (last instanceof ExceptionMessage) {
-                ExceptionMessage exceptionMessage = (ExceptionMessage) last;
-                Exception cause = exceptionMessage.getCause();
-                if (cause instanceof NoViableAltException) {
-                    NoViableAltException antlrException = (NoViableAltException) cause;
-                    result = isEofToken(antlrException.token);
-                }
-                if (cause instanceof MismatchedTokenException) {
-                    MismatchedTokenException antlrException = (MismatchedTokenException) cause;
-                    result = isEofToken(antlrException.token);
+            if (cause != null) {
+            	if (cause instanceof NoViableAltException) {
+                    return isEofToken(((NoViableAltException) cause).token);
+            	} else if (cause instanceof NoViableAltForCharException) {
+            		char badChar = ((NoViableAltForCharException) cause).foundChar;
+            		return badChar == CharScanner.EOF_CHAR;
+                } else if (cause instanceof MismatchedTokenException) {
+                    return isEofToken(((MismatchedTokenException) cause).token);
                 }
             }
         }
-        return result;    
+        return false;    
     }
 
     protected boolean isEofToken(antlr.Token token) {
diff --git a/src/main/org/codehaus/groovy/syntax/UnexpectedTokenException.java b/src/main/org/codehaus/groovy/syntax/UnexpectedTokenException.java
deleted file mode 100644
index 9092ee4797..0000000000
--- a/src/main/org/codehaus/groovy/syntax/UnexpectedTokenException.java
+++ /dev/null
@@ -1,107 +0,0 @@
-package org.codehaus.groovy.syntax;
-
-import org.codehaus.groovy.syntax.Types;
-import org.codehaus.groovy.syntax.Token;
-import org.codehaus.groovy.syntax.ParserException;
-
-public class UnexpectedTokenException extends ParserException {
-    private Token unexpectedToken;
-    private int[] expectedTypes;
-    private String comment;
-
-    public UnexpectedTokenException(Token token) {
-        this(token, null, null );
-    }
-    
-    public UnexpectedTokenException(Token token, int expectedType) {
-        this(token, new int[] { expectedType });
-    }
-    
-    public UnexpectedTokenException(Token token, int[] expectedTypes) {
-        this(token, expectedTypes, null );
-    }
-
-    public UnexpectedTokenException(Token token, int[] expectedTypes, String comment) {
-        super("Unexpected token", token);
-        this.unexpectedToken = token;
-        this.expectedTypes = expectedTypes;
-        this.comment       = comment;
-    }
-
-    public Token getUnexpectedToken() {
-        return this.unexpectedToken;
-    }
-
-    public int[] getExpectedTypes() {
-        return this.expectedTypes;
-    }
-
-    public String getUnexpectedTokenText( ) {
-        String text = null;
-        if( this.unexpectedToken != null )
-        {
-            text = this.unexpectedToken.getText();
-        }
-
-        if( text == null )
-        {
-            text = "";
-        }
-
-        return text;
-    }
-
-    public String getMessage() {
-        StringBuffer message = new StringBuffer();
-
-        if( expectedTypes != null ) {
-            message.append( "expected " );
-
-            if (this.expectedTypes.length == 1) {
-                message.append( Types.getDescription(this.expectedTypes[0]) );
-            }
-            else {
-                message.append("one of { ");
-    
-                for (int i = 0; i < expectedTypes.length; ++i) {
-                    message.append( Types.getDescription(this.expectedTypes[i]) );
-    
-                    if ((i + 1) < expectedTypes.length) {
-                        if( expectedTypes.length > 2 ) {
-                            message.append(", ");
-                        }
-                        else {
-                            message.append(" ");
-                        }
-                    }
-
-                    if ((i + 2) == expectedTypes.length) {
-                        message.append("or ");
-                    }
-                }
-    
-                message.append(" }");
-            }
-
-            message.append( "; found '" );
-        }
-        else {
-            message.append( "could not use '" );
-        }
-
-        message.append( getUnexpectedTokenText() ).append( "'" );
-        if( unexpectedToken != null ) {
-            message.append(" at " + unexpectedToken.getStartLine() + ":" + unexpectedToken.getStartColumn());
-        }
-        else {
-            message.append(" at unknown location (probably end of file)");
-        }
-
-        if( comment != null ) {
-            message.append( "; " );
-            message.append( comment );
-        }
-
-        return message.toString();
-    }
-}
