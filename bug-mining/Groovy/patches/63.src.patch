diff --git a/src/main/org/codehaus/groovy/classgen/BytecodeHelper.java b/src/main/org/codehaus/groovy/classgen/BytecodeHelper.java
index 002108c1b1..af926d2c02 100644
--- a/src/main/org/codehaus/groovy/classgen/BytecodeHelper.java
+++ b/src/main/org/codehaus/groovy/classgen/BytecodeHelper.java
@@ -253,8 +253,12 @@ public class BytecodeHelper implements Constants {
                 cv.visitInsn(ICONST_5);
                 break;
             default :
-                cv.visitIntInsn(BIPUSH, value);
-                break;
+                if (value > Byte.MIN_VALUE && value < Byte.MAX_VALUE) {
+                    cv.visitIntInsn(BIPUSH, value);
+                }
+                else {
+                    cv.visitIntInsn(SIPUSH, value);
+                }
         }
     }
 
diff --git a/src/test/groovy/bugs/ByteIndexBug.groovy b/src/test/groovy/bugs/ByteIndexBug.groovy
new file mode 100644
index 0000000000..8b7182195e
--- /dev/null
+++ b/src/test/groovy/bugs/ByteIndexBug.groovy
@@ -0,0 +1,16 @@
+/**
+ * @author Robert Fuller 
+ * @version $Revision$
+ */
+class ByteIndexBug extends GroovyTestCase {
+     
+    void testBug() {
+		sb = new StringBuffer("<<<FOO\n")
+		for (j in 0..127){ // 126 is okay.
+			sb.append('$').append("{x}")
+		}
+		sb.append("\nFOO\n")
+		
+		new GroovyShell().evaluate(sb.toString(),"foo")
+	}
+}
