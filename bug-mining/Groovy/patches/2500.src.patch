diff --git a/src/main/org/codehaus/groovy/transform/AbstractASTTransformation.java b/src/main/org/codehaus/groovy/transform/AbstractASTTransformation.java
index 5b25ee7c59..2639f5a82a 100644
--- a/src/main/org/codehaus/groovy/transform/AbstractASTTransformation.java
+++ b/src/main/org/codehaus/groovy/transform/AbstractASTTransformation.java
@@ -37,6 +37,7 @@ import org.objectweb.asm.Opcodes;
 
 import java.util.ArrayList;
 import java.util.Arrays;
+import java.util.HashMap;
 import java.util.LinkedList;
 import java.util.List;
 import java.util.Map;
@@ -147,11 +148,13 @@ public abstract class AbstractASTTransformation implements Opcodes, ASTTransform
             for (ClassNode cn : excludeTypes) {
                 List<ClassNode> remaining = new LinkedList<ClassNode>();
                 remaining.add(cn);
+                Map updatedGenericsSpec = new HashMap(genericsSpec);
                 while (!remaining.isEmpty()) {
                     ClassNode next = remaining.remove(0);
                     if (!next.equals(ClassHelper.OBJECT_TYPE)) {
+                        updatedGenericsSpec = Verifier.createGenericsSpec(next, updatedGenericsSpec);
                         for (MethodNode mn : next.getMethods()) {
-                            String md = correctToGenericsSpec(genericsSpec, mn).getTypeDescriptor();
+                            String md = correctToGenericsSpec(updatedGenericsSpec, mn).getTypeDescriptor();
                             if (md.equals(descriptor)) return true;
                         }
                         remaining.addAll(Arrays.asList(next.getInterfaces()));
@@ -162,11 +165,13 @@ public abstract class AbstractASTTransformation implements Opcodes, ASTTransform
             for (ClassNode cn : includeTypes) {
                 List<ClassNode> remaining = new LinkedList<ClassNode>();
                 remaining.add(cn);
+                Map updatedGenericsSpec = new HashMap(genericsSpec);
                 while (!remaining.isEmpty()) {
                     ClassNode next = remaining.remove(0);
                     if (!next.equals(ClassHelper.OBJECT_TYPE)) {
+                        updatedGenericsSpec = Verifier.createGenericsSpec(next, updatedGenericsSpec);
                         for (MethodNode mn : next.getMethods()) {
-                            String md = correctToGenericsSpec(genericsSpec, mn).getTypeDescriptor();
+                            String md = correctToGenericsSpec(updatedGenericsSpec, mn).getTypeDescriptor();
                             if (md.equals(descriptor)) return false;
                         }
                         remaining.addAll(Arrays.asList(next.getInterfaces()));
diff --git a/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy b/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
index 6bdee978f4..203e06b5f1 100644
--- a/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
+++ b/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
@@ -470,18 +470,25 @@ class DelegateTransformTest extends CompilableTestSupport {
     // GROOVY-6329
     void testIncludeAndExcludeByType() {
         assertScript """
-            interface OddInclusions {
-                boolean addAll(Collection<? extends Integer> c)
-                Integer remove(int index)
+            interface OddInclusionsTU<T, U> {
+                boolean addAll(Collection<? extends T> t)
+                boolean add(U u)
+                T remove(int index)
             }
+
+            interface OddInclusionsU<U> extends OddInclusionsTU<Integer, U> { }
+
+            interface OddInclusions extends OddInclusionsU<Integer> { }
+
             interface OtherInclusions {
                 void clear()
             }
+
             interface EvenExclusions extends OddInclusions, OtherInclusions { }
 
             class MixedNumbers {
                 // collection variant of addAll and remove will work on odd list
-                @Delegate(includeTypes=OddInclusions) List<Integer> odds = [1, 3, 5]
+                @Delegate(includeTypes=OddInclusions) List<Integer> odds = [1, 3]
                 // clear will work on other list
                 @Delegate(includeTypes=OtherInclusions) List<Integer> others = [0]
                 // all other methods will work on even list
@@ -490,7 +497,8 @@ class DelegateTransformTest extends CompilableTestSupport {
             }
 
             def list = new MixedNumbers()
-            assert list.all == [2, 4, 6, 1, 3, 5, 0]
+            assert list.all == [2, 4, 6, 1, 3, 0]
+            list.add(5)
             list.addAll([7, 9])
             list.addAll(1, [8])
             list.remove(0)
