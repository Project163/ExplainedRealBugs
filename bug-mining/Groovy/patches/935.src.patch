diff --git a/src/main/org/codehaus/groovy/runtime/callsite/ConstructorMetaMethodSite.java b/src/main/org/codehaus/groovy/runtime/callsite/ConstructorMetaMethodSite.java
index 1bd976576f..210f1742bf 100644
--- a/src/main/org/codehaus/groovy/runtime/callsite/ConstructorMetaMethodSite.java
+++ b/src/main/org/codehaus/groovy/runtime/callsite/ConstructorMetaMethodSite.java
@@ -1,7 +1,7 @@
 package org.codehaus.groovy.runtime.callsite;
 
 import groovy.lang.GroovyRuntimeException;
-import groovy.lang.MetaClass;
+import groovy.lang.MetaClassImpl;
 import groovy.lang.MetaMethod;
 import org.codehaus.groovy.runtime.MetaClassHelper;
 import org.codehaus.groovy.runtime.ScriptBytecodeAdapter;
@@ -15,8 +15,11 @@ import org.codehaus.groovy.runtime.ScriptBytecodeAdapter;
 */
 public class ConstructorMetaMethodSite extends MetaMethodSite {
 
-    public ConstructorMetaMethodSite(CallSite site, MetaClass metaClass, MetaMethod method, Class [] params) {
+    private final int version;
+
+    public ConstructorMetaMethodSite(CallSite site, MetaClassImpl metaClass, MetaMethod method, Class [] params) {
         super(site, metaClass, method, params);
+        this.version = metaClass.getVersion();
     }
 
     public final Object invoke(Object receiver, Object [] args) throws Throwable{
@@ -30,6 +33,7 @@ public class ConstructorMetaMethodSite extends MetaMethodSite {
 
     public final Object callConstructor(Object receiver, Object[] args) throws Throwable {
         if (receiver == metaClass.getTheClass() // meta class match receiver
+           && ((MetaClassImpl)metaClass).getVersion() == version // metaClass still be valid
            && MetaClassHelper.sameClasses(params, args) )  
         {
             MetaClassHelper.unwrap(args);
diff --git a/src/main/org/codehaus/groovy/runtime/callsite/ConstructorSite.java b/src/main/org/codehaus/groovy/runtime/callsite/ConstructorSite.java
index aee8d41bbd..16ecd08ea5 100644
--- a/src/main/org/codehaus/groovy/runtime/callsite/ConstructorSite.java
+++ b/src/main/org/codehaus/groovy/runtime/callsite/ConstructorSite.java
@@ -26,16 +26,17 @@ import java.util.Map;
 public class ConstructorSite extends MetaClassSite {
     final CachedConstructor constructor;
     final Class [] params;
+    private final int version;
 
     public ConstructorSite(CallSite site, MetaClassImpl metaClass, CachedConstructor constructor, Class params[]) {
         super(site, metaClass);
         this.constructor = constructor;
         this.params = params;
+        this.version = metaClass.getVersion();
     }
 
     public Object callConstructor(Object receiver, Object[] args) throws Throwable {
-        if (receiver == metaClass.getTheClass() // meta class match receiver
-           && MetaClassHelper.sameClasses(params, args) ) 
+        if (checkCall(receiver, args)) 
         {   
             MetaClassHelper.unwrap(args);
             try {
@@ -48,6 +49,12 @@ public class ConstructorSite extends MetaClassSite {
           return CallSiteArray.defaultCallConstructor(this, receiver, args);
     }
 
+    protected final boolean checkCall(Object receiver, Object[] args) {
+    	return receiver == metaClass.getTheClass() // meta class match receiver
+            && ((MetaClassImpl)metaClass).getVersion() == version // metaClass still be valid
+            && MetaClassHelper.sameClasses(params, args);
+    }
+
     public static ConstructorSite createConstructorSite(CallSite site, MetaClassImpl metaClass, CachedConstructor constructor, Class[] params, Object[] args) {
         if (constructor.correctArguments(args) == args) {
             if (noWrappers(args)) {
@@ -71,8 +78,7 @@ public class ConstructorSite extends MetaClassSite {
         }
 
         public final Object callConstructor(Object receiver, Object[] args) throws Throwable {
-            if (receiver == metaClass.getTheClass() // meta class match receiver
-               && MetaClassHelper.sameClasses(params, args) ) 
+            if (checkCall(receiver, args)) 
             {
                 try {
                     return constructor.doConstructorInvoke(args);
@@ -95,8 +101,7 @@ public class ConstructorSite extends MetaClassSite {
         }
 
         public Object callConstructor(Object receiver, Object[] args) throws Throwable {
-            if (receiver == metaClass.getTheClass() // meta class match receiver
-               && MetaClassHelper.sameClasses(params, args) ) 
+            if (checkCall(receiver, args)) 
             {
                 try {
                     return constructor.invoke(args);
@@ -117,8 +122,7 @@ public class ConstructorSite extends MetaClassSite {
         }
 
         public final Object callConstructor(Object receiver, Object[] args) throws Throwable {
-            if (receiver == metaClass.getTheClass() // meta class match receiver
-               && MetaClassHelper.sameClasses(params, args) ) 
+            if (checkCall(receiver, args)) 
             {
                 final Object bean = constructor.invoke(NO_ARGS);
                 try {
diff --git a/src/main/org/codehaus/groovy/runtime/callsite/MetaClassConstructorSite.java b/src/main/org/codehaus/groovy/runtime/callsite/MetaClassConstructorSite.java
index 5e9387ddab..bce401f1d9 100644
--- a/src/main/org/codehaus/groovy/runtime/callsite/MetaClassConstructorSite.java
+++ b/src/main/org/codehaus/groovy/runtime/callsite/MetaClassConstructorSite.java
@@ -15,6 +15,7 @@
  */
 package org.codehaus.groovy.runtime.callsite;
 
+import org.codehaus.groovy.reflection.ClassInfo;
 import org.codehaus.groovy.runtime.ScriptBytecodeAdapter;
 
 import groovy.lang.GroovyRuntimeException;
@@ -28,13 +29,20 @@ import groovy.lang.MetaClass;
  * @author Alex Tkachman
 */
 public class MetaClassConstructorSite extends MetaClassSite {
+
+    private final ClassInfo classInfo;
+    private final int version;
+
     public MetaClassConstructorSite(CallSite site, MetaClass metaClass) {
         super(site, metaClass);
+        classInfo = ClassInfo.getClassInfo(metaClass.getTheClass());
+        version = classInfo.getVersion();
     }
 
     public Object callConstructor(Object receiver, Object[] args) throws Throwable {
         try {
-            if (receiver == metaClass.getTheClass())
+            if (receiver == metaClass.getTheClass()
+                && version == classInfo.getVersion()) // metaClass still be valid
                 return metaClass.invokeConstructor(args);
             else
               return CallSiteArray.defaultCallConstructor(this, receiver, args);
diff --git a/src/test/groovy/bugs/Groovy3424Bug.groovy b/src/test/groovy/bugs/Groovy3424Bug.groovy
new file mode 100644
index 0000000000..1c8dd5874e
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy3424Bug.groovy
@@ -0,0 +1,71 @@
+package groovy.bugs
+
+class Groovy3424Bug extends GroovyTestCase {
+
+    MetaClassRegistry registry
+    MetaClass originalMetaClass
+
+    void setUp() {
+        registry = GroovySystem.metaClassRegistry
+        originalMetaClass = registry.getMetaClass(Groovy3424Foo)
+    }
+
+    void tearDown() {
+        registry.setMetaClass(Groovy3424Foo, originalMetaClass)
+    }
+
+    void testCallSiteShouldBeUpdatedAfterProxyMetaClassIsSet() {
+        def newFoo = { -> new Groovy3424Foo() }
+
+        assert new Groovy3424Foo() instanceof Groovy3424Foo
+        assert newFoo() instanceof Groovy3424Foo
+
+        MetaClass mc = new Groovy3424ClassProxyMetaClass(registry, Groovy3424Foo, originalMetaClass)
+        registry.setMetaClass(Groovy3424Foo, mc)
+
+        assert 'constructor' == new Groovy3424Foo()
+        assert 'constructor' == newFoo()
+    }
+
+    void testExpandoCallSiteShouldBeUpdatedAfterProxyMetaClassIsSet() {
+        Groovy3424Foo.metaClass.constructor << { String test -> 'foo' }
+
+        def newFoo = { -> new Groovy3424Foo('test') }
+
+        assert 'foo' == new Groovy3424Foo('test')
+        assert 'foo' == newFoo()
+
+        MetaClass mc = new Groovy3424ClassProxyMetaClass(registry, Groovy3424Foo, originalMetaClass)
+        registry.setMetaClass(Groovy3424Foo, mc)
+
+        assert 'constructor' == new Groovy3424Foo('test')
+        assert 'constructor' == newFoo()
+    }
+
+    void testCallSiteShouldBeUpdatedAfterOriginalMetaClassIsRestored() {
+        def newFoo = { -> new Groovy3424Foo() }
+
+        MetaClass mc = new Groovy3424ClassProxyMetaClass(registry, Groovy3424Foo, originalMetaClass)
+        registry.setMetaClass(Groovy3424Foo, mc)
+
+        assert 'constructor' == new Groovy3424Foo()
+        assert 'constructor' == newFoo()
+
+        registry.setMetaClass(Groovy3424Foo, originalMetaClass)
+
+        assert new Groovy3424Foo() instanceof Groovy3424Foo
+        assert newFoo() instanceof Groovy3424Foo
+    }
+
+}
+
+class Groovy3424Foo {}
+
+class Groovy3424ClassProxyMetaClass extends ProxyMetaClass {
+    Groovy3424ClassProxyMetaClass(MetaClassRegistry metaClassRegistry, Class aClass, MetaClass adaptee) {
+        super(metaClassRegistry, aClass, adaptee)
+    }
+    public Object invokeConstructor(final Object[] arguments) {
+        'constructor'
+    }
+}
