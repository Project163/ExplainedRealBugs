diff --git a/src/main/groovy/servlet/AbstractHttpServlet.java b/src/main/groovy/servlet/AbstractHttpServlet.java
index ab4e81e197..092ad0ebf0 100644
--- a/src/main/groovy/servlet/AbstractHttpServlet.java
+++ b/src/main/groovy/servlet/AbstractHttpServlet.java
@@ -38,9 +38,17 @@
  */
 package groovy.servlet;
 
+import groovy.util.ResourceConnector;
+import groovy.util.ResourceException;
+
 import java.io.File;
+import java.io.IOException;
+import java.net.URL;
+import java.net.URLConnection;
 
+import javax.servlet.ServletConfig;
 import javax.servlet.ServletContext;
+import javax.servlet.ServletException;
 import javax.servlet.http.HttpServlet;
 import javax.servlet.http.HttpServletRequest;
 
@@ -49,7 +57,8 @@ import javax.servlet.http.HttpServletRequest;
  *
  * @author Christian Stein
  */
-public abstract class AbstractHttpServlet extends HttpServlet {
+public abstract class AbstractHttpServlet extends HttpServlet implements
+    ResourceConnector {
 
   /**
    * Content type of the HTTP response.
@@ -63,6 +72,31 @@ public abstract class AbstractHttpServlet extends HttpServlet {
   // public static final String INC_REQUEST_URI = "javax.servlet.include.request_uri";
   public static final String INC_SERVLET_PATH = "javax.servlet.include.servlet_path";
 
+  /**
+   * Servlet (or the web application) context.
+   */
+  protected ServletContext servletContext;
+
+  /**
+   * Interface method for ResourceContainer. This is used by the GroovyScriptEngine.
+   */
+  public URLConnection getResourceConnection(String name)
+      throws ResourceException {
+    try {
+      URL url = servletContext.getResource("/" + name);
+      if (url == null) {
+        url = servletContext.getResource("/WEB-INF/groovy/" + name);
+        if (url == null) {
+          throw new ResourceException("Resource " + name + " not found");
+        }
+      }
+      return url.openConnection();
+    }
+    catch (IOException ioe) {
+      throw new ResourceException("Problem reading resource " + name);
+    }
+  }
+
   /**
    * Returns the include-aware uri of the script or template file.
    * 
@@ -151,4 +185,9 @@ public abstract class AbstractHttpServlet extends HttpServlet {
     return file;
   }
 
+  public void init(ServletConfig config) throws ServletException {
+    super.init(config);
+    this.servletContext = config.getServletContext();
+  }
+
 }
diff --git a/src/main/groovy/servlet/GroovyServlet.java b/src/main/groovy/servlet/GroovyServlet.java
index 6533f54692..208c1fb93a 100644
--- a/src/main/groovy/servlet/GroovyServlet.java
+++ b/src/main/groovy/servlet/GroovyServlet.java
@@ -32,22 +32,18 @@
 package groovy.servlet;
 
 import groovy.lang.Binding;
-import groovy.lang.MetaClass;
 import groovy.lang.Closure;
+import groovy.lang.MetaClass;
 import groovy.util.GroovyScriptEngine;
-import groovy.util.ResourceConnector;
 import groovy.util.ResourceException;
 import groovy.util.ScriptException;
 
+import java.io.File;
 import java.io.IOException;
-import java.net.URL;
-import java.net.URLConnection;
 
 import javax.servlet.ServletConfig;
 import javax.servlet.ServletContext;
 import javax.servlet.ServletException;
-import javax.servlet.ServletRequest;
-import javax.servlet.ServletResponse;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
 
@@ -83,202 +79,132 @@ import org.codehaus.groovy.runtime.GroovyCategorySupport;
  *    <servlet-mapping>
  *      <servlet-name>Groovy</servlet-name>
  *      <url-pattern>*.groovy</url-pattern>
+ *      <url-pattern>*.gdo</url-pattern>
  *    </servlet-mapping>
  * </pre>
  *
  * <p>The URL pattern does not require the "*.groovy" mapping.  You can, for
  * example, make it more Struts-like but groovy by making your mapping "*.gdo".
  *
- * <p>Whatever your mapping, the GroovyServlet will check to see if your
- * URL ends with ".groovy" and, if it does not, it will strip your mapping
- * and append ".groovy".
- *
- * <p>NOTE!  The GroovyServlet only handles mappings of the *.* type, not the
- * path-like type of /groovy/*</p>
- *
  * @author Sam Pullara
  * @author Mark Turansky (markturansky at hotmail.com)
  * @author Guillaume Laforge
+ * @author Christian Stein
+ * 
+ * @see groovy.servlet.ServletBinding
  */
-public class GroovyServlet extends AbstractHttpServlet implements ResourceConnector {
-
-    // ------------------------------------------------------ instance variables
-
-    /**
-     * A constant for ".groovy" which gets appended to script paths as needed.
-     */
-    public static final String GROOVY_EXTENSION = ".groovy";
-
-    /**
-     * The context in which this servlet is executing
-     */
-    private ServletContext sc;
-
-    /**
-     * The classloader associated with this servlet
-     */
-    private static ClassLoader parent;
-
-    /**
-     * The script engine executing the Groovy scripts for this servlet
-     */
-    private static GroovyScriptEngine gse;
-
-    // ---------------------------------------------------------- public methods
-
-    //
-    // (cstein) Do NOT override GenericServlet - using super.init() instead
-    //
-    //    /**
-    //     * Returns the ServletContext for this servlet
-    //     */
-    //    public ServletContext getServletContext() {
-    //        return sc;
-    //    }
-
-    /**
-     * Initialize the GroovyServlet.
-     *
-     * @throws ServletException if init() method defined in super class 
-     * javax.servlet.GenericServlet throws it
-     */
-    public void init(ServletConfig config) throws ServletException {
-        super.init(config);
-
-        // Use reflection, some containers don't load classes properly
-        MetaClass.setUseReflection(true);
-
-        // Get the servlet context
-        sc = config.getServletContext();
-        sc.log("Groovy servlet initialized");
-
-        // Ensure that we use the correct classloader so that we can find
-        // classes in an application server.
-        //
-        // TODO (cstein) Is parent used? Somewhere else then here?
-        //
-        parent = Thread.currentThread().getContextClassLoader();
-        if (parent == null)
-            parent = GroovyServlet.class.getClassLoader();
-
-        // Set up the scripting engine
-        gse = new GroovyScriptEngine(this);
+public class GroovyServlet extends AbstractHttpServlet {
+
+  /**
+   * The context in which this servlet is executing
+   */
+  private ServletContext sc;
+
+  /**
+   * The script engine executing the Groovy scripts for this servlet
+   */
+  private static GroovyScriptEngine gse;
+
+  /**
+   * Initialize the GroovyServlet.
+   *
+   * @throws ServletException if init() method defined in super class 
+   * javax.servlet.GenericServlet throws it
+   */
+  public void init(ServletConfig config) throws ServletException {
+    super.init(config);
+
+    // Use reflection, some containers don't load classes properly
+    MetaClass.setUseReflection(true);
+
+    // Get the servlet context
+    sc = servletContext;
+    sc.log("Groovy servlet initialized");
+
+    // Set up the scripting engine
+    gse = new GroovyScriptEngine(this);
+  }
+
+  /**
+   * Handle web requests to the GroovyServlet
+   */
+  public void service(HttpServletRequest request,
+      HttpServletResponse response) throws IOException {
+
+    // Get the Groovy script file - include aware (GROOVY-815)
+    File file = super.getScriptUriAsFile(request, sc);
+    if (!file.exists()) {
+      response.sendError(HttpServletResponse.SC_NOT_FOUND, "Not found!");
+      return; // throw new IOException(file.getAbsolutePath());
     }
-
-    /**
-     * Interface method for ResourceContainer. This is used by the GroovyScriptEngine.
-     */
-    public URLConnection getResourceConnection(String name) throws ResourceException {
-        try {
-            URL url = sc.getResource("/" + name);
-            if (url == null) {
-                url = sc.getResource("/WEB-INF/groovy/" + name);
-                if (url == null) {
-                    throw new ResourceException("Resource " + name + " not found");
-                }
-            }
-            return url.openConnection();
-        } catch (IOException ioe) {
-            throw new ResourceException("Problem reading resource " + name);
-        }
+    if (!file.canRead()) {
+      response.sendError(HttpServletResponse.SC_FORBIDDEN, "Can not read!");
+      return; // throw new IOException(file.getAbsolutePath());
     }
 
-    /**
-     * Handle web requests to the GroovyServlet
-     */
-    public void service(ServletRequest request, ServletResponse response)
-        throws IOException {
-
-        // Convert the generic servlet request and response to their Http versions
-        final HttpServletRequest httpRequest = (HttpServletRequest) request;
-        final HttpServletResponse httpResponse = (HttpServletResponse) response;
-
-        // get the script path from the request
-        final String scriptFilename = getGroovyScriptPath(httpRequest);
-        // log("Serving " + scriptFilename);
-
-        // Set it to HTML by default
-        response.setContentType("text/html");
-
-        // Set up the script context
-        final Binding binding = new ServletBinding(httpRequest, httpResponse, sc);
-
-        // Run the script
-        try {
-            Closure closure = new Closure(gse) {
-                public Object call() {
-                    try {
-                        return ((GroovyScriptEngine)getDelegate()).run(scriptFilename, binding);
-                    } catch (ResourceException e) {
-                        throw new RuntimeException(e);
-                    } catch (ScriptException e) {
-                        throw new RuntimeException(e);
-                    }
-                }
-            };
-            GroovyCategorySupport.use(ServletCategory.class, closure);
-            // Set reponse code 200 and flush buffers
-            httpResponse.setStatus(HttpServletResponse.SC_OK);
-            httpResponse.flushBuffer();            
-            // log("Flushed response buffer.");
-        } catch (RuntimeException re) {
-
-            StringBuffer error = new StringBuffer("GroovyServlet Error: ");
-            error.append(" script: '");
-            error.append(scriptFilename);
-            error.append("': ");
-
-            Throwable e = re.getCause();
-            if (e instanceof ResourceException) {
-                error.append(" Script not found, sending 404.");
-                sc.log(error.toString());
-                System.out.println(error.toString());
-                httpResponse.sendError(HttpServletResponse.SC_NOT_FOUND);
-            } else {
-
-                // write the script errors (if any) to the servlet context's log
-                if (re.getMessage() != null)
-                    error.append(re.getMessage());
-
-                if (e != null) {
-                    sc.log("An error occurred processing the request", e);
-                } else {
-                    sc.log("An error occurred processing the request", re);
-                }
-                sc.log(error.toString());
-                System.out.println(error.toString());
-
-                httpResponse.sendError(
-                    HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
-            }
+    // get the script path from the request
+    final String scriptFilename = file.getName();
+    // log("Serving " + scriptFilename);
+
+    // Set it to HTML by default
+    response.setContentType("text/html");
+
+    // Set up the script context
+    final Binding binding = new ServletBinding(request, response, sc);
+
+    // Run the script
+    try {
+      Closure closure = new Closure(gse) {
+
+        public Object call() {
+          try {
+            return ((GroovyScriptEngine) getDelegate()).run(scriptFilename,
+                binding);
+          }
+          catch (ResourceException e) {
+            throw new RuntimeException(e);
+          }
+          catch (ScriptException e) {
+            throw new RuntimeException(e);
+          }
         }
 
+      };
+      GroovyCategorySupport.use(ServletCategory.class, closure);
+      // Set reponse code 200 and flush buffers
+      response.setStatus(HttpServletResponse.SC_OK);
+      response.flushBuffer();
+      // log("Flushed response buffer.");
+    }
+    catch (RuntimeException re) {
+      StringBuffer error = new StringBuffer("GroovyServlet Error: ");
+      error.append(" script: '");
+      error.append(scriptFilename);
+      error.append("': ");
+      Throwable e = re.getCause();
+      if (e instanceof ResourceException) {
+        error.append(" Script not found, sending 404.");
+        sc.log(error.toString());
+        System.out.println(error.toString());
+        response.sendError(HttpServletResponse.SC_NOT_FOUND);
+      }
+      else {
+        // write the script errors (if any) to the servlet context's log
+        if (re.getMessage() != null)
+          error.append(re.getMessage());
+
+        if (e != null) {
+          sc.log("An error occurred processing the request", e);
+        }
+        else {
+          sc.log("An error occurred processing the request", re);
+        }
+        sc.log(error.toString());
+        System.out.println(error.toString());
+        response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
+      }
     }
 
-    // --------------------------------------------------------- private methods
-
-    /**
-     * From the HttpServletRequest, parse the groovy script path using the URL,
-     * adding the extension ".groovy" as needed.
-     */
-    private String getGroovyScriptPath(HttpServletRequest request) {
-
-        // Get the name of the Groovy script - include aware (GROOVY-815)
-        String strURI = super.getScriptUri(request);
-
-        int contextLength = request.getContextPath().length();
-        String scriptFilename = strURI.substring(contextLength).substring(1);
-
-        // if the servlet mapping is .groovy, we don't need to strip the mapping from the filename.
-        // if the mapping is anything else, we need to strip it and append .groovy
-        if (scriptFilename.endsWith(GROOVY_EXTENSION))
-            return scriptFilename;
-
-        // strip the servlet mapping (from the last ".") and append .groovy
-        int lastDot = scriptFilename.lastIndexOf(".");
-        scriptFilename = scriptFilename.substring(0, lastDot)
-            + GROOVY_EXTENSION;
-        return scriptFilename;
+  }
 
-    }
 }
diff --git a/src/main/groovy/servlet/ServletBinding.java b/src/main/groovy/servlet/ServletBinding.java
index 44499460df..bb2f5a68ce 100644
--- a/src/main/groovy/servlet/ServletBinding.java
+++ b/src/main/groovy/servlet/ServletBinding.java
@@ -58,9 +58,26 @@ import java.util.HashMap;
 import java.io.IOException;
 
 /**
- * Servlet-specific binding extesion to lazy load the writer or the output stream from the response.
- * This binding also provide a markup builder named "html".
- *
+ * Servlet-specific binding extesion to lazy load the writer or the output
+ * stream from the response.
+ * 
+ * <ul>
+ * <li><tt>"request"</tt> : HttpServletRequest </li>
+ * <li><tt>"response"</tt> : HttpServletResponse </li>
+ * <li><tt>"context"</tt> : ServletContext </li>
+ * <li><tt>"application"</tt> : ServletContext </li>
+ * <li><tt>"session"</tt> : request.getSession(true) </li>
+ * <li><tt>"param"</tt> : form parameter(s) map </li>
+ * <li><tt>"header"</tt> : header map </li>
+ * </ul>
+ * 
+ * <ul>
+ * <li><tt>"out"</tt> : response.getWriter() </li>
+ * <li><tt>"sout"</tt> : response.getOutputStream() </li>
+ * <li><tt>"html"</tt> : new MarkupBuilder(response.getWriter()) </li>
+ * </ul>
+ * </p>
+ * 
  * @author Guillaume Laforge
  */
 public class ServletBinding extends Binding {
diff --git a/src/main/groovy/servlet/TemplateServlet.java b/src/main/groovy/servlet/TemplateServlet.java
index 37123e86cd..dd5810655f 100644
--- a/src/main/groovy/servlet/TemplateServlet.java
+++ b/src/main/groovy/servlet/TemplateServlet.java
@@ -53,7 +53,6 @@ import java.util.Map;
 import java.util.WeakHashMap;
 
 import javax.servlet.ServletConfig;
-import javax.servlet.ServletContext;
 import javax.servlet.ServletException;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
@@ -147,11 +146,6 @@ public class TemplateServlet extends AbstractHttpServlet {
   // Java5 private final Map<String, TemplateCacheEntry> cache;
   private final Map cache;
 
-  /**
-   * Servlet (or the application) context.
-   */
-  private ServletContext context;
-
   /**
    * Underlying template engine used to evaluate template source files.
    */
@@ -168,7 +162,7 @@ public class TemplateServlet extends AbstractHttpServlet {
   public TemplateServlet() {
     // Java 5 this.cache = new WeakHashMap<String, TemplateCacheEntry>();
     this.cache = new WeakHashMap();
-    this.context = null; // assigned later by init()
+    //this.context = null; // assigned later by super.init()
     this.engine = null; // assigned later by init()
     this.generatedBy = true; // may be changed by init()
   }
@@ -308,10 +302,6 @@ public class TemplateServlet extends AbstractHttpServlet {
    */
   public void init(ServletConfig config) throws ServletException {
     super.init(config);
-    this.context = config.getServletContext();
-    if (context == null) {
-      throw new ServletException("Context must not be null!");
-    }
     this.engine = initTemplateEngine(config);
     if (engine == null) {
       throw new ServletException("Template engine not instantiated.");
@@ -390,7 +380,7 @@ public class TemplateServlet extends AbstractHttpServlet {
     //
     // Get the template source file handle.
     //
-    File file = super.getScriptUriAsFile(request, context);
+    File file = super.getScriptUriAsFile(request, servletContext);
     if (!file.exists()) {
       response.sendError(HttpServletResponse.SC_NOT_FOUND);
       return; // throw new IOException(file.getAbsolutePath());
@@ -410,7 +400,7 @@ public class TemplateServlet extends AbstractHttpServlet {
     //
     // Create new binding for the current request.
     //
-    ServletBinding binding = new ServletBinding(request, response, context);
+    ServletBinding binding = new ServletBinding(request, response, servletContext);
     setVariables(binding);
 
     //
