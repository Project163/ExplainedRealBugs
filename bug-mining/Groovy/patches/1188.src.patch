diff --git a/src/main/org/codehaus/groovy/tools/groovydoc/GroovyRootDocBuilder.java b/src/main/org/codehaus/groovy/tools/groovydoc/GroovyRootDocBuilder.java
index c249dacd40..411cf82bf7 100644
--- a/src/main/org/codehaus/groovy/tools/groovydoc/GroovyRootDocBuilder.java
+++ b/src/main/org/codehaus/groovy/tools/groovydoc/GroovyRootDocBuilder.java
@@ -259,7 +259,7 @@ public class GroovyRootDocBuilder {
 
 
     private void calcThenSetSummary(String src, SimpleGroovyPackageDoc packageDoc) {
-        packageDoc.setSummary(SimpleGroovyDoc.stripTags(SimpleGroovyDoc.calculateFirstSentence(src)));
+        packageDoc.setSummary(SimpleGroovyDoc.calculateFirstSentence(src));
     }
 
     private void calcThenSetOverviewDescription(String src) {
diff --git a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDoc.java b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDoc.java
index 975af4ad2e..9c7de1f903 100644
--- a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDoc.java
+++ b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDoc.java
@@ -23,7 +23,7 @@ import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
 public class SimpleGroovyClassDoc extends SimpleGroovyProgramElementDoc implements GroovyClassDoc {
-    public static final Pattern TAG_REGEX = Pattern.compile("(?m)@([a-zA-Z]+)\\s+(.*$[^@]*)");
+    public static final Pattern TAG_REGEX = Pattern.compile("(?m)@([a-zA-Z]+)\\s+(.*)");
     public static final Pattern LINK_REGEX = Pattern.compile("(?m)[{]@(link)\\s+([^}]*)}");
     public static final Pattern CODE_REGEX = Pattern.compile("(?m)[{]@(code)\\s+([^}]*)}");
     public static final Pattern REF_LABEL_REGEX = Pattern.compile("([\\w.#]*(\\(.*\\))?)(\\s(.*))?");
@@ -548,13 +548,13 @@ public class SimpleGroovyClassDoc extends SimpleGroovyProgramElementDoc implemen
 
     public String firstSentenceCommentText() {
         if (super.firstSentenceCommentText() == null)
-            setFirstSentenceCommentText(stripTags(replaceTags(calculateFirstSentence(getRawCommentText()))));
+            setFirstSentenceCommentText(replaceTags(calculateFirstSentence(getRawCommentText())));
         return super.firstSentenceCommentText();
     }
 
     public String commentText() {
         if (super.commentText() == null)
-            setCommentText(stripTags(replaceTags(getRawCommentText())));
+            setCommentText(replaceTags(getRawCommentText()));
         return super.commentText();
     }
 
@@ -567,7 +567,7 @@ public class SimpleGroovyClassDoc extends SimpleGroovyProgramElementDoc implemen
         // {@code processing hack}
         result = replaceAllTags(result, "<TT>", "</TT>", CODE_REGEX);
 
-        // hack to reformat other groovydoc tags (@see, @return, @link, @param, @throws, @author, @since) into html
+        // hack to reformat other groovydoc tags (@see, @return, @param, @throws, @author, @since) into html
         // todo: replace with proper tag support
         result = replaceAllTags(result, "<DL><DT><B>$1:</B></DT><DD>", "</DD></DL>", TAG_REGEX);
 
diff --git a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDocAssembler.java b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDocAssembler.java
index 48f19cd387..e5917e0e3a 100644
--- a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDocAssembler.java
+++ b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyClassDocAssembler.java
@@ -272,8 +272,7 @@ public class SimpleGroovyClassDocAssembler extends VisitorAdapter implements Gro
     }
 
     private boolean isNested() {
-        GroovySourceAST gpn = getGrandParentNode();
-        return getParentNode() != null && gpn != null && (gpn.getType() == CLASS_DEF || gpn.getType() == INTERFACE_DEF);
+        return getCurrentClassDoc() != null;
     }
 
     private boolean isTopLevelConstruct(GroovySourceAST node) {
@@ -617,11 +616,13 @@ public class SimpleGroovyClassDocAssembler extends VisitorAdapter implements Gro
     }
 
     private SimpleGroovyClassDoc getCurrentClassDoc() {
-        GroovySourceAST pn = getParentNode();
-        if (isTopLevelConstruct(pn)) return foundClasses.get(getIdentFor(pn));
-        GroovySourceAST gpn = getGrandParentNode();
-        if (isTopLevelConstruct(gpn)) return foundClasses.get(getIdentFor(gpn));
-        return null;
+        if (stack.isEmpty()) return null;
+        GroovySourceAST node = getParentNode();
+        if (isTopLevelConstruct(node)) return foundClasses.get(getIdentFor(node));
+        GroovySourceAST saved = stack.pop();
+        SimpleGroovyClassDoc result = getCurrentClassDoc();
+        stack.push(saved);
+        return result;
     }
 
     private String getIdentFor(GroovySourceAST gpn) {
diff --git a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyDoc.java b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyDoc.java
index e4a320fb63..cd659c5fd0 100644
--- a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyDoc.java
+++ b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyDoc.java
@@ -103,7 +103,11 @@ public class SimpleGroovyDoc implements GroovyDoc, GroovyTokenTypes {
 
     public static String calculateFirstSentence(String raw) {
         // remove all the * from beginning of lines
-        String text = raw.replaceAll("(?m)^\\s*\\*", ""); // todo precompile regex
+        String text = raw.replaceAll("(?m)^\\s*\\*", "").trim();
+        // assume completely blank line signifies end of sentence
+        text = text.replaceFirst("(?ms)\\n\\s*\\n.*", "").trim();
+        // assume @tag signifies end of sentence
+        text = text.replaceFirst("(?ms)\\n\\s*@(see|param|throws|return|author|since|exception|version|deprecated|todo)\\s.*", "").trim();
         // Comment Summary using first sentence (Locale sensitive)
         BreakIterator boundary = BreakIterator.getSentenceInstance(Locale.getDefault()); // todo - allow locale to be passed in
         boundary.setText(text);
@@ -116,10 +120,6 @@ public class SimpleGroovyDoc implements GroovyDoc, GroovyTokenTypes {
         return text;
     }
 
-    public static String stripTags(String text) {
-        return text.replaceAll("(?m)@([a-z]+\\s*.*)$", "");
-    }
-
     public boolean isClass() {
         return definitionType == CLASS_DEF;
     }
diff --git a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyMemberDoc.java b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyMemberDoc.java
index 08e1d69b53..fac97d0737 100644
--- a/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyMemberDoc.java
+++ b/src/main/org/codehaus/groovy/tools/groovydoc/SimpleGroovyMemberDoc.java
@@ -41,7 +41,7 @@ public class SimpleGroovyMemberDoc extends SimpleGroovyProgramElementDoc impleme
     public String firstSentenceCommentText() {
         if (super.firstSentenceCommentText() == null) {
             SimpleGroovyClassDoc classDoc = (SimpleGroovyClassDoc) belongsToClass;
-            setFirstSentenceCommentText(stripTags(classDoc.replaceTags(calculateFirstSentence(getRawCommentText()))));
+            setFirstSentenceCommentText(classDoc.replaceTags(calculateFirstSentence(getRawCommentText())));
         }
         return super.firstSentenceCommentText();
     }
@@ -49,7 +49,7 @@ public class SimpleGroovyMemberDoc extends SimpleGroovyProgramElementDoc impleme
     public String commentText() {
         if (super.commentText() == null) {
             SimpleGroovyClassDoc classDoc = (SimpleGroovyClassDoc) belongsToClass;
-            setCommentText(stripTags(classDoc.replaceTags(getRawCommentText())));
+            setCommentText(classDoc.replaceTags(getRawCommentText()));
         }
         return super.commentText();
     }
