diff --git a/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java b/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
index 176ae7d46a..ea7d963d77 100644
--- a/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
+++ b/src/main/org/codehaus/groovy/control/customizers/SecureASTCustomizer.java
@@ -516,7 +516,8 @@ public class SecureASTCustomizer extends CompilationCustomizer {
         if (!isPackageAllowed && ast.getPackage() != null) {
             throw new SecurityException("Package definitions are not allowed");
         }
-        if (!isMethodDefinitionAllowed && ast.getMethods()!=null && ast.getMethods().size()>0) {
+        final List<MethodNode> methods = ast.getMethods();
+        if (!isMethodDefinitionAllowed && methods !=null && methods.size()>0) {
             throw new SecurityException("Method definitions are not allowed");
         }
 
@@ -544,7 +545,14 @@ public class SecureASTCustomizer extends CompilationCustomizer {
             }
         }
 
-        ast.getStatementBlock().visit(new SecuringCodeVisitor());
+        final SecuringCodeVisitor visitor = new SecuringCodeVisitor();
+        ast.getStatementBlock().visit(visitor);
+
+        if (isMethodDefinitionAllowed && methods !=null) {
+            for (MethodNode method : methods) {
+                method.getCode().visit(visitor);
+            }
+        }
     }
 
     private void assertStarImportIsAllowed(final String packageName) {
diff --git a/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy b/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
index b9fab30f1a..71d0e21d99 100644
--- a/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
+++ b/src/test/org/codehaus/groovy/control/customizers/SecureASTCustomizerTest.groovy
@@ -364,4 +364,16 @@ class SecureASTCustomizerTest extends GroovyTestCase {
         assert hasSecurityException {shell.evaluate('java.lang.Math.cos(2)')}
     }
 
+    // Testcase for GROOVY-4978
+    void testVisitMethodBody() {
+        def shell = new GroovyShell(configuration)
+        customizer.importsBlacklist = [
+                "java.lang.System",
+		        "groovy.lang.GroovyShell",
+                "groovy.lang.GroovyClassLoader"]
+        customizer.indirectImportCheckEnabled = true
+
+        assert hasSecurityException {shell.evaluate('System.println(1)')}
+        assert hasSecurityException {shell.evaluate('def x() { System.println(1) }')}
+    }
 }
