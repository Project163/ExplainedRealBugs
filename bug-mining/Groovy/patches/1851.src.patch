diff --git a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
index a6fb58d2c9..678c66e613 100644
--- a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
+++ b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
@@ -1009,6 +1009,7 @@ public class AsmClassGenerator extends ClassGenerator {
             while (!iterType.equals(type)) {
                 String ownerName = BytecodeHelper.getClassInternalName(iterType);
                 iterType = iterType.getOuterClass();
+                if (iterType==null) break;
                 String typeName = BytecodeHelper.getTypeDescription(iterType);
                 mv.visitFieldInsn(GETFIELD, ownerName, "this$0", typeName);
             }
diff --git a/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy b/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
index 5e483a8519..dea1fa3fa4 100644
--- a/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
+++ b/src/test/groovy/transform/stc/AnonymousInnerClassSTCTest.groovy
@@ -16,6 +16,8 @@
 
 package groovy.transform.stc
 
+import groovy.transform.NotYetImplemented
+
 /**
  * Test cases specifically aimed at testing the behaviour of the type checker
  * with regards to anonymous inner classes.
@@ -35,4 +37,80 @@ class AnonymousInnerClassSTCTest extends StaticTypeCheckingTestCase {
             assert s.things.size() == 1
         '''
     }
+
+    void testAssignmentOfAICFromInterface() {
+        assertScript '''
+            Runnable r = new Runnable() {
+                public void run() { println 'ok' }
+            }
+            r.run()
+        '''
+    }
+
+    void testAssignmentOfAICFromAbstractClass() {
+        assertScript '''
+            abstract class Foo { abstract String item() }
+            Foo f = new Foo() {
+                String item() { 'ok' }
+            }
+            assert f.item() == 'ok'
+        '''
+    }
+
+    void testAssignmentOfAICFromAbstractClassAndInterface() {
+        assertScript '''
+            abstract class Foo  implements Runnable { abstract String item() }
+            Foo f = new Foo() {
+                String item() { 'ok' }
+                void run() {}
+            }
+            assert f.item() == 'ok'
+            f.run()
+        '''
+    }
+
+    void testCallMethodUsingAIC() {
+        assertScript '''abstract class Foo { abstract String item() }
+            boolean valid(Foo foo) {
+                foo.item() == 'ok'
+            }
+            def f = new Foo() {
+                String item() { 'ok' }
+            }
+            assert valid(f)
+        '''
+    }
+
+    void testCallMethodUsingAICImplementingInterface() {
+        assertScript '''abstract class Foo implements Runnable { abstract String item() }
+            boolean valid(Foo foo) {
+                foo.item() == 'ok'
+            }
+            def f = new Foo() {
+                String item() { 'ok' }
+                void run() {}
+            }
+            assert valid(f)
+            f.run()
+        '''
+    }
+
+    @NotYetImplemented
+    void testAICIntoClass() {
+        assertScript '''
+            class Outer {
+                int outer() { 1 }
+                abstract class Inner {
+                    abstract int inner()
+                }
+                int test() {
+                    Inner inner = new Inner() {
+                        int inner() { outer() }
+                    }
+                    inner.inner()
+                }
+            }
+            assert new Outer().test() == 1
+        '''
+    }
 }
diff --git a/src/test/org/codehaus/groovy/classgen/asm/sc/AnonymousInnerClassStaticCompileTest.groovy b/src/test/org/codehaus/groovy/classgen/asm/sc/AnonymousInnerClassStaticCompileTest.groovy
new file mode 100644
index 0000000000..f4d8f3361e
--- /dev/null
+++ b/src/test/org/codehaus/groovy/classgen/asm/sc/AnonymousInnerClassStaticCompileTest.groovy
@@ -0,0 +1,36 @@
+/*
+ * Copyright 2003-2012 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.codehaus.groovy.classgen.asm.sc
+
+import groovy.transform.stc.AnonymousInnerClassSTCTest
+
+/**
+ * Statically compiled the {@link AnonymousInnerClassSTCTest tests} and runs them
+ * to ensure they are compatible with static compilation.
+ *
+ * @author Cedric Champeau
+ */
+@Mixin(StaticCompilationTestSupport)
+class AnonymousInnerClassStaticCompileTest extends AnonymousInnerClassSTCTest {
+
+    @Override
+    protected void setUp() {
+        super.setUp()
+        extraSetup()
+    }
+
+}
+
