diff --git a/src/main/org/codehaus/groovy/ant/Groovyc.java b/src/main/org/codehaus/groovy/ant/Groovyc.java
index 3bdacb69cb..62e05ba191 100644
--- a/src/main/org/codehaus/groovy/ant/Groovyc.java
+++ b/src/main/org/codehaus/groovy/ant/Groovyc.java
@@ -968,6 +968,10 @@ public class Groovyc extends MatchingTask {
 
 
     protected GroovyClassLoader buildClassLoaderFor() {
+        // GROOVY-5044
+        if (!fork && !getIncludeantruntime()) {
+            throw new IllegalArgumentException("The includeAntRuntime=false option is not compatible with fork=false");
+        }
         ClassLoader parent = getIncludeantruntime()
                 ? getClass().getClassLoader()
                 : new AntClassLoader(new RootLoader(new URL[0], null), getProject(), getClasspath());
diff --git a/src/test/org/codehaus/groovy/ant/GroovycTest.java b/src/test/org/codehaus/groovy/ant/GroovycTest.java
index b14323b2f6..4692110a81 100644
--- a/src/test/org/codehaus/groovy/ant/GroovycTest.java
+++ b/src/test/org/codehaus/groovy/ant/GroovycTest.java
@@ -222,6 +222,10 @@ public class GroovycTest extends GroovyTestCase {
         ensureFails("GroovycTest1_ForkGroovy_NoClasspath_Fail");
     }
 
+    public void testNoForkWithNoIncludeAntRuntime() {
+        ensureFails("noForkNoAntRuntime");
+    }
+
     private void ensureExecutes(String target) {
         ensureNotPresent("GroovycTest1");
         project.executeTarget(target);
diff --git a/src/test/org/codehaus/groovy/ant/GroovycTest.xml b/src/test/org/codehaus/groovy/ant/GroovycTest.xml
index 42484d3de1..89a96fc75c 100644
--- a/src/test/org/codehaus/groovy/ant/GroovycTest.xml
+++ b/src/test/org/codehaus/groovy/ant/GroovycTest.xml
@@ -165,6 +165,10 @@
       <java classname="org.codehaus.groovy.ant.GroovycTest1"/>
     </target>
 
+    <target name="noForkNoAntRuntime">
+        <groovyc srcdir="${srcPath}" destdir="${destPath}" includes="GroovycTest1.groovy" fork="false" includeAntRuntime="false"/>
+    </target>
+
   <target name="clean">
     <delete quiet="true">
       <fileset dir="${destPath}/org/codehaus/groovy/ant">
