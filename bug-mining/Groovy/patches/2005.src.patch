diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index 17e1b965a5..758b7f2943 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -2896,7 +2896,11 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
         if (method.isStatic() && CLASS_Type.equals(receiver) && receiver.isUsingGenerics() && receiver.getGenericsTypes().length>0) {
             GenericsUtils.extractPlaceholders(receiver.getGenericsTypes()[0].getType(), resolvedPlaceholders);
         } else {
-            GenericsUtils.extractPlaceholders(receiver, resolvedPlaceholders);
+            ClassNode current = receiver;
+            while (current!=null) {
+                GenericsUtils.extractPlaceholders(current, resolvedPlaceholders);
+                current = current.getUnresolvedSuperClass();
+            }
         }
         GenericsUtils.extractPlaceholders(method.getReturnType(), resolvedPlaceholders);
         if (resolvedPlaceholders.isEmpty()) return returnType;
diff --git a/src/test/groovy/transform/stc/GenericsSTCTest.groovy b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
index 552a3eb38c..e12f6672b1 100644
--- a/src/test/groovy/transform/stc/GenericsSTCTest.groovy
+++ b/src/test/groovy/transform/stc/GenericsSTCTest.groovy
@@ -954,6 +954,36 @@ class GenericsSTCTest extends StaticTypeCheckingTestCase {
         '''
     }
 
+    // GROOVY-5721
+    void testExtractComponentTypeFromSubclass() {
+        assertScript '''
+        class MyList extends ArrayList<Double> {}
+
+        List<Double> list1 = new ArrayList<Double>()
+        list1 << 0.0d
+
+        // OK
+        Double d1 = list1.get(0)
+
+        //---------------------------
+
+        List<Double> list2 = new MyList<>()
+        list2 << 0.0d
+
+        //Groovyc: [Static type checking] - Cannot assign value of type java.lang.Object to variable of type java.lang.Double
+        Double d2 = list2.get(0)
+
+        //---------------------------
+
+        MyList list3 = new MyList()
+        list3 << 0.0d
+
+        //Groovyc: [Static type checking] - Cannot assign value of type java.lang.Object to variable of type java.lang.Double
+        Double d3 = list3.get(0)
+        '''
+
+    }
+
     static class MyList extends LinkedList<String> {}
 
     public static class ClassA<T> {
