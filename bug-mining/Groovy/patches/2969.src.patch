diff --git a/src/main/org/codehaus/groovy/control/customizers/builder/SecureASTCustomizerFactory.java b/src/main/org/codehaus/groovy/control/customizers/builder/SecureASTCustomizerFactory.java
index 6160a833f9..3c81dee3f4 100644
--- a/src/main/org/codehaus/groovy/control/customizers/builder/SecureASTCustomizerFactory.java
+++ b/src/main/org/codehaus/groovy/control/customizers/builder/SecureASTCustomizerFactory.java
@@ -47,6 +47,7 @@ public class SecureASTCustomizerFactory extends AbstractFactory {
         if (node instanceof SecureASTCustomizer) {
             Closure clone = (Closure) childContent.clone();
             clone.setDelegate(node);
+            clone.setResolveStrategy(Closure.DELEGATE_FIRST);
             clone.call();
         }
         return false;
diff --git a/src/test/org/codehaus/groovy/control/customizers/builder/CompilerCustomizationBuilderTest.groovy b/src/test/org/codehaus/groovy/control/customizers/builder/CompilerCustomizationBuilderTest.groovy
index c63b300f92..8b385989cf 100644
--- a/src/test/org/codehaus/groovy/control/customizers/builder/CompilerCustomizationBuilderTest.groovy
+++ b/src/test/org/codehaus/groovy/control/customizers/builder/CompilerCustomizationBuilderTest.groovy
@@ -321,7 +321,6 @@ class CompilerCustomizationBuilderTest extends GroovyTestCase {
     }
 
     void testCompilerConfigurationBuilderStyle() {
-        println 'hello'
         def config = new CompilerConfiguration()
         // the "customizers" method is added through a custom metaclass
         CompilerCustomizationBuilder.withConfig(config) {
@@ -333,6 +332,16 @@ class CompilerCustomizationBuilderTest extends GroovyTestCase {
         assert result == 'A(1)'
     }
 
+    void testCompilerConfigurationBuilderWithSecureAstCustomizer() {
+        def config = new CompilerConfiguration()
+        CompilerCustomizationBuilder.withConfig(config) {
+            secureAst {
+                importsWhitelist = []
+            }
+        }
+        assert config.compilationCustomizers.first().importsWhitelist == []
+    }
+
     private static class SourceUnit {
         String name
     }
