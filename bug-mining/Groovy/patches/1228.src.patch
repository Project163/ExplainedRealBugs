diff --git a/src/main/org/codehaus/groovy/control/ResolveVisitor.java b/src/main/org/codehaus/groovy/control/ResolveVisitor.java
index 5d499af244..e7862b0f83 100644
--- a/src/main/org/codehaus/groovy/control/ResolveVisitor.java
+++ b/src/main/org/codehaus/groovy/control/ResolveVisitor.java
@@ -68,6 +68,7 @@ public class ResolveVisitor extends ClassCodeExpressionTransformer {
     private Map<String, GenericsType> genericParameterNames = new HashMap<String, GenericsType>();
     private Set<FieldNode> fieldTypesChecked = new HashSet<FieldNode>();
     private boolean checkingVariableTypeInDeclaration = false;
+    private ImportNode currImportNode = null;
 
     /**
      * we use ConstructedClassWithPackage to limit the resolving the compiler
@@ -541,7 +542,11 @@ public class ResolveVisitor extends ClassCodeExpressionTransformer {
          */
         while (true) {
             pname = name.substring(0, index);
-            ClassNode aliasedNode = module.getImportType(pname);
+            ClassNode aliasedNode = null;
+            ImportNode importNode = module.getImport(pname);
+            if(importNode != null && importNode != currImportNode) {
+                aliasedNode = importNode.getType();
+            }
 
             if (aliasedNode != null) {
                 if (pname.length() == name.length()) {
@@ -1148,8 +1153,13 @@ public class ResolveVisitor extends ClassCodeExpressionTransformer {
         if (!module.hasImportsResolved()) {
             List l = module.getImports();
             for (ImportNode importNode : module.getImports()) {
+            	currImportNode = importNode;
                 ClassNode type = importNode.getType();
-                if (resolve(type, true, false, true)) continue;
+                if (resolve(type, true, false, true)) {
+                	currImportNode = null;
+                	continue;
+                }
+                currImportNode = null;
                 addError("unable to resolve class " + type.getName(), type);
             }
             for (ImportNode importNode : module.getStaticStarImports().values()) {
diff --git a/src/test/groovy/bugs/Groovy4107Bug.groovy b/src/test/groovy/bugs/Groovy4107Bug.groovy
new file mode 100644
index 0000000000..6a6e93154b
--- /dev/null
+++ b/src/test/groovy/bugs/Groovy4107Bug.groovy
@@ -0,0 +1,34 @@
+/*
+ * Copyright 2003-2010 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package groovy.bugs
+
+import org.codehaus.groovy.control.MultipleCompilationErrorsException
+
+class Groovy4107Bug extends GroovyTestCase {
+    void testUnqualifiedImportResolveBug() {
+        try {
+            new GroovyShell().parse """
+                import Roshan4107
+                
+                Roshan4107.foo()
+            """
+            fail('The compilation should have failed as the class Roshan4107 is non-existent')
+        } catch (MultipleCompilationErrorsException e) {
+            def syntaxError = e.errorCollector.getSyntaxError(0)
+            assert syntaxError.message.contains('unable to resolve class Roshan4107')
+        }
+    }
+}
\ No newline at end of file
