diff --git a/src/main/org/codehaus/groovy/antlr/AntlrParserPlugin.java b/src/main/org/codehaus/groovy/antlr/AntlrParserPlugin.java
index 33c9dc7674..60b562d2c5 100644
--- a/src/main/org/codehaus/groovy/antlr/AntlrParserPlugin.java
+++ b/src/main/org/codehaus/groovy/antlr/AntlrParserPlugin.java
@@ -1590,21 +1590,20 @@ public class AntlrParserPlugin extends ASTHelper implements ParserPlugin, Groovy
     protected Expression ternaryExpression(AST ternaryNode) {
         AST node = ternaryNode.getFirstChild();
         Expression base = expression(node);
-        BooleanExpression booleanExpression = new BooleanExpression(base);
-        booleanExpression.setSourcePosition(base);
         node = node.getNextSibling();
         Expression left = expression(node);
         node = node.getNextSibling();
-        Expression right;
+        Expression ret;
         if (node==null) {
-            right = left;
-            left = base;
+            ret = new ElvisOperatorExpression(base, left);
         } else {
-            right = expression(node);
+            Expression right = expression(node);
+            BooleanExpression booleanExpression = new BooleanExpression(base);
+            booleanExpression.setSourcePosition(base);
+            ret = new TernaryExpression(booleanExpression, left, right);
         }
-        TernaryExpression ternaryExpression = new TernaryExpression(booleanExpression, left, right);
-        configureAST(ternaryExpression, ternaryNode);
-        return ternaryExpression;
+        configureAST(ret, ternaryNode);
+        return ret;
     }
 
     protected Expression variableExpression(AST node) {
diff --git a/src/main/org/codehaus/groovy/ast/CodeVisitorSupport.java b/src/main/org/codehaus/groovy/ast/CodeVisitorSupport.java
index aa1343eed8..69be1d78c9 100644
--- a/src/main/org/codehaus/groovy/ast/CodeVisitorSupport.java
+++ b/src/main/org/codehaus/groovy/ast/CodeVisitorSupport.java
@@ -152,6 +152,10 @@ public abstract class CodeVisitorSupport implements GroovyCodeVisitor {
         expression.getTrueExpression().visit(this);
         expression.getFalseExpression().visit(this);
     }
+    
+    public void visitShortTernaryExpression(ElvisOperatorExpression expression) {
+        visitTernaryExpression(expression);
+    }
 
     public void visitPostfixExpression(PostfixExpression expression) {
         expression.getExpression().visit(this);
diff --git a/src/main/org/codehaus/groovy/ast/GroovyCodeVisitor.java b/src/main/org/codehaus/groovy/ast/GroovyCodeVisitor.java
index 79381d175e..7d3d0c68f6 100644
--- a/src/main/org/codehaus/groovy/ast/GroovyCodeVisitor.java
+++ b/src/main/org/codehaus/groovy/ast/GroovyCodeVisitor.java
@@ -76,6 +76,8 @@ public interface GroovyCodeVisitor {
     void visitConstructorCallExpression(ConstructorCallExpression expression);
 
     void visitTernaryExpression(TernaryExpression expression);
+    
+    void visitShortTernaryExpression(ElvisOperatorExpression expression);
 
     void visitBinaryExpression(BinaryExpression expression);
 
diff --git a/src/main/org/codehaus/groovy/ast/expr/ElvisOperatorExpression.java b/src/main/org/codehaus/groovy/ast/expr/ElvisOperatorExpression.java
new file mode 100644
index 0000000000..c2f3939b63
--- /dev/null
+++ b/src/main/org/codehaus/groovy/ast/expr/ElvisOperatorExpression.java
@@ -0,0 +1,67 @@
+/*
+ * Copyright 2003-2007 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.codehaus.groovy.ast.expr;
+
+import org.codehaus.groovy.ast.GroovyCodeVisitor;
+
+/**
+ * Represents a short ternary expression x ?: y, which is equal 
+ * to 
+ * <pre>
+ * def truePart = x
+ * def booleanPart = truePart as boolean
+ * booleanPart? truePart : y
+ * </pre>
+ * Even if x is no atomic expression, x will be evaluated only 
+ * once. Example:
+ * <pre>
+ * class Foo { 
+ *   def index=0 
+ *   def getX(){ index++; return index }
+ * }
+ * def foo = new Foo()
+ * def result = foo.x ?: "false case" 
+ * assert foo.index == 1
+ * assert result == 1 
+ * <pre>
+ * 
+ * @author <a href="mailto:blackdrag@gmx.org">Jochen Theodorou</a>
+ * @since 1.1
+ */
+public class ElvisOperatorExpression extends TernaryExpression {
+
+    public ElvisOperatorExpression(Expression base, Expression falseExpression) {
+        super(getBool(base), base, falseExpression);
+    }
+    
+    private static BooleanExpression getBool(Expression base) {
+       BooleanExpression be = new BooleanExpression(base);
+       be.setSourcePosition(base);
+       return be;
+    }
+
+    public void visit(GroovyCodeVisitor visitor) {
+        visitor.visitShortTernaryExpression(this);
+    }
+    
+    public Expression transformExpression(ExpressionTransformer transformer) {
+        Expression ret = new ElvisOperatorExpression(
+                transformer.transform(getTrueExpression()),
+                transformer.transform(getFalseExpression()));
+        ret.setSourcePosition(this);
+        return ret; 
+    }
+}
diff --git a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
index b86bf7fed2..77ff93a8a0 100644
--- a/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
+++ b/src/main/org/codehaus/groovy/classgen/AsmClassGenerator.java
@@ -702,17 +702,41 @@ public class AsmClassGenerator extends ClassGenerator {
     public void visitTernaryExpression(TernaryExpression expression) {
         onLineNumber(expression, "visitTernaryExpression");
 
-        expression.getBooleanExpression().visit(this);
+        BooleanExpression boolPart = expression.getBooleanExpression();
+        Expression truePart = expression.getTrueExpression();
+        Expression falsePart = expression.getFalseExpression();
+        
+        if (expression instanceof ElvisOperatorExpression) {
+            visitAndAutoboxBoolean(expression.getTrueExpression());
+            boolPart = new BooleanExpression(
+                    new BytecodeExpression() {
+                        public void visit(GroovyCodeVisitor visitor) {
+                            mv.visitInsn(DUP);
+                        }
+                    }
+            );
+            truePart = BytecodeExpression.NOP;
+            final Expression oldFalse = falsePart;
+            falsePart = new BytecodeExpression() {
+                public void visit(GroovyCodeVisitor visitor) {
+                    mv.visitInsn(POP);
+                    visitAndAutoboxBoolean(oldFalse);
+                }
+            };
+        }
+        
+        
+        boolPart.visit(this);
 
         Label l0 = new Label();
         mv.visitJumpInsn(IFEQ, l0);
-        visitAndAutoboxBoolean(expression.getTrueExpression());
+        visitAndAutoboxBoolean(truePart);
 
         Label l1 = new Label();
         mv.visitJumpInsn(GOTO, l1);
         mv.visitLabel(l0);
 
-        visitAndAutoboxBoolean(expression.getFalseExpression());
+        visitAndAutoboxBoolean(falsePart);
         mv.visitLabel(l1);
     }
 
diff --git a/src/main/org/codehaus/groovy/classgen/BytecodeExpression.java b/src/main/org/codehaus/groovy/classgen/BytecodeExpression.java
index 12479598e6..b88cbdda58 100644
--- a/src/main/org/codehaus/groovy/classgen/BytecodeExpression.java
+++ b/src/main/org/codehaus/groovy/classgen/BytecodeExpression.java
@@ -26,6 +26,13 @@ import org.codehaus.groovy.ast.expr.ExpressionTransformer;
  * @version $Revision$
  */
 public abstract class BytecodeExpression extends Expression {
+    public static BytecodeExpression NOP = new BytecodeExpression() {
+        public void visit(GroovyCodeVisitor visitor) {
+            //do nothing             
+        }
+    };
+    
+    
     public BytecodeExpression() {
     }
     
diff --git a/src/test/groovy/TernaryOperatorTest.groovy b/src/test/groovy/TernaryOperatorTest.groovy
index 2d2713ffd7..6b1959b813 100644
--- a/src/test/groovy/TernaryOperatorTest.groovy
+++ b/src/test/groovy/TernaryOperatorTest.groovy
@@ -36,8 +36,15 @@ class TernaryOperatorTest extends GroovyTestCase {
         def a = 1
         def x = a?:2
         assert x==a
+        
         a = null
         x = a?:2
         assert x==2
+        
+        def list = ['a','b','c']
+        def index = 0
+        def ret = list[index++]?:"something else"
+        assert index==1
+        assert ret=='a'
     }
 }
