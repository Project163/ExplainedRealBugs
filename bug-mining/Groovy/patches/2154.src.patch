diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index 026fc06df9..29da42f2b1 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -2064,6 +2064,12 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
                     mn = disambiguateMethods(mn, call);
                     if (mn.size() == 1) {
                         MethodNode directMethodCallCandidate = mn.get(0);
+                        if (chosenReceiver==null) {
+                            chosenReceiver = Receiver.make(directMethodCallCandidate.getDeclaringClass());
+                            if (chosenReceiver==null) {
+                                chosenReceiver = owners.get(0);
+                            }
+                        }
                         // visit the method to obtain inferred return type
                         typeCheckingContext.pushEnclosingClassNode(directMethodCallCandidate.getDeclaringClass());
                         for (ClassNode node : typeCheckingContext.source.getAST().getClasses()) {
diff --git a/src/test-resources/groovy/transform/stc/Groovy6047Extension.groovy b/src/test-resources/groovy/transform/stc/Groovy6047Extension.groovy
new file mode 100644
index 0000000000..678d8e483f
--- /dev/null
+++ b/src/test-resources/groovy/transform/stc/Groovy6047Extension.groovy
@@ -0,0 +1,6 @@
+// Used to check that GROOVY-6047 no longer throws an NPE
+methodNotFound { receiver, name, argumentList, argTypes, call ->
+    if (name=='elems') {
+        typeCheckingVisitor.findMethodsWithGenerated(receiver, 'elements')
+    }
+}
diff --git a/src/test/groovy/transform/stc/TypeCheckingExtensionsTest.groovy b/src/test/groovy/transform/stc/TypeCheckingExtensionsTest.groovy
index 7fc4724165..b6f72fa94d 100644
--- a/src/test/groovy/transform/stc/TypeCheckingExtensionsTest.groovy
+++ b/src/test/groovy/transform/stc/TypeCheckingExtensionsTest.groovy
@@ -438,6 +438,18 @@ class TypeCheckingExtensionsTest extends StaticTypeCheckingTestCase {
         '''
     }
 
+    void testShouldNotThrowNPE_Groovy6047() {
+        extension = 'groovy/transform/stc/Groovy6047Extension.groovy'
+        try {
+            assertScript '''
+                def b = new Vector()
+                b.elems()
+            '''
+        } catch (MissingMethodException e) {
+            // it's ok
+        }
+    }
+
     void testAmbiguousMethodCall() {
         extension = null
         shouldFailWithMessages '''
