diff --git a/src/main/groovy/servlet/AbstractHttpServlet.java b/src/main/groovy/servlet/AbstractHttpServlet.java
new file mode 100644
index 0000000000..1c0cb04e91
--- /dev/null
+++ b/src/main/groovy/servlet/AbstractHttpServlet.java
@@ -0,0 +1,142 @@
+/*
+ * $Id$
+ * 
+ * Copyright 2003 (C) James Strachan and Bob Mcwhirter. All Rights Reserved.
+ * 
+ * Redistribution and use of this software and associated documentation
+ * ("Software"), with or without modification, are permitted provided that the
+ * following conditions are met:
+ * 
+ * 1. Redistributions of source code must retain copyright statements and
+ * notices. Redistributions must also contain a copy of this document.
+ * 
+ * 2. Redistributions in binary form must reproduce the above copyright notice,
+ * this list of conditions and the following disclaimer in the documentation
+ * and/or other materials provided with the distribution.
+ * 
+ * 3. The name "groovy" must not be used to endorse or promote products derived
+ * from this Software without prior written permission of The Codehaus. For
+ * written permission, please contact info@codehaus.org.
+ * 
+ * 4. Products derived from this Software may not be called "groovy" nor may
+ * "groovy" appear in their names without prior written permission of The
+ * Codehaus. "groovy" is a registered trademark of The Codehaus.
+ * 
+ * 5. Due credit should be given to The Codehaus - http://groovy.codehaus.org/
+ * 
+ * THIS SOFTWARE IS PROVIDED BY THE CODEHAUS AND CONTRIBUTORS ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL THE CODEHAUS OR ITS CONTRIBUTORS BE LIABLE FOR
+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+ * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *  
+ */
+package groovy.servlet;
+
+import java.io.File;
+
+import javax.servlet.ServletContext;
+import javax.servlet.http.HttpServlet;
+import javax.servlet.http.HttpServletRequest;
+
+/**
+ * A common ground dealing with the http servlet API wrinkles.
+ *
+ * @author Christian Stein
+ */
+public abstract class AbstractHttpServlet extends HttpServlet {
+
+  /**
+   * Content type of the HTTP response.
+   */
+  public static final String CONTENT_TYPE_TEXT_HTML = "text/html";
+
+  /*
+   * Servlet API include key names.
+   */
+  public static final String INC_PATH_INFO = "javax.servlet.include.path_info";
+  // public static final String INC_REQUEST_URI = "javax.servlet.include.request_uri";
+  public static final String INC_SERVLET_PATH = "javax.servlet.include.servlet_path";
+
+  /**
+   * TODO ... 
+   */
+  protected String getScriptUri(HttpServletRequest request) {
+    //
+    // NOTE: This piece of code is heavily inspired by Apaches Jasper2!
+    // 
+    // http://cvs.apache.org/viewcvs.cgi/jakarta-tomcat-jasper/jasper2/ \
+    //        src/share/org/apache/jasper/servlet/JspServlet.java?view=markup
+    //
+    // Why doesn't it use request.getRequestURI()?
+    //
+
+    String uri = null;
+    String info = null;
+
+    //
+    // Check to see if the requested script/template has been the target of a
+    // RequestDispatcher.include().
+    //
+    uri = (String) request.getAttribute(INC_SERVLET_PATH);
+    if (uri != null) {
+      //
+      // Requested script/template file has been target of 
+      // RequestDispatcher.include(). Its path is assembled from the relevant
+      // javax.servlet.include.* request attributes and returned!
+      //
+      info = (String) request.getAttribute(INC_PATH_INFO);
+      if (info != null) {
+        uri += info;
+      }
+      return uri;
+    }
+
+    //
+    // Requested script/template file has not been the target of a 
+    // RequestDispatcher.include(). Reconstruct its path from the request's
+    // getServletPath() and getPathInfo() results.
+    //
+    uri = request.getServletPath();
+    info = request.getPathInfo();
+    if (info != null) {
+      uri += info;
+    }
+
+    return uri;
+  }
+
+  /**
+   * Parses the http request for the real script or template source file.
+   */
+  protected File getScriptUriAsFile(HttpServletRequest request,
+      ServletContext context) {
+    String uri = getScriptUri(request);
+    String real = context.getRealPath(uri);
+    File file = new File(real).getAbsoluteFile();
+
+      log("\tInclude-aware URI: " + uri);
+      log("\tContext real path: " + real); // context.getRealPath(uri)
+      log("\t             File: " + file);
+      log("\t      File exists? " + file.exists());
+      log("\t    File can read? " + file.canRead());
+      log("\t      ServletPath: " + request.getServletPath());
+      log("\t         PathInfo: " + request.getPathInfo()); 
+      log("\t       RequestURI: " + request.getRequestURI());
+      log("\t      QueryString: " + request.getQueryString());
+      //log("\t  Request Params: ");
+      //Enumeration e = request.getParameterNames();
+      //while (e.hasMoreElements()) {
+      //  String name = (String) e.nextElement();
+      //  log("\t\t " + name + " = " + request.getParameter(name));
+      //}   
+
+    return file;
+  }
+
+}
diff --git a/src/main/groovy/servlet/GroovyServlet.java b/src/main/groovy/servlet/GroovyServlet.java
index 68d34abdd7..6533f54692 100644
--- a/src/main/groovy/servlet/GroovyServlet.java
+++ b/src/main/groovy/servlet/GroovyServlet.java
@@ -48,7 +48,6 @@ import javax.servlet.ServletContext;
 import javax.servlet.ServletException;
 import javax.servlet.ServletRequest;
 import javax.servlet.ServletResponse;
-import javax.servlet.http.HttpServlet;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
 
@@ -101,7 +100,7 @@ import org.codehaus.groovy.runtime.GroovyCategorySupport;
  * @author Mark Turansky (markturansky at hotmail.com)
  * @author Guillaume Laforge
  */
-public class GroovyServlet extends HttpServlet implements ResourceConnector {
+public class GroovyServlet extends AbstractHttpServlet implements ResourceConnector {
 
     // ------------------------------------------------------ instance variables
 
@@ -127,17 +126,24 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
 
     // ---------------------------------------------------------- public methods
 
-    /**
-     * Returns the ServletContext for this servlet
-     */
-    public ServletContext getServletContext() {
-        return sc;
-    }
+    //
+    // (cstein) Do NOT override GenericServlet - using super.init() instead
+    //
+    //    /**
+    //     * Returns the ServletContext for this servlet
+    //     */
+    //    public ServletContext getServletContext() {
+    //        return sc;
+    //    }
 
     /**
      * Initialize the GroovyServlet.
+     *
+     * @throws ServletException if init() method defined in super class 
+     * javax.servlet.GenericServlet throws it
      */
-    public void init(ServletConfig config) {
+    public void init(ServletConfig config) throws ServletException {
+        super.init(config);
 
         // Use reflection, some containers don't load classes properly
         MetaClass.setUseReflection(true);
@@ -148,6 +154,9 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
 
         // Ensure that we use the correct classloader so that we can find
         // classes in an application server.
+        //
+        // TODO (cstein) Is parent used? Somewhere else then here?
+        //
         parent = Thread.currentThread().getContextClassLoader();
         if (parent == null)
             parent = GroovyServlet.class.getClassLoader();
@@ -178,7 +187,7 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
      * Handle web requests to the GroovyServlet
      */
     public void service(ServletRequest request, ServletResponse response)
-        throws ServletException, IOException {
+        throws IOException {
 
         // Convert the generic servlet request and response to their Http versions
         final HttpServletRequest httpRequest = (HttpServletRequest) request;
@@ -186,12 +195,13 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
 
         // get the script path from the request
         final String scriptFilename = getGroovyScriptPath(httpRequest);
+        // log("Serving " + scriptFilename);
 
         // Set it to HTML by default
         response.setContentType("text/html");
 
         // Set up the script context
-        final Binding binding = new ServletBinding((HttpServletRequest) request, (HttpServletResponse) response, sc);
+        final Binding binding = new ServletBinding(httpRequest, httpResponse, sc);
 
         // Run the script
         try {
@@ -207,6 +217,10 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
                 }
             };
             GroovyCategorySupport.use(ServletCategory.class, closure);
+            // Set reponse code 200 and flush buffers
+            httpResponse.setStatus(HttpServletResponse.SC_OK);
+            httpResponse.flushBuffer();            
+            // log("Flushed response buffer.");
         } catch (RuntimeException re) {
 
             StringBuffer error = new StringBuffer("GroovyServlet Error: ");
@@ -238,6 +252,7 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
                     HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
             }
         }
+
     }
 
     // --------------------------------------------------------- private methods
@@ -249,13 +264,7 @@ public class GroovyServlet extends HttpServlet implements ResourceConnector {
     private String getGroovyScriptPath(HttpServletRequest request) {
 
         // Get the name of the Groovy script - include aware (GROOVY-815)
-        String includeURI = (String)request.getAttribute("javax.servlet.include.request_uri");
-        String strURI = null;
-        if (includeURI != null) {
-            strURI = includeURI; 
-        } else {
-            strURI = request.getRequestURI(); 
-        }
+        String strURI = super.getScriptUri(request);
 
         int contextLength = request.getContextPath().length();
         String scriptFilename = strURI.substring(contextLength).substring(1);
diff --git a/src/main/groovy/servlet/TemplateServlet.java b/src/main/groovy/servlet/TemplateServlet.java
index 8bd5f0c9fa..a7a5d24b2d 100644
--- a/src/main/groovy/servlet/TemplateServlet.java
+++ b/src/main/groovy/servlet/TemplateServlet.java
@@ -38,7 +38,7 @@
  */
 package groovy.servlet;
 
-import groovy.servlet.ServletBinding;
+import groovy.lang.MetaClass;
 import groovy.text.SimpleTemplateEngine;
 import groovy.text.Template;
 import groovy.text.TemplateEngine;
@@ -55,7 +55,6 @@ import java.util.WeakHashMap;
 import javax.servlet.ServletConfig;
 import javax.servlet.ServletContext;
 import javax.servlet.ServletException;
-import javax.servlet.http.HttpServlet;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
 
@@ -89,7 +88,7 @@ import javax.servlet.http.HttpServletResponse;
  * @author Guillaume Laforge
  * @version 2.0
  */
-public class TemplateServlet extends HttpServlet {
+public class TemplateServlet extends AbstractHttpServlet {
 
   /**
    * Simple cache entry that validates against last modified and length
@@ -137,17 +136,6 @@ public class TemplateServlet extends HttpServlet {
 
   }
 
-  /**
-   * Content type of the HTTP response.
-   */
-  public static final String CONTENT_TYPE = "text/html";
-
-  /*
-   * Servlet API include key names.
-   */
-  private static final String INC_REQUEST_URI = "javax.servlet.include.request_uri";
-  private static final String INC_SERVLET_PATH = "javax.servlet.include.servlet_path";
-
   /*
    * Enables more log statements.
    */
@@ -218,57 +206,6 @@ public class TemplateServlet extends HttpServlet {
     return template;
   }
 
-  /*
-   * Parses the http request for the real template source file.
-   */
-  private File extractAbsoluteFile(HttpServletRequest request) {
-    String uri = null;
-    String requestUri = (String) request.getAttribute(INC_REQUEST_URI);
-    String includeUri = (String) request.getAttribute(INC_SERVLET_PATH);
-    // 
-    // The first scenario occurs when the template is not directly under /
-    // example: /foo/bar.template
-    //
-    if (requestUri != null) {
-      String current = requestUri.substring(requestUri.indexOf(includeUri));
-      if (!includeUri.equals(current)) {
-        includeUri = current;
-      }
-    }
-    //
-    // The second scenario is when the includeUri is null but it is still
-    // possible to recreate the request.
-    //
-    if (includeUri == null) {
-      uri = request.getServletPath();
-      if (request.getPathInfo() != null) {
-        uri = request.getServletPath() + request.getPathInfo();
-      }
-    }
-    else {
-      uri = includeUri;
-    }
-    //
-    // Create a file object from the real path.
-    //
-    File file = new File(context.getRealPath(uri)).getAbsoluteFile();
-    //  log("\t    TemplateFile: " + file);
-    //  log("\t     File exists? " + file.exists());
-    //  log("\t     File exists? " + file.canRead());
-    //  log("\t     ServletPath: " + request.getServletPath());
-    //  log("\t        PathInfo: " + request.getPathInfo());
-    //  log("\t        RealPath: " + context.getRealPath(uri));
-    //  log("\t      RequestURI: " + request.getRequestURI());
-    //  log("\t     QueryString: " + request.getQueryString());
-    //  //log("\t  Request Params: ");
-    //  //Enumeration e = request.getParameterNames();
-    //  //while (e.hasMoreElements()) {
-    //  //  String name = (String) e.nextElement();
-    //  //  log("\t\t " + name + " = " + request.getParameter(name));
-    //  //}
-    return file;
-  }
-
   /**
    * Gets the template created by the underlying engine parsing the request.
    * 
@@ -379,6 +316,10 @@ public class TemplateServlet extends HttpServlet {
     if (engine == null) {
       throw new ServletException("Template engine not instantiated.");
     }
+    
+    // Use reflection, some containers don't load classes properly
+    MetaClass.setUseReflection(true);
+    
     String value = config.getInitParameter("generatedBy");
     if (value != null) {
       this.generatedBy = Boolean.valueOf(value).booleanValue();
@@ -449,7 +390,7 @@ public class TemplateServlet extends HttpServlet {
     //
     // Get the template source file handle.
     //
-    File file = extractAbsoluteFile(request);
+    File file = super.getScriptUriAsFile(request, context);
     if (!file.exists()) {
       response.sendError(HttpServletResponse.SC_NOT_FOUND);
       return; // throw new IOException(file.getAbsolutePath());
@@ -475,7 +416,7 @@ public class TemplateServlet extends HttpServlet {
     //
     // Prepare the response buffer content type _before_ getting the writer.
     //
-    response.setContentType(CONTENT_TYPE);
+    response.setContentType(CONTENT_TYPE_TEXT_HTML);
 
     //
     // Get the output stream writer from the binding.
