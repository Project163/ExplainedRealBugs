diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index 72ae19d097..f368bbfe3f 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -2706,19 +2706,19 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
      * @return a String with replaced content
      * @since 1.0
      */
-    public static String replaceAll(String self, String regex, Closure closure) {
-        Matcher matcher = Pattern.compile(regex).matcher(self);
+    public static String replaceAll(final String self, final String regex, final Closure closure) {
+        final Matcher matcher = Pattern.compile(regex).matcher(self);
         if (matcher.find()) {
-            matcher.reset();
-            StringBuffer sb = new StringBuffer();
-            while (matcher.find()) {
+            final StringBuffer sb = new StringBuffer();
+            do {
                 int count = matcher.groupCount();
                 List groups = new ArrayList();
                 for (int i = 0; i <= count; i++) {
                     groups.add(matcher.group(i));
                 }
-                matcher.appendReplacement(sb, String.valueOf(closure.call(groups.toArray())));
-            }
+                final String replacement = String.valueOf(closure.call(groups.toArray()));
+                matcher.appendReplacement(sb, Matcher.quoteReplacement(replacement));
+            } while (matcher.find());
             matcher.appendTail(sb);
             return sb.toString();
         } else {
diff --git a/src/test/groovy/RegularExpressionsTest.groovy b/src/test/groovy/RegularExpressionsTest.groovy
index 70fc1a22be..09ec6aa831 100644
--- a/src/test/groovy/RegularExpressionsTest.groovy
+++ b/src/test/groovy/RegularExpressionsTest.groovy
@@ -387,4 +387,12 @@ class RegularExpressionsTest extends GroovyTestCase {
         }
         assert result == ['0:[abd, d]', '1:[abxyz, xyz]', '2:[abx, x]']
     }
+    
+    void testReplaceAllClosure() {
+        def p = /([^z]*)(z)/
+        def c = { all, m, d -> m }
+        assert 'x12345' == 'x123z45'.replaceAll(p, c)
+        assert 'x1\\2345' == 'x1\\23z4zz5'.replaceAll(p, c)
+        assert '$1$2345' == '$1$23z45'.replaceAll(p, c)
+    }
 }
