diff --git a/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java b/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
index 9cb15f7c86..e26fc75250 100644
--- a/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
+++ b/src/main/org/codehaus/groovy/transform/CategoryASTTransformation.java
@@ -33,6 +33,7 @@ import org.codehaus.groovy.ast.expr.PropertyExpression;
 import org.codehaus.groovy.ast.expr.TupleExpression;
 import org.codehaus.groovy.ast.expr.VariableExpression;
 import org.codehaus.groovy.ast.stmt.CatchStatement;
+import org.codehaus.groovy.classgen.VariableScopeVisitor;
 import org.codehaus.groovy.control.CompilePhase;
 import org.codehaus.groovy.control.SourceUnit;
 import org.codehaus.groovy.control.messages.SyntaxErrorMessage;
@@ -238,6 +239,7 @@ public class CategoryASTTransformation implements ASTTransformation, Opcodes {
                 expressionTransformer.visitMethod(method);
             }
         }
+        new VariableScopeVisitor(source, true).visitClass(parent);
     }
 
     private boolean ensureNoInstanceFieldOrProperty(final SourceUnit source, final ClassNode parent) {
diff --git a/src/test/groovy/lang/CategoryAnnotationTest.groovy b/src/test/groovy/lang/CategoryAnnotationTest.groovy
index d49ffa38a8..e6bc6b5899 100644
--- a/src/test/groovy/lang/CategoryAnnotationTest.groovy
+++ b/src/test/groovy/lang/CategoryAnnotationTest.groovy
@@ -269,5 +269,27 @@ class CategoryAnnotationTest extends GroovyTestCase {
             assert new Bar().foo() == 5
         '''
     }
+
+    void testCategoryShouldBeCompatibleWithCompileStatic_GROOVY6917() {
+        assertScript '''
+            @groovy.transform.CompileStatic
+            @Category(Integer)
+            class IntegerCategory {
+                Integer twice() { this * 2 }
+                List<Integer> multiplesUpTo(Integer num) {
+                    (2..num).collect{ j -> this * j }
+                }
+                List<Integer> multiplyAll(List<Integer> nums) {
+                    nums.collect{ it * this }
+                }
+            }
+
+            use(IntegerCategory) {
+                assert 7.twice() == 14
+                assert 7.multiplesUpTo(4) == [14, 21, 28]
+                assert 7.multiplyAll([1, 3, 5]) == [7, 21, 35]
+            }
+        '''
+    }
 }
 
