diff --git a/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java b/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java
index 07240c8f4f..bd839c71ee 100644
--- a/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java
+++ b/src/main/org/codehaus/groovy/classgen/VariableScopeVisitor.java
@@ -465,7 +465,8 @@ public class VariableScopeVisitor extends ClassCodeVisitorSupport {
         pushState(node.isStatic());
         inConstructor = isConstructor;
         node.setVariableScope(currentScope);
-
+        visitAnnotations(node);
+        
         // GROOVY-2156
         Parameter[] parameters = node.getParameters();
         for (Parameter parameter : parameters) {
@@ -473,8 +474,8 @@ public class VariableScopeVisitor extends ClassCodeVisitorSupport {
         }
 
         declare(node.getParameters(), node);
-
-        super.visitConstructorOrMethod(node, isConstructor);
+        visitClassCodeContainer(node.getCode());
+        
         popState();
     }
 
diff --git a/src/test/gls/annotations/closures/AnnotationClosureWithNonLocalVariable.groovy b/src/test/gls/annotations/closures/AnnotationClosureWithNonLocalVariable.groovy
new file mode 100644
index 0000000000..eeb445bc50
--- /dev/null
+++ b/src/test/gls/annotations/closures/AnnotationClosureWithNonLocalVariable.groovy
@@ -0,0 +1,25 @@
+package gls.annotations.closures
+
+class AnnotationClosureWithNonLocalVariable extends GroovyTestCase {
+    
+    void testVanillaVariable() {
+        assertScript """
+            import java.lang.annotation.*
+            
+            @Retention(RetentionPolicy.RUNTIME)
+            @interface Foo {
+                Class value()
+            }
+            
+            class X {
+                @Foo({ value })
+                def doit(value) {}
+            }
+            def clazz =  X.class.getDeclaredMethod("doit",[Object] as Class[]).getAnnotation(Foo.class).value()
+            def closure = clazz.newInstance(this,this)
+            closure.delegate = [value:1]
+            assert closure() == 1        
+        """
+    }
+
+}
\ No newline at end of file
