diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index a30d08ca24..8d057f0a1b 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -6554,7 +6554,9 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
     public static <K, V> Map<K, V> subMap(Map<K, V> map, Collection<K> keys) {
         Map<K, V> answer = new LinkedHashMap<K, V>(keys.size());
         for (K key : keys) {
-            answer.put(key, map.get(key));
+            if (map.containsKey(key)) {
+                answer.put(key, map.get(key));
+            }
         }
         return answer;
     }
@@ -6578,7 +6580,9 @@ public class DefaultGroovyMethods extends DefaultGroovyMethodsSupport {
     public static <K, V> Map<K, V> subMap(Map<K, V> map, K[] keys) {
         Map<K, V> answer = new LinkedHashMap<K, V>(keys.length);
         for (K key : keys) {
-            answer.put(key, map.get(key));
+            if (map.containsKey(key)) {
+                answer.put(key, map.get(key));
+            }
         }
         return answer;
     }
diff --git a/src/test/groovy/SubscriptTest.groovy b/src/test/groovy/SubscriptTest.groovy
index c154a31338..880b145a9a 100644
--- a/src/test/groovy/SubscriptTest.groovy
+++ b/src/test/groovy/SubscriptTest.groovy
@@ -196,7 +196,22 @@ class SubscriptTest extends GroovyTestCase {
         
         assert map.getClass() == sub.getClass()
     }
-    
+
+    void testSubMapWithNonExistentKey() {
+        def map = ['a':123, 'b':456, 'c':789]
+
+        def keys = ['b', 'a', 'd']
+        def sub = map.subMap(keys)
+
+        assert sub.size() == 2
+        assert sub['a'] == 123
+        assert sub['b'] == 456
+        assert ! sub.containsKey('c')
+        assert ! sub.containsKey('d')
+
+        assert map.getClass() == sub.getClass()
+    }
+
     void testListWithinAListSyntax() {
         def list = [1, 2, 3, 4..10, 5, 6]
         
