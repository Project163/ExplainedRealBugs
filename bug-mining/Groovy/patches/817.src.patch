diff --git a/src/main/groovy/lang/Binding.java b/src/main/groovy/lang/Binding.java
index f8e54e2524..d66574b97a 100644
--- a/src/main/groovy/lang/Binding.java
+++ b/src/main/groovy/lang/Binding.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2007 the original author or authors.
+ * Copyright 2003-2008 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -15,68 +15,69 @@
  */
 package groovy.lang;
 
-import java.util.HashMap;
+import java.util.LinkedHashMap;
 import java.util.Map;
 
 /**
  * Represents the variable bindings of a script which can be altered
  * from outside the script object or created outside of a script and passed
  * into it.
- * 
+ *
  * @author <a href="mailto:james@coredevelopers.net">James Strachan</a>
  * @version $Revision$
  */
 public class Binding extends GroovyObjectSupport {
     private Map variables;
-    
+
     public Binding() {
     }
-    
+
     public Binding(Map variables) {
         this.variables = variables;
     }
-    
+
     /**
      * A helper constructor used in main(String[]) method calls
-     * 
+     *
      * @param args are the command line arguments from a main()
      */
     public Binding(String[] args) {
         this();
         setVariable("args", args);
     }
-    
+
     /**
      * @param name the name of the variable to lookup
      * @return the variable value
      */
     public Object getVariable(String name) {
         if (variables == null)
-            throw new MissingPropertyException(name, Binding.class);
+            throw new MissingPropertyException(name, this.getClass());
 
         Object result = variables.get(name);
-        
+
         if (result == null && !variables.containsKey(name)) {
-            throw new MissingPropertyException(name, Binding.class);
+            throw new MissingPropertyException(name, this.getClass());
         }
-        
+
         return result;
     }
-    
+
     /**
      * Sets the value of the given variable
-     * @param name the name of the variable to set
+     *
+     * @param name  the name of the variable to set
      * @param value the new value for the given variable
      */
     public void setVariable(String name, Object value) {
         if (variables == null)
-          variables = new HashMap();
+            variables = new LinkedHashMap();
         variables.put(name, value);
     }
-    
+
     public Map getVariables() {
         if (variables == null)
-          variables = new HashMap();
+            variables = new LinkedHashMap();
         return variables;
     }
 
diff --git a/src/main/groovy/servlet/ServletBinding.java b/src/main/groovy/servlet/ServletBinding.java
index 992280c1c6..5d3d63c95d 100644
--- a/src/main/groovy/servlet/ServletBinding.java
+++ b/src/main/groovy/servlet/ServletBinding.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2007 the original author or authors.
+ * Copyright 2003-2008 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -18,77 +18,67 @@ package groovy.servlet;
 import groovy.lang.Binding;
 import groovy.xml.MarkupBuilder;
 
+import javax.servlet.ServletContext;
+import javax.servlet.http.HttpServletRequest;
+import javax.servlet.http.HttpServletResponse;
 import java.io.IOException;
 import java.util.Enumeration;
 import java.util.HashMap;
+import java.util.LinkedHashMap;
 import java.util.Map;
 
-import javax.servlet.ServletContext;
-import javax.servlet.http.HttpServletRequest;
-import javax.servlet.http.HttpServletResponse;
-
 /**
  * Servlet-specific binding extension to lazy load the writer or the output
  * stream from the response.
- * 
+ * <p/>
  * <p>
- * <h3>Default variables bound</h3>
+ * <h3>Eager variables bound</h3>
  * <ul>
  * <li><tt>"request"</tt> : the HttpServletRequest object</li>
- * <li><tt>"response"</tt> : the HttpServletResponse object</li>
- * <li><tt>"context"</tt> : the ServletContext object </li>
+ * <li><tt>"response"</tt> : the HttpServletRequest object</li>
+ * <li><tt>"context"</tt> : the ServletContext object</li>
  * <li><tt>"application"</tt> : same as context</li>
- * <li><tt>"session"</tt> : convenient for <code>request.getSession(<b>false</b>)</code> - can be null!</li>
+ * <li><tt>"session"</tt> : shorthand for <code>request.getSession(<tt>false</tt>)</code> - can be null!</li>
  * <li><tt>"params"</tt> : map of all form parameters - can be empty</li>
- * <li><tt>"headers"</tt> : map of all <b>request</b> header fields</li>
+ * <li><tt>"headers"</tt> : map of all <tt>request</tt> header fields</li>
  * </ul>
- * 
+ * <p/>
  * <p>
- * <h3>Implicite bound variables</h3>
+ * <h3>Lazy variables bound</h3>
  * <ul>
- * <li><tt>"out"</tt> : response.getWriter() </li>
- * <li><tt>"sout"</tt> : response.getOutputStream() </li>
- * <li><tt>"html"</tt> : new MarkupBuilder(response.getWriter()) </li>
+ * <li><tt>"out"</tt> : response.getWriter()</li>
+ * <li><tt>"sout"</tt> : response.getOutputStream()</li>
+ * <li><tt>"html"</tt> : new MarkupBuilder(response.getWriter())</li>
  * </ul>
  * </p>
- * 
+ *
  * @author Guillaume Laforge
  * @author Christian Stein
  */
 public class ServletBinding extends Binding {
-
-    private final Binding binding;
-
-    private final ServletContext context;
-
-    private final HttpServletRequest request;
-
-    private final HttpServletResponse response;
-
-    private MarkupBuilder html;
+    private boolean initialized;
 
     /**
      * Initializes a servlet binding.
+     *
+     * @param request  the HttpServletRequest object
+     * @param response the HttpServletRequest object
+     * @param context  the ServletContext object
      */
     public ServletBinding(HttpServletRequest request, HttpServletResponse response, ServletContext context) {
-        this.binding = new Binding();
-        this.request = request;
-        this.response = response;
-        this.context = context;
-
         /*
          * Bind the default variables.
          */
-        binding.setVariable("request", request);
-        binding.setVariable("response", response);
-        binding.setVariable("context", context);
-        binding.setVariable("application", context);
+        super.setVariable("request", request);
+        super.setVariable("response", response);
+        super.setVariable("context", context);
+        super.setVariable("application", context);
 
         /*
          * Bind the HTTP session object - if there is one.
          * Note: we don't create one here!
          */
-        binding.setVariable("session", request.getSession(false));
+        super.setVariable("session", request.getSession(false));
 
         /*
          * Bind form parameter key-value hash map.
@@ -98,7 +88,7 @@ public class ServletBinding extends Binding {
         Map params = new HashMap();
         for (Enumeration names = request.getParameterNames(); names.hasMoreElements();) {
             String name = (String) names.nextElement();
-            if (!binding.getVariables().containsKey(name)) {
+            if (!super.getVariables().containsKey(name)) {
                 String[] values = request.getParameterValues(name);
                 if (values.length == 1) {
                     params.put(name, values[0]);
@@ -107,93 +97,75 @@ public class ServletBinding extends Binding {
                 }
             }
         }
-        binding.setVariable("params", params);
+        super.setVariable("params", params);
 
         /*
          * Bind request header key-value hash map.
          */
-        Map headers = new HashMap();
+        Map<String, String> headers = new LinkedHashMap<String, String>();
         for (Enumeration names = request.getHeaderNames(); names.hasMoreElements();) {
             String headerName = (String) names.nextElement();
             String headerValue = request.getHeader(headerName);
             headers.put(headerName, headerValue);
         }
-        binding.setVariable("headers", headers);
+        super.setVariable("headers", headers);
     }
 
+    @Override
     public void setVariable(String name, Object value) {
-        /*
-         * Check sanity.
-         */
-        if (name == null) {
-            throw new IllegalArgumentException("Can't bind variable to null key.");
-        }
-        if (name.length() == 0) {
-            throw new IllegalArgumentException("Can't bind variable to blank key name. [length=0]");
-        }
-        /*
-         * Check implicite key names. See getVariable(String)!
-         */
-        if ("out".equals(name)) {
-            throw new IllegalArgumentException("Can't bind variable to key named '" + name + "'.");
-        }
-        if ("sout".equals(name)) {
-            throw new IllegalArgumentException("Can't bind variable to key named '" + name + "'.");
-        }
-        if ("html".equals(name)) {
-            throw new IllegalArgumentException("Can't bind variable to key named '" + name + "'.");
-        }
-        /*
-         * TODO Check default key names. See constructor(s).
-         */
-        
-        /*
-         * All checks passed, set the variable.
-         */
-        binding.setVariable(name, value);
+        lazyInit();
+        validateArgs(name, "Can't bind variable to");
+        excludeReservedName(name, "out");
+        excludeReservedName(name, "sout");
+        excludeReservedName(name, "html");
+        super.setVariable(name, value);
     }
 
+    @Override
     public Map getVariables() {
-        return binding.getVariables();
+        lazyInit();
+        return super.getVariables();
     }
 
     /**
      * @return a writer, an output stream, a markup builder or another requested object
      */
+    @Override
     public Object getVariable(String name) {
-        /*
-         * Check sanity.
-         */
-        if (name == null) {
-            throw new IllegalArgumentException("No variable with null key name.");
-        }
-        if (name.length() == 0) {
-            throw new IllegalArgumentException("No variable with blank key name. [length=0]");
-        }
-        /*
-         * Check implicite key names. See setVariable(String, Object)!
-         */
+        lazyInit();
+        validateArgs(name, "No variable with");
+        return super.getVariable(name);
+    }
+
+    private void lazyInit() {
+        if (initialized) return;
+        initialized = true;
+        HttpServletResponse response = (HttpServletResponse) super.getVariable("response");
+        ServletContext context = (ServletContext) super.getVariable("context");
         try {
-            if ("out".equals(name)) {
-                return response.getWriter();
-            }
-            if ("sout".equals(name)) {
-                return response.getOutputStream();
-            }
-            if ("html".equals(name)) {
-                if (html == null) {
-                    html = new MarkupBuilder(response.getWriter());
-                }
-                return html;
-            }
+            super.setVariable("out", response.getWriter());
+            super.setVariable("sout", response.getOutputStream());
+            super.setVariable("html", new MarkupBuilder(response.getWriter()));
         } catch (IOException e) {
             String message = "Failed to get writer or output stream from response.";
             context.log(message, e);
             throw new RuntimeException(message, e);
         }
-        /*
-         * Still here? Delegate to the binding object.
-         */
-        return binding.getVariable(name);
+    }
+
+    private void validateArgs(String name, String message) {
+        if (name == null) {
+            throw new IllegalArgumentException(message + " null key.");
+        }
+        if (name.length() == 0) {
+            throw new IllegalArgumentException(message + " blank key name. [length=0]");
+        }
+    }
+
+    private void excludeReservedName(String name, String reservedName) {
+        if (reservedName.equals(name)) {
+            throw new IllegalArgumentException("Can't bind variable to key named '" + name + "'.");
+        }
     }
 }
+
diff --git a/src/test/groovy/servlet/ServletBindingTest.groovy b/src/test/groovy/servlet/ServletBindingTest.groovy
index bff8d0f692..c66ac060da 100644
--- a/src/test/groovy/servlet/ServletBindingTest.groovy
+++ b/src/test/groovy/servlet/ServletBindingTest.groovy
@@ -1,176 +1,207 @@
+/*
+ * Copyright 2003-2008 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package groovy.servlet
 
-import javax.servlet.http.HttpSession
-import javax.servlet.http.HttpServletRequest
-import javax.servlet.http.HttpServletResponse
 import javax.servlet.ServletContext
 import javax.servlet.ServletOutputStream
+import javax.servlet.http.HttpServletRequest
+import javax.servlet.http.HttpServletResponse
+import javax.servlet.http.HttpSession
 
 /**
-* This test case tests the ServletBinding class. 
-* 
-* @author Hamlet D'Arcy
-*/ 
+ * This test case tests the ServletBinding class.
+ *
+ * @author Hamlet D'Arcy
+ */
 class ServletBindingTest extends GroovyTestCase {
 
-	def session = {} as HttpSession
-	def response = {} as HttpServletResponse
-	def context = {} as ServletContext
-	
-	void setUp() {
-		super.setUp()
-	}
-	
-	def makeDefaultBinding = { request ->
-		new ServletBinding(
-		    request as HttpServletRequest, 
-		    response as HttpServletResponse, 
-		    context as ServletContext
-		)
-	}
-	
-	def makeDefaultRequest  = {
-		[ getSession: {session}, 
-		getParameterNames: {new Vector().elements()}, 
-		getHeaderNames: {new Vector().elements()} ] as HttpServletRequest
-	}
-	
-	/**
-	* Tests that the constructor binds the correct default variables. 
-	*/
-	void testConstructor_VariableBindings() {
-		def request = makeDefaultRequest()
-		def binding = makeDefaultBinding(request)
-		
-		assert request == binding.getVariable("request")
-		assert response == binding.getVariable("response")
-		assert context == binding.getVariable("context")
-		assert context == binding.getVariable("application")
-		assert session == binding.getVariable("session")
-		assertTrue binding.getVariable("params").isEmpty()
-		assertTrue binding.getVariable("headers").isEmpty()
-	}
-	
-	/**
-	* Tests that the constructor binds request parameter names correctly. 
-	*/ 
-	void testConstructor_ParameterNameBindings() {
-
-		def parmNames = new Vector()
-		parmNames.add("name1")
-		parmNames.add("name2")
-
-		def request = [ 
-		    getSession: {session}, 
-			getHeaderNames: {new Vector().elements()}, 
-		    getParameterNames: {parmNames.elements()}, 
-			getParameterValues: { 
-		        //prepend string parm to known value to simulate attribute map
-		        String[] arr = new String[1]; 
-		        arr[0] = "value_for_" + it
-		        return arr} ] as HttpServletRequest
-
-		def binding = makeDefaultBinding(request)
-
-		def variables = binding.getVariable("params")
-		assert 2 == variables.size()
-		assert "value_for_name1" == variables.get("name1")
-		assert "value_for_name2" == variables.get("name2")	
-	}
-	
-	/**
-	* Tests that the constructor binds request header values correctly. 
-	*/ 
-	void testConstructor_HeaderBindings() {
-		def headerNames = new Vector()
-		headerNames.add("name1")
-		headerNames.add("name2")
-
-		def request = [ 
-		    getSession: {session}, 
-		    getParameterNames: {new Vector().elements()}, 
-		    getHeaderNames: {headerNames.elements()}, 
-		    getHeader: { 
-		        //prepend string parm to known value to simulate attribute map
-		        "value_for_" + it
-		        } ] as HttpServletRequest
-
-		def binding = makeDefaultBinding(request)
-
-		def variables = binding.getVariable("headers")
-		assert 2 == variables.size()
-		assert "value_for_name1" == variables.get("name1")
-		assert "value_for_name2" == variables.get("name2")		
-	}
-	
-	/**
-	* Tests the argument contract on getVariable. 
-	*/ 
-	void testGetVariable_Contract() {
-		
-		def request = makeDefaultRequest()
-		def binding = makeDefaultBinding(request)
-		
-		shouldFail(IllegalArgumentException) { binding.getVariable(null) }
-		shouldFail(IllegalArgumentException) { binding.getVariable("") }
-	}
-
-	/**
-	* Tests that getVariable works for the special key names. 
-	*/ 
-	void testGetVariable_ImplicitKeyNames() {
-		
-		def writer = new PrintWriter(new StringWriter())
-		def outputStream = new OutputStreamStub()
-
-		def response = [
-		    getWriter: {writer}, 
-		    getOutputStream: {outputStream} ] as HttpServletResponse
-
-		def request = makeDefaultRequest()
-
-		def binding = new ServletBinding(
-		    request as HttpServletRequest, 
-		    response as HttpServletResponse, 
-		    context as ServletContext
-		)
-
-		assert writer == binding.getVariable("out")
-		assert binding.getVariable("html") instanceof groovy.xml.MarkupBuilder
-		assert outputStream == binding.getVariable("sout")
-	}
-	
-	/**
-	* Tests the contract on setVarible(). 
-	*/ 
-	void testSetVariable_Contract() {
-		
-		def request = makeDefaultRequest()
-		def binding = makeDefaultBinding(request)
-		
-		shouldFail(IllegalArgumentException) { binding.setVariable(null, null) }
-		shouldFail(IllegalArgumentException) { binding.setVariable("", null) }
-		shouldFail(IllegalArgumentException) { binding.setVariable("out", null) }
-		shouldFail(IllegalArgumentException) { binding.setVariable("sout", null) }
-		shouldFail(IllegalArgumentException) { binding.setVariable("html", null) }		
-	}
-	
-	/**
-	* Tests setVariable. 
-	*/ 
-	void testSetVariable() {
-		def request = makeDefaultRequest()
-		def binding = makeDefaultBinding(request)
-		
-		binding.setVariable("var_name", "var_value")
-		def variables = binding.getVariables()
-		assert "var_value" == variables.get("var_name")
-	}
+    def session = {} as HttpSession
+    def response = {} as HttpServletResponse
+    def context = {} as ServletContext
+
+    void setUp() {
+        super.setUp()
+    }
+
+    def makeDefaultBinding = {request ->
+        new ServletBinding(
+                request as HttpServletRequest,
+                response as HttpServletResponse,
+                context as ServletContext
+        )
+    }
+
+    def makeDefaultRequest = {
+        [getSession: {session},
+                getParameterNames: {new Vector().elements()},
+                getHeaderNames: {new Vector().elements()}] as HttpServletRequest
+    }
+
+    /**
+     * Tests that the constructor binds the correct default variables.
+     */
+    void testConstructor_VariableBindings() {
+        def request = makeDefaultRequest()
+        def binding = makeDefaultBinding(request)
+
+        assert request == binding.getVariable("request")
+        assert response == binding.getVariable("response")
+        assert context == binding.getVariable("context")
+        assert context == binding.getVariable("application")
+        assert session == binding.getVariable("session")
+        assertTrue binding.getVariable("params").isEmpty()
+        assertTrue binding.getVariable("headers").isEmpty()
+    }
+
+    /**
+     * Tests that the constructor binds request parameter names correctly.
+     */
+    void testConstructor_ParameterNameBindings() {
+
+        def parmNames = new Vector()
+        parmNames.add("name1")
+        parmNames.add("name2")
+
+        def request = [
+                getSession: {session},
+                getHeaderNames: {new Vector().elements()},
+                getParameterNames: {parmNames.elements()},
+                getParameterValues: {
+                    //prepend string parm to known value to simulate attribute map
+                    String[] arr = new String[1];
+                    arr[0] = "value_for_" + it
+                    return arr
+                }] as HttpServletRequest
+
+        def binding = makeDefaultBinding(request)
+
+        def variables = binding.getVariable("params")
+        assert 2 == variables.size()
+        assert "value_for_name1" == variables.get("name1")
+        assert "value_for_name2" == variables.get("name2")
+    }
+
+    /**
+     * Tests that the constructor binds request header values correctly.
+     */
+    void testConstructor_HeaderBindings() {
+        def headerNames = new Vector()
+        headerNames.add("name1")
+        headerNames.add("name2")
+
+        def request = [
+                getSession: {session},
+                getParameterNames: {new Vector().elements()},
+                getHeaderNames: {headerNames.elements()},
+                getHeader: {
+                    //prepend string parm to known value to simulate attribute map
+                    "value_for_" + it
+                }] as HttpServletRequest
+
+        def binding = makeDefaultBinding(request)
+
+        def variables = binding.getVariable("headers")
+        assert 2 == variables.size()
+        assert "value_for_name1" == variables.get("name1")
+        assert "value_for_name2" == variables.get("name2")
+    }
+
+    /**
+     * Tests the argument contract on getVariable.
+     */
+    void testGetVariable_Contract() {
+
+        def request = makeDefaultRequest()
+        def binding = makeDefaultBinding(request)
+
+        shouldFail(IllegalArgumentException) { binding.getVariable(null) }
+        shouldFail(IllegalArgumentException) { binding.getVariable("") }
+    }
+
+    /**
+     * Tests that getVariables truely returns all variables
+     */
+    void testGetVariables_Contract() {
+
+        def expectedVariables = ["request", "response", "context", "application",
+                "session", "params", "headers", "out", "sout", "html"]
+        def request = makeDefaultRequest()
+        def binding = makeDefaultBinding(request)
+        def keys = binding.variables.keySet()
+        expectedVariables.each {
+            assert keys.contains(it)
+        }
+    }
+
+    /**
+     * Tests that getVariable works for the special key names.
+     */
+    void testGetVariable_ImplicitKeyNames() {
+
+        def writer = new PrintWriter(new StringWriter())
+        def outputStream = new OutputStreamStub()
+
+        def response = [
+                getWriter: {writer},
+                getOutputStream: {outputStream}] as HttpServletResponse
+
+        def request = makeDefaultRequest()
+
+        def binding = new ServletBinding(
+                request as HttpServletRequest,
+                response as HttpServletResponse,
+                context as ServletContext
+        )
+
+        assert writer == binding.getVariable("out")
+        assert binding.getVariable("html") instanceof groovy.xml.MarkupBuilder
+        assert outputStream == binding.getVariable("sout")
+    }
+
+    /**
+     * Tests the contract on setVarible().
+     */
+    void testSetVariable_Contract() {
+
+        def request = makeDefaultRequest()
+        def binding = makeDefaultBinding(request)
+
+        shouldFail(IllegalArgumentException) { binding.setVariable(null, null) }
+        shouldFail(IllegalArgumentException) { binding.setVariable("", null) }
+        shouldFail(IllegalArgumentException) { binding.setVariable("out", null) }
+        shouldFail(IllegalArgumentException) { binding.setVariable("sout", null) }
+        shouldFail(IllegalArgumentException) { binding.setVariable("html", null) }
+    }
+
+    /**
+     * Tests setVariable.
+     */
+    void testSetVariable() {
+        def request = makeDefaultRequest()
+        def binding = makeDefaultBinding(request)
+
+        binding.setVariable("var_name", "var_value")
+        def variables = binding.getVariables()
+        assert "var_value" == variables.get("var_name")
+    }
 }
 
 /**
-* Test specific sub class to stub out the ServletOutputStream class. 
-*/ 
+ * Test specific sub class to stub out the ServletOutputStream class.
+ */
 class OutputStreamStub extends ServletOutputStream {
-    void write(int x) {   }
+    void write(int x) { }
 }
