diff --git a/src/main/groovy/lang/GroovyClassLoader.java b/src/main/groovy/lang/GroovyClassLoader.java
index 40b3626e9f..e56fb5bb7a 100644
--- a/src/main/groovy/lang/GroovyClassLoader.java
+++ b/src/main/groovy/lang/GroovyClassLoader.java
@@ -730,13 +730,25 @@ public class GroovyClassLoader extends URLClassLoader {
             if ((oldClass != null && isSourceNewer(source, oldClass)) || (oldClass == null)) {
                 synchronized (sourceCache) {
                     sourceCache.remove(className);
-                    return parseClass(source.openStream(), className);
+                    if (isFile(source)) {
+                        try {
+                            return doParseClass(new GroovyCodeSource(new File(source.toURI()), config.getSourceEncoding()));
+                        } catch (URISyntaxException e) {
+                          // do nothing and fall back to the other version
+                        }
+                    }
+                    return parseClass(source.openStream(), makeFileName(className));
                 }
             }
         }
         return oldClass;
     }
-    
+
+    private String makeFileName(String className) {
+      className = className.replace('.','/');
+      return className+".groovy";
+    }
+
     /**
      * Implemented here to check package access prior to returning an
      * already loaded class.
diff --git a/src/test/groovy/lang/ScriptCacheTest.groovy b/src/test/groovy/lang/ScriptCacheTest.groovy
new file mode 100644
index 0000000000..8e8ce26f6f
--- /dev/null
+++ b/src/test/groovy/lang/ScriptCacheTest.groovy
@@ -0,0 +1,43 @@
+package groovy.lang
+
+class ScriptCacheTest extends GroovyTestCase {
+
+    def packageName = "scriptcachetest"
+    def className
+    def cl = new GroovyClassLoader(this.class.classLoader);
+    def file
+    def packageDir
+
+    public void setUp() {
+        packageDir = new File(new File("target"), packageName)
+        packageDir.mkdir()
+        packageDir.deleteOnExit()
+        file = File.createTempFile("TestScriptCache", ".groovy", packageDir)
+        file.deleteOnExit()
+        className = "${packageName}.${file.name - '.groovy'}"
+
+        def currentDir = packageDir.parentFile.absolutePath
+        cl.addClasspath(currentDir)
+        file.write """
+            package ${packageName}
+
+            def greeting = "hello"
+        """
+    }
+
+    public void tearDown() {
+        file.delete()
+        packageDir.delete()
+    }
+
+    public void testScriptCaching() {
+        def groovyClass1 = cl.loadClass(className, true, false)
+        def groovyClass2 = cl.loadClass(className, true, false)
+        assert groovyClass1 == groovyClass2
+    }
+
+    void testScriptNaming() {
+        def groovyClass1 = cl.loadClass(className, true, false)
+        assert groovyClass1.getName() == className
+    }
+}
