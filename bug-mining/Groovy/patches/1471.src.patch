diff --git a/src/main/groovy/util/CliBuilder.groovy b/src/main/groovy/util/CliBuilder.groovy
index 2357ec0ad8..f9c69575b0 100644
--- a/src/main/groovy/util/CliBuilder.groovy
+++ b/src/main/groovy/util/CliBuilder.groovy
@@ -293,7 +293,7 @@ class CliBuilder {
     static expandArgumentFiles(args) throws IOException {
         def result = []
         for (arg in args) {
-            if (arg[0] == '@') {
+            if (arg && arg[0] == '@') {
                 arg = arg.substring(1)
                 if (arg[0] != '@') {
                     expandArgumentFile(arg, result)
diff --git a/src/test/groovy/util/CliBuilderTest.groovy b/src/test/groovy/util/CliBuilderTest.groovy
index 71eb575a11..cbd7bd18a6 100644
--- a/src/test/groovy/util/CliBuilderTest.groovy
+++ b/src/test/groovy/util/CliBuilderTest.groovy
@@ -461,4 +461,14 @@ usage: groovy
         assert options.dbpassword == 'foo'
         assert options.i
     }
+
+    void testNoExpandArgsWithEmptyArg() {
+        def cli = new CliBuilder(expandArgumentFiles: false)
+        cli.parse(['something', ''])
+    }
+
+    void testExpandArgsWithEmptyArg() {
+        def cli = new CliBuilder(expandArgumentFiles: true)
+        cli.parse(['something', ''])
+    }
 }
