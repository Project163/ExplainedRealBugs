diff --git a/src/main/java/org/codehaus/groovy/transform/sc/TemporaryVariableExpression.java b/src/main/java/org/codehaus/groovy/transform/sc/TemporaryVariableExpression.java
index 515cbf88ee..14e95212b5 100644
--- a/src/main/java/org/codehaus/groovy/transform/sc/TemporaryVariableExpression.java
+++ b/src/main/java/org/codehaus/groovy/transform/sc/TemporaryVariableExpression.java
@@ -43,6 +43,7 @@ public class TemporaryVariableExpression extends Expression {
 
     public TemporaryVariableExpression(final Expression expression) {
         this.expression = expression;
+        setType(expression.getType());
         putNodeMetaData(INFERRED_TYPE, expression.getNodeMetaData(INFERRED_TYPE));
     }
 
diff --git a/src/main/java/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java b/src/main/java/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
index 53803c1466..a66c233b47 100644
--- a/src/main/java/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
+++ b/src/main/java/org/codehaus/groovy/transform/sc/transformers/BinaryExpressionTransformer.java
@@ -24,6 +24,7 @@ import org.codehaus.groovy.ast.MethodNode;
 import org.codehaus.groovy.ast.Parameter;
 import org.codehaus.groovy.ast.expr.ArrayExpression;
 import org.codehaus.groovy.ast.expr.BinaryExpression;
+import org.codehaus.groovy.ast.expr.ClassExpression;
 import org.codehaus.groovy.ast.expr.ConstantExpression;
 import org.codehaus.groovy.ast.expr.DeclarationExpression;
 import org.codehaus.groovy.ast.expr.Expression;
@@ -235,14 +236,24 @@ public class BinaryExpressionTransformer {
         if (rightExpression instanceof ListExpression
                 || rightExpression instanceof MapExpression
                 || rightExpression instanceof RangeExpression
+                || rightExpression instanceof ClassExpression
                 || rightExpression instanceof ConstantExpression
                             && !isNullConstant(rightExpression))
             return staticCompilationTransformer.transform(call);
 
-        // then "right == null ? left == null : right.isCase(left)" for null safety
+        // GROOVY-6137, GROOVY-7473: null safety and one-time evaluation
+        call.setObjectExpression(rightExpression = transformRepeatedReference(rightExpression));
         return staticCompilationTransformer.transform(ternaryX(isNullX(rightExpression), isNullX(leftExpression), call));
     }
 
+    private Expression transformRepeatedReference(final Expression expr) {
+        if (expr instanceof ConstantExpression || expr instanceof VariableExpression
+                && ((VariableExpression) expr).getAccessedVariable() instanceof Parameter) {
+            return expr;
+        }
+        return new TemporaryVariableExpression(expr);
+    }
+
     private Expression transformEqualityComparison(final BinaryExpression bin, final boolean eq) {
         Expression leftExpression = bin.getLeftExpression(), rightExpression = bin.getRightExpression();
         if (isNullConstant(rightExpression)) {
@@ -377,8 +388,8 @@ public class BinaryExpressionTransformer {
             if (left instanceof BinaryExpression) {
                 BinaryExpression be = (BinaryExpression) left;
                 if (be.getOperation().getType() == Types.LEFT_SQUARE_BRACKET) {
-                    be.setLeftExpression(new TemporaryVariableExpression(be.getLeftExpression()));
-                    be.setRightExpression(new TemporaryVariableExpression(be.getRightExpression()));
+                    be.setLeftExpression(transformRepeatedReference(be.getLeftExpression()));
+                    be.setRightExpression(transformRepeatedReference(be.getRightExpression()));
                 }
             }
             // call handles the operation, so we must add the assignment now
diff --git a/src/test/groovy/transform/stc/STCnAryExpressionTest.groovy b/src/test/groovy/transform/stc/STCnAryExpressionTest.groovy
index ac378b87a7..3da730f6bb 100644
--- a/src/test/groovy/transform/stc/STCnAryExpressionTest.groovy
+++ b/src/test/groovy/transform/stc/STCnAryExpressionTest.groovy
@@ -24,54 +24,52 @@ package groovy.transform.stc
 class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
 
     void testBinaryStringPlus() {
-        assertScript """
+        assertScript '''
             String str = 'a'
             String str2 = 'b'
             str+str2
-        """
+        '''
     }
 
     void testBinaryStringPlusInt() {
-        assertScript """
+        assertScript '''
             String str = 'a'
             int str2 = 2
             str+str2
-        """
+        '''
     }
 
     void testBinaryObjectPlusInt() {
-        shouldFailWithMessages """
+        shouldFailWithMessages '''
             def str = new Object()
             int str2 = 2
             str+str2
-        """, "Cannot find matching method java.lang.Object#plus(int)"
+        ''',
+        'Cannot find matching method java.lang.Object#plus(int)'
     }
 
     void testBinaryIntPlusObject() {
-        shouldFailWithMessages """
+        shouldFailWithMessages '''
             def str = new Object()
             int str2 = 2
             str2+str
-        """, "Cannot find matching method int#plus(java.lang.Object)"
+        ''',
+        'Cannot find matching method int#plus(java.lang.Object)'
     }
 
     void testPrimitiveComparison() {
         assertScript '''
             1<2
         '''
-
         assertScript '''
             1>2
         '''
-
         assertScript '''
             1<=2
         '''
-
         assertScript '''
             1>=2
         '''
-
         assertScript '''
             1==2
         '''
@@ -81,19 +79,15 @@ class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
         assertScript '''
             1<new Integer(2)
         '''
-
         assertScript '''
             1>new Integer(2)
         '''
-
         assertScript '''
             1<=new Integer(2)
         '''
-
         assertScript '''
             1>=new Integer(2)
         '''
-
         assertScript '''
             1==new Integer(2)
         '''
@@ -103,11 +97,9 @@ class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
         assertScript '''
             1 << 8
         '''
-
         assertScript '''
             1 >> 8
         '''
-
         assertScript '''
             1 >>> 8
         '''
@@ -119,13 +111,11 @@ class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
             int y = 8
             x << y
         '''
-
         assertScript '''
             int x = 1
             int y = 8
             x >> y
         '''
-
         assertScript '''
             int x = 1
             int y = 8
@@ -134,7 +124,7 @@ class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
     }
 
     // GROOVY-5644
-    void testSpaceshipOperatorShouldNotThrowAmbiguousError() {
+    void testSpaceshipOperatorNoAmbiguousError() {
         assertScript '''
             Integer x = 3
             Integer y = 4
@@ -142,22 +132,67 @@ class STCnAryExpressionTest extends StaticTypeCheckingTestCase {
         '''
     }
 
+    // GROOVY-7473
+    void testInOperatorShouldEvaluateOperandsOnce() {
+        assertScript '''
+            import groovy.transform.Field
+
+            @Field int i = 0
+            @Field int j = 0
+            int getA() { i++ }
+            int getB() { j++ }
+
+            def result = a in b
+            assert result
+            assert i == 1
+            assert j == 1
+        '''
+        assertScript '''
+            import groovy.transform.Field
+
+            @Field int i = 0
+            @Field int j = 0
+            def getA() { i++; null }
+            def getB() { j++ }
+
+            def result = a in b
+            assert !result
+            assert i == 1
+            assert j == 1
+        '''
+        assertScript '''
+            import groovy.transform.Field
+
+            @Field int i = 0
+            @Field int j = 0
+            def getA() { i++ }
+            def getB() { j++; null }
+
+            def result = a in b
+            assert !result
+            assert i == 1
+            assert j == 1
+        '''
+    }
+
     void testComparisonOperatorCheckWithIncompatibleTypesOkIfComparableNotImplemented() {
         shouldFailWithMessages '''
             [] < 1
-        ''', "Cannot find matching method java.util.List#compareTo(int)"
+        ''',
+        'Cannot find matching method java.util.List#compareTo(int)'
     }
 
     void testComparisonOperatorCheckWithIncompatibleTypesFailsIfComparableImplemented() {
         shouldFailWithMessages '''
            'abc' < 1
-        ''', "Cannot find matching method java.lang.String#compareTo(int)"
+        ''',
+        'Cannot find matching method java.lang.String#compareTo(int)'
     }
 
     void testCompareToCallCheckWithIncompatibleTypesAlsoFailsIfComparableImplemented() {
         shouldFailWithMessages '''
            'abc'.compareTo(1)
-        ''', "Cannot find matching method java.lang.String#compareTo(int)"
+        ''',
+        'Cannot find matching method java.lang.String#compareTo(int)'
     }
 }
-
