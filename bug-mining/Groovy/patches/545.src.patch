diff --git a/src/main/groovy/lang/ObjectRange.java b/src/main/groovy/lang/ObjectRange.java
index 3b1269599a..7e78c32741 100644
--- a/src/main/groovy/lang/ObjectRange.java
+++ b/src/main/groovy/lang/ObjectRange.java
@@ -138,8 +138,8 @@ public class ObjectRange extends AbstractList implements Range {
     /**
      * Compares an {@link ObjectRange} to another {@link ObjectRange}.
      *
-     * @return <code>true</code> if the ranges are equal
      * @param that the object to check equality with
+     * @return <code>true</code> if the ranges are equal
      */
     public boolean equals(ObjectRange that) {
         return that != null
@@ -271,10 +271,12 @@ public class ObjectRange extends AbstractList implements Range {
             } else {
                 // let's lazily calculate the size
                 size = 0;
+                Object first = from;
                 Object value = from;
                 while (to.compareTo(value) >= 0) {
                     value = increment(value);
                     size++;
+                    if (value == first) break; // handle back to beginning due to modulo incrementing
                 }
             }
         }
@@ -319,7 +321,7 @@ public class ObjectRange extends AbstractList implements Range {
 
     public boolean contains(Object value) {
         Iterator it = iterator();
-        if (value==null) return false;
+        if (value == null) return false;
         while (it.hasNext()) {
             try {
                 if (DefaultTypeTransformation.compareEqual(value, it.next())) return true;
@@ -338,20 +340,24 @@ public class ObjectRange extends AbstractList implements Range {
             step = -step;
         }
         if (step >= 0) {
+            Comparable first = from;
             Comparable value = from;
             while (value.compareTo(to) <= 0) {
                 closure.call(value);
                 for (int i = 0; i < step; i++) {
                     value = (Comparable) increment(value);
+                    if (first == value) return;
                 }
             }
         } else {
             step = -step;
+            Comparable first = to;
             Comparable value = to;
             while (value.compareTo(from) >= 0) {
                 closure.call(value);
                 for (int i = 0; i < step; i++) {
                     value = (Comparable) decrement(value);
+                    if (first == value) return;
                 }
             }
         }
diff --git a/src/main/org/codehaus/groovy/classgen/EnumVisitor.java b/src/main/org/codehaus/groovy/classgen/EnumVisitor.java
index 058d76015a..bb03cecc33 100644
--- a/src/main/org/codehaus/groovy/classgen/EnumVisitor.java
+++ b/src/main/org/codehaus/groovy/classgen/EnumVisitor.java
@@ -59,11 +59,16 @@ public class EnumVisitor extends ClassCodeVisitorSupport{
             MethodNode m = (MethodNode) methods.get(i);
             if (m.getName().equals("next") && m.getParameters().length == 0) hasNext = true;
             if (m.getName().equals("previous") && m.getParameters().length == 0) hasPrevious = true;
+            if (hasNext && hasPrevious) break;
         }
 
+        // create MIN_VALUE and MAX_VALUE fields
+        FieldNode minValue = new FieldNode("MIN_VALUE", PUBLIC_FS, enumClass, enumClass, null);
+        FieldNode maxValue = new FieldNode("MAX_VALUE", PUBLIC_FS, enumClass, enumClass, null);
+
         // create values field
         FieldNode values = new FieldNode("$VALUES",PRIVATE_FS,enumArray,enumClass,null);
-        values.setSynthetic(true);      
+        values.setSynthetic(true);
         {
             // create values() method
             MethodNode valuesMethod = new MethodNode("values",PUBLIC_FS,enumArray,new Parameter[0],ClassNode.EMPTY_ARRAY,null);
@@ -255,11 +260,15 @@ public class EnumVisitor extends ClassCodeVisitorSupport{
             int value = -1;
             Token assign = Token.newSymbol(Types.ASSIGN, -1, -1);
             List block = new ArrayList();
+            FieldNode tempMin = null;
+            FieldNode tempMax = null;
             for (Iterator iterator = fields.iterator(); iterator.hasNext();) {
                 FieldNode field = (FieldNode) iterator.next();
                 if ((field.getModifiers()&Opcodes.ACC_ENUM) == 0) continue;
                 value++;
-                
+                if (tempMin == null) tempMin = field;
+                tempMax = field;
+
                 ArgumentListExpression args = new ArgumentListExpression();
                 args.addExpression(new ConstantExpression(field.getName()));
                 args.addExpression(new ConstantExpression(new Integer(value)));
@@ -282,7 +291,25 @@ public class EnumVisitor extends ClassCodeVisitorSupport{
                 );
                 arrayInit.add(new FieldExpression(field));
             }
-            
+            block.add(
+                    new ExpressionStatement(
+                            new BinaryExpression(
+                                    new FieldExpression(minValue),
+                                    assign,
+                                    new FieldExpression(tempMin)
+                            )
+                    )
+            );
+            block.add(
+                    new ExpressionStatement(
+                            new BinaryExpression(
+                                    new FieldExpression(maxValue),
+                                    assign,
+                                    new FieldExpression(tempMax)
+                            )
+                    )
+            );
+
             block.add(
                     new ExpressionStatement(
                             new BinaryExpression(new FieldExpression(values),assign,new ArrayExpression(enumClass,arrayInit))
@@ -290,6 +317,8 @@ public class EnumVisitor extends ClassCodeVisitorSupport{
             );
             enumClass.addStaticInitializerStatements(block, true);
             enumClass.addField(values);
+            enumClass.addField(minValue);
+            enumClass.addField(maxValue);
         }
         
         
