diff --git a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
index 7a77db22e4..3a5de17cac 100644
--- a/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
+++ b/src/main/org/codehaus/groovy/runtime/DefaultGroovyMethods.java
@@ -82,6 +82,7 @@ import org.w3c.dom.NodeList;
  * @author Russel Winder
  * @author bing ran
  * @author Jochen Theodorou
+ * @author Paul King
  * @version $Revision$
  */
 public class DefaultGroovyMethods {
@@ -2657,10 +2658,8 @@ public class DefaultGroovyMethods {
         if (left.size() == 0 || right.size() == 0)
             return true;
 
-        boolean nlgnSort = sameType(new Collection[]{left, right});
-
-        Collection pickFrom = (Collection) new TreeSet(new NumberComparator());
-        ((TreeSet) pickFrom).addAll(right);
+        Collection pickFrom = new TreeSet(new NumberComparator());
+        pickFrom.addAll(right);
 
         for (Iterator iter = left.iterator(); iter.hasNext();) {
             final Object o = iter.next();
@@ -2691,6 +2690,96 @@ public class DefaultGroovyMethods {
         }
     }
 
+    public static boolean equals(int[] left, int[] right) {
+        if (left == null) {
+            return right == null;
+        }
+        if (right == null) {
+            return false;
+        }
+        if (left.length != right.length) {
+            return false;
+        }
+        for (int i = 0; i < left.length; i++) {
+            if (left[i] != right[i]) return false;
+        }
+        return true;
+    }
+
+    public static boolean equals(Object[] left, Object[] right) {
+        if (left == null) {
+            return right == null;
+        }
+        if (right == null) {
+            return false;
+        }
+        if (left.length != right.length) {
+            return false;
+        }
+        final NumberComparator numberComparator = new NumberComparator();
+        for (int i = left.length - 1; i >= 0; i--) {
+            final Object o1 = left[i];
+            final Object o2 = right[i];
+            if (o1 == null) {
+                if (o2 != null) return false;
+            } else {
+                if (o1 instanceof Number) {
+                    if (!(o2 instanceof Number && numberComparator.compare(o1, o2) == 0)) {
+                        return false;
+                    }
+                } else {
+                    // Use this way of calling equals in case the element is a List
+                    // or any other type which has an equals in DGM
+                    if (!invokeEquals(o1, o2)) return false;
+                }
+            }
+        }
+        return true;
+    }
+
+    private static boolean invokeEquals(Object o1, Object o2) {
+        return ((Boolean) InvokerHelper.invokeMethod(o1, "equals", new Object[]{o2})).booleanValue();
+    }
+
+    public static boolean equals(Object[] left, List right) {
+        return coercedEquals(left, right);
+    }
+
+    public static boolean equals(List left, Object[] right) {
+        return coercedEquals(right, left);
+    }
+
+    private static boolean coercedEquals(Object[] left, List right) {
+        if (left == null) {
+            return right == null;
+        }
+        if (right == null) {
+            return false;
+        }
+        if (left.length != right.size()) {
+            return false;
+        }
+        final NumberComparator numberComparator = new NumberComparator();
+        for (int i = left.length - 1; i >= 0; i--) {
+            final Object o1 = left[i];
+            final Object o2 = right.get(i);
+            if (o1 == null) {
+                if (o2 != null) return false;
+            } else {
+                if (o1 instanceof Number) {
+                    if (!(o2 instanceof Number && numberComparator.compare(o1, o2) == 0)) {
+                        return false;
+                    }
+                } else {
+                    // Use this way of calling equals in case the element is a List
+                    // or any other type which has an equals in DGM
+                    if (!invokeEquals(o1, o2)) return false;
+                }
+            }
+        }
+        return true;
+    }
+
     /**
      * Compare two Lists.
      * If numbers exits in the Lists, then they are compared as numbers,
@@ -2703,36 +2792,33 @@ public class DefaultGroovyMethods {
     public static boolean equals(List left, List right) {
         if (left == null) {
             return right == null;
-        } else if (right == null) {
+        }
+        if (right == null) {
             return false;
-        } else if (left.size() != right.size()) {
+        }
+        if (left.size() != right.size()) {
             return false;
-        } else {
-            final NumberComparator numberComparator = new NumberComparator();
-            final Iterator it1 = left.iterator(), it2 = right.iterator();
-
-            while (it1.hasNext()) {
-                final Object o1 = it1.next();
-                final Object o2 = it2.next();
-
-                if (o1 == null) {
-                    if (o2 != null) return false;
-                } else {
-                    if (o1 instanceof Number) {
-                        if (!(o2 instanceof Number && numberComparator.compare(o1, o2) == 0)) {
-                            return false;
-                        }
-                    } else {
-                        // Use this way of calling equals in case the elament is a List
-                        // or any other type which has an equals in DGM
-                        if (!((Boolean) InvokerHelper.invokeMethod(o1, "equals", new Object[]{o2})).booleanValue())
-                            return false;
+        }
+        final NumberComparator numberComparator = new NumberComparator();
+        final Iterator it1 = left.iterator(), it2 = right.iterator();
+        while (it1.hasNext()) {
+            final Object o1 = it1.next();
+            final Object o2 = it2.next();
+            if (o1 == null) {
+                if (o2 != null) return false;
+            } else {
+                if (o1 instanceof Number) {
+                    if (!(o2 instanceof Number && numberComparator.compare(o1, o2) == 0)) {
+                        return false;
                     }
+                } else {
+                    // Use this way of calling equals in case the element is a List
+                    // or any other type which has an equals in DGM
+                    if (!invokeEquals(o1, o2)) return false;
                 }
             }
-
-            return true;
         }
+        return true;
     }
 
     /**
diff --git a/src/main/org/codehaus/groovy/runtime/Invoker.java b/src/main/org/codehaus/groovy/runtime/Invoker.java
index 0bef515fe2..d1969a9ddf 100644
--- a/src/main/org/codehaus/groovy/runtime/Invoker.java
+++ b/src/main/org/codehaus/groovy/runtime/Invoker.java
@@ -54,7 +54,7 @@ import groovy.lang.MetaClass;
 import groovy.lang.MetaClassRegistry;
 import groovy.lang.MissingMethodException;
 
-import java.util.Map;
+import java.util.List;
 
 import org.codehaus.groovy.runtime.metaclass.MetaClassHelper;
 
@@ -128,6 +128,21 @@ public class Invoker {
 
     private Object invokePojoMethod(Object object, String methodName, Object arguments) {
         Class theClass = object.getClass();
+        // TODO move this out of here
+        if (theClass.isArray() && methodName.equals("equals") && arguments.getClass().isArray()) {
+            Object arg = ((Object[]) arguments)[0];
+            if (arg.getClass().isArray()) {
+                return Boolean.valueOf(DefaultGroovyMethods.equals((Object[])object, (Object[]) arg));
+            }
+            return Boolean.valueOf(DefaultGroovyMethods.equals((Object[])object, (List) arg));
+        }
+        else if (object instanceof List && methodName.equals("equals") && arguments.getClass().isArray()) {
+            Object arg = ((Object[]) arguments)[0];
+            if (arg.getClass().isArray()) {
+                return Boolean.valueOf(DefaultGroovyMethods.equals((List)object, (Object[]) arg));
+            }
+            return Boolean.valueOf(DefaultGroovyMethods.equals((List)object, (List) arg));
+        }
         MetaClass metaClass = metaRegistry.getMetaClass(theClass);
         return metaClass.invokeMethod(object, methodName, asArray(arguments));
     }
diff --git a/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java b/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
index 3651cd289e..b5f6338b6d 100644
--- a/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
+++ b/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java
@@ -488,13 +488,6 @@ public class DefaultTypeTransformation {
             return comparable.compareTo(right);
         }
 
-        if (left.getClass().isArray()) {
-            Collection leftList = asCollection(left);
-            if (right.getClass().isArray()) {
-                right = asCollection(right);
-            }
-            return ((Comparable) leftList).compareTo(right);
-        }
         throw new GroovyRuntimeException("Cannot compare values: " + left + " and " + right);
     }
     
@@ -503,11 +496,30 @@ public class DefaultTypeTransformation {
         if (left == null || right == null) return false;
         if (left instanceof Comparable) {
             return compareTo(left, right) == 0;
-        } else if (left instanceof List && right instanceof List) {
+        }
+        // handle int[] on both sides as special case for efficiency
+        if (left instanceof int[] && right instanceof int[]) {
+            return DefaultGroovyMethods.equals((int[]) left, (int[]) right);
+        }
+        if (left.getClass().isArray() && left.getClass().getComponentType().isPrimitive()) {
+            left = primitiveArrayToList(left);
+        }
+        if (right.getClass().isArray() && right.getClass().getComponentType().isPrimitive()) {
+            right = primitiveArrayToList(right);
+        }
+        if (left instanceof Object[] && right instanceof Object[]) {
+            return DefaultGroovyMethods.equals((Object[]) left, (Object[]) right);
+        }
+        if (left instanceof Object[] && right instanceof List) {
+            return DefaultGroovyMethods.equals((Object[]) left, (List) right);
+        }
+        if (left instanceof List && right instanceof Object[]) {
+            return DefaultGroovyMethods.equals((List) left, (Object[]) right);
+        }
+        if (left instanceof List && right instanceof List) {
             return DefaultGroovyMethods.equals((List) left, (List) right);
-        } else {
-            return left.equals(right);
         }
+        return left.equals(right);
     }
     
     /**
diff --git a/src/test/groovy/ArrayTest.groovy b/src/test/groovy/ArrayTest.groovy
index be031c012c..773789f89f 100644
--- a/src/test/groovy/ArrayTest.groovy
+++ b/src/test/groovy/ArrayTest.groovy
@@ -4,21 +4,13 @@ class ArrayTest extends GroovyTestCase {
 
     void testFixedSize() {
         def array = new String[10]
-        
         assert array.size() == 10
-        
         array[0] = "Hello"
-        
         assert array[0] == "Hello"
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
     }
     
     void testArrayWithInitializer() {
         String[] array = [ "nice", "cheese", "gromit" ]
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
-        
         assert array.size() == 3
         assert array[0] == "nice" , array.inspect()
         assert array[1] == "cheese"
@@ -26,15 +18,12 @@ class ArrayTest extends GroovyTestCase {
     }
 
     void testCharArrayCreate() {
-           def array  = new char[3]
+           def array = new char[3]
            assert array.size() == 3
     }
 
     void testCharArrayWithInitializer() {
         char[] array = [ 'a', 'b', 'c' ]
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
-        
         assert array.size() == 3
         assert array[0] == 'a' , array.inspect()
         assert array[1] == 'b'
@@ -48,9 +37,6 @@ class ArrayTest extends GroovyTestCase {
 
     void testByteArrayWithInitializer() {
         byte[] array = [0, 1, 2, 3]
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
-        
         assert array.size() == 4
         assert array[0] == 0 , array.inspect()
         assert array[1] == 1
@@ -60,7 +46,6 @@ class ArrayTest extends GroovyTestCase {
 
     void testByteArrayWithInitializerAndAssignmentOfNumber() {
         byte[] array = [ 2, 4]
-        println "Created array ${array.inspect()} with type ${array.class}"
         assert array.size() == 2
         assert array[0] == 2
         assert array[1] == 4
@@ -83,47 +68,63 @@ class ArrayTest extends GroovyTestCase {
 
     void testDoubleArrayWithInitializer() {
         double[] array = [ 1.3, 3.14, 2.7]
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
-        
         assert array.size() == 3
         assert array[0] == 1.3 , array.inspect()
         assert array[1] == 3.14
         assert array[2] == 2.7
     }
 
-
     void testIntArrayCreate() {
         def array = new int[5]
-        
         assert array.size() == 5
     }
 
     void testIntArrayWithInitializer() {
         int[] array = [42, -5, 360]
-        
-        println "Created array ${array.inspect()} with type ${array.class}"
-        
         assert array.size() == 3
         assert array[0] == 42 , array.inspect()
         assert array[1] == -5
         assert array[2] == 360
     }
 
-
-
     void testArrayDeclaration() {
         String[] array = [ "a", "b", "c" ]
-
-        array.each { element -> println( element ) }
-
         assert array.size() == 3
-
+        assert array[0] == "a"
+        assert array[1] == "b"
+        assert array[2] == "c"
     }
 
-    static void main( String[] args ) {
-        def o = new ArrayTest();
+    void testSimpleArrayEquals() {
+        Integer[] arr1 = [1,2,3,4]
+        Integer[] arr2 = [1,2,3,4]
+        assert arr1 == arr2
+        int[] primarr1 = [1,2,3,4]
+        int[] primarr2 = [1,2,3,4]
+        assert primarr1 == primarr2
+        assert primarr1 == arr2
+        double[] primarr3 = [1,2,3,4]
+        long[] primarr4 = [1,2,3,4]
+        assert primarr3 == primarr4
+        assert primarr3 == primarr1
+        assert primarr2 == primarr4
+        def list1 = [1,2,3,4]
+        assert list1 == arr1
+        assert arr1 == list1
+        assert list1 == primarr1
+        assert primarr1 == list1
+    }
 
-        o.testArrayDeclaration();
+    void testComplexArrayEquals() {
+        def a = [1,2] as Integer[]
+        def b = [1,2]
+        assert a == b
+        assert [[1,2],[3,4]] == [[1,2],[3,4]]
+        def x = [[1,2] as Integer[]]
+        Object[] y = [[1,2]]
+        assert y == x
+        //TODO: make this work; currently throws ClassCastException
+        //assert [[1,2],[3,4]] as int[][] == [[1,2],[3,4]] as int[][]
     }
+
 }
