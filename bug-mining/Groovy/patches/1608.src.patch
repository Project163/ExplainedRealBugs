diff --git a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionMultiTypeDispatcher.java b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionMultiTypeDispatcher.java
index 9dd5e6a590..693e730ba5 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionMultiTypeDispatcher.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/BinaryExpressionMultiTypeDispatcher.java
@@ -105,6 +105,7 @@ public class BinaryExpressionMultiTypeDispatcher extends BinaryExpressionHelper
     private int getOperandConversionType(ClassNode leftType, ClassNode rightType) {
         if (isIntCategory(leftType) && isIntCategory(rightType)) return 1;
         if (isLongCategory(leftType) && isLongCategory(rightType)) return 2;
+        if (isBigDecCategory(leftType) && isBigDecCategory(rightType)) return 0;
         if (isDoubleCategory(leftType) && isDoubleCategory(rightType)) return 3;
         return 0;
     }
diff --git a/src/main/org/codehaus/groovy/classgen/asm/OptimizingStatementWriter.java b/src/main/org/codehaus/groovy/classgen/asm/OptimizingStatementWriter.java
index f7ff33f457..bbdae5d4ac 100644
--- a/src/main/org/codehaus/groovy/classgen/asm/OptimizingStatementWriter.java
+++ b/src/main/org/codehaus/groovy/classgen/asm/OptimizingStatementWriter.java
@@ -630,10 +630,10 @@ public class OptimizingStatementWriter extends StatementWriter {
                     case Types.DIVIDE: case Types.DIVIDE_EQUAL:
                         if (isLongCategory(leftType) && isLongCategory(rightType)) {
                             resultType = BigDecimal_TYPE;
-                        } else if (isDoubleCategory(leftType) && isDoubleCategory(rightType)) {
-                            resultType = double_TYPE;
                         } else if (isBigDecCategory(leftType) && isBigDecCategory(rightType)) {
                             resultType = BigDecimal_TYPE;
+                        } else if (isDoubleCategory(leftType) && isDoubleCategory(rightType)) {
+                            resultType = double_TYPE;
                         }
                         break;
                     case Types.POWER: case Types.POWER_EQUAL:
diff --git a/src/test/groovy/operator/BigDecimalOperatorsTest.groovy b/src/test/groovy/operator/BigDecimalOperatorsTest.groovy
index 58d0d32f00..8863ff21a2 100644
--- a/src/test/groovy/operator/BigDecimalOperatorsTest.groovy
+++ b/src/test/groovy/operator/BigDecimalOperatorsTest.groovy
@@ -137,4 +137,22 @@ class BigDecimalOperatorsTest extends GroovyTestCase {
         assert (long)d != d
         assert (BigDecimal) d == d
     }
+
+    // -------------------------------------------------------
+    // GROOVY-5102
+    // we need both variants, since one seems to disable prim opts
+    public void testMath1() {
+        assert BigDecimal == (3/2).getClass()
+        assert BigDecimal == (7.0/8.0).getClass()
+        assert BigDecimal == (new BigDecimal(3.0)/new BigDecimal(2.0)).getClass()
+        true
+    }
+
+    public void testMath2() {
+        assert BigDecimal == (3/2).getClass()
+        assert BigDecimal == (7.0/8.0).getClass()
+        assert BigDecimal == (new BigDecimal(3.0)/new BigDecimal(2.0)).getClass()
+    }
+    // -------------------------------------------------------
+
 }
