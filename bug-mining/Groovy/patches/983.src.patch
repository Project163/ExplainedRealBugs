diff --git a/src/main/org/codehaus/groovy/ant/Groovyc.java b/src/main/org/codehaus/groovy/ant/Groovyc.java
index ebec239297..02cae181aa 100644
--- a/src/main/org/codehaus/groovy/ant/Groovyc.java
+++ b/src/main/org/codehaus/groovy/ant/Groovyc.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2007 the original author or authors.
+ * Copyright 2003-2009 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -528,8 +528,8 @@ public class Groovyc extends MatchingTask {
         // scan source directories and dest directory to build up
         // compile lists
         String[] list = src.list();
-        for (int i = 0; i < list.length; i++) {
-            File file = getProject().resolveFile(list[i]);
+        for (String filename : list) {
+            File file = getProject().resolveFile(filename);
             if (!file.exists()) {
                 throw new BuildException("srcdir \"" + file.getPath() + "\" does not exist!", getLocation());
             }
@@ -644,12 +644,12 @@ public class Groovyc extends MatchingTask {
                             jointOptions.add("-Fg" + level);
                         } else if (key.contains("debugLevel")) {
                             // ignore, taken care of in debug
-                        } else if (((key.contains("nowarn"))
+                        } else if ((key.contains("nowarn"))
                                 || (key.contains("verbose"))
-                                || (key.contains("deprecation"))
-                        ) && ("on".equalsIgnoreCase(value) || "true".equalsIgnoreCase(value) || "yes".equalsIgnoreCase("value"))
-                                ) {
-                            jointOptions.add("-F" + key);
+                                || (key.contains("deprecation"))) {
+                            // false is default, so something to do only in true case
+                            if ("on".equalsIgnoreCase(value) || "true".equalsIgnoreCase(value) || "yes".equalsIgnoreCase("value"))
+                                jointOptions.add("-F" + key);
                         } else if (key.contains("classpath")) {
                             classpath.add(javac.getClasspath());
                         } else if ((key.contains("depend"))
@@ -657,8 +657,7 @@ public class Groovyc extends MatchingTask {
                                 || (key.contains("encoding"))
                                 || (key.contains("source"))
                                 || (key.contains("target"))
-                                || (key.contains("verbose"))
-                                || (key.contains("-Xmaxwarns"))) {
+                                || (key.contains("verbose"))) {
                             jointOptions.add("-J" + key + "=" + value);
                         } else {
                             log("The option " + key + " cannot be set on the contained <javac> element. The option will be ignored", Project.MSG_WARN);
@@ -846,17 +845,16 @@ public class Groovyc extends MatchingTask {
         if (parent instanceof AntClassLoader) {
             AntClassLoader antLoader = (AntClassLoader) parent;
             String[] pathElm = antLoader.getClasspath().split(File.pathSeparator);
-            List classpath = configuration.getClasspath();
+            List<String> classpath = configuration.getClasspath();
             /*
              * Iterate over the classpath provided to groovyc, and add any missing path
              * entries to the AntClassLoader.  This is a workaround, since for some reason
              * 'directory' classpath entries were not added to the AntClassLoader' classpath.
              */
-            for (Iterator iter = classpath.iterator(); iter.hasNext();) {
-                String cpEntry = (String) iter.next();
+            for (String cpEntry : classpath) {
                 boolean found = false;
-                for (int i = 0; i < pathElm.length; i++) {
-                    if (cpEntry.equals(pathElm[i])) {
+                for (String path : pathElm) {
+                    if (cpEntry.equals(path)) {
                         found = true;
                         break;
                     }
diff --git a/src/main/org/codehaus/groovy/control/CompilerConfiguration.java b/src/main/org/codehaus/groovy/control/CompilerConfiguration.java
index 41aa58db3f..dc0ff20498 100644
--- a/src/main/org/codehaus/groovy/control/CompilerConfiguration.java
+++ b/src/main/org/codehaus/groovy/control/CompilerConfiguration.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2007 the original author or authors.
+ * Copyright 2003-2009 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -28,7 +28,6 @@ import java.util.Map;
 import java.util.Properties;
 import java.util.StringTokenizer;
 
-
 /**
  * Compilation control flags and coordination stuff.
  *
@@ -65,34 +64,43 @@ public class CompilerConfiguration {
      * See {@link WarningMessage} for levels.
      */
     private int warningLevel;
+
     /**
      * Encoding for source files
      */
+
     private String sourceEncoding;
     /**
      * A <code>PrintWriter</code> for communicating with the user
      */
+
     private PrintWriter output;
+
     /**
      * Directory into which to write classes
      */
     private File targetDirectory;
+
     /**
      * Classpath for use during compilation
      */
-    private LinkedList classpath;
+    private LinkedList<String> classpath;
+
     /**
      * If true, the compiler should produce action information
      */
     private boolean verbose;
+
     /**
      * If true, debugging code should be activated
      */
     private boolean debug;
+
     /**
      * The number of non-fatal errors to allow before bailing
      */
     private int tolerance;
+
     /**
      * Base class name for scripts (must derive from Script)
      */
@@ -123,7 +131,7 @@ public class CompilerConfiguration {
     /**
      * options for joint compilation (null by default == no joint compilation)
      */
-    private Map jointCompilationOptions;
+    private Map<String, Object> jointCompilationOptions;
     
     /**
      * Sets the Flags to defaults.
@@ -194,7 +202,7 @@ public class CompilerConfiguration {
         setWarningLevel(configuration.getWarningLevel());
         setOutput(configuration.getOutput());
         setTargetDirectory(configuration.getTargetDirectory());
-        setClasspathList(new LinkedList(configuration.getClasspath()));
+        setClasspathList(new LinkedList<String>(configuration.getClasspath()));
         setVerbose(configuration.getVerbose());
         setDebug(configuration.getDebug());
         setTolerance(configuration.getTolerance());
@@ -206,15 +214,14 @@ public class CompilerConfiguration {
         setSourceEncoding(configuration.getSourceEncoding());
         setOutput(configuration.getOutput());
         setTargetDirectory(configuration.getTargetDirectory());
-        Map jointCompilationOptions = configuration.getJointCompilationOptions();
-        if (jointCompilationOptions!=null) {
-            jointCompilationOptions = new HashMap(jointCompilationOptions);
+        Map<String, Object> jointCompilationOptions = configuration.getJointCompilationOptions();
+        if (jointCompilationOptions != null) {
+            jointCompilationOptions = new HashMap<String, Object>(jointCompilationOptions);
         }
         setJointCompilationOptions(jointCompilationOptions);
         setPluginFactory(configuration.getPluginFactory());
     }
 
-
     /**
      * Sets the Flags to the specified configuration, with defaults
      * for those not supplied.
@@ -224,8 +231,8 @@ public class CompilerConfiguration {
      * If you want to set a few flags but keep Groovy's default
      * configuration behavior then be sure to make your settings in
      * a Properties that is backed by <code>System.getProperties()</code> (which
-     * is done using the {@link #CompilerConfiguration(Properties)} constructor).<br/>
-     *   That might be done like this:<br/>
+     * is done using this constructor).<br/>
+     * That might be done like this:<br/>
      * <pre>
      *    Properties myProperties = new Properties(System.getProperties());
      *    myProperties.setProperty("groovy.output.debug", "true");
@@ -317,7 +324,6 @@ public class CompilerConfiguration {
         text = configuration.getProperty("groovy.source.encoding");
         if (text != null) setSourceEncoding(text);
 
-
         //
         // Target directory for classes
         //
@@ -357,7 +363,6 @@ public class CompilerConfiguration {
         }
         setTolerance(numeric);
 
-
         //
         // Script Base Class
         //
@@ -385,11 +390,8 @@ public class CompilerConfiguration {
             throw new ConfigurationException(e);
         }
         setMinimumRecompilationInterval(numeric);
-        
-        
     }
 
-
     /**
      * Gets the currently configured warning level.  See WarningMessage
      * for level details.
@@ -398,7 +400,6 @@ public class CompilerConfiguration {
         return this.warningLevel;
     }
 
-
     /**
      * Sets the warning level.  See WarningMessage for level details.
      */
@@ -411,7 +412,6 @@ public class CompilerConfiguration {
         }
     }
 
-
     /**
      * Gets the currently configured source file encoding.
      */
@@ -419,7 +419,6 @@ public class CompilerConfiguration {
         return this.sourceEncoding;
     }
 
-
     /**
      * Sets the encoding to be used when reading source files.
      */
@@ -428,7 +427,6 @@ public class CompilerConfiguration {
         this.sourceEncoding = encoding;
     }
 
-
     /**
      * Gets the currently configured output writer.
      */
@@ -436,7 +434,6 @@ public class CompilerConfiguration {
         return this.output;
     }
 
-
     /**
      * Sets the output writer.
      */
@@ -449,7 +446,6 @@ public class CompilerConfiguration {
         }
     }
 
-
     /**
      * Gets the target directory for writing classes.
      */
@@ -457,7 +453,6 @@ public class CompilerConfiguration {
         return this.targetDirectory;
     }
 
-
     /**
      * Sets the target directory.
      */
@@ -469,7 +464,6 @@ public class CompilerConfiguration {
         }
     }
 
-
     /**
      * Sets the target directory.
      */
@@ -477,21 +471,18 @@ public class CompilerConfiguration {
         this.targetDirectory = directory;
     }
 
-
     /**
-     * Gets the classpath.
+     * @return the classpath
      */
-    public List getClasspath() {
+    public List<String> getClasspath() {
         return this.classpath;
     }
 
-
     /**
      * Sets the classpath.
      */
     public void setClasspath(String classpath) {
-        this.classpath = new LinkedList();
-
+        this.classpath = new LinkedList<String>();
         StringTokenizer tokenizer = new StringTokenizer(classpath, File.pathSeparator);
         while (tokenizer.hasMoreTokens()) {
             this.classpath.add(tokenizer.nextToken());
@@ -502,11 +493,10 @@ public class CompilerConfiguration {
      * sets the classpath using a list of Strings
      * @param l list of strings containg the classpathparts
      */
-    public void setClasspathList(List l) {
-        this.classpath = new LinkedList(l);
+    public void setClasspathList(List<String> l) {
+        this.classpath = new LinkedList<String>(l);
     }
 
-
     /**
      * Returns true if verbose operation has been requested.
      */
@@ -514,7 +504,6 @@ public class CompilerConfiguration {
         return this.verbose;
     }
 
-
     /**
      * Turns verbose operation on or off.
      */
@@ -522,7 +511,6 @@ public class CompilerConfiguration {
         this.verbose = verbose;
     }
 
-
     /**
      * Returns true if debugging operation has been requested.
      */
@@ -530,7 +518,6 @@ public class CompilerConfiguration {
         return this.debug;
     }
 
-
     /**
      * Turns debugging operation on or off.
      */
@@ -538,7 +525,6 @@ public class CompilerConfiguration {
         this.debug = debug;
     }
 
-
     /**
      * Returns the requested error tolerance.
      */
@@ -546,7 +532,6 @@ public class CompilerConfiguration {
         return this.tolerance;
     }
 
-
     /**
      * Sets the error tolerance, which is the number of
      * non-fatal errors (per unit) that should be tolerated before
@@ -556,7 +541,6 @@ public class CompilerConfiguration {
         this.tolerance = tolerance;
     }
 
-
     /**
      * Gets the name of the base class for scripts.  It must be a subclass
      * of Script.
@@ -565,7 +549,6 @@ public class CompilerConfiguration {
         return this.scriptBaseClass;
     }
 
-
     /**
      * Sets the name of the base class for scripts.  It must be a subclass
      * of Script.
@@ -639,7 +622,6 @@ public class CompilerConfiguration {
         } catch(Exception ex) {
             // IGNORE
         }
-        
         return PRE_JDK5;
     }
     
@@ -647,7 +629,7 @@ public class CompilerConfiguration {
      * Gets the joint compilation options for this configuration.
      * @return the options
      */
-    public Map getJointCompilationOptions() {
+    public Map<String, Object> getJointCompilationOptions() {
         return jointCompilationOptions;
     }
     
@@ -656,7 +638,7 @@ public class CompilerConfiguration {
      * Using null will disable joint compilation.
      * @param options the options
      */
-    public void setJointCompilationOptions(Map options) {
+    public void setJointCompilationOptions(Map<String, Object> options) {
         jointCompilationOptions = options;
     }
 }
diff --git a/src/main/org/codehaus/groovy/tools/FileSystemCompiler.java b/src/main/org/codehaus/groovy/tools/FileSystemCompiler.java
index 57ebbb6345..593c10e0cb 100644
--- a/src/main/org/codehaus/groovy/tools/FileSystemCompiler.java
+++ b/src/main/org/codehaus/groovy/tools/FileSystemCompiler.java
@@ -157,7 +157,7 @@ public class FileSystemCompiler {
 
     public static void doCompilation(CompilerConfiguration configuration, CompilationUnit unit, String[] filenames) throws Exception {
         File tmpDir = null;
-        // if there are any joint compilation options set stub dir if not set
+        // if there are any joint compilation options set stubDir if not set
         try {
             if ((configuration.getJointCompilationOptions() != null)
                 && !configuration.getJointCompilationOptions().containsKey("stubDir"))
@@ -223,7 +223,7 @@ public class FileSystemCompiler {
 
         // joint compilation parameters
         if (cli.hasOption('j')) {
-            Map<String, String[]> compilerOptions = new HashMap<String, String[]>();
+            Map<String, Object> compilerOptions = new HashMap<String, Object>();
 
             String[] opts = cli.getOptionValues("J");
             compilerOptions.put("namedValues", opts);
diff --git a/src/main/org/codehaus/groovy/tools/javac/JavacJavaCompiler.java b/src/main/org/codehaus/groovy/tools/javac/JavacJavaCompiler.java
index cbe5523600..d63aba5290 100644
--- a/src/main/org/codehaus/groovy/tools/javac/JavacJavaCompiler.java
+++ b/src/main/org/codehaus/groovy/tools/javac/JavacJavaCompiler.java
@@ -74,6 +74,9 @@ public class JavacJavaCompiler implements JavaCompiler {
                 case 4: addJavacError("Abnormal termination of javac.", cu, javacOutput); break;
                 default: addJavacError("unexpected return value by javac.", cu, javacOutput); break;
             }
+        } else {
+            // print warnings if any
+            System.out.print(javacOutput);
         }
     }
 
