diff --git a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index ec2515e3b1..0c6275ec28 100644
--- a/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -2036,7 +2036,17 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
                         }
                         pickInferredTypeFromMethodAnnotation(directMethodCallCandidate);
                         typeCheckingContext.popEnclosingClassNode();
-                        ClassNode returnType = getType(directMethodCallCandidate);
+
+                        ClassNode returnType = null;
+
+                        if (isWithCall)  {
+                            returnType = getInferredReturnTypeFromWithClosureArgument(callArguments);
+                        }
+
+                        if (returnType == null) {
+                            returnType = getType(directMethodCallCandidate);
+                        }
+
                         if (isUsingGenericsOrIsArrayUsingGenerics(returnType)) {
                             ClassNode irtg = inferReturnTypeGenerics(chosenReceiver.getType(), directMethodCallCandidate, callArguments);
                             returnType = irtg != null && implementsInterfaceOrIsSubclassOf(irtg, returnType) ? irtg : returnType;
@@ -2078,6 +2088,28 @@ public class StaticTypeCheckingVisitor extends ClassCodeVisitorSupport {
         }
     }
 
+    /**
+     * In the case of a <em>Object.with { ... }</em> call, this method is supposed to retrieve
+     * the inferred closure return type.
+     *
+     * @param callArguments the argument list from the <em>Object#with(Closure)</em> call, ie. a single closure expression
+     * @return the inferred closure return type or <em>null</em>
+     */
+    protected ClassNode getInferredReturnTypeFromWithClosureArgument(Expression callArguments) {
+        if (!(callArguments instanceof ArgumentListExpression)) return null;
+
+        ArgumentListExpression argList = (ArgumentListExpression) callArguments;
+        ClosureExpression closure = (ClosureExpression) argList.getExpression(0);
+
+        visitClosureExpression(closure);
+
+        if (closure.getNodeMetaData(StaticTypesMarker.INFERRED_RETURN_TYPE) != null)  {
+            return closure.getNodeMetaData(StaticTypesMarker.INFERRED_RETURN_TYPE);
+        }
+
+        return null;
+    }
+
     /**
      * Given an object expression (a receiver expression), generate the list of potential receiver types.
      * @param objectExpression the receiver expression
diff --git a/src/test/groovy/transform/stc/WithSTCTest.groovy b/src/test/groovy/transform/stc/WithSTCTest.groovy
new file mode 100644
index 0000000000..daaf557cb8
--- /dev/null
+++ b/src/test/groovy/transform/stc/WithSTCTest.groovy
@@ -0,0 +1,52 @@
+/*
+ * Copyright 2003-2013 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package groovy.transform.stc
+
+/**
+ * Unit tests for static type checking : with method.
+ *
+ * @author Andre Steingress
+ */
+class WithSTCTest extends StaticTypeCheckingTestCase {
+
+    // GROOVY-5907
+    void testGenericReturnType() {
+        assertScript '''
+            @groovy.transform.CompileStatic
+            class Test {
+              static List<String> a( String s ) {
+                s.with { String it -> [ "$it" ] }
+              }
+            }
+
+            assert Test.a( 'tim' ) == [ 'tim' ]
+        '''
+    }
+
+    void testStringReturnType() {
+        assertScript '''
+            @groovy.transform.CompileStatic
+            class Test {
+              static String a( String s ) {
+                s.with { String it -> it.toLowerCase() }
+              }
+            }
+
+            assert Test.a( 'TIM' ) == 'tim'
+        '''
+    }
+}
+
