diff --git a/src/main/groovy/xml/MarkupBuilder.java b/src/main/groovy/xml/MarkupBuilder.java
index b09957f3aa..f0aa1ead2c 100644
--- a/src/main/groovy/xml/MarkupBuilder.java
+++ b/src/main/groovy/xml/MarkupBuilder.java
@@ -365,6 +365,12 @@ public class MarkupBuilder extends BuilderSupport {
                 return "&lt;";
             case '>':
                 return "&gt;";
+            case '\n':
+                if (isAttrValue) return "&#10;";
+                break;
+            case '\r':
+                if (isAttrValue) return "&#13;";
+                break;
             case '"':
                 // The double quote is only escaped if the value is for
                 // an attribute and the builder is configured to output
diff --git a/src/main/groovy/xml/streamingmarkupsupport/StreamingMarkupWriter.java b/src/main/groovy/xml/streamingmarkupsupport/StreamingMarkupWriter.java
index a2821ac0e7..54cb2c79ac 100644
--- a/src/main/groovy/xml/streamingmarkupsupport/StreamingMarkupWriter.java
+++ b/src/main/groovy/xml/streamingmarkupsupport/StreamingMarkupWriter.java
@@ -166,11 +166,14 @@ public class StreamingMarkupWriter extends Writer {
                 this.writer.write("&#x");
                 this.writer.write(Integer.toHexString(c));
                 this.writer.write(';');
-            }    else if(c == '\'' && this.writingAttribute && !useDoubleQuotes) {
-                    this.writer.write("&apos;");
-                }
-                else if(c == '"' && this.writingAttribute && useDoubleQuotes) {
-                    this.writer.write("&quot;");
+            } else if (c == '\'' && this.writingAttribute && !useDoubleQuotes) {
+                this.writer.write("&apos;");
+            } else if (c == '"' && this.writingAttribute && useDoubleQuotes) {
+                this.writer.write("&quot;");
+            } else if (c == '\n' && this.writingAttribute) {
+                this.writer.write("&#10;");
+            } else if (c == '\r' && this.writingAttribute) {
+                this.writer.write("&#13;");
             } else {
                 this.writer.write(c);
             }
diff --git a/src/test/groovy/xml/BuilderTestSupport.groovy b/src/test/groovy/xml/BuilderTestSupport.groovy
index 86d4085e89..6bc576c4e6 100644
--- a/src/test/groovy/xml/BuilderTestSupport.groovy
+++ b/src/test/groovy/xml/BuilderTestSupport.groovy
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2009 the original author or authors.
+ * Copyright 2003-2011 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -209,6 +209,17 @@ require escaping. The other characters consist of:
 </element>'''
     }
 
+    void testNewlinesInMarkupBuilder() {
+        def m = {
+            root {
+                a( b:'''one\n\rtwo''' ) {
+                  c( 'one\n\rtwo' )
+                }
+            }
+        }
+        assertExpectedXml m, """<root><a b='one&#10;&#13;two'><c>one\n\rtwo</c></a></root>"""
+    }
+
     void testObjectOperationsInMarkup() {
         def m = {
             root {
