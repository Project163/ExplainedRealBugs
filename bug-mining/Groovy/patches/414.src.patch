diff --git a/src/main/org/codehaus/groovy/ast/ClassHelper.java b/src/main/org/codehaus/groovy/ast/ClassHelper.java
index 8b670591a8..842c6bca16 100644
--- a/src/main/org/codehaus/groovy/ast/ClassHelper.java
+++ b/src/main/org/codehaus/groovy/ast/ClassHelper.java
@@ -61,10 +61,10 @@ public class ClassHelper {
     public static final ClassNode 
         DYNAMIC_TYPE = new ClassNode(Object.class),  OBJECT_TYPE = DYNAMIC_TYPE,
         VOID_TYPE = new ClassNode(Void.TYPE),        CLOSURE_TYPE = new ClassNode(Closure.class),
-        GSTRING_TYPE = new ClassNode(GString.class), LIST_TYPE = new ClassNode(List.class),
+        GSTRING_TYPE = new ClassNode(GString.class), LIST_TYPE = makeWithoutCaching(List.class),
         MAP_TYPE = new ClassNode(Map.class),         RANGE_TYPE = new ClassNode(Range.class),
         PATTERN_TYPE = new ClassNode(Pattern.class), STRING_TYPE = new ClassNode(String.class),
-        SCRIPT_TYPE = new ClassNode(Script.class),   REFERENCE_TYPE = new ClassNode(Reference.class),
+        SCRIPT_TYPE = new ClassNode(Script.class),   REFERENCE_TYPE = makeWithoutCaching(Reference.class),
         
         boolean_TYPE = new ClassNode(boolean.class),     char_TYPE = new ClassNode(char.class),
         byte_TYPE = new ClassNode(byte.class),           int_TYPE = new ClassNode(int.class),
@@ -146,14 +146,23 @@ public class ClassHelper {
             if (c==classes[i]) return types[i];
         }
         if (c.isArray()) {
-            ClassNode cn = make(c.getComponentType());
+            ClassNode cn = make(c.getComponentType(),includeGenerics);
             return cn.makeArray();
         }
+        return makeWithoutCaching(c,includeGenerics);
+    }
+    
+    public static ClassNode makeWithoutCaching(Class c){
+        return makeWithoutCaching(c,true);
+    }
+    
+    public static ClassNode makeWithoutCaching(Class c, boolean includeGenerics){
         ClassNode t = new ClassNode(c);
         if (includeGenerics) VMPluginFactory.getPlugin().setGenericsTypes(t);
         return t;
     }
     
+    
     /**
      * Creates a ClassNode using a given class.
      * Unlike make(String) this method will not use the cache
diff --git a/src/main/org/codehaus/groovy/ast/ClassNode.java b/src/main/org/codehaus/groovy/ast/ClassNode.java
index 3327cf5ea6..90e1110834 100644
--- a/src/main/org/codehaus/groovy/ast/ClassNode.java
+++ b/src/main/org/codehaus/groovy/ast/ClassNode.java
@@ -114,7 +114,7 @@ public class ClassNode extends AnnotatedNode implements Opcodes {
     /**
      * Returns the ClassNode this ClassNode is redirecting to.
      */
-    protected ClassNode redirect(){
+    public ClassNode redirect(){
         if (redirect==null) return this;
         return redirect.redirect();
     }
diff --git a/src/main/org/codehaus/groovy/control/GenericsVisitor.java b/src/main/org/codehaus/groovy/control/GenericsVisitor.java
index 72779720fb..e9136051d4 100644
--- a/src/main/org/codehaus/groovy/control/GenericsVisitor.java
+++ b/src/main/org/codehaus/groovy/control/GenericsVisitor.java
@@ -38,8 +38,11 @@ public class GenericsVisitor extends ClassCodeVisitorSupport {
     
     public void visitClass(ClassNode node) {
         boolean error=checkWildcard(node);
-        if (!error) {
-            checkGenericsUsage(node.getUnresolvedSuperClass(false), node.getSuperClass());
+        if (error) return;
+        checkGenericsUsage(node.getUnresolvedSuperClass(false), node.getSuperClass());
+        ClassNode[] interfaces = node.getInterfaces();
+        for (int i = 0; i < interfaces.length; i++) {
+            checkGenericsUsage(interfaces[i], interfaces[i].redirect());
         }
     }
     
@@ -67,13 +70,15 @@ public class GenericsVisitor extends ClassCodeVisitorSupport {
         if (cnTypes==null) {
             addError( "The class "+n.getName()+" refers to the class "+
                       cn.getName()+" and uses "+nTypes.length+
-                      " parameters, but the refered class takes no parameters", n);
+                      " parameters, but the referred class takes no parameters", n);
+            return;
         }
         if (nTypes.length!=cnTypes.length) {
             addError( "The class "+n.getName()+" refers to the class "+
                       cn.getName()+" and uses "+nTypes.length+
                       " parameters, but the refered class needs "+
                       cnTypes.length, n);
+            return;
         }
         // check bounds
         for (int i=0; i<nTypes.length; i++) {
diff --git a/src/main/org/codehaus/groovy/vmplugin/VMPluginFactory.java b/src/main/org/codehaus/groovy/vmplugin/VMPluginFactory.java
index 3c2328e624..d6d0a2cfa8 100644
--- a/src/main/org/codehaus/groovy/vmplugin/VMPluginFactory.java
+++ b/src/main/org/codehaus/groovy/vmplugin/VMPluginFactory.java
@@ -16,7 +16,6 @@
 package org.codehaus.groovy.vmplugin;
 
 import org.codehaus.groovy.vmplugin.v4.Java4;
-import org.codehaus.groovy.vmplugin.v5.Java5;
 
 /**
  * factory class to get functionlity based on the VM version.
@@ -27,11 +26,13 @@ import org.codehaus.groovy.vmplugin.v5.Java5;
 public class VMPluginFactory {
     
     private static final String JDK5_CLASSNAME_CHECK = "java.lang.annotation.Annotation";
+    private static final String JDK5_PLUGIN_NAME = "org.codehaus.groovy.vmplugin.v5.Java5";
     private static VMPluging plugin;
     static {
         try {
             ClassLoader.getSystemClassLoader().loadClass(JDK5_CLASSNAME_CHECK);
-            plugin = new Java5();
+            plugin = (VMPluging) VMPluginFactory.class.getClassLoader()
+                                 .loadClass(JDK5_PLUGIN_NAME).newInstance();
         } catch(Exception ex) {
             plugin = new Java4();
         }
diff --git a/src/main/org/codehaus/groovy/vmplugin/v5/Java5.java b/src/main/org/codehaus/groovy/vmplugin/v5/Java5.java
index 85f1d60f75..e954b19471 100644
--- a/src/main/org/codehaus/groovy/vmplugin/v5/Java5.java
+++ b/src/main/org/codehaus/groovy/vmplugin/v5/Java5.java
@@ -70,7 +70,7 @@ public class Java5 implements VMPluging {
         } else if (type instanceof TypeVariable) {
             return configureTypeVariableReference((TypeVariable) type);
         } else if (type instanceof Class) {
-            return ClassHelper.make((Class) type, false);
+            return ClassHelper.makeWithoutCaching((Class) type, false);
         } else {
             throw new GroovyBugError("unknown type: " + type + " := " + type.getClass());
         }        
diff --git a/src/test/gls/generics/GenericsTest.groovy b/src/test/gls/generics/GenericsTest.groovy
index 4dedbb9df7..ac995bbabc 100644
--- a/src/test/gls/generics/GenericsTest.groovy
+++ b/src/test/gls/generics/GenericsTest.groovy
@@ -163,10 +163,19 @@ class GenericsTest extends GenericsTestBase {
 			]
 	}
 
-	public void testInvalidParameterUsage_FAILS() {
-	    if (notYetImplemented()) return
+	public void testInvalidParameterUsage() {
 	    shouldNotCompile """
 	    	abstract class B<T> implements Map<T>{}
 	    """
+	    shouldNotCompile """
+	        class A<T,V> extends ArrayList<T,V>{}
+        """ 
+        shouldNotCompile """
+	        class A<T extends Number> {}
+	        class B<T> extends A<T>{}
+        """
+	    shouldNotCompile """
+	        class B<T> extends ArrayList<?>{}
+        """ 
 	}
 }
\ No newline at end of file
