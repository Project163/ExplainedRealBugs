diff --git a/src/main/groovy/util/Node.java b/src/main/groovy/util/Node.java
index 09d91de71b..10fd89271c 100644
--- a/src/main/groovy/util/Node.java
+++ b/src/main/groovy/util/Node.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2012 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -207,23 +207,46 @@ public class Node implements Serializable, Cloneable {
         return new Node(this, name, attributes, value);
     }
 
-    // TODO return replaced node rather than last appended?
-    // * @return the original now replaced node
     /**
      * Replaces the current node with nodes defined using builder-style notation via a Closure.
      *
      * @param c A Closure defining the new nodes using builder-style notation.
-     * @return the last appended node
+     * @return the original now replaced node
      */
     public Node replaceNode(Closure c) {
         if (parent() == null) {
             throw new UnsupportedOperationException("Replacing the root node is not supported");
         }
-        Node result = appendNodes(c);
+        appendNodes(c);
         getParentList(parent()).remove(this);
-//        this.setParent(null);
-//        return this;
-        return result;
+        this.setParent(null);
+        return this;
+    }
+
+    /**
+     * Replaces the current node with the supplied node.
+     *
+     * @param n the new Node
+     * @return the original now replaced node
+     */
+    public Node replaceNode(Node n) {
+        if (parent() == null) {
+            throw new UnsupportedOperationException("Replacing the root node is not supported");
+        }
+        List tail = getTail();
+        parent().appendNode(n.name(), n.attributes(), n.value());
+        parent().children().addAll(tail);
+        getParentList(parent()).remove(this);
+        this.setParent(null);
+        return this;
+    }
+
+    private List getTail() {
+        List list = parent().children();
+        int afterIndex = list.indexOf(this);
+        List tail = new ArrayList(list.subList(afterIndex + 1, list.size()));
+        list.subList(afterIndex + 1, list.size()).clear();
+        return tail;
     }
 
     /**
@@ -238,17 +261,12 @@ public class Node implements Serializable, Cloneable {
         appendNodes(c);
     }
 
-    private Node appendNodes(Closure c) {
-        List list = parent().children();
-        int afterIndex = list.indexOf(this);
-        List leftOvers = new ArrayList(list.subList(afterIndex + 1, list.size()));
-        list.subList(afterIndex + 1, list.size()).clear();
-        Node lastAppended = null;
+    private void appendNodes(Closure c) {
+        List tail = getTail();
         for (Node child : buildChildrenFromClosure(c)) {
-            lastAppended = parent().appendNode(child.name(), child.attributes(), child.value());
+            parent().appendNode(child.name(), child.attributes(), child.value());
         }
-        parent().children().addAll(leftOvers);
-        return lastAppended;
+        parent().children().addAll(tail);
     }
 
     private List<Node> buildChildrenFromClosure(Closure c) {
diff --git a/subprojects/groovy-xml/src/main/java/groovy/xml/dom/DOMCategory.java b/subprojects/groovy-xml/src/main/java/groovy/xml/dom/DOMCategory.java
index cb6289bb67..292d80be70 100644
--- a/subprojects/groovy-xml/src/main/java/groovy/xml/dom/DOMCategory.java
+++ b/subprojects/groovy-xml/src/main/java/groovy/xml/dom/DOMCategory.java
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2012 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -321,15 +321,13 @@ public class DOMCategory {
         return replaceNode(self.item(0), c);
     }
 
-    // TODO return replaced node rather than last appended?
     public static Node replaceNode(Node self, Closure c) {
         if (self.getParentNode() instanceof Document) {
             throw new UnsupportedOperationException("Replacing the root node is not supported");
         }
-        Node result = appendNodes(self, c);
+        appendNodes(self, c);
         self.getParentNode().removeChild(self);
-        return result;
-//        return self;
+        return self;
     }
 
     public static void plus(Element self, Closure c) {
@@ -339,17 +337,15 @@ public class DOMCategory {
         appendNodes(self, c);
     }
 
-    private static Node appendNodes(Node self, Closure c) {
+    private static void appendNodes(Node self, Closure c) {
         Node parent = self.getParentNode();
         Node beforeNode = self.getNextSibling();
         DOMBuilder b = new DOMBuilder(self.getOwnerDocument());
         Element newNodes = (Element) b.invokeMethod("rootNode", c);
         Iterator<Node> iter = XmlGroovyMethods.iterator(children(newNodes));
-        Node lastAppended = null;
         while (iter.hasNext()) {
-            lastAppended = parent.insertBefore(iter.next(), beforeNode);
+            parent.insertBefore(iter.next(), beforeNode);
         }
-        return lastAppended;
     }
 
     public static void plus(NodeList self, Closure c) {
diff --git a/subprojects/groovy-xml/src/test/groovy/groovy/util/XmlParserTest.groovy b/subprojects/groovy-xml/src/test/groovy/groovy/util/XmlParserTest.groovy
index 385dd80fbd..a9586a3e66 100644
--- a/subprojects/groovy-xml/src/test/groovy/groovy/util/XmlParserTest.groovy
+++ b/subprojects/groovy-xml/src/test/groovy/groovy/util/XmlParserTest.groovy
@@ -279,6 +279,28 @@ p() {
 '''
     }
 
+    void testReplaceNode() {
+        def xml = '<root><old/></root>'
+        def parser = new XmlParser()
+        def root = parser.parseText(xml)
+        def old = root.old[0]
+        def replacement = '<new><child/></new>'
+        def replacementNode = parser.parseText(replacement)
+        def removed = old.replaceNode(replacementNode)
+        assert removed.name() == 'old'
+
+        def writer = new StringWriter()
+        new XmlNodePrinter(new PrintWriter(writer)).print(root)
+        def result = writer.toString()
+        assert result == '''\
+<root>
+  <new>
+    <child/>
+  </new>
+</root>
+'''
+    }
+
     void testXmlParserExtensionPoints() {
         def html = new CustomXmlParser().parseText(bookXml)
         assert html.getClass() == CustomNode
diff --git a/subprojects/groovy-xml/src/test/groovy/groovy/xml/GpathSyntaxTestSupport.groovy b/subprojects/groovy-xml/src/test/groovy/groovy/xml/GpathSyntaxTestSupport.groovy
index 4d487fbdfd..09ee5b289c 100644
--- a/subprojects/groovy-xml/src/test/groovy/groovy/xml/GpathSyntaxTestSupport.groovy
+++ b/subprojects/groovy-xml/src/test/groovy/groovy/xml/GpathSyntaxTestSupport.groovy
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2012 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -362,9 +362,8 @@ class GpathSyntaxTestSupport {
 
         // XmlSlurper replacements are deferred so can't check here
         if (!isSlurper(root)) {
-            assert r.name() == 'n'
-            assert r.'@type' == 'string'
-            assert r.hello.text() == 'world'
+            assert r.name() == 'c'
+            assert r.'@a1' == '4'
         }
     }
 
@@ -395,9 +394,8 @@ class GpathSyntaxTestSupport {
 
         // XmlSlurper replacements are deferred so can't check here
         if (!isSlurper(root)) {
-            assert r.name() == 'n'
-            assert r.'@type' == 'int'
-            assert r.text() == '330'
+            assert r.name() == 'c'
+            assert r.'@a1' == '4'
         }
     }
 
diff --git a/subprojects/groovy-xml/src/test/groovy/groovy/xml/dom/DOMCategoryTest.groovy b/subprojects/groovy-xml/src/test/groovy/groovy/xml/dom/DOMCategoryTest.groovy
index 19a8b54efe..1fcb05e26a 100644
--- a/subprojects/groovy-xml/src/test/groovy/groovy/xml/dom/DOMCategoryTest.groovy
+++ b/subprojects/groovy-xml/src/test/groovy/groovy/xml/dom/DOMCategoryTest.groovy
@@ -1,5 +1,5 @@
 /*
- * Copyright 2003-2012 the original author or authors.
+ * Copyright 2003-2013 the original author or authors.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -19,6 +19,8 @@ import groovy.xml.DOMBuilder
 import groovy.xml.GpathSyntaxTestSupport
 import groovy.xml.MixedMarkupTestSupport
 import groovy.xml.TraversalTestSupport
+import groovy.xml.XmlUtil
+
 import static javax.xml.xpath.XPathConstants.*
 
 class DOMCategoryTest extends GroovyTestCase {
@@ -170,6 +172,28 @@ class DOMCategoryTest extends GroovyTestCase {
             assert a.depthFirst()*.name().join('->') == 'a->b->b'
         }
     }
+
+    void testReplaceNode() {
+        def readerOld = new StringReader('<root><old/></root>')
+        def oldDoc = DOMBuilder.parse(readerOld)
+        def oldRoot = oldDoc.documentElement
+        def readerNew = new StringReader('<new><child/></new>')
+        def newRoot = DOMBuilder.parse(readerNew).documentElement
+        def imported = oldDoc.importNode(newRoot, true)
+        use(DOMCategory) {
+            def old = oldRoot[0]
+            def removed = oldRoot.replaceChild(imported, old)
+        assert removed.name() == 'old'
+        }
+
+        assert XmlUtil.serialize(oldRoot).normalize() == '''\
+<?xml version="1.0" encoding="UTF-8"?><root>
+  <new>
+    <child/>
+  </new>
+</root>
+'''
+    }
 }
 
 class Foo {
