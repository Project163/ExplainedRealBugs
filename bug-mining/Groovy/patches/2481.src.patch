diff --git a/src/main/org/codehaus/groovy/transform/ScriptURIASTTransformation.java b/src/main/org/codehaus/groovy/transform/ScriptURIASTTransformation.java
index 580002fbe7..0ed3c56397 100644
--- a/src/main/org/codehaus/groovy/transform/ScriptURIASTTransformation.java
+++ b/src/main/org/codehaus/groovy/transform/ScriptURIASTTransformation.java
@@ -23,25 +23,19 @@ import org.codehaus.groovy.ast.AnnotatedNode;
 import org.codehaus.groovy.ast.AnnotationNode;
 import org.codehaus.groovy.ast.ClassHelper;
 import org.codehaus.groovy.ast.ClassNode;
-import org.codehaus.groovy.ast.MethodNode;
-import org.codehaus.groovy.ast.Parameter;
 import org.codehaus.groovy.ast.expr.ArgumentListExpression;
 import org.codehaus.groovy.ast.expr.ConstantExpression;
-import org.codehaus.groovy.ast.expr.ConstructorCallExpression;
 import org.codehaus.groovy.ast.expr.DeclarationExpression;
 import org.codehaus.groovy.ast.expr.EmptyExpression;
 import org.codehaus.groovy.ast.expr.Expression;
-import org.codehaus.groovy.ast.expr.VariableExpression;
+import org.codehaus.groovy.ast.expr.StaticMethodCallExpression;
 import org.codehaus.groovy.control.CompilePhase;
 import org.codehaus.groovy.control.SourceUnit;
 import org.codehaus.groovy.control.messages.SyntaxErrorMessage;
 import org.codehaus.groovy.syntax.SyntaxException;
 
 import java.io.File;
-import java.net.MalformedURLException;
 import java.net.URI;
-import java.net.URISyntaxException;
-import java.net.URL;
 import java.util.Arrays;
 
 /**
@@ -95,9 +89,19 @@ public class ScriptURIASTTransformation extends AbstractASTTransformation {
         if (uri == null) {
             addError("Unable to get the URI for the source of this script!", de);
         } else {
-            // Set the RHS to '= new URI("string for this URI")'.
-            // That may throw a URISyntaxException, but we don't need to deal with that here.
-            de.setRightExpression(new ConstructorCallExpression(URI_TYPE
+            if (!(uri.isAbsolute() || memberHasValue(node, "allowRelative", true))) {
+                // FIXME:  What should we use as the base URI?
+                // It is unlikely we get to this point with a relative URI since making a URL
+                // from will make it absolute I think.  But lets handle the simple case of
+                // using file paths and turning that into an absolute file URI.
+                // So we will use the current working directory as the base.
+                URI baseURI = new File(".").toURI();
+                uri = uri.resolve(baseURI);
+            }
+
+            // Set the RHS to '= URI.create("string for this URI")'.
+            // That may throw an IllegalArgumentExpression wrapping the URISyntaxException.
+            de.setRightExpression(new StaticMethodCallExpression(URI_TYPE, "create"
                     , new ArgumentListExpression(new ConstantExpression(uri.toString()))));
         }
     }
@@ -106,6 +110,11 @@ public class ScriptURIASTTransformation extends AbstractASTTransformation {
         return sourceUnit;
     }
 
+    protected boolean memberHasValue(AnnotationNode node, String name, Object value) {
+        final Expression member = node.getMember(name);
+        return member != null && member instanceof ConstantExpression && ((ConstantExpression) member).getValue().equals(value);
+    }
+
     protected void addError(String msg, ASTNode expr) {
         // for some reason the source unit is null sometimes, e.g. in testNotAllowedInScriptInnerClassMethods
         sourceUnit.getErrorCollector().addErrorAndContinue(new SyntaxErrorMessage(
diff --git a/src/test/groovy/ui/GroovyMainTest.groovy b/src/test/groovy/ui/GroovyMainTest.groovy
index 201b040ea1..17ab0216e1 100644
--- a/src/test/groovy/ui/GroovyMainTest.groovy
+++ b/src/test/groovy/ui/GroovyMainTest.groovy
@@ -58,10 +58,10 @@ class GroovyMainTest extends GroovyTestCase {
 
     /**
      * GROOVY-6561 : Correct handling of scripts from a URI.
+     * GROOVY-1642 : Enable a script to get it's URI by annotating a field.
      */
     void testURISource() {
         def tempFile = File.createTempFile("groovy-ui-GroovyMainTest-testURISource", ".groovy")
-        // TODO: For GROOVY-6561 we need to actually test that we got a URI to the compiler.
         tempFile.text = """
 @groovy.transform.ScriptURI def myURI
 
@@ -76,8 +76,8 @@ print myURI
         try {
             String[] args = [tempFile.toURI().toString()]
             GroovyMain.main(args)
-            def out = baos.toString()
-            assert out == tempFile.toURI()
+            def out = baos.toString().trim()
+            assert out == tempFile.toURI().toString()
         } finally {
             System.setOut(oldOut)
         }
