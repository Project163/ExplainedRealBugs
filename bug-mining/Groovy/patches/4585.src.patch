diff --git a/src/main/java/org/codehaus/groovy/ast/decompiled/MemberSignatureParser.java b/src/main/java/org/codehaus/groovy/ast/decompiled/MemberSignatureParser.java
index 1eb702bfdd..6e25c3f9ae 100644
--- a/src/main/java/org/codehaus/groovy/ast/decompiled/MemberSignatureParser.java
+++ b/src/main/java/org/codehaus/groovy/ast/decompiled/MemberSignatureParser.java
@@ -140,16 +140,13 @@ class MemberSignatureParser {
             result = new ConstructorNode(method.accessModifiers, parameters, exceptionTypes, null);
         } else {
             result = new MethodNode(method.methodName, method.accessModifiers, returnType[0], parameters, exceptionTypes, null);
-            Object annDefault = method.annotationDefault;
-            if (annDefault != null) {
-                if (annDefault instanceof TypeWrapper) {
-                    annDefault = resolver.resolveType(Type.getType(((TypeWrapper) annDefault).desc));
+            Object defaultValue = method.annotationDefault;
+            if (defaultValue != null) {
+                if (defaultValue instanceof TypeWrapper) {
+                    defaultValue = resolver.resolveType(Type.getType(((TypeWrapper) defaultValue).desc));
                 }
-                result.setCode(new ReturnStatement(new ConstantExpression(annDefault)));
+                result.setCode(new ReturnStatement(new ConstantExpression(defaultValue, true)));
                 result.setAnnotationDefault(true);
-            } else {
-                // seems wrong but otherwise some tests fail (e.g. TestingASTTransformsTest)
-                result.setCode(new ReturnStatement(new ConstantExpression(null)));
             }
         }
         if (typeParameters != null && typeParameters.length > 0) {
diff --git a/src/main/java/org/codehaus/groovy/classgen/AnnotationVisitor.java b/src/main/java/org/codehaus/groovy/classgen/AnnotationVisitor.java
index 875c588587..dd9790db4a 100644
--- a/src/main/java/org/codehaus/groovy/classgen/AnnotationVisitor.java
+++ b/src/main/java/org/codehaus/groovy/classgen/AnnotationVisitor.java
@@ -133,12 +133,10 @@ public class AnnotationVisitor {
 
     private boolean checkIfMandatoryAnnotationValuesPassed(final AnnotationNode node) {
         boolean ok = true;
-        ClassNode classNode = node.getClassNode();
-        for (MethodNode mn : classNode.getMethods()) {
-            String methodName = mn.getName();
-            // if the annotation attribute has a default, getCode() returns a ReturnStatement with the default value
-            if (mn.getCode() == null && !node.getMembers().containsKey(methodName)) {
-                addError("No explicit/default value found for annotation attribute '" + methodName + "'", node);
+        for (MethodNode mn : node.getClassNode().getMethods()) {
+            if (!mn.hasAnnotationDefault() && !node.getMembers().containsKey(mn.getName()) && !"dataVariableNames".equals(mn.getName())) {
+                // TODO: https://github.com/spockframework/spock/issues/1549               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+                addError("No explicit/default value found for annotation attribute '" + mn.getName() + "'", node);
                 ok = false;
             }
         }
diff --git a/src/main/java/org/codehaus/groovy/vmplugin/v8/Java8.java b/src/main/java/org/codehaus/groovy/vmplugin/v8/Java8.java
index 81b060ebfe..a62cce4eaf 100644
--- a/src/main/java/org/codehaus/groovy/vmplugin/v8/Java8.java
+++ b/src/main/java/org/codehaus/groovy/vmplugin/v8/Java8.java
@@ -68,7 +68,6 @@ import java.lang.reflect.Type;
 import java.lang.reflect.TypeVariable;
 import java.lang.reflect.WildcardType;
 import java.security.Permission;
-import java.security.PrivilegedAction;
 import java.util.Arrays;
 import java.util.List;
 import java.util.Optional;
@@ -135,12 +134,6 @@ public class Java8 implements VMPlugin {
         }
     }
 
-    private static void setMethodDefaultValue(final MethodNode mn, final Method m) {
-        ConstantExpression cExp = new ConstantExpression(m.getDefaultValue());
-        mn.setCode(new ReturnStatement(cExp));
-        mn.setAnnotationDefault(true);
-    }
-
     @Override
     public Class<?>[] getPluginDefaultGroovyMethods() {
         return new Class[]{PluginDefaultGroovyMethods.class};
@@ -415,29 +408,32 @@ public class Java8 implements VMPlugin {
             Class<?> clazz = classNode.getTypeClass();
             Field[] fields = clazz.getDeclaredFields();
             for (Field f : fields) {
-                ClassNode ret = makeClassNode(compileUnit, f.getGenericType(), f.getType());
-                FieldNode fn = new FieldNode(f.getName(), f.getModifiers(), ret, classNode, null);
+                ClassNode rt = makeClassNode(compileUnit, f.getGenericType(), f.getType());
+                FieldNode fn = new FieldNode(f.getName(), f.getModifiers(), rt, classNode, null);
                 setAnnotationMetaData(f.getAnnotations(), fn);
                 classNode.addField(fn);
             }
             Method[] methods = clazz.getDeclaredMethods();
             for (Method m : methods) {
-                ClassNode ret = makeClassNode(compileUnit, m.getGenericReturnType(), m.getReturnType());
+                ClassNode rt = makeClassNode(compileUnit, m.getGenericReturnType(), m.getReturnType());
                 Parameter[] params = makeParameters(compileUnit, m.getGenericParameterTypes(), m.getParameterTypes(), m.getParameterAnnotations(), m);
                 ClassNode[] exceptions = makeClassNodes(compileUnit, m.getGenericExceptionTypes(), m.getExceptionTypes());
-                MethodNode mn = new MethodNode(m.getName(), m.getModifiers(), ret, params, exceptions, null);
-                mn.setSynthetic(m.isSynthetic());
-                setMethodDefaultValue(mn, m);
+                MethodNode mn = new MethodNode(m.getName(), m.getModifiers(), rt, params, exceptions, null);
                 setAnnotationMetaData(m.getAnnotations(), mn);
+                if (m.getDefaultValue() != null) {
+                    mn.setAnnotationDefault(true); // GROOVY-10862
+                    mn.setCode(new ReturnStatement(new ConstantExpression(m.getDefaultValue(), true)));
+                }
                 mn.setGenericsTypes(configureTypeVariable(m.getTypeParameters()));
+                mn.setSynthetic(m.isSynthetic());
                 classNode.addMethod(mn);
             }
-            Constructor[] constructors = clazz.getDeclaredConstructors();
-            for (Constructor ctor : constructors) {
-                Parameter[] params = makeParameters(compileUnit, ctor.getGenericParameterTypes(), ctor.getParameterTypes(), getConstructorParameterAnnotations(ctor), ctor);
-                ClassNode[] exceptions = makeClassNodes(compileUnit, ctor.getGenericExceptionTypes(), ctor.getExceptionTypes());
-                ConstructorNode cn = classNode.addConstructor(ctor.getModifiers(), params, exceptions, null);
-                setAnnotationMetaData(ctor.getAnnotations(), cn);
+            Constructor<?>[] constructors = clazz.getDeclaredConstructors();
+            for (Constructor<?> c : constructors) {
+                Parameter[] params = makeParameters(compileUnit, c.getGenericParameterTypes(), c.getParameterTypes(), getConstructorParameterAnnotations(c), c);
+                ClassNode[] exceptions = makeClassNodes(compileUnit, c.getGenericExceptionTypes(), c.getExceptionTypes());
+                ConstructorNode cn = classNode.addConstructor(c.getModifiers(), params, exceptions, null);
+                setAnnotationMetaData(c.getAnnotations(), cn);
             }
 
             Class<?> sc = clazz.getSuperclass();
@@ -640,14 +636,14 @@ public class Java8 implements VMPlugin {
     @Override
     @Deprecated
     @SuppressWarnings("removal") // TODO a future Groovy version will remove this method
-    public <T> T doPrivileged(java.security.PrivilegedAction<T> action) {
+    public <T> T doPrivileged(final java.security.PrivilegedAction<T> action) {
         throw new UnsupportedOperationException("doPrivileged is no longer supported");
     }
 
     @Override
     @Deprecated
     @SuppressWarnings("removal") // TODO a future Groovy version will remove this method
-    public <T> T doPrivileged(java.security.PrivilegedExceptionAction<T> action) throws java.security.PrivilegedActionException {
+    public <T> T doPrivileged(final java.security.PrivilegedExceptionAction<T> action) throws java.security.PrivilegedActionException {
         throw new UnsupportedOperationException("doPrivileged is no longer supported");
     }
 
@@ -682,7 +678,7 @@ public class Java8 implements VMPlugin {
 
     private Object getInvokeSpecialHandleFallback(final Method method, final Object receiver) {
         if (!method.isAccessible()) {
-            doPrivilegedInternal((PrivilegedAction<Object>) () -> {
+            doPrivilegedInternal(() -> {
                 ReflectionUtils.trySetAccessible(method);
                 return null;
             });
@@ -694,12 +690,12 @@ public class Java8 implements VMPlugin {
             throw new GroovyBugError(e);
         }
     }
+
     @SuppressWarnings("removal") // TODO a future Groovy version should perform the operation not as a privileged action
-    private static <T> T doPrivilegedInternal(PrivilegedAction<T> action) {
+    private static <T> T doPrivilegedInternal(final java.security.PrivilegedAction<T> action) {
         return java.security.AccessController.doPrivileged(action);
     }
 
-
     @Override
     public Object invokeHandle(final Object handle, final Object[] args) throws Throwable {
         return ((MethodHandle) handle).invokeWithArguments(args);
diff --git a/src/test/org/codehaus/groovy/ast/MethodNodeTest.groovy b/src/test/org/codehaus/groovy/ast/MethodNodeTest.groovy
index 45f7ec525e..169d980f49 100644
--- a/src/test/org/codehaus/groovy/ast/MethodNodeTest.groovy
+++ b/src/test/org/codehaus/groovy/ast/MethodNodeTest.groovy
@@ -55,6 +55,23 @@ final class MethodNodeTest {
         assert result.endsWith('java.lang.String[] foo(int, int[]) from java.lang.Object]')
     }
 
+    @Test // GROOVY-10862
+    void testAnnotationDefault() {
+        MethodNode mn = ClassHelper.OBJECT_TYPE.getMethod('toString')
+
+        assert !mn.hasAnnotationDefault()
+        assert mn.getCode() == null
+
+        mn = ClassHelper.DEPRECATED_TYPE.getMethod('since')
+
+        assert mn.hasAnnotationDefault()
+        assert mn.getCode() != null
+        mn.code.expression.with {
+            assert type == ClassHelper.STRING_TYPE
+            assert value == ''
+        }
+    }
+
     @Test
     void testIsDynamicReturnType1() {
         def methodNode = new MethodNode('foo', 0, ClassHelper.dynamicType(), Parameter.EMPTY_ARRAY, ClassNode.EMPTY_ARRAY, null)
diff --git a/src/test/org/codehaus/groovy/tools/stubgenerator/InnerAnnotationStubTest.groovy b/src/test/org/codehaus/groovy/tools/stubgenerator/InnerAnnotationStubTest.groovy
index a4937d7978..80be8e90dc 100644
--- a/src/test/org/codehaus/groovy/tools/stubgenerator/InnerAnnotationStubTest.groovy
+++ b/src/test/org/codehaus/groovy/tools/stubgenerator/InnerAnnotationStubTest.groovy
@@ -21,22 +21,18 @@ package org.codehaus.groovy.tools.stubgenerator
 /**
  * Test for GROOVY-6085
  */
-class InnerAnnotationStubTest extends StringSourcesStubTestCase {
+final class InnerAnnotationStubTest extends StringSourcesStubTestCase {
 
     Map<String, String> provideSources() {
         [
-                'JacksonAnnotationTest.groovy': '''
-                @JsonSubTypes.Type
+            'JacksonAnnotationTest.groovy': '''
+                @JsonSubTypes.Type(Object)
                 @AnnoWithEnum(AnnoWithEnum.Include.NON_NULL)
-                class JacksonAnnotationTest { }
-
+                class JacksonAnnotationTest {
+                }
             ''',
-
-                'JsonSubTypes.java': '''
-                import java.lang.annotation.ElementType;
-                import java.lang.annotation.Retention;
-                import java.lang.annotation.RetentionPolicy;
-                import java.lang.annotation.Target;
+            'JsonSubTypes.java': '''
+                import java.lang.annotation.*;
 
                 @Target({ElementType.TYPE, ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER})
                 @Retention(RetentionPolicy.RUNTIME)
@@ -49,18 +45,14 @@ class InnerAnnotationStubTest extends StringSourcesStubTestCase {
                     }
                 }
             ''',
-
-                'AnnoWithEnum.java': '''
-                import java.lang.annotation.ElementType;
-                import java.lang.annotation.Retention;
-                import java.lang.annotation.RetentionPolicy;
-                import java.lang.annotation.Target;
+            'AnnoWithEnum.java': '''
+                import java.lang.annotation.*;
 
                 @Target({ElementType.TYPE, ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER})
                 @Retention(RetentionPolicy.RUNTIME)
                 public @interface AnnoWithEnum {
                     public Include value() default Include.ALWAYS;
-                    public enum Include {  ALWAYS,  NON_NULL,  NON_EMPTY; }
+                    public enum Include { ALWAYS, NON_NULL, NON_EMPTY; }
                 }
             '''
         ]
@@ -68,7 +60,7 @@ class InnerAnnotationStubTest extends StringSourcesStubTestCase {
 
     void verifyStubs() {
         def stubSource = stubJavaSourceFor('JacksonAnnotationTest')
-        assert stubSource.contains('@JsonSubTypes.Type')
+        assert stubSource.contains('@JsonSubTypes.Type(value=java.lang.Object.class)')
         assert stubSource.contains('@AnnoWithEnum(value=AnnoWithEnum.Include.NON_NULL)')
     }
 }
diff --git a/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy b/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
index 1e20c733f9..984b9b499a 100644
--- a/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
+++ b/src/test/org/codehaus/groovy/transform/DelegateTransformTest.groovy
@@ -65,14 +65,15 @@ final class DelegateTransformTest {
 
     @Test // GROOVY-10439
     void testDelegateImplementingInterfaceWithDifferentTypeArgumentThanOwner() {
-        assertScript '''
+        def err = shouldFail '''
             class C extends ArrayList<String> {
                 @Delegate List<Number> numbers // List<String> takes precedence
             }
             new C(numbers:[1,2,3])
         '''
+        assert err =~ /The return type of java.lang.Number remove\(int\) in C is incompatible with java.lang.String in java.util.ArrayList/
 
-        def err = shouldFail '''
+        err = shouldFail '''
             class C extends ArrayList<String> {
                 @Delegate HashSet<Number> numbers // Set<Number> added; Verifier checks
             }
diff --git a/src/test/org/codehaus/groovy/transform/traitx/TraitASTTransformationTest.groovy b/src/test/org/codehaus/groovy/transform/traitx/TraitASTTransformationTest.groovy
index d5a375ff64..4a454f3bf0 100644
--- a/src/test/org/codehaus/groovy/transform/traitx/TraitASTTransformationTest.groovy
+++ b/src/test/org/codehaus/groovy/transform/traitx/TraitASTTransformationTest.groovy
@@ -3048,7 +3048,7 @@ final class TraitASTTransformationTest {
 
         System.setProperty('spock.iKnowWhatImDoing.disableGroovyVersionCheck','true')
         assertScript shell, """
-            @Grab('org.spockframework:spock-core:2.2-M3-groovy-4.0')
+            @Grab('org.spockframework:spock-core:2.4-M1-groovy-4.0')
             @GrabExclude('org.apache.groovy:*')
             import spock.lang.Specification
 
