diff --git a/src/main/groovy/lang/GroovyClassLoader.java b/src/main/groovy/lang/GroovyClassLoader.java
index 88fe796cbe..996691a0f2 100644
--- a/src/main/groovy/lang/GroovyClassLoader.java
+++ b/src/main/groovy/lang/GroovyClassLoader.java
@@ -187,7 +187,7 @@ public class GroovyClassLoader extends URLClassLoader {
      * @return the main class defined in the given script
      */
     public Class parseClass(File file) throws CompilationFailedException, IOException {
-        return parseClass(new GroovyCodeSource(file));
+        return parseClass(new GroovyCodeSource(file, config.getSourceEncoding()));
     }
 
     /**
@@ -197,8 +197,13 @@ public class GroovyClassLoader extends URLClassLoader {
      * @param fileName the file name to use as the name of the class
      * @return the main class defined in the given script
      */
-    public Class parseClass(String text, String fileName) throws CompilationFailedException {
-        return parseClass(new GroovyCodeSource(text, fileName));
+    public Class parseClass(final String text, final String fileName) throws CompilationFailedException {
+        GroovyCodeSource gcs = (GroovyCodeSource) AccessController.doPrivileged(new PrivilegedAction() {
+            public Object run() {
+                return new GroovyCodeSource(text, fileName, "/groovy/script");
+            }
+        });
+        return parseClass(gcs);
     }
 
     /**
@@ -239,7 +244,10 @@ public class GroovyClassLoader extends URLClassLoader {
         GroovyCodeSource gcs = (GroovyCodeSource) AccessController.doPrivileged(new PrivilegedAction() {
             public Object run() {
                 try {
-                    return new GroovyCodeSource(DefaultGroovyMethods.getText(in), fileName, "/groovy/script");
+                    String scriptText = config.getSourceEncoding() != null ?
+                            DefaultGroovyMethods.getText(in, config.getSourceEncoding()) :
+                            DefaultGroovyMethods.getText(in);
+                    return new GroovyCodeSource(scriptText, fileName, "/groovy/script");
                 } catch (IOException e) {
                     throw new RuntimeException("Impossible to read the content of the input stream for file named: " + fileName, e);
                 }
diff --git a/src/main/groovy/lang/GroovyCodeSource.java b/src/main/groovy/lang/GroovyCodeSource.java
index 4abdbd6d0d..2408c54902 100644
--- a/src/main/groovy/lang/GroovyCodeSource.java
+++ b/src/main/groovy/lang/GroovyCodeSource.java
@@ -17,6 +17,7 @@
 package groovy.lang;
 
 import groovy.security.GroovyCodeSourcePermission;
+import groovy.util.CharsetToolkit;
 
 import java.io.*;
 import java.net.MalformedURLException;
@@ -50,9 +51,9 @@ public class GroovyCodeSource {
 	/** The certificates used to sign the items from the codesource */
 	Certificate[] certs;
     private boolean cachable;
-    
+
 	private File file;
-	
+
 	public GroovyCodeSource(String script, String name, String codeBase) {
 		this.name = name;
         this.scriptText = script;
@@ -99,17 +100,7 @@ public class GroovyCodeSource {
         }
     }
 
-    public GroovyCodeSource(final String scriptText, final String name) {
-        this.scriptText = scriptText;
-        this.name = name;
-    }
-
-    /**
-     * @param infile the file to create a GroovyCodeSource for.
-     *
-     * @throws IOException if an issue arises opening and reading the file.
-     */
-    public GroovyCodeSource(final File infile) throws IOException {
+    public GroovyCodeSource(final File infile, final String encoding) throws IOException {
         // avoid files which confuse us like ones with .. in path
         final File file = new File(infile.getCanonicalPath());
         if (!file.exists()) {
@@ -120,7 +111,7 @@ public class GroovyCodeSource {
         }
         try {
             if (!file.canRead())
-                throw new RuntimeException(file.toString() + " can not be read. Check the read permisson of the file \"" + file.toString() + "\" (" + file.getAbsolutePath() + ").");
+                throw new RuntimeException(file.toString() + " can not be read. Check the read permission of the file \"" + file.toString() + "\" (" + file.getAbsolutePath() + ").");
         }
         catch (SecurityException e) {
             throw e;
@@ -132,7 +123,14 @@ public class GroovyCodeSource {
         //package private and used only by the GroovyClassLoader.
         try {
             Object[] info = (Object[]) AccessController.doPrivileged(new PrivilegedExceptionAction() {
-                public Object run() throws MalformedURLException {
+                public Object run() throws IOException {
+                    // retrieve the content of the file using the provided encoding
+                    if (encoding != null) {
+                        scriptText = DefaultGroovyMethods.getText(infile, encoding);
+                    } else {
+                        scriptText = DefaultGroovyMethods.getText(infile);
+                    }
+
                     Object[] info = new Object[2];
                     URL url = file.toURI().toURL();
                     info[0] = url.toExternalForm();
@@ -144,12 +142,20 @@ public class GroovyCodeSource {
 
             this.name = (String) info[0];
             this.codeSource = (CodeSource) info[1];
-            this.scriptText = DefaultGroovyMethods.getText(file);
         } catch (PrivilegedActionException pae) {
             throw new RuntimeException("Could not construct a URL from: " + file);
         }
     }
 
+    /**
+     * @param infile the file to create a GroovyCodeSource for.
+     *
+     * @throws IOException if an issue arises opening and reading the file.
+     */
+    public GroovyCodeSource(final File infile) throws IOException {
+        this(infile, CharsetToolkit.getDefaultSystemCharset().name());
+    }
+
     public GroovyCodeSource(URL url) throws IOException {
 		if (url == null) {
 			throw new RuntimeException("Could not construct a GroovyCodeSource from a null URL");
diff --git a/src/main/groovy/lang/GroovyShell.java b/src/main/groovy/lang/GroovyShell.java
index 81a76f77f9..70c30b2dbd 100644
--- a/src/main/groovy/lang/GroovyShell.java
+++ b/src/main/groovy/lang/GroovyShell.java
@@ -16,6 +16,7 @@
 package groovy.lang;
 
 import groovy.ui.GroovyMain;
+import groovy.security.GroovyCodeSourcePermission;
 
 import org.codehaus.groovy.control.CompilationFailedException;
 import org.codehaus.groovy.control.CompilerConfiguration;
@@ -469,7 +470,10 @@ public class GroovyShell extends GroovyObjectSupport {
         GroovyCodeSource gcs = (GroovyCodeSource) AccessController.doPrivileged(new PrivilegedAction() {
             public Object run() {
                 try {
-                    return new GroovyCodeSource(DefaultGroovyMethods.getText(in), fileName, "/groovy/shell");
+                    String scriptText = config.getSourceEncoding() != null ?
+                            DefaultGroovyMethods.getText(in, config.getSourceEncoding()) :
+                            DefaultGroovyMethods.getText(in);
+                    return new GroovyCodeSource(scriptText, fileName, "/groovy/shell");
                 } catch (IOException e) {
                     throw new RuntimeException("Impossible to read the content of the input stream for file named: " + fileName, e);
                 }
@@ -500,6 +504,15 @@ public class GroovyShell extends GroovyObjectSupport {
         return script.run();
     }
 
+    /**
+     * Evaluates some script against the current Binding and returns the result
+     *
+     * @param scriptText the text of the script
+     */
+    public Object evaluate(final String scriptText) throws CompilationFailedException {
+        return evaluate(scriptText, generateScriptName(), "/groovy/shell");
+    }
+
     /**
      * Evaluates some script against the current Binding and returns the result
      *
@@ -507,15 +520,26 @@ public class GroovyShell extends GroovyObjectSupport {
      * @param fileName   is the logical file name of the script (which is used to create the class name of the script)
      */
     public Object evaluate(String scriptText, String fileName) throws CompilationFailedException {
-        return evaluate(new GroovyCodeSource(scriptText, fileName));
+        return evaluate(scriptText, fileName, "/groovy/shell");
     }
 
     /**
      * Evaluates some script against the current Binding and returns the result.
      * The .class file created from the script is given the supplied codeBase
      */
-    public Object evaluate(String scriptText, String fileName, String codeBase) throws CompilationFailedException {
-        return evaluate(new GroovyCodeSource(scriptText, fileName, codeBase));
+    public Object evaluate(final String scriptText, final String fileName, final String codeBase) throws CompilationFailedException {
+        SecurityManager sm = System.getSecurityManager();
+		if (sm != null) {
+		    sm.checkPermission(new GroovyCodeSourcePermission(codeBase));
+		}
+
+        GroovyCodeSource gcs = (GroovyCodeSource) AccessController.doPrivileged(new PrivilegedAction() {
+            public Object run() {
+                return new GroovyCodeSource(scriptText, fileName, codeBase);
+            }
+        });
+
+        return evaluate(gcs);
     }
 
     /**
@@ -524,16 +548,7 @@ public class GroovyShell extends GroovyObjectSupport {
      * @param file is the file of the script (which is used to create the class name of the script)
      */
     public Object evaluate(File file) throws CompilationFailedException, IOException {
-        return evaluate(new GroovyCodeSource(file));
-    }
-
-    /**
-     * Evaluates some script against the current Binding and returns the result
-     *
-     * @param scriptText the text of the script
-     */
-    public Object evaluate(String scriptText) throws CompilationFailedException {
-        return evaluate(new GroovyCodeSource(scriptText, generateScriptName()));
+        return evaluate(new GroovyCodeSource(file, config.getSourceEncoding()));
     }
 
     /**
@@ -581,7 +596,10 @@ public class GroovyShell extends GroovyObjectSupport {
         GroovyCodeSource gcs = (GroovyCodeSource) AccessController.doPrivileged(new PrivilegedAction() {
             public Object run() {
                 try {
-                    return new GroovyCodeSource(DefaultGroovyMethods.getText(in), fileName, "/groovy/shell");
+                    String scriptText = config.getSourceEncoding() != null ?
+                            DefaultGroovyMethods.getText(in, config.getSourceEncoding()) :
+                            DefaultGroovyMethods.getText(in);
+                    return new GroovyCodeSource(scriptText, fileName, "/groovy/shell");
                 } catch (IOException e) {
                     throw new RuntimeException("Impossible to read the content of the input stream for file named: " + fileName, e);
                 }
@@ -616,7 +634,7 @@ public class GroovyShell extends GroovyObjectSupport {
      * @param file is the file of the script (which is used to create the class name of the script)
      */
     public Script parse(File file) throws CompilationFailedException, IOException {
-        return parse(new GroovyCodeSource(file));
+        return parse(new GroovyCodeSource(file, config.getSourceEncoding()));
     }
 
     /**
