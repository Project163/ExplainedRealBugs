diff --git a/src/main/groovy/lang/GroovyClassLoader.java b/src/main/groovy/lang/GroovyClassLoader.java
index 7ed98e0829..63f0d974f6 100644
--- a/src/main/groovy/lang/GroovyClassLoader.java
+++ b/src/main/groovy/lang/GroovyClassLoader.java
@@ -172,7 +172,7 @@ public class GroovyClassLoader extends URLClassLoader {
             unit.addClassNode(classNode);
             unit.setClassgenCallback(collector);
             unit.compile(Phases.CLASS_GENERATION);
-
+            definePackage(collector.generatedClass.getName());
             return collector.generatedClass;
         } catch (CompilationFailedException e) {
             throw new RuntimeException(e);
@@ -280,6 +280,7 @@ public class GroovyClassLoader extends URLClassLoader {
             answer = collector.generatedClass;
             for (Iterator iter = collector.getLoadedClasses().iterator(); iter.hasNext();) {
                 Class clazz = (Class) iter.next();
+                definePackage(clazz.getName());
                 setClassCacheEntry(clazz);
             }
             if (shouldCacheSource) sourceCache.put(codeSource.getName(), answer);
@@ -287,6 +288,17 @@ public class GroovyClassLoader extends URLClassLoader {
         }
     }
 
+    private void definePackage(String className) {
+    	int i = className.lastIndexOf('.');
+    	if (i != -1) {
+    		String pkgName = className.substring(0, i);
+    		Package pkg = getPackage(pkgName);
+    		if (pkg == null) {
+    			definePackage(pkgName, null, null, null, null, null, null, null);
+    		}
+    	}
+    }
+    	
     /**
      * gets the currently used classpath.
      *
diff --git a/src/test/groovy/lang/GroovyClassLoaderTest.groovy b/src/test/groovy/lang/GroovyClassLoaderTest.groovy
index bd5b021c6c..46de2e5082 100644
--- a/src/test/groovy/lang/GroovyClassLoaderTest.groovy
+++ b/src/test/groovy/lang/GroovyClassLoaderTest.groovy
@@ -21,8 +21,9 @@ import java.security.CodeSource
 import org.codehaus.groovy.control.*
 import org.codehaus.groovy.ast.*
 import org.codehaus.groovy.classgen.*
+import org.objectweb.asm.Opcodes
 
-public class GroovyClassLoaderTest extends GroovyTestCase {
+public class GroovyClassLoaderTest extends GroovyTestCase implements Opcodes {
 
     private final GroovyClassLoader classLoader = new GroovyClassLoader()
 
@@ -173,6 +174,37 @@ public class GroovyClassLoaderTest extends GroovyTestCase {
             System.setProperty("file.encoding", encoding)
         }
     }
+
+    void testPackageDefinitionForGroovyClassesInParseClass() {
+        def loader = new GroovyClassLoader(this.class.classLoader)
+        def script = """
+            package pkg1
+            def x = 1
+        """
+        verifyPackageDetails(loader.parseClass(script), "pkg1")
+        
+        script = """
+            package pkg1.pkg2
+            class Groovy3537A{}
+        """
+        verifyPackageDetails(loader.parseClass(script), "pkg1.pkg2")
+    }
+    
+    void testPackageDefinitionForGroovyClassesInDefineClass() {
+        def loader = new GroovyClassLoader(this.class.classLoader)
+        def classNode = new ClassNode("pkg3.Groovy3537B", ACC_PUBLIC, ClassHelper.OBJECT_TYPE)
+        classNode.addConstructor(new ConstructorNode(ACC_PUBLIC, null))
+        def unit = new CompileUnit(loader, new CompilerConfiguration())
+        def module = new ModuleNode(unit)
+        classNode.setModule(module)
+        def clazz = loader.defineClass(classNode, classNode.getName() + ".groovy", "")
+        verifyPackageDetails(clazz, "pkg3")
+    }
+    
+    void verifyPackageDetails(clazz, expectedPkgName) {
+        assert clazz.package instanceof java.lang.Package
+        assert clazz.package.name == expectedPkgName
+    }
 }
 
 class GroovyClassLoaderTestFoo1 {}
