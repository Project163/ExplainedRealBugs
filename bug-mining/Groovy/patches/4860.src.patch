diff --git a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
index ce8dfec9ea..b7c5675bc9 100644
--- a/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
+++ b/src/main/java/org/codehaus/groovy/transform/stc/StaticTypeCheckingVisitor.java
@@ -2192,9 +2192,15 @@ out:    if ((samParameterTypes.length == 1 && isOrImplements(samParameterTypes[0
 
     @Override
     public void visitWhileLoop(final WhileStatement loop) {
+        Map<VariableExpression, ClassNode> startTypes = new HashMap<>();
+        loop.getLoopBlock().visit(new VariableExpressionTypeMemoizer(startTypes));
         Map<VariableExpression, List<ClassNode>> oldTracker = pushAssignmentTracking();
+
         super.visitWhileLoop(loop);
-        popAssignmentTracking(oldTracker);
+
+        if (isSecondPassNeededForControlStructure(startTypes, oldTracker)) { // GROOVY-11474
+            visitWhileLoop(loop);
+        }
     }
 
     @Override
diff --git a/src/test/groovy/transform/stc/STCAssignmentTest.groovy b/src/test/groovy/transform/stc/STCAssignmentTest.groovy
index 04f2e0e039..52d6594f08 100644
--- a/src/test/groovy/transform/stc/STCAssignmentTest.groovy
+++ b/src/test/groovy/transform/stc/STCAssignmentTest.groovy
@@ -613,6 +613,19 @@ class STCAssignmentTest extends StaticTypeCheckingTestCase {
         'Cannot find matching method java.io.Serializable#toInteger()'
     }
 
+    // GROOVY-11474
+    void testWhileLoopWithAssignment2() {
+        shouldFailWithMessages '''
+            def i = 0
+            def x = 1
+            while (i++ < 1) {
+                Integer y = x
+                x = " "
+            }
+        ''',
+        'Cannot assign value of type (java.io.Serializable & java.lang.Comparable',') to variable of type java.lang.Integer'
+    }
+
     void testTernaryWithNestedAssignment() {
         shouldFailWithMessages '''
             def x = '123'
