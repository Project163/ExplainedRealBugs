{"url":"https://api.github.com/repos/assimp/assimp/issues/545","repository_url":"https://api.github.com/repos/assimp/assimp","labels_url":"https://api.github.com/repos/assimp/assimp/issues/545/labels{/name}","comments_url":"https://api.github.com/repos/assimp/assimp/issues/545/comments","events_url":"https://api.github.com/repos/assimp/assimp/issues/545/events","html_url":"https://github.com/assimp/assimp/issues/545","id":71567551,"node_id":"MDU6SXNzdWU3MTU2NzU1MQ==","number":545,"title":"OBJ importer: Broken Material names","user":{"login":"oliverkutter","id":219048,"node_id":"MDQ6VXNlcjIxOTA0OA==","avatar_url":"https://avatars.githubusercontent.com/u/219048?v=4","gravatar_id":"","url":"https://api.github.com/users/oliverkutter","html_url":"https://github.com/oliverkutter","followers_url":"https://api.github.com/users/oliverkutter/followers","following_url":"https://api.github.com/users/oliverkutter/following{/other_user}","gists_url":"https://api.github.com/users/oliverkutter/gists{/gist_id}","starred_url":"https://api.github.com/users/oliverkutter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oliverkutter/subscriptions","organizations_url":"https://api.github.com/users/oliverkutter/orgs","repos_url":"https://api.github.com/users/oliverkutter/repos","events_url":"https://api.github.com/users/oliverkutter/events{/privacy}","received_events_url":"https://api.github.com/users/oliverkutter/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":244436167,"node_id":"MDU6TGFiZWwyNDQ0MzYxNjc=","url":"https://api.github.com/repos/assimp/assimp/labels/Bug","name":"Bug","color":"bfe5bf","default":false,"description":"Global flag to mark a deviation from expected behaviour"},{"id":1787751950,"node_id":"MDU6TGFiZWwxNzg3NzUxOTUw","url":"https://api.github.com/repos/assimp/assimp/labels/Wavefront-Obj","name":"Wavefront-Obj","color":"d4c5f9","default":false,"description":"Bugs related to the wavefront format"},{"id":8423924704,"node_id":"LA_kwDOAAnkjM8AAAAB9hrj4A","url":"https://api.github.com/repos/assimp/assimp/labels/Materials","name":"Materials","color":"D92C85","default":false,"description":"Bugs related to the material data"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-04-28T11:52:43Z","updated_at":"2025-04-17T17:55:12Z","closed_at":"2015-05-12T19:44:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi, \n\nI recently loaded an obj file that was created by Luxion Keyshot. When loading it via assimp, either in the viewer demo app or in my own code the material names are broken. The issue is that the names contain white spaces. \n\n```\n-------------------------------------------------------\n# OBJ Material Export by Luxion KeyShot\n\nnewmtl Anodized Rough Grey #1\nKd 0 0 0\nKs 0.515023 0.515023 0.515022\n\nnewmtl Hard Shiny Plastic White\nKd 1 1 1\nKs 0.992157 0.992157 0.992157\n\nnewmtl Hard Rough Plastic Black\nKd 0.0117647 0.0117647 0.0117647\nKs 0.992157 0.992157 0.992157\n....\n-------------------------------------------------------\n```\n\nIn this example the parser will only discover two material names \"Anodized\"and \"Hard\" instead of \"Anodized Rough Grey #1\", \"Hard Shiny Plastic White\", \"Hard Rough Plastic Black\". \n\nFollowing a patch that resolves the issue for me and allows me to import the model correctly.\n\n---\n\n```\ndiff --git a/code/ObjFileMtlImporter.cpp b/code/ObjFileMtlImporter.cpp\nindex bef8e47..7f6365b 100644\n--- a/code/ObjFileMtlImporter.cpp\n+++ b/code/ObjFileMtlImporter.cpp\n@@ -268,7 +268,14 @@ void ObjFileMtlImporter::createMaterial()\n    if ( numToken == 1 ) {\n        name = AI_DEFAULT_MATERIAL_NAME;\n    } else {\n-       name = token[ 1 ];\n+        // skip newmtl and all following white spaces\n+        std::size_t first_ws_pos = line.find_first_of(\" \\t\");\n+        ai_assert(first_ws_pos != std::string::npos);\n+        std::size_t first_non_ws_pos = line.find_first_not_of(\" \\t\", first_ws_pos);\n+        ai_assert(first_non_ws_pos != std::string::npos);\n+        if (first_non_ws_pos != std::string::npos) {\n+            name = line.substr(first_non_ws_pos);\n+        }\n    }\n\n    std::map<std::string, ObjFile::Material*>::iterator it = m_pModel->m_MaterialMap.find( name );\ndiff --git a/code/ObjFileParser.cpp b/code/ObjFileParser.cpp\nindex 9c59828..2ffc417 100644\n--- a/code/ObjFileParser.cpp\n+++ b/code/ObjFileParser.cpp\n@@ -469,7 +469,7 @@ void ObjFileParser::getMaterialDesc()\n         return;\n\n     char *pStart = &(*m_DataIt);\n-    while( m_DataIt != m_DataItEnd && !IsSpaceOrNewLine( *m_DataIt ) ) {\n+    while (m_DataIt != m_DataItEnd && !IsLineEnd(*m_DataIt)) {\n         ++m_DataIt;\n     }\n```\n\n---\n","closed_by":{"login":"acgessler","id":908209,"node_id":"MDQ6VXNlcjkwODIwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/908209?v=4","gravatar_id":"","url":"https://api.github.com/users/acgessler","html_url":"https://github.com/acgessler","followers_url":"https://api.github.com/users/acgessler/followers","following_url":"https://api.github.com/users/acgessler/following{/other_user}","gists_url":"https://api.github.com/users/acgessler/gists{/gist_id}","starred_url":"https://api.github.com/users/acgessler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acgessler/subscriptions","organizations_url":"https://api.github.com/users/acgessler/orgs","repos_url":"https://api.github.com/users/acgessler/repos","events_url":"https://api.github.com/users/acgessler/events{/privacy}","received_events_url":"https://api.github.com/users/acgessler/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/assimp/assimp/issues/545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/assimp/assimp/issues/545/timeline","performed_via_github_app":null,"state_reason":"completed"}