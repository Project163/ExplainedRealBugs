diff --git a/client/src/test/java/org/apache/qpid/client/AMQDestinationTest.java b/client/src/test/java/org/apache/qpid/client/AMQDestinationTest.java
index 2b0f750ee..32c97bac9 100644
--- a/client/src/test/java/org/apache/qpid/client/AMQDestinationTest.java
+++ b/client/src/test/java/org/apache/qpid/client/AMQDestinationTest.java
@@ -33,7 +33,6 @@ import javax.jms.Destination;
 import javax.jms.Queue;
 import javax.jms.Topic;
 
-import junit.framework.TestCase;
 import org.apache.qpid.test.utils.QpidTestCase;
 
 public class AMQDestinationTest extends QpidTestCase
@@ -163,6 +162,39 @@ public class AMQDestinationTest extends QpidTestCase
         assertEmptyNodeBindings(new AMQAnyDestination("ADDR:testDest3; {node: {type: topic}}"));
     }
 
+    public void testSimple_BURL() throws Exception
+    {
+        AMQQueue queue = new AMQQueue("BURL:direct://amq.direct/test-route/Foo");
+
+        assertEquals("direct", queue.getExchangeClass());
+        assertEquals("amq.direct", queue.getExchangeName());
+        assertEquals("Foo", queue.getQueueName());
+        assertEquals(queue.getQueueName(), queue.getRoutingKey());
+        assertFalse(queue.isDurable());
+    }
+
+    public void testAnonymousExchange_BURL() throws Exception
+    {
+        AMQQueue queue = new AMQQueue("BURL:direct:///Foo?durable='true'");
+
+        assertEquals("direct", queue.getExchangeClass());
+        assertEquals("", queue.getExchangeName());
+        assertEquals("Foo", queue.getQueueName());
+        assertEquals(queue.getQueueName(), queue.getRoutingKey());
+        assertTrue(queue.isDurable());
+    }
+
+    public void testNonDurableExchange_BURL() throws Exception
+    {
+        AMQQueue queue = new AMQQueue("BURL:direct://mynondurableexch//Foo?exchangeautodelete='true'");
+
+        assertEquals("direct", queue.getExchangeClass());
+        assertEquals("mynondurableexch", queue.getExchangeName());
+        assertEquals("Foo", queue.getQueueName());
+        assertEquals("Foo", queue.getRoutingKey());
+        assertTrue(queue.isExchangeAutoDelete());
+    }
+
     public void testSerializeAMQQueue_BURL() throws Exception
     {
         Queue queue = new AMQQueue("BURL:direct://amq.direct/test-route/Foo?routingkey='Foo'");
diff --git a/client/src/test/java/org/apache/qpid/jndi/PropertiesFileInitialContextFactoryTest.java b/client/src/test/java/org/apache/qpid/jndi/PropertiesFileInitialContextFactoryTest.java
index 21199e8c0..9acc7733f 100644
--- a/client/src/test/java/org/apache/qpid/jndi/PropertiesFileInitialContextFactoryTest.java
+++ b/client/src/test/java/org/apache/qpid/jndi/PropertiesFileInitialContextFactoryTest.java
@@ -105,7 +105,7 @@ public class PropertiesFileInitialContextFactoryTest extends QpidTestCase
     {
         Properties properties = new Properties();
         properties.put("connectionfactory.qpidConnectionfactory", CONNECTION_URL);
-        properties.put("destination.topicExchange", "destName");
+        properties.put("destination.topicExchange", "ADDR:destName");
 
         File f = File.createTempFile(getTestName(), ".properties");
         try
@@ -114,7 +114,6 @@ public class PropertiesFileInitialContextFactoryTest extends QpidTestCase
             properties.store(fos, null);
             fos.close();
 
-            setTestSystemProperty(ClientProperties.DEST_SYNTAX, "ADDR");
             setTestSystemProperty(InitialContext.INITIAL_CONTEXT_FACTORY, "org.apache.qpid.jndi.PropertiesFileInitialContextFactory");
             setTestSystemProperty(InitialContext.PROVIDER_URL,  f.toURI().toURL().toString());
 
diff --git a/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/BindingURLTest.java b/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/BindingURLTest.java
new file mode 100644
index 000000000..550ba9eb9
--- /dev/null
+++ b/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/BindingURLTest.java
@@ -0,0 +1,274 @@
+/*
+ *
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ *
+ */
+package org.apache.qpid.test.unit.client.destinationurl;
+
+import org.apache.qpid.test.utils.QpidTestCase;
+
+import org.apache.qpid.url.AMQBindingURL;
+import org.apache.qpid.url.BindingURL;
+
+import java.net.URISyntaxException;
+
+public class BindingURLTest extends QpidTestCase
+{
+
+    public void testFullURL() throws Exception
+    {
+        String url = "exchange.Class://exchangeName/Destination/Queue";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchange.Class", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("Destination", burl.getDestinationName());
+        assertEquals("Queue", burl.getQueueName());
+        assertEquals(1, burl.getBindingKeys().length);
+        assertEquals("Destination", burl.getRoutingKey());
+    }
+
+    public void testDestinationAbsent() throws Exception
+    {
+        String url = "exchangeClass://exchangeName//Queue";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("Queue", burl.getQueueName());
+    }
+
+    public void testQueueAbsent() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("Destination", burl.getDestinationName());
+        assertEquals("", burl.getQueueName());
+    }
+
+    public void testDestinationAndQueueAbsent() throws Exception
+    {
+        String url = "exchangeClass://exchangeName//";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("", burl.getQueueName());
+    }
+
+    public void testQueueOnly() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Queue?option='x'";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals("exchangeClass://exchangeName//Queue?option='x'", burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("Queue", burl.getQueueName());
+    }
+
+
+    public void testQueueWithOption() throws Exception
+    {
+        String url = "exchangeClass://exchangeName//Queue?option='value'";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("Queue", burl.getQueueName());
+        assertEquals("value", burl.getOption("option"));
+    }
+
+    public void testRoutingKey() throws Exception
+    {
+        String url = "exchangeClass://exchangeName//Queue?routingkey='Queue1'";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("Queue1", burl.getRoutingKey());
+        assertEquals("Queue", burl.getQueueName());
+    }
+
+    public void testWithSingleOption() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/?option='value'";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("Destination", burl.getDestinationName());
+        assertEquals("", burl.getQueueName());
+        assertEquals("value", burl.getOption("option"));
+    }
+
+    public void testWithMultipleOptions() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/?option='value',option2='value2'";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("exchangeName", burl.getExchangeName());
+        assertEquals("Destination", burl.getDestinationName());
+        assertEquals("", burl.getQueueName());
+        assertEquals("value", burl.getOption("option"));
+        assertEquals("value2", burl.getOption("option2"));
+    }
+
+    public void testRoutingKeyDefaulting_NonDirectExchangeClass() throws Exception
+    {
+
+        String url = "exchangeClass://exchangeName/Destination/Queue";
+
+        BindingURL dest = new AMQBindingURL(url);
+
+        assertEquals("exchangeClass", dest.getExchangeClass());
+        assertEquals("exchangeName", dest.getExchangeName());
+        assertEquals("Destination", dest.getDestinationName());
+        assertEquals("Queue", dest.getQueueName());
+        assertEquals(dest.getDestinationName(), dest.getRoutingKey());
+
+    }
+
+    public void testRoutingKeyDefaulting_DirectExchangeClass() throws Exception
+    {
+        String url = "direct://exchangeName/Destination/Queue";
+
+        BindingURL dest = new AMQBindingURL(url);
+
+        assertEquals("direct", dest.getExchangeClass());
+        assertEquals("exchangeName", dest.getExchangeName());
+        assertEquals("Destination", dest.getDestinationName());
+        assertEquals("Queue", dest.getQueueName());
+        assertEquals(dest.getQueueName(), dest.getRoutingKey());
+
+    }
+
+    public void testSingleBindingKeys() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/?bindingkey='key'";
+
+        BindingURL dest = new AMQBindingURL(url);
+
+        assertEquals("exchangeClass", dest.getExchangeClass());
+        assertEquals("exchangeName", dest.getExchangeName());
+        assertEquals("Destination", dest.getDestinationName());
+        assertEquals("", dest.getQueueName());
+        assertEquals(1, dest.getBindingKeys().length);
+        assertEquals("key", dest.getBindingKeys()[0]);
+    }
+
+    public void testMultipleBindingKeys() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/?bindingkey='key1',bindingkey='key2'";
+
+        BindingURL dest = new AMQBindingURL(url);
+
+        assertEquals("exchangeClass", dest.getExchangeClass());
+        assertEquals("exchangeName", dest.getExchangeName());
+        assertEquals("Destination", dest.getDestinationName());
+        assertEquals("", dest.getQueueName());
+        assertEquals(2, dest.getBindingKeys().length);
+        assertEquals("key1", dest.getBindingKeys()[0]);
+        assertEquals("key2", dest.getBindingKeys()[1]);
+    }
+
+    public void testAnonymousExchange() throws Exception
+    {
+        String url = "exchangeClass:////Queue";
+
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals(url, burl.toString());
+
+        assertEquals("exchangeClass", burl.getExchangeClass());
+        assertEquals("", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("Queue", burl.getQueueName());
+    }
+
+    // You can only specify only a routing key or binding key, but not both.
+    public void testRoutingKeyAndBindingKeyAreMutuallyExclusive() throws Exception
+    {
+        String url = "exchangeClass://exchangeName/Destination/?bindingkey='key1',routingkey='key2'";
+        try
+        {
+            new AMQBindingURL(url);
+            fail("Exception not thrown");
+        }
+        catch(URISyntaxException e)
+        {
+            // PASS
+        }
+    }
+
+    public void testBareNameTreatedAsQueue() throws Exception
+    {
+        String url = "IBMPerfQueue1?durable='true'";
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals("direct:////IBMPerfQueue1?durable='true'", burl.toString());
+
+        assertEquals("direct", burl.getExchangeClass());
+        assertEquals("", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("IBMPerfQueue1", burl.getQueueName());
+        assertEquals("IBMPerfQueue1", burl.getRoutingKey());
+        assertEquals("IBMPerfQueue1", burl.getBindingKeys()[0]);
+    }
+
+    public void testBareNameContainingSlashesTreatedAsQueueWithOddName() throws Exception
+    {
+        String url = "/a/b/c/d";
+        BindingURL burl = new AMQBindingURL(url);
+
+        assertEquals("direct://///a/b/c/d", burl.toString());
+
+        assertEquals("direct", burl.getExchangeClass());
+        assertEquals("", burl.getExchangeName());
+        assertEquals("", burl.getDestinationName());
+        assertEquals("/a/b/c/d", burl.getQueueName());
+        assertEquals("/a/b/c/d", burl.getRoutingKey());
+        assertEquals("/a/b/c/d", burl.getBindingKeys()[0]);
+    }
+
+}
diff --git a/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/DestinationURLTest.java b/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/DestinationURLTest.java
deleted file mode 100644
index 421747bea..000000000
--- a/client/src/test/java/org/apache/qpid/test/unit/client/destinationurl/DestinationURLTest.java
+++ /dev/null
@@ -1,442 +0,0 @@
-/*
- *
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *   http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing,
- * software distributed under the License is distributed on an
- * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- * KIND, either express or implied.  See the License for the
- * specific language governing permissions and limitations
- * under the License.
- *
- */
-package org.apache.qpid.test.unit.client.destinationurl;
-
-import junit.framework.TestCase;
-import org.apache.qpid.test.utils.QpidTestCase;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import org.apache.qpid.client.AMQDestination;
-import org.apache.qpid.client.RejectBehaviour;
-import org.apache.qpid.exchange.ExchangeDefaults;
-import org.apache.qpid.framing.AMQShortString;
-import org.apache.qpid.url.AMQBindingURL;
-import org.apache.qpid.url.BindingURL;
-
-import java.net.URISyntaxException;
-
-public class DestinationURLTest extends QpidTestCase
-{
-    private static final Logger _logger = LoggerFactory.getLogger(DestinationURLTest.class);
-
-    public void testFullURL() throws URISyntaxException
-    {
-
-        String url = "exchange.Class://exchangeName/Destination/Queue";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(url.equals(dest.toString()));
-
-        assertTrue(dest.getExchangeClass().equals("exchange.Class"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals("Destination"));
-
-        assertTrue(dest.getQueueName().equals("Queue"));
-    }
-
-    public void testQueue() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName//Queue";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(url.equals(dest.toString()));
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals(""));
-
-        assertTrue(dest.getQueueName().equals("Queue"));
-    }
-
-    public void testQueueWithOption() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName//Queue?option='value'";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(url.equals(dest.toString()));
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals(""));
-
-        assertTrue(dest.getQueueName().equals("Queue"));
-        assertTrue(dest.getOption("option").equals("value"));
-    }
-
-
-    public void testDestination() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName/Destination/";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(url.equals(dest.toString()));
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals("Destination"));
-
-        assertTrue(dest.getQueueName().equals(""));
-    }
-
-    public void testDestinationWithOption() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName/Destination/?option='value'";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(url.equals(dest.toString()));
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals("Destination"));
-
-        assertTrue(dest.getQueueName().equals(""));
-
-        assertTrue(dest.getOption("option").equals("value"));
-    }
-
-    public void testDestinationWithMultiOption() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName/Destination/?option='value',option2='value2'";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals("Destination"));
-
-        assertTrue(dest.getQueueName().equals(""));
-
-        assertTrue(dest.getOption("option").equals("value"));
-        assertTrue(dest.getOption("option2").equals("value2"));
-    }
-
-    public void testDestinationWithNoExchangeDefaultsToDirect() throws URISyntaxException
-    {
-
-        String url = "IBMPerfQueue1?durable='true'";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(dest.getExchangeClass().equals(ExchangeDefaults.DIRECT_EXCHANGE_CLASS));
-
-        assertTrue(dest.getExchangeName().equals(""));
-
-        assertTrue(dest.getDestinationName().equals(""));
-
-        assertTrue(dest.getQueueName().equals("IBMPerfQueue1"));
-
-        assertTrue(dest.getOption("durable").equals("true"));
-    }
-
-    public void testDestinationWithMultiBindingKeys() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName/Destination/?bindingkey='key1',bindingkey='key2'";
-
-        AMQBindingURL dest = new AMQBindingURL(url);
-
-        assertTrue(dest.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(dest.getExchangeName().equals("exchangeName"));
-
-        assertTrue(dest.getDestinationName().equals("Destination"));
-
-        assertTrue(dest.getQueueName().equals(""));
-
-        assertTrue(dest.getBindingKeys().length == 2);
-    }
-
-    // You can only specify only a routing key or binding key, but not both.
-    public void testDestinationIfOnlyRoutingKeyOrBindingKeyIsSpecified() throws URISyntaxException
-    {
-
-        String url = "exchangeClass://exchangeName/Destination/?bindingkey='key1',routingkey='key2'";
-        boolean exceptionThrown = false;
-        try
-        {
-
-            new AMQBindingURL(url);
-        }
-        catch(URISyntaxException e)
-        {
-            exceptionThrown = true;
-            _logger.info("Exception thrown",e);
-        }
-
-        assertTrue("Failed to throw an URISyntaxException when both the bindingkey and routingkey is specified",exceptionThrown);
-    }
-
-    public void testExchangeOptionsNotPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_DURABLE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_AUTODELETE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_INTERNAL));
-
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertFalse(dest.isExchangeAutoDelete());
-        assertFalse(dest.isExchangeDurable());
-        assertFalse(dest.isExchangeInternal());
-    }
-
-    public void testExchangeAutoDeleteOptionPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue?" + BindingURL.OPTION_EXCHANGE_AUTODELETE + "='true'";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertEquals("true", burl.getOption(BindingURL.OPTION_EXCHANGE_AUTODELETE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_DURABLE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_INTERNAL));
-
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertTrue(dest.isExchangeAutoDelete());
-        assertFalse(dest.isExchangeDurable());
-        assertFalse(dest.isExchangeInternal());
-    }
-
-    public void testExchangeDurableOptionPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue?" + BindingURL.OPTION_EXCHANGE_DURABLE + "='true'";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertEquals("true", burl.getOption(BindingURL.OPTION_EXCHANGE_DURABLE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_AUTODELETE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_INTERNAL));
-
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertTrue(dest.isExchangeDurable());
-        assertFalse(dest.isExchangeAutoDelete());
-        assertFalse(dest.isExchangeInternal());
-    }
-
-    public void testExchangeInternalOptionPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue?" + BindingURL.OPTION_EXCHANGE_INTERNAL + "='true'";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertEquals("true", burl.getOption(BindingURL.OPTION_EXCHANGE_INTERNAL));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_AUTODELETE));
-        assertNull(burl.getOption(BindingURL.OPTION_EXCHANGE_DURABLE));
-
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertTrue(dest.isExchangeInternal());
-        assertFalse(dest.isExchangeDurable());
-        assertFalse(dest.isExchangeAutoDelete());
-    }
-
-    public void testRejectBehaviourPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue?rejectbehaviour='server'";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertTrue(burl.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(burl.getExchangeName().equals("exchangeName"));
-
-        assertTrue(burl.getDestinationName().equals("Destination"));
-
-        assertTrue(burl.getQueueName().equals("Queue"));
-
-        //check that the MaxDeliveryCount property has the right value
-        assertEquals("server",burl.getOption(BindingURL.OPTION_REJECT_BEHAVIOUR));
-
-        //check that the MaxDeliveryCount value is correctly returned from an AMQDestination
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertEquals("Reject behaviour is unexpected", RejectBehaviour.SERVER, dest.getRejectBehaviour());
-    }
-
-    public void testRejectBehaviourNotPresent() throws URISyntaxException
-    {
-        String url = "exchangeClass://exchangeName/Destination/Queue";
-
-        AMQBindingURL burl = new AMQBindingURL(url);
-
-        assertTrue(url.equals(burl.toString()));
-
-        assertTrue(burl.getExchangeClass().equals("exchangeClass"));
-
-        assertTrue(burl.getExchangeName().equals("exchangeName"));
-
-        assertTrue(burl.getDestinationName().equals("Destination"));
-
-        assertTrue(burl.getQueueName().equals("Queue"));
-
-        class MyTestAMQDestination extends AMQDestination
-        {
-            public MyTestAMQDestination(BindingURL url)
-            {
-                super(url);
-            }
-            public boolean isNameRequired()
-            {
-                return false;
-            }
-        };
-
-        AMQDestination dest = new MyTestAMQDestination(burl);
-        assertNull("Reject behaviour is unexpected", dest.getRejectBehaviour());
-    }
-
-    public void testBindingUrlWithoutDestinationAndQueueName() throws Exception
-    {
-        AMQBindingURL bindingURL = new AMQBindingURL("topic://amq.topic//?routingkey='testTopic'");
-        assertEquals("Unexpected queue name", "", bindingURL.getQueueName());
-        assertEquals("Unexpected destination", "", bindingURL.getDestinationName());
-        assertEquals("Unexpected routing key", "testTopic", bindingURL.getRoutingKey());
-    }
-
-    public void testBindingUrlWithoutDestinationAndMissedQueueName() throws Exception
-    {
-        AMQBindingURL bindingURL = new AMQBindingURL("topic://amq.topic/?routingkey='testTopic'");
-        assertEquals("Unexpected queue name", "", bindingURL.getQueueName());
-        assertEquals("Unexpected destination", "", bindingURL.getDestinationName());
-        assertEquals("Unexpected routing key", "testTopic", bindingURL.getRoutingKey());
-    }
-
-    public void testBindingUrlWithoutQueueName() throws Exception
-    {
-        AMQBindingURL bindingURL = new AMQBindingURL("topic://amq.topic/destination/?routingkey='testTopic'");
-        assertEquals("Unexpected queue name", "", bindingURL.getQueueName());
-        assertEquals("Unexpected destination", "destination", bindingURL.getDestinationName());
-        assertEquals("Unexpected routing key", "testTopic", bindingURL.getRoutingKey());
-    }
-
-    public void testBindingUrlWithQueueNameWithoutDestination() throws Exception
-    {
-        AMQBindingURL bindingURL = new AMQBindingURL("topic://amq.topic//queueName?routingkey='testTopic'");
-        assertEquals("Unexpected queue name", "queueName", bindingURL.getQueueName());
-        assertEquals("Unexpected destination", "", bindingURL.getDestinationName());
-        assertEquals("Unexpected routing key", "testTopic", bindingURL.getRoutingKey());
-    }
-
-    public void testBindingUrlWithQueueNameAndDestination() throws Exception
-    {
-        AMQBindingURL bindingURL = new AMQBindingURL("topic://amq.topic/destination/queueName?routingkey='testTopic'");
-        assertEquals("Unexpected queue name", "queueName", bindingURL.getQueueName());
-        assertEquals("Unexpected destination", "destination", bindingURL.getDestinationName());
-        assertEquals("Unexpected routing key", "testTopic", bindingURL.getRoutingKey());
-    }
-
-    public static junit.framework.Test suite()
-    {
-        return new junit.framework.TestSuite(DestinationURLTest.class);
-    }
-}
