diff --git a/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_10.java b/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_10.java
index f717ca465..9efc670e9 100644
--- a/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_10.java
+++ b/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_10.java
@@ -204,7 +204,7 @@ public class BasicMessageProducer_0_10 extends BasicMessageProducer
         }
 
         ByteBuffer data = message.getData();
-        messageProps.setContentLength(data.remaining());
+        messageProps.setContentLength(data == null ? 0 : data.remaining());
 
         // send the message
         try
diff --git a/client/src/main/java/org/apache/qpid/client/message/JMSMapMessage.java b/client/src/main/java/org/apache/qpid/client/message/JMSMapMessage.java
index 0b0517921..af36c75ef 100644
--- a/client/src/main/java/org/apache/qpid/client/message/JMSMapMessage.java
+++ b/client/src/main/java/org/apache/qpid/client/message/JMSMapMessage.java
@@ -450,9 +450,9 @@ public class JMSMapMessage extends AbstractJMSMessage implements javax.jms.MapMe
 
     protected void populateMapFromData(ByteBuffer data) throws JMSException
     {
-        TypedBytesContentReader reader = new TypedBytesContentReader(data);
         if (data != null)
         {
+            TypedBytesContentReader reader = new TypedBytesContentReader(data);
             data.rewind();
 
             final int entries = reader.readIntImpl();
