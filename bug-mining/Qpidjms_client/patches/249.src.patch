diff --git a/client/src/main/java/org/apache/qpid/client/AMQQueueBrowser.java b/client/src/main/java/org/apache/qpid/client/AMQQueueBrowser.java
index d7a54cad4..d96544adf 100644
--- a/client/src/main/java/org/apache/qpid/client/AMQQueueBrowser.java
+++ b/client/src/main/java/org/apache/qpid/client/AMQQueueBrowser.java
@@ -22,14 +22,12 @@ package org.apache.qpid.client;
 
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
-import org.apache.qpid.AMQException;
 
 import javax.jms.IllegalStateException;
 import javax.jms.JMSException;
 import javax.jms.Message;
 import javax.jms.Queue;
 import javax.jms.QueueBrowser;
-
 import java.util.ArrayList;
 import java.util.Enumeration;
 import java.util.concurrent.atomic.AtomicBoolean;
@@ -90,38 +88,11 @@ public class AMQQueueBrowser implements QueueBrowser
     {
         checkState();
         final BasicMessageConsumer consumer =
-            (BasicMessageConsumer) _session.createBrowserConsumer(_queue, _messageSelector, false);
+                (BasicMessageConsumer) _session.createBrowserConsumer(_queue, _messageSelector, false);
 
         _consumers.add(consumer);
 
-        return new Enumeration()
-        {
-
-            Message _nextMessage = consumer == null ? null : consumer.receiveBrowse();
-
-            public boolean hasMoreElements()
-            {
-                _logger.info("QB:hasMoreElements:" + (_nextMessage != null));
-                return (_nextMessage != null);
-            }
-
-            public Object nextElement()
-            {
-                Message msg = _nextMessage;
-                try
-                {
-                    _logger.info("QB:nextElement about to receive");
-                    _nextMessage = consumer.receiveBrowse();
-                    _logger.info("QB:nextElement received:" + _nextMessage);
-                }
-                catch (JMSException e)
-                {
-                    _logger.warn("Exception caught while queue browsing", e);
-                    _nextMessage = null;
-                }
-                return msg;
-            }
-        };
+        return new QueueBrowserEnumeration(consumer);
     }
 
     public void close() throws JMSException
@@ -134,4 +105,39 @@ public class AMQQueueBrowser implements QueueBrowser
         _consumers.clear();
     }
 
+    private class QueueBrowserEnumeration implements Enumeration
+    {
+        Message _nextMessage;
+        private BasicMessageConsumer _consumer;
+
+        public QueueBrowserEnumeration(BasicMessageConsumer consumer) throws JMSException
+        {
+            _nextMessage = consumer == null ? null : consumer.receiveBrowse();
+            _logger.info("QB:created with first element:" + _nextMessage);
+            _consumer = consumer;
+        }
+
+        public boolean hasMoreElements()
+        {
+            _logger.info("QB:hasMoreElements:" + (_nextMessage != null));
+            return (_nextMessage != null);
+        }
+
+        public Object nextElement()
+        {
+            Message msg = _nextMessage;
+            try
+            {
+                _logger.info("QB:nextElement about to receive");
+                _nextMessage = _consumer.receiveBrowse();
+                _logger.info("QB:nextElement received:" + _nextMessage);
+            }
+            catch (JMSException e)
+            {
+                _logger.warn("Exception caught while queue browsing", e);
+                _nextMessage = null;
+            }
+            return msg;
+        }
+    }    
 }
