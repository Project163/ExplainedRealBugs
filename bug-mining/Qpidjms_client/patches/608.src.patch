diff --git a/client/src/main/java/org/apache/qpid/client/AMQConnection.java b/client/src/main/java/org/apache/qpid/client/AMQConnection.java
index d1297b7b5..1c8a71c0a 100644
--- a/client/src/main/java/org/apache/qpid/client/AMQConnection.java
+++ b/client/src/main/java/org/apache/qpid/client/AMQConnection.java
@@ -57,6 +57,7 @@ import javax.naming.Reference;
 import javax.naming.Referenceable;
 import javax.naming.StringRefAddr;
 
+import org.apache.qpid.client.state.AMQState;
 import org.apache.qpid.jndi.ObjectFactory;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -626,8 +627,15 @@ public class AMQConnection extends Closeable implements CommonConnection, Refere
             Class partypes[] = new Class[1];
             partypes[0] = AMQConnection.class;
             _delegate = (AMQConnectionDelegate) c.getConstructor(partypes).newInstance(this);
-            //Update our session to use this new protocol version
-            _protocolHandler.getProtocolSession().setProtocolVersion(_delegate.getProtocolVersion());
+
+            if (!ProtocolVersion.v0_10.equals(_delegate.getProtocolVersion()))
+            {
+                _protocolHandler.getProtocolSession().setProtocolVersion(_delegate.getProtocolVersion());
+            }
+
+            // reset state waiter state
+           _protocolHandler.getStateManager().clearLastException();
+            _protocolHandler.getStateManager().changeState(AMQState.CONNECTION_NOT_STARTED);
 
         }
         catch (ClassNotFoundException e)
diff --git a/client/src/main/java/org/apache/qpid/client/AMQProtocolHandler.java b/client/src/main/java/org/apache/qpid/client/AMQProtocolHandler.java
index a6dac2bc3..02e28d133 100644
--- a/client/src/main/java/org/apache/qpid/client/AMQProtocolHandler.java
+++ b/client/src/main/java/org/apache/qpid/client/AMQProtocolHandler.java
@@ -479,8 +479,13 @@ public class AMQProtocolHandler implements ExceptionHandlingByteBufferReceiver,
                     // suggesting an alternate ProtocolVersion; the server will then close the
                     // connection.
                     ProtocolInitiation protocolInit = (ProtocolInitiation) message;
-                    _suggestedProtocolVersion = protocolInit.checkVersion();
-                    _logger.info("Broker suggested using protocol version: {} ", _suggestedProtocolVersion);
+                    ProtocolVersion checkedVersion = protocolInit.checkVersion();
+                    _logger.info("Broker suggested using protocol version: {} ", checkedVersion);
+
+                    // Create protocol version from reported major and minor versions
+                    // in order to use them on delegate instantiation.
+                    // Currently delegate classes are named based on reported major and minor versions.
+                    _suggestedProtocolVersion = ProtocolVersion.get(protocolInit.getProtocolMajor(), protocolInit.getProtocolMinor());
 
                     // get round a bug in old versions of qpid whereby the connection is not closed
                     _stateManager.changeState(AMQState.CONNECTION_CLOSED);
