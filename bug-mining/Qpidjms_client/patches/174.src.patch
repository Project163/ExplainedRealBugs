diff --git a/client/src/main/java/org/apache/qpid/client/AMQSession_0_10.java b/client/src/main/java/org/apache/qpid/client/AMQSession_0_10.java
index 4f9c4edc7..26af708d7 100644
--- a/client/src/main/java/org/apache/qpid/client/AMQSession_0_10.java
+++ b/client/src/main/java/org/apache/qpid/client/AMQSession_0_10.java
@@ -758,7 +758,7 @@ public class AMQSession_0_10 extends AMQSession
         _txRangeSet.add((int) id);
         _txSize++;
         // this is a heuristic, we may want to have that configurable 
-        if( _txSize > _connection.getMaxPrefetch() / 2 )
+        if( _txSize % (_connection.getMaxPrefetch() / 2) == 0 )
         {
            // send completed so consumer credits don't dry up
            getQpidSession().messageAcknowledge(_txRangeSet, false);
