<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:21:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-2766] string to double conversion results in questionable precision</title>
                <link>https://issues.apache.org/jira/browse/QPID-2766</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;The following test:&lt;/p&gt;

&lt;p&gt;public void testString2Double_1() {&lt;br/&gt;
    try &lt;/p&gt;
{
      Message message = senderSession.createMessage();
      message.setStringProperty(&quot;pi&quot;, &quot;3.14159&quot;);
      assertEquals(3.14159, message.getDoubleProperty(&quot;pi&quot;),0);
    }
&lt;p&gt; catch (JMSException e) &lt;/p&gt;
{
      fail(e);
    }
&lt;p&gt;  }&lt;/p&gt;

&lt;p&gt;Fails with:&lt;/p&gt;

&lt;p&gt;        junit.framework.AssertionFailedError: expected:&amp;lt;3.14159&amp;gt; but&lt;br/&gt;
was:&amp;lt;3.141590118408203&amp;gt;&lt;/p&gt;

&lt;p&gt;This appears to be because the client ends up doing the equivalent of&lt;br/&gt;
Double.valueOf(Float.valueOf(value)) when doing string to double conversion&lt;br/&gt;
rather than the more direct Double.valueOf(value). &lt;/p&gt;</description>
                <environment></environment>
        <key id="12470308">QPID-2766</key>
            <summary>string to double conversion results in questionable precision</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajith">Rajith Muditha Attapattu</assignee>
                                    <reporter username="rajith">Rajith Muditha Attapattu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jul 2010 02:15:20 +0000</created>
                <updated>Tue, 14 Mar 2017 20:07:30 +0000</updated>
                            <resolved>Mon, 18 Oct 2010 22:08:17 +0000</resolved>
                                    <version>0.6</version>
                                    <fixVersion>0.7</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12893140" author="gemmellr" created="Wed, 28 Jul 2010 11:16:58 +0000"  >&lt;p&gt;Whilst I agree with the reason for making it I dont think the change made is entirely correct as it opens us to violating the JMS spec for property type conversion, since it will now first convert all property types (except Double obviously) to a String and then on to a Double. Only Floats, Doubles, and Strings are allowed to be read back as a Double value, everything else should throw a MessageFormatException. I would suggest the change should be something more along the lines of:&lt;/p&gt;

&lt;p&gt;       if(o instanceof Double)&lt;/p&gt;
       {
           return ((Double)o).doubleValue();
       }
&lt;p&gt;+      else if(o instanceof String)&lt;br/&gt;
+      &lt;/p&gt;
{
+          return Double.valueOf((String) o);
+       }
&lt;p&gt;       else&lt;br/&gt;
       {&lt;br/&gt;
           try&lt;br/&gt;
           {&lt;br/&gt;
               return Double.valueOf(getFloatProperty(propertyName));&lt;/p&gt;

&lt;p&gt;In looking at this I have also come to notice that the 0-10 message property handling (do we really need to have seperate handler code for 0-8/9 and 0-10 for all of this?) seems to improperly convert String properties into short, int, and long by delegating the conversion down to the getByteProperty() method which then restricts it to using Byte.valueof(), which is rarely going to work correctly. Ive raised that as &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-2770&quot; title=&quot;AMQMessageDelegate_0_10 uses Byte.valueOf() when converting String properties to short, int, and long values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-2770&quot;&gt;&lt;del&gt;QPID-2770&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12893290" author="rajith" created="Wed, 28 Jul 2010 18:22:59 +0000"  >&lt;p&gt;Thanks for catching this, I have fixed it.&lt;/p&gt;</comment>
                            <comment id="12922313" author="rajith" created="Mon, 18 Oct 2010 22:08:17 +0000"  >&lt;p&gt;Fixed and reviewed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0bqlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66420</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>