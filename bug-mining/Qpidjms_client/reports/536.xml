<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:22:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-5931] [Java client]  JMSException instead of InvalidDestinationException raised when sending to temporary destination after session closure</title>
                <link>https://issues.apache.org/jira/browse/QPID-5931</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;An attempt to send to an auxiliary queue after the relevant session is closed should raise InvalidDestinationException. But  javax.jms.JMSException is raised instead.&lt;/p&gt;

&lt;p&gt;junit test for this follows:&lt;/p&gt;

&lt;p&gt;~~~&lt;br/&gt;
package org.apache.qpid.example;&lt;/p&gt;

&lt;p&gt;import static org.junit.Assert.assertEquals;&lt;br/&gt;
import static org.junit.Assert.assertNotNull;&lt;br/&gt;
import static org.junit.Assert.fail;&lt;/p&gt;

&lt;p&gt;import org.apache.qpid.client.AMQConnection;&lt;br/&gt;
import org.apache.qpid.client.AMQAnyDestination;&lt;/p&gt;

&lt;p&gt;import javax.jms.Connection;&lt;br/&gt;
import javax.jms.ConnectionFactory;&lt;br/&gt;
import javax.jms.Destination;&lt;br/&gt;
import javax.jms.InvalidDestinationException;&lt;br/&gt;
import javax.jms.JMSException;&lt;br/&gt;
import javax.jms.MessageConsumer;&lt;br/&gt;
import javax.jms.MessageProducer;&lt;br/&gt;
import javax.jms.Session;&lt;br/&gt;
import javax.jms.TemporaryQueue;&lt;br/&gt;
import javax.jms.TextMessage;&lt;/p&gt;

&lt;p&gt;import org.junit.After;&lt;br/&gt;
import org.junit.Before;&lt;br/&gt;
import org.junit.Test;&lt;/p&gt;

&lt;p&gt;public class InvalidDestinationTest &lt;br/&gt;
{&lt;br/&gt;
	private Destination destination;&lt;br/&gt;
	private ConnectionFactory conFac;&lt;br/&gt;
	private Connection publisherConnection;&lt;br/&gt;
	private Session publisherSession;&lt;br/&gt;
	private Connection consumerConnection;&lt;br/&gt;
	private Session consumerSession;&lt;br/&gt;
	private MessageProducer publisherMsgProducer;&lt;br/&gt;
	private MessageConsumer consumerMsgConsumer;&lt;br/&gt;
	private MessageProducer consumerMsgProducer;&lt;br/&gt;
	private TemporaryQueue replyToQueue;&lt;/p&gt;

&lt;p&gt;	public void setupQpid() throws Exception&lt;br/&gt;
	{&lt;br/&gt;
		destination = new AMQAnyDestination(&quot;demoQueue; &lt;/p&gt;
{create: always}
&lt;p&gt;&quot;);&lt;/p&gt;

&lt;p&gt;                String brokerlist = &quot;amqp://guest:guest@guest/test?brokerlist=&apos;tcp://localhost:5672&apos;&quot;;&lt;br/&gt;
		publisherConnection = new AMQConnection(brokerlist);&lt;br/&gt;
		publisherSession = publisherConnection.createSession(false, Session.CLIENT_ACKNOWLEDGE);&lt;/p&gt;

&lt;p&gt;		consumerConnection = new AMQConnection(brokerlist);;&lt;br/&gt;
		consumerSession = consumerConnection.createSession(false, Session.CLIENT_ACKNOWLEDGE);		&lt;br/&gt;
	}	&lt;/p&gt;

&lt;p&gt;	@Before&lt;br/&gt;
	public void before() throws Exception&lt;/p&gt;
	{
		setupQpid();
	}

&lt;p&gt;	@After&lt;br/&gt;
	public void after() throws Exception&lt;/p&gt;
	{
		consumerSession.close();
		consumerConnection.close();

		publisherSession.close();
		publisherConnection.close();
	}

&lt;p&gt;	@Test&lt;br/&gt;
	public void sendToTempQueueWhenItDoesNotExist() throws Exception&lt;br/&gt;
	{&lt;br/&gt;
		consumerMsgConsumer = consumerSession.createConsumer(destination);&lt;br/&gt;
		consumerConnection.start();&lt;br/&gt;
		publisherMsgProducer = publisherSession.createProducer(destination);&lt;br/&gt;
		replyToQueue = publisherSession.createTemporaryQueue();		&lt;br/&gt;
		publisherConnection.close();&lt;/p&gt;

&lt;p&gt;		TextMessage response = consumerSession.createTextMessage(&quot;&quot;);&lt;br/&gt;
		consumerMsgProducer = consumerSession.createProducer(replyToQueue);&lt;br/&gt;
		try&lt;/p&gt;
		{
			consumerMsgProducer.send(response);
		}
&lt;p&gt;		catch (InvalidDestinationException e)&lt;/p&gt;
		{	
			//expect to get this exception			
		}
&lt;p&gt;		catch (JMSException e)&lt;/p&gt;
		{
			e.printStackTrace();
			fail(&quot;Unexpected exception type&quot;);
		}
&lt;p&gt;	}	&lt;br/&gt;
}&lt;br/&gt;
~~~&lt;/p&gt;</description>
                <environment></environment>
        <key id="12730187">QPID-5931</key>
            <summary>[Java client]  JMSException instead of InvalidDestinationException raised when sending to temporary destination after session closure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pmoravec">Pavel Moravec</assignee>
                                    <reporter username="pmoravec">Pavel Moravec</reporter>
                        <labels>
                            <label>easyfix</label>
                            <label>easytest</label>
                            <label>patch</label>
                    </labels>
                <created>Mon, 28 Jul 2014 12:40:45 +0000</created>
                <updated>Mon, 28 Jul 2014 12:43:12 +0000</updated>
                            <resolved>Mon, 28 Jul 2014 12:43:05 +0000</resolved>
                                    <version>0.28</version>
                                    <fixVersion>0.29</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14076188" author="jira-bot" created="Mon, 28 Jul 2014 12:42:43 +0000"  >&lt;p&gt;Commit 1613984 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pmoravec&quot; class=&quot;user-hover&quot; rel=&quot;pmoravec&quot;&gt;pmoravec&lt;/a&gt; in branch &apos;qpid/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1613984&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1613984&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-5931&quot; title=&quot;[Java client]  JMSException instead of InvalidDestinationException raised when sending to temporary destination after session closure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-5931&quot;&gt;&lt;del&gt;QPID-5931&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java client&amp;#93;&lt;/span&gt; JMSException instead of InvalidDestinationException raised when sending to temporary destination after session closure&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y8zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408264</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>