<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-7535] [Java Client] Strengthen notification between threads holding dispatcher lock</title>
                <link>https://issues.apache.org/jira/browse/QPID-7535</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;If there is a thread trying to acquire the dispatcher lock whilst connection is being stopped, it might  be never notified if a dispatcher thread receives the notification.&lt;br/&gt;
I think the following scenario is susceptible for the issue:&lt;br/&gt;
1) Application is trying to recover the session in a special &quot;receiver thread&quot; which is blocked whilst trying to acquire the dispatcher lock in AMQSession#recover-&amp;gt;AMQSession$Dispatcher#recover. (The same applies to session rollback)&lt;br/&gt;
2) Dispatcher thread is trying to deliver another message and is waiting for the dispatcher lock in AMQSession$Dispatcher#dispatchMessage&lt;br/&gt;
3) Main thread in a call to Connection#stop  acquired the  dispatcher lock as part of AMQSession$Dispatcher#setConnectionStopped and invokes _lock.notify().&lt;br/&gt;
3.1) The dispatcher thread receives the notification, wakes up, checks that &quot;connection stopped&quot; flag is set to &quot;true&quot; and continue to wait. The &quot;receiver thread&quot; does not receive the notification in this case, as &quot;dispatcher thread&quot; does not broadcast &quot;notify&quot;. It looks like there is a possibility for &quot;a dead lock&quot; here.&lt;/p&gt;

&lt;p&gt;Replacing &quot;notify&quot; with &quot;notifyAll&quot; should avoid running into the scenario described above, as both &quot;dispatcher thread&quot; and &quot;receiver thread&quot; would be notified. Even if &quot;dispatcher thread&quot; is notified first, the &quot;receiver thread&quot; would resume its execution after releasing the lock by the &quot;dispatcher thread&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13022180">QPID-7535</key>
            <summary>[Java Client] Strengthen notification between threads holding dispatcher lock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orudyy">Alex Rudyy</assignee>
                                    <reporter username="orudyy">Alex Rudyy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Nov 2016 12:40:06 +0000</created>
                <updated>Wed, 2 Oct 2019 19:20:32 +0000</updated>
                            <resolved>Thu, 1 Dec 2016 19:01:16 +0000</resolved>
                                    <version>0.32</version>
                    <version>qpid-java-6.0</version>
                    <version>qpid-java-6.0.1</version>
                    <version>qpid-java-6.0.2</version>
                    <version>qpid-java-6.0.3</version>
                    <version>qpid-java-6.0.4</version>
                    <version>qpid-java-6.0.5</version>
                    <version>qpid-java-6.1</version>
                                    <fixVersion>qpid-java-6.1.1</fixVersion>
                    <fixVersion>qpid-java-client-0-x-6.3.0</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15683999" author="jira-bot" created="Mon, 21 Nov 2016 16:24:04 +0000"  >&lt;p&gt;Commit 1770716 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1770716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1770716&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7535&quot; title=&quot;[Java Client] Strengthen notification between threads holding dispatcher lock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7535&quot;&gt;&lt;del&gt;QPID-7535&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Strengthen notification between threads holding dispatcher lock&lt;/p&gt;</comment>
                            <comment id="15690718" author="k-wall" created="Wed, 23 Nov 2016 17:00:46 +0000"  >&lt;p&gt;Change looks reasonable.&lt;/p&gt;</comment>
                            <comment id="15695795" author="alex.rufous" created="Fri, 25 Nov 2016 12:51:24 +0000"  >&lt;p&gt;I think it is worth porting this change into 6.1.x for inclusion into 6.1.1 version of Qpid Client&lt;/p&gt;</comment>
                            <comment id="15695799" author="alex.rufous" created="Fri, 25 Nov 2016 12:52:05 +0000"  >&lt;p&gt;JIRA is re-opened to include changes into 6.1.x&lt;/p&gt;</comment>
                            <comment id="15712756" author="jira-bot" created="Thu, 1 Dec 2016 19:00:10 +0000"  >&lt;p&gt;Commit 1772250 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/branches/6.1.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1772250&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1772250&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7535&quot; title=&quot;[Java Client] Strengthen notification between threads holding dispatcher lock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7535&quot;&gt;&lt;del&gt;QPID-7535&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Strengthen notification between threads holding dispatcher lock&lt;/p&gt;

&lt;p&gt;Merged from trunk with commandL&lt;/p&gt;


&lt;p&gt;svn merge -c 1770716 &lt;a href=&quot;https://svn.apache.org/repos/asf/qpid/java/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/qpid/java/trunk&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36ktb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>