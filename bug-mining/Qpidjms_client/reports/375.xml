<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:21:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-3207] AMQSession.java close() does not close the consumers with the correct arguments</title>
                <link>https://issues.apache.org/jira/browse/QPID-3207</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;When the AMQSession.java close() is invoked it will in turn call the &quot;private void closeConsumers(Throwable error) throws JMSException&quot;  method.&lt;br/&gt;
In this method if the error is null then the consumer.close method is called with &quot;sendClose=false&quot;.&lt;/p&gt;

&lt;p&gt;I wonder if this is the correct setting. I suspect the intended value is &quot;true&quot;.&lt;br/&gt;
The boolean value is used in determining if we should send a message-cancel or not.&lt;br/&gt;
I am not sure why we are not going to send a message cancel in this case, as we haven&apos;t encountered a session error and the session is active.&lt;br/&gt;
Note the AMQSession.java closes the session only after the consumers and producers are closed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12504312">QPID-3207</key>
            <summary>AMQSession.java close() does not close the consumers with the correct arguments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rajith">Rajith Muditha Attapattu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Apr 2011 20:42:38 +0000</created>
                <updated>Tue, 10 Feb 2015 09:53:00 +0000</updated>
                            <resolved>Tue, 10 Feb 2015 09:53:00 +0000</resolved>
                                    <version>0.10</version>
                                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13020028" author="rajith" created="Thu, 14 Apr 2011 20:53:11 +0000"  >&lt;p&gt;I have raised this issue on the qpid dev list and it seems nobody knows the reasons behind the original code.&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/qpid-dev/201104.mbox/%3CBANLkTinSwxvuL2vsobSwq2iz3HL8xtKKLg@mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/qpid-dev/201104.mbox/%3CBANLkTinSwxvuL2vsobSwq2iz3HL8xtKKLg@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have changed the value of sendClose to &quot;true&quot; and so far the tests seems ok.&lt;br/&gt;
I am going to check in this change as it seems this is the right way to go.&lt;/p&gt;</comment>
                            <comment id="13025889" author="rajith" created="Wed, 27 Apr 2011 16:51:40 +0000"  >&lt;p&gt;Currently this commit has triggered a deadlock.&lt;br/&gt;
See &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3216&quot; title=&quot;Deadlock between &amp;quot;_lock&amp;quot; (in AMQSession#DisptcherThread) and &amp;quot;_messageDeliveryLock&amp;quot; (in AMQSession.java)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3216&quot;&gt;&lt;del&gt;QPID-3216&lt;/del&gt;&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="13031656" author="gemmellr" created="Wed, 11 May 2011 11:46:43 +0000"  >&lt;p&gt;This also appears to have caused a couple of test failures on the default java profile.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/hudson/view/M-R/view/Qpid/job/qpid-java-build/94/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/view/M-R/view/Qpid/job/qpid-java-build/94/testReport/&lt;/a&gt; shows that the following 2 tests are failing.&lt;br/&gt;
org.apache.qpid.test.client.RollbackOrderTest.testOrderingAfterRollbackOnMessage &lt;br/&gt;
org.apache.qpid.test.unit.client.AMQConnectionTest.testPrefetchSystemProperty &lt;/p&gt;

&lt;p&gt;Clicking the age report leads to the following build, which only incorporated the change from this JIRA: &lt;a href=&quot;https://builds.apache.org/hudson/view/M-R/view/Qpid/job/qpid-java-build/48/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/view/M-R/view/Qpid/job/qpid-java-build/48/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;One of the failures was also raised as &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3229&quot; title=&quot;Test AMQConnectionTest#testPrefetchSystemProperty is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3229&quot;&gt;&lt;del&gt;QPID-3229&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13031661" author="k-wall" created="Wed, 11 May 2011 12:05:15 +0000"  >&lt;p&gt;In addition to the failures on the default profile Robbie has noted above, it appears that this commit has broken the following test on the &lt;b&gt;java.0.10&lt;/b&gt; profile:&lt;/p&gt;

&lt;p&gt;org.apache.qpid.test.client.destination.AddressBasedDestinationTest.testReliabilityOptions&lt;/p&gt;

&lt;p&gt;Testcase: testReliabilityOptions took 2.131 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
expected:&amp;lt;2&amp;gt; but was:&amp;lt;0&amp;gt;&lt;br/&gt;
junit.framework.AssertionFailedError: expected:&amp;lt;2&amp;gt; but was:&amp;lt;0&amp;gt;&lt;br/&gt;
        at org.apache.qpid.test.client.destination.AddressBasedDestinationTest.acceptModeTest(AddressBasedDestinationTest.java:978)&lt;br/&gt;
        at org.apache.qpid.test.client.destination.AddressBasedDestinationTest.testReliabilityOptions(AddressBasedDestinationTest.java:920)&lt;br/&gt;
        at org.apache.qpid.test.utils.QpidBrokerTestCase.runBare(QpidBrokerTestCase.java:234)&lt;br/&gt;
        at org.apache.qpid.test.utils.QpidTestCase.run(QpidTestCase.java:120)&lt;/p&gt;

</comment>
                            <comment id="13031663" author="rajith" created="Wed, 11 May 2011 12:27:15 +0000"  >&lt;p&gt;I think the best option is to rollback this change until we fix the deadlock.&lt;br/&gt;
That will allow us to get the builds back on track.&lt;br/&gt;
Meanwhile I will investigate the test failures to see if there is anything else affecting them other than the deadlock issue.&lt;/p&gt;</comment>
                            <comment id="13031669" author="rajith" created="Wed, 11 May 2011 12:46:23 +0000"  >&lt;p&gt;I have reversed the commit, all though we need to restore it at some point once we get through this deadlock issue.&lt;br/&gt;
IMO the original commit is the correct behaviour, so it would be interesting to see what other issues have popped up in addition to the deadlock problem.&lt;/p&gt;</comment>
                            <comment id="13211515" author="gemmellr" created="Sun, 19 Feb 2012 19:51:56 +0000"  >&lt;p&gt;Linking to JIRA with now-reverted change suspected to be the cause.&lt;/p&gt;</comment>
                            <comment id="13211516" author="gemmellr" created="Sun, 19 Feb 2012 19:52:17 +0000"  >&lt;p&gt;Updating with an unreleased version as fix-for.&lt;/p&gt;</comment>
                            <comment id="14312891" author="rgodfrey" created="Mon, 9 Feb 2015 21:15:27 +0000"  >&lt;p&gt;There&apos;s no reason why we would need to send explicit closes for the consumers, it should be enough on the server side to receive the session close, and obviously issues occur if this the proposed code change is made.&lt;/p&gt;

&lt;p&gt;Given there has been no work done on this JIRA for almost 4 years, I propose we close this JIRA as a &quot;not an issue&quot;&lt;/p&gt;</comment>
                            <comment id="14313923" author="gemmellr" created="Tue, 10 Feb 2015 09:52:16 +0000"  >&lt;p&gt;Agreed, resolving.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12504669">QPID-3216</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12505331">QPID-3229</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169824</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0bi67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>