<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:22:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-4274] second invocation of createConsumer fails for queue in JNDI properties</title>
                <link>https://issues.apache.org/jira/browse/QPID-4274</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;Description of problem:&lt;br/&gt;
Creating in a loop a connection, session and consumer defined in JNDI property file, 2nd instance of the loop raises &quot;Queue not found&quot; exception.&lt;/p&gt;


&lt;p&gt;Version-Release number of selected component (if applicable):&lt;br/&gt;
qpid-java-*-0.14-3&lt;/p&gt;


&lt;p&gt;How reproducible:&lt;br/&gt;
100%&lt;/p&gt;


&lt;p&gt;Steps to Reproduce:&lt;br/&gt;
See reproducer.&lt;/p&gt;


&lt;p&gt;Actual results:&lt;br/&gt;
(stack trace from Java client 0.14)&lt;br/&gt;
ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;IoReceiver - localhost/127.0.0.1:5672&amp;#93;&lt;/span&gt; (AMQConnection.java:1267) - Throwable Received but no listener set: org.apache.qpid.AMQException: ch=0 id=0 ExecutionException(errorCode=NOT_FOUND, commandId=0, classCode=4, commandCode=7, fieldIndex=0, description=not-found: Queue not found: response-queue (qpid/broker/SessionAdapter.cpp:686), errorInfo={}) &lt;span class=&quot;error&quot;&gt;&amp;#91;error code 404: not found&amp;#93;&lt;/span&gt;&lt;br/&gt;
ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; (AMQConnection.java:1267) - Throwable Received but no listener set: org.apache.qpid.AMQException: ch=0 id=0 ExecutionException(errorCode=NOT_FOUND, commandId=0, classCode=4, commandCode=7, fieldIndex=0, description=not-found: Queue not found: response-queue (qpid/broker/SessionAdapter.cpp:686), errorInfo={}) &lt;span class=&quot;error&quot;&gt;&amp;#91;error code 404: not found&amp;#93;&lt;/span&gt;&lt;br/&gt;
javax.jms.JMSException: Error registering consumer: org.apache.qpid.AMQException: ch=0 id=0 ExecutionException(errorCode=NOT_FOUND, commandId=0, classCode=4, commandCode=7, fieldIndex=0, description=not-found: Queue not found: response-queue (qpid/broker/SessionAdapter.cpp:686), errorInfo={}) &lt;span class=&quot;error&quot;&gt;&amp;#91;error code 404: not found&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2105)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2040)&lt;br/&gt;
	at org.apache.qpid.client.AMQConnectionDelegate_0_10.executeRetrySupport(AMQConnectionDelegate_0_10.java:369)&lt;br/&gt;
	at org.apache.qpid.client.AMQConnection.executeRetrySupport(AMQConnection.java:586)&lt;br/&gt;
	at org.apache.qpid.client.failover.FailoverRetrySupport.execute(FailoverRetrySupport.java:102)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createConsumerImpl(AMQSession.java:2038)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createConsumer(AMQSession.java:996)&lt;br/&gt;
	at Test_00689136.&amp;lt;init&amp;gt;(Test_00689136.java:71)&lt;br/&gt;
	at Test_00689136.main(Test_00689136.java:46)&lt;br/&gt;
Caused by: org.apache.qpid.AMQException: ch=0 id=0 ExecutionException(errorCode=NOT_FOUND, commandId=0, classCode=4, commandCode=7, fieldIndex=0, description=not-found: Queue not found: response-queue (qpid/broker/SessionAdapter.cpp:686), errorInfo={}) &lt;span class=&quot;error&quot;&gt;&amp;#91;error code 404: not found&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.qpid.client.AMQSession_0_10.setCurrentException(AMQSession_0_10.java:1102)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession_0_10.sync(AMQSession_0_10.java:1082)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession_0_10.sendConsume(AMQSession_0_10.java:686)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession_0_10.sendConsume(AMQSession_0_10.java:87)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.consumeFromQueue(AMQSession.java:2626)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.registerConsumer(AMQSession.java:2962)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.access$500(AMQSession.java:120)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2082)&lt;br/&gt;
	... 8 more&lt;/p&gt;

&lt;p&gt;Expected results:&lt;br/&gt;
No exception raised.&lt;/p&gt;

&lt;p&gt;Additional info:&lt;br/&gt;
trivial patch to be uploaded&lt;/p&gt;</description>
                <environment></environment>
        <key id="12605675">QPID-4274</key>
            <summary>second invocation of createConsumer fails for queue in JNDI properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajith">Rajith Muditha Attapattu</assignee>
                                    <reporter username="pmoravec">Pavel Moravec</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Fri, 31 Aug 2012 11:26:00 +0000</created>
                <updated>Tue, 14 Mar 2017 20:07:05 +0000</updated>
                            <resolved>Thu, 7 Mar 2013 22:34:21 +0000</resolved>
                                    <version>0.14</version>
                    <version>0.18</version>
                                    <fixVersion>0.21</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="13445845" author="pmoravec" created="Fri, 31 Aug 2012 11:27:04 +0000"  >&lt;p&gt;Reproducer&lt;/p&gt;</comment>
                            <comment id="13445846" author="pmoravec" created="Fri, 31 Aug 2012 11:28:15 +0000"  >&lt;p&gt;Simple patch proposal.&lt;/p&gt;

&lt;p&gt;calling&lt;/p&gt;

&lt;p&gt;Context ctx = new InitialContext(properties);&lt;/p&gt;

&lt;p&gt;just once causes Destination object to be created just once. First invocation of:&lt;/p&gt;

&lt;p&gt;MessageConsumer clientConsumer = session.createConsumer(destination/queue)&lt;/p&gt;

&lt;p&gt;then sets address resolution to current timestamp to prevent resolving the address later on (see handleAddressBasedDestination in AMQSession_0_10 class for details).&lt;/p&gt;

&lt;p&gt;Next invocation of createConsumer sees the destination has address already resolved, what is wrong.&lt;/p&gt;

&lt;p&gt;To correct it, once the queue is deleted (when closing the consumer), address resolution of the destination has to be re-set to 0.&lt;/p&gt;</comment>
                            <comment id="13596486" author="rajith" created="Thu, 7 Mar 2013 22:34:07 +0000"  >&lt;p&gt;Applied Pavel&apos;s patch but in a different location (where node deletion is handled) as the Queue can be deleted by Producer not just a Consumer and will cause the same issue.&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1454134&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1454134&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also applied the same fix for exchanges as a deletion triggered by a consumer/producer close can cause the same issue if the same destination is re-used to create another producer or consumer.&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1454135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1454135&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12543254" name="0001-consumerClose-to-reset-destination-AddressResolved.patch" size="756" author="pmoravec" created="Fri, 31 Aug 2012 11:28:15 +0000"/>
                            <attachment id="12543253" name="test_00689136.java" size="2294" author="pmoravec" created="Fri, 31 Aug 2012 11:27:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>251448</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0bekn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>64473</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>