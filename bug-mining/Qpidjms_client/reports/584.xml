<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:22:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-6664] Connection#close may hang awaiting failover to exhaust retries</title>
                <link>https://issues.apache.org/jira/browse/QPID-6664</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt; A client&apos;s call to Connection#close may hang awaiting failover to exhaust its retry count.  This occurs because the failover thread has acquired the failover mutex, and closing sessions requires the same mutex. &lt;/p&gt;

&lt;p&gt;If the connection has no Sessions, instead the Connection#close will complete, but the failover thread will continue to spin in the background.  &lt;/p&gt;

&lt;p&gt;The following could be done to fix the issue:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;AMQConnection#attemptReconnection while expression needs to include !isClosed().&lt;/li&gt;
	&lt;li&gt;AMQConnection#close() needs to acquire the failover mutex &lt;b&gt;after&lt;/b&gt; its call to doClose(sessions, timeout) to ensure that, in the case of a connection without sessions, the thread performing failover will have finished its work (i.e. for 0-8 the FailoverThread will be ending) before #close returns to the caller.&lt;/li&gt;
	&lt;li&gt;#AMQConnection#exceptionReceived needs to lose responsibility for mutating closed/closing.  This responsibility needs to be pushed to its callers.  0-10 already does this, this change will make 0-8 the same.  This will mean that _closed means the user has closed the connections, or the Broker has closed the connection and failover has given up.&lt;/li&gt;
	&lt;li&gt;Remove Closable#resetClosedFlag&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="12849662">QPID-6664</key>
            <summary>Connection#close may hang awaiting failover to exhaust retries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orudyy">Alex Rudyy</assignee>
                                    <reporter username="orudyy">Alex Rudyy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jul 2015 16:30:04 +0000</created>
                <updated>Wed, 2 Oct 2019 19:22:06 +0000</updated>
                            <resolved>Tue, 4 Aug 2015 15:48:00 +0000</resolved>
                                    <version>0.8</version>
                    <version>0.10</version>
                    <version>0.12</version>
                    <version>0.14</version>
                    <version>0.16</version>
                    <version>0.18</version>
                    <version>0.20</version>
                    <version>0.22</version>
                    <version>0.24</version>
                    <version>0.26</version>
                    <version>0.28</version>
                    <version>0.30</version>
                    <version>0.32</version>
                                    <fixVersion>qpid-java-6.0</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14653829" author="jira-bot" created="Tue, 4 Aug 2015 15:46:32 +0000"  >&lt;p&gt;Commit 1694080 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694080&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694080&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6664&quot; title=&quot;Connection#close may hang awaiting failover to exhaust retries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6664&quot;&gt;&lt;del&gt;QPID-6664&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Stop failover when Connection#close() is called&lt;/p&gt;</comment>
                            <comment id="14660139" author="jira-bot" created="Thu, 6 Aug 2015 15:06:16 +0000"  >&lt;p&gt;Commit 1694516 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694516&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694516&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6664&quot; title=&quot;Connection#close may hang awaiting failover to exhaust retries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6664&quot;&gt;&lt;del&gt;QPID-6664&lt;/del&gt;&lt;/a&gt;: Move FailoverHandler into parent package in order to get access to AMQConnection package protected methods&lt;/p&gt;</comment>
                            <comment id="14660140" author="jira-bot" created="Thu, 6 Aug 2015 15:06:33 +0000"  >&lt;p&gt;Commit 1694517 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694517&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694517&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6664&quot; title=&quot;Connection#close may hang awaiting failover to exhaust retries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6664&quot;&gt;&lt;del&gt;QPID-6664&lt;/del&gt;&lt;/a&gt;: Change indentention in FailoverHandler&lt;/p&gt;</comment>
                            <comment id="14661807" author="jira-bot" created="Fri, 7 Aug 2015 13:03:27 +0000"  >&lt;p&gt;Commit 1694679 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694679&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694679&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6664&quot; title=&quot;Connection#close may hang awaiting failover to exhaust retries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6664&quot;&gt;&lt;del&gt;QPID-6664&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Remove dead redirection code from the 0-8..0-91 failover handler&lt;/p&gt;</comment>
                            <comment id="14661810" author="k-wall" created="Fri, 7 Aug 2015 13:06:53 +0000"  >&lt;p&gt;Changes look reasonable to me.  I removed the dead code in r1694679 (left by &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6424&quot; title=&quot;[Java Broker] [Java Client] Implement Connection.Redirect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6424&quot;&gt;&lt;del&gt;QPID-6424&lt;/del&gt;&lt;/a&gt;) &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i0yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>