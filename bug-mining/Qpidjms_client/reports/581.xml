<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:22:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-6547] [Java Client] Client should not attempt to make explicit bindings against the default exchange</title>
                <link>https://issues.apache.org/jira/browse/QPID-6547</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;With a default address mode of BURL, an address string like &quot;/a/b/c/d&quot; is treated as if it is an attempt to bind an address to the default (no-name) exchange.  &lt;/p&gt;

&lt;p&gt;Attempting to parse such addresses as BURLs should fail.  The client should stop any attempt to create explicit bindings to the default exchange.  Attempts to use the default exchange for topics are probably dubious and should maybe generate a warning.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12830995">QPID-6547</key>
            <summary>[Java Client] Client should not attempt to make explicit bindings against the default exchange</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orudyy">Alex Rudyy</assignee>
                                    <reporter username="rgodfrey">Robert Godfrey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 May 2015 12:14:41 +0000</created>
                <updated>Wed, 2 Oct 2019 19:21:50 +0000</updated>
                            <resolved>Mon, 22 Jun 2015 15:15:22 +0000</resolved>
                                                    <fixVersion>qpid-java-6.0</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14584997" author="k-wall" created="Sun, 14 Jun 2015 09:05:47 +0000"  >&lt;p&gt;I think changes made by &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-4897&quot; title=&quot;[Java Broker] Allow selectors on bindings for exchanges other than topic exchanges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-4897&quot;&gt;&lt;del&gt;QPID-4897&lt;/del&gt;&lt;/a&gt; to AMQSession#registerConsumer mean that the client, in its default configuration (qpid.declare_queues true), won&apos;t attempt to make the binding to the default exchange, because the queue would have just been created and therefore the org.apache.qpid.client.AMQSession#isBound will return true and it won&apos;t go on to call org.apache.qpid.client.AMQSession#bindQueue().  I suspect that the user may have been using an old client (perhaps circa 0.18).&lt;/p&gt;

&lt;p&gt;To avoid the problem if the case where qpid.declare_queues is overridden to be false, the expression at AMQSesion.java:220 should ensure that the exchange in question is not the default (anonymous) exchange.&lt;/p&gt;

&lt;p&gt;Now turning to the second part of this JIRA.  The current BURL parsing implementation accepts addresses of the form &apos;/a/b/c/d&apos; which is taken to mean a queue with name &apos;/a/b/c/d&apos;, a routing key &apos;/a/b/c/d&apos; and  binding between the default exchange with the binding key &apos;/a/b/c/d&apos;.  The parser accepts these owing to the alternate paths through BindingURLParser#extractExchangeClass.  This functionality seems to be longstanding and goes back at least until &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-814&quot; title=&quot;The BindingURL parser cannot handle special characters or multiple options with the same key.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-814&quot;&gt;&lt;del&gt;QPID-814&lt;/del&gt;&lt;/a&gt; (M4) and seems to have been added in order to support the parsing of queue names such as IBMPerfQueue1?durable=&apos;true&apos;.&lt;/p&gt;

&lt;p&gt;I think we should change the BURL parser to reject such address by removing the two alternate paths in BindingURLParser#extractExchangeClass and strengthening the parser to insist that the URL includes it hierarchy prefix (i.e. //).   This change would be breaking for users who have JNDI declarations such as destination.queue = BURL:/a/b/c/d or  destination.queue = BURL:IBMPerfQueue1.  It would be no change the behaviour for users using Session#createQueue(&quot;IBMPerfQueue1&quot;), as this would continue to give an queue bound to amq.direct.  These changes would not affect ADDRs.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="14585072" author="rgodfrey" created="Sun, 14 Jun 2015 13:54:48 +0000"  >&lt;p&gt;The above seems reasonable, but I think we should also guard against cases where the address implies a request to bind to the default exchange.  For instance the following code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Queue destination = session.createQueue(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:&lt;span class=&quot;code-comment&quot;&gt;////foo/bar/baz?routingkey=&lt;span class=&quot;code-quote&quot;&gt;&apos;/foo/bar/baz&apos;&lt;/span&gt;&quot;&lt;/span&gt;);
&lt;/span&gt;        MessageConsumer consumer = session.createConsumer(destination);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will cause the following exception&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; javax.jms.JMSException: Error registering consumer: org.apache.qpid.client.AMQAuthenticationException: Cannot bind the queue &apos;foo/bar/baz&apos; to the default exchange [error code 530: not allowed]
	at org.apache.qpid.client.AMQSession.toJMSException(AMQSession.java:3645)
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2083)
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2037)
	at org.apache.qpid.client.AMQConnectionDelegate_8_0.executeRetrySupport(AMQConnectionDelegate_8_0.java:413)
	at org.apache.qpid.client.AMQConnection.executeRetrySupport(AMQConnection.java:733)
	at org.apache.qpid.client.failover.FailoverRetrySupport.execute(FailoverRetrySupport.java:90)
	at org.apache.qpid.client.AMQSession.createConsumerImpl(AMQSession.java:2035)
	at org.apache.qpid.client.AMQSession.createConsumer(AMQSession.java:980)
	at org.apache.qpid.AMQPManagementTest.main(AMQPManagementTest.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:140)
Caused by: org.apache.qpid.client.AMQAuthenticationException: Cannot bind the queue &apos;foo/bar/baz&apos; to the default exchange [error code 530: not allowed]
	at org.apache.qpid.client.handler.ConnectionCloseMethodHandler.methodReceived(ConnectionCloseMethodHandler.java:78)
	at org.apache.qpid.client.handler.ClientMethodDispatcherImpl.dispatchConnectionClose(ClientMethodDispatcherImpl.java:227)
	at org.apache.qpid.framing.ConnectionCloseBody.execute(ConnectionCloseBody.java:116)
	at org.apache.qpid.client.state.AMQStateManager.methodReceived(AMQStateManager.java:116)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;Similarly the following address should detected as erroneous client side, before attempting to redefine the default exchange&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Topic destination = session.createTopic(&lt;span class=&quot;code-quote&quot;&gt;&quot;topic:&lt;span class=&quot;code-comment&quot;&gt;////foo/bar/baz&quot;&lt;/span&gt;);
&lt;/span&gt;        MessageConsumer consumer = session.createConsumer(destination);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which gives&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; javax.jms.JMSException: Error registering consumer: org.apache.qpid.client.AMQAuthenticationException: Attempt to redeclare default exchange:  of type direct to topic. [error code 530: not allowed]
	at org.apache.qpid.client.AMQSession.toJMSException(AMQSession.java:3645)
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2083)
	at org.apache.qpid.client.AMQSession$4.execute(AMQSession.java:2037)
	at org.apache.qpid.client.AMQConnectionDelegate_8_0.executeRetrySupport(AMQConnectionDelegate_8_0.java:413)
	at org.apache.qpid.client.AMQConnection.executeRetrySupport(AMQConnection.java:733)
	at org.apache.qpid.client.failover.FailoverRetrySupport.execute(FailoverRetrySupport.java:90)
	at org.apache.qpid.client.AMQSession.createConsumerImpl(AMQSession.java:2035)
	at org.apache.qpid.client.AMQSession.createConsumer(AMQSession.java:980)
	at org.apache.qpid.AMQPManagementTest.main(AMQPManagementTest.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:140)
Caused by: org.apache.qpid.client.AMQAuthenticationException: Attempt to redeclare default exchange:  of type direct to topic. [error code 530: not allowed]
	at org.apache.qpid.client.handler.ConnectionCloseMethodHandler.methodReceived(ConnectionCloseMethodHandler.java:78)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14595227" author="jira-bot" created="Sun, 21 Jun 2015 22:27:02 +0000"  >&lt;p&gt;Commit 1686757 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1686757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1686757&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6547&quot; title=&quot;[Java Client] Client should not attempt to make explicit bindings against the default exchange&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6547&quot;&gt;&lt;del&gt;QPID-6547&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client 0-8..0-10&amp;#93;&lt;/span&gt;  Prevent client from attempting to make bindings to default exchange (when BURL addresses are in use)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Also prevent the creation of BURL addresses that try to redefine the class of the default exchange&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14596061" author="alex.rufous" created="Mon, 22 Jun 2015 15:15:22 +0000"  >&lt;p&gt;The changes look reasonable to me&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12838079">QPID-6593</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ex9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>