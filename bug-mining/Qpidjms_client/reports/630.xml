<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-7692] [Java Broker, 0-8..0-91]  Message sent to fanout exchange with no routing key is not delivered to application</title>
                <link>https://issues.apache.org/jira/browse/QPID-7692</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;If I publish a message to the fanout exchange with no routing key, then receive the same message, the client logs an error and the application fails to receive the message both otherwise continues.  The problem only occurs on the 0-8..0-91 code path and then only if the client is in BURL default address syntax.&lt;/p&gt;

&lt;p&gt;Example publish address that causes the problem:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;destination.pub = ADDR: myfanout; {create :always, node: {type: topic, x-declare: { type: fanout}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem does not occur if a subject is used e.g. myfanout/myfanout; ... or if the address does not include the &lt;em&gt;options&lt;/em&gt; part.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;12:37:40.195 [Dispatcher-2-Conn-2] ERROR o.a.qpid.client.BasicMessageConsumer - Caught exception (dump follows) - ignoring...
java.lang.IllegalArgumentException: routing/binding key  must not be null
	at org.apache.qpid.client.AMQDestination.&amp;lt;init&amp;gt;(AMQDestination.java:379) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQDestination.&amp;lt;init&amp;gt;(AMQDestination.java:369) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQDestination.&amp;lt;init&amp;gt;(AMQDestination.java:363) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQTopic.&amp;lt;init&amp;gt;(AMQTopic.java:66) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession_0_8$TopicDestinationCache.newDestination(AMQSession_0_8.java:1528) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession_0_8$TopicDestinationCache.newDestination(AMQSession_0_8.java:1524) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession_0_8$DestinationCache.getDestination(AMQSession_0_8.java:1515) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.message.AMQMessageDelegate_0_8.&amp;lt;init&amp;gt;(AMQMessageDelegate_0_8.java:127) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.message.AbstractJMSMessageFactory.create08MessageWithBody(AbstractJMSMessageFactory.java:122) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.message.AbstractJMSMessageFactory.createMessage(AbstractJMSMessageFactory.java:188) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.message.MessageFactoryRegistry.createMessage(MessageFactoryRegistry.java:126) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.BasicMessageConsumer_0_8.createJMSMessageFromUnprocessedMessage(BasicMessageConsumer_0_8.java:156) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.BasicMessageConsumer_0_8.createJMSMessageFromUnprocessedMessage(BasicMessageConsumer_0_8.java:47) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.BasicMessageConsumer.notifyMessage(BasicMessageConsumer.java:726) ~[qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession$Dispatcher.notifyConsumer(AMQSession.java:3662) [qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession$Dispatcher.dispatchMessage(AMQSession.java:3594) [qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession$Dispatcher.access$1300(AMQSession.java:3362) [qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession.dispatch(AMQSession.java:3355) [qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.message.UnprocessedMessage.dispatch(UnprocessedMessage.java:54) [qpid-client-6.1.1.jar:6.1.1]
	at org.apache.qpid.client.AMQSession$Dispatcher.run(AMQSession.java:3504) [qpid-client-6.1.1.jar:6.1.1]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13048512">QPID-7692</key>
            <summary>[Java Broker, 0-8..0-91]  Message sent to fanout exchange with no routing key is not delivered to application</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kwall">Keith Wall</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Mar 2017 12:56:41 +0000</created>
                <updated>Wed, 2 Oct 2019 19:20:36 +0000</updated>
                            <resolved>Wed, 15 Mar 2017 14:11:58 +0000</resolved>
                                                    <fixVersion>qpid-java-6.1.2</fixVersion>
                    <fixVersion>qpid-java-client-0-x-6.3.0</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15897238" author="k-wall" created="Mon, 6 Mar 2017 13:06:56 +0000"  >&lt;p&gt;The problem occurs because, on receipt, the message carries JMS_QPID_DESTTYPE = 2  which signifies topic.  This causes the client to assume that the exchange&apos;s class is topic. AMQTopic&apos;s constructor enforces that a routing key is present.   To fix, the client needs to be able to determine the class of the exchange so it can create a less stringent address object. &lt;/p&gt;</comment>
                            <comment id="15897253" author="rgodfrey" created="Mon, 6 Mar 2017 13:19:43 +0000"  >&lt;p&gt;Why does AMQTopic&apos;s constructor enforce that a routing key is present?  An empty-string routing key would still be valid in AMQP terms, would it not?&lt;/p&gt;</comment>
                            <comment id="15897363" author="k-wall" created="Mon, 6 Mar 2017 14:07:01 +0000"  >&lt;p&gt;It is actually org/apache/qpid/client/AMQDestination.java:375 that enforces &quot;routing/binding key  must not be null&quot;, AMQTopic mentioned above was incorrect.  We&apos;ve had logic like this in the code base since at least 2009.  I am finding it hard to justify the restriction.  The specs don&apos;t disallow a null routing key / destination (basic.publish/basic.deliver/basic.return/message.transfer).&lt;/p&gt;

&lt;p&gt;I think this bug may also bite in use-cases exploiting message conversion from AMQP 1.0.&lt;/p&gt;</comment>
                            <comment id="15901433" author="jira-bot" created="Wed, 8 Mar 2017 15:31:39 +0000"  >&lt;p&gt;Commit 1785988 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1785988&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1785988&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7692&quot; title=&quot;[Java Broker, 0-8..0-91]  Message sent to fanout exchange with no routing key is not delivered to application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7692&quot;&gt;&lt;del&gt;QPID-7692&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Broker&amp;#93;&lt;/span&gt; Add system test that demonstrates the defect.  Temporarily excluded on the 0-9 path.&lt;/p&gt;</comment>
                            <comment id="15901438" author="jira-bot" created="Wed, 8 Mar 2017 15:36:51 +0000"  >&lt;p&gt;Commit 1785989 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;x/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1785989&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1785989&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7692&quot; title=&quot;[Java Broker, 0-8..0-91]  Message sent to fanout exchange with no routing key is not delivered to application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7692&quot;&gt;&lt;del&gt;QPID-7692&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Allow routingKey/subject to be null in addresses&lt;/p&gt;</comment>
                            <comment id="15901448" author="k-wall" created="Wed, 8 Mar 2017 15:41:41 +0000"  >&lt;p&gt;The client Destination classes have ben relaxed to allow a &lt;tt&gt;routingKey&lt;/tt&gt; to be null.  Most of the code already seemed to be null safe as null routing keys were already tolerated on some paths.  This change allows them on other paths too.  A system test is added to the Broker that demonstrates the issue.  The test is excluded on the failing path.  This exclusion can be removed once 6.1.2 is released and the Broker&apos;s  parent POM updated to use it.&lt;/p&gt;
</comment>
                            <comment id="15926231" author="alex.rufous" created="Wed, 15 Mar 2017 14:11:58 +0000"  >&lt;p&gt;The changes look reasonable to me. We need to merge them into 6.1.x&lt;/p&gt;</comment>
                            <comment id="15926278" author="jira-bot" created="Wed, 15 Mar 2017 14:42:22 +0000"  >&lt;p&gt;Commit 1787056 from orudyy@apache.org in branch &apos;java/branches/6.1.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1787056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1787056&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7692&quot; title=&quot;[Java Broker, 0-8..0-91]  Message sent to fanout exchange with no routing key is not delivered to application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7692&quot;&gt;&lt;del&gt;QPID-7692&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client&amp;#93;&lt;/span&gt; Allow routingKey/subject to be null in addresses&lt;/p&gt;

&lt;p&gt;merged changes from client trunk using&lt;br/&gt;
svn merge -c 1785989  ^/qpid/qpid-jms-amqp-0-x/trunk&lt;br/&gt;
merged tests from broker trunk using&lt;br/&gt;
svn merge -c 1785988 ^/qpid/java/trunk&lt;/p&gt;</comment>
                            <comment id="15938797" author="alex.rufous" created="Thu, 23 Mar 2017 17:14:54 +0000"  >&lt;p&gt;Closing JIRA for version qpid-java-6.1.2 as it was released&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3aztb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>