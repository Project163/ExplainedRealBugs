<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:20:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-1084] [Java Client] Race condition suspending channel in no-ack flow control situations</title>
                <link>https://issues.apache.org/jira/browse/QPID-1084</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;When operating in no-ack mode the 0-8/0-9 client session uses a FlowControllingBlockingQueue with a threshold listener to attempt to flow control the channel when too many messages build up.&lt;/p&gt;

&lt;p&gt;This code has a built in race condition:&lt;/p&gt;

&lt;p&gt;new FlowControllingBlockingQueue.ThresholdListener()&lt;br/&gt;
                                                     {&lt;br/&gt;
                                                         public void aboveThreshold(int currentValue)&lt;/p&gt;
                                                         {
                                                                 _logger.debug(
                                                                         &quot;Above threshold(&quot; + _defaultPrefetchHighMark
                                                                         + &quot;) so suspending channel. Current value is &quot; + currentValue);
                                                                 new Thread(new SuspenderRunner(true)).start();

                                                         }

&lt;p&gt;                                                         public void underThreshold(int currentValue)&lt;/p&gt;
                                                         {
                                                                 _logger.debug(
                                                                         &quot;Below threshold(&quot; + _defaultPrefetchLowMark
                                                                         + &quot;) so unsuspending channel. Current value is &quot; + currentValue);
                                                                 new Thread(new SuspenderRunner(false)).start();

                                                         }
&lt;p&gt;                                                     });&lt;/p&gt;

&lt;p&gt;A call to aboveThreshold which is quickly followed by a call to underThreshold may result in the SuspenRunner threads executing in the opposite order to that which was desired.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12396483">QPID-1084</key>
            <summary>[Java Client] Race condition suspending channel in no-ack flow control situations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rgodfrey">Robert Godfrey</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 May 2008 10:07:25 +0000</created>
                <updated>Mon, 5 Sep 2011 21:46:14 +0000</updated>
                            <resolved>Mon, 5 Sep 2011 21:46:14 +0000</resolved>
                                    <version>M2</version>
                    <version>M2.1</version>
                    <version>M3</version>
                                    <fixVersion>JIRA Cleanup</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12598613" author="rgodfrey" created="Wed, 21 May 2008 10:09:52 +0000"  >&lt;p&gt;Committed fix on M2.x branch, patch also attached to this JIRA.&lt;/p&gt;

&lt;p&gt;Ultimately a better solution to flow controlling the channel would be preferable - but since this will all change in the 0-10 code path it may not be worth expending further effort on&lt;/p&gt;</comment>
                            <comment id="12598615" author="rgodfrey" created="Wed, 21 May 2008 10:12:03 +0000"  >&lt;p&gt;Patch from M2.x branch&lt;/p&gt;</comment>
                            <comment id="12609529" author="rgodfrey" created="Tue, 1 Jul 2008 11:19:35 +0000"  >&lt;p&gt;Patch applied to trunk&lt;/p&gt;</comment>
                            <comment id="12632209" author="marnie" created="Thu, 18 Sep 2008 13:37:30 +0000"  >&lt;p&gt;Checked, this was not merged to M2.1.x, next release from trunk (M3) will collect&lt;/p&gt;</comment>
                            <comment id="12632260" author="marnie" created="Thu, 18 Sep 2008 15:54:59 +0000"  >&lt;p&gt;Feedback from external review:&lt;/p&gt;

&lt;p&gt;Took a look at the change it solves some of the issues.&lt;/p&gt;

&lt;p&gt;Can still spawn threads as rapidly as the threshold is oscilatted over, so still an issue of spawning threads.&lt;br/&gt;
It also does not conflate changes of state, so the work in suspendChannel method is done - however many threads are spawned. &lt;/p&gt;

&lt;p&gt;At least now you can&apos;t get to the wrong state which is much better than it was. I would have expected a change in suspendChannel as well with a check if the target state equalled the current state it does nothing to avoid the overhead of doing uneeded work. &lt;/p&gt;</comment>
                            <comment id="12643825" author="marnie" created="Thu, 30 Oct 2008 11:15:00 +0000"  >&lt;p&gt;Descoping items not being worked on for M4 into Unknown Fix Version for now&lt;/p&gt;</comment>
                            <comment id="13097550" author="gemmellr" created="Mon, 5 Sep 2011 21:46:14 +0000"  >&lt;p&gt;Closing issue out as part of JIRA cleanup. Issue may already be resolved, may be invalid, or may never be fixed. See &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3469&quot; title=&quot;JIRA clean up for Java client/broker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3469&quot;&gt;&lt;del&gt;QPID-3469&lt;/del&gt;&lt;/a&gt; for further details.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12446899">QPID-2370</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12382450" name="QPID-1084.patch" size="3359" author="rgodfrey" created="Wed, 21 May 2008 10:12:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62430</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0bld3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65573</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>