<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-8222] [JMS AMQP 0-x][AMQP 0-8..0-91] Transaction commit/rollback or recover can hang when failover is in progress</title>
                <link>https://issues.apache.org/jira/browse/QPID-8222</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;JMS transaction commit/rollback or recover can hang when connectivity is lost and failover is triggered to restore the connection. When commit/rollback/recover are invoked after restoring the connectivity and before failover finishes resubscribing of existing sessions, the syncing of dispatcher queue can hang due to race with adding the signal message into the queue from session operation and cleaning the queue by failover. Here is a dump of hang commit operation:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;main&quot; #1 prio=5 os_prio=0 tid=0x000000000241c000 nid=0x2e18 waiting on condition [0x0000000002a9f000]
   java.lang.Thread.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait for  &amp;lt;0x000000076d9f4c70&amp;gt; (a java.util.concurrent.CountDownLatch$Sync)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231)
	at org.apache.qpid.client.AMQSession.syncDispatchQueue(AMQSession.java:2343)
	at org.apache.qpid.client.AMQSession.rollback(AMQSession.java:1984)
	- locked &amp;lt;0x000000076d67e5f8&amp;gt; (a java.lang.Object)
	at org.apache.qpid.client.AMQSession.commit(AMQSession.java:922)
	at org.apache.qpid.test.Test.main(Test.java:40)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The defect was introduced as part of changes committed against &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3521&quot; title=&quot;failover process for the 0-8 client does not clear the pre-dispatch queue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3521&quot;&gt;&lt;del&gt;QPID-3521&lt;/del&gt;&lt;/a&gt;. I do not see any sensible work around for the issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13176393">QPID-8222</key>
            <summary>[JMS AMQP 0-x][AMQP 0-8..0-91] Transaction commit/rollback or recover can hang when failover is in progress</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="orudyy">Alex Rudyy</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Aug 2018 11:47:09 +0000</created>
                <updated>Mon, 20 Aug 2018 09:44:49 +0000</updated>
                            <resolved>Fri, 10 Aug 2018 17:07:45 +0000</resolved>
                                    <version>qpid-java-6.1.6</version>
                    <version>qpid-java-6.0</version>
                    <version>qpid-java-6.0.1</version>
                    <version>qpid-java-6.0.2</version>
                    <version>qpid-java-6.0.3</version>
                    <version>qpid-java-6.0.4</version>
                    <version>qpid-java-6.0.5</version>
                    <version>qpid-java-6.1</version>
                    <version>qpid-java-6.0.6</version>
                    <version>qpid-java-6.1.1</version>
                    <version>qpid-java-6.1.2</version>
                    <version>qpid-java-6.0.7</version>
                    <version>qpid-java-6.1.3</version>
                    <version>qpid-java-6.0.8</version>
                    <version>qpid-java-6.1.4</version>
                    <version>qpid-java-client-0-x-6.3.0</version>
                    <version>qpid-java-6.1.5</version>
                    <version>qpid-java-client-0-x-6.3.1</version>
                    <version>qpid-java-client-0-x-6.3.2</version>
                                    <fixVersion>qpid-java-client-0-x-6.3.3</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16566665" author="alex.rufous" created="Thu, 2 Aug 2018 11:51:15 +0000"  >&lt;p&gt;The easiest way to reproduce the issue is to configure open transaction timeout on broker side, start producing transaction, wait for the timeout to expire and try to commit the transaction. &lt;/p&gt;</comment>
                            <comment id="16576558" author="jira-bot" created="Fri, 10 Aug 2018 16:50:15 +0000"  >&lt;p&gt;Commit 2f020453ea0df0ff74dd51687beeaae93392d0bf in qpid-jms-amqp-0-x&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.rufous&quot; class=&quot;user-hover&quot; rel=&quot;alex.rufous&quot;&gt;alex.rufous&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms-amqp-0-x.git;h=2f02045&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms-amqp-0-x.git;h=2f02045&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-8222&quot; title=&quot;[JMS AMQP 0-x][AMQP 0-8..0-91] Transaction commit/rollback or recover can hang when failover is in progress&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-8222&quot;&gt;&lt;del&gt;QPID-8222&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;JMS AMQP 0-x&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Fix cleaning of dispatcher queue from failover thread&lt;/p&gt;</comment>
                            <comment id="16576563" author="jira-bot" created="Fri, 10 Aug 2018 16:54:36 +0000"  >&lt;p&gt;Commit 7644fff9ed3ce43d800d5af5c679b7d79127f98a in qpid-jms-amqp-0-x&apos;s branch refs/heads/6.3.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.rufous&quot; class=&quot;user-hover&quot; rel=&quot;alex.rufous&quot;&gt;alex.rufous&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms-amqp-0-x.git;h=7644fff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms-amqp-0-x.git;h=7644fff&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-8222&quot; title=&quot;[JMS AMQP 0-x][AMQP 0-8..0-91] Transaction commit/rollback or recover can hang when failover is in progress&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-8222&quot;&gt;&lt;del&gt;QPID-8222&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;JMS AMQP 0-x&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Fix cleaning of dispatcher queue from failover thread&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 2f020453ea0df0ff74dd51687beeaae93392d0bf)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12934072" name="thread-dump.txt" size="14122" author="orudyy" created="Thu, 2 Aug 2018 11:49:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wm87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>