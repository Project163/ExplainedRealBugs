<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:21:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-3817] QueueBrowser creation does not work with Address syntax via &apos;destination.&apos; entries in JNDI properties files</title>
                <link>https://issues.apache.org/jira/browse/QPID-3817</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;I create my queue using the JNDI properties, and when I try to create a queue browser from the Destination object, I get the&lt;br/&gt;
java.lang.ClassCastException: org.apache.qpid.client.AMQAnyDestination cannot be cast to org.apache.qpid.client.AMQQueue&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createBrowser(AMQSession.java:963)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createBrowser(AMQSession.java:950)&lt;/p&gt;

&lt;p&gt;A sample code snippet is below; (just to give an idea).&lt;/p&gt;

&lt;p&gt;Properties properties = new Properties();&lt;br/&gt;
String queueAddress = &quot;T1;{create: always , node : {type : queue, durable : true}}&quot;&lt;br/&gt;
properties.put(&quot;destination.T1&quot;, queueAddress);&lt;br/&gt;
InitialContext ctx = new InitialContext(properties);&lt;br/&gt;
Destination queue = (Destination) ctx.lookup(queueName);&lt;/p&gt;

&lt;p&gt;QueueBrowser queueBrowser = qpidSession.createBrowser(queueRef);&lt;/p&gt;

&lt;p&gt;triggers =&amp;gt;&lt;br/&gt;
java.lang.ClassCastException: org.apache.qpid.client.AMQAnyDestination cannot be cast to org.apache.qpid.client.AMQQueue&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createBrowser(AMQSession.java:963)&lt;br/&gt;
	at org.apache.qpid.client.AMQSession.createBrowser(AMQSession.java:950)&lt;/p&gt;

&lt;p&gt;The createBrowser call is part of JMS. However this part of the API cannot&lt;br/&gt;
be used with Destinations defined using the addressing scheme.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541548">QPID-3817</key>
            <summary>QueueBrowser creation does not work with Address syntax via &apos;destination.&apos; entries in JNDI properties files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbie">Robbie Gemmell</assignee>
                                    <reporter username="lefthandmagic">Praveen Murugesan</reporter>
                        <labels>
                            <label>create</label>
                            <label>jndi</label>
                            <label>queue</label>
                    </labels>
                <created>Tue, 7 Feb 2012 01:42:34 +0000</created>
                <updated>Wed, 11 Feb 2015 20:06:42 +0000</updated>
                            <resolved>Mon, 13 Feb 2012 01:28:13 +0000</resolved>
                                    <version>0.15</version>
                                    <fixVersion>0.15</fixVersion>
                                    <component>Broker-J</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13206024" author="lefthandmagic" created="Sat, 11 Feb 2012 05:21:05 +0000"  >&lt;p&gt;Patch to fix the createBrowser cast exception when trying to create a queue browser with a destination object created using JNDI initialization&lt;/p&gt;</comment>
                            <comment id="13206027" author="lefthandmagic" created="Sat, 11 Feb 2012 05:36:53 +0000"  >&lt;p&gt;Patch Attached&lt;/p&gt;

&lt;p&gt;Cause: When creating a QueueBrowser with a destination created using an addressing string a java.lang.ClassCastException is thrown. &lt;/p&gt;

&lt;p&gt;Consequence: The application is unable to create QueueBrowser from destinations created using an addressing string. The workaround was to create a Queue using session.createQueue method passing an address string.&lt;/p&gt;

&lt;p&gt;Fix: The createBrowser method has been modified to avoid doing the unnecessary cast to AMQQueue object, as this doesn&apos;t work with the AMQAnyDestination object created by the jndi queue creation model. The code is now modified to work with the javax.jms.Queue interface instead of the concrete implementation.&lt;/p&gt;

&lt;p&gt;Result: The createBrowser method is now able to create a QueueBrowser from a destination created using an address string(if it implements the Queue Interface).&lt;/p&gt;

&lt;p&gt;Longer term, it might be nicer to deprecate the older addressing scheme, and stick to the new one. Also, it will be nicer to have a common queue creation code, not a separate path, when created using jndi, and when created using session.createQueue(). Since I&apos;m newer to this project I don&apos;t have great expertise, about the reason to different models. It&apos;d be great if someone can throw some light about this.&lt;/p&gt;

&lt;p&gt;Thank you.&lt;/p&gt;</comment>
                            <comment id="13206610" author="gemmellr" created="Mon, 13 Feb 2012 01:26:43 +0000"  >&lt;p&gt;Hi Praveen,&lt;/p&gt;

&lt;p&gt;Given how long this bug seems to have been present, its funny that this is the second time I have discussed it in the last couple weeks hehe. Rajith had spotted it recently and mentioned he is working on some changes to the Destination handling, so I suggested I&apos;d prefer to wait for those changes for a proper fix (the destination heirarchy is really more at fault than the QueueBrowser code is, though its wrong too) than just make a quick change to get it working seeing as there is a workaround (using &apos;queue.&apos; entries in the JNDI file) and noone had noticed it in all that time (until you did &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;). Your change is nice and small though so I have applied it.&lt;/p&gt;

&lt;p&gt;I can&apos;t really comment on the seperate paths for creating queues as I didnt write it and haven&apos;t had all that much reason to cross paths with it, but I agree having a single path (a factory, perhaps) seems like it would be an obvious approach. We arent likely to deprecate the older addressing scheme any time soon for the existing client, its the only format currnetly supported for the older protocol versions and there are what you might say large numbers of users still depending on it. Work should soon be underway on our client for AMQP 1.0 though, which is intended to be seperate from the current client to let us start afresh with a different design and include such breaks with the past.&lt;/p&gt;</comment>
                            <comment id="13206612" author="gemmellr" created="Mon, 13 Feb 2012 01:28:13 +0000"  >&lt;p&gt;Resolving, patch applied.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514202" name="QueueBrowserPatch.patch" size="1897" author="lefthandmagic" created="Sat, 11 Feb 2012 05:21:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0bj9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>