<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-6951] [Java Client] AMQSession.deregisterConsumer() leaks Memory</title>
                <link>https://issues.apache.org/jira/browse/QPID-6951</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;If a JMS user continually closes consumers on the same transactional session, a memory leak occurs at the following location.  The leak remains until the Session is closed (&lt;tt&gt;Session#close()&lt;/tt&gt;) or the session is rolled-back. (&lt;tt&gt;Session#rollback()&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;AMQSession.deregisterConsumer()&lt;/tt&gt; contains the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (_transacted)
{
    _removedConsumers.add(consumer);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, the &lt;tt&gt;_removedConsumers&lt;/tt&gt; list is only cleaned up on rollback and nowhere else.&lt;/p&gt;

&lt;p&gt;This leak appears to be longstanding.  It looks like it was added at M3 (&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-832&quot; title=&quot;Merge M2.1 and trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-832&quot;&gt;&lt;del&gt;QPID-832&lt;/del&gt;&lt;/a&gt;). &lt;/p&gt;</description>
                <environment></environment>
        <key id="12921919">QPID-6951</key>
            <summary>[Java Client] AMQSession.deregisterConsumer() leaks Memory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwall">Keith Wall</assignee>
                                    <reporter username="lorenz.quack">Lorenz Quack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Dec 2015 10:12:46 +0000</created>
                <updated>Wed, 2 Oct 2019 19:22:36 +0000</updated>
                            <resolved>Fri, 8 Jan 2016 13:27:53 +0000</resolved>
                                    <version>0.18</version>
                    <version>0.22</version>
                    <version>0.32</version>
                    <version>qpid-java-6.0</version>
                                    <fixVersion>qpid-java-6.0.1</fixVersion>
                    <fixVersion>qpid-java-6.1</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15062867" author="jira-bot" created="Thu, 17 Dec 2015 21:31:26 +0000"  >&lt;p&gt;Commit 1720664 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720664&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720664&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6951&quot; title=&quot;[Java Client] AMQSession.deregisterConsumer() leaks Memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6951&quot;&gt;&lt;del&gt;QPID-6951&lt;/del&gt;&lt;/a&gt;: Stop tracking closed consumers and remove dead code trying to release pending messages on closed consumers as corresponidng queue is already cleared on consumer close&lt;/p&gt;</comment>
                            <comment id="15066444" author="jira-bot" created="Mon, 21 Dec 2015 13:33:05 +0000"  >&lt;p&gt;Commit 1721151 from orudyy@apache.org in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721151&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721151&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6951&quot; title=&quot;[Java Client] AMQSession.deregisterConsumer() leaks Memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6951&quot;&gt;&lt;del&gt;QPID-6951&lt;/del&gt;&lt;/a&gt;: Release consumer prefetched messages on consumer close regardless whether session is closed or not. Rename/remove consumer methods to have sensible method names indicating what exactly method is really doing. Add system test&lt;/p&gt;</comment>
                            <comment id="15066448" author="alex.rufous" created="Mon, 21 Dec 2015 13:36:03 +0000"  >&lt;p&gt;Keith,&lt;br/&gt;
Please, review committed changes for the JIRA&lt;/p&gt;</comment>
                            <comment id="15066591" author="jira-bot" created="Mon, 21 Dec 2015 15:46:46 +0000"  >&lt;p&gt;Commit 1721198 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721198&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721198&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6951&quot; title=&quot;[Java Client] AMQSession.deregisterConsumer() leaks Memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6951&quot;&gt;&lt;del&gt;QPID-6951&lt;/del&gt;&lt;/a&gt;: Revert change to BasicMessageConsumer so that prefetched messages are not released if a session is already closing.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Added test to ensure that previously received messages are committed even if the consumer is closed.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15089202" author="jira-bot" created="Fri, 8 Jan 2016 13:27:45 +0000"  >&lt;p&gt;Commit 1723725 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/branches/6.0.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1723725&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1723725&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6951&quot; title=&quot;[Java Client] AMQSession.deregisterConsumer() leaks Memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6951&quot;&gt;&lt;del&gt;QPID-6951&lt;/del&gt;&lt;/a&gt;: AMQSession.deregisterConsumer() leaks Memory&lt;/p&gt;

&lt;p&gt;Merged from trunk with command:&lt;/p&gt;

&lt;p&gt;svn merge -c 1720664,1721151,1721198  &lt;a href=&quot;https://svn.apache.org/repos/asf/qpid/java/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/qpid/java/trunk&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12778247" name="QPID-6951-fix.diff" size="2337" author="orudyy" created="Thu, 17 Dec 2015 13:58:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2pwg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>