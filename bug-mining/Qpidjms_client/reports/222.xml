<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:20:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-1373] AMQSession_0_8.acknowledgeMessage leaves the message on the unack&apos;d message map</title>
                <link>https://issues.apache.org/jira/browse/QPID-1373</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;This leads to hilarity in the unit tests&lt;/p&gt;</description>
                <environment></environment>
        <key id="12406689">QPID-1373</key>
            <summary>AMQSession_0_8.acknowledgeMessage leaves the message on the unack&apos;d message map</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aidan">Aidan Skinner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Oct 2008 15:22:58 +0000</created>
                <updated>Mon, 5 Sep 2011 21:45:54 +0000</updated>
                            <resolved>Mon, 5 Sep 2011 21:45:54 +0000</resolved>
                                    <version>M4</version>
                    <version>0.5</version>
                                    <fixVersion>JIRA Cleanup</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12663695" author="aidan" created="Wed, 14 Jan 2009 09:44:08 +0000"  >&lt;p&gt;Bagsie not it&lt;/p&gt;</comment>
                            <comment id="12664446" author="marnie" created="Fri, 16 Jan 2009 09:22:58 +0000"  >&lt;p&gt;Aidan - please add a more detailed description outlining the potential impact i.e. assuming this introduces a memory leak ? If so, how bad, if not then what does happen here ? Thanks&lt;/p&gt;</comment>
                            <comment id="12665464" author="aidan" created="Tue, 20 Jan 2009 16:41:30 +0000"  >&lt;p&gt;Random tests would sometimes fail, or be unvalidatable. Needs review -&amp;gt; MR&lt;/p&gt;</comment>
                            <comment id="12680506" author="ritchiem" created="Tue, 10 Mar 2009 15:13:23 +0000"  >&lt;p&gt;Aidan, there isn&apos;t much to go on in this JIRA but, if acknowledgeThis() is supposed to only acknowledge the given message then I think you need a more robust test.&lt;/p&gt;

&lt;p&gt;The test may pass but acknowledgeThis() is actually still doing a multiple ack.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach a test that I used to validate this for myself.&lt;/p&gt;

&lt;p&gt;Always good for tests to have asserts in them &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Whilst not related to your changes I am surprised that 0-8 and 0-10 do radically different things in their acknowledgeMessage(tag,multi) methods.&lt;/p&gt;

&lt;p&gt;For instance I would expect performing a multi ack to sweek the _unackedMessageTags to remove values lower than the specified tag.&lt;/p&gt;

&lt;p&gt;So I would expect this test to fail:&lt;br/&gt;
send(4)&lt;br/&gt;
receive 1&lt;br/&gt;
receive 2&lt;br/&gt;
receive 3&lt;br/&gt;
receive 4&lt;/p&gt;

&lt;p&gt;// perform a multiple ack of message 2 directly with AMQSession&lt;br/&gt;
AMQsession.acknowledgeMessage(2, true);&lt;/p&gt;

&lt;p&gt;//Ack the rest of the session.&lt;br/&gt;
msg4.ack or session.ack&lt;/p&gt;

&lt;p&gt;The error will occur as msg 1 should have been acked twice as the session.ack just goes through the list of _unackedMessageTags and acks them all.&lt;/p&gt;</comment>
                            <comment id="13097446" author="gemmellr" created="Mon, 5 Sep 2011 21:45:54 +0000"  >&lt;p&gt;Closing issue out as part of JIRA cleanup. Issue may already be resolved, may be invalid, or may never be fixed. See &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3469&quot; title=&quot;JIRA clean up for Java client/broker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3469&quot;&gt;&lt;del&gt;QPID-3469&lt;/del&gt;&lt;/a&gt; for further details.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12401845" name="QPID-1373.patch" size="3000" author="ritchiem" created="Tue, 10 Mar 2009 15:14:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62533</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0blx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>