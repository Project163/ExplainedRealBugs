<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:20:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-2432] org.apache.qpid.client.XAResourceImpl doesn&apos;t handle get-/set- TransactionTimeout correctly</title>
                <link>https://issues.apache.org/jira/browse/QPID-2432</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;The XAResource interface&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; defines the transaction timeout to be a property of the resource itself, and not tied to any particular XID. In AMQP 0-10 however the DtxSetTimeout method is for a specific XID. At present org.apache.qpid.client.XAResourceImpl records the XID currently associated with the resource instance and uses that to implement get-/set- TransactionTimeout(). There are a couple of issues with this approach:&lt;/p&gt;

&lt;p&gt;(a) the associated xid is not nulled on committing the transaction, meaning that a call to setTransactionTimeout() immediately after a commit() will result in a request to the broker to set the timeout on that xid which violates the AMQP 0-10 protocol&lt;/p&gt;

&lt;p&gt;(b) the timeout set by a call to setTransactionTimeout() will only have effect on the currently associated xid which seems to violate the XAResource interfaces contract&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/transaction/xa/XAResource.html#setTransactionTimeout%28int%29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/transaction/xa/XAResource.html#setTransactionTimeout%28int%29&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12458235">QPID-2432</key>
            <summary>org.apache.qpid.client.XAResourceImpl doesn&apos;t handle get-/set- TransactionTimeout correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gsim">Gordon Sim</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Mar 2010 11:53:52 +0000</created>
                <updated>Mon, 5 Sep 2011 21:46:03 +0000</updated>
                            <resolved>Mon, 5 Sep 2011 21:46:03 +0000</resolved>
                                                    <fixVersion>JIRA Cleanup</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12841828" author="gsim" created="Fri, 5 Mar 2010 12:07:19 +0000"  >&lt;p&gt;There are a number of possible solutions:&lt;/p&gt;

&lt;p&gt;(a) maintain a timeout in org.apache.qpid.client.XAResourceImpl independent of the xid association, and apply that timeout via a DtxSetTimeout whenever a new xid association is made; the only issue here is that there is no guarantee that the timeout will be accepted by the broker at that point and so the XAResource contract could still be violated in some circumstances&lt;/p&gt;

&lt;p&gt;(b) clear the associated xid once the transaction commits or is rolled-back; this will at least avoid the first problem in the bug description, but doesn&apos;t address the second&lt;/p&gt;

&lt;p&gt;(c) don&apos;t support transaction timeouts at all; this reduces functionality but would not violate the XAResource contract&lt;/p&gt;

&lt;p&gt;My own inclination is to support both (a) and (c) by having a configuration option that disables timeouts completely. That allows the functionality to be used in cases where the deviation from contract is not an issue while providing the ability to enforce strict compliance with JTA.&lt;/p&gt;</comment>
                            <comment id="12841913" author="gsim" created="Fri, 5 Mar 2010 16:21:33 +0000"  >&lt;p&gt;correction: DtxSetTimeout doesn&apos;t allow a non-exceptional return status where the timeout is not valid, so the concern with option (a) is not relevant.&lt;/p&gt;</comment>
                            <comment id="12842116" author="rajith" created="Fri, 5 Mar 2010 23:25:26 +0000"  >&lt;p&gt;I added fix in rev 919666 in Qpid trunk.&lt;/p&gt;

&lt;p&gt;Modified the XAResourceImpl to maintain the timeout value and set it to any XID in the start method if the time value &amp;gt; 0&lt;br/&gt;
Also the XID nulled after commit, rollback and forget, to prevent a timeout being set on an invalid xid.&lt;br/&gt;
The setTimeout method will only set the timeout if xid is not null and if the timeout value is different from the previous value.&lt;/p&gt;

&lt;p&gt;Modified the test cases in FaultTest to adhere to the correct behaviour and also added a new test case to cover the issue mentioned in the JIRA.&lt;/p&gt;</comment>
                            <comment id="13097487" author="gemmellr" created="Mon, 5 Sep 2011 21:46:03 +0000"  >&lt;p&gt;Closing issue out as part of JIRA cleanup. Issue may already be resolved, may be invalid, or may never be fixed. See &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-3469&quot; title=&quot;JIRA clean up for Java client/broker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-3469&quot;&gt;&lt;del&gt;QPID-3469&lt;/del&gt;&lt;/a&gt; for further details.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62492</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0blov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65626</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>