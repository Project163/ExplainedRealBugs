<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:19:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-294] Race condition in establishing client connection </title>
                <link>https://issues.apache.org/jira/browse/QPID-294</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;Recent changes have created a race condition when establishing a client connection.&lt;/p&gt;

&lt;p&gt;In AMQConnection we do:&lt;/p&gt;

&lt;p&gt;    private void makeBrokerConnection(BrokerDetails brokerDetail) throws IOException, AMQException&lt;br/&gt;
    {&lt;br/&gt;
        try&lt;/p&gt;
        {
            TransportConnection.getInstance(brokerDetail).connect(_protocolHandler, brokerDetail);

            // this blocks until the connection has been set up or when an error
            // has prevented the connection being set up
            _protocolHandler.attainState(AMQState.CONNECTION_OPEN);
            _failoverPolicy.attainedConnection();

            //Again this should be changed to a suitable notify
            _connected = true;
        }

&lt;p&gt;Where the AMQProtocolHandler.attainState( ) method looks like&lt;/p&gt;


&lt;p&gt;    public void attainState(AMQState s) throws AMQException&lt;/p&gt;
    {
        _protocolSession.getStateManager().attainState(s);
    }

&lt;p&gt;However, _protocolSession may not yet have been set, as it is only created when the MINA thread calls AMQProtocolHandler.sessionCreated( ... )&lt;/p&gt;


&lt;p&gt;To fix this issue, we must create the StateManager in ProtocolHandler, and then pass this StateManager to the ProtocolSession&lt;/p&gt;

&lt;p&gt;Patch to be attached shortly&lt;/p&gt;</description>
                <environment></environment>
        <key id="12360528">QPID-294</key>
            <summary>Race condition in establishing client connection </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgodfrey">Robert Godfrey</assignee>
                                    <reporter username="rgodfrey">Robert Godfrey</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Jan 2007 12:35:25 +0000</created>
                <updated>Tue, 14 Mar 2017 20:02:37 +0000</updated>
                            <resolved>Mon, 15 Jan 2007 14:10:53 +0000</resolved>
                                                    <fixVersion>M2</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12464809" author="rgreig" created="Mon, 15 Jan 2007 14:10:53 +0000"  >&lt;p&gt;Patch applied svn revision 496302&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12348954" name="QPID-294.patch" size="6016" author="rgodfrey" created="Mon, 15 Jan 2007 12:45:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>167330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0c29j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>68311</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>