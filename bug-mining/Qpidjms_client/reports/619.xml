<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPID-7394] [0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered</title>
                <link>https://issues.apache.org/jira/browse/QPID-7394</link>
                <project id="12310520" key="QPID">Qpid</project>
                    <description>&lt;p&gt;When the application calls &lt;tt&gt;Session#receive()&lt;/tt&gt;, the client will automatically open the prefetch window by 1 message if necessary (&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-6088&quot; title=&quot;[Java Client] AMQP 0-8/8/9-1 prefetch should auto expand when receive is called in a situation where the prefetch buffer is full&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-6088&quot;&gt;&lt;del&gt;QPID-6088&lt;/del&gt;&lt;/a&gt;).    On committing the received message, the client takes care to revert the prefetch level back to the session&apos;s default value.   However, if the application calls rollback, the client fails to account for the increased credit, so when the application calls #receive again, the prefetch window will be opened further.&lt;/p&gt;

&lt;p&gt;If the downstream application experiences some kind of failure meaning it rolls back every message, this could potentially lead to the prefetch buffer growing large.  If the queue is deep, this could cause excessive network utilisation (as large numbers of messages are continually received/rejected) and excessive memory use on the client.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;This defect also allows a Broker defect to manifest - &lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7387&quot; title=&quot;[Java Broker, AMQP 0-8..0-91] Correct handling of consumer credit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7387&quot;&gt;&lt;del&gt;QPID-7387&lt;/del&gt;&lt;/a&gt;.&lt;/del&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12996945">QPID-7394</key>
            <summary>[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kwall">Keith Wall</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Aug 2016 13:25:15 +0000</created>
                <updated>Wed, 2 Oct 2019 19:22:18 +0000</updated>
                            <resolved>Mon, 12 Sep 2016 12:47:11 +0000</resolved>
                                    <version>0.32</version>
                    <version>qpid-java-6.0</version>
                    <version>qpid-java-6.0.4</version>
                                    <fixVersion>qpid-java-6.0.5</fixVersion>
                    <fixVersion>qpid-java-6.1</fixVersion>
                                    <component>JMS AMQP 0-x</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15473386" author="jira-bot" created="Thu, 8 Sep 2016 09:38:18 +0000"  >&lt;p&gt;Commit 1759774 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorenz.quack&quot; class=&quot;user-hover&quot; rel=&quot;lorenz.quack&quot;&gt;lorenz.quack&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1759774&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1759774&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client, AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Correct prefetch accounting when message rolled back&lt;/p&gt;</comment>
                            <comment id="15473395" author="jira-bot" created="Thu, 8 Sep 2016 09:42:13 +0000"  >&lt;p&gt;Commit 1759775 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorenz.quack&quot; class=&quot;user-hover&quot; rel=&quot;lorenz.quack&quot;&gt;lorenz.quack&lt;/a&gt; in branch &apos;java/branches/6.0.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1759775&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1759775&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client, AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Correct prefetch accounting when message rolled back&lt;/p&gt;

&lt;p&gt;merged from trunk via:&lt;br/&gt;
$ svn merge -c 1759774 ^/qpid/java/trunk&lt;/p&gt;</comment>
                            <comment id="15473613" author="jira-bot" created="Thu, 8 Sep 2016 11:35:16 +0000"  >&lt;p&gt;Commit 1759783 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1759783&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1759783&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: Correct compilation failure introduced by r1759774&lt;/p&gt;</comment>
                            <comment id="15473617" author="jira-bot" created="Thu, 8 Sep 2016 11:37:34 +0000"  >&lt;p&gt;Commit 1759784 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwall&quot; class=&quot;user-hover&quot; rel=&quot;kwall&quot;&gt;kwall&lt;/a&gt; in branch &apos;java/branches/6.0.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1759784&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1759784&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: Correct compilation failure introduced by r1759774&lt;br/&gt;
Merged from trunk with command:&lt;br/&gt;
svn merge -c 1759783 ^/qpid/java/trunk&lt;/p&gt;</comment>
                            <comment id="15486865" author="jira-bot" created="Tue, 13 Sep 2016 10:20:33 +0000"  >&lt;p&gt;Commit 1760522 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorenz.quack&quot; class=&quot;user-hover&quot; rel=&quot;lorenz.quack&quot;&gt;lorenz.quack&lt;/a&gt; in branch &apos;java/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1760522&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1760522&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client, AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Correct prefetch accounting when client ack session is recovered&lt;/p&gt;</comment>
                            <comment id="15486878" author="jira-bot" created="Tue, 13 Sep 2016 10:27:24 +0000"  >&lt;p&gt;Commit 1760525 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorenz.quack&quot; class=&quot;user-hover&quot; rel=&quot;lorenz.quack&quot;&gt;lorenz.quack&lt;/a&gt; in branch &apos;java/branches/6.0.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1760525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1760525&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPID-7394&quot; title=&quot;[0-8..0-91] Prefetch accounting incorrect when session rolled back / recovered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPID-7394&quot;&gt;&lt;del&gt;QPID-7394&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;Java Client, AMQP 0-8..0-91&amp;#93;&lt;/span&gt; Correct prefetch accounting when client ack session is recovered&lt;/p&gt;

&lt;p&gt;Merged from trunk with command:&lt;/p&gt;

&lt;p&gt;svn merge -c 1760522  ^/qpid/java/trunk&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12996662">QPID-7387</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12739894">QPID-6088</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12823471" name="0001-QPID-7394-Java-Client-0-8.0-91-Prevent-the-client-fr.patch" size="1359" author="kwall" created="Fri, 12 Aug 2016 14:03:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i329cf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>