diff --git a/CHANGES.txt b/CHANGES.txt
index ef5342f76..dd957f5ad 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -95,6 +95,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)
 
 BUG FIXES
 
+PIG-4814: AvroStorage does not take namenode HA as part of schema file url (daijy)
+
 PIG-4812: Register Groovy UDF with relative path does not work (daijy)
 
 PIG-4806: UDFContext can be reset in the middle during Tez input and output initialization (rohini)
diff --git a/src/org/apache/pig/builtin/AvroStorage.java b/src/org/apache/pig/builtin/AvroStorage.java
index 883f94d0b..86f764c35 100644
--- a/src/org/apache/pig/builtin/AvroStorage.java
+++ b/src/org/apache/pig/builtin/AvroStorage.java
@@ -175,8 +175,14 @@ public class AvroStorage extends LoadFunc
         if (configuredOptions.hasOption('f')) {
           try {
             Path p = new Path(configuredOptions.getOptionValue('f'));
+            Configuration conf;
+            if (UDFContext.getUDFContext().getJobConf()==null) {
+                conf = new Configuration();
+            } else {
+                conf = UDFContext.getUDFContext().getJobConf();
+            }
             Schema s = new Schema.Parser()
-              .parse((FileSystem.get(p.toUri(), new Configuration()).open(p)));  
+              .parse((FileSystem.get(p.toUri(), conf).open(p)));
             setInputAvroSchema(s);
             setOutputAvroSchema(s);
           } catch (FileNotFoundException fnfe) {
