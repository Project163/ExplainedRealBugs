diff --git a/CHANGES.txt b/CHANGES.txt
index 15d13c425..107336e5f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -142,6 +142,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1974: Lineage need to set for every cast (thejas)
+
 PIG-1988: Importing an empty macro file causing NPE (rding)
 
 PIG-1977: "Stream closed" error while reading Pig temp files (results of intermediate jobs) (rding)
diff --git a/src/org/apache/pig/newplan/logical/visitor/CastLineageSetter.java b/src/org/apache/pig/newplan/logical/visitor/CastLineageSetter.java
index c2f0e4576..56077daee 100644
--- a/src/org/apache/pig/newplan/logical/visitor/CastLineageSetter.java
+++ b/src/org/apache/pig/newplan/logical/visitor/CastLineageSetter.java
@@ -28,10 +28,12 @@ import org.apache.pig.newplan.DependencyOrderWalker;
 import org.apache.pig.newplan.OperatorPlan;
 import org.apache.pig.newplan.ReverseDependencyOrderWalker;
 import org.apache.pig.newplan.logical.expression.CastExpression;
+import org.apache.pig.newplan.logical.expression.LogicalExpression;
 import org.apache.pig.newplan.logical.expression.LogicalExpressionPlan;
 import org.apache.pig.newplan.logical.expression.LogicalExpressionVisitor;
 import org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor;
 import org.apache.pig.newplan.logical.relational.LogicalPlan;
+import org.apache.pig.newplan.logical.relational.LogicalSchema.LogicalFieldSchema;
 
 
 /**
@@ -98,7 +100,7 @@ public class CastLineageSetter extends AllExpressionVisitor{
             byte inType = cast.getExpression().getType();
             byte outType = cast.getType();
 
-            if(inType == DataType.BYTEARRAY){
+            if(containsByteArrayOrEmtpyInSchema(cast.getExpression().getFieldSchema())){
                 long inUid = cast.getExpression().getFieldSchema().uid;
                 FuncSpec inLoadFunc = uid2LoadFuncMap.get(inUid);
                 if(inLoadFunc == null){
@@ -112,6 +114,34 @@ public class CastLineageSetter extends AllExpressionVisitor{
             }
         }
 
+        /**
+         * @param fs
+         * @return true if fs is of complex type and contains a bytearray 
+         *  or empty inner schema
+         * @throws FrontendException
+         */
+        private boolean containsByteArrayOrEmtpyInSchema(LogicalFieldSchema fs)
+        throws FrontendException {
+            
+            if(fs.type == DataType.BYTEARRAY)
+                return true;
+            
+            if(DataType.isAtomic(fs.type))
+                return false;
+            
+            if(fs.schema == null || fs.schema.size() == 0)
+                return true;
+            
+            for(LogicalFieldSchema inFs : fs.schema.getFields()){
+                if(containsByteArrayOrEmtpyInSchema(inFs))
+                    return true;
+            }
+
+            return false;
+        }
+
+
+
     }
 
 }
diff --git a/test/org/apache/pig/test/TestEvalPipeline2.java b/test/org/apache/pig/test/TestEvalPipeline2.java
index 9bfee5277..46f862147 100644
--- a/test/org/apache/pig/test/TestEvalPipeline2.java
+++ b/test/org/apache/pig/test/TestEvalPipeline2.java
@@ -1435,4 +1435,29 @@ public class TestEvalPipeline2 {
         Assert.assertTrue(t.toString().equals("({(one),(two)})"));
         Assert.assertFalse(iter.hasNext());
     }
+
+    //See PIG-1974
+    @Test
+    public void testCastMap() throws Exception{
+        String[] input = {
+                "([key#1])",
+                "([key#2])",
+        };
+        
+        Util.createInputFile(cluster, "table_testCastMap", input);
+
+        pigServer.registerQuery("a = load 'table_testCastMap' as (m:map[]);");
+        pigServer.registerQuery("b = foreach a generate (map[int])m;");
+        pigServer.registerQuery("c = foreach b generate m#'key' + 1;");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("c");
+        
+        Tuple t = iter.next();
+        Assert.assertEquals(t.get(0), 2);
+        t = iter.next();
+        Assert.assertEquals(t.get(0), 3);
+        Assert.assertFalse(iter.hasNext());
+    }
+    
+    
 }
diff --git a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
index fc46bdb2a..60b307f06 100644
--- a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
+++ b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
@@ -3499,6 +3499,7 @@ public class TestTypeCheckingValidatorNewLP {
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 0);
         }
         
+        
         @Test
         public void testMapLookupLineageNoSchema() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') ;"
@@ -3609,6 +3610,30 @@ public class TestTypeCheckingValidatorNewLP {
             }
         }
     
+        @Test
+        public void testMapCastLineage() throws Throwable {
+            String query =  
+                "a = load 'a' using PigStorage('a') as (field1 : map[], field2: float );"
+                + "b = foreach a generate (map[int])field1;" ;  
+            checkLastForeachCastLoadFunc(query, "PigStorage('a')");
+        }
+
+        @Test
+        public void testTupleCastLineage() throws Throwable {
+            String query =  
+                "a = load 'a' using PigStorage('a') as (field1 : tuple(i), field2: float);"
+                + "b = foreach a generate (tuple(int))field1;" ;  
+            checkLastForeachCastLoadFunc(query, "PigStorage('a')");
+        }
+        
+        @Test
+        public void testBagCastLineage() throws Throwable {
+            String query =  
+                "a = load 'a' using PigStorage('a') as (field1 : bag{ t : tuple (i)}, field2: float);"
+                + "b = foreach a generate (bag{tuple(int)})field1;" ;  
+            checkLastForeachCastLoadFunc(query, "PigStorage('a')");
+        }
+        
         private void checkLoaderInCasts(LogicalPlan plan, String loaderClassName)
         throws FrontendException 
        {
