diff --git a/CHANGES.txt b/CHANGES.txt
index 195c97334..c461a0cb5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -30,6 +30,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-3978: Container reuse does not across PigServer (daijy)
+
 PIG-3974: E2E test data generation fails in cluster mode (lbendig via cheolsoo)
 
 PIG-3969: Javascript UDF fails if no output schema is defined (lbendig via cheolsoo)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
index 017133e21..1520070f2 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
@@ -149,8 +149,6 @@ public class TezCompiler extends PhyPlanVisitor {
 
     private Map<PhysicalOperator, TezOperator> phyToTezOpMap;
 
-    private TezResourceManager tezResourceManager;
-
     public static final String USER_COMPARATOR_MARKER = "user.comparator.func:";
     public static final String FILE_CONCATENATION_THRESHOLD = "pig.files.concatenation.threshold";
     public static final String OPTIMISTIC_FILE_CONCATENATION = "pig.optimistic.files.concatenation";
@@ -160,16 +158,15 @@ public class TezCompiler extends PhyPlanVisitor {
 
     private POLocalRearrangeTezFactory localRearrangeFactory;
 
-    public TezCompiler(PhysicalPlan plan, PigContext pigContext, TezResourceManager tezResourceManager)
+    public TezCompiler(PhysicalPlan plan, PigContext pigContext)
             throws TezCompilerException {
         super(plan, new DepthFirstWalker<PhysicalOperator, PhysicalPlan>(plan));
         this.plan = plan;
         this.pigContext = pigContext;
-        this.tezResourceManager = tezResourceManager;
 
         pigProperties = pigContext.getProperties();
         splitsSeen = Maps.newHashMap();
-        tezPlan = new TezOperPlan(tezResourceManager);
+        tezPlan = new TezOperPlan();
         nig = NodeIdGenerator.getGenerator();
         udfFinder = new UDFFinder();
         List<PhysicalOperator> roots = plan.getRoots();
@@ -196,7 +193,7 @@ public class TezCompiler extends PhyPlanVisitor {
 
     // Segment a single DAG into a DAG graph
     public TezPlanContainer getPlanContainer() throws PlanException {
-        TezPlanContainer tezPlanContainer = new TezPlanContainer(pigContext, tezResourceManager);
+        TezPlanContainer tezPlanContainer = new TezPlanContainer(pigContext);
         TezPlanContainerNode node = new TezPlanContainerNode(OperatorKey.genOpKey(scope), tezPlan);
         tezPlanContainer.add(node);
         tezPlanContainer.split(node);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
index 4597d9995..7f91ce02f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
@@ -65,8 +65,10 @@ public class TezLauncher extends Launcher {
 
         Path stagingDir = FileLocalizer.getTemporaryPath(pc, "-tez");
 
-        TezResourceManager tezResourceManager = new TezResourceManager(stagingDir, pc, conf);
+        TezResourceManager tezResourceManager = TezResourceManager.getInstance();
+        tezResourceManager.init(pc, conf);
 
+        stagingDir.getFileSystem(conf).mkdirs(stagingDir);
         log.info("Tez staging directory is " + stagingDir.toString());
         conf.set(TezConfiguration.TEZ_AM_STAGING_DIR, stagingDir.toString());
 
@@ -77,7 +79,7 @@ public class TezLauncher extends Launcher {
         PigStats.start(tezStats);
 
         TezJobControlCompiler jcc = new TezJobControlCompiler(pc, conf);
-        TezPlanContainer tezPlanContainer = compile(php, pc, tezResourceManager);
+        TezPlanContainer tezPlanContainer = compile(php, pc);
 
         TezOperPlan tezPlan;
 
@@ -205,7 +207,7 @@ public class TezLauncher extends Launcher {
             String format, boolean verbose) throws PlanException,
             VisitorException, IOException {
         log.debug("Entering TezLauncher.explain");
-        TezPlanContainer tezPlanContainer = compile(php, pc, null);
+        TezPlanContainer tezPlanContainer = compile(php, pc);
 
         if (format.equals("text")) {
             TezPlanContainerPrinter printer = new TezPlanContainerPrinter(ps, tezPlanContainer);
@@ -217,9 +219,9 @@ public class TezLauncher extends Launcher {
         }
     }
 
-    public TezPlanContainer compile(PhysicalPlan php, PigContext pc, TezResourceManager tezResourceManager)
+    public TezPlanContainer compile(PhysicalPlan php, PigContext pc)
             throws PlanException, IOException, VisitorException {
-        TezCompiler comp = new TezCompiler(php, pc, tezResourceManager);
+        TezCompiler comp = new TezCompiler(php, pc);
         TezOperPlan tezPlan = comp.compile();
 
         NoopFilterRemover filter = new NoopFilterRemover(tezPlan);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezOperPlan.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezOperPlan.java
index 9fef3f548..be2d19669 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezOperPlan.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezOperPlan.java
@@ -42,12 +42,9 @@ public class TezOperPlan extends OperatorPlan<TezOperator> {
 
     private static final long serialVersionUID = 1L;
 
-    private TezResourceManager tezResourceManager;
-
     private Map<String, Path> extraResources = new HashMap<String, Path>();
 
-    public TezOperPlan(TezResourceManager tezResourceManager) {
-        this.tezResourceManager = tezResourceManager;
+    public TezOperPlan() {
     }
 
     @Override
@@ -70,7 +67,7 @@ public class TezOperPlan extends OperatorPlan<TezOperator> {
         String resourceName = resourcePath.getName();
 
         if (!extraResources.containsKey(resourceName)) {
-            Path remoteFsPath = tezResourceManager.addTezResource(url);
+            Path remoteFsPath = TezResourceManager.getInstance().addTezResource(url);
             extraResources.put(resourceName, remoteFsPath);
         }
     }
@@ -78,7 +75,7 @@ public class TezOperPlan extends OperatorPlan<TezOperator> {
     // Add extra plan-specific local resources already present in the remote FS
     public void addExtraResource(String resourceName, Path remoteFsPath) throws IOException {
         if (!extraResources.containsKey(resourceName)) {
-            tezResourceManager.addTezResource(resourceName, remoteFsPath);
+            TezResourceManager.getInstance().addTezResource(resourceName, remoteFsPath);
             extraResources.put(resourceName, remoteFsPath);
         }
     }
@@ -93,7 +90,7 @@ public class TezOperPlan extends OperatorPlan<TezOperator> {
         addShipResources(streamVisitor.getShipFiles());
         addCacheResources(streamVisitor.getCacheFiles());
 
-        return tezResourceManager.getTezResources(extraResources.keySet());
+        return TezResourceManager.getInstance().getTezResources(extraResources.keySet());
     }
 
     // In the statement "SHIP('/home/foo')" we'll map the resource name foo to
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezPlanContainer.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezPlanContainer.java
index bd84e23e1..a26ff83e1 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezPlanContainer.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezPlanContainer.java
@@ -38,12 +38,10 @@ import org.apache.pig.impl.util.JarManager;
 
 public class TezPlanContainer extends OperatorPlan<TezPlanContainerNode> {
     private static final long serialVersionUID = 1L;
-    private TezResourceManager tezResourceManager;
     private PigContext pigContext;
 
-    public TezPlanContainer(PigContext pigContext, TezResourceManager tezResourceManager) {
+    public TezPlanContainer(PigContext pigContext) {
         this.pigContext = pigContext;
-        this.tezResourceManager = tezResourceManager;
     }
 
     // Add the Pig jar and the UDF jars as AM resources (all DAG's in the planContainer
@@ -52,7 +50,7 @@ public class TezPlanContainer extends OperatorPlan<TezPlanContainerNode> {
     public Map<String, LocalResource> getLocalResources() throws Exception {
         Set<URL> jarLists = new HashSet<URL>();
 
-        jarLists.add(tezResourceManager.getBootStrapJar());
+        jarLists.add(new File(TezResourceManager.getInstance().getBootStrapJar()).toURI().toURL());
 
         // In MR Pig the extra jars and script jars get put in Distributed Cache, but
         // in Tez we'll add them as local resources.
@@ -101,7 +99,7 @@ public class TezPlanContainer extends OperatorPlan<TezPlanContainerNode> {
         //     }
         // }
 
-        return tezResourceManager.addTezResources(jarLists);
+        return TezResourceManager.getInstance().addTezResources(jarLists);
     }
 
     public TezOperPlan getNextPlan(List<TezOperPlan> processedPlans) {
@@ -157,7 +155,7 @@ public class TezPlanContainer extends OperatorPlan<TezPlanContainerNode> {
         if (operToSegment != null) {
             for (TezOperator succ : succs) {
                 tezOperPlan.disconnect(operToSegment, succ);
-                TezOperPlan newOperPlan = new TezOperPlan(tezResourceManager);
+                TezOperPlan newOperPlan = new TezOperPlan();
                 List<TezPlanContainerNode> containerSuccs = new ArrayList<TezPlanContainerNode>();
                 if (getSuccessors(planNode)!=null) {
                     containerSuccs.addAll(getSuccessors(planNode));
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezResourceManager.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezResourceManager.java
index b4f993a2e..152a43c03 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezResourceManager.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezResourceManager.java
@@ -35,46 +35,60 @@ import org.apache.hadoop.yarn.api.records.LocalResourceType;
 import org.apache.hadoop.yarn.api.records.LocalResourceVisibility;
 import org.apache.hadoop.yarn.util.ConverterUtils;
 import org.apache.pig.impl.PigContext;
+import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.util.JarManager;
 
 public class TezResourceManager {
+    private static TezResourceManager instance = null;
+    private boolean inited = false;
     private Path stagingDir;
     private PigContext pigContext;
     private Configuration conf;
-    private URL bootStrapJar;
+    private String bootStrapJar;
     private FileSystem remoteFs;
     public Map<String, Path> resources = new HashMap<String, Path>();
 
-    public URL getBootStrapJar() {
+    public String getBootStrapJar() {
         return bootStrapJar;
     }
 
-    public TezResourceManager(Path stagingDir, PigContext pigContext, Configuration conf) throws IOException {
-        resources.clear();
-        this.stagingDir = stagingDir;
-        this.pigContext = pigContext;
-        this.conf = conf;
-        String jar = JarManager.findContainingJar(org.apache.pig.Main.class);
-        this.bootStrapJar = new File(jar).toURI().toURL();
-        remoteFs = FileSystem.get(conf);
-        addBootStrapJar();
+    static public TezResourceManager getInstance() {
+        if (instance==null) {
+            instance = new TezResourceManager();
+        }
+        return instance;
+    }
+  
+    public void init(PigContext pigContext, Configuration conf) throws IOException {
+        if (!inited) {
+            this.stagingDir = FileLocalizer.getTemporaryPath(pigContext, "-tez-resource");;
+            this.pigContext = pigContext;
+            this.conf = conf;
+            String jar = JarManager.findContainingJar(org.apache.pig.Main.class);
+            this.bootStrapJar = new File(jar).getName().toString();
+            remoteFs = FileSystem.get(conf);
+            addBootStrapJar();
+            inited = true;
+        }
     }
 
     // Add files from the source FS as local resources. The resource name will
     // be the same as the file name.
     public Path addTezResource(URL url) throws IOException {
-        Path resourcePath = new Path(url.getFile());
-        String resourceName = resourcePath.getName();
-
-        if (resources.containsKey(resourceName)) {
-            return resources.get(resourceName);
+        synchronized(this) {
+            Path resourcePath = new Path(url.getFile());
+            String resourceName = resourcePath.getName();
+    
+            if (resources.containsKey(resourceName)) {
+                return resources.get(resourceName);
+            }
+    
+            // Ship the resource to the staging directory on the remote FS
+            Path remoteFsPath = remoteFs.makeQualified(new Path(stagingDir, resourceName));
+            remoteFs.copyFromLocalFile(resourcePath, remoteFsPath);
+            resources.put(resourceName, remoteFsPath);
+            return remoteFsPath;
         }
-
-        // Ship the resource to the staging directory on the remote FS
-        Path remoteFsPath = remoteFs.makeQualified(new Path(stagingDir, resourceName));
-        remoteFs.copyFromLocalFile(resourcePath, remoteFsPath);
-        resources.put(resourceName, remoteFsPath);
-        return remoteFsPath;
     }
 
     // Add files already present in the remote FS as local resources. Allow the
@@ -97,20 +111,22 @@ public class TezResourceManager {
     }
 
     public void addBootStrapJar() throws IOException {
-        if (resources.containsKey(bootStrapJar)) {
-            return;
+        synchronized(this) {
+            if (resources.containsKey(bootStrapJar)) {
+                return;
+            }
+    
+            FileSystem remoteFs = FileSystem.get(conf);
+            File jobJar = File.createTempFile("Job", ".jar");
+            jobJar.deleteOnExit();
+            FileOutputStream fos = new FileOutputStream(jobJar);
+            JarManager.createBootStrapJar(fos, pigContext);
+    
+            // Ship the job.jar to the staging directory on the remote FS
+            Path remoteJarPath = remoteFs.makeQualified(new Path(stagingDir, bootStrapJar));
+            remoteFs.copyFromLocalFile(new Path(jobJar.getAbsolutePath()), remoteJarPath);
+            resources.put(bootStrapJar, remoteJarPath);
         }
-
-        FileSystem remoteFs = FileSystem.get(conf);
-        File jobJar = File.createTempFile("Job", ".jar");
-        jobJar.deleteOnExit();
-        FileOutputStream fos = new FileOutputStream(jobJar);
-        JarManager.createBootStrapJar(fos, pigContext);
-
-        // Ship the job.jar to the staging directory on the remote FS
-        Path remoteJarPath = remoteFs.makeQualified(new Path(stagingDir, new Path(bootStrapJar.getFile()).getName()));
-        remoteFs.copyFromLocalFile(new Path(jobJar.getAbsolutePath()), remoteJarPath);
-        resources.put(new Path(bootStrapJar.getFile()).getName(), remoteJarPath);
     }
 
     public Map<String, LocalResource> getTezResources(Set<String> resourceNames) throws Exception {
diff --git a/test/org/apache/pig/tez/TestSecondarySortTez.java b/test/org/apache/pig/tez/TestSecondarySortTez.java
index 991bb44d3..9822fd94c 100644
--- a/test/org/apache/pig/tez/TestSecondarySortTez.java
+++ b/test/org/apache/pig/tez/TestSecondarySortTez.java
@@ -44,7 +44,7 @@ public class TestSecondarySortTez extends TestSecondarySort {
     public SecondaryKeyOptimizer visitSecondaryKeyOptimizer(String query)
             throws Exception, VisitorException {
         PhysicalPlan pp = Util.buildPp(pigServer, query);
-        TezCompiler comp = new TezCompiler(pp, pc, null);
+        TezCompiler comp = new TezCompiler(pp, pc);
         TezOperPlan tezPlan = comp.compile();
         boolean nocombiner = Boolean.parseBoolean(pc.getProperties().getProperty(
                 PigConfiguration.PROP_NO_COMBINER, "false"));
diff --git a/test/org/apache/pig/tez/TestTezCompiler.java b/test/org/apache/pig/tez/TestTezCompiler.java
index 117f75f08..80e4a48e9 100644
--- a/test/org/apache/pig/tez/TestTezCompiler.java
+++ b/test/org/apache/pig/tez/TestTezCompiler.java
@@ -551,7 +551,7 @@ public class TestTezCompiler {
     private void run(String query, String expectedFile) throws Exception {
         PhysicalPlan pp = Util.buildPp(pigServer, query);
         TezLauncher launcher = new TezLauncher();
-        TezPlanContainer tezPlanContainer = launcher.compile(pp, pc, null);
+        TezPlanContainer tezPlanContainer = launcher.compile(pp, pc);
 
         ByteArrayOutputStream baos = new ByteArrayOutputStream();
         PrintStream ps = new PrintStream(baos);
diff --git a/test/org/apache/pig/tez/TestTezJobControlCompiler.java b/test/org/apache/pig/tez/TestTezJobControlCompiler.java
index 54812a520..8dcbef4d8 100644
--- a/test/org/apache/pig/tez/TestTezJobControlCompiler.java
+++ b/test/org/apache/pig/tez/TestTezJobControlCompiler.java
@@ -169,7 +169,7 @@ public class TestTezJobControlCompiler {
 
     private Pair<TezOperPlan, DAG> compile(String query) throws Exception {
         PhysicalPlan pp = Util.buildPp(pigServer, query);
-        TezCompiler comp = new TezCompiler(pp, pc, null);
+        TezCompiler comp = new TezCompiler(pp, pc);
         TezOperPlan tezPlan = comp.compile();
         TezJobControlCompiler jobComp = new TezJobControlCompiler(pc, new Configuration());
         DAG dag = jobComp.buildDAG(tezPlan, new HashMap<String, LocalResource>());
