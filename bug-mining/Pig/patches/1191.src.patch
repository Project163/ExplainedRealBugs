diff --git a/CHANGES.txt b/CHANGES.txt
index f365dc098..aca5f49e1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -28,6 +28,8 @@ PIG-3174:  Remove rpm and deb artifacts from build.xml (gates)
 
 IMPROVEMENTS
 
+PIG-3173: Partition filter push down does not happen when partition keys condition include a AND and OR construct (rohini)
+
 PIG-2786: enhance Pig launcher script wrt. HBase/HCat integration (ndimiduk via daijy)
 
 PIG-3198: Let users use any function from PigType -> PigType as if it were builtlin (jcoveney)
diff --git a/src/org/apache/pig/newplan/PColFilterExtractor.java b/src/org/apache/pig/newplan/PColFilterExtractor.java
index f988b506d..32ba78884 100644
--- a/src/org/apache/pig/newplan/PColFilterExtractor.java
+++ b/src/org/apache/pig/newplan/PColFilterExtractor.java
@@ -177,17 +177,6 @@ public class PColFilterExtractor extends PlanVisitor {
                 + fieldName + ") inside a bincond operator in the " +
                 "filter condition.");
             canPushDown = false;
-            return;
-			}
-			opsToCheckFor.set(0, AndExpression.class);
-			opsToCheckFor.add(OrExpression.class);
-			if(checkSuccessors(project, opsToCheckFor)) {
-            LOG.warn("No partition filter push down: " +
-                "You have an partition column (" + fieldName +
-                " ) in a construction like: " +
-                "(pcond  and ...) or (pcond and ...) " +
-                "where pcond is a condition on a partition column.");
-            canPushDown = false;
             return;
 			}
 		} else {
@@ -200,9 +189,35 @@ public class PColFilterExtractor extends PlanVisitor {
 		boolean rhsSawKey = false;
 		boolean lhsSawNonKeyCol = false;
 		boolean rhsSawNonKeyCol = false;
-
-		sawKey = false;
-		sawNonKeyCol = false;
+        sawKey = false;
+        sawNonKeyCol = false;
+
+        LogicalExpression binLHS = binOp.getLhs();
+        LogicalExpression binRHS = binOp.getRhs();
+        // Take care of nested OR as in
+        // ((cond1 and cond2) or (cond3 and cond4) or (cond5 and cond6)) or (cond7 and cond8)
+        if (binOp instanceof OrExpression &&
+                ((binLHS instanceof AndExpression && binRHS instanceof AndExpression) ||
+                  binLHS instanceof OrExpression || binRHS instanceof OrExpression)) {
+            visit(binLHS);
+            lhsSawNonKeyCol = sawNonKeyCol;
+            this.replaceSide = Side.NONE;
+            visit(binRHS);
+            rhsSawNonKeyCol = sawNonKeyCol;
+            this.replaceSide = Side.NONE;
+            if (lhsSawNonKeyCol || rhsSawNonKeyCol || !canPushDown) {
+                sawKey = false;
+                sawNonKeyCol = true;
+                // Don't set canPushDown to false. If there are other AND
+                // conditions on a partition column we want to push that down
+                LOG.warn("No partition filter push down: You have partition and non-partition "
+                        + "columns  in a construction like: "
+                        + "(pcond and non-pcond ..) or (pcond and non-pcond ...) "
+                        + "where pcond is a condition on a partition column and "
+                        + "non-pcond is a condition on a non-partition column.");
+                return;
+            }
+        }
 		visit( binOp.getLhs() );
 		replaceChild(binOp.getLhs());
 		lhsSawKey = sawKey;
@@ -240,8 +255,6 @@ public class PColFilterExtractor extends PlanVisitor {
 		sawNonKeyCol = lhsSawNonKeyCol || rhsSawNonKeyCol;
 	}
 
-
-
 	/**
 	 * @return the condition on partition columns extracted from filter
 	 */
diff --git a/test/org/apache/pig/test/TestPartitionFilterPushDown.java b/test/org/apache/pig/test/TestPartitionFilterPushDown.java
index b5e2f35f0..b6b26f44e 100644
--- a/test/org/apache/pig/test/TestPartitionFilterPushDown.java
+++ b/test/org/apache/pig/test/TestPartitionFilterPushDown.java
@@ -340,6 +340,98 @@ public class TestPartitionFilterPushDown {
     }
 
     @Test
+    public void testAndORConditionPartitionKeyCol() throws Exception {
+        // Case of AND and OR
+        String q = query + "b = filter a by (srcid == 10 and dstid == 5) " +
+                "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7);" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "dstid"),
+                "((((srcid == 10) and (dstid == 5)) " +
+                "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))",
+                null);
+
+        // Additional filter on non-partition key column
+        q = query +
+                "b = filter a by ((srcid == 10 and dstid == 5) " +
+                "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7)) and mrkt == 'US';" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "dstid"),
+                "((((srcid == 10) and (dstid == 5)) " +
+                "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))",
+                "(mrkt == 'US')");
+
+        // partition key col but null condition which should not become part of
+        // the pushed down filter
+        q = query + "b = filter a by (srcid is null and dstid == 5) " +
+                "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7);" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "dstid"), null);
+
+        // Case of OR and AND
+        q = query +
+                "b = filter a by (mrkt == 'US' or mrkt == 'UK') and (srcid == 11 or srcid == 10);" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "mrkt"),
+                "(((mrkt == 'US') or (mrkt == 'UK')) and ((srcid == 11) or (srcid == 10)))", null);
+        q = query +
+                "b = filter a by (mrkt == 'US' or mrkt == 'UK') and (srcid == 11 or srcid == 10) and dstid == 10;" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "mrkt"),
+                "(((mrkt == 'US') or (mrkt == 'UK')) and ((srcid == 11) or (srcid == 10)))",
+                "(dstid == 10)");
+    }
+
+    @Test
+    public void testAndORConditionMixedCol() throws Exception {
+        // Case of AND and OR with partition key and non-partition key columns
+        String q = query + "b = filter a by (srcid == 10 and dstid == 5) " +
+                "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7) " +
+                "or (srcid == 13 and dstid == 8);" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid"), null,
+                "(((((srcid == 10) and (dstid == 5)) " +
+                "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7))) " +
+                "or ((srcid == 13) and (dstid == 8)))");
+
+        // Additional filter on a partition key column
+        q = query +
+                "b = filter a by ((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) " +
+                "or (srcid == 12 and dstid == 7)) and mrkt == 'US';" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "mrkt"), "(mrkt == 'US')",
+                "((((srcid == 10) and (dstid == 5)) or ((srcid == 11) and (dstid == 6))) " +
+                "or ((srcid == 12) and (dstid == 7)))");
+
+        q = query + "b = filter a by (mrkt == 'US' or mrkt == 'UK') and " +
+                "((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) " +
+                "or (srcid == 12 and dstid == 7));" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid", "mrkt"), "((mrkt == 'US') or (mrkt == 'UK'))",
+                "((((srcid == 10) and (dstid == 5)) or ((srcid == 11) and (dstid == 6))) " +
+                "or ((srcid == 12) and (dstid == 7)))");
+
+        // Additional filter on a non-partition key column
+        q = query +
+                "b = filter a by ((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) " +
+                "or (srcid == 12 and dstid == 7)) and mrkt == 'US';" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid"), null,
+                "(((((srcid == 10) and (dstid == 5)) or ((srcid == 11) and (dstid == 6))) " +
+                "or ((srcid == 12) and (dstid == 7))) and (mrkt == 'US'))");
+
+        // Case of OR and AND
+        q = query +
+                "b = filter a by (mrkt == 'US' or mrkt == 'UK') and " +
+                "(srcid == 11 or srcid == 10) and (dstid == 5 or dstid == 6);" +
+                "store b into 'out';";
+        test(q, Arrays.asList("srcid"),
+                "((srcid == 11) or (srcid == 10))",
+                "(((mrkt == 'US') or (mrkt == 'UK')) and ((dstid == 5) or (dstid == 6)))");
+        test(q, Arrays.asList("mrkt"),
+                "((mrkt == 'US') or (mrkt == 'UK'))",
+                "(((srcid == 11) or (srcid == 10)) and ((dstid == 5) or (dstid == 6)))");
+    }
+
     public void testNegPColConditionWithNonPCol() throws Exception {
         // use of partition column condition and non partition column in
         // same condition should fail
@@ -656,8 +748,8 @@ public class TestPartitionFilterPushDown {
                     pColExtractor.getPColCondition());
         } else  {
             Assert.assertEquals("Checking partition column filter:",
-                    expPartFilterString.toLowerCase(),
-                    pColExtractor.getPColCondition().toString().toLowerCase());
+                    expPartFilterString,
+                    pColExtractor.getPColCondition().toString());
         }
 
         // The getExpression() in PColFilterExtractor was written to get the
@@ -674,7 +766,7 @@ public class TestPartitionFilterPushDown {
                 String actual = pColExtractor
                         .getExpression(
                                 (LogicalExpression) filter.getFilterPlan().getSources().get(0))
-                        .toString().toLowerCase();
+                        .toString();
                 Assert.assertEquals("checking trimmed filter expression:", expFilterString, actual);
             }
         }
