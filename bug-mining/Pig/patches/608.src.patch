diff --git a/CHANGES.txt b/CHANGES.txt
index 572c74cf5..409cca04e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -257,6 +257,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1791: System property mapred.output.compress, but pig-cluster-hadoop-site.xml doesn't (daijy)
+
 PIG-1771: New logical plan: Merge schema fail if LoadFunc.getSchema return different schema with "Load...AS" (daijy)
 
 PIG-1766: New logical plan: ImplicitSplitInserter should before DuplicateForEachColumnRewrite (daijy)
diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index 68ed2bb88..9899a14f9 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -183,16 +183,6 @@ static int run(String args[], PigProgressNotificationListener listener) {
             properties.setProperty("stop.on.failure", ""+false);
         }
         
-        if( "true".equals( properties.getProperty( "mapred.output.compress" ) ) ) {
-            properties.setProperty( "output.compression.enabled",  "true" );
-            String codec = properties.getProperty( "mapred.output.compression.codec" );
-            if( codec == null ) {
-                throw new RuntimeException( "'mapred.output.compress' is set but no value is specified for 'mapred.output.compression.codec'." );
-            } else {
-                properties.setProperty( "output.compression.codec", codec );
-            }
-        }
-        
         // set up client side system properties in UDF context
         UDFContext.getUDFContext().setClientSystemProps();
 
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 0cd8c37d0..03af85496 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -237,6 +237,16 @@ public class PigServer {
             pigContext.connect();
         }
 
+        if( "true".equals( pigContext.getProperties().getProperty( "mapred.output.compress" ) ) ) {
+            pigContext.getProperties().setProperty( "output.compression.enabled",  "true" );
+            String codec = pigContext.getProperties().getProperty( "mapred.output.compression.codec" );
+            if( codec == null ) {
+                throw new RuntimeException( "'mapred.output.compress' is set but no value is specified for 'mapred.output.compression.codec'." );
+            } else {
+                pigContext.getProperties().setProperty( "output.compression.codec", codec );
+            }
+        }
+
         addJarsFromProperties();
     }
 
