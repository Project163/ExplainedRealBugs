diff --git a/CHANGES.txt b/CHANGES.txt
index 1a97e3638..87b960545 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -324,6 +324,8 @@ Release 0.9.2 - Unreleased
 
 BUG FIXES
 
+PIG-2402: inIllustrator condition in PigMapReduce is wrong for hadoop 23 (daijy)
+
 PIG-2370: SkewedParitioner results in Kerberos error (daijy)
 
 PIG-2374: streaming regression with dotNext (daijy)
diff --git a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
index cbbdb0c64..9538149ab 100644
--- a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
+++ b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
@@ -86,6 +86,7 @@ abstract public class PigMapBase extends PigGenericMapBase {
               List<Pair<PigNullableWritable, Writable>> output,
               InputSplit split) throws IOException, InterruptedException {
             super(conf, new TaskAttemptID(), null, null, null, new IllustrateDummyReporter(), split);
+            conf.set("inIllustrator", "true");
             if (output == null)
                 throw new IOException("Null output can not be used");
             this.input = input; this.output = output;
@@ -132,6 +133,6 @@ abstract public class PigMapBase extends PigGenericMapBase {
     
     @Override
     public boolean inIllustrator(Context context) {
-        return (context instanceof WrappedMapper.Context);
+        return ((WrappedMapper.Context)context).getConfiguration().get("inIllustrator")!=null;
     }
 }
