diff --git a/CHANGES.txt b/CHANGES.txt
index 3f0b1cb4a..ba4e9bbb6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -30,6 +30,8 @@ PIG-4333: Split BigData tests into multiple groups (rohini)
  
 BUG FIXES
 
+PIG-2647: Split Combining drops splits with empty getLocations() (tmwoodruff via daijy)
+
 PIG-4294: Enable unit test "TestNestedForeach" for spark (kellyzly via rohini)
 
 PIG-4282: Enable unit test "TestForEachNestedPlan" for spark (kellyzly via rohini) 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java b/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
index 66c049f18..981d21e27 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/util/MapRedUtil.java
@@ -472,28 +472,38 @@ public class MapRedUtil {
                 result.add(combinedSplits);
                 resultLengths.add(split.getLength());
             } else {
-                ComparableSplit csplit = new ComparableSplit(split, comparableSplitId++);
                 String[] locations = split.getLocations();
-                // sort the locations to stabilize the number of maps: PIG-1757
-                Arrays.sort(locations);
-                HashSet<String> locationSeen = new HashSet<String>();
-                for (String location : locations)
-                {
-                    if (!locationSeen.contains(location))
+                if (locations.length == 0) {
+                    // This split is missing blocks, or the split returned bad locations.
+                    // Don't try to combine.
+                    comparableSplitId++;
+                    ArrayList<InputSplit> combinedSplits = new ArrayList<InputSplit>();
+                    combinedSplits.add(split);
+                    result.add(combinedSplits);
+                    resultLengths.add(split.getLength());
+                } else {
+                    ComparableSplit csplit = new ComparableSplit(split, comparableSplitId++);
+                    // sort the locations to stabilize the number of maps: PIG-1757
+                    Arrays.sort(locations);
+                    HashSet<String> locationSeen = new HashSet<String>();
+                    for (String location : locations)
                     {
-                        Node node = nodeMap.get(location);
-                        if (node == null) {
-                            node = new Node();
-                            nodes.add(node);
-                            nodeMap.put(location, node);
+                        if (!locationSeen.contains(location))
+                        {
+                            Node node = nodeMap.get(location);
+                            if (node == null) {
+                                node = new Node();
+                                nodes.add(node);
+                                nodeMap.put(location, node);
+                            }
+                            node.add(csplit);
+                            csplit.add(node);
+                            locationSeen.add(location);
                         }
-                        node.add(csplit);
-                        csplit.add(node);
-                        locationSeen.add(location);
                     }
+                    lastSplit = split;
+                    size++;
                 }
-                lastSplit = split;
-                size++;
             }
         }
         /* verification code: debug purpose
