diff --git a/CHANGES.txt b/CHANGES.txt
index aa67c1695..ba016d771 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -102,6 +102,8 @@ PIG-3480: TFile-based tmpfile compression crashes in some cases (dvryaboy via an
 
 BUG FIXES
 
+PIG-3570: Rollback PIG-3060 (daijy)
+
 PIG-3530: Some e2e tests is broken due to PIG-3480 (daijy)
 
 PIG-3492: ColumnPrune dropping used column due to LogicalRelationalOperator.fixDuplicateUids changes not propagating (knoguchi via daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
index eb9f62aaf..2fae7f8e3 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
@@ -441,12 +441,12 @@ public class POForEach extends PhysicalOperator {
                         if(its[i].hasNext()) {
                             data[i] = its[i].next();
                         } else {
-                            //the input set is null, so we return with EOP.  This is
+                            //the input set is null, so we return.  This is
                             // caught above and this function recalled with
                             // new inputs.
                             its = null;
                             data = null;
-                            res.returnStatus = POStatus.STATUS_EOP;
+                            res.returnStatus = POStatus.STATUS_NULL;
                             return res;
                         }
                     } else {
diff --git a/src/org/apache/pig/data/DefaultAbstractBag.java b/src/org/apache/pig/data/DefaultAbstractBag.java
index 35fe59832..5e9c4fc7a 100644
--- a/src/org/apache/pig/data/DefaultAbstractBag.java
+++ b/src/org/apache/pig/data/DefaultAbstractBag.java
@@ -97,7 +97,7 @@ public abstract class DefaultAbstractBag implements DataBag {
             }
             for (int i = sampled; iter.hasNext() && sampled < SPILL_SAMPLE_SIZE; i++) {
                 Tuple t = iter.next();
-                if (i % SPILL_SAMPLE_FREQUENCY == 0) {
+                if (t != null && i % SPILL_SAMPLE_FREQUENCY == 0) {
                     aggSampleTupleSize += t.getMemorySize();
                     sampled += 1;
                 }
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index 86cc4cdaf..d7e3d30f0 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1171,6 +1171,36 @@ public class TestEvalPipelineLocal {
         Assert.assertTrue(results.contains(iter.next().toString()));
         Assert.assertTrue(results.contains(iter.next().toString()));
         
+        Assert.assertFalse(iter.hasNext());
+    }
+    static public class GenBag extends EvalFunc<DataBag> {
+        @Override
+        public DataBag exec(Tuple input) throws IOException {
+            Integer content = (Integer)input.get(0);
+            DataBag bag = BagFactory.getInstance().newDefaultBag();
+
+            if (content > 10) {
+                Tuple t = TupleFactory.getInstance().newTuple();
+                t.append(content);
+                bag.add(t);
+            }
+            return bag;
+        }
+    }
+    // Two flatten statement in a pipeline, see PIG-3292
+    @Test
+    public void testFlattenTwice() throws Exception{
+        File f1 = createFile(new String[]{"{(1),(12),(9)}", "{(15),(2)}"});
+        
+        pigServer.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(f1.toString(), pigServer.getPigContext()))
+                + "' as (bag1:bag{(t:int)});");
+        pigServer.registerQuery("b = foreach a generate flatten(bag1) as field1;");
+        pigServer.registerQuery("c = foreach b generate flatten(" + GenBag.class.getName() + "(field1));");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("c");
+        Assert.assertEquals(iter.next().toString(), "(12)");
+        Assert.assertEquals(iter.next().toString(), "(15)");
+        
         Assert.assertFalse(iter.hasNext());
     }
 }
