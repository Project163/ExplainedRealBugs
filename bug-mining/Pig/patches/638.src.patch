diff --git a/CHANGES.txt b/CHANGES.txt
index feffe3a10..1d9bc5cbc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -102,6 +102,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1779: Wrong stats shown when there are multiple loads but same file names (rding)
+
 PIG-1861: The pig script stored in the Hadoop History logs is stored as a concatenated string without whitespace this causes problems when attempting to extract and execute the script (rding)
 
 PIG-1829: "0" value seen in PigStat's map/reduce runtime, even when the job is successful (rding)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigRecordReader.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigRecordReader.java
index 999430a3d..592f58d96 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigRecordReader.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigRecordReader.java
@@ -199,7 +199,7 @@ public class PigRecordReader extends RecordReader<Text, Tuple> {
             (ArrayList<FileSpec>) ObjectSerializer.deserialize(
                     conf.get(PigInputFormat.PIG_INPUTS));
         String fname = inputs.get(pigSplit.getInputIndex()).getFileName();
-        return PigStatsUtil.getMultiInputsCounterName(fname);
+        return PigStatsUtil.getMultiInputsCounterName(fname, pigSplit.getInputIndex());
     }
     
     /**
diff --git a/src/org/apache/pig/tools/pigstats/JobStats.java b/src/org/apache/pig/tools/pigstats/JobStats.java
index ee21c4067..fdd7d1e4a 100644
--- a/src/org/apache/pig/tools/pigstats/JobStats.java
+++ b/src/org/apache/pig/tools/pigstats/JobStats.java
@@ -517,32 +517,20 @@ public final class JobStats extends Operator {
                 inputs.add(is);                
             }
         } else {
-            // check for self-join (duplicated input file names)
-            HashMap<String, Integer> dupmap = new HashMap<String, Integer>();
-            for (FileSpec fsp : loads) {
-                String name = PigStatsUtil.getMultiInputsCounterName(fsp.getFileName());
-                if (name == null) continue;
-                if (dupmap.containsKey(name)) {
-                    int n = dupmap.get(name);
-                    dupmap.put(name, (n+1));
-                } else {
-                    dupmap.put(name, 1);
-                }                
-            }
-            for (FileSpec fsp : loads) {
+            for (int i=0; i<loads.size(); i++) {
+                FileSpec fsp = loads.get(i);
                 if (PigStatsUtil.isTempFile(fsp.getFileName())) continue;
-                addOneInputStats(fsp.getFileName(), dupmap);
+                addOneInputStats(fsp.getFileName(), i);
             }
         }            
     }
     
-    private void addOneInputStats(String fileName, Map<String, Integer> dupmap) {
+    private void addOneInputStats(String fileName, int index) {
         long records = -1;
         Long n = multiInputCounters.get(
-                PigStatsUtil.getMultiInputsCounterName(fileName));
-        if (n != null) {
-            Integer m = dupmap.get(PigStatsUtil.getMultiInputsCounterName(fileName));            
-            records = (m != null && m > 0) ? (n / m) : n;
+                PigStatsUtil.getMultiInputsCounterName(fileName, index));
+        if (n != null) {   
+            records = n;
         } else {
             LOG.warn("unable to get input counter for " + fileName);
         }
diff --git a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
index 66ffcdfee..6b5a50ba0 100644
--- a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
+++ b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
@@ -119,10 +119,10 @@ public abstract class PigStatsUtil {
      * @param fname the input file name
      * @return the counter name
      */
-    public static String getMultiInputsCounterName(String fname) {
+    public static String getMultiInputsCounterName(String fname, int index) {
         String shortName = getShortName(fname);            
         return (shortName == null) ? null 
-                : MULTI_INPUTS_RECORD_COUNTER + shortName;
+                : MULTI_INPUTS_RECORD_COUNTER + "_" + index + "_" + shortName;
     }
     
     private static final String SEPARATOR = "/";
diff --git a/test/org/apache/pig/test/TestPigRunner.java b/test/org/apache/pig/test/TestPigRunner.java
index a1537eadc..ca1d794db 100644
--- a/test/org/apache/pig/test/TestPigRunner.java
+++ b/test/org/apache/pig/test/TestPigRunner.java
@@ -422,14 +422,14 @@ public class TestPigRunner {
     @Test
     public void testCounterName() throws Exception {
         String s = "jdbc:hsqldb:file:/tmp/batchtest;hsqldb.default_table_type=cached;hsqldb.cache_rows=100";
-        String name = PigStatsUtil.getMultiInputsCounterName(s);
-        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "batchtest", name);
+        String name = PigStatsUtil.getMultiInputsCounterName(s, 0);
+        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_0_batchtest", name);
         s = "file:///tmp/batchtest{1,2}.txt";
-        name = PigStatsUtil.getMultiInputsCounterName(s);
-        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "batchtest{1,2}.txt", name);
+        name = PigStatsUtil.getMultiInputsCounterName(s, 1);
+        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_1_batchtest{1,2}.txt", name);
         s = "file:///tmp/batchtest*.txt";
-        name = PigStatsUtil.getMultiInputsCounterName(s);
-        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "batchtest*.txt", name);
+        name = PigStatsUtil.getMultiInputsCounterName(s, 2);
+        assertEquals(PigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_2_batchtest*.txt", name);
     }
     
     @Test
@@ -470,6 +470,45 @@ public class TestPigRunner {
         }
     }
     
+    @Test
+    public void testDuplicateCounterName() throws Exception {
+        // Pig now restricts the string size of its counter name to less than 64 characters.
+        PrintWriter w = new PrintWriter(new FileWriter("myinputfile"));
+        w.println("1\t2\t3");
+        w.println("5\t3\t4");
+        w.close();
+        String samefilename = "tmp/input";
+        Util.copyFromLocalToCluster(cluster, "myinputfile", samefilename);
+        
+        PrintWriter w1 = new PrintWriter(new FileWriter(PIG_FILE));
+        w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
+        w1.println("B = load '" + samefilename + "' as (a0:int, a1:int, a2:int);");
+        w1.println("C = join A by a0, B by a0;");
+        w1.println("store C into '" + OUTPUT_FILE + "';");
+        w1.close();
+        
+        try {
+            String[] args = { PIG_FILE };
+            PigStats stats = PigRunner.run(args, new TestNotificationListener());
+     
+            assertTrue(stats.isSuccessful());
+            
+            assertEquals(1, stats.getNumberJobs());
+            List<InputStats> inputs = stats.getInputStats();
+            assertEquals(2, inputs.size());
+            for (InputStats instats : inputs) {
+                if (instats.getLocation().endsWith("tmp/input")) {
+                    assertEquals(2, instats.getNumberRecords());
+                } else {
+                    assertEquals(5, instats.getNumberRecords());
+                }
+            }
+        } finally {
+            new File(PIG_FILE).delete();
+            Util.deleteFile(cluster, OUTPUT_FILE);
+        }
+    }
+    
     @Test
     public void testRegisterExternalJar() throws Exception {
         String[] args = { "-Dpig.additional.jars=pig-withouthadoop.jar",
