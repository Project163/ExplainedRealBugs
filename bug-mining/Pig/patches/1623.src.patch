diff --git a/CHANGES.txt b/CHANGES.txt
index ddd6906ed..c5a4984f6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -112,6 +112,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4257: Fix several e2e tests on secure cluster (daijy)
+
 PIG-4261: Skip shipping local resources in tez local mode (daijy)
 
 PIG-4182: e2e tests Scripting_[1-12] fail on Windows (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java b/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
index 639a54b32..43311ba22 100644
--- a/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
+++ b/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
@@ -79,7 +79,11 @@ public class ConfigurationUtil {
             localConf = new Configuration(false);
             localConf.addResource("core-default.xml");
         } else {
-            localConf = new Configuration(true);
+            if (PigMapReduce.sJobContext!=null) {
+                localConf = PigMapReduce.sJobContext.getConfiguration();
+            } else {
+                localConf = new Configuration(true);
+            }
             // It's really hacky, try to get unit test working under hadoop 23.
             // Hadoop23 MiniMRCluster currently need setup Distributed cache before start,
             // so build/classes/hadoop-site.xml contains such entry. This prevents some tests from
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
index c31385cc8..06f1aeb3f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
@@ -31,6 +31,7 @@ import org.apache.hadoop.io.Writable;
 import org.apache.hadoop.mapreduce.Partitioner;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.HDataType;
+import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce;
 import org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil;
 import org.apache.pig.data.DataBag;
@@ -109,7 +110,7 @@ public class WeightedRangePartitioner extends Partitioner<PigNullableWritable, W
             Map<String, Object> quantileMap = null;
             Configuration conf;
             if (!pigContext.getExecType().isLocal()) {
-                conf = new Configuration(true);
+                conf = ConfigurationUtil.toConfiguration(pigContext.getProperties());
             } else {
                 conf = new Configuration(false);
             }
diff --git a/test/org/apache/pig/test/TestMapSideCogroup.java b/test/org/apache/pig/test/TestMapSideCogroup.java
index 060b88a4f..2c78b4a81 100644
--- a/test/org/apache/pig/test/TestMapSideCogroup.java
+++ b/test/org/apache/pig/test/TestMapSideCogroup.java
@@ -479,7 +479,7 @@ public class TestMapSideCogroup {
 
         @Override
         public void initialize(Configuration conf) throws IOException {
-            is = FileSystem.get(conf).open(new Path(loc));
+            is = FileSystem.get(new Path(loc).toUri(), conf).open(new Path(loc));
         }
 
         @Override
