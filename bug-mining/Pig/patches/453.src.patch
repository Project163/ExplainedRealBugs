diff --git a/CHANGES.txt b/CHANGES.txt
index 88d79fd8f..cb97ad674 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -86,6 +86,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1221: Filter equality does not work for tuples (zjffdu)
+
 PIG-1456: TestMultiQuery takes a long time to run (rding)
 
 PIG-1457: Pig will run complete zebra test even we give -Dtestcase=xxx (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/EqualToExpr.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/EqualToExpr.java
index dc0490c34..27ed86a2c 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/EqualToExpr.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/EqualToExpr.java
@@ -17,6 +17,8 @@
  */
 package org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators;
 
+import java.util.HashMap;
+
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -124,7 +126,26 @@ public class EqualToExpr extends BinaryComparisonOperator {
             return doComparison(left, right);
                             }
 
-
+        case DataType.TUPLE: {
+            Result r = accumChild(null, dummyTuple);
+            if (r != null) {
+                return r;
+            }
+            left = lhs.getNext(dummyTuple);
+            right = rhs.getNext(dummyTuple);
+            return doComparison(left, right);
+                            }
+        
+        case DataType.MAP: {
+            Result r = accumChild(null, dummyMap);
+            if (r != null) {
+                return r;
+            }
+            left = lhs.getNext(dummyMap);
+            right = rhs.getNext(dummyMap);
+            return doComparison(left, right);
+                            }
+            
         default: {
             int errCode = 2067;
             String msg = this.getClass().getSimpleName() + " does not know how to " +
@@ -136,7 +157,7 @@ public class EqualToExpr extends BinaryComparisonOperator {
     }
 
     @SuppressWarnings("unchecked")
-    private Result doComparison(Result left, Result right) {
+    private Result doComparison(Result left, Result right) throws ExecException {
         if (trueRef == null) initializeRefs();
         if (left.returnStatus != POStatus.STATUS_OK) return left;
         if (right.returnStatus != POStatus.STATUS_OK) return right;
@@ -147,13 +168,24 @@ public class EqualToExpr extends BinaryComparisonOperator {
             left.returnStatus = POStatus.STATUS_NULL;
             return left;
         }
-        assert(left instanceof Comparable);
-        assert(right instanceof Comparable);
-        if (((Comparable)left.result).compareTo((Comparable)right.result) == 0) {
-            left.result = trueRef;
-        } else {
-            left.result = falseRef;
+        
+        if (left.result instanceof Comparable && right.result instanceof Comparable){
+            if (((Comparable)left.result).compareTo((Comparable)right.result) == 0) {
+                left.result = trueRef;
+            } else {
+                left.result = falseRef;
+            }
+        }else if (left.result instanceof HashMap && right.result instanceof HashMap){
+            HashMap leftMap=(HashMap)left.result;
+            HashMap rightMap=(HashMap)right.result;
+            if (leftMap.equals(rightMap))
+                left.result = trueRef;
+            else
+                left.result = falseRef;
+        }else{
+            throw new ExecException("The left side and right side has the different types");
         }
+        
         return left;
     }
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/NotEqualToExpr.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/NotEqualToExpr.java
index 3ceb6ef69..0d349722a 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/NotEqualToExpr.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/NotEqualToExpr.java
@@ -17,6 +17,8 @@
  */
 package org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators;
 
+import java.util.HashMap;
+
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -123,7 +125,25 @@ public class NotEqualToExpr extends BinaryComparisonOperator {
             right = rhs.getNext(dummyString);
             return doComparison(left, right);
                             }
-
+        case DataType.TUPLE: {
+            Result r = accumChild(null, dummyTuple);
+            if (r != null) {
+                return r;
+            }
+            left = lhs.getNext(dummyTuple);
+            right = rhs.getNext(dummyTuple);
+            return doComparison(left, right);
+                            }
+        
+        case DataType.MAP: {
+            Result r = accumChild(null, dummyMap);
+            if (r != null) {
+                return r;
+            }
+            left = lhs.getNext(dummyMap);
+            right = rhs.getNext(dummyMap);
+            return doComparison(left, right);
+                            }
 
         default: {
             int errCode = 2067;
@@ -136,7 +156,7 @@ public class NotEqualToExpr extends BinaryComparisonOperator {
     }
 
     @SuppressWarnings("unchecked")
-    private Result doComparison(Result left, Result right) {
+    private Result doComparison(Result left, Result right) throws ExecException {
         if (trueRef == null) initializeRefs();
         if (left.returnStatus != POStatus.STATUS_OK) return left;
         if (right.returnStatus != POStatus.STATUS_OK) return right;
@@ -147,12 +167,22 @@ public class NotEqualToExpr extends BinaryComparisonOperator {
             left.returnStatus = POStatus.STATUS_NULL;
             return left;
         }
-        assert(left instanceof Comparable);
-        assert(right instanceof Comparable);
-        if (((Comparable)left.result).compareTo((Comparable)right.result) != 0) {
-            left.result = trueRef;
-        } else {
-            left.result = falseRef;
+        
+        if (left.result instanceof Comparable && right.result instanceof Comparable){
+            if (((Comparable)left.result).compareTo((Comparable)right.result) != 0) {
+                left.result = trueRef;
+            } else {
+                left.result = falseRef;
+            }
+        }else if (left.result instanceof HashMap && right.result instanceof HashMap){
+            HashMap leftMap=(HashMap)left.result;
+            HashMap rightMap=(HashMap)right.result;
+            if (leftMap.equals(rightMap))
+                left.result = falseRef;
+            else
+                left.result = trueRef;
+        }else{
+            throw new ExecException("The left side and right side has the different types");
         }
         return left;
     }
diff --git a/test/org/apache/pig/test/TestEqualTo.java b/test/org/apache/pig/test/TestEqualTo.java
index 34e53e169..7dc3c270f 100644
--- a/test/org/apache/pig/test/TestEqualTo.java
+++ b/test/org/apache/pig/test/TestEqualTo.java
@@ -17,6 +17,7 @@
  */
 package org.apache.pig.test;
 
+import java.util.HashMap;
 import java.util.Map;
 import java.util.Random;
 
@@ -25,6 +26,7 @@ import org.apache.pig.data.DataBag;
 import org.apache.pig.data.DataByteArray;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
+import org.apache.pig.data.TupleFactory;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.POStatus;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.ConstantExpression;
@@ -270,6 +272,81 @@ public class TestEqualTo extends junit.framework.TestCase {
         assertTrue((Boolean)r.result);
     }
     
+    @Test
+    public void testTupleEq() throws ExecException{
+        Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_1");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(tuple_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(tuple_2);
+        EqualToExpr g = GenPhyOp.compEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.TUPLE);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertTrue((Boolean)r.result);
+    }
+    
+    @Test
+    public void testTupleNe() throws ExecException{
+        Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(tuple_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(tuple_2);
+        EqualToExpr g = GenPhyOp.compEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.TUPLE);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertFalse((Boolean)r.result);
+    }
+    
+    @Test
+    public void testMapEq() throws ExecException{
+        Map map_1=new HashMap();
+        map_1.put("key_1", "value_1");
+        Map map_2=new HashMap();
+        map_2.put("key_1", "value_1");
+        
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(map_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(map_2);
+        EqualToExpr g = GenPhyOp.compEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.MAP);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertTrue((Boolean)r.result);
+    }
+    
+    @Test
+    public void testMapNe() throws ExecException{
+        Map map_1=new HashMap();
+        map_1.put("key_1", "value_1");
+        Map map_2=new HashMap();
+        map_2.put("key_1", "value_2");
+        
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(map_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(map_2);
+        EqualToExpr g = GenPhyOp.compEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.MAP);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertFalse((Boolean)r.result);
+    }
+    
 	@Test
 	public void testDataByteArrayAndNullValues() throws Exception {
 	    checkNullValues(   DataType.BYTEARRAY,  new DataByteArray("b") );
diff --git a/test/org/apache/pig/test/TestNotEqualTo.java b/test/org/apache/pig/test/TestNotEqualTo.java
index 0c512020e..4e39a9bc6 100644
--- a/test/org/apache/pig/test/TestNotEqualTo.java
+++ b/test/org/apache/pig/test/TestNotEqualTo.java
@@ -17,6 +17,7 @@
  */
 package org.apache.pig.test;
 
+import java.util.HashMap;
 import java.util.Map;
 import java.util.Random;
 
@@ -25,9 +26,11 @@ import org.apache.pig.data.DataBag;
 import org.apache.pig.data.DataByteArray;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
+import org.apache.pig.data.TupleFactory;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.POStatus;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.ConstantExpression;
+import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.EqualToExpr;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.NotEqualToExpr;
 import org.apache.pig.test.utils.GenPhyOp;
 import org.apache.pig.test.utils.GenRandomData;
@@ -260,7 +263,81 @@ public class TestNotEqualTo extends junit.framework.TestCase {
         assertFalse((Boolean)r.result);
     }
     
-
+    @Test
+    public void testTupleEq() throws ExecException{
+        Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_1");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(tuple_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(tuple_2);
+        NotEqualToExpr g = GenPhyOp.compNotEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.TUPLE);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertFalse((Boolean)r.result);
+    }
+    
+    @Test
+    public void testTupleNe() throws ExecException{
+        Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(tuple_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(tuple_2);
+        NotEqualToExpr g = GenPhyOp.compNotEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.TUPLE);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertTrue((Boolean)r.result);
+    }
+    
+    @Test
+    public void testMapEq() throws ExecException{
+        Map map_1=new HashMap();
+        map_1.put("key_1", "value_1");
+        Map map_2=new HashMap();
+        map_2.put("key_1", "value_1");
+        
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(map_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(map_2);
+        NotEqualToExpr g = GenPhyOp.compNotEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.MAP);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertFalse((Boolean)r.result);
+    }
+    
+    @Test
+    public void testMapNe() throws ExecException{
+        Map map_1=new HashMap();
+        map_1.put("key_1", "value_1");
+        Map map_2=new HashMap();
+        map_2.put("key_1", "value_2");
+        
+        Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
+        ConstantExpression lt = GenPhyOp.exprConst();
+        lt.setValue(map_1);
+        ConstantExpression rt = GenPhyOp.exprConst();
+        rt.setValue(map_2);
+        NotEqualToExpr g = GenPhyOp.compNotEqualToExpr();
+        g.setLhs(lt);
+        g.setRhs(rt);
+        g.setOperandType(DataType.MAP);
+        Result r = g.getNext(new Boolean(true));
+        assertEquals(POStatus.STATUS_OK, r.returnStatus);
+        assertTrue((Boolean)r.result);
+    }
+    
     @Test
     public void testDataByteArrayAndNullValues() throws Exception {
     	
