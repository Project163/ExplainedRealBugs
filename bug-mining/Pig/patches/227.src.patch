diff --git a/CHANGES.txt b/CHANGES.txt
index 6d495b27b..0cdb92b38 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -46,6 +46,8 @@ PIG-792: skew join implementation (sriranjan via olgan)
 
 BUG FIXES
     
+    PIG-905: TOKENIZE throws exception on null data (daijy)
+
     PIG-901: InputSplit (SliceWrapper) created by Pig is big in size due to
     serialized PigContext (pradeepkth)
 
diff --git a/src/org/apache/pig/builtin/TOKENIZE.java b/src/org/apache/pig/builtin/TOKENIZE.java
index c73b7d80d..e988c7ab4 100644
--- a/src/org/apache/pig/builtin/TOKENIZE.java
+++ b/src/org/apache/pig/builtin/TOKENIZE.java
@@ -18,6 +18,8 @@
 package org.apache.pig.builtin;
 
 import java.io.IOException;
+import java.util.ArrayList;
+import java.util.List;
 import java.util.StringTokenizer;
 
 import org.apache.pig.EvalFunc;
@@ -30,7 +32,7 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
-
+import org.apache.pig.FuncSpec;
 
 public class TOKENIZE extends EvalFunc<DataBag> {
     TupleFactory mTupleFactory = TupleFactory.getInstance();
@@ -39,8 +41,14 @@ public class TOKENIZE extends EvalFunc<DataBag> {
     @Override
     public DataBag exec(Tuple input) throws IOException {
         try {
-            DataBag output = mBagFactory.newDefaultBag();
+            if (input==null)
+                return null;
+            if (input.size()==0)
+                return null;
             Object o = input.get(0);
+            if (o==null)
+                return null;
+            DataBag output = mBagFactory.newDefaultBag();
             if (!(o instanceof String)) {
             	int errCode = 2114;
             	String msg = "Expected input to be chararray, but" +
@@ -86,5 +94,11 @@ public class TOKENIZE extends EvalFunc<DataBag> {
         }   
     }
 
-    
+    public List<FuncSpec> getArgToFuncMapping() throws FrontendException {
+        List<FuncSpec> funcList = new ArrayList<FuncSpec>();
+        Schema s = new Schema();
+        s.add(new Schema.FieldSchema(null, DataType.CHARARRAY));
+        funcList.add(new FuncSpec(this.getClass().getName(), s));
+        return funcList;
+    }
 };
diff --git a/test/org/apache/pig/test/TestBuiltin.java b/test/org/apache/pig/test/TestBuiltin.java
index 9830f3bfd..4f1c1890a 100644
--- a/test/org/apache/pig/test/TestBuiltin.java
+++ b/test/org/apache/pig/test/TestBuiltin.java
@@ -1355,6 +1355,33 @@ public class TestBuiltin extends TestCase {
         
         assertTrue(f1.equals(f2));        
     }
+    
+    @Test
+    public void testTOKENIZE() throws Exception {
+        TupleFactory tf = TupleFactory.getInstance();
+        Tuple t1 = tf.newTuple(1);
+        t1.set(0, "123 456\"789");
+        Tuple t2 = tf.newTuple(1);
+        t2.set(0, null);
+        Tuple t3 = tf.newTuple(0);
+        
+        TOKENIZE f = new TOKENIZE();
+        DataBag b = f.exec(t1);
+        assertTrue(b.size()==3);
+        Iterator<Tuple> i = b.iterator();
+        Tuple rt = i.next();
+        assertTrue(rt.get(0).equals("123"));
+        rt = i.next();
+        assertTrue(rt.get(0).equals("456"));
+        rt = i.next();
+        assertTrue(rt.get(0).equals("789"));
+        
+        b = f.exec(t2);
+        assertTrue(b==null);
+        
+        b = f.exec(t3);
+        assertTrue(b==null);
+    }
 
     @Test
     public void testDIFF() throws Exception {
diff --git a/test/org/apache/pig/test/TestPigContext.java b/test/org/apache/pig/test/TestPigContext.java
index e3d717766..6d263b030 100644
--- a/test/org/apache/pig/test/TestPigContext.java
+++ b/test/org/apache/pig/test/TestPigContext.java
@@ -213,7 +213,7 @@ public class TestPigContext extends TestCase {
     private List<String> getCommands() {
         List<String> commands = new ArrayList<String>();
         commands.add("my_input = LOAD '" + Util.encodeEscape(input.getAbsolutePath()) + "' USING PigStorage();");
-        commands.add("words = FOREACH my_input GENERATE FLATTEN(TOKENIZE(*));");
+        commands.add("words = FOREACH my_input GENERATE FLATTEN(TOKENIZE($0));");
         commands.add("grouped = GROUP words BY $0;");
         commands.add("counts = FOREACH grouped GENERATE group, COUNT(words);");
         return commands;
