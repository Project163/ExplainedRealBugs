diff --git a/CHANGES.txt b/CHANGES.txt
index 0f2a89bd0..32ef5a321 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -40,6 +40,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4033: Fix MergeSparseJoin e2e tests on tez (daijy)
+
 PIG-3478: Make StreamingUDF work for Hadoop 2 (lbendig via daijy)
 
 PIG-4032: BloomFilter fails with s3 path in Hadoop 2.4 (cheolsoo)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/IndexedStorage.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/IndexedStorage.java
index a64e93744..b2096fb08 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/IndexedStorage.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/IndexedStorage.java
@@ -279,7 +279,7 @@ public class IndexedStorage extends PigStorage implements IndexableLoadFunc {
 	public void initialize(Configuration conf) throws IOException {
 		try {
 			InputFormat inputFormat = this.getInputFormat();
-			TaskAttemptID id = TaskAttemptID.forName(conf.get("mapred.task.id"));
+			TaskAttemptID id = HadoopShims.getNewTaskAttemptID();
 			
 			if (System.getenv("HADOOP_TOKEN_FILE_LOCATION") != null) {
 		                conf.set("mapreduce.job.credentials.binary", System.getenv("HADOOP_TOKEN_FILE_LOCATION"));
