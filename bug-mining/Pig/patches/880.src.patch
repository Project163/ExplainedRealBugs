diff --git a/CHANGES.txt b/CHANGES.txt
index 1ecaef89d..d72d750aa 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -24,6 +24,8 @@ INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
 
+PIG-2267: Make the name of the columns in schema optional (jcoveney via daijy)
+
 PIG-2453: Fetching schema can be very slow for multi-thousand file LOADs (dvryaboy)
 
 PIG-2443: [Piggybank] Add UDFs to check if a String is an Integer And if a String is Numeric (prkommireddi via daijy)
diff --git a/src/org/apache/pig/impl/util/NumValCarrier.java b/src/org/apache/pig/impl/util/NumValCarrier.java
new file mode 100644
index 000000000..6387813cf
--- /dev/null
+++ b/src/org/apache/pig/impl/util/NumValCarrier.java
@@ -0,0 +1,64 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pig.impl.util;
+
+import java.util.Map;
+import java.util.HashMap;
+
+import org.apache.pig.data.DataType;
+
+public class NumValCarrier {
+    private Map<Byte,ValCarrier> byteToStr = new HashMap<Byte,ValCarrier>(10);
+
+    public NumValCarrier() {
+        ValCarrier valCarrier = new ValCarrier("val");
+        ValCarrier bagCarrier = new ValCarrier("bag");
+        ValCarrier tupleCarrier = new ValCarrier("tuple");
+        ValCarrier mapCarrier = new ValCarrier("map");
+        ValCarrier nullCarrier = new ValCarrier("null");
+
+        byteToStr.put(DataType.BAG,bagCarrier);
+        byteToStr.put(DataType.CHARARRAY,valCarrier);
+        byteToStr.put(DataType.BYTEARRAY,valCarrier);
+        byteToStr.put(DataType.DOUBLE,valCarrier);
+        byteToStr.put(DataType.FLOAT,valCarrier);
+        byteToStr.put(DataType.INTEGER,valCarrier);
+        byteToStr.put(DataType.LONG,valCarrier);
+        byteToStr.put(DataType.MAP,mapCarrier);
+        byteToStr.put(DataType.TUPLE,tupleCarrier);
+        byteToStr.put(DataType.NULL,nullCarrier);
+    }
+
+    public String makeNameFromDataType(byte type) {
+        return byteToStr.get(type).getNextString();
+    }
+
+    private static class ValCarrier {
+        private int num=0;
+        private String str;
+
+        public ValCarrier(String str) {
+            this.str=str;
+        }
+
+        public String getNextString() {
+            return str+"_"+num++;
+        }
+    }
+}
diff --git a/src/org/apache/pig/parser/AliasMasker.g b/src/org/apache/pig/parser/AliasMasker.g
index 470404d00..d7db162cf 100644
--- a/src/org/apache/pig/parser/AliasMasker.g
+++ b/src/org/apache/pig/parser/AliasMasker.g
@@ -191,6 +191,7 @@ field_def
 		}
 	}
 }
+    | ^( FIELD_DEF_WITHOUT_IDENTIFIER type )
 ;
 
 field_def_list
diff --git a/src/org/apache/pig/parser/AstPrinter.g b/src/org/apache/pig/parser/AstPrinter.g
index 6a43461dc..fa4d6aafe 100644
--- a/src/org/apache/pig/parser/AstPrinter.g
+++ b/src/org/apache/pig/parser/AstPrinter.g
@@ -151,6 +151,7 @@ as_clause
 
 field_def
     : ^( FIELD_DEF IDENTIFIER { sb.append($IDENTIFIER.text); }  ( {sb.append(":"); }  type)? )
+    | ^( FIELD_DEF type )
 ;
 
 field_def_list
diff --git a/src/org/apache/pig/parser/AstValidator.g b/src/org/apache/pig/parser/AstValidator.g
index 67f674806..be313c4c7 100644
--- a/src/org/apache/pig/parser/AstValidator.g
+++ b/src/org/apache/pig/parser/AstValidator.g
@@ -35,6 +35,9 @@ options {
 @header {
 package org.apache.pig.parser;
 
+import org.apache.pig.data.DataType;
+import org.apache.pig.impl.util.NumValCarrier;
+
 import java.util.HashSet;
 import java.util.Set;
 
@@ -186,24 +189,38 @@ filename : QUOTEDSTRING
 as_clause: ^( AS field_def_list )
 ;
 
-field_def[Set<String> fieldNames] throws DuplicatedSchemaAliasException
+field_def[Set<String> fieldNames, NumValCarrier nvc] throws DuplicatedSchemaAliasException
  : ^( FIELD_DEF IDENTIFIER { validateSchemaAliasName( fieldNames, $IDENTIFIER, $IDENTIFIER.text ); } type? )
+ | ^( FIELD_DEF_WITHOUT_IDENTIFIER type { validateSchemaAliasName ( fieldNames, $FIELD_DEF_WITHOUT_IDENTIFIER, $nvc.makeNameFromDataType ( $type.typev ) ); } )
 ;
 
 field_def_list throws DuplicatedSchemaAliasException
 scope{
     Set<String> fieldNames;
+    NumValCarrier nvc;
 }
 @init {
     $field_def_list::fieldNames = new HashSet<String>();
+    $field_def_list::nvc = new NumValCarrier();
 }
- : ( field_def[$field_def_list::fieldNames] )+
+ : ( field_def[$field_def_list::fieldNames, $field_def_list::nvc] )+
 ;
 
-type : simple_type | tuple_type | bag_type | map_type
+type returns [byte typev]
+  : simple_type { $typev = $simple_type.typev; }
+  | tuple_type { $typev = DataType.TUPLE; }
+  | bag_type { $typev = DataType.BAG; }
+  | map_type { $typev = DataType.MAP; }
 ;
 
-simple_type : BOOLEAN | INT | LONG | FLOAT | DOUBLE | CHARARRAY | BYTEARRAY
+simple_type returns [byte typev]
+  : BOOLEAN { $typev = DataType.BOOLEAN; }
+  | INT { $typev = DataType.INTEGER; }
+  | LONG { $typev = DataType.LONG; }
+  | FLOAT { $typev = DataType.FLOAT; }
+  | DOUBLE { $typev = DataType.DOUBLE; }
+  | CHARARRAY { $typev = DataType.CHARARRAY; }
+  | BYTEARRAY { $typev = DataType.BYTEARRAY; }
 ;
 
 tuple_type : ^( TUPLE_TYPE field_def_list? )
diff --git a/src/org/apache/pig/parser/LogicalPlanGenerator.g b/src/org/apache/pig/parser/LogicalPlanGenerator.g
index c6e12b738..0b0849ee4 100644
--- a/src/org/apache/pig/parser/LogicalPlanGenerator.g
+++ b/src/org/apache/pig/parser/LogicalPlanGenerator.g
@@ -47,6 +47,7 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.streaming.StreamingCommand;
 import org.apache.pig.impl.streaming.StreamingCommand.HandleSpec;
 import org.apache.pig.impl.util.MultiMap;
+import org.apache.pig.impl.util.NumValCarrier;
 import org.apache.pig.impl.plan.PlanValidationException;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.newplan.logical.expression.AddExpression;
@@ -313,21 +314,29 @@ as_clause returns[LogicalSchema logicalSchema]
    }
 ;
 
-field_def returns[LogicalFieldSchema fieldSchema]
+field_def[NumValCarrier nvc] returns[LogicalFieldSchema fieldSchema]
 @init {
     byte datatype = DataType.NULL;          
+    if ($nvc==null) {
+        $nvc=new NumValCarrier();
+    }
 }
  : ^( FIELD_DEF IDENTIFIER ( type { datatype = $type.datatype;} )? )
    {
            $fieldSchema = new LogicalFieldSchema( $IDENTIFIER.text, $type.logicalSchema, datatype );
    }
+ | ^( FIELD_DEF_WITHOUT_IDENTIFIER ( type { datatype = $type.datatype; } ) )
+   {
+           $fieldSchema = new LogicalFieldSchema ( $nvc.makeNameFromDataType(datatype) , $type.logicalSchema, datatype );
+   }
 ;
 
 field_def_list returns[LogicalSchema schema]
 @init {
     $schema = new LogicalSchema();
+    NumValCarrier nvc = new NumValCarrier();
 }
- : ( field_def { $schema.addField( $field_def.fieldSchema ); } )+
+ : ( field_def[nvc] { $schema.addField( $field_def.fieldSchema ); } )+
 ;
 
 
diff --git a/src/org/apache/pig/parser/QueryParser.g b/src/org/apache/pig/parser/QueryParser.g
index 72bfb5980..f158a85ba 100644
--- a/src/org/apache/pig/parser/QueryParser.g
+++ b/src/org/apache/pig/parser/QueryParser.g
@@ -47,6 +47,7 @@ tokens {
     BAG_VAL;
     KEY_VAL_PAIR;
     FIELD_DEF;
+    FIELD_DEF_WITHOUT_IDENTIFIER;
     NESTED_CMD_ASSI;
     NESTED_CMD;
     NESTED_PROJ;
@@ -291,11 +292,13 @@ load_clause : LOAD^ filename ( USING! func_clause )? as_clause?
 filename : QUOTEDSTRING
 ;
 
-as_clause: AS^ ( field_def | ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) )
+as_clause: AS^ ( ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) | field_def )
 ;
 
 field_def : identifier ( COLON type )?
          -> ^( FIELD_DEF identifier type? )
+          | type
+         -> ^( FIELD_DEF_WITHOUT_IDENTIFIER type )
 ;
 
 field_def_list : field_def ( COMMA field_def )*
@@ -353,10 +356,10 @@ rel : alias
     | LEFT_PAREN! ( foreach_clause_complex | ( ( op_clause | foreach_clause_simple ) parallel_clause? ) ) RIGHT_PAREN!
 ;
 
-flatten_generated_item : flatten_clause ( AS! ( field_def | ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) ) )?
-                       | col_range ( AS! ( field_def | ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) ) )?
+flatten_generated_item : flatten_clause ( AS! ( ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) | field_def ) )?
+                       | col_range ( AS! ( ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) | field_def ) )?
                        | expr ( AS! field_def )?
-                       | STAR ( AS! ( field_def | ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) ) )?
+                       | STAR ( AS! ( ( LEFT_PAREN! field_def_list RIGHT_PAREN! ) | field_def ) )?
 ;
 	
 flatten_clause : FLATTEN^ LEFT_PAREN! expr RIGHT_PAREN!
diff --git a/test/org/apache/pig/parser/TestErrorHandling.java b/test/org/apache/pig/parser/TestErrorHandling.java
index 65a662b68..943c42537 100644
--- a/test/org/apache/pig/parser/TestErrorHandling.java
+++ b/test/org/apache/pig/parser/TestErrorHandling.java
@@ -241,4 +241,60 @@ public class TestErrorHandling {
         Assert.fail( "Testcase should fail" );
     }
 
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName1() throws IOException{
+        String query = "a = load 'x' as (int,val_0);";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName2() throws IOException{
+        String query = "a = load 'x' as ((int,int),tuple_0:tuple(int,int));";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName3() throws IOException{
+        String query = "a = load 'x' as (tuple_0:tuple(int,int),(int,int));";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName4() throws IOException{
+        String query = "a = load 'x' as (bag_0:bag{},{});";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName5() throws IOException{
+        String query = "a = load 'x' as ([],map_0:map[]);";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    @Test //pig-2267
+    public void testAutomaticallyGivenSchemaName6() throws IOException{
+        String query = "a = load 'x' as (int,int,int,val_3,val_2);";
+        String failMsg = "Duplicated alias in schema";
+        shouldFailWithMessage(query,failMsg);
+    }
+
+    public void shouldFailWithMessage(String query, String... messages) throws IOException {
+        try {
+            pig.registerQuery(query);
+        } catch (Exception e) {
+            String msg = e.getMessage();
+            System.out.println(msg);
+            for (String message : messages) {
+                Assert.assertTrue(msg.contains(message));
+            }
+            return;
+        }
+        Assert.fail("Testcase should fail");
+    }
+
 }
diff --git a/test/org/apache/pig/parser/TestQueryParser.java b/test/org/apache/pig/parser/TestQueryParser.java
index a1a65b61c..6e4872709 100644
--- a/test/org/apache/pig/parser/TestQueryParser.java
+++ b/test/org/apache/pig/parser/TestQueryParser.java
@@ -331,4 +331,13 @@ public class TestQueryParser {
         return parser.getNumberOfSyntaxErrors();
     }
 
+    //PIG-2267
+    public void testThatColNameIsGeneratedProperly() throws IOException {
+        String query = "a = load '1.txt' as (int,(long,[]),{([])});"
+                     + "b = foreach a generate val_0, tuple_0, bag_0;"
+                     + "c = foreach b generate val_0, flatten(tuple_0), flatten(bag_0);"
+                     + "d = foreach c generate val_0, tuple_0::val_0, bag_0::map_0;";
+        PigServer pig = new PigServer(ExecType.LOCAL);
+        Util.registerMultiLineQuery(pig, query);
+    }
 }
