diff --git a/CHANGES.txt b/CHANGES.txt
index 51223cad8..e8ae2b595 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -60,6 +60,8 @@ PIG-2011: Speed up TestTypedMap.java (dvryaboy)
 
 BUG FIXES
 
+PIG-2120: UDFContext.getClientSystemProps() does not respect pig.properties (dvryaboy)
+
 PIG-2129: NOTICE file needs updates (gates)
 
 PIG-2131: Add back test for PIG-1769 (qwertymaniac via gates)
diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index 9f5158c42..e2931a615 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -183,7 +183,7 @@ static int run(String args[], PigProgressNotificationListener listener) {
         }
         
         // set up client side system properties in UDF context
-        UDFContext.getUDFContext().setClientSystemProps();
+        UDFContext.getUDFContext().setClientSystemProps(properties);
 
         char opt;
         while ((opt = opts.getNextOpt()) != CmdLineParser.EndOfOpts) {
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 3cf925b97..68c3c57ae 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -1632,6 +1632,8 @@ public class PigServer {
          */
         private void parseQuery() throws FrontendException {
             UDFContext.getUDFContext().reset();
+            UDFContext.getUDFContext().setClientSystemProps(pigContext.getProperties());
+
             String query = buildQuery();
 
             if( query.isEmpty() ) {
diff --git a/src/org/apache/pig/backend/hadoop/hbase/HBaseStorage.java b/src/org/apache/pig/backend/hadoop/hbase/HBaseStorage.java
index c7577ea91..7cf57d5bf 100644
--- a/src/org/apache/pig/backend/hadoop/hbase/HBaseStorage.java
+++ b/src/org/apache/pig/backend/hadoop/hbase/HBaseStorage.java
@@ -229,7 +229,7 @@ public class HBaseStorage extends LoadFunc implements StoreFuncInterface, LoadPu
         }
 
         m_conf = HBaseConfiguration.create();
-        String defaultCaster = m_conf.get(CASTER_PROPERTY, STRING_CASTER);
+        String defaultCaster = UDFContext.getUDFContext().getClientSystemProps().getProperty(CASTER_PROPERTY, STRING_CASTER);
         String casterOption = configuredOptions_.getOptionValue("caster", defaultCaster);
         if (STRING_CASTER.equalsIgnoreCase(casterOption)) {
             caster_ = new Utf8StorageConverter();
@@ -246,6 +246,7 @@ public class HBaseStorage extends LoadFunc implements StoreFuncInterface, LoadPu
                 throw new IOException(e);
             }
         }
+        LOG.debug("Using caster " + caster_.getClass());
 
         caching_ = Integer.valueOf(configuredOptions_.getOptionValue("caching", "100"));
         limit_ = Long.valueOf(configuredOptions_.getOptionValue("limit", "-1"));
diff --git a/src/org/apache/pig/impl/util/UDFContext.java b/src/org/apache/pig/impl/util/UDFContext.java
index 5b02e6fe4..207735b88 100644
--- a/src/org/apache/pig/impl/util/UDFContext.java
+++ b/src/org/apache/pig/impl/util/UDFContext.java
@@ -47,9 +47,11 @@ public class UDFContext {
         return tss.get();
     }
 
-    // internal pig use only - should NOT be called from user code
-    public void setClientSystemProps() {
-        clientSysProps = System.getProperties();        
+    /*
+     *  internal pig use only - should NOT be called from user code
+     */
+    public void setClientSystemProps(Properties properties) {
+        clientSysProps = properties;
     }
     
     /**
@@ -247,4 +249,5 @@ public class UDFContext {
             return true;
         }
     }
+
 }
\ No newline at end of file
diff --git a/test/org/apache/pig/test/TestUDFContext.java b/test/org/apache/pig/test/TestUDFContext.java
index cc9d73b96..34a3f3406 100644
--- a/test/org/apache/pig/test/TestUDFContext.java
+++ b/test/org/apache/pig/test/TestUDFContext.java
@@ -18,9 +18,6 @@
 package org.apache.pig.test;
 
 import static org.junit.Assert.*;
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertNotNull;
-
 import java.io.File;
 import java.io.FileWriter;
 import java.util.Iterator;
@@ -52,14 +49,17 @@ public class TestUDFContext {
     
     @Test
     public void testUDFContext() throws Exception {
-        Util.createInputFile(cluster, "a.txt", new String[] { "dumb" });
-        Util.createInputFile(cluster, "b.txt", new String[] { "dumber" });
+        File a = Util.createLocalInputFile("a.txt", new String[] { "dumb" });
+        File b = Util.createLocalInputFile("b.txt", new String[] { "dumber" });
         FileLocalizer.deleteTempFiles();
-        PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
-        String[] statement = { "A = LOAD 'a.txt' USING org.apache.pig.test.utils.UDFContextTestLoader('joe');",
-            "B = LOAD 'b.txt' USING org.apache.pig.test.utils.UDFContextTestLoader('jane');",
+        PigServer pig = new PigServer(ExecType.LOCAL, cluster.getProperties());
+        String[] statement = { "A = LOAD '" + a.getAbsolutePath() +
+                "' USING org.apache.pig.test.utils.UDFContextTestLoader('joe');",
+            "B = LOAD '" + b.getAbsolutePath() +
+            "' USING org.apache.pig.test.utils.UDFContextTestLoader('jane');",
             "C = union A, B;",
-            "D = FOREACH C GENERATE $0, $1, org.apache.pig.test.utils.UDFContextTestEvalFunc($0), org.apache.pig.test.utils.UDFContextTestEvalFunc2($0);" };
+            "D = FOREACH C GENERATE $0, $1, org.apache.pig.test.utils.UDFContextTestEvalFunc($0), " +
+            "org.apache.pig.test.utils.UDFContextTestEvalFunc2($0);" };
 
         File tmpFile = File.createTempFile("temp_jira_851", ".pig");
         FileWriter writer = new FileWriter(tmpFile);
@@ -89,7 +89,7 @@ public class TestUDFContext {
      */
     @Test
     public void testUDFContextReset() throws Exception {
-        PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
+        PigServer pig = new PigServer(ExecType.LOCAL, cluster.getProperties());
         pig.registerQuery(" l = load 'file' as (a :int, b : int, c : int);");
         pig.registerQuery(" f = foreach l generate a, b;");        
         pig.explain("f", System.out);
