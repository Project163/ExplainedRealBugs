diff --git a/CHANGES.txt b/CHANGES.txt
index 7dafd6889..f54ed36f5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -44,8 +44,6 @@ BUG FIXES
 
 PIG-2044: Patten match bug in org.apache.pig.newplan.optimizer.Rule (knoguchi via daijy)
 
-PIG-1938: support project-range as udf argument (thejas)
-
 PIG-2048: Add zookeeper to pig jar (gbowyer via gates)
 
 PIG-2008: Cache outputFormat in HBaseStorage (thedatachef via gates)
@@ -72,6 +70,8 @@ PIG-1876: Typed map for Pig (daijy)
 
 IMPROVEMENTS
 
+PIG-1938: support project-range as udf argument (thejas)
+
 PIG-2059: PIG doesn't validate incomplete query in batch mode even if -c option is given (xuefu)
 
 PIG-2062: Script silently ended (xuefu)
@@ -224,6 +224,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-2072: NPE when udf has project-star argument and input schema is null (thejas)
+
 PIG-2075: Bring back TestNewPlanPushUpFilter (daijy)
 
 PIG-1827: When passing a parameter to Pig, if the value contains $ it has to be escaped for no apparent reason (rding)
diff --git a/src/org/apache/pig/newplan/logical/visitor/TypeCheckingExpVisitor.java b/src/org/apache/pig/newplan/logical/visitor/TypeCheckingExpVisitor.java
index d6295d2fd..bd4e8947e 100644
--- a/src/org/apache/pig/newplan/logical/visitor/TypeCheckingExpVisitor.java
+++ b/src/org/apache/pig/newplan/logical/visitor/TypeCheckingExpVisitor.java
@@ -973,6 +973,8 @@ public class TypeCheckingExpVisitor extends LogicalExpressionVisitor{
         for(int i=0;i<s.size();i++){
             try {
                 FieldSchema fs=s.getField(i);
+                if(fs == null)
+                    return false;
                 if(fs.type==DataType.BYTEARRAY){
                     return true;
                 }
@@ -1098,7 +1100,10 @@ public class TypeCheckingExpVisitor extends LogicalExpressionVisitor{
 
             FieldSchema inputFieldSchema = i.next();
             FieldSchema udfFieldSchema = j.next();
-
+            if(inputFieldSchema == null)
+                return false;
+            
+            
             if(ignoreByteArrays && inputFieldSchema.type == DataType.BYTEARRAY) {
                 continue;
             }
@@ -1249,6 +1254,9 @@ public class TypeCheckingExpVisitor extends LogicalExpressionVisitor{
         int castCnt=0;
         for(int i=0;i<sFields.size();i++){
             FieldSchema sFS = sFields.get(i);
+            if(sFS == null){
+                return INF;
+            }
 
             // if we have a byte array do not include it
             // in the computation of the score - bytearray
diff --git a/test/org/apache/pig/test/TestProjectStarRangeInUdf.java b/test/org/apache/pig/test/TestProjectStarRangeInUdf.java
index 7deb4b094..43cbdee6e 100644
--- a/test/org/apache/pig/test/TestProjectStarRangeInUdf.java
+++ b/test/org/apache/pig/test/TestProjectStarRangeInUdf.java
@@ -99,6 +99,30 @@ public class TestProjectStarRangeInUdf  {
                 "org.apache.pig.builtin.CONCAT");
     }
     
+    @Test
+    public void testProjStarExpandInForeach1NegativeNoSchema() throws IOException{
+        
+        String query;
+
+        query =
+            "  l1 = load '" + INP_FILE_5FIELDS + "' ;"
+            + "f = foreach l1 generate CONCAT(*) as ct;"
+            ; 
+        Util.checkExceptionMessage(query, "f",
+                "Could not infer the matching function for " +
+                "org.apache.pig.builtin.CONCAT");
+
+
+        query =
+            "  l1 = load '" + INP_FILE_5FIELDS + "' ;"
+            + "f = foreach l1 generate SIZE(*) as ct;"
+            ; 
+        Util.checkExceptionMessage(query, "f",
+                "Could not infer the matching function for " +
+                "org.apache.pig.builtin.SIZE");
+        
+    }
+    
     @Test
     public void testProjStarExpandInForeach2() throws IOException {
 
