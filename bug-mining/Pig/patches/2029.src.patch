diff --git a/CHANGES.txt b/CHANGES.txt
index b728067ca..f754fbbd6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -26,6 +26,8 @@ IMPROVEMENTS
 PIG-5438: Update SparkCounter.Accumulator to AccumulatorV2 (knoguchi)
 
 PIG-5439: Support Spark 3 and drop SparkShim (knoguchi)
+
+PIG-5455: Upgrade Hadoop to 3.3.6 and Tez to 0.10.3 (knoguchi)
  
 OPTIMIZATIONS
  
diff --git a/build.xml b/build.xml
index a46670b04..b622406b6 100644
--- a/build.xml
+++ b/build.xml
@@ -725,6 +725,7 @@
             <fileset dir="${ivy.lib.dir}" includes="jline-*.jar"/>
             <fileset dir="${ivy.lib.dir}" includes="jackson-mapper-asl-*.jar"/>
             <fileset dir="${ivy.lib.dir}" includes="jackson-core-asl-*.jar"/>
+            <fileset dir="${ivy.lib.dir}" includes="jackson-xc-*.jar"/>
             <fileset dir="${ivy.lib.dir}" includes="joda-time-*.jar"/>
             <fileset dir="${ivy.lib.dir}" includes="guava-*.jar"/>
             <fileset dir="${ivy.lib.dir}" includes="automaton-*.jar"/>
diff --git a/ivy.xml b/ivy.xml
index b57ec8b06..d70af1194 100644
--- a/ivy.xml
+++ b/ivy.xml
@@ -246,6 +246,9 @@
       conf="compile->master">
       <exclude org="com.thoughtworks.paranamer" module="paranamer"/>
     </dependency>
+    <dependency org="org.codehaus.jackson" name="jackson-xc" rev="${jackson.version}" conf="hadoop3->master">
+      <exclude org="com.thoughtworks.paranamer" module="paranamer"/>
+    </dependency>
     <dependency org="com.thoughtworks.paranamer" name="paranamer" rev="${paranamer.version}" conf="compile->master"/>
     <dependency org="org.fusesource.jansi" name="jansi" rev="${jansi.version}"
       conf="compile->master"/>
@@ -616,7 +619,11 @@
       conf="compile->master">
     </dependency>
 
-    <dependency org="org.mockito" name="mockito-all" rev="${mockito.version}" conf="test->default"/>
+    <dependency org="org.mockito" name="mockito-core" rev="${mockito.version}" conf="test->default"/>
+    <dependency org="org.hamcrest" name="hamcrest-all" rev="${hamcrest.version}" conf="test->default"/>
+    <dependency org="org.bouncycastle" name="bcpkix-jdk18on" rev="${bouncycastle.version}" conf="test->default"/>
+    <dependency org="org.bouncycastle" name="bcprov-jdk18on" rev="${bouncycastle.version}" conf="test->default"/>
+    <dependency org="org.bouncycastle" name="bcutil-jdk18on" rev="${bouncycastle.version}" conf="test->default"/>
 
     <dependency org="org.apache.parquet" name="parquet-pig-bundle" rev="${parquet-pig-bundle.version}" conf="compile->master"/>
 
@@ -664,9 +671,11 @@
       <exclude org="com.google.guava" />
       <exclude org="io.netty" module="netty"/>
       <exclude org="io.netty" name="netty-all"/>
+      <exclude org="com.google.protobuf" name="protobuf-java" />
     </dependency>
     <dependency org="org.apache.spark" name="spark-yarn_${spark3-scala.version}" rev="${spark3.version}" conf="spark3->default">
       <exclude org="org.apache.hadoop" />
+      <exclude org="com.google.protobuf" name="protobuf-java" />
     </dependency>
     <dependency org="javax.servlet" name="javax.servlet-api" rev="3.0.1" conf="spark3->default;spark3->default"/>
     <dependency org="javax.servlet" name="javax.servlet-api" rev="3.1.0" conf="test->master"/>
diff --git a/ivy/libraries-h2.properties b/ivy/libraries-h2.properties
index de69aa64f..9906e36f2 100644
--- a/ivy/libraries-h2.properties
+++ b/ivy/libraries-h2.properties
@@ -26,3 +26,5 @@ servlet-api.version=2.5
 spark-scala.version=2.11
 jackson-module-scala.version=2.10.2
 hive-storage-api.version=2.7.0
+protobuf-java.version=2.5.0
+mockito.version=1.8.4
diff --git a/ivy/libraries-h3.properties b/ivy/libraries-h3.properties
index 5d990095f..ec24246b7 100644
--- a/ivy/libraries-h3.properties
+++ b/ivy/libraries-h3.properties
@@ -14,17 +14,19 @@
 #It drives ivy and the generation of a maven POM
 
 #These are the versions of our Hadoop 3 dependencies (core and other libs separated and in alphabetical order)
-hadoop-common.version=3.2.4
-hadoop-hdfs.version=3.2.4
-hadoop-mapreduce.version=3.2.4
+hadoop-common.version=3.3.6
+hadoop-hdfs.version=3.3.6
+hadoop-mapreduce.version=3.3.6
 
 accumulo.version=1.6.0
 netty.version=3.10.6.Final
 codahale.metrics-core.version=3.0.1
 netty-all.version=4.1.77.Final
 re2j.version=1.0
-tez.version=0.10.2
+tez.version=0.10.3
 servlet-api.version=3.1.0
 spark-scala.version=2.12
-jackson-module-scala.version=2.10.2
+jackson-module-scala.version=2.12.7
 hive-storage-api.version=2.7.2
+protobuf-java.version=3.21.1
+mockito.version=2.28.2
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index 21f4de1d0..e7d319bc1 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -70,19 +70,19 @@ spark2-scala.version=2.11
 jackson-module-scala_spark2.version=2.9.10
 spark3.version=3.2.4
 spark3-scala.version=2.12
-jackson-module-scala_spark3.version=2.10.2
+jackson-module-scala_spark3.version=2.12.7
 xerces.version=2.10.0
 xalan.version=2.7.1
 wagon-http.version=1.0-beta-2
 zookeeper.version=3.5.7
 servlet.version=4.0.6
-protobuf-java.version=2.5.0
 metrics-core.version=2.1.2
 guice.version=3.0
 guice-servlet.version=3.0
 aopalliance.version=1.0
 jsr311-api.version=1.1.1
-mockito.version=1.8.4
+hamcrest.version=1.3
+bouncycastle.version=1.78.1
 jansi.version=1.9
 asm.version=3.3.1
 snappy-java.version=1.1.1.3
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
index afab4766e..0598a6e06 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
@@ -229,6 +229,9 @@ public class TezDagBuilder extends TezOpPlanVisitor {
         this.pigContextConf = ConfigurationUtil.toConfiguration(pc.getProperties(), false);
         MRToTezHelper.processMRSettings(pigContextConf, globalConf);
 
+        // Need to disable this feature until TEZ-4570 is fixed
+        pigContextConf.setBoolean("tez.runtime.transfer.data-via-events.enabled", false);
+
         shuffleVertexManagerBaseConf = new Configuration(false);
         // Only copy tez.shuffle-vertex-manager config to keep payload size small
         Iterator<Entry<String, String>> iter = pigContextConf.iterator();
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
index 649734d7c..4b5da89f5 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
@@ -116,7 +116,6 @@ public class TezLauncher extends Launcher {
         if (pc.getExecType().isLocal()) {
             pc.getProperties().setProperty(TezConfiguration.TEZ_LOCAL_MODE, "true");
             pc.getProperties().setProperty(TezRuntimeConfiguration.TEZ_RUNTIME_OPTIMIZE_LOCAL_FETCH, "true");
-            pc.getProperties().setProperty("tez.runtime.transfer.data-via-events.enabled","false");
             pc.getProperties().setProperty(TezConfiguration.TEZ_IGNORE_LIB_URIS, "true");
             pc.getProperties().setProperty(TezConfiguration.TEZ_AM_DAG_SCHEDULER_CLASS, DAGSchedulerNaturalOrderControlled.class.getName());
         }
diff --git a/test/org/apache/pig/test/TestBinInterSedes.java b/test/org/apache/pig/test/TestBinInterSedes.java
index b2419f5ca..677d002cc 100644
--- a/test/org/apache/pig/test/TestBinInterSedes.java
+++ b/test/org/apache/pig/test/TestBinInterSedes.java
@@ -27,6 +27,7 @@ import java.io.DataOutput;
 import java.io.DataOutputStream;
 import java.io.File;
 import java.io.IOException;
+import java.lang.reflect.Method;
 import java.util.Arrays;
 import java.util.HashMap;
 import java.util.Iterator;
@@ -44,11 +45,11 @@ import org.apache.pig.data.InterSedes;
 import org.apache.pig.data.InterSedesFactory;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
+import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.BufferedPositionedInputStream;
 import org.apache.pig.impl.io.InterRecordReader;
 import org.apache.pig.impl.util.TupleFormat;
 import org.junit.Test;
-import org.mockito.internal.util.reflection.Whitebox;
 
 public class TestBinInterSedes {
     private static final TupleFactory mTupleFactory = TupleFactory.getInstance();
@@ -453,7 +454,17 @@ public class TestBinInterSedes {
     @Test
     public void testPrefixSyncMarkers() throws Exception {
         long defaultInterval = PigConfiguration.PIG_INTERSTORAGE_SYNCMARKER_INTERVAL_DEFAULT;
-
+        ClassLoader classloader = PigContext.getClassLoader();
+        Class <?> klazz;
+        try {
+            klazz = PigContext.resolveClassName("org.mockito.internal.util.reflection.Whitebox");
+        } catch (Exception ex) {
+            klazz = PigContext.resolveClassName("org.apache.hadoop.test.Whitebox");
+        }
+        if( klazz == null ) {
+            throw new Exception("No Whitebox class found.");
+        }
+        Method method = klazz.getMethod("setInternalState", Object.class, String.class, Object.class);
         for (int b0 = -128; b0 <= 127; b0++) {
             for (int b1 = -128; b1 <= 127; b1++) {
                 for (int b2 = -128; b2 <= 127; b2++) {
@@ -464,9 +475,9 @@ public class TestBinInterSedes {
                     BufferedPositionedInputStream bpi = new BufferedPositionedInputStream(bi);
 
                     InterRecordReader reader = new InterRecordReader(syncMarker.length, defaultInterval);
-                    Whitebox.setInternalState(reader, "syncMarker", syncMarker);
-                    Whitebox.setInternalState(reader, "end", data.length);
-                    Whitebox.setInternalState(reader, "in", bpi);
+                    method.invoke(null, reader, "syncMarker", syncMarker);
+                    method.invoke(null, reader, "end", data.length);
+                    method.invoke(null, reader, "in", bpi);
 
                     try {
                         boolean ret = reader.skipUntilMarkerOrSplitEndOrEOF();
diff --git a/test/org/apache/pig/test/TezMiniCluster.java b/test/org/apache/pig/test/TezMiniCluster.java
index 87ed87e8b..56c908c54 100644
--- a/test/org/apache/pig/test/TezMiniCluster.java
+++ b/test/org/apache/pig/test/TezMiniCluster.java
@@ -57,7 +57,6 @@ public class TezMiniCluster extends YarnMiniCluster {
             // Write tez-site.xml
             Configuration tez_conf = new Configuration(false);
             tez_conf.set(TezRuntimeConfiguration.TEZ_RUNTIME_OPTIMIZE_LOCAL_FETCH, "false");
-            tez_conf.set("tez.runtime.transfer.data-via-events.enabled", "false");
             tez_conf.set("tez.lib.uris", "hdfs:///tez,hdfs:///tez/lib");
             // Set to a lower value so that tests don't get stuck for long because of 1 AM running at a time
             tez_conf.set(TezConfiguration.TEZ_SESSION_AM_DAG_SUBMIT_TIMEOUT_SECS, "20");
