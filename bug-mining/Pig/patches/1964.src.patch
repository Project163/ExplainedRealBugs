diff --git a/CHANGES.txt b/CHANGES.txt
index bd1a7d83f..62bc70c32 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -48,6 +48,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-5299: PartitionFilterOptimizer failing at compile time (knoguchi)
+
 PIG-5290: User Cache upload contention can cause job failures (xkrogen via rohini)
 
 PIG-5293: Suspicious code as missing `this' for a member (lifove via daijy)
diff --git a/src/org/apache/pig/newplan/FilterExtractor.java b/src/org/apache/pig/newplan/FilterExtractor.java
index 462cdf9b4..fd748bd44 100644
--- a/src/org/apache/pig/newplan/FilterExtractor.java
+++ b/src/org/apache/pig/newplan/FilterExtractor.java
@@ -334,7 +334,12 @@ public abstract class FilterExtractor {
 
         for( Operator succ : children ) {
             filteredPlan.disconnect( op, succ );
-            removeFromFilteredPlan( succ );
+            // check if this successor has any other predecessor.
+            // if none, proceed with the removal.
+            List<Operator> predsOfsucc = filteredPlan.getPredecessors( succ );
+            if( predsOfsucc == null || predsOfsucc.size() == 0 ) {
+                removeFromFilteredPlan( succ );
+            }
         }
 
         filteredPlan.remove( op );
diff --git a/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java b/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
index 5e06e4db2..5bf3856ca 100644
--- a/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
+++ b/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
@@ -721,6 +721,13 @@ public class TestNewPartitionFilterPushDown {
         testFull(q, "(srcid != 10)", "(srcid == z.z1)", true);
     }
 
+    @Test
+    public void testNegativeOrAndOr() throws Exception {
+        String q = query + "b = filter a by dstid != 10 OR ((dstid < 3000 and srcid == 1000) OR (dstid >= 3000 and srcid == 2000));" +
+                   "store b into 'out';";
+        test(q, Arrays.asList("srcid"), null, "((dstid != 10) or (((dstidLessThan3000) and (srcid == 1000)) or ((dstidGreaterThanEqual3000) and (srcid == 2000))))", true);
+    }
+
     //// helper methods ///////
     private PartitionFilterExtractor test(String query, List<String> partitionCols,
             String expPartFilterString, String expFilterString)
