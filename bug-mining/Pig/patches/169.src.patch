diff --git a/CHANGES.txt b/CHANGES.txt
index e4c575d96..8dc3a4954 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -444,3 +444,5 @@ Trunk (unreleased changes)
     via sms)
 
     PIG-577: outer join query looses name information (sms via pradeepkth)
+
+    PIG-690: UNION doesn't work in the latest code (pradeepkth via sms)
diff --git a/src/org/apache/pig/impl/logicalLayer/schema/Schema.java b/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
index 9759e782e..05a15f07f 100644
--- a/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
+++ b/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
@@ -1378,7 +1378,13 @@ public class Schema implements Serializable, Cloneable {
 
                 // create the merged field
                 // the mergedSubSchema can be true if allowIncompatibleTypes
-                mergedFs = new FieldSchema(mergedAlias, mergedSubSchema) ;
+                try {
+                    mergedFs = new FieldSchema(mergedAlias, mergedSubSchema, mergedType) ;
+                } catch (FrontendException e) {
+                    int errCode = 2124;
+                    String errMsg = "Internal Error: Unexpected error creating field schema";
+                    throw new SchemaMergeException(errMsg, errCode, PigException.BUG, e);
+                }
 
             }
             outputList.add(mergedFs) ;
diff --git a/test/org/apache/pig/test/TestUnion.java b/test/org/apache/pig/test/TestUnion.java
index c47c30d91..72e19addf 100644
--- a/test/org/apache/pig/test/TestUnion.java
+++ b/test/org/apache/pig/test/TestUnion.java
@@ -216,4 +216,38 @@ public class TestUnion extends junit.framework.TestCase {
         assertFalse(it.hasNext());
     }
     
+    // Test schema merge in union when one of the fields is a bag
+    @Test
+    public void testSchemaMergeWithBag() throws Exception {
+        Util.createInputFile(cluster, "input1.txt", new String[] {"dummy"});
+        Util.createInputFile(cluster, "input2.txt", new String[] {"dummy"});
+        PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
+        Util.registerQuery(pig, "a = load 'input1.txt' ;" +
+        		"b = load 'input2.txt';" +
+        		"c = foreach a generate 1, {(1, 'str1')};" +
+        		"d = foreach b generate 2, {(2, 'str2')};" +
+        		"e = union c,d");
+        Iterator<Tuple> it = pig.openIterator("e");
+        Object[] expected = new Object[] { Util.getPigConstant("(1, {(1, 'str1')})"),
+                Util.getPigConstant("(2, {(2, 'str2')})")};
+        Object[] results = new Object[2];
+        int i = 0;
+        while(it.hasNext()) {
+            if(i == 2) {
+                fail("Got more tuples than expected!");
+            }
+            Tuple t = it.next();
+            if(t.get(0).equals(1)) {
+                // this is the first tuple
+                results[0] = t;
+            } else {
+                results[1] = t;
+            }
+            i++;
+        }
+        for (int j = 0; j < expected.length; j++) {
+            assertTrue(expected[j].equals(results[j]));
+        }
+    }
+    
 }
diff --git a/test/org/apache/pig/test/Util.java b/test/org/apache/pig/test/Util.java
index e4c01487e..141dddfc0 100644
--- a/test/org/apache/pig/test/Util.java
+++ b/test/org/apache/pig/test/Util.java
@@ -311,6 +311,12 @@ public class Util {
         Schema.setSchemaDefaultType(schema, defaultType);
         return schema;
     }
+    
+    static Object getPigConstant(String pigConstantAsString) throws ParseException {
+        ByteArrayInputStream stream = new ByteArrayInputStream(pigConstantAsString.getBytes()) ;
+        QueryParser queryParser = new QueryParser(stream) ;
+        return queryParser.Datum();
+    }
 
     public static File createFile(String[] data) throws Exception{
         File f = File.createTempFile("tmp", "");
