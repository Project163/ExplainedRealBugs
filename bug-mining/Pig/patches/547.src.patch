diff --git a/CHANGES.txt b/CHANGES.txt
index 8f3c24361..dd6e451a4 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -207,6 +207,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1651: PIG class loading mishandled (rding)
+
 PIG-1650: pig grunt shell breaks for many commands like perl , awk , 
 pipe , 'ls -l' etc  (nrai via thejas)
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
index 2cf300654..ca4cf59d2 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
@@ -57,6 +57,7 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileSpec;
+import org.apache.pig.impl.logicalLayer.LogicalPlanBuilder;
 import org.apache.pig.impl.plan.CompilationMessageCollector;
 import org.apache.pig.impl.plan.PlanException;
 import org.apache.pig.impl.plan.VisitorException;
@@ -217,7 +218,7 @@ public class MapReduceLauncher extends Launcher{
             Thread jcThread = new Thread(jc);
             jcThread.setUncaughtExceptionHandler(jctExceptionHandler);
             
-            jcThread.setContextClassLoader(pc.createCl(null));
+            jcThread.setContextClassLoader(LogicalPlanBuilder.classloader);
             
             //All the setup done, now lets launch the jobs.
             jcThread.start();
diff --git a/test/org/apache/pig/test/PigTestLoader.java b/test/org/apache/pig/test/PigTestLoader.java
index 1d04e7b15..593a53323 100644
--- a/test/org/apache/pig/test/PigTestLoader.java
+++ b/test/org/apache/pig/test/PigTestLoader.java
@@ -27,16 +27,25 @@ import org.apache.pig.builtin.PigStorage;
 
 public class PigTestLoader extends PigStorage {
 
+    // This is to test PIG-1651: PIG class loading error
+    private static boolean test = false;
+    
     @Override
     public void setLocation(String location, Job job) throws IOException {
         super.setLocation(location, job);
         FileInputFormat.setInputPathFilter(job, TestPathFilter.class);
+        test = true;
     }
 
     public static class TestPathFilter implements PathFilter {
+        
+        public TestPathFilter() {
+            if (!test) throw new RuntimeException("Invalid static variable");
+        }
+        
         @Override
         public boolean accept(Path p) {
-            String name = p.getName(); 
+            String name = p.getName();            
             return !name.endsWith(".xml");
         }       
     }
