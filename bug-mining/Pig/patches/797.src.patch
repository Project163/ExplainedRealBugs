diff --git a/CHANGES.txt b/CHANGES.txt
index a82fca94d..765af4bf9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -99,6 +99,8 @@ PIG-2011: Speed up TestTypedMap.java (dvryaboy)
 
 BUG FIXES
 
+PIG-2124: Script never ending when joining from the same source (daijy)
+
 PIG-2170: NPE thrown during illustrate (thejas)
 
 PIG-2186: PigStorage new warnings about missing schema file 
diff --git a/src/org/apache/pig/newplan/logical/rules/ColumnPruneHelper.java b/src/org/apache/pig/newplan/logical/rules/ColumnPruneHelper.java
index 7dbb92e0a..e2dc33504 100644
--- a/src/org/apache/pig/newplan/logical/rules/ColumnPruneHelper.java
+++ b/src/org/apache/pig/newplan/logical/rules/ColumnPruneHelper.java
@@ -278,15 +278,22 @@ public class ColumnPruneHelper {
             // Now check for the case where the output uid is a generated one
             // If that is the case we need to add the uids which generated it in 
             // the input
+            long firstUid=-1;
             Map<Integer,Long> generatedInputUids = cg.getGeneratedInputUids();
             for( Map.Entry<Integer, Long> entry : generatedInputUids.entrySet() ) {
                 Long uid = entry.getValue();
+                LogicalRelationalOperator pred =
+                    (LogicalRelationalOperator) cg.getPlan().getPredecessors(cg).get(entry.getKey());
                 if( output.contains(uid) ) {
                     // Hence we need to all the full schema of the bag
-                    LogicalRelationalOperator pred =
-                        (LogicalRelationalOperator) cg.getPlan().getPredecessors(cg).get(entry.getKey());
                     input.addAll( getAllUids( pred.getSchema() ) );
                 }
+                if (pred.getSchema()!=null)
+                    firstUid = pred.getSchema().getField(0).uid;
+            }
+            
+            if (input.isEmpty() && firstUid!=-1) {
+                input.add(firstUid);
             }
             
             cg.annotate(INPUTUIDS, input);
diff --git a/test/org/apache/pig/test/TestPruneColumn.java b/test/org/apache/pig/test/TestPruneColumn.java
index b8565be0f..5cc6aac62 100644
--- a/test/org/apache/pig/test/TestPruneColumn.java
+++ b/test/org/apache/pig/test/TestPruneColumn.java
@@ -2069,4 +2069,32 @@ public class TestPruneColumn extends TestCase {
         
         assertFalse(iter.hasNext());
     }
+    
+    @Test
+    public void testCogroup10() throws Exception {
+        pigServer.registerQuery("A = load '"+ Util.generateURI(tmpFile2.toString(), pigServer.getPigContext()) + "' AS (a0, a1:double);");
+        pigServer.registerQuery("B = foreach A generate a0, a1, 0 as joinField;");
+        pigServer.registerQuery("C = group B all;");
+        pigServer.registerQuery("D = foreach C generate 0 as joinField, SUM(B.a1) as total;");
+        pigServer.registerQuery("E = join B by joinField, D by joinField;");
+        pigServer.registerQuery("F = foreach E generate a0;");
+        Iterator<Tuple> iter = pigServer.openIterator("F");
+        
+        assertTrue(iter.hasNext());
+        Tuple t = iter.next();
+        
+        assertTrue(t.size()==1);
+        assertTrue(t.toString().equals("(1)"));
+        
+        assertTrue(iter.hasNext());
+        t = iter.next();
+        
+        assertTrue(t.size()==1);
+        assertTrue(t.toString().equals("(2)"));
+
+        assertFalse(iter.hasNext());
+        
+        assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
+    }
+
 }
