diff --git a/CHANGES.txt b/CHANGES.txt
index da20d12f7..f9c152da4 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -170,6 +170,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3305: Infinite loop when input path contains empty partition directory (daijy)
+
 PIG-3286: TestPigContext.testImportList fails in trunk (cheolsoo)
 
 PIG-2970: Nested foreach getting incorrect schema when having unrelated inner query (daijy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/partition/PathPartitioner.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/partition/PathPartitioner.java
index bc6fd2a44..3bd7fe993 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/partition/PathPartitioner.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/partition/PathPartitioner.java
@@ -5,9 +5,9 @@
  * licenses this file to you under the Apache License, Version 2.0 (the
  * "License"); you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
- * 
+ *
  * http://www.apache.org/licenses/LICENSE-2.0
- * 
+ *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
@@ -28,17 +28,17 @@ import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 
 /**
- * 
+ *
  * Its convenient sometimes to partition logs by date values or other e.g.
  * country, city etc.<br/>
  * A daydate partitioned hdfs directory might look something like:<br/>
- * 
+ *
  * <pre>
  * /logs/repo/mylog/
  * 					daydate=2010-01-01
  * 				    daydate=2010-01-02
  * </pre>
- * 
+ *
  * This class accepts a path like /logs/repo/mylog and return a map of the
  * partition keys
  */
@@ -47,7 +47,7 @@ public class PathPartitioner {
     /**
      * Note: this must be the path lowes in the Searches for the key=value pairs
      * in the path pointer by the location parameter.
-     * 
+     *
      * @param location
      *            String root path in hdsf e.g. /user/hive/warehouse or
      *            /logs/repo
@@ -76,7 +76,7 @@ public class PathPartitioner {
     /**
      * Searches for the key=value pairs in the path pointer by the location
      * parameter.
-     * 
+     *
      * @param location
      *            String root path in hdsf e.g. /user/hive/warehouse or
      *            /logs/repo
@@ -103,7 +103,7 @@ public class PathPartitioner {
 	parseAndPutKeyValue(location, partitionKeys);
 
 	while (!((fileStatusArr = fs.listStatus(path)) == null || fs
-		.isFile(path))) {
+		.isFile(path) || fileStatusArr.length == 0)) {
 	    for (FileStatus fileStatus : fileStatusArr) {
 
 		path = fileStatus.getPath();
@@ -145,7 +145,7 @@ public class PathPartitioner {
     /**
      * Will look for key=value pairs in the path for example:
      * /user/hive/warehouse/mylogs/year=2010/month=07
-     * 
+     *
      * @param path
      * @return String[] [0]= key [1] = value
      */
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/TestPathPartitioner.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/TestPathPartitioner.java
index 10adcedc0..74f0d1239 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/TestPathPartitioner.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/TestPathPartitioner.java
@@ -102,6 +102,29 @@ public class TestPathPartitioner extends TestCase {
 	assertEquals("day", keyArr[2]);
 
     }
+    
+    @Test
+    public void testGetKeysForEmptyDir() throws Exception {
+
+        File baseDir = createDir(null, "testPathPartitioner-testGetKeys-" + System.currentTimeMillis());
+
+        File partition1 = createDir(baseDir, "year=2010");
+        File partition2 = createDir(partition1, "month=01");
+        File emptyPartition = createDir(partition2, "day=01");
+
+        PathPartitioner pathPartitioner = new PathPartitioner();
+        Set<String> keys = pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(), conf);
+
+        assertNotNull(keys);
+        assertEquals(3, keys.size());
+
+        String[] keyArr = keys.toArray(new String[] {});
+
+        assertEquals("year", keyArr[0]);
+        assertEquals("month", keyArr[1]);
+        assertEquals("day", keyArr[2]);
+
+    }
 
     private File createDir(File parent, String name) {
 	File file = new File(parent, name);
