diff --git a/CHANGES.txt b/CHANGES.txt
index 642179a13..4f8376b59 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -70,6 +70,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4156: [PATCH] fix NPE when running scripts stored on hdfs:// (acoliver via daijy)
+
 PIG-4159: TestGroupConstParallelTez and TestJobSubmissionTez should be excluded in Hadoop 20 unit tests (cheolsoo)
 
 PIG-4154: ScriptState#setScript(File) does not close resources (lars_francke via daijy)
diff --git a/src/org/apache/pig/impl/io/FileLocalizer.java b/src/org/apache/pig/impl/io/FileLocalizer.java
index 01e1411e7..2ffa4ebed 100644
--- a/src/org/apache/pig/impl/io/FileLocalizer.java
+++ b/src/org/apache/pig/impl/io/FileLocalizer.java
@@ -800,7 +800,8 @@ public class FileLocalizer {
                 && uri.getScheme() == null )||
                 // For Windows local files
                 (uri.getScheme() == null && uri.getPath().matches("^/[A-Za-z]:.*")) ||
-                uri.getScheme().equals("local") ) {
+                (uri.getScheme() != null && uri.getScheme().equals("local")) 
+            ) {
             srcFs = localFs;
         } else {
             srcFs = path.getFileSystem(conf);
