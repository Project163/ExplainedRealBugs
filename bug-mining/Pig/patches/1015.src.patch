diff --git a/CHANGES.txt b/CHANGES.txt
index a9bf913bd..9d3bb2367 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -24,6 +24,8 @@ INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
 
+PIG-2837: AvroStorage throws StackOverFlowError (cheolsoo via sms)
+
 PIG-2856: AvroStorage doesn't load files in the directories when a glob pattern matches both files and directories. (cheolsoo via sms)
 
 PIG-2569: Fix org.apache.pig.test.TestInvoker.testSpeed (aklochkov via dvryaboy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroSchema2Pig.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroSchema2Pig.java
index 613fffe9d..6b1d2a153 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroSchema2Pig.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroSchema2Pig.java
@@ -47,12 +47,12 @@ public class AvroSchema2Pig {
      */
     public static ResourceSchema convert(Schema schema) throws IOException {
 
-        if (AvroStorageUtils.containsGenericUnion(schema))
-            throw new IOException ("We don't accept schema containing generic unions.");
-        
         if (AvroStorageUtils.containsRecursiveRecord(schema))
             throw new IOException ("We don't accept schema containing recursive records.");
         
+        if (AvroStorageUtils.containsGenericUnion(schema))
+            throw new IOException ("We don't accept schema containing generic unions.");
+
         ResourceFieldSchema inSchema = inconvert(schema, FIELD);
 
         ResourceSchema tupleSchema;
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
index 95137a45e..2fab3f7e2 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
@@ -32,6 +32,7 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.backend.executionengine.ExecJob.JOB_STATUS;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobCreationException;
+import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.piggybank.storage.avro.AvroStorage;
 import org.apache.pig.piggybank.storage.avro.PigSchema2Avro;
 import org.apache.pig.test.Util;
@@ -81,6 +82,8 @@ public class TestAvroStorage {
     final private String testArrayFile = getInputFile("test_array.avro");
     final private String testRecordFile = getInputFile("test_record.avro");
     final private String testRecordSchema = getInputFile("test_record.avsc");
+    final private String testRecursiveSchemaFile = getInputFile("test_recursive_schema.avro");
+    final private String testGenericUnionSchemaFile = getInputFile("test_generic_union_schema.avro");
     final private String testTextFile = getInputFile("test_record.txt");
     final private String testSingleTupleBagFile = getInputFile("messages.avro");
     final private String testNoExtensionFile = getInputFile("test_no_extension");
@@ -96,6 +99,48 @@ public class TestAvroStorage {
         if(pigServerLocal != null) pigServerLocal.shutdown();
     }
 
+    @Test
+    public void testRecursiveSchema() throws IOException {
+        // Verify that a FrontendException is thrown if schema is recursive.
+        String output= outbasedir + "testRecursiveSchema";
+        deleteDirectory(new File(output));
+        String [] queries = {
+          " in = LOAD '" + testRecursiveSchemaFile +
+              "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();",
+          " STORE in INTO '" + output +
+              "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"
+           };
+        try {
+            testAvroStorage(queries);
+            Assert.fail();
+        } catch (FrontendException e) {
+            // The IOException thrown by AvroStorage for recursive schema is caught
+            // by the Pig frontend, and FrontendException is re-thrown.
+            assertTrue(e.getMessage().contains("Cannot get schema"));
+        }
+    }
+
+    @Test
+    public void testGenericUnionSchema() throws IOException {
+        // Verify that a FrontendException is thrown if schema has generic union.
+        String output= outbasedir + "testGenericUnionSchema";
+        deleteDirectory(new File(output));
+        String [] queries = {
+          " in = LOAD '" + testGenericUnionSchemaFile +
+              "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();",
+          " STORE in INTO '" + output +
+              "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"
+           };
+        try {
+            testAvroStorage(queries);
+            Assert.fail();
+        } catch (FrontendException e) {
+            // The IOException thrown by AvroStorage for generic union is caught
+            // by the Pig frontend, and FrontendException is re-thrown.
+            assertTrue(e.getMessage().contains("Cannot get schema"));
+        }
+    }
+
     @Test
     public void testDir() throws IOException {
         // Verify that all files in a directory including its sub-directories are loaded.
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_generic_union_schema.avro b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_generic_union_schema.avro
new file mode 100644
index 000000000..4e23e7316
Binary files /dev/null and b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_generic_union_schema.avro differ
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_recursive_schema.avro b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_recursive_schema.avro
new file mode 100644
index 000000000..12a36f8e4
Binary files /dev/null and b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/avro_test_files/test_recursive_schema.avro differ
