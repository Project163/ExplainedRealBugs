diff --git a/CHANGES.txt b/CHANGES.txt
index b8d757669..809da2541 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -229,6 +229,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-2088: Return alias validation failed when there is single line comment in the macro (rding)
+
 PIG-2081: Dryrun gives wrong line numbers in error message for scripts containing macro (rding)
 
 PIG-2078: POProject.getNext(DataBag) does not handle null (daijy)
diff --git a/src/org/apache/pig/parser/PigMacro.java b/src/org/apache/pig/parser/PigMacro.java
index cb5470c4b..bfcad8494 100644
--- a/src/org/apache/pig/parser/PigMacro.java
+++ b/src/org/apache/pig/parser/PigMacro.java
@@ -373,8 +373,10 @@ class PigMacro {
 
     private static void skipSingleLineComment(StreamTokenizer st)
             throws IOException {
+        int lineNo = st.lineno();
         int lookahead = st.nextToken();
         while (lookahead != StreamTokenizer.TT_EOF && lookahead != '\n') {
+            if (st.lineno() > lineNo) break;
             lookahead = st.nextToken();
         }
         st.pushBack();
diff --git a/test/org/apache/pig/test/TestMacroExpansion.java b/test/org/apache/pig/test/TestMacroExpansion.java
index 33e1bc006..b22dec4d4 100644
--- a/test/org/apache/pig/test/TestMacroExpansion.java
+++ b/test/org/apache/pig/test/TestMacroExpansion.java
@@ -1050,6 +1050,29 @@ public class TestMacroExpansion {
         validateFailure(macro + script, expectedErr);
     }
     
+    @Test // PIG-2088
+    public void checkReturnAliasTest3() throws Throwable {
+        String macro = "define group_and_count_2 (A,C) returns B {\n" +
+            "    -- D = JOIN $A BY user, $C BY user; \n" +
+            "    --D = JOIN $A BY user, $C BY user; \n" +
+            "    $B = JOIN $A BY user, $C BY user;\n" +
+            "};\n";
+        
+        String script = 
+            "alpha = load 'users' as (user, age, zip);\n" +
+            "beta = load 'links' as (user, link, view);\n" +
+            "gamma = group_and_count_2 (alpha,beta);\n" +
+            "store gamma into 'byuser';\n";
+        
+        String expected = 
+            "alpha = load 'users' as (user, age, zip);\n" +
+            "beta = load 'links' as (user, link, view);\n" +
+            "gamma = JOIN alpha BY (user), beta BY (user);\n" +
+            "store gamma INTO 'byuser';\n";
+
+        verify(macro + script, expected);
+    }
+    
     // PIG-1999: macro contains schema name that conflicts with alias
     @Test
     public void negativeTest7() throws Throwable {
