diff --git a/CHANGES.txt b/CHANGES.txt
index 11cc22fdd..598899e86 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -158,6 +158,8 @@ PIG-2228: support partial aggregation in map task (thejas)
 
 BUG FIXES
 
+PIG-2313: NPE in ILLUSTRATE trying to get StatusReporter in STORE (daijy)
+
 PIG-2335: bin/pig does not work with bash 3.0 (azaroth)
 
 PIG-2275: NullPointerException from ILLUSTRATE (daijy)
diff --git a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
index 7bf336dbd..8bdfa2cea 100644
--- a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
+++ b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
@@ -60,38 +60,6 @@ abstract public class PigMapBase extends PigGenericMapBase {
     public boolean inIllustrator(Context context) {
         return (context instanceof PigMapBase.IllustratorContext);
     }
-
-    /**
-     * Dummy implementation of StatusReporter for illustrate mode
-     *
-     */
-    @SuppressWarnings("deprecation")
-    public static class IllustrateDummyReporter extends StatusReporter{
-
-
-        Counters countGen = new Counters();
-        
-        @Override
-        public Counter getCounter(Enum<?> arg0) {
-            return countGen.findCounter(arg0);
-        }
-
-        @Override
-        public Counter getCounter(String group, String name) {
-            return countGen.findCounter(group, name);
-        }
-
-        @Override
-        public void progress() {
-            //no-op
-        }
-
-        @Override
-        public void setStatus(String arg0) {
-            //no-op
-        }
-        
-    }
     
     public class IllustratorContext extends Context {
         private DataBag input;
diff --git a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
index 3239d35e6..50d3b1b50 100644
--- a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
+++ b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
@@ -70,7 +70,7 @@ public class PigMapReduce extends PigGenericMapReduce {
                   POPackage pkg
                   ) throws IOException, InterruptedException {
                 super(job.getJobConf(), new TaskAttemptID(), new FakeRawKeyValueIterator(input.iterator().hasNext()),
-                    null, null, null, null, null, null, PigNullableWritable.class, NullableTuple.class);
+                    null, null, null, null, new IllustrateDummyReporter(), null, PigNullableWritable.class, NullableTuple.class);
                 bos = new ByteArrayOutputStream();
                 dos = new DataOutputStream(bos);
                 org.apache.hadoop.mapreduce.Job nwJob = new org.apache.hadoop.mapreduce.Job(job.getJobConf());
diff --git a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
index b7416b7c4..cbbdb0c64 100644
--- a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
+++ b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapBase.java
@@ -85,7 +85,7 @@ abstract public class PigMapBase extends PigGenericMapBase {
         public IllustratorContext(Configuration conf, DataBag input,
               List<Pair<PigNullableWritable, Writable>> output,
               InputSplit split) throws IOException, InterruptedException {
-            super(conf, new TaskAttemptID(), null, null, null, null, split);
+            super(conf, new TaskAttemptID(), null, null, null, new IllustrateDummyReporter(), split);
             if (output == null)
                 throw new IOException("Null output can not be used");
             this.input = input; this.output = output;
diff --git a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
index 8c5c61474..783ae552f 100644
--- a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
+++ b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigMapReduce.java
@@ -112,7 +112,7 @@ public class PigMapReduce extends PigGenericMapReduce {
                   POPackage pkg
                   ) throws IOException, InterruptedException {
                 super(job.getJobConf(), new TaskAttemptID(), new FakeRawKeyValueIterator(input.iterator().hasNext()),
-                    null, null, null, null, null, null, PigNullableWritable.class, NullableTuple.class);
+                    null, null, null, null, new IllustrateDummyReporter(), null, PigNullableWritable.class, NullableTuple.class);
                 bos = new ByteArrayOutputStream();
                 dos = new DataOutputStream(bos);
                 org.apache.hadoop.mapreduce.Job nwJob = new org.apache.hadoop.mapreduce.Job(job.getJobConf());
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/IllustrateDummyReporter.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/IllustrateDummyReporter.java
new file mode 100644
index 000000000..c3ebeeb90
--- /dev/null
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/IllustrateDummyReporter.java
@@ -0,0 +1,59 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pig.backend.hadoop.executionengine.mapReduceLayer;
+
+import org.apache.hadoop.mapred.Counters;
+import org.apache.hadoop.mapreduce.Counter;
+import org.apache.hadoop.mapreduce.StatusReporter;
+
+/**
+ * Dummy implementation of StatusReporter for illustrate mode
+ *
+ */
+@SuppressWarnings("deprecation")
+public class IllustrateDummyReporter extends StatusReporter{
+
+
+    Counters countGen = new Counters();
+    
+    @Override
+    public Counter getCounter(Enum<?> arg0) {
+        return countGen.findCounter(arg0);
+    }
+
+    @Override
+    public Counter getCounter(String group, String name) {
+        return countGen.findCounter(group, name);
+    }
+
+    @Override
+    public void progress() {
+        //no-op
+    }
+
+    @Override
+    public void setStatus(String arg0) {
+        //no-op
+    }
+
+    public float getProgress() {
+        return 0;
+    }
+    
+}
\ No newline at end of file
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapBase.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapBase.java
index dc2a49751..ac74a68d5 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapBase.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapBase.java
@@ -124,14 +124,16 @@ public abstract class PigGenericMapBase extends Mapper<Text, Tuple, PigNullableW
             runPipeline(leaf);
         }
 
-        for (POStore store: stores) {
-            if (!initialized) {
-                MapReducePOStoreImpl impl 
-                    = new MapReducePOStoreImpl(context);
-                store.setStoreImpl(impl);
-                store.setUp();
+        if (!inIllustrator) {
+            for (POStore store: stores) {
+                if (!initialized) {
+                    MapReducePOStoreImpl impl 
+                        = new MapReducePOStoreImpl(context);
+                    store.setStoreImpl(impl);
+                    store.setUp();
+                }
+                store.tearDown();
             }
-            store.tearDown();
         }
         
         //Calling EvalFunc.finish()
@@ -227,12 +229,14 @@ public abstract class PigGenericMapBase extends Mapper<Text, Tuple, PigNullableW
             pigReporter.setRep(context);
             PhysicalOperator.setReporter(pigReporter);
            
-            for (POStore store: stores) {
-                MapReducePOStoreImpl impl 
-                    = new MapReducePOStoreImpl(context);
-                store.setStoreImpl(impl);
-                if (!pigContext.inIllustrator)
-                    store.setUp();
+            if (!inIllustrator) {
+                for (POStore store: stores) {
+                    MapReducePOStoreImpl impl 
+                        = new MapReducePOStoreImpl(context);
+                    store.setStoreImpl(impl);
+                    if (!pigContext.inIllustrator)
+                        store.setUp();
+                }
             }
             
             boolean aggregateWarning = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("aggregate.warning"));
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapReduce.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapReduce.java
index 5f5368de3..d41f8d623 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapReduce.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigGenericMapReduce.java
@@ -518,14 +518,16 @@ public class PigGenericMapReduce {
                 runPipeline(leaf);
             }
 
-            for (POStore store: stores) {
-                if (!initialized) {
-                    MapReducePOStoreImpl impl 
-                        = new MapReducePOStoreImpl(context);
-                    store.setStoreImpl(impl);
-                    store.setUp();
+            if (!inIllustrator) {
+                for (POStore store: stores) {
+                    if (!initialized) {
+                        MapReducePOStoreImpl impl 
+                            = new MapReducePOStoreImpl(context);
+                        store.setStoreImpl(impl);
+                        store.setUp();
+                    }
+                    store.tearDown();
                 }
-                store.tearDown();
             }
                         
             //Calling EvalFunc.finish()
diff --git a/test/org/apache/pig/test/TestExampleGenerator.java b/test/org/apache/pig/test/TestExampleGenerator.java
index d10bbca41..4babccbd2 100644
--- a/test/org/apache/pig/test/TestExampleGenerator.java
+++ b/test/org/apache/pig/test/TestExampleGenerator.java
@@ -390,4 +390,22 @@ public class TestExampleGenerator {
         assertTrue(derivedData != null);
     }
 
+    @Test
+    public void testFilterGroupCountStore() throws Exception {
+        File out = File.createTempFile("testFilterGroupCountStoreOutput", "");
+        out.deleteOnExit();
+        out.delete();
+    
+        PigServer pigServer = new PigServer(pigContext);
+        pigServer.setBatchOn();
+        pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
+        pigServer.registerQuery("B = filter A by x < 5;");
+        pigServer.registerQuery("C = group B by x;");
+        pigServer.registerQuery("D = foreach C generate group as x, COUNT(B) as the_count;");
+        pigServer.registerQuery("store D into '" +  out.getAbsolutePath() + "';");
+        Map<Operator, DataBag> derivedData = pigServer.getExamples(null);
+    
+        assertTrue(derivedData != null);
+    }
+
 }
