diff --git a/CHANGES.txt b/CHANGES.txt
index 730cd190c..261c50ee0 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -22,12 +22,14 @@ Trunk (unreleased changes)
  
 INCOMPATIBLE CHANGES
 
-PIG-3485: Remove CastUtils.bytesToMap(byte[] b) method from LoadCaster interface (cheolsoo)
+PIG-3485: Remove CastUtils.bytesToMap(byte[] b) method from LoadCaster interface (cheolsoo) 
 
 PIG-3419: Pluggable Execution Engine (achalsoni81 via cheolsoo)
 
 IMPROVEMENTS
 
+PIG-3295: Casting from bytearray failing after Union even when each field is from a single Loader (knoguchi)
+
 PIG-3444: CONCAT with 2+ input parameters fail (lbendig via daijy)
 
 PIG-3529: Upgrade HBase dependency from 0.95-SNAPSHOT to 0.96 (jarcec via daijy)
diff --git a/src/org/apache/pig/FuncSpec.java b/src/org/apache/pig/FuncSpec.java
index f7e7eac58..5efced956 100644
--- a/src/org/apache/pig/FuncSpec.java
+++ b/src/org/apache/pig/FuncSpec.java
@@ -242,7 +242,8 @@ public class FuncSpec implements Serializable, Cloneable {
     
     @Override
     public int hashCode() {
-        return getClassName().hashCode() + ctorArgs.length;
+        return ctorArgs == null ?  getClassName().hashCode() :
+                                   getClassName().hashCode() + ctorArgs.length;
     }
  
     @Override
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
index 66023e356..84b3b45d6 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
@@ -61,6 +61,7 @@ import org.joda.time.DateTime;
  */
 public class POCast extends ExpressionOperator {
     private final static Log log = LogFactory.getLog(POCast.class);
+    private static final String unknownByteArrayErrorMessage = "Received a bytearray from the UDF or Union from two different Loaders. Cannot determine how to convert the bytearray to "; 
     private FuncSpec funcSpec = null;
     transient private LoadCaster caster;
     private boolean castNotNeeded = false;
@@ -164,7 +165,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToBigInteger(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to BigInteger.";
+                        String msg = unknownByteArrayErrorMessage + "BigInteger.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -280,7 +281,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToBigDecimal(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to BigDecimal.";
+                        String msg = unknownByteArrayErrorMessage + "BigDecimal.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -395,7 +396,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToBoolean(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to boolean.";
+                        String msg = unknownByteArrayErrorMessage + "boolean.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -509,7 +510,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToInteger(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to int.";
+                        String msg = unknownByteArrayErrorMessage + "int.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -635,7 +636,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToLong(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to long.";
+                        String msg = unknownByteArrayErrorMessage + "long.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -758,7 +759,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToDouble(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to double.";
+                        String msg = unknownByteArrayErrorMessage + "double.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -880,7 +881,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToFloat(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to float.";
+                        String msg = unknownByteArrayErrorMessage + "float.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -1006,7 +1007,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToDateTime(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to datetime.";
+                        String msg = unknownByteArrayErrorMessage + "datetime.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -1117,7 +1118,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToCharArray(dba.get());
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to string.";
+                        String msg = unknownByteArrayErrorMessage + "string.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -1269,7 +1270,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToTuple(dba.get(), fieldSchema);
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to tuple.";
+                        String msg = unknownByteArrayErrorMessage + "tuple.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -1331,7 +1332,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToBag(((DataByteArray)obj).get(), fs);
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to bag.";
+                    String msg = unknownByteArrayErrorMessage + "bag.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
             } else {
@@ -1362,7 +1363,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToTuple(((DataByteArray)obj).get(), fs);
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to tuple.";
+                    String msg = unknownByteArrayErrorMessage + "tuple.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
             } else {
@@ -1387,7 +1388,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToMap(((DataByteArray)obj).get(), fs);
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to tuple.";
+                    String msg = unknownByteArrayErrorMessage + "tuple.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
             } else {
@@ -1401,7 +1402,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToBoolean(((DataByteArray) obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to int.";
+                    String msg = unknownByteArrayErrorMessage + "int.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1440,7 +1441,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToInteger(((DataByteArray) obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to int.";
+                    String msg = unknownByteArrayErrorMessage + "int.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1486,7 +1487,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToDouble(((DataByteArray) obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to double.";
+                    String msg = unknownByteArrayErrorMessage + "double.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1532,7 +1533,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToLong(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to long.";
+                    String msg = unknownByteArrayErrorMessage + "long.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1578,7 +1579,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToFloat(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to float.";
+                    String msg = unknownByteArrayErrorMessage + "float.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1624,7 +1625,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToDateTime(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to datetime.";
+                    String msg = unknownByteArrayErrorMessage + "datetime.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1663,7 +1664,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToCharArray(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to float.";
+                    String msg = unknownByteArrayErrorMessage + "float.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1711,7 +1712,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToBigInteger(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to BigInteger.";
+                    String msg = unknownByteArrayErrorMessage + "BigInteger.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1756,7 +1757,7 @@ public class POCast extends ExpressionOperator {
                     result = caster.bytesToBigDecimal(((DataByteArray)obj).get());
                 } else {
                     int errCode = 1075;
-                    String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to BigDecimal.";
+                    String msg = unknownByteArrayErrorMessage + "BigDecimal.";
                     throw new ExecException(msg, errCode, PigException.INPUT);
                 }
                 break;
@@ -1860,7 +1861,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToBag(dba.get(), fieldSchema);
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to bag.";
+                        String msg = unknownByteArrayErrorMessage + "bag.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -1951,7 +1952,7 @@ public class POCast extends ExpressionOperator {
                         res.result = caster.bytesToMap(dba.get(), fieldSchema);
                     } else {
                         int errCode = 1075;
-                        String msg = "Received a bytearray from the UDF. Cannot determine how to convert the bytearray to map.";
+                        String msg = unknownByteArrayErrorMessage + "map.";
                         throw new ExecException(msg, errCode, PigException.INPUT);
                     }
                 } catch (ExecException ee) {
@@ -2036,4 +2037,4 @@ public class POCast extends ExpressionOperator {
     public Tuple illustratorMarkup(Object in, Object out, int eqClassIndex) {
       return (Tuple) out;
     }
-}
\ No newline at end of file
+}
diff --git a/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java b/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
index 4235d8269..b5c44eefb 100644
--- a/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
+++ b/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
@@ -17,14 +17,20 @@
  */
 package org.apache.pig.newplan.logical.visitor;
 
+import java.io.IOException;
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 
 import org.apache.pig.FuncSpec;
+import org.apache.pig.LoadCaster;
+import org.apache.pig.LoadFunc;
 import org.apache.pig.PigException;
 import org.apache.pig.data.DataType;
+import org.apache.pig.impl.PigContext;
+import org.apache.pig.StreamToPig;
 import org.apache.pig.impl.builtin.IdentityColumn;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.plan.VisitorException;
@@ -86,6 +92,8 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
     // then the mapping is stored here
     Map<LogicalRelationalOperator, FuncSpec>  rel2InputFuncMap = 
         new HashMap<LogicalRelationalOperator, FuncSpec>();
+
+    Map<FuncSpec, Class> func2casterMap = new HashMap<FuncSpec, Class>();
     
     public LineageFindRelVisitor(OperatorPlan plan) throws FrontendException {
         super(plan, new DependencyOrderWalker(plan));
@@ -192,7 +200,8 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
         }
         //ensure that all predecessors are mapped to same load func spec
         for(int i=1; i<preds.size(); i++){
-            if(!loadFuncSpec.equals(getAssociatedLoadFunc((LogicalRelationalOperator) preds.get(i)))){
+            if(!haveIdenticalCasters(loadFuncSpec,getAssociatedLoadFunc(
+                    (LogicalRelationalOperator) preds.get(i)))){
                 return;
             }
         }
@@ -218,7 +227,8 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
             if(funcSpec != null) {
                 for(int i=1; i<schema.size(); i++){
                     LogicalFieldSchema fs = schema.getField(i);
-                    if(! funcSpec.equals(uid2LoadFuncMap.get(fs.uid))){
+                    if(! haveIdenticalCasters(funcSpec,
+                            uid2LoadFuncMap.get(fs.uid))){
                         //all uid are not associated with same func spec, there is no
                         // single func spec that represents all the fields
                         funcSpec = null;
@@ -420,8 +430,38 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
         // Since the uid changes for Union, add mappings for new uids to funcspec
         LogicalSchema schema = relOp.getSchema();
         if(schema != null){
+            // For each output field, checking all the fields being
+            // union-ed(bundled) together and only set the funcspec when ALL
+            // of them come from the same caster
+            //
+            // A = (i,j)
+            // B = (i,j)
+            // C = UNION A, B;
+            // Checking if A.i and B.i have the same caster.
+            // Same for A.j and B.j
+            // A.i and A.j may come from the different casters
             for (LogicalFieldSchema logicalFieldSchema : schema.getFields()) {
-                addUidLoadFuncToMap(logicalFieldSchema.uid,rel2InputFuncMap.get(relOp));
+                Set<Long> inputs = relOp.getInputUids(logicalFieldSchema.uid);
+                if( inputs.size() == 0 ) {
+                    // uid was not changed.
+                    // funcspec should be already set. skipping
+                    continue;
+                }
+                FuncSpec prevLoadFuncSpec = null, curLoadFuncSpec = null;
+                boolean allSameLoader = true;
+                for(Long inputUid: inputs) {
+                    curLoadFuncSpec = uid2LoadFuncMap.get(inputUid) ;
+                    if( prevLoadFuncSpec != null
+                      && !haveIdenticalCasters(prevLoadFuncSpec,
+                                               curLoadFuncSpec) ) {
+                        allSameLoader = false;
+                        break;
+                    }
+                  prevLoadFuncSpec  = curLoadFuncSpec;
+                }
+                if( allSameLoader ) {
+                    addUidLoadFuncToMap(logicalFieldSchema.uid,curLoadFuncSpec);
+                }
             }
         }
     }
@@ -483,7 +523,7 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
         FuncSpec curFuncSpec = uid2LoadFuncMap.get(uid);
         if(curFuncSpec == null){
             uid2LoadFuncMap.put(uid, loadFuncSpec);
-        }else if(! curFuncSpec.equals(loadFuncSpec)){
+        }else if(! haveIdenticalCasters(curFuncSpec,loadFuncSpec)){
             String msg = "Bug: uid mapped to two different load functions : " +
             curFuncSpec + " and " + loadFuncSpec;
             throw new VisitorException(msg,2262, PigException.BUG) ;
@@ -524,7 +564,7 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
             
             for(LogicalFieldSchema fs : inputFieldSchemas){
                 //check if all func spec match
-                if(!funcSpec1.equals(uid2LoadFuncMap.get(fs.uid))){
+                if(!haveIdenticalCasters(funcSpec1,uid2LoadFuncMap.get(fs.uid))){
                     allMatch = false;
                 }
                 //check if all inner schema match for use later
@@ -712,7 +752,67 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
 
         
     }
-    
+
+    //Copied from POCast.instantiateFunc
+    private Class instantiateCaster(FuncSpec funcSpec) throws VisitorException {
+        if ( funcSpec == null ) {
+            return null;
+        }
+
+        if( func2casterMap.containsKey(funcSpec) ) {
+          return func2casterMap.get(funcSpec);
+        }
+
+        LoadCaster caster = null;
+        Object obj = PigContext.instantiateFuncFromSpec(funcSpec);
+        try {
+            if (obj instanceof LoadFunc) {
+                caster = ((LoadFunc)obj).getLoadCaster();
+            } else if (obj instanceof StreamToPig) {
+                caster = ((StreamToPig)obj).getLoadCaster();
+            } else {
+                throw new VisitorException("Invalid class type " + funcSpec.getClassName(),
+                                           2270, PigException.BUG );
+            }
+        } catch (IOException e) {
+            throw new VisitorException("Invalid class type " + funcSpec.getClassName(),
+                                         2270, e );
+        }
+
+        Class retval = (caster == null) ? null : caster.getClass();
+        func2casterMap.put(funcSpec, retval);
+        return retval;
+    }
+
+
+    private boolean haveIdenticalCasters(FuncSpec f1, FuncSpec f2)  throws VisitorException{
+        if( f1 == null || f2 == null ) {
+            return false;
+        }
+        if( f1.equals(f2) ) {
+            return true;
+        }
+        Class caster1 = instantiateCaster(f1);
+        Class caster2 = instantiateCaster(f2);
+
+        if( caster1 == null || caster2 == null ) {
+            return false;
+        }
+
+        //From PIG-3295
+        //If the class name for LoadCaster are the same, and LoadCaster only has
+        //default constructor, then two LoadCasters are considered equal
+        if( caster1.getCanonicalName().equals(caster2.getCanonicalName())  &&
+            caster1.getConstructors().length == 1 &&
+            caster1.getConstructors()[0].getGenericParameterTypes().length == 0  &&
+            caster2.getConstructors().length == 1 &&
+            caster2.getConstructors()[0].getGenericParameterTypes().length == 0 ) {
+            return true;
+        }
+
+        return false;
+
+    }
     
     
 }
diff --git a/test/e2e/pig/tests/negative.conf b/test/e2e/pig/tests/negative.conf
index a4876ccb3..f528eeb4f 100644
--- a/test/e2e/pig/tests/negative.conf
+++ b/test/e2e/pig/tests/negative.conf
@@ -567,7 +567,7 @@ c = foreach b generate org.apache.pig.test.udf.evalfunc.CreateMap((chararray)nam
 d = foreach c generate $0#'alice young';
 split d into e if $0 < 42, f if $0 >= 42;
 store e into ':OUTPATH:';\,
-                'expected_err_regex' => "Received a bytearray from the UDF. Cannot determine how to convert the bytearray",
+                'expected_err_regex' => "Received a bytearray from the UDF or Union from two different Loaders. Cannot determine how to convert the bytearray to int",
             },
         ]
         }
diff --git a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
index ab2b82067..5ba116d0a 100644
--- a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
+++ b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
@@ -2679,7 +2679,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a'  using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a'  using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = foreach d generate group, field1 + 1, field4 + 2.0 ;";
@@ -2690,7 +2690,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupMapLookupLineage() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = foreach d generate group, field1#'key' + 1, field4 + 2.0 ;";
@@ -2716,26 +2716,26 @@ public class TestTypeCheckingValidatorNewLP {
             exOp = (LogicalExpression) foreachPlan.getSinks().get(0);
             if(! (exOp instanceof ProjectExpression)) exOp = (LogicalExpression) foreachPlan.getSinks().get(1);
             CastExpression cast = (CastExpression)foreachPlan.getPredecessors(exOp).get(0);
-            checkCastLoadFunc(cast, "PigStorage('b')");
+            checkCastLoadFunc(cast, "org.apache.pig.test.PigStorageWithDifferentCaster('b')");
         }
 
         @Test
         public void testCogroupStarLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by *, b by *;"
             + "d = foreach c generate group, flatten($1), flatten($2);"
             + "e = foreach d generate group, field1 + 1, field4 + 2.0;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupStarLineageFail() throws Throwable {
 
-            String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );"
+            String query = "a = load 'a' using PigStorage('x') as (field1, field2: float, field3: chararray );"
+            + "b = load 'b' using PigStorage('x') as (field4, field5, field6: chararray );"
             + "c = cogroup a by *, b by *;"
             + "d = foreach c generate group, flatten($1), flatten($2);"
             + "e = foreach d generate group + 1, field1 + 1, field4 + 2.0;";
@@ -2774,8 +2774,8 @@ public class TestTypeCheckingValidatorNewLP {
 
         @Test
         public void testCogroupStarLineageNoSchemaFail() throws Throwable {
-            String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'b' using PigStorage('b');"
+            String query = "a = load 'a' using PigStorage('x');"
+            + "b = load 'b' using PigStorage('x');"
             + "c = cogroup a by *, b by *;";
 
             String exMsg= "Cogroup/Group by '*' or 'x..' " +
@@ -2788,33 +2788,33 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupMultiColumnProjectLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, a.(field1, field2), b.(field4);"
             + "e = foreach d generate group, flatten($1), flatten($2);"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupProjectStarLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate *;"
             + "f = foreach d generate group, flatten(a), flatten(b) ;"
             + "g = foreach f generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupProjectStarLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'b' using PigStorage('b');"
+            + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate *;"
             + "f = foreach d generate group, flatten(a), flatten(b) ;"
@@ -2827,7 +2827,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupProjectStarLineageMixSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'b' using PigStorage();"
+            + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster();"
             + "c = cogroup a by field1, b by $0;"
             + "d = foreach c generate *;"
             + "f = foreach d generate group, flatten(a), flatten(b) ;"
@@ -2840,20 +2840,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupLineageFail() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = foreach d generate group + 1, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, null, 0);
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupLineage2NoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = foreach d generate $0, $1 + 1, $2 + 2.0 ;";
@@ -2866,7 +2866,7 @@ public class TestTypeCheckingValidatorNewLP {
         public void testUnionLineage() throws Throwable {
             //here the type checker will insert a cast for the union, converting the column field2 into a float
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = union a , b;"
             + "d = foreach c generate field2 + 2.0 ;";
 
@@ -2888,7 +2888,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testUnionLineageNoSchemaDiffLoadFunc() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = union a , b;"
             + "d = foreach c generate $1 + 2.0 ;";
 
@@ -2909,7 +2909,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testUnionLineageDifferentSchemaFail() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray, field7 );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray, field7 );"
             + "c = union a , b;"
             + "d = foreach c generate $3 + 2.0 ;";
 
@@ -2928,7 +2928,7 @@ public class TestTypeCheckingValidatorNewLP {
             printMessageCollector(collector);
 
             boolean isWarningSeen = false;
-            assertTrue("message collector has message", collector.hasMessage());
+            assertTrue("message collector does not have message", collector.hasMessage());
 
             for (Message msg : collector){
                 if (msg.getMessageType() == MessageType.Warning
@@ -2937,7 +2937,7 @@ public class TestTypeCheckingValidatorNewLP {
                 }
             }
 
-            assertTrue("Expected warning is seen", isWarningSeen);
+            assertTrue("Expected warning is not seen", isWarningSeen);
         }
 
         @Test
@@ -2953,10 +2953,10 @@ public class TestTypeCheckingValidatorNewLP {
 
         @Test
         public void testUnionLineageMixSchemaFail() throws Throwable {
-            // different loader func spec associated with each input, so can't determine
+            // different loader caster associated with each input, so can't determine
             // which one to use on union output
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = union a , b;"
             + "d = foreach c generate $3 + 2.0 ;";
 
@@ -3014,20 +3014,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupFilterLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = filter d by field4 > 5;"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupFilterLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = filter d by $2 > 5;"
@@ -3115,20 +3115,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupSplitLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-                + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+                + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
                 + "c = cogroup a by field1, b by field4;"
                 + "d = foreach c generate group, flatten(a), flatten(b) ;"
                 + "split d into e if field4 > 'm', f if field6 > 'm' ;"
                 + "g = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupSplitLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-                + "b = load 'a' using PigStorage('b');"
+                + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
                 + "c = cogroup a by $0, b by $0;"
                 + "d = foreach c generate group, flatten(a), flatten(b) ;"
                 + "split d into e if $1 > 'm', f if $1 > 'm' ;"
@@ -3158,20 +3158,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupDistinctLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = distinct d;"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupDistinctLineageNoSchema() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage();"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = distinct d;"
@@ -3231,20 +3231,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupSortLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by field4 desc;"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupSortLineageNoSchema() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by $2 desc;"
@@ -3256,20 +3256,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupSortStarLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by * desc;"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupSortStarLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by * desc;"
@@ -3282,12 +3282,12 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCrossLineage() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cross a, b;"
             + "d = foreach c generate field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')",0);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')",1);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')",1);
         }
 
         @Test
@@ -3303,7 +3303,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCrossLineageNoSchemaFail() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cross a , b;"
             + "d = foreach c generate $1 + 2.0 ;";
 
@@ -3324,7 +3324,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCrossLineageMixSchemaFail() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cross a , b;"
             + "d = foreach c generate $3 + 2.0 ;";
 
@@ -3334,12 +3334,12 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testJoinLineage() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = join a by field1, b by field4;"
             + "d = foreach c generate field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 0);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 1);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 1);
 
         }
 
@@ -3358,7 +3358,7 @@ public class TestTypeCheckingValidatorNewLP {
             //this test case should change when we decide on what flattening a tuple or bag
             //with null schema results in a foreach flatten and hence a join
             String query =  "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage();"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();"
             + "c = join a by $0, b by $0;"
             + "d = foreach c generate $1 + 2.0 ;";
 
@@ -3379,7 +3379,7 @@ public class TestTypeCheckingValidatorNewLP {
             //this test case should change when we decide on what flattening a tuple or bag
             //with null schema results in a foreach flatten and hence a join
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage();"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();"
             + "c = join a by field1, b by $0;"
             + "d = foreach c generate $3 + 2.0 ;";
 
@@ -3407,20 +3407,20 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupLimitLineage() throws Throwable {
             String query = "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = limit d 100;"
             + "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupLimitLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = limit d 100;"
@@ -3433,7 +3433,7 @@ public class TestTypeCheckingValidatorNewLP {
         @Test
         public void testCogroupTopKLineage() throws Throwable {
             String query =  "a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );"
-            + "b = load 'a' using PigStorage('b') as (field4, field5, field6: chararray );"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );"
             + "c = cogroup a by field1, b by field4;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by field1 desc;"
@@ -3441,13 +3441,13 @@ public class TestTypeCheckingValidatorNewLP {
             + "g = foreach f generate group, field1 + 1, field4 + 2.0 ;";
 
             checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
-            checkLastForeachCastLoadFunc(query, "PigStorage('b')", 2);
+            checkLastForeachCastLoadFunc(query, "org.apache.pig.test.PigStorageWithDifferentCaster('b')", 2);
         }
 
         @Test
         public void testCogroupTopKLineageNoSchema() throws Throwable {
             String query = "a = load 'a' using PigStorage('a');"
-            + "b = load 'a' using PigStorage('b');"
+            + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');"
             + "c = cogroup a by $0, b by $0;"
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = order d by $2 desc;"
@@ -3496,8 +3496,13 @@ public class TestTypeCheckingValidatorNewLP {
             + "d = foreach c generate group, flatten(a), flatten(b) ;"
             + "e = foreach d generate $0, $1 + 1, $2 + 2.0 ;";
 
-            checkLastForeachCastLoadFunc(query, null, 1);
-            checkLastForeachCastLoadFunc(query, null, 2);
+            // PigStorage and PigStreaming both returns Utf8StorageConverter so
+            // it may return either PigStorage or PigStreaming.
+            // Here, our code happens to return the first one thus
+            // checking with PigStorage.  Depending on the implementation,
+            // this test may start failing.
+            checkLastForeachCastLoadFunc(query, "PigStorage('a')", 1);
+            checkLastForeachCastLoadFunc(query, "PigStorage('a')", 2);
         }
 
         @Test
diff --git a/test/org/apache/pig/test/TestUnion.java b/test/org/apache/pig/test/TestUnion.java
index 1e006362c..e3c30a779 100644
--- a/test/org/apache/pig/test/TestUnion.java
+++ b/test/org/apache/pig/test/TestUnion.java
@@ -278,4 +278,94 @@ public class TestUnion {
         assertEquals(2, recordCount);
 
     }
-}
\ No newline at end of file
+    @Test
+    public void testCastingAfterUnionWithMultipleLoadersDifferentCasters()
+        throws Exception {
+        // Note that different caster case only works when each field is still coming
+        // from the single Loader.
+        // In the case below, 'a' is coming from A(PigStorage)
+        // and 'b' is coming from B(TextLoader). No overlaps.
+        File f1 = Util.createInputFile("tmp", "i1.txt", new String[] {"1","2","3"});
+        File f2 = Util.createInputFile("tmp", "i2.txt", new String[] {"a","b","c"});
+
+        PigServer ps = new PigServer(ExecType.LOCAL, new Properties());
+        //PigStorage and TextLoader have different LoadCasters
+        ps.registerQuery("A = load '" + f1.getAbsolutePath() + "' as (a:bytearray);");
+        ps.registerQuery("B = load '" + f2.getAbsolutePath() + "' using TextLoader() as (b:bytearray);");
+        ps.registerQuery("C = union onschema A,B;");
+        ps.registerQuery("D = foreach C generate (int)a as a,(chararray)b as b;");
+
+        Schema dumpSchema = ps.dumpSchema("D");
+        Schema expected = new Schema ();
+        expected.add(new Schema.FieldSchema("a", DataType.INTEGER));
+        expected.add(new Schema.FieldSchema("b", DataType.CHARARRAY));
+        assertEquals(expected, dumpSchema);
+
+        Iterator<Tuple> itr = ps.openIterator("D");
+        int recordCount = 0;
+        while(itr.next() != null)
+            ++recordCount;
+        assertEquals(6, recordCount);
+
+    }
+
+    @Test
+    public void testCastingAfterUnionWithMultipleLoadersDifferentCasters2()
+        throws Exception {
+        // A bit more complicated pattern but still same requirement of each
+        // field coming from the same Loader.
+        // 'a' is coming from A(PigStorage)
+        // 'i' is coming from B and C but both from the TextLoader.
+        File f1 = Util.createInputFile("tmp", "i1.txt", new String[] {"b","c", "1", "3"});
+        File f2 = Util.createInputFile("tmp", "i2.txt", new String[] {"a","b","c"});
+        File f3 = Util.createInputFile("tmp", "i3.txt", new String[] {"1","2","3"});
+
+        PigServer ps = new PigServer(ExecType.LOCAL, new Properties());
+        ps.registerQuery("A = load '" + f1.getAbsolutePath() + "' as (a:bytearray);"); // Using PigStorage()
+        ps.registerQuery("B = load '" + f2.getAbsolutePath() + "' using TextLoader() as (i:bytearray);");
+        ps.registerQuery("C = load '" + f3.getAbsolutePath() + "' using TextLoader() as (i:bytearray);");
+        ps.registerQuery("B2 = join B by i, A by a;");              //{A::a: bytearray,B::i: bytearray}
+        ps.registerQuery("B3 = foreach B2 generate a, B::i as i;"); //{A::a: bytearray,i: bytearray}
+        ps.registerQuery("C2 = join C by i, A by a;");              //{A::a: bytearray,C::i: bytearray}
+        ps.registerQuery("C3 = foreach C2 generate a, C::i as i;"); //{A::a: bytearray,i: bytearray}
+        ps.registerQuery("D = union onschema B3,C3;");              // {A::a: bytearray,i: bytearray}
+        ps.registerQuery("E = foreach D generate (chararray) a, (chararray) i;");//{A::a: chararray,i: chararray}
+        Iterator<Tuple> itr = ps.openIterator("E");
+        int recordCount = 0;
+        while(itr.next() != null)
+            ++recordCount;
+        assertEquals(4, recordCount);
+
+    }
+
+    @Test
+    public void testCastingAfterUnionWithMultipleLoadersSameCaster()
+        throws Exception {
+        // Fields coming from different loaders but
+        // having the same LoadCaster.
+        File f1 = Util.createInputFile("tmp", "i1.txt", new String[] {"1\ta","2\tb","3\tc"});
+        PigServer ps = new PigServer(ExecType.LOCAL, new Properties());
+        // PigStorage and PigStorageWithStatistics have the same
+        // LoadCaster(== Utf8StorageConverter)
+        ps.registerQuery("A = load '" + f1.getAbsolutePath() + "' as (a:bytearray, b:bytearray);");
+        ps.registerQuery("B = load '" + f1.getAbsolutePath() +
+          "' using org.apache.pig.test.PigStorageWithStatistics() as (a:bytearray, b:bytearray);");
+        ps.registerQuery("C = union onschema A,B;");
+        ps.registerQuery("D = foreach C generate (int)a as a,(chararray)b as b;");
+        // 'a' is coming from A and 'b' is coming from B; No overlaps.
+
+        Schema dumpSchema = ps.dumpSchema("D");
+        Schema expected = new Schema ();
+        expected.add(new Schema.FieldSchema("a", DataType.INTEGER));
+        expected.add(new Schema.FieldSchema("b", DataType.CHARARRAY));
+        assertEquals(expected, dumpSchema);
+
+        Iterator<Tuple> itr = ps.openIterator("D");
+        int recordCount = 0;
+        while(itr.next() != null)
+            ++recordCount;
+        assertEquals(6, recordCount);
+
+    }
+
+}
