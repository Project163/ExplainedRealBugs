diff --git a/CHANGES.txt b/CHANGES.txt
index 0398e712d..b80edc816 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -159,3 +159,5 @@ Trunk (unreleased changes)
     PIG-301: fix for order by descending
 
     PIG-378: fix for GENERATE + LIMIT
+
+    PIG-362: don't push limit above generate with flatten
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java b/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
index 56751f217..acd031060 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
@@ -135,17 +135,16 @@ public class OpLimitOptimizer extends LogicalTransformer {
         }
         // Limit can be duplicated, and the new instance pushed in front of an operator for the following operators 
         // (that is, if you have X->limit, you can transform that to limit->X->limit):
-        else if (predecessor instanceof LOCross || 
-        		predecessor instanceof LOForEach || predecessor instanceof LOUnion)
+        else if (predecessor instanceof LOCross || predecessor instanceof LOUnion)
         {
         	LOLimit newLimit = null;
-			// Process the predecessors with only one input. LOForEach should now have at least
-			// one flaten
-			if (predecessor instanceof LOForEach)
+			List<LogicalOperator> nodesToProcess = new ArrayList<LogicalOperator>();
+			for (LogicalOperator prepredecessor:mPlan.getPredecessors(predecessor))
+				nodesToProcess.add(prepredecessor);
+			for (LogicalOperator prepredecessor:nodesToProcess)
 			{
-				LogicalOperator prepredecessor = mPlan.getPredecessors(predecessor).get(0);
 				try {
-					newLimit = limit.duplicate();
+					newLimit = (LOLimit)limit.duplicate();
 					insertBetween(prepredecessor, newLimit, predecessor, null);
 				} catch (Exception e) {
 					throw new OptimizerException("Can not insert LOLimit clone", e);
@@ -153,24 +152,6 @@ public class OpLimitOptimizer extends LogicalTransformer {
 				// we can move the new LOLimit even further, recursively optimize LOLimit
 				processNode(newLimit);
 			}
-			// Now comes predecessors with multiple inputs
-			else if (predecessor instanceof LOCross || predecessor instanceof LOUnion)
-			{
-				List<LogicalOperator> nodesToProcess = new ArrayList<LogicalOperator>();
-				for (LogicalOperator prepredecessor:mPlan.getPredecessors(predecessor))
-					nodesToProcess.add(prepredecessor);
-				for (LogicalOperator prepredecessor:nodesToProcess)
-				{
-					try {
-						newLimit = (LOLimit)limit.duplicate();
-						insertBetween(prepredecessor, newLimit, predecessor, null);
-					} catch (Exception e) {
-						throw new OptimizerException("Can not insert LOLimit clone", e);
-					}
-					// we can move the new LOLimit even further, recursively optimize LOLimit
-					processNode(newLimit);
-				}
-			}
         }
         // Limit can be merged into LOSort, result a "limited sort"
         else if (predecessor instanceof LOSort)
diff --git a/test/org/apache/pig/test/TestLogicalOptimizer.java b/test/org/apache/pig/test/TestLogicalOptimizer.java
index e5e36b67a..fd7c3310e 100644
--- a/test/org/apache/pig/test/TestLogicalOptimizer.java
+++ b/test/org/apache/pig/test/TestLogicalOptimizer.java
@@ -147,5 +147,15 @@ public class TestLogicalOptimizer extends junit.framework.TestCase {
 	    optimizePlan(plan);
 	    compareWithGoldenFile(plan, FILE_BASE_LOCATION + "optlimitplan6.dot");
 	}
+    
+    @Test
+    // Limit stay the same for ForEach with a flatten
+    public void testOPLimit7Optimizer() throws Exception {
+        planTester.buildPlan("A = load 'myfile1';");
+        planTester.buildPlan("B = foreach A generate flatten($0);");
+        LogicalPlan plan = planTester.buildPlan("C = limit B 100;");
+        optimizePlan(plan);
+        compareWithGoldenFile(plan, FILE_BASE_LOCATION + "optlimitplan7.dot");
+    }
 }
 
diff --git a/test/org/apache/pig/test/data/DotFiles/optlimitplan7.dot b/test/org/apache/pig/test/data/DotFiles/optlimitplan7.dot
new file mode 100644
index 000000000..70088e746
--- /dev/null
+++ b/test/org/apache/pig/test/data/DotFiles/optlimitplan7.dot
@@ -0,0 +1,6 @@
+digraph graph1 {
+    LOLoad47 -> LOForEach50;
+    LOForEach50 [hasflat="true"];
+    LOForEach50 -> LOLimit51;
+    LOLimit51 [limit="100"];
+}
\ No newline at end of file
