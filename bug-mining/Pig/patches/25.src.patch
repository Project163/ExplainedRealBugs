diff --git a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
index 1c72df783..3cd26aa6b 100644
--- a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
+++ b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
@@ -2598,7 +2598,7 @@ Object AtomDatum():
 	t = <INTEGER> {obj = new Integer(Integer.parseInt(t.image));}
 |	t = <LONGINTEGER> 
     {
-        String num = t.image.substring(0, t.image.length() - 2);
+        String num = t.image.substring(0, t.image.length() - 1);
         obj = new Long(Long.parseLong(num));
     }
 |	t = <FLOATNUMBER> {obj = new Float(Float.parseFloat(t.image));}
diff --git a/test/org/apache/pig/test/TestTypeChecking.java b/test/org/apache/pig/test/TestTypeChecking.java
index 1459b662c..1a5e76eb7 100644
--- a/test/org/apache/pig/test/TestTypeChecking.java
+++ b/test/org/apache/pig/test/TestTypeChecking.java
@@ -258,5 +258,13 @@ public class TestTypeChecking extends TestCase {
     }
 
 
+    public void testGenerate1() throws Throwable {
+        TypeCheckingTestUtil.printCurrentMethodName() ;
+        planTester.buildPlan("a = load '/user/pig/tests/data/singlefile/studenttab10k' as (name:chararray, age:int, gpa:double);") ;
+        LogicalPlan plan1 = planTester.buildPlan("b = foreach a generate 1 + 0.2f + 253645L, gpa+1; ") ;
+        planTester.typeCheckPlan(plan1);
+    }
+
+
 
 }
diff --git a/test/org/apache/pig/test/TypeGraphPrinter.java b/test/org/apache/pig/test/TypeGraphPrinter.java
index e4c57be49..484cf73eb 100644
--- a/test/org/apache/pig/test/TypeGraphPrinter.java
+++ b/test/org/apache/pig/test/TypeGraphPrinter.java
@@ -62,6 +62,76 @@ public class TypeGraphPrinter extends LOVisitor {
     protected void visit(UnaryExpressionOperator op) {               
         appendOp(op) ;
     }
+
+
+    public void visit(LOGreaterThan op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOLesserThan op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOGreaterThanEqual op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOLesserThanEqual op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOEqual op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LONotEqual op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOAdd op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOSubtract op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOMultiply op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LODivide op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOMod op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+
+	public void visit(LONegative op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOMapLookup op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOAnd op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOOr op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LONot op) throws VisitorException {
+		appendOp(op) ;
+	}
+
+	public void visit(LOIsNull op) throws VisitorException {
+		appendOp(op) ;
+	}
     
     protected void visit(LOCogroup op) throws VisitorException {
         appendOp(op) ;
