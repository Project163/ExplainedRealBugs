diff --git a/CHANGES.txt b/CHANGES.txt
index 04dd712c6..2cc77b7ee 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -256,6 +256,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3292: Logical plan invalid state: duplicate uid in schema during self-join to get cross product (cheolsoo via daijy)
+
 PIG-3491: Fix e2e failure Jython_Diagnostics_4 (daijy)
 
 PIG-3434: Null subexpression in bincond nullifies outer tuple (or bag) (mwagner via daijy)
diff --git a/src/org/apache/pig/newplan/logical/relational/LOCross.java b/src/org/apache/pig/newplan/logical/relational/LOCross.java
index 503511d9a..2d26e433c 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOCross.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOCross.java
@@ -78,6 +78,10 @@ public class LOCross extends LogicalRelationalOperator {
             }            
         }        
 
+        if (nested) {
+            LogicalRelationalOperator.fixDuplicateUids(fss);
+        }
+
         schema = new LogicalSchema();
         for(LogicalSchema.LogicalFieldSchema fieldSchema: fss) {
             schema.addField(fieldSchema);
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index 70c7883d5..86cc4cdaf 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -24,6 +24,7 @@ import java.io.IOException;
 import java.io.PrintStream;
 import java.io.PrintWriter;
 import java.util.ArrayList;
+import java.util.Collection;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Iterator;
@@ -1145,4 +1146,31 @@ public class TestEvalPipelineLocal {
         Assert.assertTrue(iter.next().toString().equals("(NASDAQ)"));
         Assert.assertFalse(iter.hasNext());
     }
+    
+    // Self cross, see PIG-3292
+    @Test
+    public void testSelfCross() throws Exception{
+        File f1 = createFile(new String[]{"1\t2", "1\t3"});
+        
+        pigServer.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(f1.toString(), pigServer.getPigContext()))
+                + "' as (key, x);");
+        pigServer.registerQuery("a_group = group a by key;");
+        pigServer.registerQuery("b = foreach a_group {y = a.x;pair = cross a.x, y;"
+                + "generate flatten(pair);}");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("b");
+        
+        Collection<String> results = new HashSet<String>();
+        results.add("(3,3)");
+        results.add("(2,2)");
+        results.add("(3,2)");
+        results.add("(2,3)");
+        
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        
+        Assert.assertFalse(iter.hasNext());
+    }
 }
