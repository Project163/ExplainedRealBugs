diff --git a/CHANGES.txt b/CHANGES.txt
index b5f72634f..39452d1fc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -457,6 +457,8 @@ Release 0.9.3 - Unreleased
 
 BUG FIXES
 
+PIG-2442: Multiple Stores in pig streaming causes infinite waiting (daijy)
+
 PIG-2609: e2e harness: make hdfs base path configurable (outside default.conf) (thw via daijy)
 
 PIG-2576: Change in behavior for UDFContext.getUDFContext().getJobConf() in front-end (thw via daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PhyPlanSetter.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PhyPlanSetter.java
index 94c4af75d..48d2f1311 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PhyPlanSetter.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PhyPlanSetter.java
@@ -17,6 +17,8 @@
  */
 package org.apache.pig.backend.hadoop.executionengine.mapReduceLayer;
 
+import java.util.List;
+
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.*;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.*;
@@ -99,7 +101,15 @@ public class PhyPlanSetter extends PhyPlanVisitor {
     
     @Override
     public void visitSplit(POSplit spl) throws VisitorException{
-        super.visitSplit(spl);
+        PhysicalPlan oldPlan = parent;
+        List<PhysicalPlan> plans = spl.getPlans();
+        for (PhysicalPlan plan : plans) {
+            parent = plan;
+            pushWalker(mCurrentWalker.spawnChildWalker(plan));
+            visit();
+            popWalker();
+        }
+        parent=oldPlan;
         spl.setParentPlan(parent);
     }
     
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POSplit.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POSplit.java
index fbff723c2..2c1457a35 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POSplit.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POSplit.java
@@ -291,6 +291,9 @@ public class POSplit extends PhysicalOperator {
             } 
             
             int idx = processedSet.nextClearBit(0);
+            if (inpEOP && parentPlan.endOfAllInput) {
+                myPlans.get(idx).endOfAllInput = true;
+            }
             PhysicalOperator leaf = myPlans.get(idx).getLeaves().get(0);
             
             res = leaf.getNext(dummyTuple);
diff --git a/test/org/apache/pig/test/TestStreamingLocal.java b/test/org/apache/pig/test/TestStreamingLocal.java
index 3e0990668..b74507411 100644
--- a/test/org/apache/pig/test/TestStreamingLocal.java
+++ b/test/org/apache/pig/test/TestStreamingLocal.java
@@ -20,6 +20,7 @@ package org.apache.pig.test;
 import java.io.File;
 import java.util.ArrayList;
 import java.util.Iterator;
+import java.util.List;
 
 import junit.framework.TestCase;
 
@@ -289,36 +290,45 @@ public class TestStreamingLocal extends TestCase {
     }
     
     @Test
-    public void testJoinTwoStreamingRelations() 
+    // See PIG-2442
+    public void testTwoStreamingMultiStore() 
     throws Exception {
-        ArrayList<String> list = new ArrayList<String>();
-        for (int i=0; i<10000; i++) {
-            list.add("A," + i);
-        }
-        File input = Util.createInputFile("tmp", "", list.toArray(new String[0]));
+        File input = File.createTempFile("tmp", "");
+        input.delete();
+        Util.createLocalInputFile(input.getAbsolutePath(), new String[] {"first", "second", "third"});
         
-        // Expected results
-        Tuple expected = TupleFactory.getInstance().newTuple(4);
-        expected.set(0, "A");
-        expected.set(1, 0);
-        expected.set(2, "A");
-        expected.set(3, 0);        
+        File output1 = File.createTempFile("tmp", "");
+        output1.delete();
         
-        pigServer.registerQuery("A = load 'file:" + Util.encodeEscape(input.toString()) + "' using " + 
-                    PigStorage.class.getName() + "(',') as (a0, a1);");
-        pigServer.registerQuery("B = stream A through `head -1` as (a0, a1);");
-        pigServer.registerQuery("C = load 'file:" + Util.encodeEscape(input.toString()) + "' using " + 
-                PigStorage.class.getName() + "(',') as (a0, a1);");
-        pigServer.registerQuery("D = stream C through `head -1` as (a0, a1);");
-        pigServer.registerQuery("E = join B by a0, D by a0;");
+        File output2 = File.createTempFile("tmp", "");
+        output2.delete();   
+        
+        pigServer.setBatchOn();
+        pigServer.registerQuery("A = load '" + input.getAbsolutePath() + "';");
+        pigServer.registerQuery("B1 = stream A through `cat`;");
+        pigServer.registerQuery("B1 = foreach B1 generate $0;");
+        pigServer.registerQuery("STORE B1 INTO '" + output1.getAbsolutePath() + "' USING PigStorage();");
+        pigServer.registerQuery("B2 =  STREAM B1 THROUGH `cat`;");
+        pigServer.registerQuery("STORE B2 INTO '" + output2.getAbsolutePath() + "' USING PigStorage();");
+        
+        pigServer.executeBatch();
+        
+        List<Tuple> list = Util.readFile2TupleList(output1.getAbsolutePath() + File.separator + 
+                "part-m-00000", "\t");
+        assertTrue(list.get(0).get(0).equals("first"));
+        assertTrue(list.get(1).get(0).equals("second"));
+        assertTrue(list.get(2).get(0).equals("third"));
+        
+        list = Util.readFile2TupleList(output2.getAbsolutePath() + File.separator + 
+                "part-m-00000", "\t");
+        assertTrue(list.get(0).get(0).equals("first"));
+        assertTrue(list.get(1).get(0).equals("second"));
+        assertTrue(list.get(2).get(0).equals("third"));
+    }
+    
+    @Test
+    public void testJoinTwoStreamingRelations() {
         
-        Iterator<Tuple> iter = pigServer.openIterator("E");
-        int count = 0;
-        while (iter.hasNext()) {
-            Assert.assertEquals(expected.toString(), iter.next().toString());
-            count++;
-        }
-        Assert.assertTrue(count == 1);
     }
 
     @Test
