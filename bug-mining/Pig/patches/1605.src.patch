diff --git a/CHANGES.txt b/CHANGES.txt
index 7be97cc4b..21115b21b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -94,6 +94,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4184: UDF backward compatibility issue after POStatus.STATUS_NULL refactory (daijy)
+
 PIG-4238: Property 'pig.job.converted.fetch' should be unset when fetch finishes (lbendig)
 
 PIG-4151: Pig Cannot Write Empty Maps to HBase (daijy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/ExtremalTupleByNthField.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/ExtremalTupleByNthField.java
index c6ecd05a2..502cd9140 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/ExtremalTupleByNthField.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/ExtremalTupleByNthField.java
@@ -289,6 +289,9 @@ public class ExtremalTupleByNthField extends EvalFunc<Tuple> implements
 	@SuppressWarnings("unchecked")
 	protected final static Tuple extreme(int pind, int psign, Tuple input,
 			PigProgressable reporter) throws ExecException {
+	    if (input == null || input.size() == 0 || input.get(0) == null) {
+	        return null;
+	    }
 		DataBag values = (DataBag) input.get(0);
 
 		// if we were handed an empty bag, return NULL
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/CustomFormatToISO.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/CustomFormatToISO.java
index 06f795b60..e08c9a8d6 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/CustomFormatToISO.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/CustomFormatToISO.java
@@ -76,6 +76,9 @@ public class CustomFormatToISO extends EvalFunc<String> {
             return null;
         }
 
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/ISOToUnix.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/ISOToUnix.java
index c26a7576c..f27c2acc3 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/ISOToUnix.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/ISOToUnix.java
@@ -77,7 +77,7 @@ public class ISOToUnix extends EvalFunc<Long> {
     @Override
     public Long exec(Tuple input) throws IOException
     {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
         
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/UnixToISO.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/UnixToISO.java
index 43d9edd09..9d5692857 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/UnixToISO.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/convert/UnixToISO.java
@@ -77,7 +77,7 @@ public class UnixToISO extends EvalFunc<String> {
     @Override
     public String exec(Tuple input) throws IOException
     {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
         
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISODaysBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISODaysBetween.java
index 7782d7d0f..04daa3e59 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISODaysBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISODaysBetween.java
@@ -93,6 +93,9 @@ public class ISODaysBetween extends EvalFunc<Long> {
             return null;
         }
 
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOHoursBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOHoursBetween.java
index cb33ba2ff..81f5a25a5 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOHoursBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOHoursBetween.java
@@ -88,7 +88,10 @@ public class ISOHoursBetween extends EvalFunc<Long> {
         if (input == null || input.size() < 2) {
             return null;
         }
-        
+
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMinutesBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMinutesBetween.java
index 00d980ee3..cf5eb615b 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMinutesBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMinutesBetween.java
@@ -88,7 +88,10 @@ public class ISOMinutesBetween extends EvalFunc<Long> {
         if (input == null || input.size() < 2) {
             return null;
         }
-        
+
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMonthsBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMonthsBetween.java
index 483346ccd..e55a730b4 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMonthsBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOMonthsBetween.java
@@ -91,7 +91,10 @@ public class ISOMonthsBetween extends EvalFunc<Long> {
         if (input == null || input.size() < 2) {
             return null;
         }
-        
+
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOSecondsBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOSecondsBetween.java
index 297c4c66a..934449061 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOSecondsBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOSecondsBetween.java
@@ -87,7 +87,10 @@ public class ISOSecondsBetween extends EvalFunc<Long> {
         if (input == null || input.size() < 2) {
             return null;
         }
-        
+
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOYearsBetween.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOYearsBetween.java
index c60e64b09..e0ee47dc4 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOYearsBetween.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/diff/ISOYearsBetween.java
@@ -88,7 +88,10 @@ public class ISOYearsBetween extends EvalFunc<Long> {
         if (input == null || input.size() < 2) {
             return null;
         }
-        
+
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
         // Set the time to default or the output is in UTC
         DateTimeZone.setDefault(DateTimeZone.UTC);
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToDay.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToDay.java
index 07836f88b..5d95c632f 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToDay.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToDay.java
@@ -84,7 +84,7 @@ public class ISOToDay extends EvalFunc<String> {
     
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToHour.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToHour.java
index 7967cf6da..832d0a142 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToHour.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToHour.java
@@ -84,7 +84,7 @@ public class ISOToHour extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }        
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMinute.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMinute.java
index 2ea660605..6618e1455 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMinute.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMinute.java
@@ -84,7 +84,7 @@ public class ISOToMinute extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMonth.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMonth.java
index 0854e3a29..58526cd0d 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMonth.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToMonth.java
@@ -85,7 +85,7 @@ public class ISOToMonth extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToSecond.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToSecond.java
index 9c3bfe3a1..c0f3d0a11 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToSecond.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToSecond.java
@@ -85,7 +85,7 @@ public class ISOToSecond extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToWeek.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToWeek.java
index 58eec890e..7afb11b4b 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToWeek.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToWeek.java
@@ -86,7 +86,7 @@ public class ISOToWeek extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToYear.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToYear.java
index f175c3c30..a872a2bfb 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToYear.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/datetime/truncate/ISOToYear.java
@@ -85,7 +85,7 @@ public class ISOToYear extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-        if (input == null || input.size() < 1) {
+        if (input == null || input.size() < 1 || input.get(0) == null) {
             return null;
         }
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ABS.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ABS.java
index 8b9280217..56a0c1fe6 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ABS.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ABS.java
@@ -71,7 +71,7 @@ public class ABS extends EvalFunc<Double>{
 	 * @param output returns a single numeric value, absolute value of the argument
 	 */
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Double d;
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleAbs.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleAbs.java
index 27337d882..bf9cce2e5 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleAbs.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleAbs.java
@@ -67,7 +67,7 @@ public class DoubleAbs extends EvalFunc<Double>{
 	 * @param output returns a single numeric value, absolute value of the argument
 	 */
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Double d;
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleCopySign.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleCopySign.java
index 7d1c6ce6f..934538717 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleCopySign.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleCopySign.java
@@ -67,6 +67,9 @@ public class DoubleCopySign extends EvalFunc<Double>{
 	public Double exec(Tuple input) throws IOException {
         if (input == null || input.size() < 2)
             return null;
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			double first =  (Double)input.get(0);
 			double second = (Double)input.get(1);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleGetExponent.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleGetExponent.java
index 59a8646c0..2c3ced4a0 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleGetExponent.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleGetExponent.java
@@ -62,7 +62,7 @@ public class DoubleGetExponent extends EvalFunc<Integer>{
 	 * exponent used in the representation of a double
 	 */
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try {
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextAfter.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextAfter.java
index 4ea408333..7541ebd41 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextAfter.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextAfter.java
@@ -70,6 +70,12 @@ public class DoubleNextAfter extends EvalFunc<Double>{
 	 */
 	@Override
 	public Double exec(Tuple input) throws IOException {
+	    if (input == null || input.size() < 2) {
+	        return null;
+	    }
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			double first = (Double)input.get(0);
 			double second = (Double)input.get(0);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextup.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextup.java
index ed04d48a9..44cd7148b 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextup.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleNextup.java
@@ -61,7 +61,7 @@ public class DoubleNextup extends EvalFunc<Double>{
      * @param output returns a single numeric value, nextup value of the argument
      */
     public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
         Double d;
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleRound.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleRound.java
index 8d5f43324..d8b110389 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleRound.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleRound.java
@@ -68,7 +68,7 @@ public class DoubleRound extends EvalFunc<Long>{
 	 */
 	@Override
 	public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleSignum.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleSignum.java
index d7bce5a6e..609b2a69c 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleSignum.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleSignum.java
@@ -62,7 +62,7 @@ public class DoubleSignum extends EvalFunc<Double>{
 	 */
 	@Override
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleUlp.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleUlp.java
index 92db8ace8..702a3da64 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleUlp.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/DoubleUlp.java
@@ -66,7 +66,7 @@ public class DoubleUlp extends EvalFunc<Double>{
 	 * the size of an ulp of the argument.
 	 */
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatAbs.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatAbs.java
index ae5aee228..aa0a27f11 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatAbs.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatAbs.java
@@ -67,7 +67,7 @@ public class FloatAbs extends EvalFunc<Float>{
 	 * @param output returns a single numeric value, absolute value of the argument
 	 */
 	public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Float d;
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatCopySign.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatCopySign.java
index 3c7d388c7..24affee66 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatCopySign.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatCopySign.java
@@ -67,6 +67,9 @@ public class FloatCopySign extends EvalFunc<Float>{
 	public Float exec(Tuple input) throws IOException {
         if (input == null || input.size() < 2)
             return null;
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			float first =  (Float)input.get(0);
 			float second = (Float)input.get(1);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatGetExponent.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatGetExponent.java
index a13ffe903..bd842a803 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatGetExponent.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatGetExponent.java
@@ -62,7 +62,7 @@ public class FloatGetExponent extends EvalFunc<Integer>{
 	 * exponent used in the representation of a double
 	 */
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try {
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMax.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMax.java
index 3164fbf20..dc045ae1f 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMax.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMax.java
@@ -60,9 +60,8 @@ public class FloatMax extends EvalFunc<Float>{
      * @param output returns a single numeric value, which is the smaller of two inputs
      */
     public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
-
         try{
             Float first = (Float)input.get(0);
             Float second = (Float)input.get(1);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMin.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMin.java
index 3e835dc60..1ca052459 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMin.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatMin.java
@@ -60,9 +60,8 @@ public class FloatMin extends EvalFunc<Float>{
 	 * @param output returns a single numeric value, which is the smaller of two inputs
 	 */
 	public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
-
         try{
             Float first = (Float)input.get(0);
             Float second = (Float)input.get(1);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextAfter.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextAfter.java
index c20b08212..e3d49698d 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextAfter.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextAfter.java
@@ -70,6 +70,11 @@ public class FloatNextAfter extends EvalFunc<Float>{
 	 */
 	@Override
 	public Float exec(Tuple input) throws IOException {
+        if (input == null || input.size() < 2)
+            return null;
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			Float first = (Float)input.get(0);
 			Double second = (Double)input.get(0);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextup.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextup.java
index 3f54e3e63..676b34c0e 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextup.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatNextup.java
@@ -61,7 +61,7 @@ public class FloatNextup extends EvalFunc<Float>{
      * @param output returns a single numeric value, nextup value of the argument
      */
     public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
         Float d;
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatRound.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatRound.java
index 9e1a004a2..8dc554816 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatRound.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatRound.java
@@ -68,7 +68,7 @@ public class FloatRound extends EvalFunc<Integer>{
 	 */
 	@Override
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatSignum.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatSignum.java
index 919b267c9..a19e03b18 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatSignum.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatSignum.java
@@ -62,7 +62,7 @@ public class FloatSignum extends EvalFunc<Float>{
 	 */
 	@Override
 	public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatUlp.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatUlp.java
index 6da7613e6..e5703c79a 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatUlp.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/FloatUlp.java
@@ -66,7 +66,7 @@ public class FloatUlp extends EvalFunc<Float>{
 	 * the size of an ulp of the argument.
 	 */
 	public Float exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntAbs.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntAbs.java
index e6b3ea0fe..63363c696 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntAbs.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntAbs.java
@@ -66,7 +66,7 @@ public class IntAbs extends EvalFunc<Integer>{
 	 * @param output returns a single numeric value, absolute value of the argument
 	 */
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Integer d;
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMax.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMax.java
index 95ada5fea..a74877f18 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMax.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMax.java
@@ -60,7 +60,7 @@ public class IntMax extends EvalFunc<Integer>{
      * @param output returns a single numeric value, which is the smaller of two inputs
      */
     public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMin.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMin.java
index d53e750a3..a6439aeb5 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMin.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/IntMin.java
@@ -60,7 +60,7 @@ public class IntMin extends EvalFunc<Integer>{
      * @param output returns a single numeric value, which is the smaller of two inputs
      */
     public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongAbs.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongAbs.java
index fb55c12e4..f9d6dcc59 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongAbs.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongAbs.java
@@ -67,7 +67,7 @@ public class LongAbs extends EvalFunc<Long>{
 	 * @param output returns a single numeric value, absolute value of the argument
 	 */
 	public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Long d;
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMax.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMax.java
index 4746a5e00..5094d9886 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMax.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMax.java
@@ -60,7 +60,7 @@ public class LongMax extends EvalFunc<Long>{
      * @param output returns a single numeric value, which is the smaller of two inputs
      */
     public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMin.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMin.java
index 120e63ff4..0ff421e6e 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMin.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/LongMin.java
@@ -60,7 +60,7 @@ public class LongMin extends EvalFunc<Long>{
      * @param output returns a single numeric value, which is the smaller of two inputs
      */
     public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() < 2)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/NEXTUP.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/NEXTUP.java
index 7ef4b898c..3366eb3ab 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/NEXTUP.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/NEXTUP.java
@@ -65,7 +65,7 @@ public class NEXTUP extends EvalFunc<Double>{
      * @param output returns a single numeric value, nextup value of the argument
      */
     public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
         Double d;
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ROUND.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ROUND.java
index 87300c195..c075f224c 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ROUND.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ROUND.java
@@ -72,7 +72,7 @@ public class ROUND extends EvalFunc<Long>{
 	 */
 	@Override
 	public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SCALB.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SCALB.java
index 57a86d01c..cbefdc3aa 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SCALB.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SCALB.java
@@ -72,7 +72,9 @@ public class SCALB extends EvalFunc<Double>{
 	public Double exec(Tuple input) throws IOException {
         if (input == null || input.size() < 2)
             return null;
-
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			Double first = DataType.toDouble(input.get(0));
 			Integer second = DataType.toInteger(input.get(1));
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SIGNUM.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SIGNUM.java
index 13a1d6557..c5c2604e8 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SIGNUM.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/SIGNUM.java
@@ -66,7 +66,7 @@ public class SIGNUM extends EvalFunc<Double>{
 	 */
 	@Override
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ULP.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ULP.java
index c7be3b7b9..20580c2f4 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ULP.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/ULP.java
@@ -66,7 +66,7 @@ public class ULP extends EvalFunc<Double>{
 	 * the size of an ulp of the argument.
 	 */
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/copySign.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/copySign.java
index 1c2f6d1db..0ac178a04 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/copySign.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/copySign.java
@@ -70,6 +70,9 @@ public class copySign extends EvalFunc<Double>{
 	public Double exec(Tuple input) throws IOException {
         if (input == null || input.size() < 2)
             return null;
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			double first =  DataType.toDouble(input.get(0));
 			double second = DataType.toDouble(input.get(1));
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/getExponent.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/getExponent.java
index d39f1b6c0..758f14f43 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/getExponent.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/getExponent.java
@@ -66,7 +66,7 @@ public class getExponent extends EvalFunc<Integer>{
 	 * exponent used in the representation of a double
 	 */
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try {
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/nextAfter.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/nextAfter.java
index ce4a15df1..fb8ea6655 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/nextAfter.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/math/nextAfter.java
@@ -70,6 +70,12 @@ public class nextAfter extends EvalFunc<Double>{
 	 */
 	@Override
 	public Double exec(Tuple input) throws IOException {
+	    if (input == null || input.size() < 2) {
+	        return null;
+	    }
+        if (input.get(0) == null || input.get(1) == null) {
+            return null;
+        }
 		try{
 			double first = DataType.toDouble(input.get(0));
 			double second = DataType.toDouble(input.get(1));
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/HashFNV2.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/HashFNV2.java
index 54edd7989..5021f9e04 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/HashFNV2.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/HashFNV2.java
@@ -34,7 +34,7 @@ public class HashFNV2 extends HashFNV {
             String msg = "HashFNV : Only 2 parameters are allowed.";
             throw new IOException(msg);
         }
-        if (input.get(0)==null)
+        if (input.get(0)==null || input.get(1)==null)
             return null;
         try {
             mMod = (Integer)input.get(1);
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtract.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtract.java
index 96b754966..36968ea9d 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtract.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtract.java
@@ -66,7 +66,7 @@ public class RegexExtract extends EvalFunc<String> {
             String msg = "RegexExtract : Only 3 parameters are allowed.";
             throw new IOException(msg);
         }
-        if (input.get(0)==null)
+        if (input.get(0)==null || input.get(1)==null || input.get(2)==null)
             return null;
         try {
             if (!input.get(1).equals(mExpression))
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtractAll.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtractAll.java
index 18bc20e46..d71f58bf6 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtractAll.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexExtractAll.java
@@ -59,7 +59,7 @@ public class RegexExtractAll extends EvalFunc<Tuple> {
             throw new IOException(msg);
         }
 
-        if (input.get(0)==null)
+        if (input.get(0)==null||input.get(1)==null)
             return null;
         try {
             if (!input.get(1).equals(mExpression)) {
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexMatch.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexMatch.java
index 4e3217d43..5021c9cff 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexMatch.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/string/RegexMatch.java
@@ -56,7 +56,7 @@ public class RegexMatch extends EvalFunc<Integer> {
             String msg = "RegexMatch : Only 2 parameters are allowed.";
             throw new IOException(msg);
         }
-        if (input.get(0)==null)
+        if (input.get(0)==null || input.get(1)==null)
             return null;
         try {
             if (!input.get(1).equals(mExpression))
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/DateExtractor.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/DateExtractor.java
index 16bc7325f..1e39e82d1 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/DateExtractor.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/DateExtractor.java
@@ -104,7 +104,7 @@ public class DateExtractor extends EvalFunc<String> {
     
     @Override
     public String exec(Tuple input) throws IOException {
-      if (input == null || input.size() == 0)
+      if (input == null || input.size() == 0 || input.get(0) == null)
         return null;
       String str="";
       try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/HostExtractor.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/HostExtractor.java
index d0d97e039..1942ef94c 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/HostExtractor.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/HostExtractor.java
@@ -44,7 +44,7 @@ import org.apache.pig.impl.logicalLayer.schema.Schema;
 public class HostExtractor extends EvalFunc<String> {
   @Override
   public String exec(Tuple input) throws IOException {
-    if (input == null || input.size() == 0)
+    if (input == null || input.size() == 0 || input.get(0) == null)
       return null;
     String str="";
     try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchEngineExtractor.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchEngineExtractor.java
index 64b8c41ae..0aa633ed4 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchEngineExtractor.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchEngineExtractor.java
@@ -389,7 +389,7 @@ public class SearchEngineExtractor extends EvalFunc<String> {
 
     @Override
     public String exec(Tuple input) throws IOException {
-      if (input == null || input.size() == 0)
+      if (input == null || input.size() == 0 || input.get(0) == null)
         return null;
       String referer="";
       try{
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/xml/XPath.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/xml/XPath.java
index ee95989a7..2193892f0 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/xml/XPath.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/xml/XPath.java
@@ -81,6 +81,9 @@ public class XPath extends EvalFunc<String> {
         try {
 
             final String xml = (String) input.get(0);
+            if (xml == null) {
+                return null;
+            }
             
             if(input.size() > 2)
                 cache = (Boolean) input.get(2);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
index ccb551da0..be307aa67 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
@@ -277,27 +277,6 @@ public class POUserFunc extends ExpressionOperator {
         }
         try {
             if(result.returnStatus == POStatus.STATUS_OK) {
-                Tuple t = (Tuple) result.result;
-
-                // For backward compatibility, we short-circuit tuples whose
-                // size is 1 and field is null. (See PIG-3679)
-                if (t.size() == 1 && t.isNull(0)) {
-                    pigLogger.warn(this, "All the input values are null, skipping the invocation of UDF",
-                            PigWarning.SKIP_UDF_CALL_FOR_NULL);
-                    Schema outputSchema = func.outputSchema(func.getInputSchema());
-                    // If the output schema is tuple (i.e. multiple fields are
-                    // to be returned), we return a tuple where every field is
-                    // null.
-                    if (outputSchema != null && outputSchema.getField(0).type == DataType.TUPLE) {
-                        result.result = tf.newTuple(outputSchema.getField(0).schema.size());
-                    // Otherwise, we simply return null since it can be cast to
-                    // any data type.
-                    } else {
-                        result.result = null;
-                    }
-                    return result;
-                }
-
                 if (isAccumulative()) {
                     if (isAccumStarted()) {
                         if (!haveCheckedIfTerminatingAccumulator) {
diff --git a/src/org/apache/pig/builtin/ABS.java b/src/org/apache/pig/builtin/ABS.java
index b5c1fabe0..397312b0c 100644
--- a/src/org/apache/pig/builtin/ABS.java
+++ b/src/org/apache/pig/builtin/ABS.java
@@ -42,7 +42,7 @@ public class ABS extends EvalFunc<Double>{
 	 * @return output returns a single numeric value, absolute value of the argument
 	 */
 	public Double exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         Double d;
diff --git a/src/org/apache/pig/builtin/BigDecimalAbs.java b/src/org/apache/pig/builtin/BigDecimalAbs.java
index 3644597b9..8b4286508 100644
--- a/src/org/apache/pig/builtin/BigDecimalAbs.java
+++ b/src/org/apache/pig/builtin/BigDecimalAbs.java
@@ -27,6 +27,8 @@ import org.apache.pig.data.Tuple;
 public class BigDecimalAbs extends EvalFunc<BigDecimal> {
     @Override
     public BigDecimal exec(Tuple input) throws IOException {
+        if (input == null || input.size() == 0 || input.get(0) == null)
+            return null;
         return ((BigDecimal)input.get(0)).abs();
     }
 
diff --git a/src/org/apache/pig/builtin/BigIntegerAbs.java b/src/org/apache/pig/builtin/BigIntegerAbs.java
index fcba39b20..5b905709e 100644
--- a/src/org/apache/pig/builtin/BigIntegerAbs.java
+++ b/src/org/apache/pig/builtin/BigIntegerAbs.java
@@ -27,6 +27,8 @@ import org.apache.pig.data.Tuple;
 public class BigIntegerAbs extends EvalFunc<BigInteger> {
     @Override
     public BigInteger exec(Tuple input) throws IOException {
+        if (input == null || input.size() == 0 || input.get(0) == null)
+            return null;
         return ((BigInteger)input.get(0)).abs();
     }
 
diff --git a/src/org/apache/pig/builtin/DoubleRound.java b/src/org/apache/pig/builtin/DoubleRound.java
index 7ee2396f6..36c73cbab 100644
--- a/src/org/apache/pig/builtin/DoubleRound.java
+++ b/src/org/apache/pig/builtin/DoubleRound.java
@@ -37,7 +37,7 @@ public class DoubleRound extends EvalFunc<Long>{
 	 */
 	@Override
 	public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/src/org/apache/pig/builtin/FloatRound.java b/src/org/apache/pig/builtin/FloatRound.java
index e166e5293..e4fe79efa 100644
--- a/src/org/apache/pig/builtin/FloatRound.java
+++ b/src/org/apache/pig/builtin/FloatRound.java
@@ -39,7 +39,7 @@ public class FloatRound extends EvalFunc<Integer>{
 	 */
 	@Override
 	public Integer exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/src/org/apache/pig/builtin/ROUND.java b/src/org/apache/pig/builtin/ROUND.java
index ccbd0e4aa..087b1a0ec 100644
--- a/src/org/apache/pig/builtin/ROUND.java
+++ b/src/org/apache/pig/builtin/ROUND.java
@@ -44,7 +44,7 @@ public class ROUND extends EvalFunc<Long>{
 	 */
 	@Override
 	public Long exec(Tuple input) throws IOException {
-        if (input == null || input.size() == 0)
+        if (input == null || input.size() == 0 || input.get(0) == null)
             return null;
 
         try{
diff --git a/test/org/apache/pig/test/TestUDF.java b/test/org/apache/pig/test/TestUDF.java
index 73fc95332..d1a4f2daa 100644
--- a/test/org/apache/pig/test/TestUDF.java
+++ b/test/org/apache/pig/test/TestUDF.java
@@ -20,6 +20,7 @@ package org.apache.pig.test;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.assertFalse;
 
 import java.io.File;
 import java.io.FileWriter;
@@ -319,4 +320,31 @@ public class TestUDF {
             return l;
         }
     }
+
+    @Test
+    // See PIG-4184
+    public void testUDFNullInput() throws Exception {
+        PigServer pig = new PigServer(ExecType.LOCAL);
+        File inputFile = Util.createInputFile("tmp", "", 
+                new String[] {"\t", "2\t3"});
+        pig.registerQuery("a = load '"
+                + Util.generateURI(Util.encodeEscape(inputFile.toString()), pig.getPigContext())
+                + "' as (i1:int, i2:int);");
+        pig.registerQuery("b = foreach a generate " + IntToBool.class.getName() + "(i1);");
+
+        Iterator<Tuple> iter = pig.openIterator("b");
+        assertEquals(iter.next().toString(), "(false)");
+        assertEquals(iter.next().toString(), "(true)");
+        assertFalse(iter.hasNext());
+    }
+
+    public static class IntToBool extends EvalFunc<Boolean> {
+        @Override
+        public Boolean exec(Tuple input) throws IOException {
+            if (input == null || input.size() == 0)
+                return null;
+            Integer val = (Integer)input.get(0);
+            return (val == null || val == 0) ? false : true;
+        }
+    }
 }
\ No newline at end of file
