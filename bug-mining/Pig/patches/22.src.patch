diff --git a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
index 5fccbd211..5e91c96cc 100644
--- a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
+++ b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
@@ -227,12 +227,16 @@ public class QueryParser {
 		 */
 
 
-		LogicalPlan foreachPlan = new LogicalPlan();
+	
+		//Construct the cogroup operator and add it to the logical plan
+		LogicalOperator cogroup = parseCogroup(gis, lp);
+		lp.add(cogroup);
+		log.debug("Added operator " + cogroup.getClass().getName() + " to the logical plan");
+		
 		for (int i = 0; i < n; i++) {
 			LogicalPlan projectPlan = new LogicalPlan(); 
-			LogicalOperator projectInput = gis.get(i).op;
+			LogicalOperator projectInput = cogroup;
 			ExpressionOperator column = new LOProject(projectPlan, new OperatorKey(scope, getNextId()), projectInput, i+1);
-			((LOProject)column).setStar(true);
 			flattenList.add(true);
 			flattenedColumns.add(column);
 			(gis.get(i)).isInner = true;
@@ -246,26 +250,11 @@ public class QueryParser {
 		}
 
 		
-		//Construct the cogroup operator and add it to the logical plan
-		
-		LogicalOperator cogroup = parseCogroup(gis, lp);
-		lp.add(cogroup);
-		log.debug("Added operator " + cogroup.getClass().getName() + " to the logical plan");
-		
-		
-		//Construct the generate operator from the list of projection plans
-		//Add the generate operator to the foreach logical plan
-        /*
-		LogicalOperator generate = new LOGenerate(lp, new OperatorKey(scope, getNextId()), generatePlans, flattenList);
-		foreachPlan.add(generate);
-		log.debug("Added operator " + generate.getClass().getName() + " to the logical plan " + lp);
-        */
 		
 		/*
 		 * Construct the foreach operator from the foreach logical plan
 		 * Add the foreach operator to the top level logical plan
 		 */
-		 
 		LogicalOperator foreach = new LOForEach(lp, new OperatorKey(scope, getNextId()), generatePlans, flattenList);
 		lp.add(foreach);
 		log.debug("Added operator " + foreach.getClass().getName() + " to the logical plan");
diff --git a/test/org/apache/pig/test/TestBuiltin.java b/test/org/apache/pig/test/TestBuiltin.java
index 3de5393c1..ee929fc10 100644
--- a/test/org/apache/pig/test/TestBuiltin.java
+++ b/test/org/apache/pig/test/TestBuiltin.java
@@ -873,8 +873,6 @@ public class TestBuiltin extends TestCase {
         assertTrue(f1.equals(f2));        
     }
     
-    // TODO FIX
-    /*
     @Test
     public void testShellFuncSingle() throws Throwable {
         //ShellBagEvalFunc func = new ShellBagEvalFunc("tr o 0");
@@ -935,7 +933,6 @@ public class TestBuiltin extends TestCase {
         assertFalse(iter.hasNext());
         tempFile.delete();
     }
-    */
            
     private static String getInputType(String typeFor) {
         return allowedInput.get(typeFor);
