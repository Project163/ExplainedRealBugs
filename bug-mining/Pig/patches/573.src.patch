diff --git a/CHANGES.txt b/CHANGES.txt
index 537303daa..4e3bca2dc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -217,6 +217,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1704: Output Compression is not at work if the output path is absolute and there is a trailing / afte the compression suffix (yanz)
+
 PIG-1695: MergeForEach does not carry user defined schema if any one of the merged ForEach has user defined schema (daijy)
 
 PIG-1684: Inconsistent usage of store func. (thejas)
diff --git a/src/org/apache/pig/LoadFunc.java b/src/org/apache/pig/LoadFunc.java
index 41606d6ac..e949de5fe 100644
--- a/src/org/apache/pig/LoadFunc.java
+++ b/src/org/apache/pig/LoadFunc.java
@@ -270,6 +270,8 @@ public abstract class LoadFunc {
                                 new Path(curDir, path).toString();
             }
             fname = fname.replaceFirst("^file:/([^/])", "file:///$1");
+            // remove the trailing /
+            fname = fname.replaceFirst("/$", "");
             pathStrings.add(fname);
         }
     
diff --git a/test/org/apache/pig/test/TestBZip.java b/test/org/apache/pig/test/TestBZip.java
index 69c653764..401b243c4 100644
--- a/test/org/apache/pig/test/TestBZip.java
+++ b/test/org/apache/pig/test/TestBZip.java
@@ -117,6 +117,65 @@ public class TestBZip {
         out.delete();
     }
     
+   /**
+    * Tests the end-to-end writing and reading of a BZip file using absolute path with a trailing /.
+    */
+    @Test
+    public void testBzipInPig2() throws Exception {
+        PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
+       
+        File in = File.createTempFile("junit", ".bz2");
+        in.deleteOnExit();
+        
+        File out = File.createTempFile("junit", ".bz2");
+        out.deleteOnExit();
+        out.delete();
+               
+        CBZip2OutputStream cos = 
+            new CBZip2OutputStream(new FileOutputStream(in));
+        for (int i = 1; i < 100; i++) {
+            StringBuffer sb = new StringBuffer();
+            sb.append(i).append("\n").append(-i).append("\n");
+            byte bytes[] = sb.toString().getBytes();
+            cos.write(bytes);
+        }
+        cos.close();
+                       
+        pig.registerQuery("AA = load '"
+                + Util.generateURI(in.getAbsolutePath(), pig.getPigContext())
+                + "';");
+        pig.registerQuery("A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);");
+        pig.registerQuery("store A into '" + out.getAbsolutePath() + "/';");
+        FileSystem fs = FileSystem.get(ConfigurationUtil.toConfiguration(
+                pig.getPigContext().getProperties()));
+        FSDataInputStream is = fs.open(new Path(out.getAbsolutePath() + 
+                "/part-r-00000.bz2"));
+        CBZip2InputStream cis = new CBZip2InputStream(is);
+        
+        // Just a sanity check, to make sure it was a bzip file; we
+        // will do the value verification later
+        assertEquals(100, cis.read(new byte[100]));
+        cis.close();
+        
+        pig.registerQuery("B = load '" + out.getAbsolutePath() + "';");
+        
+        Iterator<Tuple> i = pig.openIterator("B");
+        HashMap<Integer, Integer> map = new HashMap<Integer, Integer>();
+        while (i.hasNext()) {
+            Integer val = DataType.toInteger(i.next().get(0));
+            map.put(val, val);            
+        }
+        
+        assertEquals(new Integer(99), new Integer(map.keySet().size()));
+        
+        for (int j = 1; j < 100; j++) {
+            assertEquals(new Integer(j), map.get(j));
+        }
+        
+        in.delete();
+        out.delete();
+    }
+
     /** 
      * Tests that '\n', '\r' and '\r\n' are treated as record delims when using
      * bzip just like they are when using uncompressed text
diff --git a/test/org/apache/pig/test/TestLoad.java b/test/org/apache/pig/test/TestLoad.java
index 8f7628199..da57b9cdb 100644
--- a/test/org/apache/pig/test/TestLoad.java
+++ b/test/org/apache/pig/test/TestLoad.java
@@ -176,7 +176,7 @@ public class TestLoad extends junit.framework.TestCase {
         for (PigServer pig : servers) {
             pc = pig.getPigContext();
             boolean noConversionExpected = true;
-            checkLoadPath("/tmp/foo/../././","/tmp/foo/../././", noConversionExpected);
+            checkLoadPath("/tmp/foo/../././","/tmp/foo/.././.", noConversionExpected);
         }
     }
 
@@ -266,6 +266,7 @@ public class TestLoad extends junit.framework.TestCase {
         String nonDfsUrl = "har://hdfs-namenode/user/foo/";
         LogicalPlan lp = lpt.buildPlan("a = load '" + nonDfsUrl + "';");
         LOLoad load = (LOLoad) lp.getRoots().get(0);
+        nonDfsUrl = nonDfsUrl.replaceFirst("/$", "");
         Assert.assertEquals(nonDfsUrl, load.getInputFile().getFileName());
     }
     
diff --git a/test/org/apache/pig/test/TestStore.java b/test/org/apache/pig/test/TestStore.java
index 15a771577..bfe7df1e2 100644
--- a/test/org/apache/pig/test/TestStore.java
+++ b/test/org/apache/pig/test/TestStore.java
@@ -390,7 +390,7 @@ public class TestStore extends junit.framework.TestCase {
 
     @Test
     public void testStoreRemoteNormalize() throws Exception {
-        checkStorePath("/tmp/foo/../././","/tmp/foo/../././");
+        checkStorePath("/tmp/foo/../././","/tmp/foo/.././.");
     }
 
     @Test
