diff --git a/CHANGES.txt b/CHANGES.txt
index 7b22a6abf..012bc76d9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -42,6 +42,8 @@ PIG-1876: Typed map for Pig (daijy)
 
 IMPROVEMENTS
 
+PIG-2002: Regression: Pig gives error "Projection with nothing to reference!" for a valid query (xuefu)
+
 PIG-1921: Improve error messages in new parser (xuefu)
 
 PIG-1996: Pig new parser fails to recognize PARALLEL keywords in a case (xuefu)
diff --git a/src/org/apache/pig/newplan/logical/expression/CastExpression.java b/src/org/apache/pig/newplan/logical/expression/CastExpression.java
index 13a93345d..c55e2a8ba 100644
--- a/src/org/apache/pig/newplan/logical/expression/CastExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/CastExpression.java
@@ -89,7 +89,7 @@ public class CastExpression extends UnaryExpression {
         LogicalExpression copy = new CastExpression(
                 lgExpPlan,
                 this.getExpression().deepCopy(lgExpPlan),
-                this.getFieldSchema().deepCopy());
+                castSchema.deepCopy());
         try {
             FuncSpec origFuncSpec = this.getFuncSpec();
             if (origFuncSpec != null ) {
diff --git a/test/org/apache/pig/parser/TestLogicalPlanGenerator.java b/test/org/apache/pig/parser/TestLogicalPlanGenerator.java
index 5db383024..804ef7023 100644
--- a/test/org/apache/pig/parser/TestLogicalPlanGenerator.java
+++ b/test/org/apache/pig/parser/TestLogicalPlanGenerator.java
@@ -46,6 +46,7 @@ public class TestLogicalPlanGenerator {
                          };
         command = Util.createInputFile("script", "pl", script);
     }
+    
     @Test
     public void test1() {
         String query = "A = load 'x' as ( u:int, v:long, w:bytearray); " + 
@@ -229,10 +230,18 @@ public class TestLogicalPlanGenerator {
         generateLogicalPlan( query );
     }
 
+    @Test
+    public void test19() {
+        String query = "A = load 'x' as (u:map[], v);\n" +
+                       "B = foreach A { T = (chararray)u#'hello'#'world'; generate T; };";
+        generateLogicalPlan( query );
+    }
+    
     @Test
     public void testFilter() {
         String query = "A = load 'x' as ( u:int, v:long, w:bytearray); " + 
-                       "B = filter A by 2 > 1; ";
+                       "B = filter A by 2 > 1;\n" +
+                       "store B into 'y';";
         generateLogicalPlan( query );
     }
 
