diff --git a/CHANGES.txt b/CHANGES.txt
index bc67cab93..869464ef5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -265,6 +265,8 @@ PIG-2228: support partial aggregation in map task (thejas)
 
 BUG FIXES
 
+PIG-2509: Util.getSchemaFromString fails with java.lang.NullPointerException when a tuple in a bag has no name (as when used in MongoStorage UDF) (jcoveney via daijy)
+
 PIG-2559: Embedded pig in python; invoking sys.exit(0) causes script failure (vivekp via daijy)
 
 PIG-2530: Reusing alias name in nested foreach causes incorrect results (daijy)
diff --git a/src/org/apache/pig/parser/QueryParser.g b/src/org/apache/pig/parser/QueryParser.g
index f158a85ba..b6ba421f3 100644
--- a/src/org/apache/pig/parser/QueryParser.g
+++ b/src/org/apache/pig/parser/QueryParser.g
@@ -315,7 +315,9 @@ tuple_type : TUPLE? LEFT_PAREN field_def_list? RIGHT_PAREN
           -> ^( TUPLE_TYPE field_def_list? )
 ;
 
-bag_type : BAG? LEFT_CURLY ( ( identifier COLON )? tuple_type )? RIGHT_CURLY
+bag_type : BAG? LEFT_CURLY ( null_keyword COLON tuple_type? ) RIGHT_CURLY
+        -> ^( BAG_TYPE tuple_type? )
+         | BAG? LEFT_CURLY ( ( identifier COLON )? tuple_type )? RIGHT_CURLY
         -> ^( BAG_TYPE identifier? tuple_type? )
 ;
 
diff --git a/test/org/apache/pig/test/TestSchema.java b/test/org/apache/pig/test/TestSchema.java
index f9ba6aa3b..38b6821ee 100644
--- a/test/org/apache/pig/test/TestSchema.java
+++ b/test/org/apache/pig/test/TestSchema.java
@@ -882,7 +882,8 @@ public class TestSchema {
             "a:double,b:float,t:tuple(x:int,b:bag{t:tuple(a:int,b:float,c:double,x:tuple(z:bag{r:tuple(z:bytearray)}))},z:bytearray)",
             "a,b,t:tuple(x,b:bag{t:tuple(a,b,c,x:tuple(z:bag{r:tuple(z)}))},z)",
             "a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:int,b:float)})})})})})}",
-            "a:bag{}"
+            "a:bag{}",
+            "b:{null:(a:int)}"
         };
         for (String schemaString : schemaStrings) {
             Schema s1 = Utils.getSchemaFromString(schemaString);
