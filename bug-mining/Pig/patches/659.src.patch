diff --git a/CHANGES.txt b/CHANGES.txt
index 952cd830e..e397da7d6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -120,6 +120,9 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1868: New logical plan fails when I have complex data types from udf
+(daijy)
+
 PIG-1927: Dereference partial name failed (daijy)
 
 PIG-1934: Fix zebra test TestCheckin1, TestCheckin4 (daijy)
diff --git a/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java b/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
index 7c1a92ba5..e13ff9b71 100644
--- a/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
+++ b/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
@@ -440,8 +440,7 @@ public class LogicalSchema {
                         else {
                             try {
                                 // Only check compatibility
-                                LogicalSchema.merge(fs1.schema, fs2.schema, MergeMode.LoadForEachInner);
-                                mergedSubSchema = fs1.schema;
+                                mergedSubSchema = LogicalSchema.merge(fs1.schema, fs2.schema, MergeMode.LoadForEachInner);
                             } catch (FrontendException e) {
                                 throw new FrontendException("Incompatable field schema: left is \"" + fs1.toString(false) + "\", right is \"" + fs2.toString(false) + "\"", 1031);
                             }
diff --git a/test/org/apache/pig/test/TestSchema.java b/test/org/apache/pig/test/TestSchema.java
index a6f73969e..20a7bb3ce 100644
--- a/test/org/apache/pig/test/TestSchema.java
+++ b/test/org/apache/pig/test/TestSchema.java
@@ -768,7 +768,7 @@ public class TestSchema extends TestCase {
         
         mergedSchema = LogicalSchema.merge(b, a, LogicalSchema.MergeMode.LoadForEach);
         expected = org.apache.pig.newplan.logical.Util.translateSchema(Util.getSchemaFromString(
-            "a2:bytearray, b2:(), c2:int"));
+            "a2:bytearray, b2:(b11:int,b12:float), c2:int"));
         Assert.assertTrue(LogicalSchema.equals(mergedSchema, expected, false, false));
     }
 
