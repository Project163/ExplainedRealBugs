diff --git a/CHANGES.txt b/CHANGES.txt
index 66fb84947..39c44262f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -62,6 +62,8 @@ PIG-2011: Speed up TestTypedMap.java (dvryaboy)
 
 BUG FIXES
 
+PIG-2110: NullPointerException in piggybank.evaluation.util.apachelogparser.SearchTermExtractor (dale_jin via daijy)
+
 PIG-2144: ClassCastException when using IsEmpty(DIFF()) (thejas)
 
 PIG-2139: LogicalExpressionSimplifier optimizer rule should check if udf is
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchTermExtractor.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchTermExtractor.java
index c61cc761d..b555dd5f1 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchTermExtractor.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/util/apachelogparser/SearchTermExtractor.java
@@ -167,6 +167,7 @@ public class SearchTermExtractor extends EvalFunc<String> {
       if (HOSTS.containsKey(host) || host.contains("google.co")
           || host.contains("search.yahoo")) {
         String queryString = urlObject.getQuery();
+        if (queryString == null) { return null; }
         TERM_MATCHER.reset(queryString);
         if (TERM_MATCHER.find()) {
           String terms = TERM_MATCHER.group(1);
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/evaluation/util/apachelogparser/TestSearchTermExtractor.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/evaluation/util/apachelogparser/TestSearchTermExtractor.java
index 5a17ed23f..fc9487504 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/evaluation/util/apachelogparser/TestSearchTermExtractor.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/evaluation/util/apachelogparser/TestSearchTermExtractor.java
@@ -26,6 +26,7 @@ import org.junit.Test;
 public class TestSearchTermExtractor extends TestCase {
     private static HashMap<String, String> tests = new HashMap<String, String>();
     static {
+        tests.put("http://www.google.com/search", null);
         tests.put("http://www.google.com/search?hl=en&q=a+simple+test&btnG=Google+Search", "a simple test");
         tests.put("http://www.google.co.uk/search?hl=en&q=a+simple+test&btnG=Google+Search&meta=", "a simple test");
         tests.put("http://www.google.co.jp/search?hl=ja&q=a+simple+test&btnG=Google+%E6%A4%9C%E7%B4%A2&lr=", "a simple test");
