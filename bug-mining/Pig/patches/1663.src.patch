diff --git a/CHANGES.txt b/CHANGES.txt
index 87d7abbbe..281913fa7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -48,6 +48,8 @@ PIG-4333: Split BigData tests into multiple groups (rohini)
  
 BUG FIXES
 
+PIG-4392: RANK BY fails when default_parallel is greater than cardinality of field being ranked by (daijy)
+
 PIG-4403: Combining -Dpig.additional.jars.uris with -useHCatalog breaks due to combination
  with colon instead of comma (ovlaere via daijy)
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java
index 70fdf2765..153f4cef8 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java
@@ -407,17 +407,13 @@ public class JobControlCompiler{
             }
             groupCounters = counters.getGroup(groupName);
 
-            Iterator<Counter> it = groupCounters.iterator();
             HashMap<Integer,Long> counterList = new HashMap<Integer, Long>();
 
-            while(it.hasNext()) {
-                try{
-                    Counter c = it.next();
-                    counterList.put(Integer.valueOf(c.getDisplayName()), c.getValue());
-                } catch (Exception ex) {
-                    ex.printStackTrace();
-                }
+            for (int i=0;i<job.getJob().getNumReduceTasks();i++) {
+                Long value = groupCounters.getCounter(Integer.toString(i));
+                counterList.put(i, value);
             }
+
             counterSize = counterList.size();
             counterPairs = new ArrayList<Pair<String,Long>>();
 
diff --git a/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java b/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
index adc328b70..469129bc8 100644
--- a/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
+++ b/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
@@ -422,6 +422,7 @@ public class LogToPhyTranslationVisitor extends LogicalRelationalNodesVisitor {
                 poSort = new POSort(new OperatorKey(scope, nodeGen
                         .getNextNodeId(scope)), -1, null,
                         newPhysicalPlan, newOrderPlan, null);
+                poSort.setRequestedParallelism(loRank.getRequestedParallelism());
                 poSort.addOriginalLocation(loRank.getAlias(), loRank.getLocation());
 
 
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index c12d595c8..0472e27c5 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1265,4 +1265,27 @@ public class TestEvalPipelineLocal {
         Assert.assertEquals(iter.next().toString(), "(1)");
         Assert.assertFalse(iter.hasNext());
     }
+
+    // see PIG-4392
+    @Test
+    public void testRankWithEmptyReduce() throws Exception {
+        File f1 = createFile(new String[]{"1\t2\t3", "4\t5\t6", "7\t8\t9"});
+        pigServer.setDefaultParallel(4);
+        
+        pigServer.registerQuery("d = load '" + Util.generateURI(f1.toString(), pigServer.getPigContext())
+                + "' as (a:int, b:int, c:int);");
+        pigServer.registerQuery("e = rank d by a parallel 4;");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("e");
+
+        Collection<String> results = new HashSet<String>();
+        results.add("(1,1,2,3)");
+        results.add("(2,4,5,6)");
+        results.add("(3,7,8,9)");
+        
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertTrue(results.contains(iter.next().toString()));
+        Assert.assertFalse(iter.hasNext());
+    }
 }
