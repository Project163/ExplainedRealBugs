diff --git a/CHANGES.txt b/CHANGES.txt
index 4b88563e5..1085ffaa1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -47,6 +47,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)
 
 BUG FIXES
 
+PIG-4635: NPE while running pig script in tez mode (daijy)
+
 PIG-4683: Nested order is broken after PIG-3591 in some cases (daijy)
 
 PIG-4679: Performance degradation due to InputSizeReducerEstimator since PIG-3754 (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
index 41237521f..52764ab09 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
@@ -189,6 +189,7 @@ public class TezOperator extends Operator<TezOpPlanVisitor> {
     private transient VertexGroupInfo vertexGroupInfo;
     // Mapping of OperatorKey of POStore OperatorKey to vertexGroup TezOperator
     private Map<OperatorKey, OperatorKey> vertexGroupStores = null;
+    private boolean isVertexGroup = false;
 
     public static class LoaderInfo implements Serializable {
         private List<POLoad> loads = null;
@@ -487,7 +488,7 @@ public class TezOperator extends Operator<TezOpPlanVisitor> {
     // Union is the only operator that uses alias vertex (VertexGroup) now. But
     // more operators could be added to the list in the future.
     public boolean isVertexGroup() {
-        return vertexGroupInfo != null;
+        return isVertexGroup;
     }
 
     public VertexGroupInfo getVertexGroupInfo() {
@@ -496,6 +497,7 @@ public class TezOperator extends Operator<TezOpPlanVisitor> {
 
     public void setVertexGroupInfo(VertexGroupInfo vertexGroup) {
         this.vertexGroupInfo = vertexGroup;
+        this.isVertexGroup = true;
     }
 
     public void addVertexGroupStore(OperatorKey storeKey, OperatorKey vertexGroupKey) {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezPrinter.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezPrinter.java
index 2f0c1c6fc..ce5d98176 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezPrinter.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezPrinter.java
@@ -55,9 +55,13 @@ public class TezPrinter extends TezOpPlanVisitor {
     public void visitTezOp(TezOperator tezOper) throws VisitorException {
         if (tezOper.isVertexGroup()) {
             VertexGroupInfo info = tezOper.getVertexGroupInfo();
-            mStream.println("Tez vertex group "
-                    + tezOper.getOperatorKey().toString() + "\t<-\t "
-                    + info.getInputs() + "\t->\t " + info.getOutput());
+            mStream.print("Tez vertex group "
+                    + tezOper.getOperatorKey().toString());
+            if (info!=null) {
+                mStream.println("\t<-\t " + info.getInputs() + "\t->\t " + info.getOutput());
+            } else {
+                mStream.println();
+            }
             mStream.println("# No plan on vertex group");
         } else {
             mStream.println("Tez vertex " + tezOper.getOperatorKey().toString());
diff --git a/test/org/apache/pig/tez/TestTezGraceParallelism.java b/test/org/apache/pig/tez/TestTezGraceParallelism.java
index c7fbc3dc4..cf8d19c55 100644
--- a/test/org/apache/pig/tez/TestTezGraceParallelism.java
+++ b/test/org/apache/pig/tez/TestTezGraceParallelism.java
@@ -26,6 +26,7 @@ import java.io.FileWriter;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.io.StringWriter;
+import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Random;
@@ -248,4 +249,37 @@ public class TestTezGraceParallelism {
             Util.removeLogAppender(PigGraceShuffleVertexManager.class, "testJoinWithDifferentDepth2");
         }
     }
+
+    @Test
+    // See PIG-4635 for a NPE in TezOperDependencyParallelismEstimator
+    public void testJoinWithUnion() throws IOException{
+        NodeIdGenerator.reset();
+        PigServer.resetScope();
+        StringWriter writer = new StringWriter();
+        Util.createLogAppender("testJoinWithUnion", writer, PigGraceShuffleVertexManager.class);
+        try {
+            // DAG: 29 -> 32 -> 41 \
+            //                       -> 70 (vertex group) -> 61
+            //      42 -> 45 -> 54 /
+            pigServer.registerQuery("A = load '" + INPUT_DIR + "/" + INPUT_FILE2 + "' as (name:chararray, gender:chararray);");
+            pigServer.registerQuery("B = distinct A;");
+            pigServer.registerQuery("C = group B by name;");
+            pigServer.registerQuery("D = load '" + INPUT_DIR + "/" + INPUT_FILE2 + "' as (name:chararray, gender:chararray);");
+            pigServer.registerQuery("E = distinct D;");
+            pigServer.registerQuery("F = group E by name;");
+            pigServer.registerQuery("G = union C, F;");
+            pigServer.registerQuery("H = distinct G;");
+            Iterator<Tuple> iter = pigServer.openIterator("H");
+            int count = 0;
+            while (iter.hasNext()) {
+                iter.next();
+                count++;
+            }
+            assertEquals(count, 20);
+            assertTrue(writer.toString().contains("time to set parallelism for scope-41"));
+            assertTrue(writer.toString().contains("time to set parallelism for scope-54"));
+        } finally {
+            Util.removeLogAppender(PigGraceShuffleVertexManager.class, "testJoinWithUnion");
+        }
+    }
 }
