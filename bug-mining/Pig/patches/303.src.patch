diff --git a/CHANGES.txt b/CHANGES.txt
index c617de644..e1e347062 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -41,6 +41,9 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-1108: Incorrect map output key type in MultiQuery optimiza (rding via
+olgan)
+
 PIG-1022:  optimizer pushes filter before the foreach that generates column
 used by filter (daijy via gates)
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
index a36a94c6c..3c4f02783 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
@@ -107,6 +107,11 @@ class MultiQueryOptimizer extends MROpPlanVisitor {
                     
         List<MapReduceOper> successors = getPlan().getSuccessors(mr);
         for (MapReduceOper successor : successors) {
+            if (successor.getUseSecondaryKey()) {
+                log.debug("Splittee " + successor.getOperatorKey().getId()
+                        + " uses secondary key, do not merge it");
+                continue;
+            }
             if (isMapOnly(successor)) {
                 if (isSingleLoadMapperPlan(successor.mapPlan)) {                    
                     mappers.add(successor);                
@@ -121,10 +126,11 @@ class MultiQueryOptimizer extends MROpPlanVisitor {
                 }
             }                
         }
-                      
+                  
+        int numSplittees = successors.size();
+        
         // case 1: exactly one splittee and it's map-only
-        if (mappers.size() == 1 && mapReducers.size() == 0 
-                && multiLoadMROpers.size() == 0 ) {            
+        if (mappers.size() == 1 && numSplittees == 1) {    
             mergeOnlyMapperSplittee(mappers.get(0), mr);
             
             log.info("Merged the only map-only splittee.");
@@ -133,16 +139,14 @@ class MultiQueryOptimizer extends MROpPlanVisitor {
         }
         
         // case 2: exactly one splittee and it has reducer
-        if (isMapOnly(mr) && mapReducers.size() == 1 
-                && mappers.size() == 0 && multiLoadMROpers.size() == 0) {            
+        if (isMapOnly(mr) && mapReducers.size() == 1 && numSplittees == 1) {            
             mergeOnlyMapReduceSplittee(mapReducers.get(0), mr);
             
             log.info("Merged the only map-reduce splittee.");
             
             return;
         } 
-        
-        int numSplittees = successors.size();
+                
         int numMerges = 0;
         
         PhysicalPlan splitterPl = isMapOnly(mr) ? mr.mapPlan : mr.reducePlan;                            
diff --git a/test/org/apache/pig/test/TestMultiQuery.java b/test/org/apache/pig/test/TestMultiQuery.java
index d18f9ded1..5b9528dd4 100644
--- a/test/org/apache/pig/test/TestMultiQuery.java
+++ b/test/org/apache/pig/test/TestMultiQuery.java
@@ -88,6 +88,33 @@ public class TestMultiQuery extends TestCase {
         myPig = null;
     }
     
+    @Test
+    public void testMultiQueryJiraPig1108() {
+        
+        try {
+            myPig.setBatchOn();
+
+            myPig.registerQuery("a = load 'file:test/org/apache/pig/test/data/passwd' " 
+                    + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
+            myPig.registerQuery("split a into plan1 if (uid > 5), plan2 if ( uid < 5);");
+            myPig.registerQuery("b = group plan1 by uname;");
+            myPig.registerQuery("c = foreach b { tmp = order plan1 by uid desc; " 
+                    + "generate flatten(group) as foo, tmp; };");
+            myPig.registerQuery("d = filter c BY foo is not null;");
+            myPig.registerQuery("store d into '/tmp/output1';");
+            myPig.registerQuery("store plan2 into '/tmp/output2';");
+             
+            List<ExecJob> jobs = myPig.executeBatch();
+            for (ExecJob job : jobs) {
+                assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
+            }
+            
+        } catch (Exception e) {
+            e.printStackTrace();
+            Assert.fail();
+        } 
+    }    
+    
     @Test
     public void testMultiQueryJiraPig1060() {
 
