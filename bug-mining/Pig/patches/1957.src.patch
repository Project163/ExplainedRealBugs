diff --git a/CHANGES.txt b/CHANGES.txt
index a9ae51055..d3eb51247 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -65,6 +65,12 @@ PIG-5262: Fix jdiff related issues: fail build upon error, correct xml character
 PIG-5225: Several unit tests are not annotated with @Test (nkollar via rohini)
 
 
+Release 0.17.1 (unreleased)
+
+BUG FIXES
+
+PIG-5254: Hit Ctrl-D to quit grunt shell fail (wjqian via daijy)
+
 Release 0.17.0
 Â 
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/tools/grunt/ConsoleReaderInputStream.java b/src/org/apache/pig/tools/grunt/ConsoleReaderInputStream.java
index a2244dcc8..e14deed05 100644
--- a/src/org/apache/pig/tools/grunt/ConsoleReaderInputStream.java
+++ b/src/org/apache/pig/tools/grunt/ConsoleReaderInputStream.java
@@ -21,7 +21,6 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.io.SequenceInputStream;
 import java.util.Enumeration;
-
 import jline.console.ConsoleReader;
 import jline.console.history.FileHistory;
 
@@ -104,7 +103,11 @@ public class ConsoleReaderInputStream extends SequenceInputStream {
             }
 
             if (buffer == null) {
-                buffer = reader.readLine().getBytes();
+                //buffer = reader.readLine().getBytes();
+            	String buff = reader.readLine();
+            	if (buff == null){
+            		buff = "quit";}
+            	buffer = buff.getBytes();
 
                 //Write current grunt buffer to pig history file
                 ((FileHistory)reader.getHistory()).flush();
