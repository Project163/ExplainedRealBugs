diff --git a/CHANGES.txt b/CHANGES.txt
index 3d2db1cd9..e6ade9bcb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -154,6 +154,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3060: FLATTEN in nested foreach fails when the input contains an empty bag (daijy)
+
 PIG-2247: Pig parser does not detect multiple arguments with the same name passed to macro (dreambird via daijy)
 
 PIG-3264: mvn signanddeploy target broken for pigunit, pigsmoke and piggybank (billgraham)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
index 14598cc7f..45de39813 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
@@ -441,12 +441,12 @@ public class POForEach extends PhysicalOperator {
                         if(its[i].hasNext()) {
                             data[i] = its[i].next();
                         } else {
-                            //the input set is null, so we return.  This is
+                            //the input set is null, so we return with EOP.  This is
                             // caught above and this function recalled with
                             // new inputs.
                             its = null;
                             data = null;
-                            res.returnStatus = POStatus.STATUS_NULL;
+                            res.returnStatus = POStatus.STATUS_EOP;
                             return res;
                         }
                     } else {
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index 788aa626a..aca3445ea 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1108,4 +1108,19 @@ public class TestEvalPipelineLocal {
         Assert.assertTrue(iter.next().toString().equals("((4,5),{((4,5),6)})"));
         Assert.assertFalse(iter.hasNext());
     }
+    
+    @Test
+    // See PIG-3060
+    public void testFlattenEmptyBag() throws Exception {
+        File f1 = createFile(new String[]{"2\t{}","3\t{(1),(2)}", "4\t{}"});
+        pigServer.registerQuery("A = load '" + Util.generateURI(f1.toString(), pigServer.getPigContext())
+                + "'  as (a0:int, a1:bag{(t:chararray)});");
+        pigServer.registerQuery("B = group A by a0;");
+        pigServer.registerQuery("C = foreach B { c1 = foreach A generate FLATTEN(a1); generate COUNT(c1);};");
+        Iterator<Tuple> iter = pigServer.openIterator("C");
+        Assert.assertTrue(iter.next().toString().equals("(0)"));
+        Assert.assertTrue(iter.next().toString().equals("(2)"));
+        Assert.assertTrue(iter.next().toString().equals("(0)"));
+        Assert.assertFalse(iter.hasNext());
+    }
 }
