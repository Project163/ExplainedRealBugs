diff --git a/CHANGES.txt b/CHANGES.txt
index 1d55dc432..5fe7c28bc 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -188,6 +188,9 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-2018: NPE for co-group with group-by column having complex schema and 
+ different load functions for each input (thejas)
+
 PIG-2015: Explain writes out logical plan twice (alangates)
 
 PIG-2017: consumeMap() fails with EmptyStackException (thedatachef via daijy)
@@ -845,7 +848,7 @@ PIG-1414: Problem with parameter substitution (rding)
 PIG-1407: Logging starts before being configured (azaroth via daijy)
 
 PIG-1391: pig unit tests leave behind files in temp directory because 
-MiniCluster files don't get deleted (tejas)
+ MiniCluster files don't get deleted (thejas)
 
 PIG-1211: Pig script runs half way after which it reports syntax error
 (pradeepkth)
diff --git a/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java b/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
index 40733f351..51cc7ab6a 100644
--- a/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
+++ b/src/org/apache/pig/newplan/logical/visitor/LineageFindRelVisitor.java
@@ -507,7 +507,6 @@ public class LineageFindRelVisitor extends LogicalRelationalNodesVisitor{
                 //check if all func spec match
                 if(!funcSpec1.equals(uid2LoadFuncMap.get(fs.uid))){
                     allMatch = false;
-                    break;
                 }
                 //check if all inner schema match for use later
                 if(outFS.schema == null ||  !outFS.schema.isEqual(fs.schema)){
diff --git a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
index cd08d4604..adf3c6852 100644
--- a/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
+++ b/test/org/apache/pig/test/TestTypeCheckingValidatorNewLP.java
@@ -4106,4 +4106,17 @@ public class TestTypeCheckingValidatorNewLP {
             checkLastForeachCastLoadFunc(query, null, 0);
         }
 
+        //see PIG-2018
+        @Test
+        public void testCoGroupComplex(){
+            String query = 
+                "l1 = load 'x' using PigStorage(':') as (a : (i : int),b,c);"
+                + "l2 = load 'x' as (a,b,c);"
+                + "cg = cogroup l1 by a, l2 by a;";
+            try {
+                createAndProcessLPlan(query);
+            } catch (FrontendException e) {
+                fail("caught exception creating lp");
+            }
+        }
 }
