diff --git a/CHANGES.txt b/CHANGES.txt
index f8bcd4c3c..485f7ce8f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -432,3 +432,5 @@ Trunk (unreleased changes)
     via sms)
 
     PIG-591: Error handling phase four (sms via pradeepkth)
+
+    PIG-664: Semantics of * is not consistent (sms)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
index 25ac0d2fb..7b3053608 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
@@ -175,8 +175,7 @@ public class POUserFunc extends ExpressionOperator {
                 if(temp.returnStatus!=POStatus.STATUS_OK)
                     return temp;
                 
-                /* Refer Pig-597 */
-                /* if(op instanceof POProject &&
+                if(op instanceof POProject &&
                         op.getResultType() == DataType.TUPLE){
                     POProject projOp = (POProject)op;
                     if(projOp.isStar()){
@@ -186,7 +185,7 @@ public class POUserFunc extends ExpressionOperator {
                             rslt.append(trslt.get(i));
                         continue;
                     }
-                }*/
+                }
                 ((Tuple)res.result).append(temp.result);
 			}
 			res.returnStatus = temp.returnStatus;
diff --git a/src/org/apache/pig/builtin/ARITY.java b/src/org/apache/pig/builtin/ARITY.java
index 60594b0b3..779823871 100644
--- a/src/org/apache/pig/builtin/ARITY.java
+++ b/src/org/apache/pig/builtin/ARITY.java
@@ -31,12 +31,9 @@ public class ARITY extends EvalFunc<Integer> {
 
     @Override
     public Integer exec(Tuple input) throws IOException {
-        if (input.size() == 0)
-            return null;
         try{
-            Tuple t = (Tuple)input.get(0);
-            if (t == null) return null;
-            return new Integer(t.size());
+            if (input == null) return null;
+            return new Integer(input.size());
         } catch (Exception e) {
             int errCode = 2106;
             String msg = "Error while computing arity in " + this.getClass().getSimpleName();
diff --git a/src/org/apache/pig/builtin/TupleSize.java b/src/org/apache/pig/builtin/TupleSize.java
index b8db7e246..562466fe4 100644
--- a/src/org/apache/pig/builtin/TupleSize.java
+++ b/src/org/apache/pig/builtin/TupleSize.java
@@ -33,12 +33,9 @@ public class TupleSize extends EvalFunc<Long> {
 
     @Override
     public Long exec(Tuple input) throws IOException {
-        if (input.size() == 0)
-            return null;
         try{
-            Tuple t = (Tuple)input.get(0);
-            if (t == null) return null;
-            return new Long(t.size());
+            if (input == null) return null;
+            return new Long(input.size());
         }catch(Exception e){
             int errCode = 2106;
             String msg = "Error while computing size in " + this.getClass().getSimpleName();
diff --git a/test/org/apache/pig/test/TestBuiltin.java b/test/org/apache/pig/test/TestBuiltin.java
index 4e00a36f4..ea7e2bd36 100644
--- a/test/org/apache/pig/test/TestBuiltin.java
+++ b/test/org/apache/pig/test/TestBuiltin.java
@@ -1047,18 +1047,16 @@ public class TestBuiltin extends TestCase {
         
         
         // Tuple size
-        Tuple t5 = TupleFactory.getInstance().newTuple();
-        t5.append(t1);
         expected = new Long(3);
         size = new TupleSize();
         msg = "[Testing TupleSize on input type: Tuple]";
-        assertTrue(msg, expected.equals(size.exec(t5)));
+        assertTrue(msg, expected.equals(size.exec(t1)));
         
         // Test for ARITY function.
         // It is depricated but we still need to make sure it works
         ARITY arrity = new ARITY();
         msg = "[Testing ARRITY on input type: Tuple]";
-        assertTrue(msg, expected.equals(new Long(arrity.exec(t5))));
+        assertTrue(msg, expected.equals(new Long(arrity.exec(t1))));
     }
 
     // Builtin APPLY Functions
diff --git a/test/org/apache/pig/test/TestEvalPipeline2.java b/test/org/apache/pig/test/TestEvalPipeline2.java
new file mode 100644
index 000000000..6f7a6614b
--- /dev/null
+++ b/test/org/apache/pig/test/TestEvalPipeline2.java
@@ -0,0 +1,95 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.pig.test;
+
+import static org.apache.pig.ExecType.MAPREDUCE;
+
+import java.io.File;
+import java.io.FileOutputStream;
+import java.io.PrintStream;
+import java.util.Iterator;
+import java.util.Random;
+
+import org.junit.Before;
+import org.junit.Test;
+
+import org.apache.pig.ExecType;
+import org.apache.pig.PigServer;
+import org.apache.pig.data.*;
+import org.apache.pig.impl.io.FileLocalizer;
+import org.apache.pig.test.utils.Identity;
+
+import junit.framework.TestCase;
+
+public class TestEvalPipeline2 extends TestCase {
+    
+    MiniCluster cluster = MiniCluster.buildCluster();
+    private PigServer pigServer;
+
+    TupleFactory mTf = TupleFactory.getInstance();
+    BagFactory mBf = BagFactory.getInstance();
+    
+    @Before
+    @Override
+    public void setUp() throws Exception{
+        FileLocalizer.setR(new Random());
+        pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
+//        pigServer = new PigServer(ExecType.LOCAL);
+    }
+    
+    @Test
+    public void testUDFwithStarInput() throws Exception {
+        int LOOP_COUNT = 10;
+        File tmpFile = File.createTempFile("test", "txt");
+        PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
+        Random r = new Random();
+        for(int i = 0; i < LOOP_COUNT; i++) {
+            for(int j=0;j<LOOP_COUNT;j+=2){
+                ps.println(i+"\t"+j);
+                ps.println(i+"\t"+j);
+            }
+        }
+        ps.close();
+
+        pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString()) + "';");
+        pigServer.registerQuery("B = group A by $0;");
+        String query = "C = foreach B {"
+        + "generate " + Identity.class.getName() +"(*);"
+        + "};";
+
+        pigServer.registerQuery(query);
+        Iterator<Tuple> iter = pigServer.openIterator("C");
+        if(!iter.hasNext()) fail("No output found");
+        int numIdentity = 0;
+        while(iter.hasNext()){
+            Tuple tuple = iter.next();
+            Tuple t = (Tuple)tuple.get(0);
+            assertEquals(DataByteArray.class, t.get(0).getClass());
+            int group = Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
+            assertEquals(numIdentity, group);
+            assertTrue(t.get(1) instanceof DataBag);
+            DataBag bag = (DataBag)t.get(1);
+            assertEquals(10, bag.size());
+            assertEquals(2, t.size());
+            ++numIdentity;
+        }
+        assertEquals(LOOP_COUNT, numIdentity);
+
+    }
+
+}
diff --git a/test/org/apache/pig/test/TestFRJoin.java b/test/org/apache/pig/test/TestFRJoin.java
index fc5ca84f2..c867dd647 100644
--- a/test/org/apache/pig/test/TestFRJoin.java
+++ b/test/org/apache/pig/test/TestFRJoin.java
@@ -98,13 +98,12 @@ public class TestFRJoin extends TestCase{
         }
 
         @Override
-        public DataBag exec(Tuple in) throws IOException {
+        public DataBag exec(Tuple input) throws IOException {
             if(!isTblSetUp){
                 setUpHashTable();
                 isTblSetUp = true;
             }
             try {
-                Tuple input = (Tuple)in.get(0);
                 String key = (String) input.get(keyField);
                 if(!replTbl.containsKey(key)) return BagFactory.getInstance().newDefaultBag();
                 return replTbl.get(key);
