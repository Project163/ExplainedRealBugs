diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index 7b27fd05c..15bb6b1e2 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -179,6 +179,16 @@ static int run(String args[], PigProgressNotificationListener listener) {
             properties.setProperty("stop.on.failure", ""+false);
         }
         
+        if( "true".equals( properties.getProperty( "mapred.output.compress" ) ) ) {
+            properties.setProperty( "output.compression.enabled",  "true" );
+            String codec = properties.getProperty( "mapred.output.compression.codec" );
+            if( codec == null ) {
+                throw new RuntimeException( "'mapred.output.compress' is set but no value is specified for 'mapred.output.compression.codec'." );
+            } else {
+                properties.setProperty( "output.compression.codec", codec );
+            }
+        }
+        
         // set up client side system properties in UDF context
         UDFContext.getUDFContext().setClientSystemProps();
 
diff --git a/src/org/apache/pig/builtin/PigStorage.java b/src/org/apache/pig/builtin/PigStorage.java
index d41c0c4b0..7b8bd6d0d 100644
--- a/src/org/apache/pig/builtin/PigStorage.java
+++ b/src/org/apache/pig/builtin/PigStorage.java
@@ -28,6 +28,7 @@ import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.io.Text;
 import org.apache.hadoop.io.compress.BZip2Codec;
+import org.apache.hadoop.io.compress.CompressionCodec;
 import org.apache.hadoop.io.compress.GzipCodec;
 import org.apache.hadoop.mapreduce.InputFormat;
 import org.apache.hadoop.mapreduce.Job;
@@ -232,14 +233,24 @@ LoadPushDown {
     public void setStoreLocation(String location, Job job) throws IOException {
         job.getConfiguration().set("mapred.textoutputformat.separator", "");
         FileOutputFormat.setOutputPath(job, new Path(location));
-        if (location.endsWith(".bz2") || location.endsWith(".bz")) {
-            FileOutputFormat.setCompressOutput(job, true);
-            FileOutputFormat.setOutputCompressorClass(job,  BZip2Codec.class);
-        }  else if (location.endsWith(".gz")) {
-            FileOutputFormat.setCompressOutput(job, true);
-            FileOutputFormat.setOutputCompressorClass(job, GzipCodec.class);
+        if( "true".equals( job.getConfiguration().get( "output.compression.enabled" ) ) ) {
+            FileOutputFormat.setCompressOutput( job, true );
+            String codec = job.getConfiguration().get( "output.compression.codec" );
+            try {
+                FileOutputFormat.setOutputCompressorClass( job,  (Class<? extends CompressionCodec>) Class.forName( codec ) );
+            } catch (ClassNotFoundException e) {
+                throw new RuntimeException("Class not found: " + codec );
+            }
         } else {
-            FileOutputFormat.setCompressOutput(job, false);
+            if (location.endsWith(".bz2") || location.endsWith(".bz")) {
+                FileOutputFormat.setCompressOutput(job, true);
+                FileOutputFormat.setOutputCompressorClass(job,  BZip2Codec.class);
+            }  else if (location.endsWith(".gz")) {
+                FileOutputFormat.setCompressOutput(job, true);
+                FileOutputFormat.setOutputCompressorClass(job, GzipCodec.class);
+            } else {
+                FileOutputFormat.setCompressOutput( job, false);
+            }
         }
     }
 
diff --git a/test/org/apache/pig/test/TestBZip.java b/test/org/apache/pig/test/TestBZip.java
index 401b243c4..d8567e9a5 100644
--- a/test/org/apache/pig/test/TestBZip.java
+++ b/test/org/apache/pig/test/TestBZip.java
@@ -440,4 +440,35 @@ public class TestBZip {
         stat = fs.getFileStatus(new Path("output.bz2/part-m-00000.bz2"));
         assertTrue(stat.getLen() > 0);     
     }
+
+    @Test
+    public void testBzipStoreInMultiQuery2() throws Exception {
+        String[] inputData = new String[] {
+                "1\t2\r3\t4"
+        };
+        
+        String inputFileName = "input2.txt";
+        Util.createInputFile(cluster, inputFileName, inputData);
+        
+        PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster
+                .getProperties());
+        PigContext pigContext = pig.getPigContext();
+        pigContext.getProperties().setProperty( "output.compression.enabled", "true" );
+        pigContext.getProperties().setProperty( "output.compression.codec", "org.apache.hadoop.io.compress.BZip2Codec" );
+        
+        pig.setBatchOn();
+        pig.registerQuery("a = load '" +  inputFileName + "';");
+        pig.registerQuery("store a into 'output2.bz2';");
+        pig.registerQuery("store a into 'output2';");
+        pig.executeBatch();
+        
+        FileSystem fs = FileSystem.get(ConfigurationUtil.toConfiguration(
+                pig.getPigContext().getProperties()));
+        FileStatus stat = fs.getFileStatus(new Path("output2/part-m-00000.bz2"));        
+        assertTrue(stat.getLen() > 0);     
+        
+        stat = fs.getFileStatus(new Path("output2.bz2/part-m-00000.bz2"));
+        assertTrue(stat.getLen() > 0);     
+    }
+    
 }
