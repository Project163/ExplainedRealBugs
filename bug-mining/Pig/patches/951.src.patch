diff --git a/CHANGES.txt b/CHANGES.txt
index 1adc571fd..821cdd2a2 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -106,6 +106,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-2644: Piggybank's HadoopJobHistoryLoader throws NPE when reading broken history file (herberts via daijy)
+
 PIG-2627: Custom partitioner not set when POSplit is involved in Plan (aniket486 via daijy)
 
 PIG-2596: Jython UDF does not handle boolean output (aniket486 via daijy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/HadoopJobHistoryLoader.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/HadoopJobHistoryLoader.java
index 7040e6c66..c1aba97da 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/HadoopJobHistoryLoader.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/HadoopJobHistoryLoader.java
@@ -482,7 +482,7 @@ public class HadoopJobHistoryLoader extends LoadFunc {
             // CHECK_IT: Only one SUCCESSFUL TASK ATTEMPT
             Map.Entry<String, JobHistory.TaskAttempt> tae = kv.next();
             JobHistory.TaskAttempt attempt = tae.getValue();
-            if (attempt.getValues().get(JobHistory.Keys.TASK_STATUS).equals(
+            if (null != attempt && null != attempt.getValues() && attempt.getValues().containsKey(JobHistory.Keys.TASK_STATUS) && attempt.getValues().get(JobHistory.Keys.TASK_STATUS).equals(
                     "SUCCESS")) {
                 return attempt.getValues();
             }
