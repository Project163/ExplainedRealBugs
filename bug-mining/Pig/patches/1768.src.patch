diff --git a/CHANGES.txt b/CHANGES.txt
index 8a07cc28b..8e3f69043 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -55,6 +55,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)
 
 BUG FIXES
 
+PIG-4703: TezOperator.stores shall not ship to backend (daijy)
+
 PIG-4696: Empty map returned by a streaming_python udf wrongly contains a null key (cheolsoo)
 
 PIG-4691: [Pig on Tez] Support for whitelisting storefuncs for union optimization (rohini)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
index f41d4d522..8b1b3fcba 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
@@ -486,7 +486,7 @@ public class TezDagBuilder extends TezOpPlanVisitor {
             // usually followed by limit other than store. But would benefit
             // cases like skewed join followed by group by.
             if (tezOp.getSortOperator().getEstimatedParallelism() != -1
-                    && TezCompilerUtil.isIntermediateReducer(tezOp.getSortOperator())) {
+                    && tezOp.getSortOperator().isIntermediateReducer()) {
                 payloadConf.setLong(
                         InputSizeReducerEstimator.BYTES_PER_REDUCER_PARAM,
                         intermediateTaskInputSize);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezEdgeDescriptor.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezEdgeDescriptor.java
index db9538abd..03b6c3707 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezEdgeDescriptor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezEdgeDescriptor.java
@@ -32,7 +32,7 @@ import org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput;
  */
 public class TezEdgeDescriptor implements Serializable {
     // Combiner runs on both input and output of Tez edge.
-    public PhysicalPlan combinePlan;
+    transient public PhysicalPlan combinePlan;
 
     public String inputClassName;
     public String outputClassName;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
index 52764ab09..0a7557133 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/TezOperator.java
@@ -18,6 +18,7 @@
 package org.apache.pig.backend.hadoop.executionengine.tez.plan;
 
 import java.io.ByteArrayOutputStream;
+import java.io.IOException;
 import java.io.Serializable;
 import java.util.ArrayList;
 import java.util.BitSet;
@@ -35,6 +36,7 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.util.PlanHelper;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.TezOperDependencyParallelismEstimator.TezParallelismFactorVisitor;
 import org.apache.pig.backend.hadoop.executionengine.tez.runtime.PigProcessor;
+import org.apache.pig.backend.hadoop.executionengine.tez.util.TezCompilerUtil;
 import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.plan.Operator;
 import org.apache.pig.impl.plan.OperatorKey;
@@ -145,7 +147,7 @@ public class TezOperator extends Operator<TezOpPlanVisitor> {
 
     private double parallelismFactor = -1;
 
-    private LinkedList<POStore> stores = null;
+    private Boolean intermediateReducer = null;
 
     // Types of blocking operators. For now, we only support the following ones.
     public static enum OPER_FEATURE {
@@ -644,11 +646,22 @@ public class TezOperator extends Operator<TezOpPlanVisitor> {
         return parallelismFactor;
     }
 
-    public LinkedList<POStore> getStores() throws VisitorException {
-        if (stores == null) {
-            stores = PlanHelper.getPhysicalOperators(plan, POStore.class);
+    public Boolean isIntermediateReducer() throws IOException {
+        if (intermediateReducer == null) {
+            intermediateReducer = false;
+            // set intermediateReducer to true if are no loads or stores in a TezOperator
+            LinkedList<POStore> stores = PlanHelper.getPhysicalOperators(plan, POStore.class);
+            // Not map and not final reducer
+            if (stores.size() <= 0 &&
+                    (getLoaderInfo().getLoads() == null || getLoaderInfo().getLoads().size() <= 0)) {
+                intermediateReducer = true;
+            }
         }
-        return stores;
+        return intermediateReducer;
+    }
+
+    public void setIntermediateReducer(Boolean intermediateReducer) {
+        this.intermediateReducer = intermediateReducer;
     }
 
     public static class VertexGroupInfo {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/ParallelismSetter.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/ParallelismSetter.java
index b878bd038..e793950fa 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/ParallelismSetter.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/ParallelismSetter.java
@@ -17,7 +17,6 @@
  */
 package org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer;
 
-import java.util.LinkedList;
 import java.util.Map;
 
 import org.apache.commons.logging.Log;
@@ -26,13 +25,11 @@ import org.apache.hadoop.conf.Configuration;
 import org.apache.pig.PigConfiguration;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
-import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezEdgeDescriptor;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezOpPlanVisitor;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezOperPlan;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezOperator;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.operator.NativeTezOper;
-import org.apache.pig.backend.hadoop.executionengine.tez.util.TezCompilerUtil;
 import org.apache.pig.backend.hadoop.executionengine.util.ParallelConstantVisitor;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.PigImplConstants;
@@ -80,11 +77,6 @@ public class ParallelismSetter extends TezOpPlanVisitor {
             // Can only set parallelism here if the parallelism isn't derived from
             // splits
             int parallelism = -1;
-            boolean intermediateReducer = false;
-            LinkedList<POStore> stores = tezOp.getStores();
-            if (stores.size() <= 0) {
-                intermediateReducer = true;
-            }
             if (tezOp.getLoaderInfo().getLoads() != null && tezOp.getLoaderInfo().getLoads().size() > 0) {
                 // requestedParallelism of Loader vertex is handled in LoaderProcessor
                 // propogate to vertexParallelism
@@ -93,7 +85,6 @@ public class ParallelismSetter extends TezOpPlanVisitor {
             } else {
                 int prevParallelism = -1;
                 boolean isOneToOneParallelism = false;
-                intermediateReducer = TezCompilerUtil.isIntermediateReducer(tezOp);
 
                 for (Map.Entry<OperatorKey,TezEdgeDescriptor> entry : tezOp.inEdges.entrySet()) {
                     if (entry.getValue().dataMovementType == DataMovementType.ONE_TO_ONE) {
@@ -126,7 +117,7 @@ public class ParallelismSetter extends TezOpPlanVisitor {
                     boolean overrideRequestedParallelism = false;
                     if (parallelism != -1
                             && autoParallelismEnabled
-                            && intermediateReducer
+                            && tezOp.isIntermediateReducer()
                             && !tezOp.isDontEstimateParallelism()
                             && tezOp.isOverrideIntermediateParallelism()) {
                         overrideRequestedParallelism = true;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/TezOperDependencyParallelismEstimator.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/TezOperDependencyParallelismEstimator.java
index d02f1dce4..61b0ca739 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/TezOperDependencyParallelismEstimator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/TezOperDependencyParallelismEstimator.java
@@ -36,6 +36,7 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POMergeJoin;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPackage;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POSplit;
+import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.util.PlanHelper;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezEdgeDescriptor;
 import org.apache.pig.backend.hadoop.executionengine.tez.plan.TezOperPlan;
@@ -79,15 +80,13 @@ public class TezOperDependencyParallelismEstimator implements TezParallelismEsti
             return -1;
         }
 
-        boolean intermediateReducer = TezCompilerUtil.isIntermediateReducer(tezOper);
-
         // TODO: If map opts and reduce opts are same estimate higher parallelism
         // for tasks based on the count of number of map tasks else be conservative as now
         maxTaskCount = conf.getInt(PigReducerEstimator.MAX_REDUCER_COUNT_PARAM,
                 PigReducerEstimator.DEFAULT_MAX_REDUCER_COUNT_PARAM);
 
         // If parallelism is set explicitly, respect it
-        if (!intermediateReducer && tezOper.getRequestedParallelism()!=-1) {
+        if (!tezOper.isIntermediateReducer() && tezOper.getRequestedParallelism()!=-1) {
             return tezOper.getRequestedParallelism();
         }
 
@@ -129,7 +128,7 @@ public class TezOperDependencyParallelismEstimator implements TezParallelismEsti
 
         int roundedEstimatedParallelism = (int)Math.ceil(estimatedParallelism);
 
-        if (intermediateReducer && tezOper.isOverrideIntermediateParallelism()) {
+        if (tezOper.isIntermediateReducer() && tezOper.isOverrideIntermediateParallelism()) {
             // Estimated reducers should not be more than the configured limit
             roundedEstimatedParallelism = Math.min(roundedEstimatedParallelism, maxTaskCount);
             int userSpecifiedParallelism = pc.defaultParallel;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
index 71083de0a..e5fa05483 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
@@ -251,19 +251,4 @@ public class TezCompilerUtil {
         edge.setIntermediateOutputValueClass(TUPLE_CLASS);
     }
 
-    /**
-     * Returns true if there are no loads or stores in a TezOperator.
-     * To be called only after LoaderProcessor is called
-     */
-    static public boolean isIntermediateReducer(TezOperator tezOper) throws VisitorException {
-        boolean intermediateReducer = false;
-        LinkedList<POStore> stores = tezOper.getStores();
-        // Not map and not final reducer
-        if (stores.size() <= 0 &&
-                (tezOper.getLoaderInfo().getLoads() == null || tezOper.getLoaderInfo().getLoads().size() <= 0)) {
-            intermediateReducer = true;
-        }
-        return intermediateReducer;
-    }
-
 }
diff --git a/test/org/apache/pig/tez/TestTezGraceParallelism.java b/test/org/apache/pig/tez/TestTezGraceParallelism.java
index cf8d19c55..4dc51b84b 100644
--- a/test/org/apache/pig/tez/TestTezGraceParallelism.java
+++ b/test/org/apache/pig/tez/TestTezGraceParallelism.java
@@ -26,17 +26,23 @@ import java.io.FileWriter;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.io.StringWriter;
-import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
+import java.util.Properties;
 import java.util.Random;
 import java.util.regex.Pattern;
 
+import org.apache.hadoop.mapreduce.Job;
 import org.apache.pig.PigServer;
+import org.apache.pig.ResourceSchema;
+import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.InputSizeReducerEstimator;
 import org.apache.pig.backend.hadoop.executionengine.tez.runtime.PigGraceShuffleVertexManager;
+import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.plan.NodeIdGenerator;
+import org.apache.pig.impl.util.ObjectSerializer;
+import org.apache.pig.impl.util.UDFContext;
 import org.apache.pig.test.Util;
 import org.apache.tez.dag.library.vertexmanager.ShuffleVertexManager;
 import org.junit.AfterClass;
@@ -282,4 +288,40 @@ public class TestTezGraceParallelism {
             Util.removeLogAppender(PigGraceShuffleVertexManager.class, "testJoinWithUnion");
         }
     }
+
+    @Test
+    // See PIG-4703
+    public void testUDFContextSetInBackend() throws IOException{
+        NodeIdGenerator.reset();
+        PigServer.resetScope();
+        File outputDir = File.createTempFile("intemediate", "txt");
+        outputDir.delete();
+        pigServer.registerQuery("A = load '" + INPUT_DIR + "/" + INPUT_FILE2 + "' as (name:chararray, gender:chararray);");
+        pigServer.registerQuery("B = order A by name;");
+        pigServer.registerQuery("C = distinct B;");
+        pigServer.registerQuery("D = load '" + INPUT_DIR + "/" + INPUT_FILE1 + "' as (name:chararray, age:int);");
+        pigServer.registerQuery("E = group D by name;");
+        pigServer.registerQuery("F = foreach E generate group as name, AVG(D.age) as avg_age;");
+        pigServer.registerQuery("G = join C by name left, F by name;");
+        ExecJob job = pigServer.store("G", Util.removeColon(outputDir.getAbsolutePath()), StorerWithUDFContextCheck.class.getName());
+        assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
+    }
+
+    static public class StorerWithUDFContextCheck extends PigStorage {
+        @Override
+        public void checkSchema(ResourceSchema resourceSchema) throws IOException {
+            UDFContext.getUDFContext().getUDFProperties(this.getClass(), new String[]{signature})
+            .setProperty("schema", ObjectSerializer.serialize(resourceSchema));
+        }
+        @Override
+        public void setStoreLocation(String location, Job job) throws IOException {
+            Properties udfProps = UDFContext.getUDFContext().getUDFProperties(
+                    this.getClass(), new String[]{signature});
+            ResourceSchema rs = (ResourceSchema)ObjectSerializer.deserialize(udfProps.getProperty("schema"));
+            if (rs == null) {
+                throw new IOException("Should not be null");
+            }
+            super.setStoreLocation(location, job);
+        }
+    }
 }
