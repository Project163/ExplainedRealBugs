diff --git a/CHANGES.txt b/CHANGES.txt
index 24c820fc8..1ba53a0f2 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -115,6 +115,8 @@ PIG-3882: Multiquery off mode execution is not done in batch and very inefficien
  
 BUG FIXES
 
+PIG-3909: Type Casting issue (daijy)
+
 PIG-3905: 0.12.1 release can't be build for Hadoop2 (daijy)
 
 PIG-3894: Datetime function AddDuration, SubtractDuration and all Between functions don't check for null values in the input tuple (jennythompson via cheolsoo)
diff --git a/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java b/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
index 1ef1a26a3..49f551fb9 100644
--- a/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
@@ -280,7 +280,10 @@ public class ProjectExpression extends ColumnExpression {
             return fieldSchema;
         LogicalRelationalOperator referent = findReferent();
 
-        LogicalSchema schema = referent.getSchema();
+        LogicalSchema schema = null;
+        if (referent.getSchema()!=null) {
+            schema = referent.getSchema().deepCopy();
+        }
 
         if (attachedRelationalOp instanceof LOGenerate && plan.getSuccessors(this)==null) {
             if (!(findReferent() instanceof LOInnerLoad)||
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index bb2396505..8b4746f11 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1216,4 +1216,19 @@ public class TestEvalPipelineLocal {
         Schema s = pigServer.dumpSchema("final");
         Assert.assertEquals(s.toString(), "{n1::x3: int}");
     }
+    
+    // see PIG-3909
+    @Test
+    public void testCastSchemaShare() throws Exception{
+        File f1 = createFile(new String[]{"{([fieldkey1#polisan,fieldkey2#lily])}"});
+        
+        pigServer.registerQuery("A = load '" + Util.encodeEscape(Util.generateURI(f1.toString(), pigServer.getPigContext()))
+                + "' as (bagofmap:{});");
+        pigServer.registerQuery("B = foreach A generate FLATTEN((IsEmpty(bagofmap) ? null : bagofmap)) AS bagofmap;");
+        pigServer.registerQuery("C = filter B by (chararray)bagofmap#'fieldkey1' matches 'po.*';");
+        pigServer.registerQuery("D = foreach C generate (chararray)bagofmap#'fieldkey2';");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("D");
+        Assert.assertEquals(iter.next().toString(), "(lily)");
+    }
 }
