diff --git a/CHANGES.txt b/CHANGES.txt
index 8c82631bc..725cbec60 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -28,6 +28,8 @@ PIG-4333: Split BigData tests into multiple groups (rohini)
  
 BUG FIXES
 
+PIG-4326: AvroStorageSchemaConversionUtilities does not properly convert schema for maps of arrays of records (mprim via daijy)
+
 PIG-4345: e2e test "RubyUDFs_13" fails because of the different result of "group a all" in different engines like "spark", "mapreduce" (kellyzly via rohini)
 
 PIG-4332: Remove redundant jars packaged into pig-withouthadoop.jar for hadoop 2 (rohini)
diff --git a/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java b/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
index fb89e9c76..c121ebd9d 100644
--- a/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
+++ b/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
@@ -219,21 +219,32 @@ public class AvroStorageSchemaConversionUtilities {
       ResourceSchema mapSchema = new ResourceSchema();
       ResourceSchema.ResourceFieldSchema[] mapSchemaFields =
           new ResourceSchema.ResourceFieldSchema[1];
-      if (mapAvroSchema.getType() == Type.RECORD) {
-        ResourceSchema innerResourceSchema =
-            avroSchemaToResourceSchema(fieldSchema.getValueType(), schemasInStack,
-            alreadyDefinedSchemas, allowRecursiveSchema);
+      switch(mapAvroSchema.getType()) {
+      case RECORD:
+        ResourceSchema innerResourceSchemaRecord =
+          avroSchemaToResourceSchema(fieldSchema.getValueType(), schemasInStack,
+          alreadyDefinedSchemas, allowRecursiveSchema);
         mapSchemaFields[0] = new ResourceSchema.ResourceFieldSchema();
         mapSchemaFields[0].setType(DataType.TUPLE);
         mapSchemaFields[0].setName(mapAvroSchema.getName());
-        mapSchemaFields[0].setSchema(innerResourceSchema);
+        mapSchemaFields[0].setSchema(innerResourceSchemaRecord);
         mapSchemaFields[0].setDescription(fieldSchema.getDoc());
-      } else {
+        mapSchema.setFields(mapSchemaFields);
+        rf.setSchema(mapSchema);
+        break;
+      case MAP:
+      case ARRAY:
+        ResourceSchema innerResourceSchema =
+            avroSchemaToResourceSchema(fieldSchema.getValueType(), schemasInStack,
+            alreadyDefinedSchemas, allowRecursiveSchema);
+        rf.setSchema(innerResourceSchema);
+        break;
+      default:
         mapSchemaFields[0] = new ResourceSchema.ResourceFieldSchema();
         mapSchemaFields[0].setType(getPigType(mapAvroSchema));
+        mapSchema.setFields(mapSchemaFields);
+        rf.setSchema(mapSchema);
       }
-      mapSchema.setFields(mapSchemaFields);
-      rf.setSchema(mapSchema);
     }
       break;
     case DataType.TUPLE:
diff --git a/test/org/apache/pig/builtin/TestAvroStorage.java b/test/org/apache/pig/builtin/TestAvroStorage.java
index ff0ba7ea9..878b3845f 100644
--- a/test/org/apache/pig/builtin/TestAvroStorage.java
+++ b/test/org/apache/pig/builtin/TestAvroStorage.java
@@ -103,6 +103,7 @@ public class TestAvroStorage {
         "recordsWithFixed",
         "recordsWithMaps",
         "recordsWithMapsOfRecords",
+        "recordsWithMapsOfArrayOfRecords",
         "recordsWithNullableUnions",
         "recordWithRepeatedSubRecords",
         "recursiveRecord",
@@ -543,6 +544,18 @@ public class TestAvroStorage {
       verifyResults(createOutputName(),check);
     }
 
+    @Test public void testLoadRecordsWithMapsOfArrayOfRecords() throws Exception {
+        final String input = basedir + "data/avro/uncompressed/recordsWithMapsOfArrayOfRecords.avro";
+        final String check = input;
+        testAvroStorage(true, basedir + "code/pig/identity_just_ao2.pig",
+            ImmutableMap.of(
+                "INFILE",             input,
+                "AVROSTORAGE_OUT_2", "-f " + basedir + "schema/recordsWithMapsOfArrayOfRecords.avsc",
+                "OUTFILE",            createOutputName())
+          );
+        verifyResults(createOutputName(),check);
+      }
+
     @Test public void testLoadRecordsWithNullableUnions() throws Exception {
       final String input = basedir + "data/avro/uncompressed/recordsWithNullableUnions.avro";
       final String check = input;
diff --git a/test/org/apache/pig/builtin/avro/data/json/recordsWithMapsOfArrayOfRecords.json b/test/org/apache/pig/builtin/avro/data/json/recordsWithMapsOfArrayOfRecords.json
new file mode 100644
index 000000000..711b9bdc2
--- /dev/null
+++ b/test/org/apache/pig/builtin/avro/data/json/recordsWithMapsOfArrayOfRecords.json
@@ -0,0 +1,25 @@
+{"key" : "A",
+ "value" : 1,
+ "parameters" : {
+   "firstParameter" : []
+  }
+}
+{"key" : "B",
+ "value" : 2,
+ "parameters" : {}
+}
+{"key" : "C",
+ "value" : 3,
+ "parameters" : {
+     "firstParameter" : [
+       {"k" : "c", "v" : 3},
+       {"k" : "c1", "v" : 4},
+       {"k" : "c2", "v" : 5}
+     ],
+     "secondParameter" : [
+       {"k" : "c3", "v" : 6},
+       {"k" : "c4", "v" : 7},
+       {"k" : "c5", "v" : 8}
+     ]
+  }
+}
diff --git a/test/org/apache/pig/builtin/avro/schema/recordsWithMapsOfArrayOfRecords.avsc b/test/org/apache/pig/builtin/avro/schema/recordsWithMapsOfArrayOfRecords.avsc
new file mode 100644
index 000000000..4e9b9574c
--- /dev/null
+++ b/test/org/apache/pig/builtin/avro/schema/recordsWithMapsOfArrayOfRecords.avsc
@@ -0,0 +1,24 @@
+{
+  "name" : "recordsWithMapsOfArrayOfRecords",
+  "namespace" : "org.apache.pig.test.builtin",
+  "type" : "record",
+  "fields" : [
+    {"name" : "key", "type" : "string"},
+    {"name" : "value", "type" : "int"},
+    {"name" : "parameters", "type" :
+      {"type" : "map",
+       "values" : {
+         "type" : "array",
+         "items" : {
+            "name" : "innerRecord",
+            "type" : "record",
+            "fields" : [
+              {"name" : "k", "type" : "string"},
+              {"name" : "v", "type" : "int"}
+            ]
+          }
+        }
+      }  
+    }    
+  ]
+}
