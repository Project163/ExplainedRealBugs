diff --git a/CHANGES.txt b/CHANGES.txt
index 8fcb6d5ae..11c4b5f46 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -192,6 +192,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3310: ImplicitSplitInserter does not generate new uids for nested schema fields, leading to miscomputations (cstenac via daijy)
+
 PIG-3334: Fix Windows piggybank unit test failures (daijy)
 
 PIG-3337: Fix remaining Window e2e tests (daijy)
diff --git a/src/org/apache/pig/newplan/logical/relational/LOSplitOutput.java b/src/org/apache/pig/newplan/logical/relational/LOSplitOutput.java
index f99252968..3fbf1406d 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOSplitOutput.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOSplitOutput.java
@@ -23,6 +23,7 @@ import java.util.HashSet;
 import java.util.Map;
 import java.util.Set;
 
+import org.apache.pig.data.DataType;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.util.Pair;
 import org.apache.pig.newplan.Operator;
@@ -51,6 +52,23 @@ public class LOSplitOutput extends LogicalRelationalOperator {
         this.filterPlan = filterPlan;
     }
     
+    private void reassignUidRec(LogicalSchema schema) {
+        for (LogicalFieldSchema fs : schema.getFields()) {
+            /* If one of the field contains a nested schema, we need to reassign Uids on the nested fields too */
+            if (fs.schema != null && (fs.type == DataType.TUPLE || fs.type == DataType.BAG || fs.type == DataType.MAP)) {
+                reassignUidRec(fs.schema);
+            }
+            if (uidMapping.containsKey(fs.uid)) {
+                fs.uid = uidMapping.get(fs.uid);
+            }
+            else {
+                long predUid = fs.uid;
+                fs.uid = LogicalExpression.getNextUid();
+                uidMapping.put(predUid, fs.uid);
+            }
+        }
+    }
+    
     @Override
     public LogicalSchema getSchema() throws FrontendException {
         if (schema!=null)
@@ -61,16 +79,7 @@ public class LOSplitOutput extends LogicalRelationalOperator {
         
         if (input.getSchema()!=null) {
             schema = input.getSchema().deepCopy();
-            for (LogicalFieldSchema fs : schema.getFields()) {
-                if (uidMapping.containsKey(fs.uid)) {
-                    fs.uid = uidMapping.get(fs.uid);
-                }
-                else {
-                    long predUid = fs.uid;
-                    fs.uid = LogicalExpression.getNextUid();
-                    uidMapping.put(predUid, fs.uid);
-                }
-            }
+            reassignUidRec(schema);
         }
         return schema;
     }   
