diff --git a/CHANGES.txt b/CHANGES.txt
index aaa95c99d..48d5f9029 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -195,6 +195,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1595: casting relation to scalar- problem with handling of data from non PigStorage loaders (thejas)
+
 PIG-1591: pig does not create a log file, if tje MR job succeeds but front end fails (nrai via daijy)
 
 PIG-1543: IsEmpty returns the wrong value after using LIMIT (daijy)
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 196ed1331..45c18fb82 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -1261,9 +1261,13 @@ public class PigServer {
                 // If referredPlan already has a store, 
                 // we just use it instead of adding one from our pocket
                 store = referredPlan.getLeaves().get(0);
-                if(store instanceof LOStore) {
-                    // use this store
-                    fileSpec = ((LOStore)store).getOutputFile();
+                if(store instanceof LOStore 
+                        &&
+                        ((LOStore)store).getOutputFile().getFuncName().equals(
+                                InterStorage.class.getName())                                            
+                ) {
+                        // use this store
+                        fileSpec = ((LOStore)store).getOutputFile();
                 }
                 else {
                     // add new store
diff --git a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
index bed29e4b4..faac5cac2 100644
--- a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
+++ b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
@@ -783,12 +783,12 @@ public class QueryParser {
         lp.add(rconst);
         lp.connect(rconst, expr);
 
-        if(over != null && over.getField(colNum).type != DataType.BYTEARRAY) {
-            LOCast loCast = new LOCast(lp, new OperatorKey(scope, getNextId()), over.getField(colNum).type);
-            lp.add(loCast);
-            lp.connect(expr, loCast);
-            expr = loCast;
-        } 
+//        if(over != null && over.getField(colNum).type != DataType.BYTEARRAY) {
+//            LOCast loCast = new LOCast(lp, new OperatorKey(scope, getNextId()), over.getField(colNum).type);
+//            lp.add(loCast);
+//            lp.connect(expr, loCast);
+//            expr = loCast;
+//        } 
         return expr;
     }    
 }
diff --git a/src/org/apache/pig/newplan/DependencyOrderWalker.java b/src/org/apache/pig/newplan/DependencyOrderWalker.java
index 87e44e591..f7828895d 100644
--- a/src/org/apache/pig/newplan/DependencyOrderWalker.java
+++ b/src/org/apache/pig/newplan/DependencyOrderWalker.java
@@ -64,7 +64,7 @@ public class DependencyOrderWalker extends PlanWalker {
 
         List<Operator> fifo = new ArrayList<Operator>();
         Set<Operator> seen = new HashSet<Operator>();
-        List<Operator> leaves = plan.getSinks();
+        List<Operator> leaves = getSinks();
         if (leaves == null) return;
         for (Operator op : leaves) {
             doAllPredecessors(op, seen, fifo);
@@ -74,6 +74,10 @@ public class DependencyOrderWalker extends PlanWalker {
             op.accept(visitor);
         }
     }
+    
+    protected List<Operator> getSinks() throws FrontendException{
+        return plan.getSinks();
+    }
 
     protected void doAllPredecessors(Operator node,
                                    Set<Operator> seen,
diff --git a/src/org/apache/pig/newplan/logical/expression/ExpToPhyTranslationVisitor.java b/src/org/apache/pig/newplan/logical/expression/ExpToPhyTranslationVisitor.java
index bafddffe4..c25efd1f1 100644
--- a/src/org/apache/pig/newplan/logical/expression/ExpToPhyTranslationVisitor.java
+++ b/src/org/apache/pig/newplan/logical/expression/ExpToPhyTranslationVisitor.java
@@ -511,7 +511,7 @@ public class ExpToPhyTranslationVisitor extends LogicalExpressionVisitor {
         
         //We need to track all the scalars
         if(op.getImplicitReferencedOperator() != null) {
-            scalarAliasMap.put(p, (LogicalRelationalOperator)op.getImplicitReferencedOperator());
+            scalarAliasMap.put(p, op.getImplicitReferencedOperator());
         }
     }
     
diff --git a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
index e6dbbeb24..a0e287737 100644
--- a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
@@ -41,7 +41,7 @@ import org.apache.pig.newplan.logical.relational.LogicalSchema.LogicalFieldSchem
 public class UserFuncExpression extends LogicalExpression {
 
     private FuncSpec mFuncSpec;
-    private Operator implicitReferencedOperator = null; 
+    private LogicalRelationalOperator implicitReferencedOperator = null; 
     
     public UserFuncExpression(OperatorPlan plan, FuncSpec funcSpec) {
         super("UserFunc", plan);
@@ -108,12 +108,9 @@ public class UserFuncExpression extends LogicalExpression {
             List<Operator> args = plan.getSuccessors(this);
             if(args != null && args.size() > 0 ){
                 int pos = (Integer)((ConstantExpression)args.get(0)).getValue();
-                LogicalRelationalOperator inp = (LogicalRelationalOperator)implicitReferencedOperator;
-
-                if( inp.getSchema() != null){
-                    LogicalFieldSchema inpFs = inp.getSchema().getField(pos);
+                if( implicitReferencedOperator.getSchema() != null){
+                    LogicalFieldSchema inpFs = implicitReferencedOperator.getSchema().getField(pos);
                     fieldSchema = new LogicalFieldSchema(inpFs);
-                    //  fieldSchema.alias = "ReadScalars_" + fieldSchema.alias;
                 }else{
                     fieldSchema = new LogicalFieldSchema(null, null, DataType.BYTEARRAY);
                 }
@@ -157,11 +154,11 @@ public class UserFuncExpression extends LogicalExpression {
         return fieldSchema;
     }
     
-    public Operator getImplicitReferencedOperator() {
+    public LogicalRelationalOperator getImplicitReferencedOperator() {
         return implicitReferencedOperator;
     }
     
-    public void setImplicitReferencedOperator(Operator implicitReferencedOperator) {
+    public void setImplicitReferencedOperator(LogicalRelationalOperator implicitReferencedOperator) {
         this.implicitReferencedOperator = implicitReferencedOperator;
     }
 
diff --git a/src/org/apache/pig/newplan/logical/optimizer/SchemaPatcher.java b/src/org/apache/pig/newplan/logical/optimizer/SchemaPatcher.java
index 21c00e1d0..2a3a9a903 100644
--- a/src/org/apache/pig/newplan/logical/optimizer/SchemaPatcher.java
+++ b/src/org/apache/pig/newplan/logical/optimizer/SchemaPatcher.java
@@ -20,6 +20,7 @@ package org.apache.pig.newplan.logical.optimizer;
 
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.newplan.OperatorPlan;
+import org.apache.pig.newplan.logical.relational.LogicalPlan;
 import org.apache.pig.newplan.optimizer.PlanTransformListener;
 
 /**
diff --git a/src/org/apache/pig/newplan/logical/optimizer/SchemaResetter.java b/src/org/apache/pig/newplan/logical/optimizer/SchemaResetter.java
index 6957d0476..e4eddeeb2 100644
--- a/src/org/apache/pig/newplan/logical/optimizer/SchemaResetter.java
+++ b/src/org/apache/pig/newplan/logical/optimizer/SchemaResetter.java
@@ -5,7 +5,7 @@ import java.util.List;
 
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.util.MultiMap;
-import org.apache.pig.newplan.DependencyOrderWalker;
+import org.apache.pig.newplan.DependencyOrderWalkerLPScalar;
 import org.apache.pig.newplan.OperatorPlan;
 import org.apache.pig.newplan.PlanWalker;
 import org.apache.pig.newplan.ReverseDependencyOrderWalker;
@@ -33,7 +33,7 @@ import org.apache.pig.newplan.logical.relational.LogicalRelationalNodesVisitor;
 public class SchemaResetter extends LogicalRelationalNodesVisitor {
 
     public SchemaResetter(OperatorPlan plan) throws FrontendException {
-        super(plan, new DependencyOrderWalker(plan));
+        super(plan, new DependencyOrderWalkerLPScalar(plan));
     }
 
     @Override
