diff --git a/CHANGES.txt b/CHANGES.txt
index 3a205d2f5..d97dab9d1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -156,6 +156,8 @@ PIG-2228: support partial aggregation in map task (thejas)
 
 BUG FIXES
 
+PIG-2119: DuplicateForEachColumnRewrite makes assumptions about the position of LOGGenerate in the plan (daijy)
+
 PIG-2290: TOBAG wraps tuple parameters in another tuple (ryan.hoegg via thejas)
 
 PIG-2288: Pig 0.9 error message not useful as compared to 0.8 in case 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java b/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
index c7a07c574..f5ea8607d 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
@@ -48,6 +48,7 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.util.ObjectSerializer;
 import org.apache.pig.newplan.Operator;
+import org.apache.pig.newplan.logical.optimizer.DanglingNestedNodeRemover;
 import org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer;
 import org.apache.pig.newplan.logical.optimizer.SchemaResetter;
 import org.apache.pig.newplan.logical.optimizer.UidResetter;
@@ -236,6 +237,9 @@ public class HExecutionEngine {
             pod.visit();
         }
         
+        DanglingNestedNodeRemover DanglingNestedNodeRemover = new DanglingNestedNodeRemover( plan );
+        DanglingNestedNodeRemover.visit();
+        
         UidResetter uidResetter = new UidResetter( plan );
         uidResetter.visit();
         
diff --git a/src/org/apache/pig/newplan/logical/optimizer/DanglingNestedNodeRemover.java b/src/org/apache/pig/newplan/logical/optimizer/DanglingNestedNodeRemover.java
new file mode 100644
index 000000000..496eddab8
--- /dev/null
+++ b/src/org/apache/pig/newplan/logical/optimizer/DanglingNestedNodeRemover.java
@@ -0,0 +1,67 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pig.newplan.logical.optimizer;
+
+import java.util.ArrayList;
+import java.util.Iterator;
+import java.util.List;
+
+import org.apache.pig.impl.logicalLayer.FrontendException;
+import org.apache.pig.newplan.DependencyOrderWalker;
+import org.apache.pig.newplan.Operator;
+import org.apache.pig.newplan.OperatorPlan;
+import org.apache.pig.newplan.logical.relational.LOForEach;
+import org.apache.pig.newplan.logical.relational.LOGenerate;
+import org.apache.pig.newplan.logical.relational.LogicalPlan;
+import org.apache.pig.newplan.logical.relational.LogicalRelationalNodesVisitor;
+
+public class DanglingNestedNodeRemover extends LogicalRelationalNodesVisitor {
+
+    public DanglingNestedNodeRemover(OperatorPlan plan)
+            throws FrontendException {
+        super(plan, new DependencyOrderWalker(plan));
+    }
+
+    @Override
+    public void visit(LOForEach foreach) throws FrontendException {
+        LogicalPlan innerPlan = foreach.getInnerPlan();
+        List<Operator> opsToRemove = new ArrayList<Operator>();
+        Iterator<Operator> ops = innerPlan.getOperators();
+        
+        while (ops.hasNext()) {
+            Operator op = ops.next();
+            // Check if op leads to LOGenerate, otherwise, candidate to remove
+            Operator currentOp = op;
+            boolean endWithNoLOGenerate = false;
+            while (!(currentOp instanceof LOGenerate)) {
+                if (innerPlan.getSuccessors(currentOp)==null) {
+                    endWithNoLOGenerate = true;
+                    break;
+                }
+                currentOp = innerPlan.getSuccessors(currentOp).get(0);
+            }
+            if (endWithNoLOGenerate)
+                opsToRemove.add(op);
+        }
+        
+        for (Operator op : opsToRemove) {
+            innerPlan.removeAndReconnect(op);
+        }
+    }
+}
diff --git a/test/org/apache/pig/test/TestPlanGeneration.java b/test/org/apache/pig/test/TestPlanGeneration.java
index 91a4ba352..dc79f1fde 100644
--- a/test/org/apache/pig/test/TestPlanGeneration.java
+++ b/test/org/apache/pig/test/TestPlanGeneration.java
@@ -175,4 +175,20 @@ public class TestPlanGeneration extends junit.framework.TestCase {
         poStore = (POStore)mrOper.mapPlan.getLeaves().get(0);
         assert(poStore.getAlias().equals("B"));
     }
+    
+    // See PIG-2119
+    @Test
+    public void testDanglingNestedNode() throws Exception  {
+        String query = "a = load 'b.txt' AS (id:chararray, num:int); " +
+            "b = group a by id;" +
+            "c = foreach b {" +
+            "  d = order a by num DESC;" +
+            "  n = COUNT(a);" +
+            "  e = limit d 1;" +
+            "  generate n;" +
+            "};";
+        
+        LogicalPlan lp = Util.parse(query, pc);
+        Util.optimizeNewLP(lp);
+    }
 }
diff --git a/test/org/apache/pig/test/Util.java b/test/org/apache/pig/test/Util.java
index 100f82ead..9c07b831b 100644
--- a/test/org/apache/pig/test/Util.java
+++ b/test/org/apache/pig/test/Util.java
@@ -82,6 +82,7 @@ import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.logicalLayer.schema.Schema.FieldSchema;
 import org.apache.pig.impl.plan.CompilationMessageCollector;
 import org.apache.pig.impl.util.LogUtils;
+import org.apache.pig.newplan.logical.optimizer.DanglingNestedNodeRemover;
 import org.apache.pig.newplan.logical.optimizer.LogicalPlanPrinter;
 import org.apache.pig.newplan.logical.optimizer.SchemaResetter;
 import org.apache.pig.newplan.logical.relational.LOStore;
@@ -721,6 +722,9 @@ public class Util {
     public static  LogicalPlan optimizeNewLP( 
             LogicalPlan lp)
     throws FrontendException{
+        DanglingNestedNodeRemover DanglingNestedNodeRemover = new DanglingNestedNodeRemover( lp );
+        DanglingNestedNodeRemover.visit();
+        
         UidResetter uidResetter = new UidResetter( lp );
         uidResetter.visit();
         
