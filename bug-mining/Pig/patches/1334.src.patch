diff --git a/CHANGES.txt b/CHANGES.txt
index 9c93898be..8a1a55416 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -64,6 +64,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-3657: New partition filter extractor fails with NPE (cheolsoo)
+
 PIG-3617: problem with temp file deletion in MAPREDUCE operator (nezihyigitbasi via cheolsoo)
 
 PIG-3649: POPartialAgg incorrectly calculates size reduction when multiple values aggregated (tmwoodruff via daijy)
diff --git a/src/org/apache/pig/newplan/FilterExtractor.java b/src/org/apache/pig/newplan/FilterExtractor.java
index 43cc62aa1..2a327d37a 100644
--- a/src/org/apache/pig/newplan/FilterExtractor.java
+++ b/src/org/apache/pig/newplan/FilterExtractor.java
@@ -180,23 +180,35 @@ public class FilterExtractor {
     }
 
     private LogicalExpression andLogicalExpressions(
-            LogicalExpressionPlan plan, LogicalExpression a, LogicalExpression b) {
+            LogicalExpressionPlan plan, LogicalExpression a, LogicalExpression b) throws FrontendException {
         if (a == null) {
             return b;
         }
         if (b == null) {
             return a;
         }
+        if (!plan.ops.contains(a)) {
+            a = a.deepCopy(plan);
+        }
+        if (!plan.ops.contains(b)) {
+            b = b.deepCopy(plan);
+        }
         LogicalExpression andOp = new AndExpression(plan, a, b);
         return andOp;
     }
 
     private LogicalExpression orLogicalExpressions(
-            LogicalExpressionPlan plan, LogicalExpression a, LogicalExpression b) {
+            LogicalExpressionPlan plan, LogicalExpression a, LogicalExpression b) throws FrontendException {
         // Or 2 operators if they are not null
         if (a == null || b == null) {
             return null;
         }
+        if (!plan.ops.contains(a)) {
+            a = a.deepCopy(plan);
+        }
+        if (!plan.ops.contains(b)) {
+            b = b.deepCopy(plan);
+        }
         LogicalExpression orOp = new OrExpression(plan, a, b);
         return orOp;
     }
@@ -234,7 +246,7 @@ public class FilterExtractor {
             //              AND (leftState.filterExpr OR rightState.pushdownExpr)
             //              AND (leftState.filterExpr OR rightState.filterExpr)
             state.pushdownExpr = orLogicalExpressions(pushdownExprPlan, leftState.pushdownExpr, rightState.pushdownExpr);
-            if(state.pushdownExpr == null) {
+            if (state.pushdownExpr == null) {
                 // Whatever we did so far on the right tree is all wasted :(
                 // Undo all the mutation (AND OR distributions) until now
                 removeFromFilteredPlan(leftState.filterExpr);
diff --git a/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java b/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
index 9c1061967..703d86f73 100644
--- a/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
+++ b/test/org/apache/pig/test/TestNewPartitionFilterPushDown.java
@@ -61,6 +61,7 @@ import org.apache.pig.newplan.logical.expression.OrExpression;
 import org.apache.pig.newplan.logical.expression.ProjectExpression;
 import org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer;
 import org.apache.pig.newplan.logical.relational.LOFilter;
+import org.apache.pig.newplan.logical.relational.LogToPhyTranslationVisitor;
 import org.apache.pig.newplan.logical.relational.LogicalPlan;
 import org.apache.pig.newplan.logical.rules.LoadTypeCastInserter;
 import org.apache.pig.newplan.logical.rules.PartitionFilterOptimizer;
@@ -466,6 +467,10 @@ public class TestNewPartitionFilterPushDown {
                         (it.next() instanceof LOFilter));
             }
         }
+
+        // Test that the filtered plan can be translated to physical plan (PIG-3657)
+        LogToPhyTranslationVisitor translator = new LogToPhyTranslationVisitor(newLogicalPlan);
+        translator.visit();
     }
 
     /**
@@ -671,6 +676,16 @@ public class TestNewPartitionFilterPushDown {
         negativeTest(q, Arrays.asList("srcid", "mrkt", "dstid"));
     }
 
+    // PIG-3657
+    @Test
+    public void testFilteredPlanWithLogToPhyTranslator() throws Exception {
+        String q = "a = load 'foo' using " + TestLoader.class.getName() +
+                "('srcid:int, mrkt:chararray', 'srcid') as (f1, f2);" +
+                "b = filter a by (f1 < 5 or (f1 == 10 and f2 == 'UK'));" +
+                "store b into 'out';";
+        testFull(q, "((srcid < 5) or (srcid == 10))", "((f1 < 5) or (f2 == 'UK'))", false);
+    }
+
     //// helper methods ///////
     private FilterExtractor test(String query, List<String> partitionCols,
             String expPartFilterString, String expFilterString)
