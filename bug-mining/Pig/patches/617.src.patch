diff --git a/CHANGES.txt b/CHANGES.txt
index dba97431a..4e1bb7237 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -86,6 +86,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-767: Schema reported from DESCRIBE and actual schema of inner bags are different (daijy)
+
 PIG-1801: Need better error message for Jython errors (rding)
 
 PIG-1742: org.apache.pig.newplan.optimizer.Rule.java does not work
diff --git a/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java b/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
index a82bc3444..8590f13ac 100644
--- a/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
@@ -135,25 +135,24 @@ public class DereferenceExpression extends ColumnExpression {
         LogicalExpression successor = (LogicalExpression)plan.getSuccessors(this).get(0);
         LogicalFieldSchema predFS = successor.getFieldSchema();
         if (predFS!=null) {
-            if (columns.size()>1 || predFS.type==DataType.BAG) {
+            if (predFS.type==DataType.BAG) {
                 LogicalSchema innerSchema = null;
                 if (predFS.schema!=null) {
                     innerSchema = new LogicalSchema();
-                    LogicalSchema realSchema;
-                    if (predFS.schema.isTwoLevelAccessRequired()) {
-                        realSchema = predFS.schema.getField(0).schema;
-                    }
-                    else {
-                        realSchema = predFS.schema;
-                    }
-                    if (realSchema!=null) {
+                    // Get the tuple inner schema
+                    LogicalSchema origSchema = predFS.schema.getField(0).schema;;
+                    // Slice the tuple inner schema
+                    if (origSchema!=null) {
                         for (int column:columns) {
-                            innerSchema.addField(realSchema.getField(column));
+                            innerSchema.addField(origSchema.getField(column));
                         }
                     }
                 }
-                fieldSchema = new LogicalSchema.LogicalFieldSchema(null, innerSchema, predFS.type, 
-                        LogicalExpression.getNextUid());
+                LogicalSchema bagSchema = new LogicalSchema();
+                bagSchema.setTwoLevelAccessRequired(true);
+                bagSchema.addField(new LogicalSchema.LogicalFieldSchema(null, innerSchema, DataType.TUPLE, 
+                        LogicalExpression.getNextUid()));
+                fieldSchema = new LogicalSchema.LogicalFieldSchema(null, bagSchema, DataType.BAG, LogicalExpression.getNextUid());
             }
             else { // Dereference a field out of a tuple
                 if (predFS.schema!=null)
diff --git a/src/org/apache/pig/newplan/logical/relational/LOCogroup.java b/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
index 598b1ec81..3fe587547 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
@@ -195,11 +195,18 @@ public class LOCogroup extends LogicalRelationalOperator {
                 generatedInputUids.put( counter, bagUid );
             }
             
-            LogicalFieldSchema newBagSchema = new LogicalFieldSchema(
-                    ((LogicalRelationalOperator)op).getAlias(), inputSchema, 
+            LogicalFieldSchema newTupleFieldSchema = new LogicalFieldSchema(
+                    null, inputSchema, DataType.TUPLE, LogicalExpression.getNextUid());
+            
+            LogicalSchema bagSchema = new LogicalSchema();
+            bagSchema.addField(newTupleFieldSchema);
+            bagSchema.setTwoLevelAccessRequired(true);
+            
+            LogicalFieldSchema newBagFieldSchema = new LogicalFieldSchema(
+                    ((LogicalRelationalOperator)op).getAlias(), bagSchema, 
                     DataType.BAG, bagUid);
 
-            fieldSchemaList.add( newBagSchema );
+            fieldSchemaList.add( newBagFieldSchema );
             counter ++;
         }
 
diff --git a/src/org/apache/pig/newplan/logical/relational/LOGenerate.java b/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
index 8a54d16dd..6d68daef5 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
@@ -109,9 +109,11 @@ public class LOGenerate extends LogicalRelationalOperator {
                                 if (fieldSchema.schema!=null) {
                                     if (fieldSchema.schema.isTwoLevelAccessRequired()) {
                                         //  assert(fieldSchema.schema.size() == 1 && fieldSchema.schema.getField(0).type == DataType.TUPLE)
-                                        innerFieldSchemas = fieldSchema.schema.getField(0).schema.getFields();
+                                        if (fieldSchema.schema!=null && fieldSchema.schema.getField(0).schema!=null)
+                                            innerFieldSchemas = fieldSchema.schema.getField(0).schema.getFields();
                                     } else {
-                                        innerFieldSchemas = fieldSchema.schema.getFields();
+                                        if (fieldSchema.schema!=null)
+                                            innerFieldSchemas = fieldSchema.schema.getFields();
                                     }
                                     for (LogicalSchema.LogicalFieldSchema fs : innerFieldSchemas) {
                                         fs.alias = fieldSchema.alias + "::" + fs.alias;
diff --git a/src/org/apache/pig/newplan/logical/relational/LOInnerLoad.java b/src/org/apache/pig/newplan/logical/relational/LOInnerLoad.java
index e67649e44..a48ca32af 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOInnerLoad.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOInnerLoad.java
@@ -70,12 +70,14 @@ public class LOInnerLoad extends LogicalRelationalOperator {
             if (prj.getFieldSchema()!=null) {
                 if (prj.getFieldSchema().type==DataType.BAG && prj.getFieldSchema().schema!=null &&
                         prj.getFieldSchema().schema.isTwoLevelAccessRequired()) {
-                    schema = new LogicalSchema();
                     LogicalFieldSchema tupleSchema = prj.getFieldSchema().schema.getField(0);
-                    for (int i=0;i<tupleSchema.schema.size();i++)
-                        schema.addField(tupleSchema.schema.getField(i));
+                    if (tupleSchema!=null && tupleSchema.schema!=null) {
+                        schema = new LogicalSchema();
+                        for (int i=0;i<tupleSchema.schema.size();i++)
+                            schema.addField(tupleSchema.schema.getField(i));
+                        alias = prj.getFieldSchema().alias;
+                    }
                     sourceIsBag = true;
-                    alias = prj.getFieldSchema().alias;
                 }
                 else if (prj.getFieldSchema().type==DataType.BAG){
                     sourceIsBag = true;
diff --git a/src/org/apache/pig/newplan/logical/rules/DuplicateForEachColumnRewrite.java b/src/org/apache/pig/newplan/logical/rules/DuplicateForEachColumnRewrite.java
index 27c04b4bc..c8902ca04 100644
--- a/src/org/apache/pig/newplan/logical/rules/DuplicateForEachColumnRewrite.java
+++ b/src/org/apache/pig/newplan/logical/rules/DuplicateForEachColumnRewrite.java
@@ -102,9 +102,11 @@ public class DuplicateForEachColumnRewrite extends Rule {
                             if (exp.getFieldSchema().schema!=null) {
                                 if (exp.getFieldSchema().schema.isTwoLevelAccessRequired()) {
                                     //  assert(fieldSchema.schema.size() == 1 && fieldSchema.schema.getField(0).type == DataType.TUPLE)
-                                    innerFieldSchemas = exp.getFieldSchema().schema.getField(0).schema.getFields();
+                                    if (exp.getFieldSchema().schema.getField(0).schema!=null)
+                                        innerFieldSchemas = exp.getFieldSchema().schema.getField(0).schema.getFields();
                                 } else {
-                                    innerFieldSchemas = exp.getFieldSchema().schema.getFields();
+                                    if (exp.getFieldSchema().schema!=null)
+                                        innerFieldSchemas = exp.getFieldSchema().schema.getFields();
                                 }
                             }
                         }
diff --git a/test/org/apache/pig/test/TestLogicalPlanMigrationVisitor.java b/test/org/apache/pig/test/TestLogicalPlanMigrationVisitor.java
index 110469f6b..38e4c8f9c 100644
--- a/test/org/apache/pig/test/TestLogicalPlanMigrationVisitor.java
+++ b/test/org/apache/pig/test/TestLogicalPlanMigrationVisitor.java
@@ -421,18 +421,19 @@ public class TestLogicalPlanMigrationVisitor extends TestCase {
         assertEquals( false, uids.contains( schema.getField(0).uid ) );
         assertEquals( 0, schema.getField(0).alias.compareTo("group") );
         
-        
         assertEquals( DataType.BAG, schema.getField(1).type );
-        
-        assertEquals( DataType.CHARARRAY, schema.getField(1).schema.getField(0).type );
-        assertEquals( 0, schema.getField(1).schema.getField(0).alias.compareTo("name") );
-        assertEquals( loadSchema.getField(0).uid, schema.getField(1).schema.getField(0).uid );
-        assertEquals( DataType.INTEGER, schema.getField(1).schema.getField(1).type );
-        assertEquals( 0, schema.getField(1).schema.getField(1).alias.compareTo("age") );
-        assertEquals( loadSchema.getField(1).uid, schema.getField(1).schema.getField(1).uid );
-        assertEquals( DataType.FLOAT, schema.getField(1).schema.getField(2).type );
-        assertEquals( 0, schema.getField(1).schema.getField(2).alias.compareTo("gpa") );
-        assertEquals( loadSchema.getField(2).uid, schema.getField(1).schema.getField(2).uid );
+        LogicalSchema bagSchema = schema.getField(1).schema;
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( loadSchema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.INTEGER, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("age") );
+        assertEquals( loadSchema.getField(1).uid, tupleSchema.getField(1).uid );
+        assertEquals( DataType.FLOAT, tupleSchema.getField(2).type );
+        assertEquals( 0, tupleSchema.getField(2).alias.compareTo("gpa") );
+        assertEquals( loadSchema.getField(2).uid, tupleSchema.getField(2).uid );
         
         uids.add(Long.valueOf( schema.getField(0).uid ) );
         assertEquals( false, uids.contains( schema.getField(1).uid ) );
@@ -481,17 +482,18 @@ public class TestLogicalPlanMigrationVisitor extends TestCase {
         assertEquals( DataType.INTEGER, schema.getField(0).schema.getField(1).type );
         
         assertEquals( DataType.BAG, schema.getField(1).type );
-        
-        assertEquals( DataType.CHARARRAY, schema.getField(1).schema.getField(0).type );
-        assertEquals( 0, schema.getField(1).schema.getField(0).alias.compareTo("name") );
-        assertEquals( loadSchema.getField(0).uid, schema.getField(1).schema.getField(0).uid );
-        assertEquals( DataType.INTEGER, schema.getField(1).schema.getField(1).type );
-        assertEquals( 0, schema.getField(1).schema.getField(1).alias.compareTo("age") );
-        assertEquals( loadSchema.getField(1).uid, schema.getField(1).schema.getField(1).uid );
-        assertEquals( DataType.FLOAT, schema.getField(1).schema.getField(2).type );
-        assertEquals( 0, schema.getField(1).schema.getField(2).alias.compareTo("gpa") );
-        assertEquals( loadSchema.getField(2).uid, schema.getField(1).schema.getField(2).uid );
-        
+        LogicalSchema bagSchema = schema.getField(1).schema;
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( loadSchema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.INTEGER, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("age") );
+        assertEquals( loadSchema.getField(1).uid, tupleSchema.getField(1).uid );
+        assertEquals( DataType.FLOAT, tupleSchema.getField(2).type );
+        assertEquals( 0, tupleSchema.getField(2).alias.compareTo("gpa") );
+        assertEquals( loadSchema.getField(2).uid, tupleSchema.getField(2).uid );
         
         // We are doing Uid tests at the end as the uids should not repeat
         uids.add(Long.valueOf( schema.getField(0).uid ) );
@@ -560,25 +562,29 @@ public class TestLogicalPlanMigrationVisitor extends TestCase {
         assertEquals( 0, schema.getField(0).alias.compareTo("group") );
 
         assertEquals( DataType.BAG, schema.getField(1).type );
-        
-        assertEquals( DataType.CHARARRAY, schema.getField(1).schema.getField(0).type );
-        assertEquals( 0, schema.getField(1).schema.getField(0).alias.compareTo("name") );
-        assertEquals( loadSchema.getField(0).uid, schema.getField(1).schema.getField(0).uid );
-        assertEquals( DataType.INTEGER, schema.getField(1).schema.getField(1).type );
-        assertEquals( 0, schema.getField(1).schema.getField(1).alias.compareTo("age") );
-        assertEquals( loadSchema.getField(1).uid, schema.getField(1).schema.getField(1).uid );
-        assertEquals( DataType.FLOAT, schema.getField(1).schema.getField(2).type );
-        assertEquals( 0, schema.getField(1).schema.getField(2).alias.compareTo("gpa") );
-        assertEquals( loadSchema.getField(2).uid, schema.getField(1).schema.getField(2).uid );
+        LogicalSchema bagSchema = schema.getField(1).schema;
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( loadSchema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.INTEGER, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("age") );
+        assertEquals( loadSchema.getField(1).uid, tupleSchema.getField(1).uid );
+        assertEquals( DataType.FLOAT, tupleSchema.getField(2).type );
+        assertEquals( 0, tupleSchema.getField(2).alias.compareTo("gpa") );
+        assertEquals( loadSchema.getField(2).uid, tupleSchema.getField(2).uid );
         
         assertEquals( DataType.BAG, schema.getField(2).type );
+        bagSchema = schema.getField(2).schema;
+        tupleSchema = bagSchema.getField(0).schema;
         
-        assertEquals( DataType.CHARARRAY, schema.getField(2).schema.getField(0).type );
-        assertEquals( 0, schema.getField(2).schema.getField(0).alias.compareTo("name") );
-        assertEquals( load2Schema.getField(0).uid, schema.getField(2).schema.getField(0).uid );
-        assertEquals( DataType.CHARARRAY, schema.getField(2).schema.getField(1).type );
-        assertEquals( 0, schema.getField(2).schema.getField(1).alias.compareTo("blah") );
-        assertEquals( load2Schema.getField(1).uid, schema.getField(2).schema.getField(1).uid );        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( load2Schema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("blah") );
+        assertEquals( load2Schema.getField(1).uid, tupleSchema.getField(1).uid );        
         
         
         // We are doing Uid tests at the end as the uids should not repeat                
@@ -650,28 +656,32 @@ public class TestLogicalPlanMigrationVisitor extends TestCase {
                
 
         assertEquals( DataType.BAG, schema.getField(1).type );
-        
-        assertEquals( DataType.CHARARRAY, schema.getField(1).schema.getField(0).type );
-        assertEquals( 0, schema.getField(1).schema.getField(0).alias.compareTo("name") );
-        assertEquals( loadSchema.getField(0).uid, schema.getField(1).schema.getField(0).uid );
-        assertEquals( DataType.INTEGER, schema.getField(1).schema.getField(1).type );
-        assertEquals( 0, schema.getField(1).schema.getField(1).alias.compareTo("age") );
-        assertEquals( loadSchema.getField(1).uid, schema.getField(1).schema.getField(1).uid );
-        assertEquals( DataType.FLOAT, schema.getField(1).schema.getField(2).type );
-        assertEquals( 0, schema.getField(1).schema.getField(2).alias.compareTo("gpa") );
-        assertEquals( loadSchema.getField(2).uid, schema.getField(1).schema.getField(2).uid );
+        LogicalSchema bagSchema = schema.getField(1).schema;
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( loadSchema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.INTEGER, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("age") );
+        assertEquals( loadSchema.getField(1).uid, tupleSchema.getField(1).uid );
+        assertEquals( DataType.FLOAT, tupleSchema.getField(2).type );
+        assertEquals( 0, tupleSchema.getField(2).alias.compareTo("gpa") );
+        assertEquals( loadSchema.getField(2).uid, tupleSchema.getField(2).uid );
         
         assertEquals( DataType.BAG, schema.getField(2).type );
-        
-        assertEquals( DataType.CHARARRAY, schema.getField(2).schema.getField(0).type );
-        assertEquals( 0, schema.getField(2).schema.getField(0).alias.compareTo("name") );
-        assertEquals( load2Schema.getField(0).uid, schema.getField(2).schema.getField(0).uid );
-        assertEquals( DataType.INTEGER, schema.getField(2).schema.getField(1).type );
-        assertEquals( 0, schema.getField(2).schema.getField(1).alias.compareTo("age") );
-        assertEquals( load2Schema.getField(1).uid, schema.getField(2).schema.getField(1).uid );
-        assertEquals( DataType.CHARARRAY, schema.getField(2).schema.getField(2).type );
-        assertEquals( 0, schema.getField(2).schema.getField(2).alias.compareTo("blah") );
-        assertEquals( load2Schema.getField(2).uid, schema.getField(2).schema.getField(2).uid );        
+        bagSchema = schema.getField(2).schema;
+        tupleSchema = bagSchema.getField(0).schema;
+        
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(0).type );
+        assertEquals( 0, tupleSchema.getField(0).alias.compareTo("name") );
+        assertEquals( load2Schema.getField(0).uid, tupleSchema.getField(0).uid );
+        assertEquals( DataType.INTEGER, tupleSchema.getField(1).type );
+        assertEquals( 0, tupleSchema.getField(1).alias.compareTo("age") );
+        assertEquals( load2Schema.getField(1).uid, tupleSchema.getField(1).uid );
+        assertEquals( DataType.CHARARRAY, tupleSchema.getField(2).type );
+        assertEquals( 0, tupleSchema.getField(2).alias.compareTo("blah") );
+        assertEquals( load2Schema.getField(2).uid, tupleSchema.getField(2).uid );        
         
         
         // We are doing Uid tests at the end as the uids should not repeat
diff --git a/test/org/apache/pig/test/TestNewPlanLogToPhyTranslationVisitor.java b/test/org/apache/pig/test/TestNewPlanLogToPhyTranslationVisitor.java
index a55685b1b..ab55b4a70 100644
--- a/test/org/apache/pig/test/TestNewPlanLogToPhyTranslationVisitor.java
+++ b/test/org/apache/pig/test/TestNewPlanLogToPhyTranslationVisitor.java
@@ -69,6 +69,7 @@ import org.apache.pig.newplan.logical.expression.NotExpression;
 import org.apache.pig.newplan.logical.expression.ProjectExpression;
 import org.apache.pig.newplan.logical.expression.SubtractExpression;
 import org.apache.pig.newplan.logical.expression.UserFuncExpression;
+import org.apache.pig.newplan.logical.relational.LOCogroup;
 import org.apache.pig.newplan.logical.relational.LOFilter;
 import org.apache.pig.newplan.logical.relational.LOForEach;
 import org.apache.pig.newplan.logical.relational.LOGenerate;
@@ -1371,4 +1372,47 @@ public class TestNewPlanLogToPhyTranslationVisitor extends TestCase {
         assertTrue(foreach.getSchema().getField(0).alias.equals("a0"));
         assertTrue(foreach.getSchema().getField(1).alias.equals("a1"));
     }
+    
+    // See PIG-767
+    public void testCogroupSchema1() throws Exception {
+        LogicalPlanTester lpt = new LogicalPlanTester(pc);
+        lpt.buildPlan("a = load '1.txt' as (a0, a1);");
+        lpt.buildPlan("b = group a by a0;");
+        LogicalPlan plan = lpt.buildPlan("store b into 'empty';");  
+        
+        org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan = migratePlan(plan);
+        Operator store = newLogicalPlan.getSinks().get(0);
+        LOCogroup cogroup = (LOCogroup)newLogicalPlan.getPredecessors(store).get(0);
+        
+        LogicalSchema cogroupSchema = cogroup.getSchema();
+        assertEquals(cogroupSchema.getField(1).type, DataType.BAG);
+        assertTrue(cogroupSchema.getField(1).alias.equals("a"));
+        LogicalSchema bagSchema = cogroupSchema.getField(1).schema;
+        assertEquals(bagSchema.getField(0).type, DataType.TUPLE);
+        assertEquals(bagSchema.getField(0).alias, null);
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        assertEquals(tupleSchema.size(), 2);
+    }
+    
+    // See PIG-767
+    public void testCogroupSchema2() throws Exception {
+        LogicalPlanTester lpt = new LogicalPlanTester(pc);
+        lpt.buildPlan("a = load '1.txt' as (a0, a1);");
+        lpt.buildPlan("b = group a by a0;");
+        lpt.buildPlan("c = foreach b generate a.a1;");
+        LogicalPlan plan = lpt.buildPlan("store c into 'empty';");  
+        
+        org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan = migratePlan(plan);
+        Operator store = newLogicalPlan.getSinks().get(0);
+        LOForEach foreach = (LOForEach)newLogicalPlan.getPredecessors(store).get(0);
+        
+        LogicalSchema foreachSchema = foreach.getSchema();
+        assertEquals(foreachSchema.getField(0).type, DataType.BAG);
+        LogicalSchema bagSchema = foreachSchema.getField(0).schema;
+        assertEquals(bagSchema.getField(0).type, DataType.TUPLE);
+        assertEquals(bagSchema.getField(0).alias, null);
+        LogicalSchema tupleSchema = bagSchema.getField(0).schema;
+        assertEquals(tupleSchema.size(), 1);
+        assertTrue(tupleSchema.getField(0).alias.equals("a1"));
+    }
 }
diff --git a/test/org/apache/pig/test/TestPigServer.java b/test/org/apache/pig/test/TestPigServer.java
index 5770524d8..aba19fd66 100644
--- a/test/org/apache/pig/test/TestPigServer.java
+++ b/test/org/apache/pig/test/TestPigServer.java
@@ -481,7 +481,7 @@ public class TestPigServer extends TestCase {
         InputStream fileWithStdOutContents = new DataInputStream( new BufferedInputStream( new FileInputStream(stdOutRedirectedFile)));
         BufferedReader reader = new BufferedReader(new InputStreamReader(fileWithStdOutContents));
         while ((s = reader.readLine()) != null) {
-            assertTrue(s.equals("c: {group: int,a: {field1: int,field2: float,field3: chararray},b: {field4: bytearray,field5: double,field6: chararray}}") == true);
+            assertTrue(s.equals("c: {group: int,a: {(field1: int,field2: float,field3: chararray)},b: {(field4: bytearray,field5: double,field6: chararray)}}") == true);
         }
         fileWithStdOutContents.close();
     }
diff --git a/test/org/apache/pig/test/TestSchema.java b/test/org/apache/pig/test/TestSchema.java
index 5363694bf..2ce435660 100644
--- a/test/org/apache/pig/test/TestSchema.java
+++ b/test/org/apache/pig/test/TestSchema.java
@@ -653,7 +653,7 @@ public class TestSchema extends TestCase {
         Iterator<Tuple> it = pigServer.openIterator("c");
         while(it.hasNext()) {
             Tuple t = it.next();
-            assertEquals("{a: {f1: chararray,f2: int}}", t.get(0));
+            assertEquals("{a: {(f1: chararray,f2: int)}}", t.get(0));
         }
         cluster.shutDown();
     }
