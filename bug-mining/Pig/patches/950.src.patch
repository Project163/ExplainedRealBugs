diff --git a/CHANGES.txt b/CHANGES.txt
index 212f7462d..1adc571fd 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -106,6 +106,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-2627: Custom partitioner not set when POSplit is involved in Plan (aniket486 via daijy)
+
 PIG-2596: Jython UDF does not handle boolean output (aniket486 via daijy)
 
 PIG-2652: Skew join and order by don't trigger reducer estimation (billgraham via dvryaboy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
index ace462a8c..3c1c9b55a 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MultiQueryOptimizer.java
@@ -1051,6 +1051,7 @@ class MultiQueryOptimizer extends MROpPlanVisitor {
         splitter.reducePlan = mapReduce.reducePlan;
         splitter.setReduceDone(true);
         splitter.combinePlan = mapReduce.combinePlan;
+        splitter.customPartitioner = mapReduce.customPartitioner;
                 
         // replace store operator in the splitter with split operator
         if (leaf instanceof POStore) {                            
diff --git a/test/org/apache/pig/test/TestMultiQueryCompiler.java b/test/org/apache/pig/test/TestMultiQueryCompiler.java
index 690a163de..cc00a57f6 100644
--- a/test/org/apache/pig/test/TestMultiQueryCompiler.java
+++ b/test/org/apache/pig/test/TestMultiQueryCompiler.java
@@ -46,6 +46,7 @@ import org.apache.pig.impl.plan.Operator;
 import org.apache.pig.impl.plan.OperatorPlan;
 import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.newplan.logical.relational.LogicalPlan;
+import org.apache.pig.test.utils.SimpleCustomPartitioner;
 import org.apache.pig.tools.grunt.GruntParser;
 import org.apache.pig.tools.pigscript.parser.ParseException;
 import org.junit.After;
@@ -1367,6 +1368,37 @@ public class TestMultiQueryCompiler {
         }
     }
     
+    @Test
+    public void testMultiQueryWithCustomPartitioner() {
+
+        System.out.println("===== multi-query with intermediate stores =====");
+
+        try {            
+            myPig.setBatchOn();
+            
+            myPig.registerQuery("a = load 'passwd' " +
+                                "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
+            myPig.registerQuery("l = FILTER a BY uname == 'foo';");
+            myPig.registerQuery("b = GROUP a BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
+            myPig.registerQuery("c = FOREACH b GENERATE FLATTEN(a) PARALLEL 3;");
+            myPig.registerQuery("STORE c INTO 'output1';");
+            myPig.registerQuery("STORE l INTO 'output2';");
+
+            LogicalPlan lp = checkLogicalPlan(1, 2, 6);
+
+            PhysicalPlan pp = checkPhysicalPlan(lp, 1, 2, 12);
+
+            MROperPlan mrp = checkMRPlan(pp, 1, 1, 1); 
+            
+            MapReduceOper mrop = mrp.getRoots().get(0);
+            Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
+
+        } catch (Exception e) {
+            e.printStackTrace();
+            Assert.fail();
+        } 
+    }    
+    
     // --------------------------------------------------------------------------
     // Helper methods
 
