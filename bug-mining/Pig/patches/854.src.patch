diff --git a/CHANGES.txt b/CHANGES.txt
index 26f03d7ee..f2d9822ef 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -324,6 +324,8 @@ Release 0.9.2 - Unreleased
 
 BUG FIXES
 
+PIG-2385: Store statements not getting processed (daijy)
+
 PIG-2320: Error: "projection with nothing to reference" (daijy)
 
 PIG-2346: TypeCastInsert should not insert Foreach if there is no as statement (daijy)
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 9fa1b88c7..ef2f2f85e 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -1233,17 +1233,17 @@ public class PigServer {
         if( jobPriority != null ) {
             pigContext.getProperties().setProperty( PigContext.JOB_PRIORITY, jobPriority );
         }
-        
-       currDAG.compile();
+       
+        // In this plan, all stores in the plan will be executed. They should be ignored if the plan is reused.
+        currDAG.countExecutedStores();
+       
+        currDAG.compile();
 
         if( currDAG.lp.size() == 0 ) {
             return PigStatsUtil.getEmptyPigStats();
         }
-
-        PigStats stats = executeCompiledLogicalPlan();
         
-        // At this point, all stores in the plan are executed. They should be ignored if the plan is reused.
-        currDAG.executed();
+        PigStats stats = executeCompiledLogicalPlan();
         
         return stats;
     }
@@ -1360,9 +1360,9 @@ public class PigServer {
         };
 
         /**
-         * Call back method for post execution processing.
+         * Call back method for counting executed stores.
          */
-        private void executed() {
+        private void countExecutedStores() {
             for( Operator sink : lp.getSinks() ) {
                 if( sink instanceof LOStore ) {
                     processedStores++;
diff --git a/test/e2e/pig/tests/nightly.conf b/test/e2e/pig/tests/nightly.conf
index 5eaaa7d8b..1cb19db86 100644
--- a/test/e2e/pig/tests/nightly.conf
+++ b/test/e2e/pig/tests/nightly.conf
@@ -3880,6 +3880,17 @@ store E into ':OUTPATH:';\,
                                 C = group B all;
                                 D = foreach C generate group, COR(B.age, B.gpa, B.gpa2);
                                 store D into ':OUTPATH:';?,
+                    }, {
+                        # PIG-2385
+                        'num' => 3,
+                        'pig_params' => ['-M'],
+                        'pig' => q?A = LOAD ':INPATH:/singlefile/studenttab10k' AS (name:chararray, age:int,gpa:double);
+                                Z = group A all;
+                                Z1 = foreach Z generate AVG(A.gpa) as avg;
+                                B = foreach A generate name, age, gpa-Z1.avg as diff;
+                                STORE B INTO ':OUTPATH:.1';
+                                C = DISTINCT B ;
+                                store C into ':OUTPATH:.2';?,
                     }
                 ],
             },{
