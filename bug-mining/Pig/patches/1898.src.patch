diff --git a/CHANGES.txt b/CHANGES.txt
index a6e5c6412..196539f5a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -155,6 +155,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-5064: NPE in TestScriptUDF#testPythonBuiltinModuleImport1 when JAVA_HOME is not set (water via daijy)
+
 PIG-5048: HiveUDTF fail if it is the first expression in projection (nkollar via daijy)
 
 PIG-4951: Rename PIG_ATS_ENABLED constant (szita via daijy)
diff --git a/test/org/apache/pig/test/TestScriptUDF.java b/test/org/apache/pig/test/TestScriptUDF.java
index 726609caf..8dc5818d3 100644
--- a/test/org/apache/pig/test/TestScriptUDF.java
+++ b/test/org/apache/pig/test/TestScriptUDF.java
@@ -247,7 +247,11 @@ public class TestScriptUDF{
         Assert.assertTrue(t.get(0).toString().equals(System.getenv(input[0])));
         Assert.assertTrue(iter.hasNext());
         t = iter.next();
-        Assert.assertTrue(t.get(0).toString().equals(System.getenv(input[1])));
+        if (System.getenv(input[1]) != null) {  // JAVA_HOME is set, t.get(0) is not null
+            Assert.assertTrue(t.get(0).toString().equals(System.getenv(input[1])));
+        } else {  // JAVA_HOME is not set, t.get(0) is null
+            Assert.assertNull(t.get(0));
+        }
         Assert.assertFalse(iter.hasNext());
     }
 
