diff --git a/CHANGES.txt b/CHANGES.txt
index 8fc80ff06..a3b8dd5aa 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -367,6 +367,8 @@ PIG-2228: support partial aggregation in map task (thejas)
 
 BUG FIXES
 
+PIG-2717: Tuple field mangled during flattening (daijy)
+
 PIG-2721: Wrong output generated while loading bags as input (knoguchi via daijy)
 
 PIG-2578: Multiple Store-commands mess up mapred.output.dir. (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
index b62156c8b..47137d510 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
@@ -229,6 +229,7 @@ public class POPackageAnnotator extends MROpPlanVisitor {
                         lrearrange.isProjectStar(), lrearrange.getProjectedColsMap()));
             pkg.setKeyInfo(keyInfo);
             pkg.setKeyTuple(lrearrange.isKeyTuple());
+            pkg.setKeyCompound(lrearrange.isKeyCompound());
         }
 
         /**
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POJoinPackage.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POJoinPackage.java
index cfa077fec..d1283b82f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POJoinPackage.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POJoinPackage.java
@@ -70,6 +70,7 @@ public class POJoinPackage extends POPackage {
             setInner(p.getInner());
             setKeyInfo(p.getKeyInfo());
             this.isKeyTuple = p.isKeyTuple;
+            this.isKeyCompound = p.isKeyCompound;
         }
         if (f!=null)
         {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLocalRearrange.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLocalRearrange.java
index cd38fdc62..00fad495c 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLocalRearrange.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLocalRearrange.java
@@ -113,6 +113,13 @@ public class POLocalRearrange extends PhysicalOperator {
     // off the "key" correctly to stitch together the
     // "value"
     private boolean isKeyTuple = false;
+    // marker to note that the tuple "key" is compound
+    // in nature. For example:
+    // group a by (a0, a1);
+    // The group key is a tuple of two fields, isKeyCompound is on
+    // group a by a0; -- a0 is a tuple
+    // The group key is a tuple of one field, isKeyCompound is off
+    private boolean isKeyCompound = false;
     private boolean isSecondaryKeyTuple = false;
 
     private int mProjectedColsMapSize = 0;
@@ -574,6 +581,7 @@ public class POLocalRearrange extends PhysicalOperator {
             // off the "key" correctly to stitch together the
             // "value"
             isKeyTuple  = true;
+            isKeyCompound = true;
         }
         mProjectedColsMapSize = mProjectedColsMap.size();
     }
@@ -733,6 +741,13 @@ public class POLocalRearrange extends PhysicalOperator {
     public boolean isKeyTuple() {
         return isKeyTuple;
     }
+    
+    /**
+     * @return the isKeyCompound
+     */
+    public boolean isKeyCompound() {
+        return isKeyCompound;
+    }
 
     /**
      * @return the keyTuple
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
index f68420f6b..4f499691c 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
@@ -80,6 +80,8 @@ public class POPackage extends PhysicalOperator {
     
     // marker to indicate if key is a tuple
     protected boolean isKeyTuple = false;
+    // marker to indicate if the tuple key is compound in nature
+    protected boolean isKeyCompound = false;
     // key as a Tuple object (if the key is a tuple)
     protected Tuple keyAsTuple;
     
@@ -344,7 +346,7 @@ public class POPackage extends PhysicalOperator {
                     valIndex++;
                 } else {
                     // the field for this index is in the key
-                    if(isKeyTuple) {
+                    if(isKeyTuple && isKeyCompound) {
                         // the key is a tuple, extract the
                         // field out of the tuple
                         copy.set(i, keyAsTuple.get(keyIndex));
@@ -415,6 +417,13 @@ public class POPackage extends PhysicalOperator {
     public void setKeyTuple(boolean keyTuple) {
         this.isKeyTuple = keyTuple;
     }
+    
+    /**
+     * @param keyCompound the keyCompound to set
+     */
+    public void setKeyCompound(boolean keyCompound) {
+        this.isKeyCompound = keyCompound;
+    }
 
     /**
      * @return the keyInfo
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index fc74fab62..0ba5c1e2a 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1094,4 +1094,17 @@ public class TestEvalPipelineLocal {
         Assert.assertTrue(iter.next().toString().equals("(b)"));
         Assert.assertFalse(iter.hasNext());
     }
+    
+    @Test
+    public void testGroupByTuple() throws Exception {
+        File f1 = createFile(new String[]{"1\t2\t3","4\t5\t6"});
+        pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(), pigServer.getPigContext())
+                + "' as (x:int, y:int, z:int);");
+        pigServer.registerQuery("b = foreach a generate TOTUPLE(x, y) as t, z;");
+        pigServer.registerQuery("c = group b by t;");
+        Iterator<Tuple> iter = pigServer.openIterator("c");
+        Assert.assertTrue(iter.next().toString().equals("((1,2),{((1,2),3)})"));
+        Assert.assertTrue(iter.next().toString().equals("((4,5),{((4,5),6)})"));
+        Assert.assertFalse(iter.hasNext());
+    }
 }
