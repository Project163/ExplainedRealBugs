diff --git a/CHANGES.txt b/CHANGES.txt
index e73edec1b..900ef516d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -404,6 +404,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-3051: java.lang.IndexOutOfBoundsException failure with LimitOptimizer + ColumnPruning (knoguchi via rohini)
+
 PIG-3076: make TestScalarAliases more reliable (julien)
 
 PIG-3020: "Duplicate uid in schema" error when joining two relations derived from the same load statement (jcoveney)
diff --git a/src/org/apache/pig/newplan/logical/relational/LOSort.java b/src/org/apache/pig/newplan/logical/relational/LOSort.java
index d5909a632..c01e342b1 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOSort.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOSort.java
@@ -29,7 +29,9 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.newplan.OperatorPlan;
 import org.apache.pig.newplan.PlanVisitor;
+import org.apache.pig.newplan.ReverseDependencyOrderWalker;
 import org.apache.pig.newplan.logical.expression.LogicalExpressionPlan;
+import org.apache.pig.newplan.logical.expression.LogicalExpressionVisitor;
 import org.apache.pig.newplan.logical.expression.ProjectExpression;
 
 public class LOSort extends LogicalRelationalOperator{
@@ -197,4 +199,42 @@ public class LOSort extends LogicalRelationalOperator{
     public Operator getInput(LogicalPlan plan) {
         return plan.getPredecessors(this).get(0);
     }
+
+    private static class ResetProjectionAttachedRelationalOpVisitor
+        extends LogicalExpressionVisitor {
+        private LogicalRelationalOperator attachedRelationalOp;
+
+        ResetProjectionAttachedRelationalOpVisitor (
+            LogicalExpressionPlan plan, LogicalRelationalOperator op )
+            throws FrontendException {
+            super(plan, new ReverseDependencyOrderWalker(plan));
+            this.attachedRelationalOp = op;
+
+        }
+        @Override
+        public void visit(ProjectExpression pe) throws FrontendException {
+            pe.setAttachedRelationalOp(attachedRelationalOp);
+        }
+    }
+
+    public static LOSort createCopy(LOSort sort) throws FrontendException {
+        LOSort newSort = new LOSort(sort.getPlan(), null,
+                                    sort.getAscendingCols(),
+                                    sort.getUserFunc());
+
+        List<LogicalExpressionPlan> newSortColPlans =
+            new ArrayList<LogicalExpressionPlan>(sort.getSortColPlans().size());
+
+        for(LogicalExpressionPlan lep:sort.getSortColPlans() ) {
+            LogicalExpressionPlan new_lep = lep.deepCopy();
+
+            // Resetting the attached LOSort operator of the ProjectExpression
+            // to the newSort 
+            new ResetProjectionAttachedRelationalOpVisitor(
+                new_lep, newSort ).visit();
+            newSortColPlans.add(new_lep);
+        }
+        newSort.setSortColPlans(newSortColPlans);
+        return newSort;
+    }
 }
diff --git a/src/org/apache/pig/newplan/logical/rules/LimitOptimizer.java b/src/org/apache/pig/newplan/logical/rules/LimitOptimizer.java
index 500111a15..c32f9b3ad 100644
--- a/src/org/apache/pig/newplan/logical/rules/LimitOptimizer.java
+++ b/src/org/apache/pig/newplan/logical/rules/LimitOptimizer.java
@@ -202,9 +202,7 @@ public class LimitOptimizer extends Rule {
                             && greatGrandparants.size() != 0
                             && greatGrandparants.get(0) instanceof LOSort) {
                         LOSort sort = (LOSort) greatGrandparants.get(0);
-                        LOSort newSort = new LOSort(sort.getPlan(), sort
-                                .getSortColPlans(), sort.getAscendingCols(),
-                                sort.getUserFunc());
+                        LOSort newSort = LOSort.createCopy(sort);
                         newSort.setLimit(limit.getLimit());
 
                         currentPlan.replace(limit, newSort);
diff --git a/test/e2e/pig/tests/nightly.conf b/test/e2e/pig/tests/nightly.conf
index b8ceead8e..87e7932a6 100644
--- a/test/e2e/pig/tests/nightly.conf
+++ b/test/e2e/pig/tests/nightly.conf
@@ -4575,6 +4575,27 @@ store C into ':OUTPATH:';\,
                         'rc' => 0,
                         'not_expected_out_regex' => "checkJobConf: conf is null: false",
                         'expected_out_regex' => "checkJobConf: conf is null: true",
+                    }, {
+                        # PIG-3051
+                        'num' => 5,
+                        'pig' => q?A = LOAD ':INPATH:/singlefile/votertab10k' AS (name, age, registration, contributions);
+                                -- dropping one column to force columnprune
+                                B = foreach A generate age, registration,contributions;
+                                C = order B by contributions;
+                                D = limit C 3;
+                                E = foreach D generate contributions;
+                                STORE C INTO ':OUTPATH:.1';
+                                STORE E INTO ':OUTPATH:.2';?,
+                        'verify_pig_script' => q?A = LOAD ':INPATH:/singlefile/votertab10k' AS (name, age, registration, contributions);
+                                B = foreach A generate age, registration,contributions;
+                                C = order B by contributions;
+                                STORE C INTO ':OUTPATH:.1';
+                                F = LOAD ':INPATH:/singlefile/votertab10k' AS (name, age, registration, contributions);
+                                G = foreach F generate age, registration,contributions;
+                                H = order G by contributions;
+                                I = limit H 3;
+                                J = foreach I generate contributions;
+                                STORE J INTO ':OUTPATH:.2';?,
                     }
                 ],
             },{
