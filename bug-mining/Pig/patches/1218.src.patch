diff --git a/CHANGES.txt b/CHANGES.txt
index a4f4a5456..0d3cd09a7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -198,6 +198,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3364: Case expression fails with an even number of when branches (cheolsoo)
+
 PIG-3354: UDF example does not handle nulls (patc888 via daijy)
 
 PIG-3355: ColumnMapKeyPrune bug with distinct operator (jeremykarn via aniket486)
diff --git a/src/org/apache/pig/parser/LogicalPlanGenerator.g b/src/org/apache/pig/parser/LogicalPlanGenerator.g
index 38eba98e7..b13f346ed 100644
--- a/src/org/apache/pig/parser/LogicalPlanGenerator.g
+++ b/src/org/apache/pig/parser/LogicalPlanGenerator.g
@@ -1102,7 +1102,7 @@ case_cond[LogicalExpressionPlan plan] returns[LogicalExpression expr]
     {
         // Convert CASE tree to nested bincond expressions. Please also see
         // QueryParser.g for how CASE tree is constructed from case statement.
-        boolean hasElse = exprs.size() \% 2 == 1;
+        boolean hasElse = exprs.size() != conds.size();
         LogicalExpression elseExpr = hasElse ? exprs.get(exprs.size() - 1)
                                              : new ConstantExpression($plan, null);
         int numWhenBranches = conds.size();
diff --git a/test/org/apache/pig/test/TestCase.java b/test/org/apache/pig/test/TestCase.java
index 047293f94..e66da7141 100644
--- a/test/org/apache/pig/test/TestCase.java
+++ b/test/org/apache/pig/test/TestCase.java
@@ -95,25 +95,24 @@ public class TestCase {
 
         pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
         pigServer.registerQuery("B = FOREACH A GENERATE i, (" +
-                "  CASE i % 5" +
-                "    WHEN 0 THEN '5n'" +
-                "    WHEN 1 THEN '5n+1'" +
-                "    WHEN 2 THEN '5n+2'" +
-                "    WHEN 3 THEN '5n+3'" +
-                "    ELSE        '5n+4'" +
+                "  CASE i % 4" +
+                "    WHEN 0 THEN '4n'" +
+                "    WHEN 1 THEN '4n+1'" +
+                "    WHEN 2 THEN '4n+2'" +
+                "    ELSE        '4n+3'" +
                 "  END" +
                 ");");
         pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
         List<Tuple> out = data.get("bar");
         assertEquals(7, out.size());
-        assertEquals(tuple(1,"5n+1"), out.get(0));
-        assertEquals(tuple(2,"5n+2"), out.get(1));
-        assertEquals(tuple(3,"5n+3"), out.get(2));
-        assertEquals(tuple(4,"5n+4"), out.get(3));
-        assertEquals(tuple(5,"5n"),   out.get(4));
-        assertEquals(tuple(6,"5n+1"), out.get(5));
-        assertEquals(tuple(7,"5n+2"), out.get(6));
+        assertEquals(tuple(1,"4n+1"), out.get(0));
+        assertEquals(tuple(2,"4n+2"), out.get(1));
+        assertEquals(tuple(3,"4n+3"), out.get(2));
+        assertEquals(tuple(4,"4n"),   out.get(3));
+        assertEquals(tuple(5,"4n+1"), out.get(4));
+        assertEquals(tuple(6,"4n+2"), out.get(5));
+        assertEquals(tuple(7,"4n+3"), out.get(6));
     }
 
     /**
@@ -179,24 +178,23 @@ public class TestCase {
         pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
         pigServer.registerQuery("B = FOREACH A GENERATE i, (" +
                 "  CASE " +
-                "    WHEN i % 5 == 0 THEN '5n'" + // Conditional expression in when branch
-                "    WHEN i % 5 == 1 THEN '5n+1'" +
-                "    WHEN i % 5 == 2 THEN '5n+2'" +
-                "    WHEN i % 5 == 3 THEN '5n+3'" +
-                "    ELSE                 '5n+4'" +
+                "    WHEN i % 4 == 0 THEN '4n'" + // Conditional expression in when branch
+                "    WHEN i % 4 == 1 THEN '4n+1'" +
+                "    WHEN i % 4 == 2 THEN '4n+2'" +
+                "    ELSE                 '4n+3'" +
                 "  END" +
                 ");");
         pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
         List<Tuple> out = data.get("bar");
         assertEquals(7, out.size());
-        assertEquals(tuple(1,"5n+1"), out.get(0));
-        assertEquals(tuple(2,"5n+2"), out.get(1));
-        assertEquals(tuple(3,"5n+3"), out.get(2));
-        assertEquals(tuple(4,"5n+4"), out.get(3));
-        assertEquals(tuple(5,"5n"),   out.get(4));
-        assertEquals(tuple(6,"5n+1"), out.get(5));
-        assertEquals(tuple(7,"5n+2"), out.get(6));
+        assertEquals(tuple(1,"4n+1"), out.get(0));
+        assertEquals(tuple(2,"4n+2"), out.get(1));
+        assertEquals(tuple(3,"4n+3"), out.get(2));
+        assertEquals(tuple(4,"4n"),   out.get(3));
+        assertEquals(tuple(5,"4n+1"), out.get(4));
+        assertEquals(tuple(6,"4n+2"), out.get(5));
+        assertEquals(tuple(7,"4n+3"), out.get(6));
     }
 
     /**
