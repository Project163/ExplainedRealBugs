diff --git a/CHANGES.txt b/CHANGES.txt
index c09688edc..7368a781f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -225,6 +225,8 @@ PIG-3480: TFile-based tmpfile compression crashes in some cases (dvryaboy via an
 
 BUG FIXES
 
+PIG-3774: Piggybank Over UDF get wrong result (daijy)
+
 PIG-3657: New partition filter extractor fails with NPE (cheolsoo)
 
 PIG-3347: Store invocation brings side effect (daijy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/Over.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/Over.java
index 956a94f7b..53c054ba7 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/Over.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/evaluation/Over.java
@@ -349,7 +349,8 @@ public class Over extends EvalFunc<DataBag> {
         } else if ("percent_rank".equalsIgnoreCase(agg)) {
             func = new PercentRank(udfArgs);
         } else if ("cume_dist".equalsIgnoreCase(agg)) {
-            func = new CumeDist(udfArgs);
+            //func = new CumeDist(udfArgs);
+            func = new CumeDist();
         } else if ("debug".equalsIgnoreCase(agg)) {
             func = new Debug();
         } else {
@@ -755,6 +756,7 @@ public class Over extends EvalFunc<DataBag> {
         }
     }
 
+    /*
     private static class CumeDist extends BaseRank<Double> {
         CumeDist(Object[] args) throws IOException {
             super(args);
@@ -768,6 +770,20 @@ public class Over extends EvalFunc<DataBag> {
             return ((double)lastRankUsed) / (double)iter.tuples.size();
         }
     }
+    */
+
+    private static class CumeDist extends ResetableEvalFunc<Double> {
+
+        @Override
+        public Double exec(Tuple input) throws IOException {
+            DataBag inbag = (DataBag)input.get(0);
+            OverBag.OverBagIterator iter =
+                (OverBag.OverBagIterator)inbag.iterator();
+
+            return ((double)++currentRow)/(double)iter.tuples.size();
+        }
+    }
+
 
 
 
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/evaluation/TestOver.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/evaluation/TestOver.java
index 2e6a013b6..1557aa0ee 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/evaluation/TestOver.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/evaluation/TestOver.java
@@ -1610,6 +1610,13 @@ public class TestOver {
         t.set(4, 0);
         DataBag outbag = func.exec(t);
         assertEquals(7, outbag.size());
+        int count = 1;
+        for (Tuple to : outbag) {
+            assertEquals(1, to.size());
+            assertEquals(count/7.0, to.get(0));
+            count++;
+        }
+        /*
         Iterator<Tuple> iter = outbag.iterator();
         t = iter.next();
         assertEquals(0.14285714285714285, t.get(0));
@@ -1625,5 +1632,6 @@ public class TestOver {
         assertEquals(0.5714285714285714, t.get(0));
         t = iter.next();
         assertEquals(1.0, t.get(0));
+        */
     }
 }
