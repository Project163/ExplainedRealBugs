diff --git a/CHANGES.txt b/CHANGES.txt
index bac890a51..1cceda180 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -100,6 +100,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1872: Fix bug in AvroStorage (guolin2001, jghoman via daijy)
+
 PIG-1536: use same logic for merging inner schemas in "default union" and
 "union onschema" (daijy)
 
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
index 03586e436..f75dacad4 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
@@ -211,6 +211,10 @@ public class AvroStorageUtils {
                 if (containsRecursiveRecord(fs, definedRecordNames))
                     return true;
             }
+            
+            /* remove its own name from the name set */
+            definedRecordNames.remove(s.getName());
+
             return false;
         }
         
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorageUtils.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorageUtils.java
index 9cb2fa697..e5d0c38c8 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorageUtils.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorageUtils.java
@@ -48,12 +48,28 @@ public class TestAvroStorageUtils {
         final String str3 ="[\"null\", " + str2 + "]";
         s = Schema.parse(str3);
         assertTrue(AvroStorageUtils.containsRecursiveRecord(s));
+        
     }
 
     @Test
     public void canIdentifyNonRecursiveRecords() throws IOException {
         final String non = RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"null\", \"string\"] } ] }";
         assertFalse(AvroStorageUtils.containsRecursiveRecord(Schema.parse(non)));
+        
+        final String s1 =
+            "{ \"type\":\"record\", \"name\":\"Event\", " +
+               "\"fields\":[ " +
+                       "{\"name\":\"f1\", " +
+                         "\"type\":{ \"type\":\"record\",\"name\":\"Entity\", " +
+                                          "\"fields\":[{\"name\":\"type\", \"type\": \"string\"}," +
+                                                             "{\"name\":\"value\",\"type\": \"int\"}] " +
+                                         "} }, " +
+                       " {\"name\":\"f2\",\"type\": \"Entity\"}, " +
+                       " {\"name\":\"f3\",\"type\": \"Entity\"} " +
+                       "] }";
+            Schema schema1 = Schema.parse(s1);
+            assertFalse(AvroStorageUtils.containsRecursiveRecord(schema1));
+
     }
 
      @Test
