diff --git a/CHANGES.txt b/CHANGES.txt
index b542dfb9a..1227b5d82 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -57,6 +57,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)
 
 BUG FIXES
 
+PIG-4712: [Pig on Tez] NPE in Bloom UDF after Union (rohini)
+
 PIG-4707: [Pig on Tez] Streaming job hangs with pig.exec.mapPartAgg=true (rohini)
 
 PIG-4703: TezOperator.stores shall not ship to backend (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
index f38cb66cc..818bb4c01 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
@@ -566,6 +566,8 @@ public class POUserFunc extends ExpressionOperator {
             requestedParallelism, null, funcSpec.clone());
         clone.setResultType(resultType);
         clone.signature = signature;
+        clone.cacheFiles = cacheFiles;
+        clone.shipFiles = shipFiles;
         return clone;
     }
 
diff --git a/test/e2e/pig/tests/nightly.conf b/test/e2e/pig/tests/nightly.conf
index cde2b7c3f..644de3bd9 100644
--- a/test/e2e/pig/tests/nightly.conf
+++ b/test/e2e/pig/tests/nightly.conf
@@ -5148,6 +5148,30 @@ store C into ':OUTPATH:';\,
                                 C = load ':INPATH:/singlefile/votertab10k'as (name:chararray, age:int, reg:chararray, contrib:float);
                                 D = join C by name, B by name;
                                 store D into ':OUTPATH:';",
+                    },{
+                        'num' => 4,
+                        'pig' => "set pig.optimizer.rules.disabled PushUpFilter;
+                                define bb BuildBloom('Hash.JENKINS_HASH', 'fixed', '128', '3');
+                                A = LOAD ':INPATH:/singlefile/studenttab10k' AS (name:chararray, age:int, gpa:double);
+                                B = filter A by name == 'alice allen';
+                                C = group B all;
+                                D = foreach C generate bb(B.name);
+                                store D into ':HDFSTMP:/mybloom_4';
+                                exec;
+                                define bloom Bloom(':HDFSTMP:/mybloom_4');
+                                E = LOAD ':INPATH:/singlefile/studenttab10k' AS (name:chararray, age:int, gpa:double);
+                                F = LOAD ':INPATH:/singlefile/studenttab10k' AS (name:chararray, age:int, gpa:double);
+                                G = union E, F;
+                                -- PushUpFilter is disabled to avoid filter being pushed before union
+                                H = filter G by bloom(name);
+                                store H into ':OUTPATH:';",
+                        'notmq' => 1,
+                        'verify_pig_script' => "
+                                A = LOAD ':INPATH:/singlefile/studenttab10k' AS (name, age:int ,gpa:double);
+                                B = LOAD ':INPATH:/singlefile/studenttab10k' AS (name, age:int ,gpa:double);
+                                C = UNION A,B;
+                                D = filter C by name == 'alice allen';
+                                store D into ':OUTPATH:';",
                     }
                 ],
             },{
