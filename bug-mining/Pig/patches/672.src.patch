diff --git a/CHANGES.txt b/CHANGES.txt
index 4faa3a114..4a5d705bf 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -26,6 +26,8 @@ PIG-1680: HBaseStorage should work with HBase 0.90 (gstathis, billgraham, dvryab
 
 IMPROVEMENTS
 
+PIG-1961: Pig prints "null" as file name in case of grammar error (xuefu)
+
 PIG-1956: Pig parser shouldn't log error code 0 (xuefu)
 
 PIG-1957: Pig parser gives misleading error message when the next foreach block has syntactic errors (xuefu)
diff --git a/src/org/apache/pig/parser/AstValidator.g b/src/org/apache/pig/parser/AstValidator.g
index 8f953d6f8..7998522d4 100644
--- a/src/org/apache/pig/parser/AstValidator.g
+++ b/src/org/apache/pig/parser/AstValidator.g
@@ -58,24 +58,6 @@ throws RecognitionException {
     throw e;
 }
 
-public String getErrorMessage(RecognitionException e, String[] tokenNames) {
-    String msg = e.getMessage();
-    if ( e instanceof DuplicatedSchemaAliasException ) {
-        DuplicatedSchemaAliasException dae = (DuplicatedSchemaAliasException)e;
-        msg = "Duplicated schema alias name '"+ dae.getAlias() + "' in the schema definition";
-    } else if( e instanceof UndefinedAliasException ) {
-        UndefinedAliasException dae = (UndefinedAliasException)e;
-        msg = "Alias '"+ dae.getAlias() + "' is not defined";
-    }
-    
-    return msg;
-}
-
-@Override
-public String getErrorHeader(RecognitionException ex) {
-	return QueryParserUtils.generateErrorHeader( ex );
-}
-
 private void validateSchemaAliasName(Set<String> fieldNames, CommonTree node, String name)
 throws DuplicatedSchemaAliasException {
     if( fieldNames.contains( name ) ) {
diff --git a/src/org/apache/pig/parser/LogicalPlanGenerator.g b/src/org/apache/pig/parser/LogicalPlanGenerator.g
index 7ae903ee5..f01605a43 100644
--- a/src/org/apache/pig/parser/LogicalPlanGenerator.g
+++ b/src/org/apache/pig/parser/LogicalPlanGenerator.g
@@ -134,25 +134,6 @@ public LogicalPlanGenerator(TreeNodeStream input, PigContext pigContext, String
     builder = new LogicalPlanBuilder( pigContext, scope, fileNameMap, input );
 }
 
-public String getErrorMessage(RecognitionException e, String[] tokenNames) {
-    String msg = e.getMessage();
-    if ( e instanceof NonProjectExpressionException ) {
-        NonProjectExpressionException pee = (NonProjectExpressionException)e;
-        msg = "For input to a nested operator, if it's an expression, it can only be " +
-              "a projection expression. The given expression is: " + 
-              pee.getExpression().getPlan() + ".";
-    } else {
-        msg = e.toString();
-    }
-    
-    return msg;
-}
-
-@Override
-public String getErrorHeader(RecognitionException ex) {
-    return QueryParserUtils.generateErrorHeader( ex );
-}
-
 } // End of @members
 
 @rulecatch {
diff --git a/src/org/apache/pig/parser/QueryParser.g b/src/org/apache/pig/parser/QueryParser.g
index 9e9d5acbd..37b5e429d 100644
--- a/src/org/apache/pig/parser/QueryParser.g
+++ b/src/org/apache/pig/parser/QueryParser.g
@@ -96,6 +96,7 @@ throws RecognitionException {
     throw e;
 }
 
+@Override
 public String getErrorMessage(RecognitionException e, String[] tokenNames ) {
     if( !log.isDebugEnabled() ) {
         if( e instanceof NoViableAltException ) {
@@ -117,6 +118,7 @@ public String getErrorMessage(RecognitionException e, String[] tokenNames ) {
     return stack + " " + msg;
 }
 
+@Override
 public String getTokenErrorDisplay(Token t) {
     return "'" + t.getText() + "'";
 }
diff --git a/src/org/apache/pig/parser/QueryParserUtils.java b/src/org/apache/pig/parser/QueryParserUtils.java
index e17ff23c8..4519d5f50 100644
--- a/src/org/apache/pig/parser/QueryParserUtils.java
+++ b/src/org/apache/pig/parser/QueryParserUtils.java
@@ -170,16 +170,8 @@ public class QueryParserUtils {
          return alias + "_" + filename + "_" + funcSpec.toString();
      }
      
-     static String generateErrorHeader(RecognitionException ex) {
-         return "<line " + ex.line +", column " + ex.charPositionInLine + ">";
-     }
-
-    static String generateErrorHeader(RecognitionException ex, String fname) {
-        StringBuilder sb = new StringBuilder();
-        sb.append("<file ").append(fname).append(", line ")
-                .append(ex.line).append(", column ")
-                .append(ex.charPositionInLine).append(">");
-        return sb.toString();
+    static String generateErrorHeader(RecognitionException ex, String filename) {
+        return new SourceLocation( filename, ex.line, ex.charPositionInLine ).toString();
     }
     
     @SuppressWarnings({ "unchecked", "rawtypes" })
diff --git a/src/org/apache/pig/parser/SourceLocation.java b/src/org/apache/pig/parser/SourceLocation.java
index 364f0feac..8cca142a6 100644
--- a/src/org/apache/pig/parser/SourceLocation.java
+++ b/src/org/apache/pig/parser/SourceLocation.java
@@ -26,6 +26,12 @@ public class SourceLocation {
     public SourceLocation() {
     }
     
+    public SourceLocation(String filename, int line, int offset) {
+    	this.file = filename;
+    	this.line = line;
+    	this.offset = offset;
+    }
+    
     public SourceLocation(PigParserNode tree) {
         this.file = tree.getFileName();
         this.line = tree.getLine();
diff --git a/test/org/apache/pig/parser/TestErrorHandling.java b/test/org/apache/pig/parser/TestErrorHandling.java
index ad889b0ea..297ec12b6 100644
--- a/test/org/apache/pig/parser/TestErrorHandling.java
+++ b/test/org/apache/pig/parser/TestErrorHandling.java
@@ -173,4 +173,34 @@ public class TestErrorHandling {
         Assert.fail( "Testcase should fail" );
     }
 
+    @Test // PIG-1961
+    public void tesNegative11() throws IOException {
+        String query = "A = load ^ 'x' as (name, age, gpa);\n";
+        try {
+            pig.registerQuery( query );
+        } catch(FrontendException ex) {
+        	String msg = ex.getMessage();
+            System.out.println( msg );
+            Assert.assertFalse( msg.contains( "file null" ) );
+            Assert.assertTrue( msg.contains( "Unexpected character" ) );
+            return;
+        }
+        Assert.fail( "Testcase should fail" );
+    }
+    
+    @Test // PIG-1961
+    public void tesNegative12() throws IOException {
+        String query = "A = loadd 'x' as (name, age, gpa);\n";
+        try {
+            pig.registerQuery( query );
+        } catch(FrontendException ex) {
+        	String msg = ex.getMessage();
+            System.out.println( msg );
+            Assert.assertFalse( msg.contains( "file null" ) );
+            Assert.assertTrue( msg.contains( "mismatched input ''x'' expecting LEFT_PAREN" ) );
+            return;
+        }
+        Assert.fail( "Testcase should fail" );
+    }
+
 }
