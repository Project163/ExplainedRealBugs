diff --git a/CHANGES.txt b/CHANGES.txt
index 7c8a91bfb..3ef2ac38d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -26,6 +26,12 @@ PIG-1680: HBaseStorage should work with HBase 0.90 (gstathis, billgraham, dvryab
 
 IMPROVEMENTS
 
+PIG-1956: Pig parser shouldn't log error code 0 (xuefu)
+
+PIG-1957: Pig parser gives misleading error message when the next foreach block has syntactic errors (xuefu)
+
+PIG-1958: Regression: Pig doesn't log type cast warning messages (xuefu)
+
 PIG-1918: Line number should be give for logical plan failures (xuefu)
 
 PIG-1899: Add end to end test harness for Pig (gates)
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 93c67bb94..9de3bc65a 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -70,6 +70,7 @@ import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.plan.CompilationMessageCollector;
+import org.apache.pig.impl.plan.CompilationMessageCollector.MessageType;
 import org.apache.pig.impl.streaming.StreamingCommand;
 import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.impl.util.ObjectSerializer;
@@ -179,6 +180,7 @@ public class PigServer {
 
 
     private boolean isMultiQuery = true;
+    private boolean aggregateWarning = true;
 
     private String constructScope() {
         // scope servers for now as a session id
@@ -227,7 +229,7 @@ public class PigServer {
         this.pigContext = context;
         currDAG = new Graph(false);
 
-        //aggregateWarning = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("aggregate.warning"));
+        aggregateWarning = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("aggregate.warning"));
         isMultiQuery = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("opt.multiquery","true"));
         
         jobName = pigContext.getProperties().getProperty(
@@ -1591,7 +1593,16 @@ public class PigServer {
             // TODO: input/output validation visitor
 
             CompilationMessageCollector collector = new CompilationMessageCollector() ;
+            
             new TypeCheckingRelVisitor( lp, collector).visit();
+            if(aggregateWarning) {
+                CompilationMessageCollector.logMessages(collector, MessageType.Warning, aggregateWarning, log);
+            } else {
+                for(Enum type: MessageType.values()) {
+                    CompilationMessageCollector.logAllMessages(collector, log);
+                }
+            }
+            
             new UnionOnSchemaSetter( lp ).visit();
             new CastLineageSetter(lp, collector).visit();
         }
diff --git a/src/org/apache/pig/parser/ParserException.java b/src/org/apache/pig/parser/ParserException.java
index 78f8f2606..9249dfece 100644
--- a/src/org/apache/pig/parser/ParserException.java
+++ b/src/org/apache/pig/parser/ParserException.java
@@ -24,17 +24,18 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 
 public class ParserException extends FrontendException {
 	private static final long serialVersionUID = 1L;
+	private static final int errorCode = 1200;
 	
 	public ParserException(RecognitionException recoException) {
-		super( recoException );
+		super( "Pig script failed to parse: " + recoException, errorCode, recoException );
 	}
 	
 	public ParserException(String msg) {
-		super( msg );
+		super( msg, errorCode );
 	}
 
 	public ParserException(String msg, Throwable cause) {
-	    super( msg, cause );
+	    super( msg, errorCode, cause );
 	}
 	
 	@Override
diff --git a/src/org/apache/pig/parser/QueryParser.g b/src/org/apache/pig/parser/QueryParser.g
index 8b7f1acc8..9e9d5acbd 100644
--- a/src/org/apache/pig/parser/QueryParser.g
+++ b/src/org/apache/pig/parser/QueryParser.g
@@ -166,10 +166,16 @@ parallel_clause : PARALLEL^ INTEGER
 // is covered by general_statement.
 // We need to handle foreach specifically because of the ending ';', which is not required 
 // if there is a nested block. This is ugly, but it gets the job done.
-foreach_statement : ( alias EQUAL )? foreach_clause_complex SEMI_COLON?
-                 -> ^( STATEMENT alias? foreach_clause_complex )
-                  | ( alias EQUAL )? foreach_clause_simple parallel_clause? SEMI_COLON
-                 -> ^( STATEMENT alias? foreach_clause_simple parallel_clause? )
+foreach_statement : ( ( alias EQUAL )?  FOREACH rel LEFT_CURLY ) => foreach_complex_statement
+                  | foreach_simple_statement
+;
+
+foreach_complex_statement : ( alias EQUAL )? foreach_clause_complex SEMI_COLON?
+                         -> ^( STATEMENT alias? foreach_clause_complex )
+;
+
+foreach_simple_statement : ( alias EQUAL )? foreach_clause_simple parallel_clause? SEMI_COLON
+                        -> ^( STATEMENT alias? foreach_clause_simple parallel_clause? )
 ;
 
 alias : IDENTIFIER
diff --git a/test/org/apache/pig/parser/TestErrorHandling.java b/test/org/apache/pig/parser/TestErrorHandling.java
index 7e0af1da1..ad889b0ea 100644
--- a/test/org/apache/pig/parser/TestErrorHandling.java
+++ b/test/org/apache/pig/parser/TestErrorHandling.java
@@ -155,4 +155,22 @@ public class TestErrorHandling {
         Assert.fail( "Testcase should fail" );
     }
 
+    @Test // PIG-1956, 1957
+    public void tesNegative9() throws IOException {
+        String query = "A = load 'x' as (name, age, gpa);\n" +
+                       "B = group A by name;\n" +
+                       "C = foreach B { ba = filter A by age < '25'; bb = foreach ba generate gpa; generate group, flatten(bb);}";
+        try {
+            pig.registerQuery( query );
+        } catch(FrontendException ex) {
+        	String msg = ex.getMessage();
+            System.out.println( msg );
+            Assert.assertEquals( 1200, ex.getErrorCode() );
+            Assert.assertTrue( msg.contains( "line 3, column 58" ) );
+            Assert.assertTrue( msg.contains( "mismatched input 'ba' expecting LEFT_PAREN" ) );
+            return;
+        }
+        Assert.fail( "Testcase should fail" );
+    }
+
 }
diff --git a/test/org/apache/pig/test/TestGrunt.java b/test/org/apache/pig/test/TestGrunt.java
index 31144944f..2339f4854 100644
--- a/test/org/apache/pig/test/TestGrunt.java
+++ b/test/org/apache/pig/test/TestGrunt.java
@@ -125,9 +125,7 @@ public class TestGrunt extends TestCase {
         try {
             grunt.exec();
         } catch (Exception e) {
-            PigException pe = LogUtils.getPigException(e);
-            String msg = (pe == null? e.getMessage(): pe.getMessage());
-            assertTrue(msg.contains("Error during parsing"));
+            assertTrue(e.getMessage().contains("Error during parsing"));
         }
     }
 
