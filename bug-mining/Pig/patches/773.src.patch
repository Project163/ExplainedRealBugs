diff --git a/CHANGES.txt b/CHANGES.txt
index 305212182..d59f2db77 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -60,6 +60,8 @@ PIG-2011: Speed up TestTypedMap.java (dvryaboy)
 
 BUG FIXES
 
+PIG-2137: SAMPLE should not be pushed above DISTINCT (dvryaboy and thejas)
+
 PIG-2136: Implementation of Sample should use LessThanExpression 
  instead of LessThanEqualExpression (azaroth via thejas)
 
diff --git a/src/org/apache/pig/newplan/logical/rules/PushUpFilter.java b/src/org/apache/pig/newplan/logical/rules/PushUpFilter.java
index 7996eefb7..31f060e51 100644
--- a/src/org/apache/pig/newplan/logical/rules/PushUpFilter.java
+++ b/src/org/apache/pig/newplan/logical/rules/PushUpFilter.java
@@ -80,8 +80,8 @@ public class PushUpFilter extends Rule {
             if( pred == null )
                 return false;
 
-            // sort, distinct, or sort by is always okay.
-            if( pred instanceof LOSort || pred instanceof LODistinct || pred instanceof LOUnion ) {
+            // sort and union are always okay.
+            if( pred instanceof LOSort || pred instanceof LOUnion ) {
                 return true;
             }
 
@@ -102,6 +102,12 @@ public class PushUpFilter extends Rule {
                 return false;
             }
 
+            //if there is no nondeterministic udf, filter can be pushed above 
+            // Distinct
+            if(pred instanceof LODistinct){
+                return true;
+            }
+
             // collect all uids used in the filter plan
             Set<Long> uids = collectUidFromExpPlan(filterPlan);
 
diff --git a/test/org/apache/pig/test/TestNewPlanFilterRule.java b/test/org/apache/pig/test/TestNewPlanFilterRule.java
index 2640a4f65..c7d4ed401 100644
--- a/test/org/apache/pig/test/TestNewPlanFilterRule.java
+++ b/test/org/apache/pig/test/TestNewPlanFilterRule.java
@@ -18,7 +18,11 @@
 
 package org.apache.pig.test;
 
-import java.util.*;
+import java.util.ArrayList;
+import java.util.HashSet;
+import java.util.List;
+import java.util.Properties;
+import java.util.Set;
 
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
@@ -28,11 +32,17 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.util.MultiMap;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.newplan.OperatorPlan;
-import org.apache.pig.newplan.logical.expression.*;
+import org.apache.pig.newplan.logical.expression.AndExpression;
+import org.apache.pig.newplan.logical.expression.ConstantExpression;
+import org.apache.pig.newplan.logical.expression.EqualExpression;
+import org.apache.pig.newplan.logical.expression.LogicalExpression;
+import org.apache.pig.newplan.logical.expression.LogicalExpressionPlan;
+import org.apache.pig.newplan.logical.expression.ProjectExpression;
 import org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer;
 import org.apache.pig.newplan.logical.optimizer.ProjectionPatcher;
 import org.apache.pig.newplan.logical.optimizer.SchemaPatcher;
 import org.apache.pig.newplan.logical.relational.LOCogroup;
+import org.apache.pig.newplan.logical.relational.LODistinct;
 import org.apache.pig.newplan.logical.relational.LOFilter;
 import org.apache.pig.newplan.logical.relational.LOForEach;
 import org.apache.pig.newplan.logical.relational.LOJoin;
@@ -511,7 +521,55 @@ public class TestNewPlanFilterRule {
         Assert.assertTrue( fe1 instanceof LOForEach );
         Operator filter = newLogicalPlan.getSuccessors( fe2 ).get( 0 );
         Assert.assertTrue( filter instanceof LOFilter );
+    }
+
+    /**
+     * Test that SAMPLE doesn't get pushed up over Distinct (see PIG-2137)
+     */
+    @Test
+    public void testSampleDistinct() throws Exception {
+        String query = "A = LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" +
+        "B = DISTINCT A;" +
+        "C = SAMPLE B 0.1 ; " +
+        "D = STORE C INTO 'empty';";
+        // expect loload -> foreach -> distinct -> filter
+        LogicalPlan newLogicalPlan = migrateAndOptimizePlan( query );
+        newLogicalPlan.explain(System.out, "text", true);
 
+        Operator load = newLogicalPlan.getSources().get( 0 );
+        Assert.assertTrue( load instanceof LOLoad );
+        Operator fe1 = newLogicalPlan.getSuccessors( load ).get( 0 );
+        Assert.assertTrue( fe1 instanceof LOForEach );
+        Operator dist = newLogicalPlan.getSuccessors( fe1 ).get( 0 );
+        Assert.assertTrue( dist instanceof LODistinct );
+        Operator filter = newLogicalPlan.getSuccessors( dist ).get( 0 );
+        Assert.assertTrue( filter instanceof LOFilter );
+    }
+    
+    /**
+     * Test that deterministic filter gets get pushed up over Distinct (see PIG-2137)
+     */
+    @Test
+    public void testFilterAfterDistinct() throws Exception {
+        String query = "A = LOAD 'file.txt' AS (name : chararray, cuisines:bag{ t : ( cuisine ) } );" +
+        "B = DISTINCT A;" +
+        "C = filter B by SIZE(name) > 10;" +
+        "D = STORE C INTO 'long_name';";
+        // filter should be pushed above distinct,
+        //ie expect - loload -> foreach -> filter -> distinct 
+        LogicalPlan newLogicalPlan = migrateAndOptimizePlan( query );
+        newLogicalPlan.explain(System.out, "text", true);
+
+        Operator load = newLogicalPlan.getSources().get( 0 );
+        Assert.assertTrue( load instanceof LOLoad );
+        Operator fe1 = newLogicalPlan.getSuccessors( load ).get( 0 );
+        Assert.assertTrue( fe1 instanceof LOForEach );
+        Operator filter = newLogicalPlan.getSuccessors(fe1).get( 0 );
+        Assert.assertTrue( filter instanceof LOFilter );
+   
+        Operator dist = newLogicalPlan.getSuccessors(filter).get( 0 );
+        Assert.assertTrue( dist instanceof LODistinct );
+        
     }
 
     private LogicalPlan migrateAndOptimizePlan(String query) throws Exception {
