diff --git a/CHANGES.txt b/CHANGES.txt
index 49dff5d08..0ee73ad29 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -230,6 +230,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3457: Provide backward compatibility for PigStatsUtil and JobStats (daijy)
+
 PIG-3466: Race Conditions in InternalDistinctBag during proactive spill (cheolsoo)
 
 PIG-3464: Mark ExecType and ExecutionEngine interfaces as evolving (cheolsoo)
diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index 9ba1b8619..c57491bfb 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -75,7 +75,7 @@ import org.apache.pig.tools.cmdline.CmdLineParser;
 import org.apache.pig.tools.grunt.Grunt;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.apache.pig.tools.pigstats.ScriptState;
 import org.apache.pig.tools.timer.PerformanceTimerFactory;
 
@@ -605,33 +605,33 @@ static int run(String args[], PigProgressNotificationListener listener) {
     } catch (ParseException e) {
         usage();
         rc = ReturnCode.PARSE_EXCEPTION;
-        PigStatsUtil.setErrorMessage(e.getMessage());
-        PigStatsUtil.setErrorThrowable(e);
+        PigStatsUtilBase.setErrorMessage(e.getMessage());
+        PigStatsUtilBase.setErrorThrowable(e);
     } catch (org.apache.pig.tools.parameters.ParseException e) {
        // usage();
         rc = ReturnCode.PARSE_EXCEPTION;
-        PigStatsUtil.setErrorMessage(e.getMessage());
-        PigStatsUtil.setErrorThrowable(e);
+        PigStatsUtilBase.setErrorMessage(e.getMessage());
+        PigStatsUtilBase.setErrorThrowable(e);
     } catch (IOException e) {
         if (e instanceof PigException) {
             PigException pe = (PigException)e;
             rc = (pe.retriable()) ? ReturnCode.RETRIABLE_EXCEPTION
                     : ReturnCode.PIG_EXCEPTION;
-            PigStatsUtil.setErrorMessage(pe.getMessage());
-            PigStatsUtil.setErrorCode(pe.getErrorCode());
+            PigStatsUtilBase.setErrorMessage(pe.getMessage());
+            PigStatsUtilBase.setErrorCode(pe.getErrorCode());
         } else {
             rc = ReturnCode.IO_EXCEPTION;
-            PigStatsUtil.setErrorMessage(e.getMessage());
+            PigStatsUtilBase.setErrorMessage(e.getMessage());
         }
-        PigStatsUtil.setErrorThrowable(e);
+        PigStatsUtilBase.setErrorThrowable(e);
 
         if(!gruntCalled) {
             LogUtils.writeLog(e, logFileName, log, verbose, "Error before Pig is launched");
         }
     } catch (Throwable e) {
         rc = ReturnCode.THROWABLE_EXCEPTION;
-        PigStatsUtil.setErrorMessage(e.getMessage());
-        PigStatsUtil.setErrorThrowable(e);
+        PigStatsUtilBase.setErrorMessage(e.getMessage());
+        PigStatsUtilBase.setErrorThrowable(e);
 
         if(!gruntCalled) {
             LogUtils.writeLog(e, logFileName, log, verbose, "Error before Pig is launched");
@@ -1009,7 +1009,7 @@ throws IOException {
     pigContext.connect();
     ScriptEngine scriptEngine = ScriptEngine.getInstance(engine);
     Map<String, List<PigStats>> statsMap = scriptEngine.run(pigContext, file);
-    PigStatsUtil.setStatsMap(statsMap);
+    PigStatsUtilBase.setStatsMap(statsMap);
 
     int failCount = 0;
     int totalCount = 0;
diff --git a/src/org/apache/pig/PigRunner.java b/src/org/apache/pig/PigRunner.java
index 1a54d8062..dcca1e79f 100644
--- a/src/org/apache/pig/PigRunner.java
+++ b/src/org/apache/pig/PigRunner.java
@@ -21,7 +21,7 @@ import org.apache.pig.classification.InterfaceAudience;
 import org.apache.pig.classification.InterfaceStability;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 
 /**
  * A utility to help run PIG scripts within a Java program.
@@ -46,7 +46,7 @@ public abstract class PigRunner {
     }
     
     public static PigStats run(String[] args, PigProgressNotificationListener listener) {
-        return PigStatsUtil.getPigStats(Main.run(args, listener));
+        return PigStatsUtilBase.getPigStats(Main.run(args, listener));
     }
     
 }
diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 2306ff05b..cc5794798 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -96,7 +96,7 @@ import org.apache.pig.parser.QueryParserUtils;
 import org.apache.pig.pen.ExampleGenerator;
 import org.apache.pig.scripting.ScriptEngine;
 import org.apache.pig.tools.grunt.GruntParser;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
@@ -391,9 +391,9 @@ public class PigServer {
     protected List<ExecJob> getJobs(PigStats stats) {
         LinkedList<ExecJob> jobs = new LinkedList<ExecJob>();
         JobGraph jGraph = stats.getJobGraph();
-        Iterator<JobStats> iter = jGraph.iterator();
+        Iterator<JobStatsBase> iter = jGraph.iterator();
         while (iter.hasNext()) {
-            JobStats js = iter.next();
+            JobStatsBase js = iter.next();
             for (OutputStats output : js.getOutputs()) {
                 if (js.isSuccessful()) {
                     jobs.add(new HJob(HJob.JOB_STATUS.COMPLETED, pigContext, output
@@ -959,7 +959,7 @@ public class PigServer {
 
             //check for exception
             Exception ex = null;
-            for(JobStats js : stats.getJobGraph()){
+            for(JobStatsBase js : stats.getJobGraph()){
                 if(js.getException() != null) {
                     ex = js.getException();
                 }
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
index d01f1f61a..3756f0418 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
@@ -75,7 +75,7 @@ import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.impl.util.UDFContext;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil;
 import org.apache.pig.tools.pigstats.mapreduce.MRScriptState;
 
@@ -507,7 +507,7 @@ public class MapReduceLauncher extends Launcher{
                 : ReturnCode.FAILURE)
                 : ReturnCode.SUCCESS; 
         
-        PigStats pigStats = PigStatsUtil.getPigStats(ret);
+        PigStats pigStats = PigStatsUtilBase.getPigStats(ret);
         // run cleanup for all of the stores
              for (OutputStats output : pigStats.getOutputStats()) {
                  POStore store = output.getPOStore();
diff --git a/src/org/apache/pig/scripting/BoundScript.java b/src/org/apache/pig/scripting/BoundScript.java
index 28340d155..c6fe17579 100644
--- a/src/org/apache/pig/scripting/BoundScript.java
+++ b/src/org/apache/pig/scripting/BoundScript.java
@@ -38,7 +38,7 @@ import org.apache.pig.tools.grunt.GruntParser;
 import org.apache.pig.tools.pigscript.parser.ParseException;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.apache.pig.tools.pigstats.ScriptState;
 
 /**
@@ -176,15 +176,15 @@ public class BoundScript {
                 stats.add(future.get());
             } catch (InterruptedException e) {
                 LOG.error("Pig pipeline failed to complete", e);
-                PigStatsUtil.getEmptyPigStats();
-                PigStatsUtil.setErrorMessage(e.getMessage());
-                PigStats failed = PigStatsUtil.getPigStats(ReturnCode.FAILURE);                    
+                PigStatsUtilBase.getEmptyPigStats();
+                PigStatsUtilBase.setErrorMessage(e.getMessage());
+                PigStats failed = PigStatsUtilBase.getPigStats(ReturnCode.FAILURE);                    
                 stats.add(failed);
             } catch (ExecutionException e) {
                 LOG.error("Pig pipeline failed to complete", e);
-                PigStatsUtil.getEmptyPigStats();
-                PigStatsUtil.setErrorMessage(e.getMessage());                  
-                PigStats failed = PigStatsUtil.getPigStats(ReturnCode.FAILURE);                    
+                PigStatsUtilBase.getEmptyPigStats();
+                PigStatsUtilBase.setErrorMessage(e.getMessage());                  
+                PigStats failed = PigStatsUtilBase.getPigStats(ReturnCode.FAILURE);                    
                 stats.add(failed);
             }
         }
diff --git a/src/org/apache/pig/scripting/SyncProgressNotificationAdaptor.java b/src/org/apache/pig/scripting/SyncProgressNotificationAdaptor.java
index 5064020dd..bd73f6073 100644
--- a/src/org/apache/pig/scripting/SyncProgressNotificationAdaptor.java
+++ b/src/org/apache/pig/scripting/SyncProgressNotificationAdaptor.java
@@ -23,7 +23,7 @@ import java.util.List;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.plans.MROperPlan;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 
@@ -39,7 +39,7 @@ class SyncProgressNotificationAdaptor implements PigProgressNotificationListener
     }
 
     @Override
-    public void jobFailedNotification(String scriptId, JobStats jobStats) {
+    public void jobFailedNotification(String scriptId, JobStatsBase jobStats) {
         synchronized (listeners) {
             for (PigProgressNotificationListener listener : listeners) {
                 listener.jobFailedNotification(scriptId, jobStats);
@@ -48,7 +48,7 @@ class SyncProgressNotificationAdaptor implements PigProgressNotificationListener
     }
 
     @Override
-    public void jobFinishedNotification(String scriptId, JobStats jobStats) {
+    public void jobFinishedNotification(String scriptId, JobStatsBase jobStats) {
         synchronized (listeners) {
             for (PigProgressNotificationListener listener : listeners) {
                 listener.jobFinishedNotification(scriptId, jobStats);
diff --git a/src/org/apache/pig/tools/grunt/Grunt.java b/src/org/apache/pig/tools/grunt/Grunt.java
index db70ddb41..8c79d6ff2 100644
--- a/src/org/apache/pig/tools/grunt/Grunt.java
+++ b/src/org/apache/pig/tools/grunt/Grunt.java
@@ -29,7 +29,7 @@ import org.apache.pig.impl.PigContext;
 import org.apache.pig.tools.grunt.GruntParser;
 import org.apache.pig.tools.grunt.PigCompletor;
 import org.apache.pig.tools.grunt.PigCompletorAliases;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.impl.util.LogUtils;
 
@@ -64,7 +64,7 @@ public class Grunt
         boolean verbose = "true".equalsIgnoreCase(pig.getPigContext().getProperties().getProperty("verbose"));
         while(true) {
             try {
-                PigStatsUtil.getEmptyPigStats();
+                PigStatsUtilBase.getEmptyPigStats();
                 parser.setInteractive(true);
                 parser.parseStopOnError();
                 break;                            
@@ -79,7 +79,7 @@ public class Grunt
     public int[] exec() throws Throwable {
         boolean verbose = "true".equalsIgnoreCase(pig.getPigContext().getProperties().getProperty("verbose"));
         try {
-            PigStatsUtil.getEmptyPigStats();
+            PigStatsUtilBase.getEmptyPigStats();
             parser.setInteractive(false);
             return parser.parseStopOnError();
         } catch (Throwable t) {
diff --git a/src/org/apache/pig/tools/grunt/GruntParser.java b/src/org/apache/pig/tools/grunt/GruntParser.java
index 4883b778e..11d627bf1 100644
--- a/src/org/apache/pig/tools/grunt/GruntParser.java
+++ b/src/org/apache/pig/tools/grunt/GruntParser.java
@@ -68,7 +68,7 @@ import org.apache.pig.tools.pigscript.parser.ParseException;
 import org.apache.pig.tools.pigscript.parser.PigScriptParser;
 import org.apache.pig.tools.pigscript.parser.PigScriptParserTokenManager;
 import org.apache.pig.tools.pigscript.parser.TokenMgrError;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.fusesource.jansi.Ansi;
@@ -131,9 +131,9 @@ public class GruntParser extends PigScriptParser {
                 mPigServer.executeBatch();
                 PigStats stats = PigStats.get();
                 JobGraph jg = stats.getJobGraph();
-                Iterator<JobStats> iter = jg.iterator();
+                Iterator<JobStatsBase> iter = jg.iterator();
                 while (iter.hasNext()) {
-                    JobStats js = iter.next();
+                    JobStatsBase js = iter.next();
                     if (!js.isSuccessful()) {
                         mNumFailedJobs++;
                         Exception exp = (js.getException() != null) ? js.getException()
diff --git a/src/org/apache/pig/tools/pigstats/JobStats.java b/src/org/apache/pig/tools/pigstats/JobStats.java
index 3a74c411b..af577f6a9 100644
--- a/src/org/apache/pig/tools/pigstats/JobStats.java
+++ b/src/org/apache/pig/tools/pigstats/JobStats.java
@@ -1,177 +1,15 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
 package org.apache.pig.tools.pigstats;
 
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.List;
-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
-import org.apache.pig.classification.InterfaceAudience;
-import org.apache.pig.classification.InterfaceStability;
-import org.apache.pig.newplan.Operator;
-import org.apache.pig.newplan.PlanVisitor;
-import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
+import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
 
+@Deprecated
 /**
- * This class encapsulates the runtime statistics of a MapReduce job. 
- * Job statistics is collected when job is completed.
+ * This class is only for backward compatibility. New application need
+ * to use MRJobStats instead
  */
-@InterfaceAudience.Public
-@InterfaceStability.Evolving
-public abstract class JobStats extends Operator {
-        
-    public static final String ALIAS = "JobStatistics:alias";
-    public static final String ALIAS_LOCATION = "JobStatistics:alias_location";
-    public static final String FEATURE = "JobStatistics:feature";
-        
-    private static final Log LOG = LogFactory.getLog(JobStats.class);
-    public static final String SUCCESS_HEADER = null;
-    public static final String FAILURE_HEADER = null;
-    
-    public static enum JobState { UNKNOWN, SUCCESS, FAILED; }
-    
-    protected JobState state = JobState.UNKNOWN;
-        
-    protected ArrayList<OutputStats> outputs;
-    
-    protected ArrayList<InputStats> inputs;
-       
-    private String errorMsg;
-    
-    private Exception exception = null;
-               
-    protected JobStats(String name, JobGraph plan) {
+public class JobStats extends MRJobStats {
+    public JobStats(String name, JobGraph plan) {
         super(name, plan);
-        outputs = new ArrayList<OutputStats>();
-        inputs = new ArrayList<InputStats>();
-    }
-
-    public abstract String getJobId();
-    
-    public JobState getState() { return state; }
-    
-    public boolean isSuccessful() { return (state == JobState.SUCCESS); }
-
-    public void setSuccessful(boolean isSuccessful) {
-        this.state = isSuccessful ? JobState.SUCCESS : JobState.FAILED;
-    }
-
-    public String getErrorMessage() { return errorMsg; }
-    
-    public Exception getException() { return exception; }
-    
-    public List<OutputStats> getOutputs() {
-        return Collections.unmodifiableList(outputs);
-    }
-    
-    public List<InputStats> getInputs() {
-        return Collections.unmodifiableList(inputs);
-    }
-       
-    public String getAlias() {
-        return (String)getAnnotation(ALIAS);
-    }
-    
-    public String getAliasLocation() {
-        return (String)getAnnotation(ALIAS_LOCATION);
-    }
-
-    public String getFeature() {
-        return (String)getAnnotation(FEATURE);
-    }
-        
-    /**
-     * Returns the total bytes written to user specified HDFS
-     * locations of this job.
-     */
-    public long getBytesWritten() {        
-        long count = 0;
-        for (OutputStats out : outputs) {
-            long n = out.getBytes();            
-            if (n > 0) count += n;
-        }
-        return count;
-    }
-    
-    /**
-     * Returns the total number of records in user specified output
-     * locations of this job.
-     */
-    public long getRecordWrittern() {
-        long count = 0;
-        for (OutputStats out : outputs) {
-            long rec = out.getNumberRecords();
-            if (rec > 0) count += rec;
-        }
-        return count;
-    }
-    
-    @Override
-    public abstract void accept(PlanVisitor v) throws FrontendException;
-    
-    
-    @Override
-    public boolean isEqual(Operator operator) {
-        if (!(operator instanceof JobStats)) return false;
-        return name.equalsIgnoreCase(operator.getName());
-    }    
-
-    public void setErrorMsg(String errorMsg) {
-        this.errorMsg = errorMsg;
-    }
-    
-    public void setBackendException(Exception e) {
-        exception = e;
-    }
-       
-    public abstract String getDisplayString(boolean isLocal);
-
-    
-    /**
-     * Calculate the median value from the given array
-     * @param durations
-     * @return median value
-     */
-    protected long calculateMedianValue(long[] durations) {
-		long median;
-		// figure out the median
-		Arrays.sort(durations);
-		int midPoint = durations.length /2;
-		if ((durations.length & 1) == 1) {
-			// odd
-			median = durations[midPoint];
-		} else {
-			// even
-			median = (durations[midPoint-1] + durations[midPoint]) / 2; 
-		}
-		return median;
-	}
-    
-    public boolean isSampler() {
-        return getFeature().contains(ScriptState.PIG_FEATURE.SAMPLER.name());
-    }
-    
-    public boolean isIndexer() {
-        return getFeature().contains(ScriptState.PIG_FEATURE.INDEXER.name());
     }
-    
 }
diff --git a/src/org/apache/pig/tools/pigstats/JobStatsBase.java b/src/org/apache/pig/tools/pigstats/JobStatsBase.java
new file mode 100644
index 000000000..0938c2b62
--- /dev/null
+++ b/src/org/apache/pig/tools/pigstats/JobStatsBase.java
@@ -0,0 +1,177 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pig.tools.pigstats;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.pig.newplan.Operator;
+import org.apache.pig.newplan.PlanVisitor;
+import org.apache.pig.classification.InterfaceAudience;
+import org.apache.pig.classification.InterfaceStability;
+import org.apache.pig.impl.logicalLayer.FrontendException;
+import org.apache.pig.tools.pigstats.PigStats.JobGraph;
+
+/**
+ * This class encapsulates the runtime statistics of a MapReduce job. 
+ * Job statistics is collected when job is completed.
+ */
+@InterfaceAudience.Public
+@InterfaceStability.Evolving
+public abstract class JobStatsBase extends Operator {
+        
+    public static final String ALIAS = "JobStatistics:alias";
+    public static final String ALIAS_LOCATION = "JobStatistics:alias_location";
+    public static final String FEATURE = "JobStatistics:feature";
+        
+    private static final Log LOG = LogFactory.getLog(JobStatsBase.class);
+    public static final String SUCCESS_HEADER = null;
+    public static final String FAILURE_HEADER = null;
+    
+    public static enum JobState { UNKNOWN, SUCCESS, FAILED; }
+    
+    protected JobState state = JobState.UNKNOWN;
+        
+    protected ArrayList<OutputStats> outputs;
+    
+    protected ArrayList<InputStats> inputs;
+       
+    private String errorMsg;
+    
+    private Exception exception = null;
+               
+    protected JobStatsBase(String name, JobGraph plan) {
+        super(name, plan);
+        outputs = new ArrayList<OutputStats>();
+        inputs = new ArrayList<InputStats>();
+    }
+
+    public abstract String getJobId();
+    
+    public JobState getState() { return state; }
+    
+    public boolean isSuccessful() { return (state == JobState.SUCCESS); }
+
+    public void setSuccessful(boolean isSuccessful) {
+        this.state = isSuccessful ? JobState.SUCCESS : JobState.FAILED;
+    }
+
+    public String getErrorMessage() { return errorMsg; }
+    
+    public Exception getException() { return exception; }
+    
+    public List<OutputStats> getOutputs() {
+        return Collections.unmodifiableList(outputs);
+    }
+    
+    public List<InputStats> getInputs() {
+        return Collections.unmodifiableList(inputs);
+    }
+       
+    public String getAlias() {
+        return (String)getAnnotation(ALIAS);
+    }
+    
+    public String getAliasLocation() {
+        return (String)getAnnotation(ALIAS_LOCATION);
+    }
+
+    public String getFeature() {
+        return (String)getAnnotation(FEATURE);
+    }
+        
+    /**
+     * Returns the total bytes written to user specified HDFS
+     * locations of this job.
+     */
+    public long getBytesWritten() {        
+        long count = 0;
+        for (OutputStats out : outputs) {
+            long n = out.getBytes();            
+            if (n > 0) count += n;
+        }
+        return count;
+    }
+    
+    /**
+     * Returns the total number of records in user specified output
+     * locations of this job.
+     */
+    public long getRecordWrittern() {
+        long count = 0;
+        for (OutputStats out : outputs) {
+            long rec = out.getNumberRecords();
+            if (rec > 0) count += rec;
+        }
+        return count;
+    }
+    
+    @Override
+    public abstract void accept(PlanVisitor v) throws FrontendException;
+    
+    
+    @Override
+    public boolean isEqual(Operator operator) {
+        if (!(operator instanceof JobStatsBase)) return false;
+        return name.equalsIgnoreCase(operator.getName());
+    }    
+
+    public void setErrorMsg(String errorMsg) {
+        this.errorMsg = errorMsg;
+    }
+    
+    public void setBackendException(Exception e) {
+        exception = e;
+    }
+       
+    public abstract String getDisplayString(boolean isLocal);
+
+    
+    /**
+     * Calculate the median value from the given array
+     * @param durations
+     * @return median value
+     */
+    protected long calculateMedianValue(long[] durations) {
+		long median;
+		// figure out the median
+		Arrays.sort(durations);
+		int midPoint = durations.length /2;
+		if ((durations.length & 1) == 1) {
+			// odd
+			median = durations[midPoint];
+		} else {
+			// even
+			median = (durations[midPoint-1] + durations[midPoint]) / 2; 
+		}
+		return median;
+	}
+    
+    public boolean isSampler() {
+        return getFeature().contains(ScriptState.PIG_FEATURE.SAMPLER.name());
+    }
+    
+    public boolean isIndexer() {
+        return getFeature().contains(ScriptState.PIG_FEATURE.INDEXER.name());
+    }
+    
+}
diff --git a/src/org/apache/pig/tools/pigstats/PigProgressNotificationListener.java b/src/org/apache/pig/tools/pigstats/PigProgressNotificationListener.java
index 15fa4e3fb..887317d89 100644
--- a/src/org/apache/pig/tools/pigstats/PigProgressNotificationListener.java
+++ b/src/org/apache/pig/tools/pigstats/PigProgressNotificationListener.java
@@ -64,16 +64,16 @@ public interface PigProgressNotificationListener extends java.util.EventListener
     /**
      * Invoked just after a MR job is completed successfully. 
      * @param scriptId the unique id of the script 
-     * @param jobStats the {@link JobStats} object associated with the MR job
+     * @param jobStats the {@link JobStatsBase} object associated with the MR job
      */
-    public void jobFinishedNotification(String scriptId, JobStats jobStats);
+    public void jobFinishedNotification(String scriptId, JobStatsBase jobStats);
     
     /**
      * Invoked when a MR job fails.
      * @param scriptId the unique id of the script 
-     * @param jobStats the {@link JobStats} object associated with the MR job
+     * @param jobStats the {@link JobStatsBase} object associated with the MR job
      */
-    public void jobFailedNotification(String scriptId, JobStats jobStats);
+    public void jobFailedNotification(String scriptId, JobStatsBase jobStats);
     
     /**
      * Invoked just after an output is successfully written.
diff --git a/src/org/apache/pig/tools/pigstats/PigStats.java b/src/org/apache/pig/tools/pigstats/PigStats.java
index 6d2e58e14..2e2cd6482 100644
--- a/src/org/apache/pig/tools/pigstats/PigStats.java
+++ b/src/org/apache/pig/tools/pigstats/PigStats.java
@@ -39,7 +39,7 @@ import org.apache.pig.newplan.BaseOperatorPlan;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.newplan.OperatorPlan;
 import org.apache.pig.newplan.PlanVisitor;
-import org.apache.pig.tools.pigstats.JobStats.JobState;
+import org.apache.pig.tools.pigstats.JobStatsBase.JobState;
 import org.apache.pig.tools.pigstats.mapreduce.SimplePigStats;
 
 /**
@@ -232,13 +232,13 @@ public abstract class PigStats {
             buf = new StringBuffer();
         }
         
-        public void visit(JobStats op) throws FrontendException {
+        public void visit(JobStatsBase op) throws FrontendException {
             buf.append(op.getJobId());
             List<Operator> succs = plan.getSuccessors(op);
             if (succs != null) {
                 buf.append("\t->\t");
                 for (Operator p : succs) {                  
-                    buf.append(((JobStats)p).getJobId()).append(",");
+                    buf.append(((JobStatsBase)p).getJobId()).append(",");
                 }               
             }
             buf.append("\n");
@@ -252,9 +252,9 @@ public abstract class PigStats {
     }
     
     /**
-     * JobGraph is an {@link OperatorPlan} whose members are {@link JobStats}
+     * JobGraph is an {@link OperatorPlan} whose members are {@link JobStatsBase}
      */
-    public static class JobGraph extends BaseOperatorPlan implements Iterable<JobStats>{
+    public static class JobGraph extends BaseOperatorPlan implements Iterable<JobStatsBase>{
                 
         @Override
         public String toString() {
@@ -274,20 +274,20 @@ public abstract class PigStats {
          * @return List<JobStats>
          */
         @SuppressWarnings("unchecked")
-        public List<JobStats> getJobList() {
+        public List<JobStatsBase> getJobList() {
             return IteratorUtils.toList(iterator());
         }
 
-        public Iterator<JobStats> iterator() {
-            return new Iterator<JobStats>() {
+        public Iterator<JobStatsBase> iterator() {
+            return new Iterator<JobStatsBase>() {
                 private Iterator<Operator> iter = getOperators();                
                 @Override
                 public boolean hasNext() {                
                     return iter.hasNext();
                 }
                 @Override
-                public JobStats next() {              
-                    return (JobStats)iter.next();
+                public JobStatsBase next() {              
+                    return (JobStatsBase)iter.next();
                 }
                 @Override
                 public void remove() {}
@@ -308,11 +308,11 @@ public abstract class PigStats {
             return false;
         }
         
-        public List<JobStats> getSuccessfulJobs() {
-            ArrayList<JobStats> lst = new ArrayList<JobStats>();
-            Iterator<JobStats> iter = iterator();
+        public List<JobStatsBase> getSuccessfulJobs() {
+            ArrayList<JobStatsBase> lst = new ArrayList<JobStatsBase>();
+            Iterator<JobStatsBase> iter = iterator();
             while (iter.hasNext()) {
-                JobStats js = iter.next();
+                JobStatsBase js = iter.next();
                 if (js.getState() == JobState.SUCCESS) {
                     lst.add(js);
                 }
@@ -321,11 +321,11 @@ public abstract class PigStats {
             return lst;
         }
         
-        public List<JobStats> getFailedJobs() {
-            ArrayList<JobStats> lst = new ArrayList<JobStats>();
-            Iterator<JobStats> iter = iterator();
+        public List<JobStatsBase> getFailedJobs() {
+            ArrayList<JobStatsBase> lst = new ArrayList<JobStatsBase>();
+            Iterator<JobStatsBase> iter = iterator();
             while (iter.hasNext()) {
-                JobStats js = iter.next();
+                JobStatsBase js = iter.next();
                 if (js.getState() == JobState.FAILED) {
                     lst.add(js);
                 }
@@ -334,9 +334,9 @@ public abstract class PigStats {
         }
     }    
     
-    private static class JobComparator implements Comparator<JobStats> {
+    private static class JobComparator implements Comparator<JobStatsBase> {
         @Override
-        public int compare(JobStats o1, JobStats o2) {           
+        public int compare(JobStatsBase o1, JobStatsBase o2) {           
             return o1.getJobId().compareTo(o2.getJobId());
         }       
     }    
diff --git a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
index 18ac98582..0da659ea2 100644
--- a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
+++ b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
@@ -15,73 +15,14 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-
 package org.apache.pig.tools.pigstats;
 
-import java.util.List;
-import java.util.Map;
-import java.util.regex.Matcher;
-import java.util.regex.Pattern;
-
-import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.mapreduce.SimplePigStats;
+import org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil;
 
+@Deprecated
 /**
- * A utility class for Pig Statistics
+ * This class is only for backward compatibility. New application need
+ * to use MRJobStats instead
  */
-public class PigStatsUtil {
-        
-    /**
-     * Returns an empty PigStats object
-     * Use of this method is not advised
-     * as it will return the MR execution
-     * engine version of PigStats by 
-     * default, and is not necessarily 
-     * empty depending on the timing.
-     * 
-     * @return an empty PigStats object
-     */
-    @Deprecated
-    public static PigStats getEmptyPigStats() {
-        return PigStats.start(new SimplePigStats());
-    }
-    
-    /**
-     * Returns the PigStats with the given return code
-     * 
-     * @param code the return code
-     * @return the PigStats with the given return code
-     */
-    public static PigStats getPigStats(int code) {
-        PigStats ps = PigStats.get();
-        ps.setReturnCode(code);
-        return ps;
-    }
-    
-    
-    public static void setErrorMessage(String msg) {
-        PigStats.get().setErrorMessage(msg);
-    }
-    
-    public static void setErrorCode(int code) {
-        PigStats.get().setErrorCode(code);
-    }
-    
-    public static void setErrorThrowable(Throwable t) {
-        PigStats.get().setErrorThrowable(t);
-    }
-    
-    private static Pattern pattern = Pattern.compile("tmp(-)?[\\d]{1,10}$");
-    
-    public static boolean isTempFile(String fileName) {
-        Matcher result = pattern.matcher(fileName);
-        return result.find();
-    }
-    
-    public static void setStatsMap(Map<String, List<PigStats>> statsMap) {
-        EmbeddedPigStats stats = new EmbeddedPigStats(statsMap);
-        PigStats.set(stats);
-    }
-   
- 
+public class PigStatsUtil extends MRPigStatsUtil {
 }
diff --git a/src/org/apache/pig/tools/pigstats/PigStatsUtilBase.java b/src/org/apache/pig/tools/pigstats/PigStatsUtilBase.java
new file mode 100644
index 000000000..788e86e40
--- /dev/null
+++ b/src/org/apache/pig/tools/pigstats/PigStatsUtilBase.java
@@ -0,0 +1,91 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pig.tools.pigstats;
+
+import java.util.List;
+import java.util.Map;
+import java.util.regex.Matcher;
+import java.util.regex.Pattern;
+
+import org.apache.hadoop.classification.InterfaceAudience;
+import org.apache.pig.classification.InterfaceStability;
+import org.apache.pig.tools.pigstats.PigStats;
+import org.apache.pig.tools.pigstats.mapreduce.SimplePigStats;
+
+/**
+ * A utility class for Pig Statistics
+ */
+@InterfaceAudience.Public
+@InterfaceStability.Evolving
+public class PigStatsUtilBase {
+        
+    /**
+     * Returns an empty PigStats object
+     * Use of this method is not advised
+     * as it will return the MR execution
+     * engine version of PigStats by 
+     * default, and is not necessarily 
+     * empty depending on the timing.
+     * 
+     * @return an empty PigStats object
+     */
+    @Deprecated
+    public static PigStats getEmptyPigStats() {
+        return PigStats.start(new SimplePigStats());
+    }
+    
+    /**
+     * Returns the PigStats with the given return code
+     * 
+     * @param code the return code
+     * @return the PigStats with the given return code
+     */
+    public static PigStats getPigStats(int code) {
+        PigStats ps = PigStats.get();
+        ps.setReturnCode(code);
+        return ps;
+    }
+    
+    
+    public static void setErrorMessage(String msg) {
+        PigStats.get().setErrorMessage(msg);
+    }
+    
+    public static void setErrorCode(int code) {
+        PigStats.get().setErrorCode(code);
+    }
+    
+    public static void setErrorThrowable(Throwable t) {
+        PigStats.get().setErrorThrowable(t);
+    }
+    
+    private static Pattern pattern = Pattern.compile("tmp(-)?[\\d]{1,10}$");
+    
+    public static boolean isTempFile(String fileName) {
+        Matcher result = pattern.matcher(fileName);
+        return result.find();
+    }
+    
+    public static void setStatsMap(Map<String, List<PigStats>> statsMap) {
+        EmbeddedPigStats stats = new EmbeddedPigStats(statsMap);
+        PigStats.set(stats);
+    }
+   
+ 
+}
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
index 1a37848eb..be7bb235b 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
@@ -50,7 +50,7 @@ import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.util.ObjectSerializer;
 import org.apache.pig.tools.pigstats.InputStats;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.PigStats.JobGraphPrinter;
@@ -62,10 +62,10 @@ import org.apache.pig.tools.pigstats.PigStats.JobGraphPrinter;
  */
 @InterfaceAudience.Public
 @InterfaceStability.Evolving
-public final class MRJobStats extends JobStats {
+public class MRJobStats extends JobStatsBase {
         
     
-    MRJobStats(String name, JobGraph plan) {
+    protected MRJobStats(String name, JobGraph plan) {
         super(name, plan);
     }
 
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
index 4bdcf1992..bedcc34ee 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
@@ -22,6 +22,7 @@ import java.io.IOException;
 import java.util.Map;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.classification.InterfaceAudience;
 import org.apache.hadoop.mapred.Counters;
 import org.apache.hadoop.mapred.JobClient;
 import org.apache.hadoop.mapred.RunningJob;
@@ -33,20 +34,23 @@ import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.NativeMapRed
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.plans.MROperPlan;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POStore;
 import org.apache.pig.backend.hadoop.executionengine.shims.HadoopShims;
+import org.apache.pig.classification.InterfaceStability;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.mapreduce.SimplePigStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRScriptState;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 
 
 
 /**
  * A utility class for Pig Statistics
  */
-public class MRPigStatsUtil extends PigStatsUtil {
+@InterfaceAudience.Public
+@InterfaceStability.Evolving
+public class MRPigStatsUtil extends PigStatsUtilBase {
 
     public static final String MULTI_STORE_RECORD_COUNTER 
             = "Output records in ";
@@ -198,7 +202,7 @@ public class MRPigStatsUtil extends PigStatsUtil {
      * @param job the job being run
      * @return JobStats for the job
      */
-    public static JobStats addJobStats(Job job) {
+    public static JobStatsBase addJobStats(Job job) {
         SimplePigStats ps = (SimplePigStats)PigStats.get();
         return ps.addMRJobStats(job);
     }
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
index 4669c4bcc..49bc4515d 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
@@ -64,7 +64,7 @@ import org.apache.pig.newplan.logical.relational.LOJoin;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.ScriptState;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.OutputStats;
 
@@ -133,13 +133,13 @@ public class MRScriptState extends ScriptState {
         }
     }
     
-    public void emitjobFinishedNotification(JobStats jobStats) {
+    public void emitjobFinishedNotification(JobStatsBase jobStats) {
         for (PigProgressNotificationListener listener: listeners) {
             listener.jobFinishedNotification(id, jobStats);
         }
     }
     
-    public void emitJobFailedNotification(JobStats jobStats) {
+    public void emitJobFailedNotification(JobStatsBase jobStats) {
         for (PigProgressNotificationListener listener: listeners) {
             listener.jobFailedNotification(id, jobStats);
         }
@@ -243,10 +243,10 @@ public class MRScriptState extends ScriptState {
         // upon available. Therefore, before a job is submitted, the ids
         // of its parent jobs are already available.
         JobGraph jg = PigStats.get().getJobGraph();
-        JobStats js = null;
-        Iterator<JobStats> iter = jg.iterator();
+        JobStatsBase js = null;
+        Iterator<JobStatsBase> iter = jg.iterator();
         while (iter.hasNext()) {
-            JobStats job = iter.next();
+            JobStatsBase job = iter.next();
             if (job.getName().equals(mro.getOperatorKey().toString())) {
                 js = job;
                 break;
@@ -257,7 +257,7 @@ public class MRScriptState extends ScriptState {
             if (preds != null) {
                 StringBuilder sb = new StringBuilder();
                 for (Operator op : preds) {
-                    JobStats job = (JobStats)op;
+                    JobStatsBase job = (JobStatsBase)op;
                     if (sb.length() > 0) sb.append(",");
                     sb.append(job.getJobId());
                 }
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/SimplePigStats.java b/src/org/apache/pig/tools/pigstats/mapreduce/SimplePigStats.java
index bbfd5a9bb..1697303db 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/SimplePigStats.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/SimplePigStats.java
@@ -48,11 +48,11 @@ import org.apache.pig.impl.plan.DependencyOrderWalker;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.pig.tools.pigstats.InputStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
-import org.apache.pig.tools.pigstats.JobStats.JobState;
+import org.apache.pig.tools.pigstats.JobStatsBase.JobState;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.ScriptState;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 
 /**
  * SimplePigStats encapsulates the statistics collected from a running script. 
@@ -211,7 +211,7 @@ public final class SimplePigStats extends PigStats {
 
     @Override
     public long getSMMSpillCount() {
-        Iterator<JobStats> it = jobPlan.iterator();
+        Iterator<JobStatsBase> it = jobPlan.iterator();
         long ret = 0;
         while (it.hasNext()) {
             ret += ((MRJobStats) it.next()).getSMMSpillCount();
@@ -221,7 +221,7 @@ public final class SimplePigStats extends PigStats {
 
     @Override
     public long getProactiveSpillCountObjects() {
-        Iterator<JobStats> it = jobPlan.iterator();
+        Iterator<JobStatsBase> it = jobPlan.iterator();
         long ret = 0;
         while (it.hasNext()) {            
             ret += ((MRJobStats) it.next()).getProactiveSpillCountObjects();
@@ -231,7 +231,7 @@ public final class SimplePigStats extends PigStats {
     
     @Override
     public long getProactiveSpillCountRecords() {
-        Iterator<JobStats> it = jobPlan.iterator();
+        Iterator<JobStatsBase> it = jobPlan.iterator();
         long ret = 0;
         while (it.hasNext()) {            
             ret += ((MRJobStats) it.next()).getProactiveSpillCountRecs();
@@ -241,7 +241,7 @@ public final class SimplePigStats extends PigStats {
     
     @Override
     public long getBytesWritten() {
-        Iterator<JobStats> it = jobPlan.iterator();
+        Iterator<JobStatsBase> it = jobPlan.iterator();
         long ret = 0;
         while (it.hasNext()) {
             long n = it.next().getBytesWritten();
@@ -252,7 +252,7 @@ public final class SimplePigStats extends PigStats {
     
     @Override
     public long getRecordWritten() {
-        Iterator<JobStats> it = jobPlan.iterator();
+        Iterator<JobStatsBase> it = jobPlan.iterator();
         long ret = 0;
         while (it.hasNext()) {
             long n = it.next().getRecordWrittern();
@@ -284,7 +284,7 @@ public final class SimplePigStats extends PigStats {
     @Override
     public List<OutputStats> getOutputStats() {
         List<OutputStats> outputs = new ArrayList<OutputStats>();
-        Iterator<JobStats> iter = jobPlan.iterator();
+        Iterator<JobStatsBase> iter = jobPlan.iterator();
         while (iter.hasNext()) {
             for (OutputStats os : iter.next().getOutputs()) {
                 outputs.add(os);
@@ -297,7 +297,7 @@ public final class SimplePigStats extends PigStats {
     public OutputStats result(String alias) {
         if (aliasOuputMap == null) {
             aliasOuputMap = new HashMap<String, OutputStats>();
-            Iterator<JobStats> iter = jobPlan.iterator();
+            Iterator<JobStatsBase> iter = jobPlan.iterator();
             while (iter.hasNext()) {
                 for (OutputStats os : iter.next().getOutputs()) {
                     String a = os.getAlias();
@@ -315,7 +315,7 @@ public final class SimplePigStats extends PigStats {
     @Override
     public List<InputStats> getInputStats() {
         List<InputStats> inputs = new ArrayList<InputStats>();
-        Iterator<JobStats> iter = jobPlan.iterator();
+        Iterator<JobStatsBase> iter = jobPlan.iterator();
         while (iter.hasNext()) {
             for (InputStats is : iter.next().getInputs()) {
                 inputs.add(is);
@@ -447,8 +447,8 @@ public final class SimplePigStats extends PigStats {
             } else {
                 sb.append(MRJobStats.SUCCESS_HEADER).append("\n");
             }
-            List<JobStats> arr = jobPlan.getSuccessfulJobs();
-            for (JobStats js : arr) {                
+            List<JobStatsBase> arr = jobPlan.getSuccessfulJobs();
+            for (JobStatsBase js : arr) {                
                 sb.append(js.getDisplayString(execType.isLocal()));
             }
             sb.append("\n");
@@ -457,8 +457,8 @@ public final class SimplePigStats extends PigStats {
                 || returnCode == ReturnCode.PARTIAL_FAILURE) {
             sb.append("Failed Jobs:\n");
             sb.append(MRJobStats.FAILURE_HEADER).append("\n");
-            List<JobStats> arr = jobPlan.getFailedJobs();
-            for (JobStats js : arr) {   
+            List<JobStatsBase> arr = jobPlan.getFailedJobs();
+            for (JobStatsBase js : arr) {   
                 sb.append(js.getDisplayString(execType.isLocal()));
             }
             sb.append("\n");
@@ -516,9 +516,9 @@ public final class SimplePigStats extends PigStats {
             return;
         }
         String id = job.getAssignedJobID().toString();
-        Iterator<JobStats> iter = jobPlan.iterator();
+        Iterator<JobStatsBase> iter = jobPlan.iterator();
         while (iter.hasNext()) {
-            JobStats js = iter.next();
+            JobStatsBase js = iter.next();
             if (id.equals(js.getJobId())) {
                 js.setBackendException(e);
                 break;
@@ -531,7 +531,7 @@ public final class SimplePigStats extends PigStats {
     }
     
     int getNumberSuccessfulJobs() {
-        Iterator<JobStats> iter = jobPlan.iterator();
+        Iterator<JobStatsBase> iter = jobPlan.iterator();
         int count = 0;
         while (iter.hasNext()) {
             if (iter.next().getState() == JobState.SUCCESS) count++; 
@@ -540,7 +540,7 @@ public final class SimplePigStats extends PigStats {
     }
     
     int getNumberFailedJobs() {
-        Iterator<JobStats> iter = jobPlan.iterator();
+        Iterator<JobStatsBase> iter = jobPlan.iterator();
         int count = 0;
         while (iter.hasNext()) {
             if (iter.next().getState() == JobState.FAILED) count++; 
diff --git a/test/org/apache/pig/newplan/logical/relational/TestLocationInPhysicalPlan.java b/test/org/apache/pig/newplan/logical/relational/TestLocationInPhysicalPlan.java
index b37a437ec..424f6fbee 100644
--- a/test/org/apache/pig/newplan/logical/relational/TestLocationInPhysicalPlan.java
+++ b/test/org/apache/pig/newplan/logical/relational/TestLocationInPhysicalPlan.java
@@ -28,7 +28,7 @@ import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.OriginalLocation;
 import org.apache.pig.test.Util;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.junit.Test;
 
 public class TestLocationInPhysicalPlan {
@@ -60,7 +60,7 @@ public class TestLocationInPhysicalPlan {
         Assert.assertEquals(4, originalLocation.getLine());
         Assert.assertEquals(0, originalLocation.getOffset());
         Assert.assertEquals("A", originalLocation.getAlias());
-        JobStats jStats = (JobStats)job.getStatistics().getJobGraph().getSinks().get(0);
+        JobStatsBase jStats = (JobStatsBase)job.getStatistics().getJobGraph().getSinks().get(0);
         Assert.assertEquals("M: A[1,4],A[3,4],B[2,4] C: A[3,4],B[2,4] R: A[3,4]", jStats.getAliasLocation());
     }
 }
diff --git a/test/org/apache/pig/test/TestCounters.java b/test/org/apache/pig/test/TestCounters.java
index 46d41f0f5..a3064b656 100644
--- a/test/org/apache/pig/test/TestCounters.java
+++ b/test/org/apache/pig/test/TestCounters.java
@@ -36,7 +36,7 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.tools.pigstats.InputStats;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
@@ -96,7 +96,7 @@ public class TestCounters {
         System.out.println("============================================");
 
         JobGraph jg = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jg.iterator();
+        Iterator<JobStatsBase> iter = jg.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();                    
 
@@ -147,7 +147,7 @@ public class TestCounters {
         System.out.println("============================================");
 
         JobGraph jp = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jp.iterator();
+        Iterator<JobStatsBase> iter = jp.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();
         
@@ -206,7 +206,7 @@ public class TestCounters {
         System.out.println("============================================");
 
         JobGraph jp = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jp.iterator();
+        Iterator<JobStatsBase> iter = jp.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();
             System.out.println("Map input records : " + js.getMapInputRecords());
@@ -264,7 +264,7 @@ public class TestCounters {
         System.out.println("============================================");
 
         JobGraph jp = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jp.iterator();
+        Iterator<JobStatsBase> iter = jp.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();
             System.out.println("Map input records : " + js.getMapInputRecords());
@@ -322,7 +322,7 @@ public class TestCounters {
         System.out.println("============================================");
         
         JobGraph jp = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jp.iterator();
+        Iterator<JobStatsBase> iter = jp.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();
             System.out.println("Map input records : " + js.getMapInputRecords());
@@ -381,7 +381,7 @@ public class TestCounters {
         System.out.println("============================================");
  
         JobGraph jp = pigStats.getJobGraph();
-        Iterator<JobStats> iter = jp.iterator();
+        Iterator<JobStatsBase> iter = jp.iterator();
         while (iter.hasNext()) {
             MRJobStats js = (MRJobStats) iter.next();
             System.out.println("Map input records : " + js.getMapInputRecords());
diff --git a/test/org/apache/pig/test/TestEmptyInputDir.java b/test/org/apache/pig/test/TestEmptyInputDir.java
index 5f8355cab..c774c740d 100644
--- a/test/org/apache/pig/test/TestEmptyInputDir.java
+++ b/test/org/apache/pig/test/TestEmptyInputDir.java
@@ -29,7 +29,7 @@ import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.pig.PigRunner;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
 import org.junit.AfterClass;
diff --git a/test/org/apache/pig/test/TestFRJoin2.java b/test/org/apache/pig/test/TestFRJoin2.java
index be0ec1e15..94bc96d68 100644
--- a/test/org/apache/pig/test/TestFRJoin2.java
+++ b/test/org/apache/pig/test/TestFRJoin2.java
@@ -31,7 +31,7 @@ import org.apache.pig.data.BagFactory;
 import org.apache.pig.data.DataBag;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.test.utils.TestHelper;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
diff --git a/test/org/apache/pig/test/TestGroupConstParallel.java b/test/org/apache/pig/test/TestGroupConstParallel.java
index 33fdae848..4f04d5b17 100644
--- a/test/org/apache/pig/test/TestGroupConstParallel.java
+++ b/test/org/apache/pig/test/TestGroupConstParallel.java
@@ -43,7 +43,7 @@ import org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer;
 import org.apache.pig.newplan.logical.rules.GroupByConstParallelSetter;
 import org.apache.pig.newplan.optimizer.Rule;
 import org.apache.pig.test.utils.GenPhyOp;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
diff --git a/test/org/apache/pig/test/TestMRJobStats.java b/test/org/apache/pig/test/TestMRJobStats.java
index 45b316441..b2401e938 100644
--- a/test/org/apache/pig/test/TestMRJobStats.java
+++ b/test/org/apache/pig/test/TestMRJobStats.java
@@ -44,7 +44,7 @@ import org.apache.pig.backend.hadoop.hbase.HBaseStorage;
 import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.util.UDFContext;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
@@ -130,7 +130,7 @@ public class TestMRJobStats {
         String msg = (String)getJobStatsMethod("getDisplayString", boolean.class)
             .invoke(jobStats, false);
 
-        System.out.println(JobStats.SUCCESS_HEADER);
+        System.out.println(JobStatsBase.SUCCESS_HEADER);
         System.out.println(msg);
 
         assertTrue(msg.startsWith(ASSERT_STRING));
@@ -165,7 +165,7 @@ public class TestMRJobStats {
             .invoke(jobStats, jobClient, jobConf);
         String msg = (String)getJobStatsMethod("getDisplayString", boolean.class)
             .invoke(jobStats, false);
-        System.out.println(JobStats.SUCCESS_HEADER);
+        System.out.println(JobStatsBase.SUCCESS_HEADER);
         System.out.println(msg);
 
         StringBuilder sb = new StringBuilder();
diff --git a/test/org/apache/pig/test/TestMultiQueryLocal.java b/test/org/apache/pig/test/TestMultiQueryLocal.java
index d52d3073f..306f5d3c1 100644
--- a/test/org/apache/pig/test/TestMultiQueryLocal.java
+++ b/test/org/apache/pig/test/TestMultiQueryLocal.java
@@ -53,7 +53,7 @@ import org.apache.pig.tools.grunt.GruntParser;
 import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.newplan.logical.relational.LogicalPlan;
 import org.apache.pig.tools.pigscript.parser.ParseException;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.junit.After;
 import org.junit.Before;
@@ -651,9 +651,9 @@ public class TestMultiQueryLocal {
             e.printStackTrace(System.out);
             throw new IOException(e);
         }
-        Iterator<JobStats> iter = stats.getJobGraph().iterator();
+        Iterator<JobStatsBase> iter = stats.getJobGraph().iterator();
         while (iter.hasNext()) {
-            JobStats js = iter.next();
+            JobStatsBase js = iter.next();
             failed = !js.isSuccessful();
             if (failed) {
                 break;
diff --git a/test/org/apache/pig/test/TestNumberOfReducers.java b/test/org/apache/pig/test/TestNumberOfReducers.java
index 53edcbffe..8285e2dc7 100644
--- a/test/org/apache/pig/test/TestNumberOfReducers.java
+++ b/test/org/apache/pig/test/TestNumberOfReducers.java
@@ -25,7 +25,7 @@ import java.io.PrintWriter;
 import org.apache.pig.PigRunner;
 import org.apache.pig.PigServer;
 import org.apache.pig.impl.PigContext;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
 import org.junit.AfterClass;
diff --git a/test/org/apache/pig/test/TestPigRunner.java b/test/org/apache/pig/test/TestPigRunner.java
index c5d84cf80..8ea14a1f4 100644
--- a/test/org/apache/pig/test/TestPigRunner.java
+++ b/test/org/apache/pig/test/TestPigRunner.java
@@ -46,11 +46,11 @@ import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.tools.pigstats.InputStats;
-import org.apache.pig.tools.pigstats.JobStats;
+import org.apache.pig.tools.pigstats.JobStatsBase;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil;
 import org.junit.AfterClass;
@@ -165,7 +165,7 @@ public class TestPigRunner {
             assertEquals(3, stats.getRecordWritten());       
             
             assertEquals("A,B,C",
-                    ((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
+                    ((JobStatsBase)stats.getJobGraph().getSinks().get(0)).getAlias());
             
             Configuration conf = ConfigurationUtil.toConfiguration(stats.getPigProperties());
             assertTrue(conf.getBoolean("stop.on.failure", false));           
@@ -201,7 +201,7 @@ public class TestPigRunner {
             assertEquals(3, stats.getRecordWritten());       
             
             assertEquals("A,B,C",
-                    ((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
+                    ((JobStatsBase)stats.getJobGraph().getSinks().get(0)).getAlias());
         } finally {
             new File(PIG_FILE).delete();
             Util.deleteFile(cluster, PIG_FILE);
@@ -224,7 +224,7 @@ public class TestPigRunner {
             assertTrue(stats.getJobGraph().size() == 4);
             assertTrue(stats.getJobGraph().getSinks().size() == 1);
             assertTrue(stats.getJobGraph().getSources().size() == 1);
-            JobStats js = (JobStats) stats.getJobGraph().getSinks().get(0);
+            JobStatsBase js = (JobStatsBase) stats.getJobGraph().getSinks().get(0);
             assertEquals(OUTPUT_FILE, js.getOutputs().get(0).getName());
             assertEquals(2, js.getOutputs().get(0).getNumberRecords());
             assertEquals(12, js.getOutputs().get(0).getBytes());
@@ -232,9 +232,9 @@ public class TestPigRunner {
             assertEquals(2, stats.getRecordWritten());
             assertEquals(12, stats.getBytesWritten());
             
-            assertEquals("A", ((JobStats) stats.getJobGraph().getSources().get(
+            assertEquals("A", ((JobStatsBase) stats.getJobGraph().getSources().get(
                     0)).getAlias());
-            assertEquals("B", ((JobStats) stats.getJobGraph().getPredecessors(
+            assertEquals("B", ((JobStatsBase) stats.getJobGraph().getPredecessors(
                     js).get(0)).getAlias());
             assertEquals("B", js.getAlias()); 
         } finally {
@@ -282,7 +282,7 @@ public class TestPigRunner {
                 }                
             }            
             assertEquals("A,B,C",
-                    ((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
+                    ((JobStatsBase)stats.getJobGraph().getSinks().get(0)).getAlias());
         } finally {
             new File(PIG_FILE).delete();
             Util.deleteFile(cluster, OUTPUT_FILE);
@@ -333,7 +333,7 @@ public class TestPigRunner {
                 }                
             }           
             assertEquals("A,B,C,D,E",
-                    ((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
+                    ((JobStatsBase)stats.getJobGraph().getSinks().get(0)).getAlias());
         } finally {
             new File(PIG_FILE).delete();
             Util.deleteFile(cluster, OUTPUT_FILE);
@@ -354,13 +354,13 @@ public class TestPigRunner {
         try {
             String[] args = { PIG_FILE };
             PigStats stats = PigRunner.run(args, null);
-            Iterator<JobStats> iter = stats.getJobGraph().iterator();
+            Iterator<JobStatsBase> iter = stats.getJobGraph().iterator();
             while (iter.hasNext()) {
-                 JobStats js=iter.next();
+                 JobStatsBase js=iter.next();
                  if(js.getState().name().equals("FAILED")) {
                      List<Operator> ops=stats.getJobGraph().getSuccessors(js);
                      for(Operator op : ops ) {
-                         assertEquals(((JobStats)op).getState().toString(), "UNKNOWN");
+                         assertEquals(((JobStatsBase)op).getState().toString(), "UNKNOWN");
                      }
                  }
             }
@@ -425,9 +425,9 @@ public class TestPigRunner {
             assertTrue(!stats.isSuccessful());            
             assertTrue(stats.getReturnCode() == ReturnCode.PARTIAL_FAILURE);
             assertTrue(stats.getJobGraph().size() == 2);
-            JobStats job = (JobStats)stats.getJobGraph().getSources().get(0);
+            JobStatsBase job = (JobStatsBase)stats.getJobGraph().getSources().get(0);
             assertTrue(job.isSuccessful());
-            job = (JobStats)stats.getJobGraph().getSinks().get(0);
+            job = (JobStatsBase)stats.getJobGraph().getSinks().get(0);
             assertTrue(!job.isSuccessful());
             assertTrue(stats.getOutputStats().size() == 3);
             for (OutputStats output : stats.getOutputStats()) {
@@ -450,7 +450,7 @@ public class TestPigRunner {
         context.connect();
         for (int i=0; i<100; i++) {
             String file = FileLocalizer.getTemporaryPath(context).toString();
-            assertTrue("not a temp file: " + file, PigStatsUtil.isTempFile(file));
+            assertTrue("not a temp file: " + file, PigStatsUtilBase.isTempFile(file));
         }
     }
     
@@ -916,7 +916,7 @@ public class TestPigRunner {
             int successfulJobs = 0;
             Iterator<Operator> it = stats.getJobGraph().getOperators();
             while (it.hasNext()){
-                JobStats js = (JobStats)it.next();
+                JobStatsBase js = (JobStatsBase)it.next();
                 if (js.isSuccessful())
                     successfulJobs++;
             }
@@ -954,12 +954,12 @@ public class TestPigRunner {
         }
 
         @Override
-        public void jobFailedNotification(String id, JobStats jobStats) {
+        public void jobFailedNotification(String id, JobStatsBase jobStats) {
             System.out.println("id: " + id + " job failed: " + jobStats.getJobId());           
         }
 
         @Override
-        public void jobFinishedNotification(String id, JobStats jobStats) {
+        public void jobFinishedNotification(String id, JobStatsBase jobStats) {
             System.out.println("id: " + id + " job finished: " + jobStats.getJobId()); 
             int[] nums = numMap.get(id);
             nums[JobFinished]++;            
diff --git a/test/org/apache/pig/test/TestScriptLanguage.java b/test/org/apache/pig/test/TestScriptLanguage.java
index cb7eb9d2d..d1df7f5a4 100644
--- a/test/org/apache/pig/test/TestScriptLanguage.java
+++ b/test/org/apache/pig/test/TestScriptLanguage.java
@@ -35,7 +35,7 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.scripting.ScriptEngine;
 import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.apache.pig.tools.pigstats.PigStatsUtilBase;
 import org.junit.After;
 import org.junit.AfterClass;
 import org.junit.Before;
@@ -665,7 +665,7 @@ public class TestScriptLanguage {
         
         createEmptyFiles(file1, file2);
         // Clear stats from previous execution
-        PigStatsUtil.getEmptyPigStats();
+        PigStatsUtilBase.getEmptyPigStats();
         
         // ExecMode.FILE
         stats = PigRunner.run(new String[] { "-f", scriptFile.getAbsolutePath(), "arg0", 
