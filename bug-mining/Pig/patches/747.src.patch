diff --git a/CHANGES.txt b/CHANGES.txt
index d7b0eb642..4aeb6b48b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -593,6 +593,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-2067: FilterLogicExpressionSimplifier removed some branches in some cases (daijy)
+
 PIG-2033: Pig returns sucess for the failed Pig script (rding)
 
 PIG-1993: PigStorageSchema throw NPE with ColumnPruning (daijy)
diff --git a/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java b/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
index 8cf8093ae..16687eccc 100644
--- a/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/ProjectExpression.java
@@ -404,7 +404,18 @@ public class ProjectExpression extends ColumnExpression {
     public boolean isEqual(Operator other) throws FrontendException {
         if (other != null && other instanceof ProjectExpression) {
             ProjectExpression po = (ProjectExpression)other;
-            return po.input == input && po.col == col;
+            if (po.input != input || po.col != col)
+                return false;
+            
+            Operator mySucc = getPlan().getSuccessors(this)!=null?
+                    getPlan().getSuccessors(this).get(0):null;
+            Operator theirSucc = other.getPlan().getSuccessors(other)!=null?
+                    other.getPlan().getSuccessors(other).get(0):null;
+            if (mySucc!=null && theirSucc!=null)
+                return mySucc.isEqual(theirSucc);
+            if (mySucc==null && theirSucc==null)
+                return true;
+            return false;
         } else {
             return false;
         }
diff --git a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
index 04f0acdf9..b31ee86c5 100644
--- a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
@@ -69,7 +69,18 @@ public class UserFuncExpression extends LogicalExpression {
     public boolean isEqual(Operator other) throws FrontendException {
         if( other instanceof UserFuncExpression ) {
             UserFuncExpression exp = (UserFuncExpression)other;
-            return mFuncSpec.equals(exp.mFuncSpec );
+            if (!mFuncSpec.equals(exp.mFuncSpec ))
+                return false;
+            
+            List<Operator> mySuccs = getPlan().getSuccessors(this);
+            List<Operator> theirSuccs = other.getPlan().getSuccessors(other);
+            if (mySuccs.size()!=theirSuccs.size())
+                return false;
+            for (int i=0;i<mySuccs.size();i++) {
+                if (!mySuccs.get(i).isEqual(theirSuccs.get(i)))
+                    return false;
+            }
+            return true;
         } else {
             return false;
         }
diff --git a/src/org/apache/pig/newplan/logical/relational/LogicalPlan.java b/src/org/apache/pig/newplan/logical/relational/LogicalPlan.java
index e06418b36..42c98d0b1 100644
--- a/src/org/apache/pig/newplan/logical/relational/LogicalPlan.java
+++ b/src/org/apache/pig/newplan/logical/relational/LogicalPlan.java
@@ -76,13 +76,12 @@ public class LogicalPlan extends BaseOperatorPlan {
         ps.println("# New Logical Plan:");
         ps.println("#-----------------------------------------------");
 
-        if (format.equals("text")) {
-            LogicalPlanPrinter npp = new LogicalPlanPrinter(this, ps);
-            npp.visit();
-        } else if (format.equals("dot")) {
+        if (format.equals("dot")) {
             DotLOPrinter lpp = new DotLOPrinter(this, ps);
             lpp.dump();
-            ps.println("");
+        } else {
+            LogicalPlanPrinter npp = new LogicalPlanPrinter(this, ps);
+            npp.visit();
         }
     }
 
diff --git a/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java b/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
index cba174f1f..4f1c780cd 100644
--- a/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
+++ b/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
@@ -18,6 +18,7 @@
 
 package org.apache.pig.newplan.logical.rules;
 
+import java.util.ArrayList;
 import java.util.List;
 import java.util.Iterator;
 
@@ -41,6 +42,8 @@ import org.apache.pig.newplan.optimizer.Transformer;
 
 public class LogicalExpressionSimplifier extends Rule {
 
+    private List<LOFilter> processedFilters = new ArrayList<LOFilter>();
+    
     enum DNFExpressionType {
         AND, OR
     }
@@ -51,15 +54,27 @@ public class LogicalExpressionSimplifier extends Rule {
 
     @Override
     public Transformer getNewTransformer() {
-        return new LogicalExpressionSimplifierTransformer();
+        return new LogicalExpressionSimplifierTransformer(processedFilters);
     }
 
     public static class LogicalExpressionSimplifierTransformer extends Transformer {
         private static final String dnfCountAnnotationKey = "dnfSplitCount";
         private OperatorPlan plan;
+        
+        private List<LOFilter> processedFilters;
 
+        public LogicalExpressionSimplifierTransformer(List<LOFilter> processedFilters) {
+            this.processedFilters = processedFilters;
+        }
         @Override
         public boolean check(OperatorPlan matched) throws FrontendException {
+            LOFilter filter = (LOFilter)matched.getOperators().next();
+            
+            // If the filter is already processed, we quit.
+            if (processedFilters.contains(filter))
+                return false;
+            
+            processedFilters.add(filter);
             return true;
         }
 
diff --git a/test/org/apache/pig/test/TestFilterSimplification.java b/test/org/apache/pig/test/TestFilterSimplification.java
index 614f41341..fedc28f47 100644
--- a/test/org/apache/pig/test/TestFilterSimplification.java
+++ b/test/org/apache/pig/test/TestFilterSimplification.java
@@ -479,6 +479,28 @@ public class TestFilterSimplification extends TestCase {
         expected = Util.buildLp(pigServer, query);;
 
         assertTrue(expected.isEqual(newLogicalPlan));
+        
+        // case 31: See PIG-2067
+        query = "A = load 'a.dat' as (cookie);" +
+                "B = load 'b.dat' as (cookie);" +
+                "C = cogroup A by cookie, B by cookie;" +
+                "E = filter C by COUNT(B)>0 AND COUNT(A)>0;" +
+                "store E into 'empty';";
+        newLogicalPlan = Util.buildLp(pigServer, query);;
+
+        optimizer = new MyPlanOptimizer(newLogicalPlan, 10);
+        optimizer.optimize();
+
+        // Make sure in this case, we don't optimize
+        query = "A = load 'a.dat' as (cookie);" +
+            "B = load 'b.dat' as (cookie);" +
+            "C = cogroup A by cookie, B by cookie;" +
+            "E = filter C by COUNT(B)>0 AND COUNT(A)>0;" +
+            "store E into 'empty';";
+        
+        expected = Util.buildLp(pigServer, query);;
+
+        assertTrue(expected.isEqual(newLogicalPlan));
 
     }
 
