diff --git a/CHANGES.txt b/CHANGES.txt
index 1a29ae366..3cfdf3bf1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -249,6 +249,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-3132: NPE when illustrating a relation with HCatLoader (daijy)
+
 PIG-3194: Changes to ObjectSerializer.java break compatibility with Hadoop 0.20.2 (prkommireddi via dvryaboy)
 
 PIG-3241: ConcurrentModificationException in POPartialAgg (dvryaboy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLoad.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLoad.java
index 7eb00942c..55bd89624 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLoad.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POLoad.java
@@ -93,7 +93,7 @@ public class POLoad extends PhysicalOperator {
         loader = new ReadToEndLoader((LoadFunc)
                 PigContext.instantiateFuncFromSpec(lFile.getFuncSpec()), 
                 ConfigurationUtil.toConfiguration(pc.getProperties()), 
-                lFile.getFileName(),0);
+                lFile.getFileName(),0, signature);
     }
     
     /**
diff --git a/src/org/apache/pig/impl/io/ReadToEndLoader.java b/src/org/apache/pig/impl/io/ReadToEndLoader.java
index ec64eb478..8435a3590 100644
--- a/src/org/apache/pig/impl/io/ReadToEndLoader.java
+++ b/src/org/apache/pig/impl/io/ReadToEndLoader.java
@@ -106,6 +106,8 @@ public class ReadToEndLoader extends LoadFunc implements LoadMetadata {
     private InputFormat inputFormat = null;
     
     private PigContext pigContext;
+    
+    private String udfContextSignature = null;
 
     /**
      * @param wrappedLoadFunc
@@ -133,6 +135,16 @@ public class ReadToEndLoader extends LoadFunc implements LoadMetadata {
         this.pigContext = pigContext;
         init();
     }
+    
+    public ReadToEndLoader(LoadFunc wrappedLoadFunc, Configuration conf,
+            String inputLocation, int splitIndex, String signature) throws IOException {
+        this.udfContextSignature = signature;
+        this.wrappedLoadFunc = wrappedLoadFunc;
+        this.inputLocation = inputLocation;
+        this.conf = conf;
+        this.curSplitIndex = splitIndex;
+        init();
+    }
 
     /**
      * This constructor takes an array of split indexes (toReadSplitIdxs) of the 
@@ -167,6 +179,7 @@ public class ReadToEndLoader extends LoadFunc implements LoadMetadata {
 
         // let's initialize the wrappedLoadFunc 
         Job job = new Job(conf);
+        wrappedLoadFunc.setUDFContextSignature(this.udfContextSignature);
         wrappedLoadFunc.setLocation(inputLocation, 
                 job);
         // The above setLocation call could write to the conf within
@@ -277,7 +290,7 @@ public class ReadToEndLoader extends LoadFunc implements LoadMetadata {
 
     @Override
     public void setLocation(String location, Job job) throws IOException {
-        //no-op
+        wrappedLoadFunc.setLocation(location, job);
     }
 
     @Override
@@ -313,4 +326,9 @@ public class ReadToEndLoader extends LoadFunc implements LoadMetadata {
              ((LoadMetadata) wrappedLoadFunc).setPartitionFilter(partitionFilter);
         }
     }
+    
+    @Override
+    public void setUDFContextSignature(String signature) {
+        this.udfContextSignature = signature;
+    }
 }
diff --git a/src/org/apache/pig/pen/LocalMapReduceSimulator.java b/src/org/apache/pig/pen/LocalMapReduceSimulator.java
index 2e3971a7c..416c78fd0 100644
--- a/src/org/apache/pig/pen/LocalMapReduceSimulator.java
+++ b/src/org/apache/pig/pen/LocalMapReduceSimulator.java
@@ -105,6 +105,7 @@ public class LocalMapReduceSimulator {
         // jc is null only when mrp.size == 0
         boolean needFileInput;
         final ArrayList<OperatorKey> emptyInpTargets = new ArrayList<OperatorKey>();
+        pc.getProperties().setProperty("pig.illustrating", "true");
         while(mrp.size() != 0) {
             jc = jcc.compile(mrp, "Illustrator");
             if(jc == null) {
diff --git a/test/org/apache/pig/test/TestExampleGenerator.java b/test/org/apache/pig/test/TestExampleGenerator.java
index 4246b655e..f9b5203c4 100644
--- a/test/org/apache/pig/test/TestExampleGenerator.java
+++ b/test/org/apache/pig/test/TestExampleGenerator.java
@@ -33,6 +33,7 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.data.DataBag;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.newplan.Operator;
+import org.apache.pig.test.utils.UDFContextTestLoaderWithSignature;
 import org.junit.BeforeClass;
 import org.junit.Test;
 
@@ -394,5 +395,14 @@ public class TestExampleGenerator {
     
         assertNotNull(derivedData);
     }
+    
+    @Test
+    public void testLoaderWithContext() throws Exception {
+        PigServer pigServer = new PigServer(pigContext);
+        pigServer.registerQuery("A = load " + A.toString() + " using " + UDFContextTestLoaderWithSignature.class.getName() + "('a') as (x, y);");
+        Map<Operator, DataBag> derivedData = pigServer.getExamples("A");
+        
+        assertNotNull(derivedData);
+    }
 
 }
