diff --git a/CHANGES.txt b/CHANGES.txt
index 5b2925cfa..12f9323c8 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -58,6 +58,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4118: Fix hadoopversion 23 compilation due to TEZ-1237/TEZ-1407 (daijy)
+
 PIG-4109: register local jar fail on Windows when Pig script is remote (daijy)
 
 PIG-4116: Update Pig doc about Hadoop 2 Streaming Python UDF support (cheolsoo)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/POStoreTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/POStoreTez.java
index f916b4f47..26fcecb04 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/POStoreTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/POStoreTez.java
@@ -32,7 +32,7 @@ import org.apache.tez.common.counters.CounterGroup;
 import org.apache.tez.common.counters.TezCounter;
 import org.apache.tez.mapreduce.output.MROutput;
 import org.apache.tez.runtime.api.LogicalOutput;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 import org.apache.tez.runtime.library.api.KeyValueWriter;
 
 /**
@@ -70,7 +70,7 @@ public class POStoreTez extends POStore implements TezOutput, TezTaskConfigurabl
     }
 
     @Override
-    public void initialize(TezProcessorContext processorContext)
+    public void initialize(ProcessorContext processorContext)
             throws ExecException {
         if (isMultiStore()) {
             CounterGroup multiStoreGroup = processorContext.getCounters()
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/POValueOutputTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/POValueOutputTez.java
index 1fb9e06fa..283bb3727 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/POValueOutputTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/POValueOutputTez.java
@@ -40,7 +40,7 @@ import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.tez.runtime.api.LogicalOutput;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 import org.apache.tez.runtime.library.api.KeyValueWriter;
 
 public class POValueOutputTez extends PhysicalOperator implements TezOutput, TezTaskConfigurable {
@@ -81,7 +81,7 @@ public class POValueOutputTez extends PhysicalOperator implements TezOutput, Tez
     }
 
     @Override
-    public void initialize(TezProcessorContext processorContext)
+    public void initialize(ProcessorContext processorContext)
             throws ExecException {
         taskIndex = processorContext.getTaskIndex();
     }
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
index 427f0df5b..265ddd507 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
@@ -23,7 +23,7 @@ import java.util.Map;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
-import org.apache.tez.dag.api.EdgeManagerDescriptor;
+import org.apache.tez.dag.api.EdgeManagerPluginDescriptor;
 import org.apache.tez.dag.api.InputDescriptor;
 import org.apache.tez.dag.api.VertexManagerPlugin;
 import org.apache.tez.dag.api.VertexManagerPluginContext;
@@ -87,11 +87,11 @@ public class PartitionerDefinedVertexManager extends VertexManagerPlugin {
             if (dynamicParallelism!=currentParallelism) {
                 LOG.info("Pig Partitioner Defined Vertex Manager: reset parallelism to " + dynamicParallelism
                         + " from " + currentParallelism);
-                Map<String, EdgeManagerDescriptor> edgeManagers =
-                    new HashMap<String, EdgeManagerDescriptor>();
+                Map<String, EdgeManagerPluginDescriptor> edgeManagers =
+                    new HashMap<String, EdgeManagerPluginDescriptor>();
                 for(String vertex : getContext().getInputVertexEdgeProperties().keySet()) {
-                    EdgeManagerDescriptor edgeManagerDescriptor =
-                            new EdgeManagerDescriptor(ScatterGatherEdgeManager.class.getName());
+                    EdgeManagerPluginDescriptor edgeManagerDescriptor =
+                            new EdgeManagerPluginDescriptor(ScatterGatherEdgeManager.class.getName());
                     edgeManagers.put(vertex, edgeManagerDescriptor);
                 }
                 getContext().setVertexParallelism(dynamicParallelism, null, edgeManagers, null);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
index 6fd2c09f4..53b5ed546 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
@@ -57,7 +57,7 @@ import org.apache.tez.runtime.api.AbstractLogicalIOProcessor;
 import org.apache.tez.runtime.api.Event;
 import org.apache.tez.runtime.api.LogicalInput;
 import org.apache.tez.runtime.api.LogicalOutput;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 import org.apache.tez.runtime.api.events.VertexManagerEvent;
 import org.apache.tez.runtime.library.api.KeyValueReader;
 
@@ -96,7 +96,7 @@ public class PigProcessor extends AbstractLogicalIOProcessor {
     public static String sampleVertex;
     public static Map<String, Object> sampleMap;
 
-    public PigProcessor(TezProcessorContext context) {
+    public PigProcessor(ProcessorContext context) {
         super(context);
     }
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
index 11618400e..7a9cb0a0b 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
@@ -107,7 +107,7 @@ import org.apache.tez.dag.api.DAG;
 import org.apache.tez.dag.api.DataSinkDescriptor;
 import org.apache.tez.dag.api.DataSourceDescriptor;
 import org.apache.tez.dag.api.Edge;
-import org.apache.tez.dag.api.EdgeManagerDescriptor;
+import org.apache.tez.dag.api.EdgeManagerPluginDescriptor;
 import org.apache.tez.dag.api.EdgeProperty;
 import org.apache.tez.dag.api.EdgeProperty.DataMovementType;
 import org.apache.tez.dag.api.GroupInputEdge;
@@ -129,6 +129,7 @@ import org.apache.tez.mapreduce.hadoop.MRJobConfig;
 import org.apache.tez.mapreduce.input.MRInput;
 import org.apache.tez.mapreduce.output.MROutput;
 import org.apache.tez.mapreduce.partition.MRPartitioner;
+import org.apache.tez.mapreduce.protos.MRRuntimeProtos;
 import org.apache.tez.runtime.library.api.TezRuntimeConfiguration;
 import org.apache.tez.runtime.library.input.ConcatenatedMergedKeyValueInput;
 import org.apache.tez.runtime.library.input.ShuffledMergedInput;
@@ -342,7 +343,7 @@ public class TezDagBuilder extends TezOpPlanVisitor {
 
         if (edge.dataMovementType!=DataMovementType.BROADCAST && to.getEstimatedParallelism()!=-1 && (to.isGlobalSort()||to.isSkewedJoin())) {
             // Use custom edge
-            return new EdgeProperty((EdgeManagerDescriptor)null,
+            return new EdgeProperty((EdgeManagerPluginDescriptor)null,
                     edge.dataSourceType, edge.schedulingType, out, in);
             }
 
@@ -596,9 +597,9 @@ public class TezDagBuilder extends TezOpPlanVisitor {
             vertex.setLocationHint(new VertexLocationHint(tezOp.getLoaderInfo().getInputSplitInfo().getTaskLocationHints()));
             vertex.addDataSource(ld.getOperatorKey().toString(),
                     new DataSourceDescriptor(new InputDescriptor(MRInput.class.getName())
-                            .setUserPayload(MRHelpers.createMRInputPayload(
-                                    payloadConf,
-                                    tezOp.getLoaderInfo().getInputSplitInfo().getSplitsProto())),
+                            .setUserPayload(MRRuntimeProtos.MRInputUserPayloadProto.newBuilder()
+                            .setConfigurationBytes(TezUtils.createByteStringFromConf(payloadConf))
+                            .setSplits(tezOp.getLoaderInfo().getInputSplitInfo().getSplitsProto()).build().toByteArray()),
                     new InputInitializerDescriptor(MRInputSplitDistributor.class.getName()), dag.getCredentials()));
         }
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskConfigurable.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskConfigurable.java
index 18095664d..f4ebc7871 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskConfigurable.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskConfigurable.java
@@ -19,7 +19,7 @@
 package org.apache.pig.backend.hadoop.executionengine.tez;
 
 import org.apache.pig.backend.executionengine.ExecException;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 
 /**
  * This interface is implemented by PhysicalOperators that can need to access
@@ -28,6 +28,6 @@ import org.apache.tez.runtime.api.TezProcessorContext;
 
 public interface TezTaskConfigurable {
 
-    public void initialize(TezProcessorContext processorContext) throws ExecException;
+    public void initialize(ProcessorContext processorContext) throws ExecException;
 
 }
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskContext.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskContext.java
index 098a7f46c..af6b21b74 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskContext.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezTaskContext.java
@@ -21,17 +21,17 @@ import org.apache.hadoop.mapreduce.Counter;
 import org.apache.pig.backend.hadoop.executionengine.TaskContext;
 import org.apache.tez.common.counters.TezCounter;
 import org.apache.tez.mapreduce.hadoop.mapred.MRCounters.MRCounter;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 
-public class TezTaskContext extends TaskContext<TezProcessorContext> {
-    private TezProcessorContext context;
+public class TezTaskContext extends TaskContext<ProcessorContext> {
+    private ProcessorContext context;
 
-    public TezTaskContext(TezProcessorContext context) {
+    public TezTaskContext(ProcessorContext context) {
         this.context = context;
     }
 
     @Override
-    public TezProcessorContext get() {
+    public ProcessorContext get() {
         return context;
     }
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
index d31f9019e..db5f88245 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
@@ -36,7 +36,7 @@ import org.apache.pig.backend.hadoop.executionengine.tez.TezTaskConfigurable;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.tez.runtime.api.LogicalOutput;
-import org.apache.tez.runtime.api.TezProcessorContext;
+import org.apache.tez.runtime.api.ProcessorContext;
 import org.apache.tez.runtime.library.api.KeyValueWriter;
 
 public class POCounterTez extends POCounter implements TezOutput, TezTaskConfigurable {
@@ -56,7 +56,7 @@ public class POCounterTez extends POCounter implements TezOutput, TezTaskConfigu
     }
 
     @Override
-    public void initialize(TezProcessorContext processorContext)
+    public void initialize(ProcessorContext processorContext)
             throws ExecException {
         this.setTaskId(processorContext.getTaskIndex());
     }
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/LoaderProcessor.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/LoaderProcessor.java
index ea0517910..22e16756d 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/LoaderProcessor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/LoaderProcessor.java
@@ -41,7 +41,7 @@ import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.pig.impl.util.ObjectSerializer;
 import org.apache.pig.impl.util.UDFContext;
-import org.apache.tez.mapreduce.hadoop.MRHelpers;
+import org.apache.tez.mapreduce.hadoop.MRInputHelpers;
 
 public class LoaderProcessor extends TezOpPlanVisitor {
     private Configuration conf;
@@ -130,7 +130,7 @@ public class LoaderProcessor extends TezOpPlanVisitor {
             tezOp.getLoaderInfo().setInpLimits(inpLimits);
             // Not using MRInputAMSplitGenerator because delegation tokens are
             // fetched in FileInputFormat
-            tezOp.getLoaderInfo().setInputSplitInfo(MRHelpers.generateInputSplitsToMem(conf, false, 0));
+            tezOp.getLoaderInfo().setInputSplitInfo(MRInputHelpers.generateInputSplitsToMem(conf, false, 0));
         }
         return lds;
     }
