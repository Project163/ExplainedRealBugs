diff --git a/CHANGES.txt b/CHANGES.txt
index 83fc3498d..dfc1666d1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -110,6 +110,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4250: Fix Security Risks found by Coverity (daijy)
+
 PIG-4258: Fix several e2e tests on Windows (daijy)
 
 PIG-4256: Fix StreamingPythonUDFs e2e test failure on Windows (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/accumulo/AccumuloBinaryConverter.java b/src/org/apache/pig/backend/hadoop/accumulo/AccumuloBinaryConverter.java
index 2532a4530..9d6ba5e08 100644
--- a/src/org/apache/pig/backend/hadoop/accumulo/AccumuloBinaryConverter.java
+++ b/src/org/apache/pig/backend/hadoop/accumulo/AccumuloBinaryConverter.java
@@ -172,9 +172,12 @@ public class AccumuloBinaryConverter implements LoadStoreCaster {
 
         len = len ^ 0x80000000;
 
-        dos.writeInt(len);
-        dos.write(bytes);
-        dos.close();
+        try {
+            dos.writeInt(len);
+            dos.write(bytes);
+        } finally {
+            dos.close();
+        }
 
         return ret;
     }
diff --git a/src/org/apache/pig/backend/hadoop/accumulo/Utils.java b/src/org/apache/pig/backend/hadoop/accumulo/Utils.java
index 81e92d34a..ccbcaaf4b 100644
--- a/src/org/apache/pig/backend/hadoop/accumulo/Utils.java
+++ b/src/org/apache/pig/backend/hadoop/accumulo/Utils.java
@@ -297,8 +297,6 @@ public class Utils {
             zos.write(arr, 0, read);
             read = is.read(arr);
         }
-        is.close();
-        zos.closeEntry();
     }
 
     public static void jarDir(File dir, String relativePath, ZipOutputStream zos)
@@ -317,7 +315,16 @@ public class Utils {
             zos.closeEntry();
         } else {
             InputStream is = new FileInputStream(manifestFile);
-            copyToZipStream(is, manifestEntry, zos);
+            try {
+                copyToZipStream(is, manifestEntry, zos);
+            } finally {
+                if (is != null) {
+                    is.close();
+                }
+                if (zos != null) {
+                    zos.closeEntry();
+                }
+            }
         }
         zos.closeEntry();
         zipDir(dir, relativePath, zos, true);
@@ -345,7 +352,16 @@ public class Utils {
                     if (!path.equals(JarFile.MANIFEST_NAME)) {
                         ZipEntry anEntry = new ZipEntry(path);
                         InputStream is = new FileInputStream(f);
-                        copyToZipStream(is, anEntry, zos);
+                        try {
+                            copyToZipStream(is, anEntry, zos);
+                        } finally {
+                            if (is != null) {
+                                is.close();
+                            }
+                            if (zos != null) {
+                                zos.closeEntry();
+                            }
+                        }
                     }
                 }
             }
diff --git a/src/org/apache/pig/backend/hadoop/hbase/HBaseBinaryConverter.java b/src/org/apache/pig/backend/hadoop/hbase/HBaseBinaryConverter.java
index 82969a782..b23fd198f 100644
--- a/src/org/apache/pig/backend/hadoop/hbase/HBaseBinaryConverter.java
+++ b/src/org/apache/pig/backend/hadoop/hbase/HBaseBinaryConverter.java
@@ -93,7 +93,7 @@ public class HBaseBinaryConverter implements LoadStoreCaster {
 
     @Override
     public Map<String, Object> bytesToMap(byte[] b, ResourceFieldSchema fieldSchema) throws IOException {
-        return bytesToMap(b, fieldSchema);
+        throw new ExecException("Can't generate a Map from byte[]");
     }
 
     /**
diff --git a/src/org/apache/pig/builtin/AvroStorage.java b/src/org/apache/pig/builtin/AvroStorage.java
index dfe484576..d77fda4da 100644
--- a/src/org/apache/pig/builtin/AvroStorage.java
+++ b/src/org/apache/pig/builtin/AvroStorage.java
@@ -596,7 +596,11 @@ public class AvroStorage extends LoadFunc
         } else {
           rr = new AvroRecordReader(s);
         }
-        rr.initialize(is, tc);
+        try {
+            rr.initialize(is, tc);
+        } finally {
+            rr.close();
+        }
         tc.setStatus(is.toString());
         return rr;
       }
diff --git a/src/org/apache/pig/builtin/Bloom.java b/src/org/apache/pig/builtin/Bloom.java
index dad469fd9..290bd0a32 100644
--- a/src/org/apache/pig/builtin/Bloom.java
+++ b/src/org/apache/pig/builtin/Bloom.java
@@ -105,7 +105,12 @@ public class Bloom extends FilterFunc {
                 });
 
         String dcFile = dir + "/" + partFiles[0];
-        filter.readFields(new DataInputStream(new FileInputStream(dcFile)));
+        DataInputStream dis = new DataInputStream(new FileInputStream(dcFile));
+        try {
+            filter.readFields(dis);
+        } finally {
+            dis.close();
+        }
     }
 
     /**
diff --git a/src/org/apache/pig/builtin/TextLoader.java b/src/org/apache/pig/builtin/TextLoader.java
index e916b4564..3ca6f3880 100644
--- a/src/org/apache/pig/builtin/TextLoader.java
+++ b/src/org/apache/pig/builtin/TextLoader.java
@@ -148,7 +148,9 @@ public class TextLoader extends LoadFunc implements LoadCaster {
 
     @Override
     public Map<String, Object> bytesToMap(byte[] b, ResourceFieldSchema schema) throws IOException {
-        return bytesToMap(b, schema);
+        int errCode = 2109;
+        String msg = "TextLoader does not support conversion to Map.";
+        throw new ExecException(msg, errCode, PigException.BUG);
     }
 
     /**
diff --git a/src/org/apache/pig/data/DistinctDataBag.java b/src/org/apache/pig/data/DistinctDataBag.java
index 4a5599ca9..9e4ca95f9 100644
--- a/src/org/apache/pig/data/DistinctDataBag.java
+++ b/src/org/apache/pig/data/DistinctDataBag.java
@@ -516,19 +516,27 @@ public class DistinctDataBag extends DefaultAbstractBag {
                     // the spill files list.  So I need to append it to my
                     // linked list as well so that it's still there when I
                     // move my linked list back to the spill files.
+                    DataOutputStream out = null;
                     try {
-                        DataOutputStream out = getSpillFile();
+                        out = getSpillFile();
                         ll.add(mSpillFiles.get(mSpillFiles.size() - 1));
                         Tuple t;
                         while ((t = readFromTree()) != null) {
                             t.write(out);
                         }
                         out.flush();
-                        out.close();
                     } catch (IOException ioe) {
                         String msg = "Unable to find our spill file.";
                         log.fatal(msg, ioe);
                         throw new RuntimeException(msg, ioe);
+                    } finally {
+                        if (out != null) {
+                            try {
+                                out.close();
+                            } catch (IOException e) {
+                                warn("Error closing spill", PigWarning.UNABLE_TO_CLOSE_SPILL_FILE, e);
+                            }
+                        }
                     }
                 }
                 // delete files that have been merged into new files
diff --git a/src/org/apache/pig/data/InternalDistinctBag.java b/src/org/apache/pig/data/InternalDistinctBag.java
index bbb008f9d..c45976d45 100644
--- a/src/org/apache/pig/data/InternalDistinctBag.java
+++ b/src/org/apache/pig/data/InternalDistinctBag.java
@@ -36,6 +36,7 @@ import java.util.TreeSet;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pig.PigConfiguration;
+import org.apache.pig.PigWarning;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce;
 import org.apache.pig.classification.InterfaceAudience;
 import org.apache.pig.classification.InterfaceStability;
@@ -424,19 +425,25 @@ public class InternalDistinctBag extends SortedSpillBag {
                     // the spill files list.  So I need to append it to my
                     // linked list as well so that it's still there when I
                     // move my linked list back to the spill files.
+                    DataOutputStream out = null;
                     try {
-                        DataOutputStream out = getSpillFile();
+                        out = getSpillFile();
                         ll.add(mSpillFiles.get(mSpillFiles.size() - 1));
                         Tuple t;
                         while ((t = readFromTree()) != null) {
                             t.write(out);
                         }
                         out.flush();
-                        out.close();
                     } catch (IOException ioe) {
                         String msg = "Unable to find our spill file.";
                         log.fatal(msg, ioe);
                         throw new RuntimeException(msg, ioe);
+                    } finally {
+                        try {
+                            out.close();
+                        } catch (IOException e) {
+                            warn("Error closing spill", PigWarning.UNABLE_TO_CLOSE_SPILL_FILE, e);
+                        }
                     }
                 }
 
diff --git a/src/org/apache/pig/data/InternalSortedBag.java b/src/org/apache/pig/data/InternalSortedBag.java
index b58cd3ed9..a1b244658 100644
--- a/src/org/apache/pig/data/InternalSortedBag.java
+++ b/src/org/apache/pig/data/InternalSortedBag.java
@@ -35,6 +35,7 @@ import java.util.PriorityQueue;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.pig.PigWarning;
 
 
 /**
@@ -401,19 +402,27 @@ public class InternalSortedBag extends SortedSpillBag{
                     // the spill files list.  So I need to append it to my
                     // linked list as well so that it's still there when I
                     // move my linked list back to the spill files.
+                    DataOutputStream out = null;
                     try {
-                        DataOutputStream out = getSpillFile();
+                        out = getSpillFile();
                         ll.add(mSpillFiles.get(mSpillFiles.size() - 1));
                         Tuple t;
                         while ((t = readFromPriorityQ()) != null) {
                             t.write(out);
                         }
                         out.flush();
-                        out.close();
                     } catch (IOException ioe) {
                         String msg = "Unable to find our spill file.";
                         log.fatal(msg, ioe);
                         throw new RuntimeException(msg, ioe);
+                    } finally {
+                        if (out != null) {
+                            try {
+                                out.close();
+                            } catch (IOException e) {
+                                warn("Error closing spill", PigWarning.UNABLE_TO_CLOSE_SPILL_FILE, e);
+                            }
+                        }
                     }
                 }
                 // delete files that have been merged into new files
diff --git a/src/org/apache/pig/data/SchemaTupleBackend.java b/src/org/apache/pig/data/SchemaTupleBackend.java
index fdeccc7ad..a4a630d96 100644
--- a/src/org/apache/pig/data/SchemaTupleBackend.java
+++ b/src/org/apache/pig/data/SchemaTupleBackend.java
@@ -184,14 +184,22 @@ public class SchemaTupleBackend {
             LOG.info("Attempting to read file: " + s);
             // The string is the symlink into the distributed cache
             File src = new File(s);
-            FileInputStream fin = new FileInputStream(src);
-            FileOutputStream fos = new FileOutputStream(new File(codeDir, s));
-
-            fin.getChannel().transferTo(0, src.length(), fos.getChannel());
-
-            fin.close();
-            fos.close();
-            LOG.info("Successfully copied file to local directory.");
+            FileInputStream fin = null;
+            FileOutputStream fos = null;
+            try {
+                fin = new FileInputStream(src);
+                fos = new FileOutputStream(new File(codeDir, s));
+    
+                fin.getChannel().transferTo(0, src.length(), fos.getChannel());
+                LOG.info("Successfully copied file to local directory.");
+            } finally {
+                if (fin != null) {
+                    fin.close();
+                }
+                if (fos != null) {
+                    fos.close();
+                }
+            }
         }
     }
 
diff --git a/src/org/apache/pig/data/SortedDataBag.java b/src/org/apache/pig/data/SortedDataBag.java
index 5740b54d4..e33dd2468 100644
--- a/src/org/apache/pig/data/SortedDataBag.java
+++ b/src/org/apache/pig/data/SortedDataBag.java
@@ -491,19 +491,25 @@ public class SortedDataBag extends DefaultAbstractBag{
                     // the spill files list.  So I need to append it to my
                     // linked list as well so that it's still there when I
                     // move my linked list back to the spill files.
+                    DataOutputStream out = null;
                     try {
-                        DataOutputStream out = getSpillFile();
+                        out = getSpillFile();
                         ll.add(mSpillFiles.get(mSpillFiles.size() - 1));
                         Tuple t;
                         while ((t = readFromPriorityQ()) != null) {
                             t.write(out);
                         }
                         out.flush();
-                        out.close();
                     } catch (IOException ioe) {
                         String msg = "Unable to find our spill file.";
                         log.fatal(msg, ioe);
                         throw new RuntimeException(msg, ioe);
+                    } finally {
+                        try {
+                            out.close();
+                        } catch (IOException e) {
+                            warn("Error closing spill", PigWarning.UNABLE_TO_CLOSE_SPILL_FILE, e);
+                        }
                     }
                 }
                 // delete files that have been merged into new files
diff --git a/src/org/apache/pig/impl/io/FileLocalizer.java b/src/org/apache/pig/impl/io/FileLocalizer.java
index ebe1a99f7..f0f9b4383 100644
--- a/src/org/apache/pig/impl/io/FileLocalizer.java
+++ b/src/org/apache/pig/impl/io/FileLocalizer.java
@@ -862,14 +862,20 @@ public class FileLocalizer {
         dest.getParentFile().mkdirs();
         dest.deleteOnExit();
 
-        OutputStream outputStream = new BufferedOutputStream(new FileOutputStream(dest));
-        byte[] buffer = new byte[1024];
-        int len;
-        while ((len=resourceStream.read(buffer)) > 0) {
-          outputStream.write(buffer,0,len);
+        OutputStream outputStream = null;
+        try {
+            outputStream = new BufferedOutputStream(new FileOutputStream(dest));
+            byte[] buffer = new byte[1024];
+            int len;
+            while ((len=resourceStream.read(buffer)) > 0) {
+              outputStream.write(buffer,0,len);
+            }
+        } finally {
+            resourceStream.close();
+            if (outputStream != null) {
+                outputStream.close();
+            }
         }
-        outputStream.close();
-
         localFileRet = new FetchFileRet(dest,false);
       }
       else
diff --git a/src/org/apache/pig/impl/util/JarManager.java b/src/org/apache/pig/impl/util/JarManager.java
index cf90e1434..aa90c6288 100644
--- a/src/org/apache/pig/impl/util/JarManager.java
+++ b/src/org/apache/pig/impl/util/JarManager.java
@@ -90,9 +90,16 @@ public class JarManager {
         createPigScriptUDFJar(fos, pigContext, contents);
 
         if (!contents.isEmpty()) {
-            FileInputStream fis = new FileInputStream(scriptUDFJarFile);
-            String md5 = org.apache.commons.codec.digest.DigestUtils.md5Hex(fis);
-            fis.close();
+            FileInputStream fis = null;
+            String md5 = null;
+            try {
+                fis = new FileInputStream(scriptUDFJarFile);
+                md5 = org.apache.commons.codec.digest.DigestUtils.md5Hex(fis);
+            } finally {
+                if (fis != null) {
+                    fis.close();
+                }
+            }
             File newScriptUDFJarFile = new File(scriptUDFJarFile.getParent(), "PigScriptUDF-" + md5 + ".jar");
             scriptUDFJarFile.renameTo(newScriptUDFJarFile);
             return newScriptUDFJarFile;
@@ -114,7 +121,11 @@ public class JarManager {
             if (stream==null) {
                 throw new IOException("Cannot find " + path);
             }
-            addStream(jarOutputStream, path, stream, contents, inputFile.lastModified());
+            try {
+                addStream(jarOutputStream, path, stream, contents, inputFile.lastModified());
+            } finally {
+                stream.close();
+            }
         }
         for (Map.Entry<String, File> entry : pigContext.getScriptFiles().entrySet()) {
             log.debug("Adding entry " + entry.getKey() + " to job jar" );
@@ -127,7 +138,11 @@ public class JarManager {
             if (stream==null) {
                 throw new IOException("Cannot find " + entry.getValue().getPath());
             }
-            addStream(jarOutputStream, entry.getKey(), stream, contents, entry.getValue().lastModified());
+            try {
+                addStream(jarOutputStream, entry.getKey(), stream, contents, entry.getValue().lastModified());
+            } finally {
+                stream.close();
+            }
         }
         if (!contents.isEmpty()) {
             jarOutputStream.close();
diff --git a/src/org/apache/pig/parser/QueryParserDriver.java b/src/org/apache/pig/parser/QueryParserDriver.java
index 6dc88ba95..bd899fc84 100644
--- a/src/org/apache/pig/parser/QueryParserDriver.java
+++ b/src/org/apache/pig/parser/QueryParserDriver.java
@@ -574,6 +574,7 @@ public class QueryParserDriver {
 
             String macroText = null;
             try {
+                in.close();
                 in = new BufferedReader(new StringReader(sb.toString()));
                 macroText = pigContext.doParamSubstitution(in);
             } catch (IOException e) {
diff --git a/src/org/apache/pig/scripting/Pig.java b/src/org/apache/pig/scripting/Pig.java
index 7f624a86e..06d607f6a 100644
--- a/src/org/apache/pig/scripting/Pig.java
+++ b/src/org/apache/pig/scripting/Pig.java
@@ -349,13 +349,16 @@ public class Pig {
     private static String getScriptFromFile(String filename) throws IOException {
         LineNumberReader rd = new LineNumberReader(new FileReader(filename));
         StringBuilder sb = new StringBuilder();
-        String line = rd.readLine();
-        while (line != null) {
-            sb.append(line);
-            sb.append("\n");
-            line = rd.readLine();
+        try {
+            String line = rd.readLine();
+            while (line != null) {
+                sb.append(line);
+                sb.append("\n");
+                line = rd.readLine();
+            }
+        } finally {
+            rd.close();
         }
-        rd.close();
         return sb.toString();
     }
 
diff --git a/src/org/apache/pig/scripting/jython/JythonScriptEngine.java b/src/org/apache/pig/scripting/jython/JythonScriptEngine.java
index 33c97dfb1..688b577c7 100644
--- a/src/org/apache/pig/scripting/jython/JythonScriptEngine.java
+++ b/src/org/apache/pig/scripting/jython/JythonScriptEngine.java
@@ -409,13 +409,15 @@ public class JythonScriptEngine extends ScriptEngine {
             throw new IOException("Can't read file: " + scriptFile);
         }
 
-        // TODO: fis1 is not closed
         FileInputStream fis1 = new FileInputStream(scriptFile);
-        if (hasFunction(fis1)) {
-            registerFunctions(scriptFile, null, pigContext);
+        try {
+            if (hasFunction(fis1)) {
+                registerFunctions(scriptFile, null, pigContext);
+            }
+        } finally {
+            fis1.close();
         }
 
-        
         Interpreter.setMain(true);
         FileInputStream fis = new FileInputStream(scriptFile);
         try {
diff --git a/src/org/apache/pig/scripting/streaming/python/PythonScriptEngine.java b/src/org/apache/pig/scripting/streaming/python/PythonScriptEngine.java
index 90a9fea7b..2a9b2153a 100644
--- a/src/org/apache/pig/scripting/streaming/python/PythonScriptEngine.java
+++ b/src/org/apache/pig/scripting/streaming/python/PythonScriptEngine.java
@@ -56,7 +56,12 @@ public class PythonScriptEngine extends ScriptEngine {
         }
         
         FileInputStream fin = new FileInputStream(f);
-        List<String[]> functions = getFunctions(fin);
+        List<String[]> functions = null;
+        try {
+            functions = getFunctions(fin);
+        } finally {
+            fin.close();
+        }
         namespace = namespace == null ? "" : namespace + NAMESPACE_SEPARATOR;
         for(String[] functionInfo : functions) {
             String name = functionInfo[0];
@@ -75,7 +80,6 @@ public class PythonScriptEngine extends ScriptEngine {
                                                     execType, isIllustrate
                                         }));
         }
-        fin.close();
     }
 
     @Override
diff --git a/src/org/apache/pig/tools/grunt/GruntParser.java b/src/org/apache/pig/tools/grunt/GruntParser.java
index 3c278baf9..084eee1d1 100644
--- a/src/org/apache/pig/tools/grunt/GruntParser.java
+++ b/src/org/apache/pig/tools/grunt/GruntParser.java
@@ -45,6 +45,7 @@ import java.util.Set;
 import jline.ConsoleReader;
 import jline.ConsoleReaderInputStream;
 
+import org.apache.commons.io.output.NullOutputStream;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.fs.FileSystem;
@@ -390,26 +391,9 @@ public class GruntParser extends PigScriptParser {
         explainCurrentBatch(false);
     }
 
-    /**
-     * A {@link PrintStream} implementation which does not write anything
-     * Used with '-check' command line option to pig Main
-     * (through {@link GruntParser#explainCurrentBatch(boolean) } )
-     */
-    static class NullPrintStream extends PrintStream {
-        public NullPrintStream(String fileName) throws FileNotFoundException {
-            super(fileName);
-        }
-        @Override
-        public void write(byte[] buf, int off, int len) {}
-        @Override
-        public void write(int b) {}
-        @Override
-        public void write(byte [] b) {}
-    }
-
     protected void explainCurrentBatch(boolean dontPrintOutput) throws IOException {
-        PrintStream lp = (dontPrintOutput) ? new NullPrintStream("dummy") : System.out;
-        PrintStream ep = (dontPrintOutput) ? new NullPrintStream("dummy") : System.out;
+        PrintStream lp = (dontPrintOutput) ? new PrintStream(new NullOutputStream()) : System.out;
+        PrintStream ep = (dontPrintOutput) ? new PrintStream(new NullOutputStream()) : System.out;
 
         if (!(mExplain.mLast && mExplain.mCount == 0)) {
             if (mPigServer.isBatchEmpty()) {
@@ -489,7 +473,9 @@ public class GruntParser extends PigScriptParser {
 
         PigContext context = mPigServer.getPigContext();
         BufferedReader reader = new BufferedReader(new FileReader(scriptPath));
-        return context.doParamSubstitution(reader, params, paramFiles);
+        String result = context.doParamSubstitution(reader, params, paramFiles);
+        reader.close();
+        return result;
     }
 
     @Override
