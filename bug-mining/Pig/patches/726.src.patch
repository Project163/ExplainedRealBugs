diff --git a/CHANGES.txt b/CHANGES.txt
index 06612f656..b251342ae 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -200,6 +200,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-2040: Move classloader from QueryParserDriver to PigContext (daijy)
+
 PIG-1999: Macro alias masker should consider schema context (rding)
 
 PIG-1821: UDFContext.getUDFProperties does not handle collisions
diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index eda05d1f7..baa8e2a39 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -67,7 +67,6 @@ import org.apache.pig.impl.util.ObjectSerializer;
 import org.apache.pig.impl.util.PropertiesUtil;
 import org.apache.pig.impl.util.UDFContext;
 import org.apache.pig.parser.DryRunGruntParser;
-import org.apache.pig.parser.QueryParserDriver;
 import org.apache.pig.scripting.ScriptEngine;
 import org.apache.pig.scripting.ScriptEngine.SupportedScriptLang;
 import org.apache.pig.tools.cmdline.CmdLineParser;
@@ -357,7 +356,7 @@ static int run(String args[], PigProgressNotificationListener listener) {
         if (properties.get("udf.import.list")!=null)
             PigContext.initializeImportList((String)properties.get("udf.import.list"));
 
-        QueryParserDriver.classloader = pigContext.createCl(null);
+        PigContext.setClassLoader(pigContext.createCl(null));
 
         // construct the parameter substitution preprocessor
         Grunt grunt = null;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
index 5b65b092c..cac97150f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
@@ -63,7 +63,6 @@ import org.apache.pig.impl.plan.VisitorException;
 import org.apache.pig.impl.plan.CompilationMessageCollector.MessageType;
 import org.apache.pig.impl.util.ConfigurationValidator;
 import org.apache.pig.impl.util.LogUtils;
-import org.apache.pig.parser.QueryParserDriver;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStatsUtil;
 import org.apache.pig.tools.pigstats.ScriptState;
@@ -222,7 +221,7 @@ public class MapReduceLauncher extends Launcher{
             Thread jcThread = new Thread(jc);
             jcThread.setUncaughtExceptionHandler(jctExceptionHandler);
             
-            jcThread.setContextClassLoader(QueryParserDriver.classloader);
+            jcThread.setContextClassLoader(PigContext.getClassLoader());
             
             //All the setup done, now lets launch the jobs.
             jcThread.start();
diff --git a/src/org/apache/pig/impl/PigContext.java b/src/org/apache/pig/impl/PigContext.java
index b2514e4be..c0b0fd7df 100644
--- a/src/org/apache/pig/impl/PigContext.java
+++ b/src/org/apache/pig/impl/PigContext.java
@@ -128,6 +128,8 @@ public class PigContext implements Serializable {
 
     // List of paths skipped for automatic shipping
     List<String> skippedShipPaths = new ArrayList<String>();
+
+    static private ClassLoader classloader = PigContext.class.getClassLoader();
     
     public PigContext() {
         this(ExecType.MAPREDUCE, new Properties());
@@ -226,7 +228,7 @@ public class PigContext implements Serializable {
     public void addJar(URL resource) throws MalformedURLException{
         if (resource != null) {
             extraJars.add(resource);
-            QueryParserDriver.classloader = createCl(null);
+            PigContext.classloader = createCl(null);
         }
     }
 
@@ -422,7 +424,7 @@ public class PigContext implements Serializable {
         for(String prefix: getPackageImportList()) {
             Class c;
             try {
-                c = Class.forName(prefix+name,true, QueryParserDriver.classloader);
+                c = Class.forName(prefix+name,true, PigContext.classloader);
                 return c;
             } 
             catch (ClassNotFoundException e) {
@@ -644,4 +646,10 @@ public class PigContext implements Serializable {
     {
         defaultLogLevel = l;
     }
+    public static ClassLoader getClassLoader() {
+        return classloader;
+    }
+    public static void setClassLoader(ClassLoader cl) {
+        classloader = cl;
+    }
 }
diff --git a/src/org/apache/pig/parser/QueryParserDriver.java b/src/org/apache/pig/parser/QueryParserDriver.java
index 13488998f..bb69470d1 100644
--- a/src/org/apache/pig/parser/QueryParserDriver.java
+++ b/src/org/apache/pig/parser/QueryParserDriver.java
@@ -46,8 +46,6 @@ import org.apache.pig.parser.QueryParser.literal_return;
 import org.apache.pig.tools.pigstats.ScriptState;
 
 public class QueryParserDriver {
-    public static ClassLoader classloader = QueryParserDriver.class.getClassLoader();
-    
     private static final Log LOG = LogFactory.getLog(QueryParserDriver.class);
     
     private static final String MACRO_DEF = "MACRO_DEF";
