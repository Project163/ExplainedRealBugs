diff --git a/src/org/apache/pig/builtin/InvokerFunction.java b/src/org/apache/pig/builtin/InvokerFunction.java
index a2f3e4516..54f21784d 100644
--- a/src/org/apache/pig/builtin/InvokerFunction.java
+++ b/src/org/apache/pig/builtin/InvokerFunction.java
@@ -1,3 +1,20 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.pig.builtin;
 
 import java.io.IOException;
diff --git a/src/org/apache/pig/builtin/InvokerGenerator.java b/src/org/apache/pig/builtin/InvokerGenerator.java
index 8e01965d3..850b672fe 100644
--- a/src/org/apache/pig/builtin/InvokerGenerator.java
+++ b/src/org/apache/pig/builtin/InvokerGenerator.java
@@ -1,3 +1,20 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.pig.builtin;
 
 import static org.objectweb.asm.Opcodes.ACC_PUBLIC;
@@ -119,7 +136,7 @@ public class InvokerGenerator extends EvalFunc<Object> {
         methodName_ = methodName;
         argumentTypes_ = argumentTypes.split(",");
         if ("".equals(argumentTypes)) {
-            argumentTypes_ = new String[0]; 
+            argumentTypes_ = new String[0];
         }
     }
 
@@ -168,7 +185,7 @@ public class InvokerGenerator extends EvalFunc<Object> {
         if (returnClazz.isPrimitive()) {
             type = returnTypeMap.get(inverseTypeMap.get(returnClazz));
         } else {
-            type = returnTypeMap.get(returnClazz);  
+            type = returnTypeMap.get(returnClazz);
         }
 
         //TODO add functionality so that if the user pairs this witha  cast that it will let you return object
@@ -189,8 +206,8 @@ public class InvokerGenerator extends EvalFunc<Object> {
         for (int i = 0; i < argumentTypes.length; i++) {
             try {
                 arguments[i]= nameToClassObjectMap.get(argumentTypes[i]);
-                if (arguments[i] == null) { 
-                    arguments[i] = PigContext.resolveClassName(argumentTypes[i]);                   
+                if (arguments[i] == null) {
+                    arguments[i] = PigContext.resolveClassName(argumentTypes[i]);
                 }
             } catch (IOException e) {
                 throw new RuntimeException("Unable to find class in PigContext: " + argumentTypes[i], e);
@@ -207,7 +224,7 @@ public class InvokerGenerator extends EvalFunc<Object> {
 
     private byte[] generateInvokerFunctionBytecode(String className, Method method, boolean isStatic, Class<?>[] arguments) {
         boolean isInterface = method.getDeclaringClass().isInterface();
-        
+
         ClassWriter cw = new ClassWriter(0);
         cw.visit(V1_6, ACC_PUBLIC + ACC_SUPER, className, null, "java/lang/Object", new String[] { "org/apache/pig/builtin/InvokerFunction" });
 
@@ -282,7 +299,6 @@ public class InvokerGenerator extends EvalFunc<Object> {
         return primitiveSignature.get(clazz);
     }
 
-    
     private void boxIfPrimitive(MethodVisitor mv, Class<?> clazz) {
         if (!clazz.isPrimitive()) {
             return;
@@ -290,7 +306,7 @@ public class InvokerGenerator extends EvalFunc<Object> {
         String boxedClass = getMethodStyleName(inverseTypeMap.get(clazz));
         mv.visitMethodInsn(INVOKESTATIC, boxedClass, "valueOf", "("+getMethodStyleName(clazz)+")L"+boxedClass+";");
     }
-    
+
     private void unboxIfPrimitive(MethodVisitor mv, Class<?> clazz) {
         if (!clazz.isPrimitive()) {
             return;
diff --git a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
index f1db78847..5c18befd0 100644
--- a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
@@ -214,7 +214,7 @@ public class UserFuncExpression extends LogicalExpression {
         if (lazilyInitializeInvokerFunction) {
             initializeInvokerFunction();
         }
-        
+
         // Since ef only set one time, we never change its value, so we can optimize it by instantiate only once.
         // This significantly optimize the performance of frontend (PIG-1738)
         if (ef==null) {
@@ -259,16 +259,16 @@ public class UserFuncExpression extends LogicalExpression {
 
     private void initializeInvokerFunction() {
         List<LogicalFieldSchema> fieldSchemas = Lists.newArrayList();
-        for (LogicalExpression le : saveArgsForLater) {     
+        for (LogicalExpression le : saveArgsForLater) {
             try {
                 fieldSchemas.add(le.getFieldSchema());
             } catch (FrontendException e) {
                 throw new RuntimeException(e);
             }
         }
-        
+
         Class<?> funcClass;
-        
+
         if (invokerIsStatic) {
             try {
                 funcClass = PigContext.resolveClassName(packageName);
@@ -281,42 +281,42 @@ public class UserFuncExpression extends LogicalExpression {
                 funcClass = LogicalPlanBuilder.typeToClass(funcClass);
             }
         }
-        
+
         Class<?>[] parameterTypes = new Class<?>[fieldSchemas.size() - (invokerIsStatic ? 0 : 1)];
         int idx = 0;
         for (int i = invokerIsStatic ? 0 : 1; i < fieldSchemas.size(); i++) {
             parameterTypes[idx++] = DataType.findTypeClass(fieldSchemas.get(i).type);
         }
-        
+
         List<Integer> primitiveParameters = Lists.newArrayList();
-        
+
         for (int i = 0; i < parameterTypes.length; i++) {
             if (parameterTypes[i].isPrimitive()) {
                 primitiveParameters.add(i);
             }
         }
-        
+
         int tries = 1 << primitiveParameters.size();
 
         Method m = null;
-        
+
         for (int i = 0; i < tries; i++) {
             Class<?>[] tmpParameterTypes = new Class<?>[parameterTypes.length];
             for (int j = 0; j < parameterTypes.length; j++) {
                 tmpParameterTypes[j] = parameterTypes[j];
             }
-            
+
             int tmp = i;
             int idx2 = 0;
             while (tmp > 0) {
                 if (tmp % 2 == 1) {
                     int toFlip = primitiveParameters.get(idx2);
-                    tmpParameterTypes[toFlip] = LogicalPlanBuilder.typeToClass(tmpParameterTypes[toFlip]); 
+                    tmpParameterTypes[toFlip] = LogicalPlanBuilder.typeToClass(tmpParameterTypes[toFlip]);
                 }
                 tmp >>= 1;
                 idx2++;
             }
-            
+
             try {
                 m = funcClass.getMethod(funcName, parameterTypes);
                 if (m != null) {
@@ -329,11 +329,11 @@ public class UserFuncExpression extends LogicalExpression {
                 // we just continue, as we are searching for a match post-boxing
             }
         }
-        
+
         if (m == null) {
             throw new RuntimeException("Given method ["+funcName+"] does not exist on class: " + funcClass);
         }
-        
+
         String[] ctorArgs = new String[3];
         ctorArgs[0] = funcClass.getName();
         ctorArgs[1] = funcName;
@@ -343,7 +343,7 @@ public class UserFuncExpression extends LogicalExpression {
             params.add(param.getName());
         }
         ctorArgs[2] = Joiner.on(",").join(params);
-        
+
         //TODO need to allow them to define such a function so it can be cached etc (esp. if they reuse)
         mFuncSpec = new FuncSpec(InvokerGenerator.class.getName(), ctorArgs);
         lazilyInitializeInvokerFunction = false;
diff --git a/src/org/apache/pig/parser/LogicalPlanBuilder.java b/src/org/apache/pig/parser/LogicalPlanBuilder.java
index e46f5eac8..99e481d76 100644
--- a/src/org/apache/pig/parser/LogicalPlanBuilder.java
+++ b/src/org/apache/pig/parser/LogicalPlanBuilder.java
@@ -1432,9 +1432,9 @@ public class LogicalPlanBuilder {
             return Long.class;
         } else if (clazz == Double.TYPE) {
             return Long.class;
-    	} else if (clazz == Boolean.TYPE) {
+        } else if (clazz == Boolean.TYPE) {
             return Long.class;
-    	} else if (clazz == Short.TYPE) {
+        } else if (clazz == Short.TYPE) {
             return Short.class;
         } else if (clazz == Byte.TYPE) {
             return Byte.class;
diff --git a/test/org/apache/pig/builtin/TestInvokerGenerator.java b/test/org/apache/pig/builtin/TestInvokerGenerator.java
index 0551ba32e..6eb346f5b 100644
--- a/test/org/apache/pig/builtin/TestInvokerGenerator.java
+++ b/test/org/apache/pig/builtin/TestInvokerGenerator.java
@@ -1,3 +1,20 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.pig.builtin;
 
 import static org.apache.pig.builtin.mock.Storage.resetData;
@@ -21,69 +38,69 @@ import com.google.common.collect.ImmutableSet;
 import com.google.common.collect.Sets;
 
 public class TestInvokerGenerator {
-	private static PigServer pigServer;
-	private static Random r;
-	
-	@Before
-	public void setUp() throws Exception {
-		pigServer = new PigServer(ExecType.LOCAL);
-		r = new Random(42L);
-	}
-	
-	@Test
-	public void testConcat() throws Exception {
-	    Data data = resetData(pigServer);
-
-	    Set<Tuple> inputs = ImmutableSet.of(tuple("a"), tuple("b"), tuple("c"));
-	    Set<Tuple> expected = Sets.newHashSet();
-	    
-	    for (Tuple t : inputs) {
-	    	String str = (String)t.get(0);
-	    	expected.add(tuple(str.concat(str)));
-	    }
-	    
-	    data.set("foo", Utils.getSchemaFromString("x:chararray"), inputs);
-		
-		pigServer.registerQuery("define concat InvokerGenerator('java.lang.String','concat','String');");
-		pigServer.registerQuery("a = load 'foo' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate concat($0, $0);");
-		pigServer.registerQuery("store b into 'bar' using mock.Storage();");
-		
-		List<Tuple> results = data.get("bar");
-		assertEquals(expected.size(), results.size());
-		for (Tuple t : results) {
-			assertTrue(expected.remove(t));
-		}
-		assertEquals(0, expected.size());
-	}
-	
-	@Test
-	public void testValueOf() throws Exception {
-	    Data data = resetData(pigServer);
-
-	    Set<Tuple> inputs = Sets.newHashSet();
-	    while (inputs.size() < 1000) {
-	    	inputs.add(tuple(Integer.toString(r.nextInt())));
-	    }
-	    Set<Tuple> expected = Sets.newHashSet();
-	    
-	    for (Tuple t : inputs) {
-	    	String str = (String)t.get(0);
-	    	expected.add(tuple(Integer.valueOf(str)));
-	    }
-	    
-	    data.set("foo", Utils.getSchemaFromString("x:chararray"), inputs);
-		
-		pigServer.registerQuery("define valueOf InvokerGenerator('java.lang.Integer','valueOf','String');");
-		pigServer.registerQuery("a = load 'foo' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate valueOf($0);");
-		pigServer.registerQuery("store b into 'bar' using mock.Storage();");
-		
-		List<Tuple> results = data.get("bar");
-		assertEquals(expected.size(), results.size());
-		for (Tuple t : results) {
-			assertTrue(expected.remove(t));
-		}
-		assertEquals(0, expected.size());		
-	}
-}
\ No newline at end of file
+    private static PigServer pigServer;
+    private static Random r;
+
+    @Before
+    public void setUp() throws Exception {
+        pigServer = new PigServer(ExecType.LOCAL);
+        r = new Random(42L);
+    }
+
+    @Test
+    public void testConcat() throws Exception {
+        Data data = resetData(pigServer);
+
+        Set<Tuple> inputs = ImmutableSet.of(tuple("a"), tuple("b"), tuple("c"));
+        Set<Tuple> expected = Sets.newHashSet();
+
+        for (Tuple t : inputs) {
+            String str = (String)t.get(0);
+            expected.add(tuple(str.concat(str)));
+        }
+
+        data.set("foo", Utils.getSchemaFromString("x:chararray"), inputs);
+
+        pigServer.registerQuery("define concat InvokerGenerator('java.lang.String','concat','String');");
+        pigServer.registerQuery("a = load 'foo' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate concat($0, $0);");
+        pigServer.registerQuery("store b into 'bar' using mock.Storage();");
+
+        List<Tuple> results = data.get("bar");
+        assertEquals(expected.size(), results.size());
+        for (Tuple t : results) {
+            assertTrue(expected.remove(t));
+        }
+        assertEquals(0, expected.size());
+    }
+
+    @Test
+    public void testValueOf() throws Exception {
+        Data data = resetData(pigServer);
+
+        Set<Tuple> inputs = Sets.newHashSet();
+        while (inputs.size() < 1000) {
+            inputs.add(tuple(Integer.toString(r.nextInt())));
+        }
+        Set<Tuple> expected = Sets.newHashSet();
+
+        for (Tuple t : inputs) {
+            String str = (String)t.get(0);
+            expected.add(tuple(Integer.valueOf(str)));
+        }
+
+        data.set("foo", Utils.getSchemaFromString("x:chararray"), inputs);
+
+        pigServer.registerQuery("define valueOf InvokerGenerator('java.lang.Integer','valueOf','String');");
+        pigServer.registerQuery("a = load 'foo' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate valueOf($0);");
+        pigServer.registerQuery("store b into 'bar' using mock.Storage();");
+
+        List<Tuple> results = data.get("bar");
+        assertEquals(expected.size(), results.size());
+        for (Tuple t : results) {
+            assertTrue(expected.remove(t));
+        }
+        assertEquals(0, expected.size());
+    }
+}
diff --git a/test/org/apache/pig/test/TestBuiltinInvoker.java b/test/org/apache/pig/test/TestBuiltinInvoker.java
index a12b4efdf..d7437e411 100644
--- a/test/org/apache/pig/test/TestBuiltinInvoker.java
+++ b/test/org/apache/pig/test/TestBuiltinInvoker.java
@@ -1,3 +1,20 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.pig.test;
 
 import static org.apache.pig.builtin.mock.Storage.resetData;
@@ -23,106 +40,106 @@ import org.python.google.common.collect.Sets;
 import com.google.common.collect.ImmutableSet;
 
 public class TestBuiltinInvoker {
-	private static PigServer pigServer;
-	private static Data data;
-	private static Set<Tuple> chardata = ImmutableSet.of(tuple("a"),tuple("b"),tuple("c"));
-	private static Set<Tuple> intdata = ImmutableSet.of(tuple(1),tuple(2),tuple(3));
-	private static Set<Tuple> charintdata = ImmutableSet.of(tuple("1"),tuple("2"),tuple("3"));
-	private static TupleFactory mTupleFactory = TupleFactory.getInstance();
-	private static Random r;
-	
-	@Before
-	public void setUp() throws Exception {
-		pigServer = new PigServer(ExecType.LOCAL);
-		
-		data = resetData(pigServer);
-
-	    data.set("chardata", Utils.getSchemaFromString("x:chararray"), chardata);
-	    data.set("charintdata", Utils.getSchemaFromString("x:chararray"), charintdata);
-	    
-	    r = new Random(42L);
-	}
-	
-	@Test
-	public void testConcat() throws Exception {
-		Set<Tuple> expected = Sets.newHashSet();
-		for (Tuple t : chardata) {
-			String str = (String)t.get(0);
-			expected.add(mTupleFactory.newTuple(str + str));
-		}
-		
-		pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate invoke(x)concat(x);");
-		pigServer.registerQuery("store b into 'res' using mock.Storage();");
-		List<Tuple> results = data.get("res");
-		dataIsEqual(expected, results);
-	}
-	
-	@Test
-	public void testValueOf() throws Exception {
-		Set<Tuple> expected = Sets.newHashSet();
-		for (Tuple t : charintdata) {
-			String str = (String)t.get(0);
-			expected.add(mTupleFactory.newTuple(Integer.valueOf(str)));
-		}
-		
-		pigServer.registerQuery("a = load 'charintdata' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate invoke&Integer.valueOf(x);");
-		pigServer.registerQuery("store b into 'res' using mock.Storage();");
-		List<Tuple> results = data.get("res");
-		dataIsEqual(expected, results);
-	}
-	
-	@Test
-	public void testManyConcat() throws Exception {
-		Set<Tuple> expected = Sets.newHashSet();
-		for (Tuple t : chardata) {
-			String str = (String)t.get(0);
-			expected.add(mTupleFactory.newTuple(str + str + str + str));
-		}
-		
-		pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate invoke(invoke(invoke(x)concat(x))concat(x))concat(x);");
-		pigServer.registerQuery("store b into 'res' using mock.Storage();");
-		List<Tuple> results = data.get("res");
-		dataIsEqual(expected, results);
-	}
-	
-	@Test
-	public void testTupleSize() throws Exception {
-		pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate invoke(TOTUPLE(x))size();");
-		pigServer.registerQuery("store b into 'res' using mock.Storage();");
-		List<Tuple> results = data.get("res");
-		assertEquals(3, results.size());
-		for (Tuple t : results) {
-			assertEquals(Integer.valueOf(1), (Integer)t.get(0));	
-		}
-	}
-	
-	@Test
-	public void testStringSize() throws Exception {
-		Set<Tuple> input = Sets.newHashSet();
-		Set<Tuple> expected = Sets.newHashSet();
-		for (int i = 0; i < 1000; i++) {
-			String val = Integer.toString(r.nextInt());
-			input.add(tuple(val));
-			expected.add(tuple(val, val.length()));
-		}
-		data.set("foo", Utils.getSchemaFromString("x:chararray"), input);
-		
-		pigServer.registerQuery("a = load 'foo' using mock.Storage();");
-		pigServer.registerQuery("b = foreach @ generate $0, invoke($0)length();");
-		pigServer.registerQuery("store b into 'bar' using mock.Storage();");
-		
-		dataIsEqual(expected, data.get("bar"));
-	}
-	
-	private void dataIsEqual(Set<Tuple> expected, Collection<Tuple> results) {
-		assertEquals(expected.size(), results.size());
-		for (Tuple t : results) {
-			assertTrue(expected.remove(t));
-		}
-		assertEquals(0, expected.size());
-	}
+    private static PigServer pigServer;
+    private static Data data;
+    private static Set<Tuple> chardata = ImmutableSet.of(tuple("a"),tuple("b"),tuple("c"));
+    private static Set<Tuple> intdata = ImmutableSet.of(tuple(1),tuple(2),tuple(3));
+    private static Set<Tuple> charintdata = ImmutableSet.of(tuple("1"),tuple("2"),tuple("3"));
+    private static TupleFactory mTupleFactory = TupleFactory.getInstance();
+    private static Random r;
+
+    @Before
+    public void setUp() throws Exception {
+        pigServer = new PigServer(ExecType.LOCAL);
+
+        data = resetData(pigServer);
+
+        data.set("chardata", Utils.getSchemaFromString("x:chararray"), chardata);
+        data.set("charintdata", Utils.getSchemaFromString("x:chararray"), charintdata);
+
+        r = new Random(42L);
+    }
+
+    @Test
+    public void testConcat() throws Exception {
+        Set<Tuple> expected = Sets.newHashSet();
+        for (Tuple t : chardata) {
+            String str = (String)t.get(0);
+            expected.add(mTupleFactory.newTuple(str + str));
+        }
+
+        pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate invoke(x)concat(x);");
+        pigServer.registerQuery("store b into 'res' using mock.Storage();");
+        List<Tuple> results = data.get("res");
+        dataIsEqual(expected, results);
+    }
+
+    @Test
+    public void testValueOf() throws Exception {
+        Set<Tuple> expected = Sets.newHashSet();
+        for (Tuple t : charintdata) {
+            String str = (String)t.get(0);
+            expected.add(mTupleFactory.newTuple(Integer.valueOf(str)));
+        }
+
+        pigServer.registerQuery("a = load 'charintdata' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate invoke&Integer.valueOf(x);");
+        pigServer.registerQuery("store b into 'res' using mock.Storage();");
+        List<Tuple> results = data.get("res");
+        dataIsEqual(expected, results);
+    }
+
+    @Test
+    public void testManyConcat() throws Exception {
+        Set<Tuple> expected = Sets.newHashSet();
+        for (Tuple t : chardata) {
+            String str = (String)t.get(0);
+            expected.add(mTupleFactory.newTuple(str + str + str + str));
+        }
+
+        pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate invoke(invoke(invoke(x)concat(x))concat(x))concat(x);");
+        pigServer.registerQuery("store b into 'res' using mock.Storage();");
+        List<Tuple> results = data.get("res");
+        dataIsEqual(expected, results);
+    }
+
+    @Test
+    public void testTupleSize() throws Exception {
+        pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate invoke(TOTUPLE(x))size();");
+        pigServer.registerQuery("store b into 'res' using mock.Storage();");
+        List<Tuple> results = data.get("res");
+        assertEquals(3, results.size());
+        for (Tuple t : results) {
+            assertEquals(Integer.valueOf(1), (Integer)t.get(0));
+        }
+    }
+
+    @Test
+    public void testStringSize() throws Exception {
+        Set<Tuple> input = Sets.newHashSet();
+        Set<Tuple> expected = Sets.newHashSet();
+        for (int i = 0; i < 1000; i++) {
+            String val = Integer.toString(r.nextInt());
+            input.add(tuple(val));
+            expected.add(tuple(val, val.length()));
+        }
+        data.set("foo", Utils.getSchemaFromString("x:chararray"), input);
+
+        pigServer.registerQuery("a = load 'foo' using mock.Storage();");
+        pigServer.registerQuery("b = foreach @ generate $0, invoke($0)length();");
+        pigServer.registerQuery("store b into 'bar' using mock.Storage();");
+
+        dataIsEqual(expected, data.get("bar"));
+    }
+
+    private void dataIsEqual(Set<Tuple> expected, Collection<Tuple> results) {
+        assertEquals(expected.size(), results.size());
+        for (Tuple t : results) {
+            assertTrue(expected.remove(t));
+        }
+        assertEquals(0, expected.size());
+    }
 }
