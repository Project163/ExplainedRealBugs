diff --git a/CHANGES.txt b/CHANGES.txt
index b5721e8b3..4faa3a114 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -136,6 +136,10 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1923: Jython UDFs fail to convert Maps of Integer values back to Pig types (julien)
+
+PIG-1944: register javascript UDFs does not work (julien)
+
 PIG-1955: PhysicalOperator has a member variable (non-static) Log object that
 is non-transient, this causes serialization errors (woody via rding)
 
diff --git a/src/org/apache/pig/parser/PlanGenerationFailureException.java b/src/org/apache/pig/parser/PlanGenerationFailureException.java
index 5d90a9e89..4aecb346f 100644
--- a/src/org/apache/pig/parser/PlanGenerationFailureException.java
+++ b/src/org/apache/pig/parser/PlanGenerationFailureException.java
@@ -38,4 +38,8 @@ public class PlanGenerationFailureException extends PigRecognitionException {
         return ex;
     }
 
+    @Override
+    public Throwable getCause() {
+        return ex;
+    }
 }
diff --git a/src/org/apache/pig/scripting/js/JsScriptEngine.java b/src/org/apache/pig/scripting/js/JsScriptEngine.java
index b876f8e59..568c9a881 100644
--- a/src/org/apache/pig/scripting/js/JsScriptEngine.java
+++ b/src/org/apache/pig/scripting/js/JsScriptEngine.java
@@ -217,10 +217,6 @@ public class JsScriptEngine extends ScriptEngine {
             throw new IOException("Can't read file: " + scriptFile);
         }
 
-        // to enable passing of information to the slave
-        this.scriptPath = scriptFile;
-        clientInstance = this;
-
         registerFunctions(scriptFile, null, pigContext);    
 
         // run main
@@ -232,6 +228,10 @@ public class JsScriptEngine extends ScriptEngine {
     @Override
     public void registerFunctions(String path, String namespace,
             PigContext pigContext) throws IOException {
+        // to enable passing of information to the slave
+        this.scriptPath = path;
+        this.clientInstance = this;
+        
         pigContext.scriptJars.add(getJarPath(Context.class));
         namespace = (namespace == null) ? "" : namespace + NAMESPACE_SEPARATOR;
         FileInputStream fis = new FileInputStream(path);
diff --git a/src/org/apache/pig/scripting/jython/JythonFunction.java b/src/org/apache/pig/scripting/jython/JythonFunction.java
index e32c8bc8d..3a8d7af67 100644
--- a/src/org/apache/pig/scripting/jython/JythonFunction.java
+++ b/src/org/apache/pig/scripting/jython/JythonFunction.java
@@ -80,7 +80,7 @@ public class JythonFunction extends EvalFunc<Object> {
                         "unregistered " + functionName);
             }
         } catch (ParseException pe) {
-            throw new ExecException("Could not parse schema for script function " + pe);
+            throw new ExecException("Could not parse schema for script function " + pe, pe);
         } catch (IOException e) {
             throw new IllegalStateException("Could not initialize: " + filename, e);
         } catch (Exception e) {
diff --git a/src/org/apache/pig/scripting/jython/JythonUtils.java b/src/org/apache/pig/scripting/jython/JythonUtils.java
index e458dc587..efcbcbca2 100644
--- a/src/org/apache/pig/scripting/jython/JythonUtils.java
+++ b/src/org/apache/pig/scripting/jython/JythonUtils.java
@@ -69,10 +69,15 @@ public class JythonUtils {
                 }
                 javaObj = list;
             } else if (pyObject instanceof PyDictionary) {
-                Map<?, PyObject> map = Py.tojava(pyObject, Map.class);
+                Map<?, Object> map = Py.tojava(pyObject, Map.class);
                 Map<Object, Object> newMap = new HashMap<Object, Object>();
-                for (Map.Entry<?, PyObject> entry : map.entrySet()) {
-                    newMap.put(entry.getKey(), pythonToPig(entry.getValue()));
+                for (Map.Entry<?, Object> entry : map.entrySet()) {
+                    if (entry.getValue() instanceof PyObject) {
+                        newMap.put(entry.getKey(), pythonToPig((PyObject) entry.getValue()));
+                    } else {
+                        // Jython sometimes uses directly the java class: for example for integers
+                        newMap.put(entry.getKey(), entry.getValue());
+                    }
                 }
                 javaObj = newMap;
             } else if (pyObject instanceof PyLong) {
@@ -94,15 +99,15 @@ public class JythonUtils {
                     javaObj = new DataByteArray((byte[])javaObj);
                 }
                 else {
-                    throw new ExecException("Non supported pig datatype found, cast failed");
+                    throw new ExecException("Non supported pig datatype found, cast failed: "+(pyObject==null?null:pyObject.getClass().getName()));
                 }
             }
             if(javaObj.equals(Py.NoConversion)) {
-                throw new ExecException("Cannot cast into any pig supported type");
+                throw new ExecException("Cannot cast into any pig supported type: "+(pyObject==null?null:pyObject.getClass().getName()));
             }
             return javaObj;
         } catch (Exception e) {
-            throw new ExecException("Cannot convert jython type to pig datatype "+ e);
+            throw new ExecException("Cannot convert jython type ("+(pyObject==null?null:pyObject.getClass().getName())+") to pig datatype "+ e, e);
         }
     }
 
diff --git a/test/org/apache/pig/test/TestScriptUDF.java b/test/org/apache/pig/test/TestScriptUDF.java
index 263c41e22..3af6e8b10 100644
--- a/test/org/apache/pig/test/TestScriptUDF.java
+++ b/test/org/apache/pig/test/TestScriptUDF.java
@@ -19,6 +19,7 @@ package org.apache.pig.test;
 
 import java.io.File;
 import java.util.Iterator;
+import java.util.Map;
 import java.util.Random;
 
 import junit.framework.TestCase;
@@ -112,6 +113,50 @@ public class TestScriptUDF extends TestCase {
 
         assertTrue(t.toString().equals("(9)"));
     }
+    
+    @Test
+    public void testJavascriptExampleScript() throws Exception{
+        String[] script = {
+                "helloworld.outputSchema = \"word:chararray\";",
+                "function helloworld() {",
+                "return 'Hello, World';",
+                "}",
+                "complex.outputSchema = \"word:chararray,num:long\";",
+                "function complex(word) {",
+                "return {word:word, num:word.length};",
+                "}",
+        };
+        String[] input = {
+                "one\t1",
+                "two\t2",
+                "three\t3"
+        };
+
+        Util.createInputFile(cluster, "table_testJavascriptExampleScript", input);
+        Util.createLocalInputFile( "testJavascriptExampleScript.js", script);
+
+        // Test the namespace
+        pigServer.registerCode("testJavascriptExampleScript.js", "javascript", "myfuncs");
+        pigServer.registerQuery("A = LOAD 'table_testJavascriptExampleScript' as (a0:chararray, a1:long);");
+        pigServer.registerQuery("B = foreach A generate myfuncs.helloworld(), myfuncs.complex($0);");
+
+        Iterator<Tuple> iter = pigServer.openIterator("B");
+        assertTrue(iter.hasNext());
+        Tuple t = iter.next();
+
+        assertEquals(((Tuple)t.get(1)).get(1), 3);
+
+        assertTrue(iter.hasNext());
+        t = iter.next();
+
+        assertEquals(((Tuple)t.get(1)).get(1), 3);
+
+        assertTrue(iter.hasNext());
+        t = iter.next();
+
+        assertEquals(((Tuple)t.get(1)).get(1), 5);
+
+    }
 
     // See PIG-928
     @Test
@@ -346,6 +391,45 @@ public class TestScriptUDF extends TestCase {
         
     }
     
+    @Test
+    public void testPythonScriptUDFMapOutput() throws Exception{
+        String[] script = {
+                "#!/usr/bin/python",
+                "@outputSchema(\"mapint:[]\")",
+                "def maptomapint(map):" ,
+                "\toutMap = {}",
+                "\tfor k, v in map.iteritems():",
+                "\t\toutMap[k] = len(v)",
+                "\treturn outMap"
+        };
+        String[] input = {
+                "[1#hello,2#world]",
+                "[3#pig,4#rocks]",
+        };
+
+        Util.createInputFile(cluster, "table_testPythonScriptUDFMapOutput", input);
+        Util.createLocalInputFile( "testPythonScriptUDFMapOutput.py", script);
+
+        pigServer.registerCode("testPythonScriptUDFMapOutput.py", "jython", "pig");
+        pigServer.registerQuery("A = LOAD 'table_testPythonScriptUDFMapOutput' as (a0:map[]);");
+        pigServer.registerQuery("B = foreach A generate pig.maptomapint(a0);");
+
+        Iterator<Tuple> iter = pigServer.openIterator("B");
+        assertTrue(iter.hasNext());
+        Tuple t = iter.next();
+        
+        assertEquals(5, ((Map<?,?>)t.get(0)).get("1"));
+        assertEquals(5, ((Map<?,?>)t.get(0)).get("2"));
+        
+        assertTrue(iter.hasNext());
+        t = iter.next();
+        assertEquals(3, ((Map<?,?>)t.get(0)).get("3"));
+        assertEquals(5, ((Map<?,?>)t.get(0)).get("4"));
+        
+        assertFalse(iter.hasNext());
+        
+    }
+    
     @Test
     public void testPythonScriptUDFNullInputOutput() throws Exception {
         String[] script = {
