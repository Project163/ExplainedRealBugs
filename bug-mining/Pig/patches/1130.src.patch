diff --git a/CHANGES.txt b/CHANGES.txt
index 2202ca2ec..d1fff3291 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -95,6 +95,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-3135: HExecutionEngine should look for resources in user passed Properties (prkommireddi via cheolsoo)
+
 PIG-3145: Parameters in core-site.xml and mapred-site.xml are not correctly substituted (cheolsoo)
 
 PIG-3149: e2e build.xml still refers to jython 2.5.0 jar even though it's replaced by jython standalone 2.5.2 jar (cheolsoo)
diff --git a/conf/pig.properties b/conf/pig.properties
index cd4713de8..52e778010 100644
--- a/conf/pig.properties
+++ b/conf/pig.properties
@@ -175,3 +175,22 @@ hcat.bin=/usr/local/hcat/bin/hcat
 #####################################################################
 
 #pig.load.default.statements=
+
+
+#####################################################################
+
+########### Override hadoop configs programatically #################
+
+# By default, Pig expects hadoop configs (hadoop-site.xml and core-site.xml)
+# to be present on the classpath. There are cases when these configs are 
+# needed to be passed programatically, such as while using the PigServer API.
+# In such cases, you can override hadoop configs by setting the property
+# "pig.use.overriden.hadoop.configs". 
+# 
+# When this property is set to true, Pig ignores looking for hadoop configs
+# in the classpath and instead picks it up from Properties/Configuration
+# object passed to it.
+
+# pig.use.overriden.hadoop.configs=false
+#
+######################################################################
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java b/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
index 38f21b132..af5f728e6 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/HExecutionEngine.java
@@ -39,6 +39,7 @@ import org.apache.pig.ExecType;
 import org.apache.pig.PigException;
 import org.apache.pig.backend.datastorage.DataStorage;
 import org.apache.pig.backend.executionengine.ExecException;
+import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
 import org.apache.pig.backend.hadoop.datastorage.HDataStorage;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;
@@ -140,20 +141,26 @@ public class HExecutionEngine {
            
         JobConf jc = null;
         if ( this.pigContext.getExecType() == ExecType.MAPREDUCE ) {
-            
-            // Check existence of hadoop-site.xml or core-site.xml
-            Configuration testConf = new Configuration();
-            ClassLoader cl = testConf.getClassLoader();
-            URL hadoop_site = cl.getResource( HADOOP_SITE );
-            URL core_site = cl.getResource( CORE_SITE );
-            
-            if( hadoop_site == null && core_site == null ) {
-                throw new ExecException("Cannot find hadoop configurations in classpath (neither hadoop-site.xml nor core-site.xml was found in the classpath)." +
-                        " If you plan to use local mode, please put -x local option in command line", 
-                        4010);
+            // Check existence of user provided configs
+            String isHadoopConfigsOverriden = properties.getProperty("pig.use.overriden.hadoop.configs");
+            if (isHadoopConfigsOverriden != null && isHadoopConfigsOverriden.equals("true")) {
+                jc = new JobConf(ConfigurationUtil.toConfiguration(properties));
             }
+            else {
+                // Check existence of hadoop-site.xml or core-site.xml in classpath
+                // if user provided confs are not being used
+                Configuration testConf = new Configuration();
+                ClassLoader cl = testConf.getClassLoader();
+                URL hadoop_site = cl.getResource( HADOOP_SITE );
+                URL core_site = cl.getResource( CORE_SITE );
 
-            jc = new JobConf();
+                if( hadoop_site == null && core_site == null ) {
+                        throw new ExecException("Cannot find hadoop configurations in classpath (neither hadoop-site.xml nor core-site.xml was found in the classpath)." +
+                                " If you plan to use local mode, please put -x local option in command line", 
+                                4010);
+                }
+                jc = new JobConf();
+            }
             jc.addResource("pig-cluster-hadoop-site.xml");
             jc.addResource(YARN_SITE);
             
diff --git a/test/org/apache/pig/test/TestHExecutionEngine.java b/test/org/apache/pig/test/TestHExecutionEngine.java
new file mode 100644
index 000000000..d45f02281
--- /dev/null
+++ b/test/org/apache/pig/test/TestHExecutionEngine.java
@@ -0,0 +1,39 @@
+package org.apache.pig.test;
+
+import junit.framework.Assert;
+
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.mapred.JobConf;
+import org.apache.pig.ExecType;
+import org.apache.pig.backend.executionengine.ExecException;
+import org.apache.pig.impl.PigContext;
+import org.junit.Test;
+
+
+public class TestHExecutionEngine {
+    
+    @Test(expected = ExecException.class)
+    public void testJobConfGeneration() throws ExecException {
+        Configuration conf = new Configuration(false);
+        conf.set("foo", "bar");
+        PigContext pigContext = new PigContext(ExecType.MAPREDUCE, conf);
+        // This should fail as pig expects Hadoop configs are present in
+        // classpath.
+        pigContext.connect();
+    } 
+    
+    @Test
+    public void testJobConfGenerationWithUserConfigs() throws ExecException {
+        Configuration conf = new Configuration(false);
+        // This property allows Pig to depend on user Configuration 
+        // and not the classpath
+        conf.set("pig.use.overriden.hadoop.configs", "true");
+        conf.set("mapred.job.tracker", "host:12345");
+        conf.set("apache", "pig");
+        PigContext pigContext = new PigContext(ExecType.MAPREDUCE, conf);
+        pigContext.connect();
+        JobConf jc = pigContext.getExecutionEngine().getJobConf();
+        Assert.assertEquals(jc.get("mapred.job.tracker"), "host:12345");
+        Assert.assertEquals(jc.get("apache"), "pig");
+    }
+}
