diff --git a/CHANGES.txt b/CHANGES.txt
index a1c6fb74a..7bc0cbb33 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -60,6 +60,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4122: Fix hadoopversion 23 compilation due to TEZ-1194 (daijy)
+
 PIG-4061: Make Streaming UDF work in Tez (daijy)
 
 PIG-4118: Fix hadoopversion 23 compilation due to TEZ-1237/TEZ-1407 (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
index 53b5ed546..f695e1d5b 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/PigProcessor.java
@@ -52,6 +52,7 @@ import org.apache.pig.impl.util.ObjectSerializer;
 import org.apache.pig.impl.util.UDFContext;
 import org.apache.pig.tools.pigstats.PigStatusReporter;
 import org.apache.tez.common.TezUtils;
+import org.apache.tez.dag.api.UserPayload;
 import org.apache.tez.mapreduce.output.MROutput;
 import org.apache.tez.runtime.api.AbstractLogicalIOProcessor;
 import org.apache.tez.runtime.api.Event;
@@ -113,7 +114,7 @@ public class PigProcessor extends AbstractLogicalIOProcessor {
         PhysicalOperator.reporter = new ThreadLocal<PigProgressable>();
         PigMapReduce.sJobConfInternal = new ThreadLocal<Configuration>();
 
-        byte[] payload = getContext().getUserPayload();
+        UserPayload payload = getContext().getUserPayload();
         conf = TezUtils.createConfFromUserPayload(payload);
         PigContext.setPackageImportList((ArrayList<String>) ObjectSerializer
                 .deserialize(conf.get("udf.import.list")));
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
index 7a9cb0a0b..207fef413 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
@@ -116,6 +116,7 @@ import org.apache.tez.dag.api.InputInitializerDescriptor;
 import org.apache.tez.dag.api.OutputCommitterDescriptor;
 import org.apache.tez.dag.api.OutputDescriptor;
 import org.apache.tez.dag.api.ProcessorDescriptor;
+import org.apache.tez.dag.api.UserPayload;
 import org.apache.tez.dag.api.Vertex;
 import org.apache.tez.dag.api.VertexGroup;
 import org.apache.tez.dag.api.VertexLocationHint;
@@ -559,7 +560,7 @@ public class TezDagBuilder extends TezOpPlanVisitor {
         }
 
         // Take our assembled configuration and create a vertex
-        byte[] userPayload = TezUtils.createUserPayloadFromConf(payloadConf);
+        UserPayload userPayload = TezUtils.createUserPayloadFromConf(payloadConf);
         procDesc.setUserPayload(userPayload);
 
         Vertex vertex = new Vertex(tezOp.getOperatorKey().toString(), procDesc, tezOp.getVertexParallelism(),
@@ -597,9 +598,9 @@ public class TezDagBuilder extends TezOpPlanVisitor {
             vertex.setLocationHint(new VertexLocationHint(tezOp.getLoaderInfo().getInputSplitInfo().getTaskLocationHints()));
             vertex.addDataSource(ld.getOperatorKey().toString(),
                     new DataSourceDescriptor(new InputDescriptor(MRInput.class.getName())
-                            .setUserPayload(MRRuntimeProtos.MRInputUserPayloadProto.newBuilder()
+                            .setUserPayload(new UserPayload(MRRuntimeProtos.MRInputUserPayloadProto.newBuilder()
                             .setConfigurationBytes(TezUtils.createByteStringFromConf(payloadConf))
-                            .setSplits(tezOp.getLoaderInfo().getInputSplitInfo().getSplitsProto()).build().toByteArray()),
+                            .setSplits(tezOp.getLoaderInfo().getInputSplitInfo().getSplitsProto()).build().toByteArray())),
                     new InputInitializerDescriptor(MRInputSplitDistributor.class.getName()), dag.getCredentials()));
         }
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
index 725ffd9ce..86c5b4b9e 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezLauncher.java
@@ -58,6 +58,7 @@ import org.apache.pig.tools.pigstats.tez.TezStats;
 import org.apache.pig.tools.pigstats.tez.TezTaskStats;
 import org.apache.tez.common.TezUtils;
 import org.apache.tez.dag.api.TezConfiguration;
+import org.apache.tez.dag.api.UserPayload;
 import org.apache.tez.dag.api.Vertex;
 import org.apache.tez.dag.api.client.DAGStatus;
 import org.apache.tez.runtime.library.api.TezRuntimeConfiguration;
@@ -217,8 +218,8 @@ public class TezLauncher extends Launcher {
         public void notifyStarted() throws IOException {
             for (Vertex v : runningJob.getDAG().getVertices()) {
                 TezTaskStats tts = tezStats.getVertexStats(v.getName());
-                byte[] bb = v.getProcessorDescriptor().getUserPayload();
-                Configuration conf = TezUtils.createConfFromUserPayload(bb);
+                UserPayload payload = v.getProcessorDescriptor().getUserPayload();
+                Configuration conf = TezUtils.createConfFromUserPayload(payload);
                 tts.setConf(conf);
                 tts.setId(v.getName());
                 tezScriptState.emitJobStartedNotification(v.getName());
diff --git a/src/org/apache/pig/tools/pigstats/tez/TezStats.java b/src/org/apache/pig/tools/pigstats/tez/TezStats.java
index abf1a6611..967be376b 100644
--- a/src/org/apache/pig/tools/pigstats/tez/TezStats.java
+++ b/src/org/apache/pig/tools/pigstats/tez/TezStats.java
@@ -49,6 +49,7 @@ import org.apache.tez.common.counters.TaskCounter;
 import org.apache.tez.common.counters.TezCounter;
 import org.apache.tez.common.counters.TezCounters;
 import org.apache.tez.dag.api.DAG;
+import org.apache.tez.dag.api.UserPayload;
 import org.apache.tez.dag.api.Vertex;
 import org.apache.tez.dag.api.client.DAGStatus;
 
@@ -204,8 +205,8 @@ public class TezStats extends PigStats {
         for (String name : tezOpVertexMap.keySet()) {
             Vertex v = dag.getVertex(name);
             if (v != null) {
-                byte[] bb = v.getProcessorDescriptor().getUserPayload();
-                Configuration conf = TezUtils.createConfFromUserPayload(bb);
+                UserPayload payload = v.getProcessorDescriptor().getUserPayload();
+                Configuration conf = TezUtils.createConfFromUserPayload(payload);
                 addVertexStats(name, conf, succeeded, tezJob.getVertexCounters(name));
             }
         }
