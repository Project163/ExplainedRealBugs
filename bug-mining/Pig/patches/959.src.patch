diff --git a/CHANGES.txt b/CHANGES.txt
index 9640f5990..a4515055c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -23,6 +23,9 @@ Trunk (unreleased changes)
 INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
+
+PIG-2685: Fix error in EvalFunc ctor when implementing Algebraic UDF whose return type is parameterized (andy schlaikjer via jcoveney)
+
 PIG-2677: Add target to build.xml to generate clover summary reports (gates)
 
 PIG-2650: Convenience mock Loader and Storer to simplify unit testing of Pig scripts (julien)
diff --git a/src/org/apache/pig/EvalFunc.java b/src/org/apache/pig/EvalFunc.java
index 423e6f2e5..27fd1d066 100644
--- a/src/org/apache/pig/EvalFunc.java
+++ b/src/org/apache/pig/EvalFunc.java
@@ -145,7 +145,7 @@ public abstract class EvalFunc<T>  {
                 throw new RuntimeException("Initial " + errMsg);
             if (getReturnTypeFromSpec(new FuncSpec(a.getIntermed())) != Tuple.class)
                     throw new RuntimeException("Intermediate " + errMsg);
-            if (getReturnTypeFromSpec(new FuncSpec(a.getFinal())) != returnType)
+            if (!getReturnTypeFromSpec(new FuncSpec(a.getFinal())).equals(returnType))
                     throw new RuntimeException("Final " + errMsg);
         }
         
diff --git a/test/org/apache/pig/TestAlgebraicEvalWithParameterizedReturnType.java b/test/org/apache/pig/TestAlgebraicEvalWithParameterizedReturnType.java
new file mode 100644
index 000000000..501885b3d
--- /dev/null
+++ b/test/org/apache/pig/TestAlgebraicEvalWithParameterizedReturnType.java
@@ -0,0 +1,58 @@
+package org.apache.pig;
+
+import java.io.IOException;
+import java.util.Map;
+
+import org.apache.pig.data.Tuple;
+import org.junit.Test;
+
+public class TestAlgebraicEvalWithParameterizedReturnType {
+  public static class AlgebraicEvalFuncWithParameterizedReturnType extends
+      EvalFunc<Map<String, Long>> implements Algebraic {
+    public static class Initial extends EvalFunc<Tuple> {
+      @Override
+      public Tuple exec(Tuple input) throws IOException {
+        return null;
+      }
+    }
+
+    public static class Intermediate extends EvalFunc<Tuple> {
+      @Override
+      public Tuple exec(Tuple input) throws IOException {
+        return null;
+      }
+    }
+
+    public static class Final extends EvalFunc<Map<String, Long>> {
+      @Override
+      public Map<String, Long> exec(Tuple input) throws IOException {
+        return null;
+      }
+    }
+
+    @Override
+    public Map<String, Long> exec(Tuple input) throws IOException {
+      return null;
+    }
+
+    @Override
+    public String getInitial() {
+      return Initial.class.getName();
+    }
+
+    @Override
+    public String getIntermed() {
+      return Intermediate.class.getName();
+    }
+
+    @Override
+    public String getFinal() {
+      return Final.class.getName();
+    }
+  }
+
+  @Test
+  public void testConstruction() {
+    new AlgebraicEvalFuncWithParameterizedReturnType();
+  }
+}
