diff --git a/CHANGES.txt b/CHANGES.txt
index 1e970cddc..8fac2d75d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -207,6 +207,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1645: Using both small split combination and temporary file compression on a query of ORDER BY may cause crash (yanz)
+
 PIG-1635: Logical simplifier does not simplify away constants under AND and OR; after simplificaion the ordering of operands of
           AND and OR may get changed (yanz)
 
diff --git a/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java b/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
index 3dd84a5c2..49353d5ca 100644
--- a/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
+++ b/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
@@ -22,7 +22,9 @@ import java.util.ArrayList;
 import java.util.Properties;
 
 
+import org.apache.hadoop.mapreduce.RecordReader;
 import org.apache.pig.backend.executionengine.ExecException;
+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigSplit;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.PigContext;
@@ -198,5 +200,19 @@ public class PoissonSampleLoader extends SampleLoader {
         }
 
     }
+    
+    @Override
+    public void prepareToRead(RecordReader reader, PigSplit split) throws IOException {
+        super.prepareToRead(reader, split);
+        numRowsSampled = 0;
+        avgTupleMemSz = 0;
+        rowNum = 0;
+        skipInterval = -1;
+        memToSkipPerSample = 0;
+        numRowSplTupleReturned = false;
+        sampleRate = DEFAULT_SAMPLE_RATE;
+        heapPerc = PartitionSkewedKeys.DEFAULT_PERCENT_MEMUSAGE;
+        newSample = null;
+    }
 
 }
diff --git a/src/org/apache/pig/impl/builtin/RandomSampleLoader.java b/src/org/apache/pig/impl/builtin/RandomSampleLoader.java
index 71d831c08..f12767681 100644
--- a/src/org/apache/pig/impl/builtin/RandomSampleLoader.java
+++ b/src/org/apache/pig/impl/builtin/RandomSampleLoader.java
@@ -21,6 +21,8 @@ import java.io.IOException;
 import java.util.Random;
 
 import org.apache.pig.data.Tuple;
+import org.apache.hadoop.mapreduce.RecordReader;
+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigSplit;
 
 /**
  * A loader that samples the data.  
@@ -101,6 +103,13 @@ public class RandomSampleLoader extends SampleLoader {
         return getSample();
     } 
     
+    @Override
+    public void prepareToRead(RecordReader reader, PigSplit split) throws IOException {
+        super.prepareToRead(reader, split);
+        samples = null;
+        nextSampleIdx = 0;
+    }
+    
     private Tuple getSample() {
         if(nextSampleIdx < samples.length){
             return samples[nextSampleIdx++];
