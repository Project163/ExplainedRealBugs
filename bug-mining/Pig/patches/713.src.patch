diff --git a/CHANGES.txt b/CHANGES.txt
index 40a29b487..646cdcffb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -188,6 +188,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-2017: consumeMap() fails with EmptyStackException (thedatachef via daijy)
+
 PIG-1989: complex type casting should return null on casting failure (daijy)
 
 PIG-1826: Unexpected data type -1 found in stream error (daijy)
diff --git a/src/org/apache/pig/builtin/Utf8StorageConverter.java b/src/org/apache/pig/builtin/Utf8StorageConverter.java
index 71259b494..b3c69dc0c 100644
--- a/src/org/apache/pig/builtin/Utf8StorageConverter.java
+++ b/src/org/apache/pig/builtin/Utf8StorageConverter.java
@@ -25,6 +25,7 @@ import java.util.Arrays;
 import java.util.HashMap;
 import java.util.Map;
 import java.util.Stack;
+import java.util.EmptyStackException;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -228,10 +229,12 @@ public class Utf8StorageConverter implements LoadStoreCaster {
                     break;
                 else if (buf==']' ||buf=='}'||buf==')')
                 {
-                    if (level.peek()==findStartChar((char)buf))
-                        level.pop();
-                    else
+                    try {
+                        if (level.peek()==findStartChar((char)buf))
+                            level.pop();
+                    } catch (EmptyStackException e) {
                         throw new IOException("Malformed map");
+                    }
                 } else if (buf==','&&level.isEmpty()) { // Current map item complete
                     break;
                 }
diff --git a/test/org/apache/pig/test/TestConversions.java b/test/org/apache/pig/test/TestConversions.java
index cb77db7f1..05d0655dc 100644
--- a/test/org/apache/pig/test/TestConversions.java
+++ b/test/org/apache/pig/test/TestConversions.java
@@ -340,6 +340,14 @@ public class TestConversions extends TestCase {
         s = "[#]";
         m = ps.getLoadCaster().bytesToMap(s.getBytes());
         assertTrue(m==null);
+
+        s = "[a#}";
+        m = ps.getLoadCaster().bytesToMap(s.getBytes());
+        assertTrue(m==null);
+
+        s = "[a#)";
+        m = ps.getLoadCaster().bytesToMap(s.getBytes());
+        assertTrue(m==null);
         
         s = "(a,b)";
         schema = Utils.getSchemaFromString("t:tuple()");
