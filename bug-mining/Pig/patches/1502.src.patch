diff --git a/CHANGES.txt b/CHANGES.txt
index bbfa90ea4..eaa892484 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -42,6 +42,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4036: Fix e2e failures - JobManagement_3, CmdErrors_3 and BigData_4 (daijy)
+
 PIG-4041: org.apache.pig.backend.hadoop.executionengine.tez.util.MRToTezHelper compiling error (jeagles via cheolsoo)
 
 PIG-4038: SPRINTF should return NULL on any NULL input (mrflip via daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
index 2e69dc661..3a7e795ea 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
@@ -79,6 +79,8 @@ public class POPackage extends PhysicalOperator {
 
     private boolean useDefaultBag = false;
 
+    private boolean lastBagReadOnly = true;
+
     protected Packager pkgr;
 
     protected PigNullableWritable keyWritable;
@@ -196,6 +198,12 @@ public class POPackage extends PhysicalOperator {
                     useDefaultBag = true;
                 }
             }
+            // If multiquery, the last bag is InternalCachedBag and should not
+            // set ReadOnly flag, otherwise we will materialize again to another
+            // InternalCachedBag
+            if (pkgr instanceof MultiQueryPackager) {
+                lastBagReadOnly = false;
+            }
         }
         int numInputs = pkgr.getNumInputs(keyWritable.getIndex());
         boolean[] readOnce = new boolean[numInputs];
@@ -220,7 +228,10 @@ public class POPackage extends PhysicalOperator {
                 }
 
             } else {
-                readOnce[numInputs - 1] = true;
+                if (lastBagReadOnly) {
+                    readOnce[numInputs - 1] = true;
+                }
+
                 // We know the tuples will come sorted by index, so we can wrap
                 // the last input in a ReadOnceBag and let the Packager decide
                 // whether or not to read into memory
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
index a4e4b958b..f7478c3ce 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
@@ -473,6 +473,6 @@ public class Packager implements Illustrable, Serializable, Cloneable {
                 // POJoinPackage in the pipeline and is also blocking the pipeline;
                 // constructor argument should be 2 * numInputs. But for one obscure
                 // case we don't want to pay the penalty all the time.
-                : new InternalCachedBag(numInputs-1);
+                : new InternalCachedBag(numInputs);
     }
 }
diff --git a/src/org/apache/pig/impl/streaming/StreamingCommand.java b/src/org/apache/pig/impl/streaming/StreamingCommand.java
index 17fa30e3c..0c5c2030b 100644
--- a/src/org/apache/pig/impl/streaming/StreamingCommand.java
+++ b/src/org/apache/pig/impl/streaming/StreamingCommand.java
@@ -34,7 +34,7 @@ import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.builtin.PigStreaming;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
-import org.apache.zookeeper.Shell;
+import org.apache.hadoop.util.Shell;
 
 
 /**
