diff --git a/CHANGES.txt b/CHANGES.txt
index 012bc76d9..9a3c4ab71 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -170,6 +170,9 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-1939: order-by statement should support project-range to-end in 
+ any position among the sort columns if input schema is known (thejas)
+
 PIG-1978: Secondary sort fail when dereferencing two fields inside foreach (daijy)
 
 PIG-1962: Wrong alias assinged to store operator (daijy)
diff --git a/src/org/apache/pig/newplan/logical/visitor/ProjectStarExpander.java b/src/org/apache/pig/newplan/logical/visitor/ProjectStarExpander.java
index 585ffb303..48bc7ada8 100644
--- a/src/org/apache/pig/newplan/logical/visitor/ProjectStarExpander.java
+++ b/src/org/apache/pig/newplan/logical/visitor/ProjectStarExpander.java
@@ -77,14 +77,28 @@ public class ProjectStarExpander extends LogicalRelationalNodesVisitor{
 
         if(expPlans.size() != ascOrder.size()){
             throw new AssertionError("Size of expPlans and ascorder should be same");
+        }            
+        
+        for(int i=0; i < expPlans.size(); i++){
+            //expand the plan
+            LogicalExpressionPlan ithExpPlan = expPlans.get(i);
+            List<LogicalExpressionPlan> expandedPlans = expandPlan(ithExpPlan, 0);
+            newExpPlans.addAll(expandedPlans);
+
+            //add corresponding isAsc flags
+            Boolean isAsc = ascOrder.get(i);
+            for(int j=0; j < expandedPlans.size(); j++){
+                newAscOrder.add(isAsc);
+            }
         }
 
         //check if there is a project-star-to-end followed by another sort plan
-        for(int i=0; i < expPlans.size(); i++){
-            ProjectExpression proj = getProjectStar(expPlans.get(i));
+        // in the expanded plans (can happen if there is no input schema)
+        for(int i=0; i < newExpPlans.size(); i++){
+            ProjectExpression proj = getProjectStar(newExpPlans.get(i));
             if(proj != null && 
                     proj.isRangeProject() && proj.getEndCol() == -1 &&
-                    i != expPlans.size() -1
+                    i != newExpPlans.size() -1
             ){
                 //because of order by sampler logic limitation, this is not
                 //supported right now
@@ -97,22 +111,6 @@ public class ProjectStarExpander extends LogicalRelationalNodesVisitor{
                 );
             }
         }
-            
-        
-        for(int i=0; i < expPlans.size(); i++){
-            //expand the plan
-            LogicalExpressionPlan ithExpPlan = expPlans.get(i);
-            List<LogicalExpressionPlan> expandedPlans = expandPlan(ithExpPlan, 0);
-            newExpPlans.addAll(expandedPlans);
-
-            //add corresponding isAsc flags
-            Boolean isAsc = ascOrder.get(i);
-            for(int j=0; j < expandedPlans.size(); j++){
-                newAscOrder.add(isAsc);
-            }
-        }
-
-        
         
         sort.setSortColPlans(newExpPlans);
         sort.setAscendingCols(newAscOrder);
diff --git a/test/org/apache/pig/test/TestProjectRange.java b/test/org/apache/pig/test/TestProjectRange.java
index 68978a3f3..843da22bf 100644
--- a/test/org/apache/pig/test/TestProjectRange.java
+++ b/test/org/apache/pig/test/TestProjectRange.java
@@ -821,7 +821,7 @@ public class TestProjectRange  {
         query =
             "  l1 = load '" + INP_FILE_5FIELDS + 
                     "' as (a : int, b : long, c : int, d : int, e : int);"
-            + " o = order l1 by  b .. c,  a DESC, d .. DESC;"
+            + " o = order l1 by  b .. c, d .. DESC,  a DESC;"
             ; 
         compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int", query, "o");
 
