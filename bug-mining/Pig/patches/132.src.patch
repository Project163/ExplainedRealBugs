diff --git a/CHANGES.txt b/CHANGES.txt
index e1bc5a58d..d12f2ee6a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -310,3 +310,5 @@ Trunk (unreleased changes)
 
     PIG-517: load functiin with parameters does not work with cast (pradeepk
     via olgan)
+
+    PIG-525: make sure cast for udf parameters works (olgan)
diff --git a/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java b/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
index 5f23d5ec8..d9bd99541 100644
--- a/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
+++ b/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
@@ -1422,11 +1422,17 @@ public class TypeCheckingVisitor extends LOVisitor {
             try {
                 currentPlan.connect(input, cast);
                 currentPlan.connect(cast, udf);
+                this.visit(cast);
             } catch (PlanException ioe) {
                 AssertionError err = new AssertionError(
                         "Explicit casting insertion");
                 err.initCause(ioe);
                 throw err;
+            } catch (VisitorException ve) {
+                AssertionError err = new AssertionError(
+                        "Explicit casting insertion");
+                err.initCause(ve);
+                throw err;
             }
         }
         udf.setMArgs(newArgs);
diff --git a/test/org/apache/pig/test/TestBestFitCast.java b/test/org/apache/pig/test/TestBestFitCast.java
index 53bb99a6a..f3eaa4073 100644
--- a/test/org/apache/pig/test/TestBestFitCast.java
+++ b/test/org/apache/pig/test/TestBestFitCast.java
@@ -86,6 +86,34 @@ public class TestBestFitCast extends TestCase {
 
     }
     
+    public static class UDF2 extends EvalFunc<String>{
+        /**
+         * java level API
+         * @param input expects a single numeric DataAtom value
+         * @param output returns a single numeric DataAtom value, cosine value of the argument
+         */
+        @Override
+        public String exec(Tuple input) throws IOException {
+            try{
+                String str = (String)input.get(0);
+                return str.toUpperCase();
+            }catch (Exception e){
+                return null;
+            }
+        }
+
+        /* (non-Javadoc)
+         * @see org.apache.pig.EvalFunc#getArgToFuncMapping()
+         */
+        @Override
+        public List<FuncSpec> getArgToFuncMapping() throws FrontendException {
+            List<FuncSpec> funcList = new ArrayList<FuncSpec>();
+            funcList.add(new FuncSpec(this.getClass().getName(), new Schema(new Schema.FieldSchema(null, DataType.CHARARRAY))));
+            return funcList;
+        }    
+
+    }
+    
     @Test
     public void test1() throws Exception{
         //Passing (long, int)
@@ -173,4 +201,17 @@ public class TestBestFitCast extends TestCase {
         }
         
     }
+
+    @Test
+    public void test6() throws Exception{
+        // test UDF with single mapping function 
+        // where bytearray is passed in as input parameter
+        File input = Util.createInputFile("tmp", "", new String[] {"abc"});
+        pigServer.registerQuery("A = LOAD '" + Util.generateURI(input.toString()) +"';");
+        pigServer.registerQuery("B = FOREACH A GENERATE " + UDF2.class.getName() + "($0);");
+        Iterator<Tuple> iter = pigServer.openIterator("B");
+        if(!iter.hasNext()) fail("No Output received");
+        Tuple t = iter.next();
+        assertEquals("ABC", t.get(0));
+    }
 }
