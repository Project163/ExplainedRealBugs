diff --git a/CHANGES.txt b/CHANGES.txt
index 1995b0a77..92399dde3 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -34,6 +34,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-3515: Shell commands are limited from OS buffer (andronat via cheolsoo)
+
 PIG-3520: Provide backward compatibility for PigRunner and PPNL after PIG-3419 (daijy via cheolsoo)
 
 PIG-3519: Remove dependency on uber avro-tools jar (jarcec via cheolsoo)
diff --git a/src/org/apache/pig/tools/parameters/PreprocessorContext.java b/src/org/apache/pig/tools/parameters/PreprocessorContext.java
index 699296f3c..59ba4f54d 100644
--- a/src/org/apache/pig/tools/parameters/PreprocessorContext.java
+++ b/src/org/apache/pig/tools/parameters/PreprocessorContext.java
@@ -186,19 +186,6 @@ public class PreprocessorContext {
             throw rte;
         }
 
-        int exitVal;
-        try {
-            exitVal = p.waitFor();
-        } catch (InterruptedException e) {
-            RuntimeException rte = new RuntimeException("Interrupted Thread Exception while waiting for command to get over"+e.getMessage() , e);
-            throw rte;
-        }
-
-        if (exitVal != 0) {
-            RuntimeException rte = new RuntimeException("Error executing shell command: " + cmd + ". Command exit with exit code of " + exitVal );
-            throw rte;
-        }
-
         BufferedReader br = null;
         try{
             InputStreamReader isr = new InputStreamReader(p.getInputStream());
@@ -235,6 +222,19 @@ public class PreprocessorContext {
             if (br != null) try {br.close();} catch(Exception e) {}
         }
 
+        int exitVal;
+        try {
+            exitVal = p.waitFor();
+        } catch (InterruptedException e) {
+            RuntimeException rte = new RuntimeException("Interrupted Thread Exception while waiting for command to get over"+e.getMessage() , e);
+            throw rte;
+        }
+
+        if (exitVal != 0) {
+            RuntimeException rte = new RuntimeException("Error executing shell command: " + cmd + ". Command exit with exit code of " + exitVal );
+            throw rte;
+        }
+
         return streamData.trim();
     }
 
