diff --git a/CHANGES.txt b/CHANGES.txt
index 2b46a4dd6..f66e8308f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -147,6 +147,9 @@ PIG-1176: Column Pruner issues in union of loader with and without schema
 PIG-1184: PruneColumns optimization does not handle the case of foreach
 flatten correctly if flattened bag is not used later (daijy)
 
+PIG-1189: StoreFunc UDF should ship to the backend automatically without
+"register" (daijy)
+
 Release 0.6.0 - Unreleased
 
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
index d934ffaa4..2bb5d4e63 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
@@ -732,6 +732,8 @@ public class MRCompiler extends PhyPlanVisitor {
             storeToMapReduceMap.put(op, curMROp);
             nonBlocking(op);
             phyToMROpMap.put(op, curMROp);
+            if (op.getSFile()!=null && op.getSFile().getFuncSpec()!=null)
+                curMROp.UDFs.add(op.getSFile().getFuncSpec().toString());
         }catch(Exception e){
             int errCode = 2034;
             String msg = "Error compiling operator " + op.getClass().getSimpleName();
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceOper.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceOper.java
index 46e4971ad..100f82f8e 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceOper.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceOper.java
@@ -20,8 +20,10 @@ package org.apache.pig.backend.hadoop.executionengine.mapReduceLayer;
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import java.util.ArrayList;
+import java.util.HashSet;
 import java.util.List;
 import java.util.Properties;
+import java.util.Set;
 
 import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.plan.OperatorKey;
@@ -105,7 +107,7 @@ public class MapReduceOper extends Operator<MROpPlanVisitor> {
     // Sort order for secondary keys;
     boolean[] secondarySortOrder;
 
-    public List<String> UDFs;
+    public Set<String> UDFs;
     
     // Indicates if a UDF comparator is used
     boolean isUDFComparatorUsed = false;
@@ -142,7 +144,7 @@ public class MapReduceOper extends Operator<MROpPlanVisitor> {
         mapPlan = new PhysicalPlan();
         combinePlan = new PhysicalPlan();
         reducePlan = new PhysicalPlan();
-        UDFs = new ArrayList<String>();
+        UDFs = new HashSet<String>();
         nig = NodeIdGenerator.getGenerator();
         scope = k.getScope();
     }
diff --git a/src/org/apache/pig/impl/util/JarManager.java b/src/org/apache/pig/impl/util/JarManager.java
index da4ede87a..3403ecfdf 100644
--- a/src/org/apache/pig/impl/util/JarManager.java
+++ b/src/org/apache/pig/impl/util/JarManager.java
@@ -32,6 +32,7 @@ import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 import java.util.Vector;
 import java.util.jar.JarEntry;
 import java.util.jar.JarInputStream;
@@ -96,7 +97,7 @@ public class JarManager {
      * @throws ClassNotFoundException
      * @throws IOException
      */
-    public static void createJar(OutputStream os, List<String> funcs, PigContext pigContext) throws ClassNotFoundException, IOException {
+    public static void createJar(OutputStream os, Set<String> funcs, PigContext pigContext) throws ClassNotFoundException, IOException {
         Vector<JarListEntry> jarList = new Vector<JarListEntry>();
         for(String toSend: pigPackagesToSend) {
             addContainingJar(jarList, PigMapReduce.class, toSend, pigContext);
diff --git a/test/org/apache/pig/test/TestMRCompiler.java b/test/org/apache/pig/test/TestMRCompiler.java
index 635ee228e..1498f867d 100644
--- a/test/org/apache/pig/test/TestMRCompiler.java
+++ b/test/org/apache/pig/test/TestMRCompiler.java
@@ -914,8 +914,9 @@ public class TestMRCompiler extends junit.framework.TestCase {
         MapReduceOper mrOper = mrPlan.getRoots().get(0);
         
         assertTrue(mrOper.UDFs.size()==2);
-        assertTrue(mrOper.UDFs.get(0).equals("BinStorage"));
-        assertTrue(mrOper.UDFs.get(1).equals("org.apache.pig.builtin.PigStorage"));
+        assertTrue(mrOper.UDFs.size()==2);
+        assertTrue(mrOper.UDFs.contains("BinStorage"));
+        assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
     }
 
     @Test
diff --git a/test/org/apache/pig/test/data/GoldenFiles/MRC15.gld b/test/org/apache/pig/test/data/GoldenFiles/MRC15.gld
index 53c23d272..7577d7fc7 100644
--- a/test/org/apache/pig/test/data/GoldenFiles/MRC15.gld
+++ b/test/org/apache/pig/test/data/GoldenFiles/MRC15.gld
@@ -26,7 +26,7 @@ MapReduce(1,GFCross) - -156:
     |   |
     |   |---Load(file:/tmp/temp-1456742965/tmp-26634357:org.apache.pig.builtin.BinStorage) - -152
     |
-    |---MapReduce(20,TestMRCompiler$WeirdComparator,COUNT,SUM) - -145:
+    |---MapReduce(20,SUM,COUNT,TestMRCompiler$WeirdComparator) - -145:
         |   Store(file:/tmp/temp-1456742965/tmp-26634357:org.apache.pig.builtin.BinStorage) - -151
         |   |
         |   |---New For Each(false,false)[tuple] - -2197807331204639125
@@ -88,4 +88,4 @@ MapReduce(1,GFCross) - -156:
                 |       |   |
                 |       |   Constant(true) - --6860857982727545176
                 |       |
-                |       |---Load(DummyFil:DummyLdr) - -737965411848544085
\ No newline at end of file
+                |       |---Load(DummyFil:DummyLdr) - -737965411848544085
diff --git a/test/org/apache/pig/test/utils/GenPhyOp.java b/test/org/apache/pig/test/utils/GenPhyOp.java
index f5d892e07..edcdfc1d4 100644
--- a/test/org/apache/pig/test/utils/GenPhyOp.java
+++ b/test/org/apache/pig/test/utils/GenPhyOp.java
@@ -762,7 +762,6 @@ public class GenPhyOp{
 
     public static POStore topStoreOp() {
         POStore ret = new POStore(new OperatorKey("", r.nextLong()));
-        ret.setSFile(new FileSpec("DummyFil", new FuncSpec("DummyLdr")));
         return ret;
     }
 
