diff --git a/CHANGES.txt b/CHANGES.txt
index 7d62f4346..f024a2364 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -157,6 +157,8 @@ PIG-3882: Multiquery off mode execution is not done in batch and very inefficien
  
 BUG FIXES
 
+PIG-3915: MapReduce queries in Pigmix outputs different results than Pig's (keren3000 via daijy)
+
 PIG-3955: Remove url.openStream() file descriptor leak from JCC (aniket486)
 
 PIG-3958: TestMRJobStats is broken in 0.13 and trunk (aniket486)
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L1.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L1.java
index 2e38f0cd7..211df4d66 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L1.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L1.java
@@ -21,28 +21,24 @@ import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
-import java.util.Properties;
 import java.util.Map;
+import java.util.Properties;
 
 import org.apache.hadoop.fs.Path;
-import org.apache.hadoop.io.Text;
 import org.apache.hadoop.io.IntWritable;
 import org.apache.hadoop.io.LongWritable;
+import org.apache.hadoop.io.Text;
 import org.apache.hadoop.mapred.FileInputFormat;
 import org.apache.hadoop.mapred.FileOutputFormat;
 import org.apache.hadoop.mapred.JobConf;
-import org.apache.hadoop.mapred.KeyValueTextInputFormat;
-import org.apache.hadoop.mapred.Mapper;
 import org.apache.hadoop.mapred.MapReduceBase;
+import org.apache.hadoop.mapred.Mapper;
 import org.apache.hadoop.mapred.OutputCollector;
 import org.apache.hadoop.mapred.Reducer;
 import org.apache.hadoop.mapred.Reporter;
 import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
-import org.apache.hadoop.mapred.lib.IdentityMapper;
-
-import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L1 {
 
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L10.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L10.java
index f753f3242..17bdfa2a9 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L10.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L10.java
@@ -45,7 +45,6 @@ import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
 import org.apache.hadoop.mapred.lib.IdentityMapper;
-
 import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L10 {
@@ -127,9 +126,8 @@ public class L10 {
 
         public int getPartition(MyType key, Text value, int numPartitions) {
             int rc = 0;
-            if (key.query_term == null || key.query_term.length() < 2) return 39;
-            if (key.query_term.charAt(0) > ']') rc += 20;
-            rc += map.get(key.query_term.charAt(1));
+            if (key==null || key.query_term == null ||  key.query_term.length() < 1 ) return 0;
+            rc += map.get(key.query_term.charAt(0));
             return rc;
         }
 
@@ -137,65 +135,65 @@ public class L10 {
             // Don't actually do any configuration, do the setup of the hash
             // because this call is guaranteed to be made each time we set up
             // MyPartitioner
-            map = new HashMap<Character, Integer>(57);
-            map.put('A', 0);
+            map = new HashMap<Character, Integer>(59);
+            map.put('A', 1);
             map.put('B', 1);
             map.put('C', 2);
-            map.put('D', 3);
-            map.put('E', 4);
-            map.put('F', 5);
-            map.put('G', 6);
-            map.put('I', 7);
-            map.put('H', 8);
-            map.put('J', 9);
-            map.put('K', 10);
-            map.put('L', 11);
-            map.put('M', 12);
-            map.put('N', 13);
-            map.put('O', 14);
-            map.put('P', 15);
-            map.put('Q', 16);
-            map.put('R', 17);
-            map.put('S', 18);
-            map.put('T', 19);
-            map.put('U', 0);
-            map.put('V', 1);
-            map.put('W', 2);
-            map.put('X', 3);
-            map.put('Y', 4);
-            map.put('Z', 5);
-            map.put('[', 6);
-            map.put('\\', 7);
-            map.put(']', 8);
-            map.put('^', 9);
-            map.put('_', 10);
-            map.put('`', 11);
-            map.put('a', 12);
-            map.put('b', 13);
-            map.put('c', 14);
-            map.put('d', 15);
-            map.put('e', 16);
-            map.put('f', 17);
-            map.put('g', 18);
-            map.put('h', 19);
-            map.put('i', 0);
-            map.put('j', 1);
-            map.put('k', 2);
-            map.put('l', 3);
-            map.put('m', 4);
-            map.put('n', 5);
-            map.put('o', 6);
-            map.put('p', 7);
-            map.put('q', 8);
-            map.put('r', 9);
-            map.put('s', 10);
-            map.put('t', 11);
-            map.put('u', 12);
-            map.put('v', 13);
-            map.put('w', 14);
-            map.put('x', 15);
-            map.put('y', 16);
-            map.put('z', 17);
+            map.put('D', 2);
+            map.put('E', 3);
+            map.put('F', 3);
+            map.put('G', 4);
+            map.put('H', 4);
+            map.put('I', 5);
+            map.put('J', 5);
+            map.put('K', 6);
+            map.put('L', 6);
+            map.put('M', 7);
+            map.put('N', 7);
+            map.put('O', 8);
+            map.put('P', 8);
+            map.put('Q', 9);
+            map.put('R', 9);
+            map.put('S', 10);
+            map.put('T', 10);
+            map.put('U', 11);
+            map.put('V', 11);
+            map.put('W', 12);
+            map.put('X', 12);
+            map.put('Y', 13);
+            map.put('Z', 13);
+            map.put('[', 14);
+            map.put('\\', 14);
+            map.put(']', 15);
+            map.put('^', 15);
+            map.put('_', 16);
+            map.put('`', 16);
+            map.put('a', 17);
+            map.put('b', 17);
+            map.put('c', 18);
+            map.put('d', 18);
+            map.put('e', 19);
+            map.put('f', 20);
+            map.put('g', 20);
+            map.put('h', 21);
+            map.put('i', 22);
+            map.put('j', 23);
+            map.put('k', 24);
+            map.put('l', 25);
+            map.put('m', 26);
+            map.put('n', 27);
+            map.put('o', 28);
+            map.put('p', 29);
+            map.put('q', 30);
+            map.put('r', 31);
+            map.put('s', 32);
+            map.put('t', 33);
+            map.put('u', 34);
+            map.put('v', 35);
+            map.put('w', 36);
+            map.put('x', 37);
+            map.put('y', 38);
+            map.put('z', 39);
         }
     }
 
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L12.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L12.java
index 1d9298148..67aa5af2e 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L12.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L12.java
@@ -58,8 +58,8 @@ public class L12 {
 
             List<Text> fields = Library.splitLine(val, '');
 
-            // Filter out null users and query terms.
-            if (fields.get(0).getLength() == 0 &&
+            // Filter out null users or query terms.
+            if (fields.get(0).getLength() == 0 ||
                     fields.get(3).getLength() == 0) return;
             try {
                 oc.collect(fields.get(0),
@@ -74,13 +74,12 @@ public class L12 {
                 Iterator<DoubleWritable> iter, 
                 OutputCollector<Text, DoubleWritable> oc,
                 Reporter reporter) throws IOException {
-            double max = Double.MIN_VALUE;
+            double max = Double.NEGATIVE_INFINITY;
 
             while (iter.hasNext()) {
                 double d = iter.next().get();
-                max = max > d ? max : d;
+            	if (max < d) max=d;
             }
-
             oc.collect(key, new DoubleWritable(max));
         }
     }
@@ -129,24 +128,22 @@ public class L12 {
                 OutputCollector<Text, LongWritable> oc,
                 Reporter reporter) throws IOException {
             List<Text> fields = Library.splitLine(val, '');
-
+            
             // Filter out non-null users and non-null queries
-            if (fields.get(0).getLength() != 0 ||
-                    fields.get(3).getLength() != 0) return;
+            if (fields.get(0).getLength() == 0 || fields.get(3).getLength() != 0) return;
             oc.collect(fields.get(1), new LongWritable(1));
-
-        }
+       }
 
         public void reduce(
                 Text key,
                 Iterator<LongWritable> iter, 
                 OutputCollector<Text, LongWritable> oc,
                 Reporter reporter) throws IOException {
-            long cnt = 0;
-
+  
+        	long cnt = 0;
             while (iter.hasNext()) {
-                iter.next();
-                cnt++;
+                LongWritable l = iter.next();
+            	cnt += l.get();
             }
             oc.collect(key, new LongWritable(cnt));
         }
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L15.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L15.java
index 8e067d7a3..7d3433043 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L15.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L15.java
@@ -19,6 +19,7 @@ package org.apache.pig.test.pigmix.mapreduce;
 
 import java.io.IOException;
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.HashSet;
 import java.util.Iterator;
 import java.util.List;
@@ -41,7 +42,6 @@ import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
 import org.apache.hadoop.mapred.lib.IdentityMapper;
-
 import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L15 {
@@ -81,8 +81,10 @@ public class L15 {
             HashSet<Text> hash1 = new HashSet<Text>();
             HashSet<Text> hash2 = new HashSet<Text>();
             HashSet<Text> hash3 = new HashSet<Text>();
+            int cnt_per_combiner = 0;
             while (iter.hasNext()) {
                 List<Text> vals = Library.splitLine(iter.next(), '');
+                cnt_per_combiner++;
                 try {
 					hash1.add(vals.get(0));
 					hash2.add(vals.get(1));
@@ -104,6 +106,8 @@ public class L15 {
             sb.append("");
             sb.append(ts.toString());
             sb.append("");
+            sb.append(cnt_per_combiner);
+            sb.append("");
             oc.collect(key, new Text(sb.toString()));
             reporter.setStatus("OK");
         }
@@ -120,27 +124,33 @@ public class L15 {
             HashSet<Text> hash2 = new HashSet<Text>();
             HashSet<Text> hash3 = new HashSet<Text>();
             while (iter.hasNext()) {
-                List<Text> vals = Library.splitLine(iter.next(), '');
-                try {
+				Text line = iter.next();
+				List<Text> vals = Library.splitLine(line, '');
+				try {
 					hash1.add(vals.get(0));
 					hash2.add(vals.get(1));
 					hash3.add(vals.get(2));
 				}catch(NumberFormatException nfe) {
 				}
 			}
-			Integer ts=0;
-			Double rev=new Double(0.0);
-            for (Text t : hash2) rev += Double.valueOf(t.toString());
-            for (Text t : hash3) ts += Integer.valueOf(t.toString());
-            StringBuffer sb = new StringBuffer();
+
+			Integer ts = 0;
+			Double rev = new Double(0.0);
+			Integer overall_cnt_per_group = new Integer(0);
+			for (Text t : hash2)
+				rev += Double.valueOf(t.toString());
+			for (Text t : hash3)
+				ts += Integer.valueOf(t.toString());
+			StringBuffer sb = new StringBuffer();
 			sb.append((new Integer(hash1.size())).toString());
-            sb.append("");
-            sb.append(rev.toString());
-            sb.append("");
-            sb.append(ts.toString());
-            oc.collect(key, new Text(sb.toString()));
-            reporter.setStatus("OK");
-        }
+			sb.append("");
+			sb.append(rev.toString());
+			sb.append("");
+			Double avg = (double) ((Integer.valueOf(ts.toString())) / hash3.size());
+			sb.append(avg);
+			oc.collect(key, new Text(sb.toString()));
+			reporter.setStatus("OK");
+		}
     }
 
     public static void main(String[] args) throws IOException {
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L2.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L2.java
index 2de2bb063..94a766bb0 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L2.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L2.java
@@ -19,39 +19,31 @@ package org.apache.pig.test.pigmix.mapreduce;
 
 import java.io.BufferedReader;
 import java.io.FileInputStream;
-import java.io.InputStreamReader;
 import java.io.IOException;
+import java.io.InputStreamReader;
 import java.net.URI;
 import java.net.URISyntaxException;
 import java.util.ArrayList;
 import java.util.HashSet;
-import java.util.Iterator;
 import java.util.List;
-import java.util.Set;
-import java.util.Properties;
 import java.util.Map;
+import java.util.Properties;
+import java.util.Set;
 
-import org.apache.hadoop.fs.FileSystem;
-import org.apache.hadoop.fs.FSDataInputStream;
+import org.apache.hadoop.filecache.DistributedCache;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.io.LongWritable;
 import org.apache.hadoop.io.Text;
-import org.apache.hadoop.filecache.DistributedCache;
 import org.apache.hadoop.mapred.FileInputFormat;
 import org.apache.hadoop.mapred.FileOutputFormat;
 import org.apache.hadoop.mapred.JobConf;
-import org.apache.hadoop.mapred.KeyValueTextInputFormat;
-import org.apache.hadoop.mapred.Mapper;
 import org.apache.hadoop.mapred.MapReduceBase;
+import org.apache.hadoop.mapred.Mapper;
 import org.apache.hadoop.mapred.OutputCollector;
-import org.apache.hadoop.mapred.Reducer;
 import org.apache.hadoop.mapred.Reporter;
 import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
-import org.apache.hadoop.mapred.lib.IdentityMapper;
-
-import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L2 {
 
@@ -78,6 +70,7 @@ public class L2 {
                     String[] fields = line.split("");
                     hash.add(fields[0]);
                 }
+                reader.close();
             } catch (IOException ioe) {
                 throw new RuntimeException(ioe);
             }
@@ -92,7 +85,6 @@ public class L2 {
             List<Text> fields = Library.splitLine(val, '');
             String name = fields.get(0).toString();
 
-            String v;
             if (hash.contains(name)) {
                 StringBuffer sb = new StringBuffer();
                 sb.append(name);
@@ -112,7 +104,6 @@ public class L2 {
         }
         String inputDir = args[0];
         String outputDir = args[1];
-        String parallel = args[2];
         JobConf lp = new JobConf(L2.class);
         lp.setJobName("L2 Load Page Views");
         lp.setInputFormat(TextInputFormat.class);
@@ -123,8 +114,7 @@ public class L2 {
         for (Map.Entry<Object,Object> entry : props.entrySet()) {
             lp.set((String)entry.getKey(), (String)entry.getValue());
         }
-        DistributedCache.addCacheFile(
-            new URI(inputDir + "/power_users"), lp);
+        DistributedCache.addCacheFile(new URI(inputDir + "/power_users"), lp);
         FileInputFormat.addInputPath(lp, new Path(inputDir + "/page_views"));
         FileOutputFormat.setOutputPath(lp, new Path(outputDir + "/L2out"));
         lp.setNumReduceTasks(0);
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L3.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L3.java
index 43d17c82d..34a0cb567 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L3.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L3.java
@@ -127,7 +127,6 @@ public class L3 {
         String inputDir = args[0];
         String outputDir = args[1];
         String parallel = args[2];
-        String user = System.getProperty("user.name");
         JobConf lp = new JobConf(L3.class);
         lp.setJobName("L3 Load Page Views");
         lp.setInputFormat(TextInputFormat.class);
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L5.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L5.java
index 12d8a3acd..1560077c2 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L5.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L5.java
@@ -92,12 +92,14 @@ public class L5 {
             int cnt = 0;
 
             while (iter.hasNext()) {
-                if (iter.next().toString().charAt(0) == '2') cnt++;
-                reporter.setStatus("OK");
+		//As soon as a value for that name appears in the 'users' table, exclude the tuple by a return
+                if (iter.next().toString().charAt(0) == '2') return;
+		reporter.setStatus("OK");
             }
 
-            oc.collect(null, key);
-            reporter.setStatus("OK");
+	    oc.collect(null, key);
+	    reporter.setStatus("OK");
+	   
         }
     }
 
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L6.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L6.java
index 4fac7fe6f..5e7fe9251 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L6.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L6.java
@@ -68,10 +68,8 @@ public class L6 {
             sb.append("");
             sb.append(fields.get(5).toString());
             Text key = new Text(sb.toString());
-
             try {
-                oc.collect(fields.get(0),
-                    new IntWritable(Integer.valueOf(fields.get(3).toString())));
+                oc.collect(key,new IntWritable(Integer.valueOf(fields.get(2).toString())));
             } catch (NumberFormatException nfe) {
             }
         }
@@ -91,6 +89,7 @@ public class L6 {
             }
             oc.collect(key, new IntWritable(sum));
             reporter.setStatus("OK");
+           
         }
     }
 
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L7.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L7.java
index 377838556..f668aa79e 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L7.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L7.java
@@ -81,7 +81,7 @@ public class L7 {
             }
             StringBuffer sb = new StringBuffer();
             sb.append((new Integer(morning)).toString());
-            sb.append("");
+            sb.append('');
             sb.append((new Integer(afternoon)).toString());
             oc.collect(key, new Text(sb.toString()));
             reporter.setStatus("OK");
@@ -98,11 +98,14 @@ public class L7 {
                 Reporter reporter) throws IOException {
             int morning = 0, afternoon = 0;
             while (iter.hasNext()) {
-                List<Text> vals = Library.splitLine(iter.next(), '');
+            	List<Text> vals = Library.splitLine(iter.next(), '');
                 try {
                     morning += Integer.valueOf(vals.get(0).toString());
-                    if (vals.size() > 1) afternoon += Integer.valueOf(vals.get(1).toString());
+                    if (vals.size() > 1) {
+                    	afternoon += Integer.valueOf(vals.get(1).toString());
+                    }
                 } catch (NumberFormatException nfe) {
+                	System.out.println(nfe);
                 }
             }
             StringBuffer sb = new StringBuffer();
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L8.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L8.java
index ea5d32533..f68150370 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L8.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L8.java
@@ -41,7 +41,6 @@ import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
 import org.apache.hadoop.mapred.lib.IdentityMapper;
-
 import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L8 {
@@ -78,7 +77,7 @@ public class L8 {
             int tsSum = 0, erCnt = 0;
             double erSum = 0.0;
             while (iter.hasNext()) {
-                List<Text> vals = Library.splitLine(iter.next(), '');
+            	 List<Text> vals = Library.splitLine(iter.next(), '');
                 try {
                     tsSum += Integer.valueOf(vals.get(0).toString());
                     erSum += Double.valueOf(vals.get(1).toString());
@@ -109,9 +108,10 @@ public class L8 {
             while (iter.hasNext()) {
                 List<Text> vals = Library.splitLine(iter.next(), '');
                 try {
-                    tsSum += Integer.valueOf(vals.get(0).toString());
-                    erSum += Double.valueOf(vals.get(1).toString());
-                    erCnt++;
+                        tsSum += Integer.valueOf(vals.get(0).toString());
+	                    erSum += Double.valueOf(vals.get(1).toString());
+	                    erCnt += Integer.valueOf(vals.get(2).toString());
+                	                    
                 } catch (NumberFormatException nfe) {
                 }
             }
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L9.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L9.java
index d3c8c7f4b..d91d57667 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L9.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/L9.java
@@ -31,7 +31,6 @@ import org.apache.hadoop.io.LongWritable;
 import org.apache.hadoop.mapred.FileInputFormat;
 import org.apache.hadoop.mapred.FileOutputFormat;
 import org.apache.hadoop.mapred.JobConf;
-import org.apache.hadoop.mapred.KeyValueTextInputFormat;
 import org.apache.hadoop.mapred.Mapper;
 import org.apache.hadoop.mapred.MapReduceBase;
 import org.apache.hadoop.mapred.OutputCollector;
@@ -41,8 +40,6 @@ import org.apache.hadoop.mapred.Reporter;
 import org.apache.hadoop.mapred.TextInputFormat;
 import org.apache.hadoop.mapred.jobcontrol.Job;
 import org.apache.hadoop.mapred.jobcontrol.JobControl;
-import org.apache.hadoop.mapred.lib.IdentityMapper;
-
 import org.apache.pig.test.pigmix.mapreduce.Library;
 
 public class L9 {
@@ -60,7 +57,7 @@ public class L9 {
             List<Text> fields = Library.splitLine(val, '');
             if (fields.size() != 9) return;
 
-            oc.collect(fields.get(0), val);
+            oc.collect(fields.get(3), val);
         }
     }
 
@@ -71,9 +68,8 @@ public class L9 {
         public int getPartition(Text key, Text value, int numPartitions) {
             int rc = 0;
             String s = key.toString();
-            if (s == null || s.length() < 2) return 39;
-            if (s.charAt(0) > ']') rc += 20;
-            rc += map.get(s.charAt(1));
+            if (s == null || s.length() < 1)  return 0;
+            rc += map.get(s.charAt(0));
             return rc;
         }
 
@@ -81,65 +77,65 @@ public class L9 {
             // Don't actually do any configuration, do the setup of the hash
             // because this call is guaranteed to be made each time we set up
             // MyPartitioner
-            map = new HashMap<Character, Integer>(57);
-            map.put('A', 0);
+            map = new HashMap<Character, Integer>(59);
+            map.put('A', 1);
             map.put('B', 1);
             map.put('C', 2);
-            map.put('D', 3);
-            map.put('E', 4);
-            map.put('F', 5);
-            map.put('G', 6);
-            map.put('I', 7);
-            map.put('H', 8);
-            map.put('J', 9);
-            map.put('K', 10);
-            map.put('L', 11);
-            map.put('M', 12);
-            map.put('N', 13);
-            map.put('O', 14);
-            map.put('P', 15);
-            map.put('Q', 16);
-            map.put('R', 17);
-            map.put('S', 18);
-            map.put('T', 19);
-            map.put('U', 0);
-            map.put('V', 1);
-            map.put('W', 2);
-            map.put('X', 3);
-            map.put('Y', 4);
-            map.put('Z', 5);
-            map.put('[', 6);
-            map.put('\\', 7);
-            map.put(']', 8);
-            map.put('^', 9);
-            map.put('_', 10);
-            map.put('`', 11);
-            map.put('a', 12);
-            map.put('b', 13);
-            map.put('c', 14);
-            map.put('d', 15);
-            map.put('e', 16);
-            map.put('f', 17);
-            map.put('g', 18);
-            map.put('h', 19);
-            map.put('i', 0);
-            map.put('j', 1);
-            map.put('k', 2);
-            map.put('l', 3);
-            map.put('m', 4);
-            map.put('n', 5);
-            map.put('o', 6);
-            map.put('p', 7);
-            map.put('q', 8);
-            map.put('r', 9);
-            map.put('s', 10);
-            map.put('t', 11);
-            map.put('u', 12);
-            map.put('v', 13);
-            map.put('w', 14);
-            map.put('x', 15);
-            map.put('y', 16);
-            map.put('z', 17);
+            map.put('D', 2);
+            map.put('E', 3);
+            map.put('F', 3);
+            map.put('G', 4);
+            map.put('H', 4);
+            map.put('I', 5);
+            map.put('J', 5);
+            map.put('K', 6);
+            map.put('L', 6);
+            map.put('M', 7);
+            map.put('N', 7);
+            map.put('O', 8);
+            map.put('P', 8);
+            map.put('Q', 9);
+            map.put('R', 9);
+            map.put('S', 10);
+            map.put('T', 10);
+            map.put('U', 11);
+            map.put('V', 11);
+            map.put('W', 12);
+            map.put('X', 12);
+            map.put('Y', 13);
+            map.put('Z', 13);
+            map.put('[', 14);
+            map.put('\\', 14);
+            map.put(']', 15);
+            map.put('^', 15);
+            map.put('_', 16);
+            map.put('`', 16);
+            map.put('a', 17);
+            map.put('b', 17);
+            map.put('c', 18);
+            map.put('d', 18);
+            map.put('e', 19);
+            map.put('f', 20);
+            map.put('g', 20);
+            map.put('h', 21);
+            map.put('i', 22);
+            map.put('j', 23);
+            map.put('k', 24);
+            map.put('l', 25);
+            map.put('m', 26);
+            map.put('n', 27);
+            map.put('o', 28);
+            map.put('p', 29);
+            map.put('q', 30);
+            map.put('r', 31);
+            map.put('s', 32);
+            map.put('t', 33);
+            map.put('u', 34);
+            map.put('v', 35);
+            map.put('w', 36);
+            map.put('x', 37);
+            map.put('y', 38);
+            map.put('z', 39);
         }
     }
 
diff --git a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/Library.java b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/Library.java
index a45e674d8..ac0192ef7 100644
--- a/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/Library.java
+++ b/test/perf/pigmix/src/java/org/apache/pig/test/pigmix/mapreduce/Library.java
@@ -39,7 +39,7 @@ public class Library {
             }
         }
         // Grab the last one.
-        if (start != s.length() - 1) cols.add(new Text(s.substring(start)));
+        if (start != s.length()) cols.add(new Text(s.substring(start)));
 
         return cols;
     }
