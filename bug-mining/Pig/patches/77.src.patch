diff --git a/CHANGES.txt b/CHANGES.txt
index 050772e98..006d0091c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -191,3 +191,7 @@ Trunk (unreleased changes)
     PIG-422: cross is broken (shravanmn via olgan)
 
     PIG-407: need to clone operators (pradeepk vi olgan)
+
+    PIG-428: TypeCastInserter does not replace projects in inner plans
+    correctly (pradeepk vi olgan)
+
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java b/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
index 289d2196c..75626ac79 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
@@ -73,15 +73,17 @@ public abstract class LogicalTransformer extends Transformer<LogicalOperator, Lo
     private class ProjectFixerUpper extends LOVisitor {
 
         private LogicalOperator mNewNode;
+        private LogicalOperator mOldNode;
         private Map<Integer, Integer> mProjectionMapping;
 
         ProjectFixerUpper(
                 LogicalPlan plan,
-                LogicalOperator newNode,
-                Map<Integer, Integer> projectionMapping) {
+                LogicalOperator oldNode,
+                LogicalOperator newNode, Map<Integer, Integer> projectionMapping) {
             super(plan,
                 new DepthFirstWalker<LogicalOperator, LogicalPlan>(plan));
             mNewNode = newNode;
+            mOldNode = oldNode;
             mProjectionMapping = projectionMapping;
         }
 
@@ -109,8 +111,9 @@ public abstract class LogicalTransformer extends Transformer<LogicalOperator, Lo
             // outside the plan).
             List<LogicalOperator> preds = mPlan.getPredecessors(p);
             if (preds == null || preds.size() == 0) {
-                // Change the expression
-                p.setExpression(mNewNode);
+                if(p.getExpression().equals(mOldNode))
+                    // Change the expression
+                    p.setExpression(mNewNode);
 
                 // Remap the projection column if necessary
                 if (mProjectionMapping != null && !p.isStar()) {
@@ -209,7 +212,7 @@ public abstract class LogicalTransformer extends Transformer<LogicalOperator, Lo
         
         for (LogicalPlan lp : plans) {
             ProjectFixerUpper pfu =
-                new ProjectFixerUpper(lp, newNode, projectionMapping);
+                new ProjectFixerUpper(lp, after, newNode, projectionMapping);
             pfu.visit();
         }
     }
@@ -302,7 +305,7 @@ public abstract class LogicalTransformer extends Transformer<LogicalOperator, Lo
 	        
 	        for (LogicalPlan lp : plans) {
 	            ProjectFixerUpper pfu =
-	                new ProjectFixerUpper(lp, after, projectionMapping);
+	                new ProjectFixerUpper(lp, nodeToRemove, after, projectionMapping);
 	            pfu.visit();
 	        }
 	
