diff --git a/CHANGES.txt b/CHANGES.txt
index 50afe8b85..234073e4f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -70,6 +70,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4169: NPE in ConstantCalculator (cheolsoo)
+
 PIG-4161: check for latest Hive snapshot dependencies (daijy)
 
 PIG-4102: Adding e2e tests and several improvements for Orc predicate pushdown (daijy)
diff --git a/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java b/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java
index cb829a55b..761781c1e 100644
--- a/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java
+++ b/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java
@@ -27,6 +27,7 @@ import java.util.Map;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
+import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.logicalLayer.FrontendException;
@@ -148,12 +149,15 @@ public abstract class ConstantCalculator extends Rule {
                     PhysicalOperator root = expPhysicalPlan.getLeaves().get(0);
                     try {
                         UDFContext.getUDFContext().addJobConf(ConfigurationUtil.toConfiguration(pc.getProperties(), true));
-                        val = root.getNext(root.getResultType()).result;
+                        Result ret= root.getNext(root.getResultType());
+                        if (ret.result != null) {
+                            val = ret.result;
+                            valSet = true;
+                        }
                         UDFContext.getUDFContext().addJobConf(null);
                     } catch (ExecException e) {
                         throw new FrontendException(e);
                     }
-                    valSet = true;
                 } else if (op instanceof UserFuncExpression) {
                     // If solo UDF, calculate UDF
                     UserFuncExpression udf = (UserFuncExpression)op;
