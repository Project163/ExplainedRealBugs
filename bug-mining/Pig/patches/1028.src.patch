diff --git a/CHANGES.txt b/CHANGES.txt
index cff4a62c7..24b31c3d9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -242,6 +242,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-2848: TestBuiltInBagToTupleOrString fails now that mock.Storage enforces not overwriting output (julien)
+
 PIG-2884: JobControlCompiler mis-logs after reducer estimation (billgraham)
 
 PIG-2876: Bump up Xerces version (jcoveney)
diff --git a/test/org/apache/pig/test/TestBuiltInBagToTupleOrString.java b/test/org/apache/pig/test/TestBuiltInBagToTupleOrString.java
index 390b6f8bf..8da461c9c 100644
--- a/test/org/apache/pig/test/TestBuiltInBagToTupleOrString.java
+++ b/test/org/apache/pig/test/TestBuiltInBagToTupleOrString.java
@@ -40,11 +40,11 @@ import static org.apache.pig.builtin.mock.Storage.*;
 import org.junit.Test;
 
 /**
- * 
+ *
  * Test cases for BagToTuple and BagToString UDFs
- * 
+ *
  * @author hluu
- * 
+ *
  */
 public class TestBuiltInBagToTupleOrString {
 	private BagFactory bf = BagFactory.getInstance();
@@ -58,7 +58,7 @@ public class TestBuiltInBagToTupleOrString {
 		Tuple output = udf.exec(udfInput);
 		assertNull(output);
 	}
-	
+
 	@Test
 	public void testBasicBagToTupleUDF() throws Exception {
 
@@ -202,12 +202,12 @@ public class TestBuiltInBagToTupleOrString {
 		// input contains tuple instead of bag
 		udfInput.set(0, tf.newTuple());
 		BagToTuple udf = new BagToTuple();
-		
+
 		// expecting an exception because the input if of type Tuple, not DataBag
 		udf.exec(udfInput);
 	}
 
-	
+
 	@Test
 	public void testNullInputBagToStringUDF() throws Exception {
 		BagToString udf = new BagToString();
@@ -216,7 +216,7 @@ public class TestBuiltInBagToTupleOrString {
 		String output = udf.exec(udfInput);
 		assertNull(output);
 	}
-	
+
 	@Test(expected=org.apache.pig.backend.executionengine.ExecException.class)
 	public void testInvalidInputForBagToStringUDF() throws Exception {
 		TupleFactory tf = TupleFactory.getInstance();
@@ -224,7 +224,7 @@ public class TestBuiltInBagToTupleOrString {
 		// input contains tuple instead of bag
 		udfInput.set(0, tf.newTuple());
 		BagToString udf = new BagToString();
-		
+
 		// expecting an exception because the input if of type Tuple, not DataBag
 		udf.exec(udfInput);
 	}
@@ -253,7 +253,7 @@ public class TestBuiltInBagToTupleOrString {
 
 		assertEquals("a_5_c_6", result);
 	}
-	
+
 	@Test
 	public void testBasicBagToStringUDF() throws Exception {
 		BagFactory bf = BagFactory.getInstance();
@@ -307,25 +307,25 @@ public class TestBuiltInBagToTupleOrString {
 		udfInput.set(0, inputBag);
 		udfInput.set(1, "_");
 		String result = udf.exec(udfInput);
-		
+
 		assertEquals("a_5_c_6_(d,7)", result);
 	}
-	
+
 	@Test
 	public void testNestedDataElementsForBagToStringUDF() throws Exception {
 
 		DataBag inputBag = buildBagWithNestedTupleAndBag();
-		
+
 		BagToString udf = new BagToString();
 		Tuple udfInput = tf.newTuple(2);
 		udfInput.set(0, inputBag);
 		udfInput.set(1, "*");
-		
+
 		String result = udf.exec(udfInput);
 		assertEquals("a*5*c*6*(d,7)*{(in bag,10)}", result);
 	}
 
-	
+
 	@Test(expected=java.lang.RuntimeException.class)
 	public void testInvalidZeroInputToOutputSchemaForBagToTupleStringUDF() throws Exception {
 
@@ -337,9 +337,9 @@ public class TestBuiltInBagToTupleOrString {
 
 		assertEquals("schema of BagToTuple input", outputSchema.getField(0).type,
 				DataType.CHARARRAY);
-		
+
 	}
-	
+
 	@Test
 	public void testOutputSchemaForBagToTupleStringUDF() throws Exception {
 
@@ -360,9 +360,9 @@ public class TestBuiltInBagToTupleOrString {
 
 		assertEquals("schema of BagToTuple input", outputSchema.getField(0).type,
 				DataType.CHARARRAY);
-		
+
 	}
-	
+
 	@Test
 	public void testOutputSchemaWithDefaultDelimiterForBagToTupleStringUDF() throws Exception {
 
@@ -382,9 +382,9 @@ public class TestBuiltInBagToTupleOrString {
 
 		assertEquals("schema of BagToTuple input", outputSchema.getField(0).type,
 				DataType.CHARARRAY);
-		
+
 	}
-	
+
 	@Test(expected=java.lang.RuntimeException.class)
 	public void testInvalidOutputSchemaForBagToTupleStringUDF() throws Exception {
 
@@ -404,17 +404,17 @@ public class TestBuiltInBagToTupleOrString {
 		// expecting an exception because the delimiter is not of type Data.CHARARRAY
 		udf.outputSchema(inputSch);
 	}
-	
+
 	@Test
 	public void testPigScriptForBagToTupleUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 		// bag of chararray
 		data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a"), tuple("b"), tuple("c"))));
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    assertEquals(schema("myBag:(l:chararray)"), data.getSchema("bar"));
@@ -427,18 +427,18 @@ public class TestBuiltInBagToTupleOrString {
 		data.set("foo", "myBag:bag{t:(l:long)}",
 				tuple(bag(tuple(1), tuple(2), tuple(3))));
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    out = data.get("bar");
 	    assertEquals(tuple(1, 2, 3), out.get(0).get(0));
 	}
-	
+
 	@Test
 	public void testPigScriptMultipleElmementsPerTupleForBagTupleUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 		data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a", "b"), tuple("c", "d"), tuple("e", "f"))));
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
@@ -448,122 +448,122 @@ public class TestBuiltInBagToTupleOrString {
 	    List<Tuple> out = data.get("bar");
 	    assertEquals(tuple("a", "b","c", "d", "e", "f"), out.get(0).get(0));
 	}
-	
+
 	@Test
 	public void testPigScriptNestedTupleForBagToTupleDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 	    Tuple nestedTuple = tuple(bag(tuple("c"), tuple("d")));
 	    data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a"), tuple("b"), nestedTuple, tuple("e"))));
-		
+
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    assertEquals(tuple("a", "b",bag(tuple("c"), tuple("d")), "e"), out.get(0).get(0));
-	    
+
 	}
-	
+
 	@Test
 	public void testPigScriptEmptyBagForBagToTupleUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 	    data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag()));
-		
+
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    // empty bag will generate empty tuple
 	    assertEquals(tuple(), out.get(0).get(0));
-	    
+
 	}
-	
+
 	@Test
 	public void testPigScriptrForBagToStringUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 		data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a"), tuple("b"), tuple("c"))));
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
-	    
-	    pigServer.registerQuery("C = FOREACH A GENERATE BagToString(myBag, '==') as myBag;");		
-	    pigServer.registerQuery("STORE C INTO 'foo' USING mock.Storage();");
+
+	    pigServer.registerQuery("C = FOREACH A GENERATE BagToString(myBag, '==') as myBag;");
+	    pigServer.registerQuery("STORE C INTO 'baz' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    assertEquals(schema("myBag:chararray"), data.getSchema("bar"));
 	    assertEquals(tuple("a_b_c"), out.get(0));
-	    
-	    out = data.get("foo");
+
+	    out = data.get("baz");
 	    assertEquals(tuple("a==b==c"), out.get(0));
 	}
-	
+
 	@Test
 	public void testPigScriptMultipleElmementsPerTupleForBagToStringUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 		data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a", "b"), tuple("c", "d"), tuple("e", "f"))));
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
 		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
 		pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
-		
+
 		pigServer.registerQuery("C = FOREACH A GENERATE BagToString(myBag, '^') as myBag;");
-		pigServer.registerQuery("STORE C INTO 'foo' USING mock.Storage();");
+		pigServer.registerQuery("STORE C INTO 'baz' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    assertEquals(tuple("a_b_c_d_e_f"), out.get(0));
-	    
-	    out = data.get("foo");
+
+	    out = data.get("baz");
 	    assertEquals(tuple("a^b^c^d^e^f"), out.get(0));
 	}
-	
+
 	@Test
 	public void testPigScriptNestedTupleForBagToStringUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 	    Tuple nestedTuple = tuple(bag(tuple("c"), tuple("d")));
 	    data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag(tuple("a"), tuple("b"), nestedTuple, tuple("e"))));
-		
+
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    assertEquals(tuple("a_b_{(c),(d)}_e"), out.get(0));
-	    
+
 	}
 
 	@Test
 	public void testPigScriptEmptyBagForBagToStringUDF() throws Exception {
 		PigServer pigServer = new PigServer(ExecType.LOCAL);
 		Data data = resetData(pigServer);
-		
+
 	    data.set("foo", "myBag:bag{t:(l:chararray)}",
 				tuple(bag()));
-		
+
 		pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
-		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");		
+		pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
 	    pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
 
 	    List<Tuple> out = data.get("bar");
 	    // empty bag will generate empty string
 	    assertEquals(tuple(""), out.get(0));
-	    
+
 	}
-	
+
 	private DataBag buildBagWithNestedTupleAndBag() throws ExecException {
 		Tuple t1 = tf.newTuple(2);
 		t1.set(0, "a");
