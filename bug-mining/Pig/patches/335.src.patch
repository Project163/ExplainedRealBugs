diff --git a/CHANGES.txt b/CHANGES.txt
index b246fefb6..1e085cc26 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -315,6 +315,8 @@ PIG-1155: Need to make sure existing loaders work "as is" (daijy)
 PIG-1144: set default_parallelism construct does not set the number of
 reducers correctly (daijy)
 
+PIG-1165: Signature of loader does not set correctly for order by (daijy)
+
 Release 0.5.0
 
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/SampleOptimizer.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/SampleOptimizer.java
index a9f964f63..a65331c5f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/SampleOptimizer.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/SampleOptimizer.java
@@ -180,7 +180,7 @@ public class SampleOptimizer extends MROpPlanVisitor {
         rslargs[1] = load.getLFile().getFuncSpec().getCtorArgs()[1];
         FileSpec fs = new FileSpec(predFs.getFileName(),new FuncSpec(loadFunc, rslargs));
         POLoad newLoad = new POLoad(load.getOperatorKey(),load.getRequestedParallelism(), fs, load.isSplittable());
-        newLoad.setSignature(load.getSignature());
+        newLoad.setSignature(predLoad.getSignature());
         try {
             mr.mapPlan.replace(load, newLoad);
             
@@ -196,7 +196,7 @@ public class SampleOptimizer extends MROpPlanVisitor {
         // Second, replace the loader in our successor with whatever the originally used loader was.
         fs = new FileSpec(predFs.getFileName(), predFs.getFuncSpec());
         newLoad = new POLoad(succLoad.getOperatorKey(), succLoad.getRequestedParallelism(), fs, succLoad.isSplittable());
-        newLoad.setSignature(succLoad.getSignature());
+        newLoad.setSignature(predLoad.getSignature());
         try {
             succ.mapPlan.replace(succLoad, newLoad);
         } catch (PlanException e) {
diff --git a/test/findbugsExcludeFile.xml b/test/findbugsExcludeFile.xml
index f523db19c..0750cbdaa 100644
--- a/test/findbugsExcludeFile.xml
+++ b/test/findbugsExcludeFile.xml
@@ -324,5 +324,9 @@
         <Field name = "res" />
         <Bug pattern="MF_CLASS_MASKS_FIELD" />
     </Match>
-    
+    <Match>
+        <Class name="org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher" />
+        <Method name = "launchPig" />
+        <Bug pattern="DE_MIGHT_IGNORE" />
+    </Match>
 </FindBugsFilter>
diff --git a/test/org/apache/pig/test/TestPruneColumn.java b/test/org/apache/pig/test/TestPruneColumn.java
index cc07991c1..3bc5e0c08 100644
--- a/test/org/apache/pig/test/TestPruneColumn.java
+++ b/test/org/apache/pig/test/TestPruneColumn.java
@@ -1656,4 +1656,25 @@ public class TestPruneColumn extends TestCase {
             "No map keys pruned for C"}));
     }
 
+    // See PIG-1165
+    @Test
+    public void testOrderbyWrongSignature() throws Exception {
+        pigServer.registerQuery("A = load '"+ Util.generateURI(tmpFile1.toString()) + "' AS (a0, a1, a2);");
+        pigServer.registerQuery("B = load '"+ Util.generateURI(tmpFile2.toString()) + "' AS (b0, b1);");
+        pigServer.registerQuery("C = order A by a1;");
+        pigServer.registerQuery("D = join C by a1, B by b0;");
+        pigServer.registerQuery("E = foreach D generate a1, b0, b1;");
+        Iterator<Tuple> iter = pigServer.openIterator("E");
+        
+        assertTrue(iter.hasNext());
+        Tuple t = iter.next();
+        
+        assertTrue(t.size()==3);
+        assertTrue(t.toString().equals("(2,2,2)"));
+        
+        assertFalse(iter.hasNext());
+        
+        assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $2", 
+            "No map keys pruned for A", "No column pruned for B", "No map keys pruned for B"}));
+    }
 }
