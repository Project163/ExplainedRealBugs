diff --git a/CHANGES.txt b/CHANGES.txt
index f5d646004..4b88563e5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -47,6 +47,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)
 
 BUG FIXES
 
+PIG-4683: Nested order is broken after PIG-3591 in some cases (daijy)
+
 PIG-4679: Performance degradation due to InputSizeReducerEstimator since PIG-3754 (daijy)
 
 PIG-4315: MergeJoin or Split followed by order by gives NPE in Tez (rohini)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
index 0e1e4ce81..ebe25c8f1 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POPackage.java
@@ -257,8 +257,15 @@ public class POPackage extends PhysicalOperator {
                     NullableTuple ntup = tupIter.next();
                     int index = ntup.getIndex();
                     if (index == numInputs - 1) {
-                        dbs[index] = new PeekedBag(pkgr, ntup, tupIter, keyWritable);
-                        break;
+                        if (pkgr.getUseSecondaryKey()) {
+                            if (dbs[index] == null) {
+                                dbs[index] = useDefaultBag ? BagFactory.getInstance()
+                                        .newDefaultBag() : new InternalCachedBag(numInputs);
+                            }
+                        } else {
+                            dbs[index] = new PeekedBag(pkgr, ntup, tupIter, keyWritable);
+                            break;
+                        }
                     }
                     Tuple copy = pkgr.getValueTuple(keyWritable, ntup, index);
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
index a6ee245f3..8992b6eb0 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/Packager.java
@@ -353,6 +353,9 @@ public class Packager implements Illustrable, Serializable, Cloneable {
     public void setUseSecondaryKey(boolean useSecondaryKey) {
         this.useSecondaryKey = useSecondaryKey;
     }
+    public boolean getUseSecondaryKey() {
+        return useSecondaryKey;
+    }
 
     public void setPackageType(PackageType type) {
         this.pkgType = type;
diff --git a/test/org/apache/pig/test/TestSecondarySort.java b/test/org/apache/pig/test/TestSecondarySort.java
index 046b36890..8991010e3 100644
--- a/test/org/apache/pig/test/TestSecondarySort.java
+++ b/test/org/apache/pig/test/TestSecondarySort.java
@@ -448,6 +448,38 @@ public abstract class TestSecondarySort {
 
     }
 
+    @Test
+    public void testNestedSortMultiQueryEndToEnd3() throws Exception {
+        File input1 = Util.createTempFileDelOnExit("test", "txt");
+        PrintStream ps1 = new PrintStream(new FileOutputStream(input1));
+        ps1.println("a\t0");
+        ps1.println("a\t2");
+        ps1.println("a\t1");
+        ps1.close();
+        Util.copyFromLocalToCluster(cluster, input1.getCanonicalPath(), "testNestedSortMultiQueryEndToEnd3-input-1.txt");
+
+        File input2 = Util.createTempFileDelOnExit("test", "txt");
+        PrintStream ps2 = new PrintStream(new FileOutputStream(input2));
+        ps2.println("a");
+        ps2.close();
+        Util.copyFromLocalToCluster(cluster, input2.getCanonicalPath(), "testNestedSortMultiQueryEndToEnd3-input-2.txt");
+
+        try {
+            pigServer.setBatchOn();
+            pigServer.registerQuery("a = load 'testNestedSortMultiQueryEndToEnd3-input-1.txt' as (a0:chararray, a1:chararray);");
+            pigServer.registerQuery("b = load 'testNestedSortMultiQueryEndToEnd3-input-2.txt' as (b0);");
+            pigServer.registerQuery("c = cogroup b by b0, a by a0;");
+            pigServer.registerQuery("d = foreach c {a_sorted = order a by a1 desc;generate group, a_sorted, b;}");
+            Iterator<Tuple> iter = pigServer.openIterator("d");
+
+            assertEquals(iter.next().toString(), "(a,{(a,2),(a,1),(a,0)},{(a)})");
+        } finally {
+            Util.deleteFile(cluster, "testNestedSortMultiQueryEndToEnd3-input-1.txt");
+            Util.deleteFile(cluster, "testNestedSortMultiQueryEndToEnd3-input-2.txt");
+        }
+
+    }
+
     // See PIG-1978
     @Test
     public void testForEachTwoInput() throws Exception {
