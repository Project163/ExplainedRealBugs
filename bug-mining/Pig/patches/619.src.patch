diff --git a/CHANGES.txt b/CHANGES.txt
index 87857ce7d..64df050de 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -86,6 +86,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-496: project of bags from complex data causes failures (daijy)
+
 PIG-730: problem combining schema from a union of several LOAD expressions, with a nested bag inside the schema (daijy)
 
 PIG-767: Schema reported from DESCRIBE and actual schema of inner bags are different (daijy)
diff --git a/src/org/apache/pig/builtin/Utf8StorageConverter.java b/src/org/apache/pig/builtin/Utf8StorageConverter.java
index 6f9162258..c8cbb83fc 100644
--- a/src/org/apache/pig/builtin/Utf8StorageConverter.java
+++ b/src/org/apache/pig/builtin/Utf8StorageConverter.java
@@ -73,7 +73,7 @@ public class Utf8StorageConverter implements LoadStoreCaster {
         if (fieldSchema==null) {
             throw new IOException("Schema is null");
         }
-        ResourceFieldSchema[] fss=fieldSchema.getSchema().getFields();;
+        ResourceFieldSchema[] fss=fieldSchema.getSchema().getFields();
         Tuple t;
         int buf;
         while ((buf=in.read())!='{') {
@@ -161,20 +161,31 @@ public class Utf8StorageConverter implements LoadStoreCaster {
                 }
                 if (buf=='['||buf=='{'||buf=='(') {
                     level.push((char)buf);
+                    mOut.write(buf);
                 }
                 else if (buf==')' && level.isEmpty()) // End of tuple
+                {
+                    DataByteArray value = new DataByteArray(mOut.toByteArray());
+                    t.append(value);
                     break;
+                }
+                else if (buf==',' && level.isEmpty())
+                {
+                    DataByteArray value = new DataByteArray(mOut.toByteArray());
+                    t.append(value);
+                    mOut.reset();
+                }
                 else if (buf==']' ||buf=='}'||buf==')')
                 {
                     if (level.peek()==findStartChar((char)buf))
                         level.pop();
                     else
                         throw new IOException("Malformed tuple");
+                    mOut.write(buf);
                 }
-                mOut.write(buf);
+                else
+                    mOut.write(buf);
             }
-            DataByteArray value = new DataByteArray(mOut.toByteArray());
-            t.append(value);
         }
         return t;
     }
diff --git a/test/org/apache/pig/test/TestConversions.java b/test/org/apache/pig/test/TestConversions.java
index d6146558f..cb77db7f1 100644
--- a/test/org/apache/pig/test/TestConversions.java
+++ b/test/org/apache/pig/test/TestConversions.java
@@ -345,9 +345,11 @@ public class TestConversions extends TestCase {
         schema = Utils.getSchemaFromString("t:tuple()");
         rfs = new ResourceSchema(schema).getFields()[0];
         t = ps.getLoadCaster().bytesToTuple(s.getBytes(), rfs);
-        assertTrue(t.size()==1);
+        assertTrue(t.size()==2);
         assertTrue(t.get(0) instanceof DataByteArray);
-        assertTrue(t.get(0).toString().equals("a,b"));
+        assertTrue(t.get(0).toString().equals("a"));
+        assertTrue(t.get(1) instanceof DataByteArray);
+        assertTrue(t.get(1).toString().equals("b"));
         
         s = "[a#(1,2,3)]";
         m = ps.getLoadCaster().bytesToMap(s.getBytes());
@@ -360,9 +362,13 @@ public class TestConversions extends TestCase {
         schema = Utils.getSchemaFromString("t:tuple()");
         rfs = new ResourceSchema(schema).getFields()[0];
         t = ps.getLoadCaster().bytesToTuple(s.getBytes(), rfs);
-        assertTrue(t.size()==1);
+        assertTrue(t.size()==3);
         assertTrue(t.get(0) instanceof DataByteArray);
-        assertTrue(t.get(0).toString().equals("a,b,(123,456,{(1,2,3)})"));
+        assertTrue(t.get(0).toString().equals("a"));
+        assertTrue(t.get(1) instanceof DataByteArray);
+        assertTrue(t.get(1).toString().equals("b"));
+        assertTrue(t.get(2) instanceof DataByteArray);
+        assertTrue(t.get(2).toString().equals("(123,456,{(1,2,3)})"));
         
         s = "(a,b,(123,456,{(1,2,3}))";
         schema = Utils.getSchemaFromString("t:tuple()");
