diff --git a/CHANGES.txt b/CHANGES.txt
index 98f2e2f16..12c0fda80 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -208,6 +208,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-2842: TestNewPlanOperatorPlan fails when new Configuration() picks up a previous minicluster conf file (julien)
+
 PIG-2827: Unwrap exception swallowing in TOP (haitao.yao via jcoveney)
 
 PIG-2825: StoreFunc signature setting in LogicalPlan broken (jcoveney)
diff --git a/test/org/apache/pig/test/TestNewPlanOperatorPlan.java b/test/org/apache/pig/test/TestNewPlanOperatorPlan.java
index 38d589ab5..1f8fe5681 100644
--- a/test/org/apache/pig/test/TestNewPlanOperatorPlan.java
+++ b/test/org/apache/pig/test/TestNewPlanOperatorPlan.java
@@ -31,6 +31,7 @@ import org.apache.pig.ExecType;
 import org.apache.pig.FuncSpec;
 import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
 import org.apache.pig.builtin.PigStorage;
+import org.apache.pig.builtin.mock.Storage;
 import org.apache.pig.data.DataType;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileSpec;
@@ -1527,7 +1528,7 @@ public class TestNewPlanOperatorPlan extends TestCase {
         aschema1.addField(new LogicalSchema.LogicalFieldSchema(
             "x", null, DataType.INTEGER));
         LOLoad A1 = newLOLoad(new FileSpec("/abc",
-            new FuncSpec(DummyLoad.class.getName(), new String[] {"x", "y"})), aschema1, lp1, new Configuration());
+            new FuncSpec(DummyLoad.class.getName(), new String[] {"x", "y"})), aschema1, lp1, conf);
         lp1.add(A1);
         
         LogicalExpressionPlan fp1 = new LogicalExpressionPlan();
@@ -1545,7 +1546,7 @@ public class TestNewPlanOperatorPlan extends TestCase {
         
         LogicalPlan lp2 = new LogicalPlan();
         LOLoad A2 = newLOLoad(new FileSpec("/abc",
-            new FuncSpec(DummyLoad.class.getName(), new String[] {"x", "z"})), null, lp2, new Configuration());
+            new FuncSpec(DummyLoad.class.getName(), new String[] {"x", "z"})), null, lp2, conf);
         lp2.add(A2);
         
         LogicalExpressionPlan fp2 = new LogicalExpressionPlan();
