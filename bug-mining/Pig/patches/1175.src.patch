diff --git a/CHANGES.txt b/CHANGES.txt
index b0fc13576..ddf075ec5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -151,6 +151,8 @@ PIG-3013: BinInterSedes improve chararray sort performance (rohini)
 
 BUG FIXES
 
+PIG-2247: Pig parser does not detect multiple arguments with the same name passed to macro (dreambird via daijy)
+
 PIG-3264: mvn signanddeploy target broken for pigunit, pigsmoke and piggybank (billgraham)
 
 PIG-3262: Pig contrib 0.11 doesn't compile on certain rpm systems (mgrover via cheolsoo)
diff --git a/src/org/apache/pig/parser/PigMacro.java b/src/org/apache/pig/parser/PigMacro.java
index 10711f769..435fc1366 100644
--- a/src/org/apache/pig/parser/PigMacro.java
+++ b/src/org/apache/pig/parser/PigMacro.java
@@ -39,6 +39,8 @@ import org.apache.commons.logging.LogFactory;
 import org.apache.pig.parser.PigParserNode.InvocationPoint;
 import org.apache.pig.tools.parameters.ParameterSubstitutionPreprocessor;
 
+import com.google.common.collect.ImmutableSet;
+
 class PigMacro {
 
     private static final Log LOG = LogFactory.getLog(PigMacro.class);
@@ -135,7 +137,18 @@ class PigMacro {
                             + ((outputs == null) ? 0 : outputs.length));
             throw new ParserException(msg);
         }
-        
+
+        int distinct = ImmutableSet.copyOf(inputs).asList().size();
+        if (distinct != inputs.length) {
+            String msg = getErrorMessage(file, line, "Cannot expand macro '"
+                    + name + "'",
+                    " Duplicated arguments names are passed in macro:"
+                              + " number of arguments: " + inputs.length
+                              + " number of distinct arguments: "
+                              + distinct);
+            throw new ParserException(msg);
+        }
+
         String[] args = new String[params.size()];
         for (int i=0; i<params.size(); i++) {
         	 if (inputs[i].startsWith("$"))
diff --git a/test/org/apache/pig/test/TestMacroExpansion.java b/test/org/apache/pig/test/TestMacroExpansion.java
index ebeb37a07..ce03b27b9 100644
--- a/test/org/apache/pig/test/TestMacroExpansion.java
+++ b/test/org/apache/pig/test/TestMacroExpansion.java
@@ -969,6 +969,25 @@ public class TestMacroExpansion {
         validateFailure(macro + script, expectedErr);
     }
     
+    //duplicate arguments passed in macro
+    @Test
+    public void negativeTest10() throws Throwable {
+        String macro = "define simple_macro(in_relation, min_gpa, min_gpa) returns c {\n" +
+            "b = filter $in_relation by age >= $min_gpa;\n" +
+            "$c = foreach b generate user, zip;\n" +
+            "};\n";
+
+        String script =
+            "alpha = load 'users' as (user, age, zip);\n" +
+            "gamma = simple_macro (alpha, age, age);\n" +
+            "store gamma into 'byuser';\n";
+
+        String expectedErr = "Reason:  Duplicated arguments names are passed in macro:" +
+            " number of arguments: 3 number of distinct arguments: 2";
+
+        validateFailure(macro + script, expectedErr);
+    }
+
     @Test // macro doesn't contain return alias
     public void checkReturnAliasTest1() throws Throwable {
         String macro = "define group_and_count_1 (A,C) returns B {\n" +
