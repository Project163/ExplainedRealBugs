diff --git a/CHANGES.txt b/CHANGES.txt
index b2696effa..1c86bfab2 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -220,6 +220,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1731: Stack Overflows where there are composite logical expressions on UDFs using the new logical plan (yanz)
+
 PIG-1723: Need to limit the length of Pig counter names (rding)
 
 PIG-1714: Option mapred.output.compress doesn't work in Pig 0.8 but worked in
diff --git a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
index ae80a525a..58f952c92 100644
--- a/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/UserFuncExpression.java
@@ -65,7 +65,7 @@ public class UserFuncExpression extends LogicalExpression {
     public boolean isEqual(Operator other) throws FrontendException {
         if( other instanceof UserFuncExpression ) {
             UserFuncExpression exp = (UserFuncExpression)other;
-            return plan.isEqual(exp.plan) && mFuncSpec.equals(exp.mFuncSpec );
+            return mFuncSpec.equals(exp.mFuncSpec );
         } else {
             return false;
         }
diff --git a/test/org/apache/pig/test/TestFilterUDF.java b/test/org/apache/pig/test/TestFilterUDF.java
index 1f9b2868c..ffc589d1c 100644
--- a/test/org/apache/pig/test/TestFilterUDF.java
+++ b/test/org/apache/pig/test/TestFilterUDF.java
@@ -166,4 +166,43 @@ public class TestFilterUDF {
             assertTrue(t.equals(expectedTuple));
         }
     }
+
+    @Test
+    public void testFilterUDFusingDefine2() throws Exception{
+        File inputFile= createFile(
+                    new String[]{ 
+                        "www.paulisageek.com\t4",
+                        "www.yahoo.com\t12344",
+                        "google.com\t1",
+                        "us2.amazon.com\t4141"
+                    }
+                );
+
+        File filterFile = createFile(
+                    new String[]{ 
+                        "12344"
+                    }
+                );
+
+        pigServer.registerQuery("define FILTER_CRITERION "
+                + FILTERFROMFILE.class.getName()
+                + "('"
+                + Util.generateURI(filterFile.toString(), pigServer
+                        .getPigContext()) + "');");
+        pigServer.registerQuery("a = LOAD '"
+                + Util.generateURI(inputFile.toString(), pigServer
+                        .getPigContext())
+                + "' as (url:chararray, numvisits:int);");
+        pigServer.registerQuery("b = filter a by FILTER_CRITERION(numvisits) AND FILTER_CRITERION(numvisits);");
+
+        Tuple expectedTuple = tf.newTuple();
+        expectedTuple.append(new String("www.yahoo.com"));
+        expectedTuple.append(new Integer("12344"));
+
+        Iterator<Tuple> iter = pigServer.openIterator("b");
+        while(iter.hasNext()){
+            Tuple t = iter.next();
+            assertTrue(t.equals(expectedTuple));
+        }
+    }
 }
