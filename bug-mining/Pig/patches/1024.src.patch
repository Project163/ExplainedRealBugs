diff --git a/CHANGES.txt b/CHANGES.txt
index 6adb88d83..2f005093b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -24,6 +24,8 @@ INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
 
+PIG-2662: skew join does not honor its config parameters (rajesh.balamohan via thejas)
+
 PIG-2871: Refactor signature for PigReducerEstimator (billgraham)
 
 PIG-2851: Add flag to ant to run tests with a debugger port (billgraham)
diff --git a/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java b/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
index 49353d5ca..5ce5b9e15 100644
--- a/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
+++ b/src/org/apache/pig/impl/builtin/PoissonSampleLoader.java
@@ -22,6 +22,7 @@ import java.util.ArrayList;
 import java.util.Properties;
 
 
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.mapreduce.RecordReader;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigSplit;
@@ -171,36 +172,6 @@ public class PoissonSampleLoader extends SampleLoader {
         return t;
     }
 
-    /**
-     * Computes the number of samples for the loader
-     * 
-     * @param inputs : Set to pig inputs
-     * @param pc : PigContext object
-     * 
-     */
-    @Override
-    public void computeSamples(ArrayList<Pair<FileSpec, Boolean>> inputs, 
-            PigContext pc) throws ExecException {
-        Properties pcProps = pc.getProperties();
-
-        // % of memory available for the records
-        heapPerc = PartitionSkewedKeys.DEFAULT_PERCENT_MEMUSAGE;
-        if (pcProps.getProperty(PERC_MEM_AVAIL) != null) {
-            try {
-                heapPerc = Float.valueOf(pcProps.getProperty(PERC_MEM_AVAIL));
-            }catch(NumberFormatException e) {
-                // ignore, use default value
-            }
-        }
-
-        try {
-            sampleRate = Integer.valueOf(pcProps.getProperty(SAMPLE_RATE));
-        } catch (NumberFormatException e) {
-            sampleRate = DEFAULT_SAMPLE_RATE;
-        }
-
-    }
-    
     @Override
     public void prepareToRead(RecordReader reader, PigSplit split) throws IOException {
         super.prepareToRead(reader, split);
@@ -210,9 +181,11 @@ public class PoissonSampleLoader extends SampleLoader {
         skipInterval = -1;
         memToSkipPerSample = 0;
         numRowSplTupleReturned = false;
-        sampleRate = DEFAULT_SAMPLE_RATE;
-        heapPerc = PartitionSkewedKeys.DEFAULT_PERCENT_MEMUSAGE;
         newSample = null;
+
+        Configuration conf = split.getConf();
+        sampleRate = conf.getInt(SAMPLE_RATE, DEFAULT_SAMPLE_RATE);
+        heapPerc = conf.getFloat(PERC_MEM_AVAIL, PartitionSkewedKeys.DEFAULT_PERCENT_MEMUSAGE);
     }
 
 }
diff --git a/test/org/apache/pig/test/TestPoissonSampleLoader.java b/test/org/apache/pig/test/TestPoissonSampleLoader.java
index 97d2cc5be..22b4407bc 100644
--- a/test/org/apache/pig/test/TestPoissonSampleLoader.java
+++ b/test/org/apache/pig/test/TestPoissonSampleLoader.java
@@ -90,8 +90,9 @@ public class TestPoissonSampleLoader extends TestCase{
         Util.deleteFile(cluster, INPUT_FILE1);
     }
 
-    @Test
-    public void testNumSamples() throws IOException {
+    private int testNumSamples(String memUsage, String sampleRate) throws IOException {
+        pigServer.getPigContext().getProperties().setProperty("pig.skewedjoin.reduce.memusage", memUsage);
+        pigServer.getPigContext().getProperties().setProperty("pig.sksampler.samplerate", sampleRate);
         pigServer.registerQuery("A = Load '"+INPUT_FILE1+"' Using PoissonSampleLoader('PigStorage()', '100');");
         Iterator<Tuple> iter = pigServer.openIterator("A");
         int count = 0;
@@ -99,7 +100,29 @@ public class TestPoissonSampleLoader extends TestCase{
             count++;
             iter.next();
         }
-        assertEquals(count, 1);
+        return count;
+    }
+
+    @Test
+    public void testNumSamples() throws IOException {
+        //PoissonSampleLoader.DEFAULT_SAMPLE_RATE is 17
+        int count = testNumSamples("0.0001", "17");
+        assertEquals(count, 12);
+
+        count = testNumSamples("0.001", "17");
+        assertEquals(count, 6);
+
+        count = testNumSamples("0.001", "10");
+        assertEquals(count, 4);
+
+        count = testNumSamples("0.001", "100");
+        assertEquals(count, 9);
+
+        count = testNumSamples("0.005", "17");
+        assertEquals(count, 2);
+
+        count = testNumSamples("0.0001", "100");
+        assertEquals(count, 42);
     }
 
     /*
@@ -110,7 +133,19 @@ public class TestPoissonSampleLoader extends TestCase{
         pigServer.registerQuery("A = Load '"+INPUT_FILE1+"' Using PoissonSampleLoader('PigStorage(\\\\\\':\\\\\\')', '100');");
         Iterator<Tuple> iter = pigServer.openIterator("A");
         assertTrue(iter.hasNext());
-        assertEquals(5, iter.next().size());
+        
+        Tuple t = iter.next();
+        //Check the tuple size. It has to be 3.
+        assertEquals(3, t.size());
+
+        while(iter.hasNext()){
+            t = iter.next();
+        }
+        // Last tuple's size has to be 5
+        // 3 datum  (ex: 100:apple1:aaa)
+        // + PoissonSampleLoader.NUMROWS_TUPLE_MARKER ??_pig_inTeRnal-spEcial_roW_num_tuple3kt579CFLehkblah 
+        // + numRow 300
+        assertEquals(5, t.size());
     }
 
 }
\ No newline at end of file
