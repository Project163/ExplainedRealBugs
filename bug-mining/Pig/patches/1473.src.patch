diff --git a/CHANGES.txt b/CHANGES.txt
index b7cdab675..8e07f08e0 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -34,6 +34,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4013: Order by multiple column fail on Tez (daijy)
+
 PIG-3983: TestGrunt.testKeepGoigFailed fail on tez mode (daijy)
 
 PIG-3959: Skewed join followed by replicated join fails in Tez (cheolsoo)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
index 375f291aa..c31385cc8 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/partitioners/WeightedRangePartitioner.java
@@ -60,9 +60,9 @@ public class WeightedRangePartitioner extends Partitioner<PigNullableWritable, W
     protected Map<PigNullableWritable, DiscreteProbabilitySampleGenerator> weightedParts =
             new HashMap<PigNullableWritable, DiscreteProbabilitySampleGenerator>();
     protected PigNullableWritable[] quantiles;
-    private RawComparator<PigNullableWritable> comparator;
+    protected RawComparator<PigNullableWritable> comparator;
     private PigContext pigContext;
-    private Configuration job;
+    protected Configuration job;
 
     protected boolean inited = false;
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/WeightedRangePartitionerTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/WeightedRangePartitionerTez.java
index 816c3fd99..b3d820386 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/WeightedRangePartitionerTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/WeightedRangePartitionerTez.java
@@ -30,6 +30,7 @@ import org.apache.pig.data.InternalMap;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.builtin.FindQuantiles;
 import org.apache.pig.impl.io.PigNullableWritable;
+import org.apache.tez.runtime.library.common.ConfigUtils;
 
 public class WeightedRangePartitionerTez extends WeightedRangePartitioner {
     private static final Log LOG = LogFactory.getLog(WeightedRangePartitionerTez.class);
@@ -72,7 +73,7 @@ public class WeightedRangePartitionerTez extends WeightedRangePartitioner {
         } catch (Exception e) {
             throw new RuntimeException(e);
         }
-
+        comparator = ConfigUtils.getIntermediateInputKeyComparator(job);
         LOG.info("Initialized WeightedRangePartitionerTez. Time taken: " + (System.currentTimeMillis() - start));
         inited = true;
     }
diff --git a/test/e2e/pig/tests/nightly.conf b/test/e2e/pig/tests/nightly.conf
index c00dd00ee..f157604ca 100644
--- a/test/e2e/pig/tests/nightly.conf
+++ b/test/e2e/pig/tests/nightly.conf
@@ -1256,6 +1256,13 @@ c = order b by instate;
 store c into ':OUTPATH:';\,
 			'sortArgs' => ['-t', '	', '-k', '1,1'],
 			},
+                        {
+			'num' => 20,
+			'pig' => q\a = load ':INPATH:/singlefile/studenttab10k' as (name:chararray, age:int, gpa:double);
+b = order a by name ASC, age DESC parallel 9;
+store b into ':OUTPATH:';\,
+                        'sortArgs' => ['-t', '	', '-k', '1,1', '-k', '2,2nr'],
+			},
 		]
 		},
 		{
