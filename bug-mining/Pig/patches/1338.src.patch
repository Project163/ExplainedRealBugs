diff --git a/CHANGES.txt b/CHANGES.txt
index dbfeb3a92..53c1c6497 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -74,6 +74,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-3677: ConfigurationUtil.getLocalFSProperties can return an inconsistent property set (rohini)
+
 PIG-3511: Security: Pig temporary directories might have world readable permissions (rohini)
 
 PIG-3664: Piggy Bank XPath UDF can't be called (nezihyigitbasi via daijy)
diff --git a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
index c908beb00..444b5f943 100644
--- a/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
+++ b/shims/src/hadoop20/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
@@ -97,7 +97,7 @@ public class HadoopShims {
     public static JobControl newJobControl(String groupName, int timeToSleep) {
       return new PigJobControl(groupName, timeToSleep);
     }
-    
+
     public static long getDefaultBlockSize(FileSystem fs, Path path) {
         return fs.getDefaultBlockSize();
     }
@@ -115,4 +115,8 @@ public class HadoopShims {
         // for Hadoop 0.20
         return report.getProgress() != successfulProgress;
     }
+
+    public static void unsetConf(Configuration conf, String key) {
+        // Not supported in Hadoop 0.20/1.x
+    }
 }
diff --git a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
index dc1776cae..7ff4eb76b 100644
--- a/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
+++ b/shims/src/hadoop23/org/apache/pig/backend/hadoop/executionengine/shims/HadoopShims.java
@@ -115,4 +115,8 @@ public class HadoopShims {
     public static boolean isJobFailed(TaskReport report) {
         return report.getCurrentStatus()==TIPStatus.FAILED;
     }
+    
+    public static void unsetConf(Configuration conf, String key) {
+        conf.unset(key);
+    }
 }
diff --git a/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java b/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
index 20f10de7c..6ceef3e13 100644
--- a/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
+++ b/src/org/apache/pig/backend/hadoop/datastorage/ConfigurationUtil.java
@@ -18,7 +18,6 @@
 
 package org.apache.pig.backend.hadoop.datastorage;
 
-import java.lang.reflect.Method;
 import java.util.Enumeration;
 import java.util.Iterator;
 import java.util.Map;
@@ -28,6 +27,7 @@ import java.util.Properties;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.pig.ExecType;
 import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce;
+import org.apache.pig.backend.hadoop.executionengine.shims.HadoopShims;
 import org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil;
 
 public class ConfigurationUtil {
@@ -79,21 +79,10 @@ public class ConfigurationUtil {
             // so build/classes/hadoop-site.xml contains such entry. This prevents some tests from
             // successful (They expect those files in hdfs), so we need to unset it in hadoop 23.
             // This should go away once MiniMRCluster fix the distributed cache issue.
-            Method unsetMethod = null;
-            try {
-                unsetMethod = localConf.getClass().getMethod("unset", new Class[]{String.class});
-            } catch (Exception e) {
-            }
-            if (unsetMethod!=null) {
-                try {
-                    unsetMethod.invoke(localConf, new Object[]{"mapreduce.job.cache.files"});
-                } catch (Exception e) {
-                    // Should not happen
-                }
-            }
+            HadoopShims.unsetConf(localConf, "mapreduce.job.cache.files");
         }
+        localConf.set(MapRedUtil.FILE_SYSTEM_NAME, "file:///");
         Properties props = ConfigurationUtil.toProperties(localConf);
-        props.setProperty(MapRedUtil.FILE_SYSTEM_NAME, "file:///");
         return props;
     }
 }
