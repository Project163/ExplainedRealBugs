diff --git a/CHANGES.txt b/CHANGES.txt
index 37de1c812..ab3f66a1a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -40,6 +40,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4035: Fix CollectedGroup e2e tests for tez (daijy)
+
 PIG-4034: Exclude TestTezAutoParallelism when -Dhadoopversion=20 (cheolsoo)
 
 PIG-4033: Fix MergeSparseJoin e2e tests on tez (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCollectedGroup.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCollectedGroup.java
index c355d1dfe..1d1431073 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCollectedGroup.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCollectedGroup.java
@@ -130,15 +130,7 @@ public class POCollectedGroup extends PhysicalOperator {
         // Since the output is buffered, we need to flush the last
         // set of records when the close method is called by mapper.
         if (this.parentPlan.endOfAllInput) {
-            if (outputBag != null) {
-                Tuple tup = mTupleFactory.newTuple(2);
-                tup.set(0, prevKey);
-                tup.set(1, outputBag);
-                outputBag = null;
-                return new Result(POStatus.STATUS_OK, tup);
-            }
-
-            return new Result(POStatus.STATUS_EOP, null);
+            return getStreamCloseResult();
         }
 
         Result inp = null;
@@ -146,8 +138,13 @@ public class POCollectedGroup extends PhysicalOperator {
 
         while (true) {
             inp = processInput();
-            if (inp.returnStatus == POStatus.STATUS_EOP ||
-                    inp.returnStatus == POStatus.STATUS_ERR) {
+            if (inp.returnStatus == POStatus.STATUS_EOP) {
+                if (this.parentPlan.endOfAllInput) {
+                    return getStreamCloseResult();
+                } else {
+                    break;
+                }
+            } else if (inp.returnStatus == POStatus.STATUS_ERR) {
                 break;
             }
 
@@ -278,4 +275,16 @@ public class POCollectedGroup extends PhysicalOperator {
     public Tuple illustratorMarkup(Object in, Object out, int eqClassIndex) {
         return null;
     }
+
+    private Result getStreamCloseResult() throws ExecException {
+        if (outputBag != null) {
+            Tuple tup = mTupleFactory.newTuple(2);
+            tup.set(0, prevKey);
+            tup.set(1, outputBag);
+            outputBag = null;
+            return new Result(POStatus.STATUS_OK, tup);
+        }
+
+        return new Result(POStatus.STATUS_EOP, null);
+    }
 }
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
index f39f68fc5..84dbeec4c 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
@@ -34,6 +34,7 @@ import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.io.IntWritable;
 import org.apache.hadoop.io.LongWritable;
 import org.apache.hadoop.mapreduce.lib.partition.HashPartitioner;
+import org.apache.pig.CollectableLoadFunc;
 import org.apache.pig.FuncSpec;
 import org.apache.pig.IndexableLoadFunc;
 import org.apache.pig.LoadFunc;
@@ -551,13 +552,46 @@ public class TezCompiler extends PhyPlanVisitor {
         }
     }
 
-    // visit methods in alphabetical order
-
     @Override
     public void visitCollectedGroup(POCollectedGroup op) throws VisitorException {
-        int errCode = 2034;
-        String msg = "Cannot compile " + op.getClass().getSimpleName();
-        throw new TezCompilerException(msg, errCode, PigException.BUG);
+
+        List<PhysicalOperator> roots = curTezOp.plan.getRoots();
+        if(roots.size() != 1){
+            int errCode = 2171;
+            String errMsg = "Expected one but found more then one root physical operator in physical plan.";
+            throw new TezCompilerException(errMsg,errCode,PigException.BUG);
+        }
+
+        PhysicalOperator phyOp = roots.get(0);
+        if(! (phyOp instanceof POLoad)){
+            int errCode = 2172;
+            String errMsg = "Expected physical operator at root to be POLoad. Found : "+phyOp.getClass().getCanonicalName();
+            throw new TezCompilerException(errMsg,errCode,PigException.BUG);
+        }
+
+        LoadFunc loadFunc = ((POLoad)phyOp).getLoadFunc();
+        try {
+            if(!(CollectableLoadFunc.class.isAssignableFrom(loadFunc.getClass()))){
+                int errCode = 2249;
+                throw new TezCompilerException("While using 'collected' on group; data must be loaded via loader implementing CollectableLoadFunc.", errCode);
+            }
+            ((CollectableLoadFunc)loadFunc).ensureAllKeyInstancesInSameSplit();
+        } catch (TezCompilerException e){
+            throw (e);
+        } catch (IOException e) {
+            int errCode = 2034;
+            String msg = "Error compiling operator " + op.getClass().getSimpleName();
+            throw new MRCompilerException(msg, errCode, PigException.BUG, e);
+        }
+
+        try{
+            nonBlocking(op);
+            phyToTezOpMap.put(op, curTezOp);
+        }catch(Exception e){
+            int errCode = 2034;
+            String msg = "Error compiling operator " + op.getClass().getSimpleName();
+            throw new MRCompilerException(msg, errCode, PigException.BUG, e);
+        }
     }
 
     @Override
