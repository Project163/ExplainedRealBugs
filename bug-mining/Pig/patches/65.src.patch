diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
index fcc47c2ee..0f99e6bd4 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POUserFunc.java
@@ -153,7 +153,8 @@ public class POUserFunc extends ExpressionOperator {
                 if(temp.returnStatus!=POStatus.STATUS_OK)
                     return temp;
                 
-                if(op instanceof POProject){
+                if(op instanceof POProject &&
+                        op.getResultType() == DataType.TUPLE){
                     POProject projOp = (POProject)op;
                     if(projOp.isStar()){
                         Tuple trslt = (Tuple) temp.result;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
index d19dcd8ac..2cd18242b 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
@@ -337,7 +337,9 @@ public class POForEach extends PhysicalOperator {
                 ++i;
                 PhysicalOperator leaf = (PhysicalOperator)p.getLeaves().get(0); 
                 planLeaves.add(leaf);
-                if(leaf instanceof POProject && ((POProject)leaf).isStar())
+                if(leaf instanceof POProject &&
+                        leaf.getResultType() == DataType.TUPLE &&
+                        ((POProject)leaf).isStar())
                     isToBeFlattened.set(i, true);
             }
         }
diff --git a/test/org/apache/pig/test/TestEvalPipeline.java b/test/org/apache/pig/test/TestEvalPipeline.java
index 82d14e04b..f97c392d7 100644
--- a/test/org/apache/pig/test/TestEvalPipeline.java
+++ b/test/org/apache/pig/test/TestEvalPipeline.java
@@ -376,7 +376,7 @@ public class TestEvalPipeline extends TestCase {
         + "C1 = filter A by $0 > -1;"
         + "C2 = distinct C1;"
         + "C3 = distinct A;"
-        + "generate (int)group," + Identity.class.getName() +"(*), COUNT(C2), SUM(C2.$1)," +  TitleNGrams.class.getName() + "(C3), MAX(C3.$1);"
+        + "generate (int)group," + Identity.class.getName() +"(*), COUNT(C2), SUM(C2.$1)," +  TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"
         + "};";
 
         pigServer.registerQuery(query);
@@ -389,7 +389,8 @@ public class TestEvalPipeline extends TestCase {
             assertEquals((Long)5L, (Long)t.get(2));
             assertEquals(LOOP_COUNT*2.0, (Double)t.get(3), 0.01);
             assertEquals(8.0, (Double)t.get(5), 0.01);
-            assertEquals(6, t.size());
+            assertEquals(5L, ((DataBag)t.get(6)).size());
+            assertEquals(7, t.size());
             ++numIdentity;
         }
         assertEquals(LOOP_COUNT, numIdentity);
