diff --git a/CHANGES.txt b/CHANGES.txt
index 48c3f7101..7ed3af12e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -388,6 +388,9 @@ PIG-1195: POSort should take care of sort order (daijy)
 
 PIG-1210: fieldsToRead send the same fields more than once in some cases (daijy)
 
+PIG-1231: DefaultDataBagIterator.hasNext() should be idempotent in all cases
+(daijy)
+
 Release 0.5.0
 
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/data/DefaultDataBag.java b/src/org/apache/pig/data/DefaultDataBag.java
index c4bca1cbf..982f002da 100644
--- a/src/org/apache/pig/data/DefaultDataBag.java
+++ b/src/org/apache/pig/data/DefaultDataBag.java
@@ -50,6 +50,8 @@ public class DefaultDataBag extends DefaultAbstractBag {
 
     private static final Log log = LogFactory.getLog(DefaultDataBag.class);
     
+    boolean hasCachedTuple = false;
+    
     public DefaultDataBag() {
         mContents = new ArrayList<Tuple>();
     }
@@ -74,6 +76,7 @@ public class DefaultDataBag extends DefaultAbstractBag {
     }
     
     public Iterator<Tuple> iterator() {
+        hasCachedTuple = false;
         return new DefaultDataBagIterator();
     }
 
@@ -150,9 +153,12 @@ public class DefaultDataBag extends DefaultAbstractBag {
         }
 
         public boolean hasNext() { 
-            // See if we can find a tuple.  If so, buffer it.
+            // Once we call hasNext(), set the flag, so we can call hasNext() repeated without fetching next tuple
+            if (hasCachedTuple)
+                return (mBuf != null);
             mBuf = next();
-            return mBuf != null;
+            hasCachedTuple = true;
+            return (mBuf != null);
         }
 
         public Tuple next() {
@@ -161,9 +167,9 @@ public class DefaultDataBag extends DefaultAbstractBag {
             if ((mCntr++ & 0x3ff) == 0) reportProgress();
 
             // If there's one in the buffer, use that one.
-            if (mBuf != null) {
+            if (hasCachedTuple) {
                 Tuple t = mBuf;
-                mBuf = null;
+                hasCachedTuple = false;
                 return t;
             }
 
diff --git a/test/org/apache/pig/test/TestDataBag.java b/test/org/apache/pig/test/TestDataBag.java
index 925e0185d..6649c0030 100644
--- a/test/org/apache/pig/test/TestDataBag.java
+++ b/test/org/apache/pig/test/TestDataBag.java
@@ -1082,6 +1082,40 @@ public class TestDataBag extends junit.framework.TestCase {
         }
         assertEquals(bg6, bg7);
     }
+    
+    // See PIG-1231
+    @Test
+    public void testDataBagIterIdempotent() throws Exception {
+        DataBag bg0 = new DefaultDataBag();
+        processDataBag(bg0, true);
+        
+        DataBag bg1 = new DistinctDataBag();
+        processDataBag(bg1, true);
+        
+        DataBag bg2 = new InternalDistinctBag();
+        processDataBag(bg2, true);
+        
+        DataBag bg3 = new InternalSortedBag();
+        processDataBag(bg3, true);
+        
+        DataBag bg4 = new SortedDataBag(null);
+        processDataBag(bg4, true);
+        
+        DataBag bg5 = new InternalCachedBag(0, 0);
+        processDataBag(bg5, false);
+    }
+    
+    void processDataBag(DataBag bg, boolean doSpill) {
+        Tuple t = TupleFactory.getInstance().newTuple(new Integer(0));
+        bg.add(t);
+        if (doSpill)
+            bg.spill();
+        Iterator<Tuple> iter = bg.iterator();
+        assertTrue(iter.hasNext());
+        iter.next();
+        assertFalse(iter.hasNext());
+        assertFalse("hasNext should be idempotent", iter.hasNext());        
+    }
 }
 
 
diff --git a/test/org/apache/pig/test/TestNullConstant.java b/test/org/apache/pig/test/TestNullConstant.java
index c9a868975..8c7c23624 100644
--- a/test/org/apache/pig/test/TestNullConstant.java
+++ b/test/org/apache/pig/test/TestNullConstant.java
@@ -160,10 +160,8 @@ public class TestNullConstant extends TestCase {
         pigServer.registerQuery("b = foreach a generate {(null)}, ['2'#null];");
         Iterator<Tuple> it = pigServer.openIterator("b");
         Tuple t = it.next();
-System.out.println("tuple: " + t);
         assertEquals(null, ((DataBag)t.get(0)).iterator().next().get(0));
         assertEquals(null, ((Map<String, Object>)t.get(1)).get("2"));
-        
     }
 
     @Test
