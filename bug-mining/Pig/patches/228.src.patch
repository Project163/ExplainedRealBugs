diff --git a/CHANGES.txt b/CHANGES.txt
index e5ccfa991..c35593446 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -49,6 +49,8 @@ PIG-792: skew join implementation (sriranjan via olgan)
 
 BUG FIXES
     
+    PIG-913: Error in Pig script when grouping on chararray column (daijy)
+
     PIG-907: Provide multiple version of HashFNV (Piggybank) (daijy)
 
     PIG-905: TOKENIZE throws exception on null data (daijy)
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java b/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
index 0ace1e03e..1ff20f4af 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/LogicalTransformer.java
@@ -206,73 +206,6 @@ public abstract class LogicalTransformer extends Transformer<LogicalOperator, Lo
         insertBetween(after, newNode, successors.get(0), projectionMapping);
     }
 
-    /**
-     * Remove a node in the middle of a linear chain. This includes removing the node 
-     * from the plan and reconnect the nodes before and after the node as well as rebuilding
-     * all of the schemas. This node should have one and only one predecessor and zero or one 
-     * successor
-     * @param nodeToRemove Node to remove
-     * @param projectionMapping A map that defines how projections in after
-     * relate to projections in nodeToRemove.  Keys are the projection offsets in
-     * after, values are the new offsets in nodeToRemove.  If this field is null,
-     * then it will be assumed that the mapping is 1-1.
-     * @throws VisitorException, FrontendException
-     */
-    protected void removeFromChain(
-            LogicalOperator nodeToRemove,
-            Map<Integer, Integer> projectionMapping)
-            throws VisitorException, FrontendException {
-    	
-    	List<LogicalOperator> afterNodes = mPlan.getPredecessors(nodeToRemove);
-    	if (afterNodes.size()!=1)
-    		throw new RuntimeException("removeFromChain only valid to remove " + 
-            	"node has one predecessor.");
-    	List<LogicalOperator> beforeNodes = mPlan.getSuccessors(nodeToRemove);
-    	if (beforeNodes!=null && beforeNodes.size()!=1)
-    		throw new RuntimeException("removeFromChain only valid to remove " + 
-        		"node has one successor.");
-    	
-    	// Get after and before node
-    	LogicalOperator after = mPlan.getPredecessors(nodeToRemove).get(0);
-    	LogicalOperator before = null;
-    	if (beforeNodes!=null)
-    		before = mPlan.getSuccessors(nodeToRemove).get(0);
-    	
-        // Remove nodeToRemove from plan
-    	mPlan.remove(nodeToRemove);
-    	if (before!=null)
-    	{
-	    	// Shortcut nodeToRemove.
-	        mPlan.connect(after, before);
-	
-	        // Visit all the inner plans of before and change their projects to
-	        // connect to after instead of nodeToRemove.
-	        // Find right inner plan(s) to visit
-	        List<LogicalPlan> plans = new ArrayList<LogicalPlan>();
-	        if (before instanceof LOCogroup) {
-	            plans.addAll((((LOCogroup)before).getGroupByPlans()).values());
-	        } else if (before instanceof LOSort) {
-	            plans.addAll(((LOSort)before).getSortColPlans());
-	        } else if (before instanceof LOFilter) {
-	            plans.add(((LOFilter)before).getComparisonPlan());
-	        } else if (before instanceof LOSplitOutput) {
-	            plans.add(((LOSplitOutput)before).getConditionPlan());
-	        } else if (before instanceof LOForEach) {
-	            plans.addAll(((LOForEach)before).getForEachPlans());
-	        }
-	        
-	        for (LogicalPlan lp : plans) {
-	            ProjectFixerUpper pfu =
-	                new ProjectFixerUpper(lp, nodeToRemove, after, projectionMapping);
-	            pfu.visit();
-	        }
-	
-    	}
-
-    	// Now rebuild the schemas
-        // rebuildSchemas();
-    }
-
     @Override
     public void reset() {
         // do nothing
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java b/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
index 5c50d3b27..47f65f096 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/OpLimitOptimizer.java
@@ -159,7 +159,7 @@ public class OpLimitOptimizer extends LogicalTransformer {
             		if (prepredecessor!=null)
             		{
             				try {
-            					removeFromChain(limit, null);
+            					mPlan.removeAndReconnect(limit);
             					insertBetween(prepredecessor, limit, predecessor, null);
             					
             				} catch (Exception e) {
@@ -213,7 +213,7 @@ public class OpLimitOptimizer extends LogicalTransformer {
                     else
                         sort.setLimit(sort.getLimit()<limit.getLimit()?sort.getLimit():limit.getLimit());
                     try {
-                        removeFromChain(limit, null);
+                        mPlan.removeAndReconnect(limit);
                     } catch (Exception e) {
                         int errCode = 2012;
                         String msg = "Can not remove LOLimit after LOSort";
@@ -227,7 +227,7 @@ public class OpLimitOptimizer extends LogicalTransformer {
             	LOLimit beforeLimit = (LOLimit)predecessor;
             	beforeLimit.setLimit(beforeLimit.getLimit()<limit.getLimit()?beforeLimit.getLimit():limit.getLimit());
             	try {
-            		removeFromChain(limit, null);
+            		mPlan.removeAndReconnect(limit);
             	} catch (Exception e) {
             	    int errCode = 2012;
             	    String msg = "Can not remove LOLimit after LOLimit";
diff --git a/test/org/apache/pig/test/TestLogicalOptimizer.java b/test/org/apache/pig/test/TestLogicalOptimizer.java
index fdb98658e..093edd195 100644
--- a/test/org/apache/pig/test/TestLogicalOptimizer.java
+++ b/test/org/apache/pig/test/TestLogicalOptimizer.java
@@ -184,6 +184,17 @@ public class TestLogicalOptimizer extends junit.framework.TestCase {
         
     }
 
+    @Test
+    //See bug PIG-913
+    public void testOPLimit10Optimizer() throws Exception {
+        planTester.buildPlan("A = load 'myfile' AS (s:chararray);");
+        planTester.buildPlan("B = limit A 100;");
+        LogicalPlan plan = planTester.buildPlan("C = GROUP B by $0;");
+        optimizePlan(plan);
+        compareWithGoldenFile(plan, FILE_BASE_LOCATION + "optlimitplan10.dot");
+    }
+
+    
     @Test
     //Test to ensure that the right exception is thrown
     public void testErrImplicitSplitInserter() throws Exception {
diff --git a/test/org/apache/pig/test/data/DotFiles/optlimitplan10.dot b/test/org/apache/pig/test/data/DotFiles/optlimitplan10.dot
new file mode 100644
index 000000000..ef1ed364c
--- /dev/null
+++ b/test/org/apache/pig/test/data/DotFiles/optlimitplan10.dot
@@ -0,0 +1,7 @@
+digraph graph1 {
+    LOLoad1061 -> LOLimit1062;
+    LOLimit1062 [limit="100"];
+    LOLimit1062 -> LOForEach1067;
+    LOForEach1067 [hasflat="false"];
+    LOForEach1067 -> LOCogroup1064;
+}
