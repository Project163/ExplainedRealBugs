diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
index 2d54eaeb9..586f15f17 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
@@ -17,6 +17,7 @@
  */
 package org.apache.pig.backend.hadoop.executionengine.physicalLayer;
 
+import java.io.IOException;
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.List;
@@ -28,6 +29,7 @@ import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pig.ComparisonFunc;
 import org.apache.pig.EvalFunc;
+import org.apache.pig.FuncSpec;
 import org.apache.pig.LoadFunc;
 import org.apache.pig.data.DataType;
 import org.apache.pig.impl.PigContext;
@@ -38,6 +40,9 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOpe
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.ExpressionOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.BinaryExpressionOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.UnaryExpressionOperator;
+import org.apache.pig.builtin.BinStorage;
+import org.apache.pig.impl.io.FileLocalizer;
+import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.logicalLayer.*;
 import org.apache.pig.impl.plan.DependencyOrderWalker;
 import org.apache.pig.impl.plan.DependencyOrderWalkerWOSeenChk;
@@ -759,6 +764,14 @@ public class LogToPhyTranslationVisitor extends LOVisitor {
         String scope = split.getOperatorKey().scope;
         PhysicalOperator physOp = new POSplit(new OperatorKey(scope, nodeGen
                 .getNextNodeId(scope)), split.getRequestedParallelism());
+        FileSpec splStrFile;
+        try {
+            splStrFile = new FileSpec(FileLocalizer.getTemporaryPath(null, pc).toString(),new FuncSpec(BinStorage.class.getName()));
+        } catch (IOException e1) {
+            log.error("Unable to obtain a temporary path because " + e1.getMessage());
+            throw new VisitorException(e1);
+        }
+        ((POSplit)physOp).setSplitStore(splStrFile);
         LogToPhyMap.put(split, physOp);
 
         currentPlan.add(physOp);
diff --git a/test/org/apache/pig/test/TestLogToPhyCompiler.java b/test/org/apache/pig/test/TestLogToPhyCompiler.java
index 634b91b39..ccd50c7cf 100644
--- a/test/org/apache/pig/test/TestLogToPhyCompiler.java
+++ b/test/org/apache/pig/test/TestLogToPhyCompiler.java
@@ -68,10 +68,16 @@ public class TestLogToPhyCompiler extends junit.framework.TestCase {
     
     Random r = new Random();
     PigContext pc = new PigContext(ExecType.LOCAL, new Properties());
-
+    
     private boolean generate = false;
     
     
+    
+    @Override
+    protected void setUp() throws Exception {
+        pc.connect();
+    }
+
     private void writeData(File input, int noTuples, int arityOfTuples, char separator) throws IOException {
     	FileOutputStream dat = new FileOutputStream(input);
         
diff --git a/test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld b/test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld
index 57b4a6ee1..cb96f36bf 100644
--- a/test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld
+++ b/test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld
@@ -1,20 +1,20 @@
 Filter[tuple] - Test-Plan-Builder-214
 |   |
-|   Not[boolean] - Test-Plan-Builder-217
+|   POIsNull[tuple] - Test-Plan-Builder-216
 |   |
-|   |---POIsNull[tuple] - Test-Plan-Builder-216
-|       |
-|       |---Project[bytearray][0] - Test-Plan-Builder-215
+|   |---Project[bytearray][0] - Test-Plan-Builder-215
 |
 |---Split - Test-Plan-Builder-213
     |
     |---Load(a:org.apache.pig.builtin.PigStorage) - Test-Plan-Builder-212
 
-Filter[tuple] - Test-Plan-Builder-218
+Filter[tuple] - Test-Plan-Builder-217
 |   |
-|   POIsNull[tuple] - Test-Plan-Builder-220
+|   Not[boolean] - Test-Plan-Builder-220
 |   |
-|   |---Project[bytearray][0] - Test-Plan-Builder-219
+|   |---POIsNull[tuple] - Test-Plan-Builder-219
+|       |
+|       |---Project[bytearray][0] - Test-Plan-Builder-218
 |
 |---Split - Test-Plan-Builder-213
     |
diff --git a/test/org/apache/pig/test/data/GoldenFiles/Split1.gld b/test/org/apache/pig/test/data/GoldenFiles/Split1.gld
index df21fe2b4..f991fcebf 100644
--- a/test/org/apache/pig/test/data/GoldenFiles/Split1.gld
+++ b/test/org/apache/pig/test/data/GoldenFiles/Split1.gld
@@ -1,6 +1,6 @@
 Filter[tuple] - Test-Plan-Builder-196
 |   |
-|   Greater Than[boolean] - Test-Plan-Builder-199
+|   Less Than[boolean] - Test-Plan-Builder-199
 |   |
 |   |---Project[bytearray][0] - Test-Plan-Builder-197
 |   |
@@ -12,7 +12,7 @@ Filter[tuple] - Test-Plan-Builder-196
 
 Filter[tuple] - Test-Plan-Builder-200
 |   |
-|   Less Than[boolean] - Test-Plan-Builder-203
+|   Greater Than[boolean] - Test-Plan-Builder-203
 |   |
 |   |---Project[bytearray][0] - Test-Plan-Builder-201
 |   |
