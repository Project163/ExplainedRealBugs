diff --git a/CHANGES.txt b/CHANGES.txt
index b728067ca..f6574946c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -42,6 +42,8 @@ PIG-5450: Pig-on-Spark3 E2E ORC test failing with java.lang.VerifyError: Bad ret
 
 PIG-5452: Null handling of FLATTEN with user defined schema (as clause) (knoguchi)
 
+PIG-5453: FLATTEN shifting fields incorrectly (knoguchi)
+
 Release 0.18.0 - Unreleased
  
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
index e9fa5a610..710c163f1 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POForEach.java
@@ -549,7 +549,8 @@ public class POForEach extends PhysicalOperator {
                 }
             } else if(in instanceof Tuple) {
                 Tuple t = (Tuple)in;
-                int size = t.size();
+                int size = flattenNumFields == null || flattenNumFields[i] == 0 ?
+                           t.size() : Math.min(flattenNumFields[i], t.size());
                 for(int j = 0; j < size; ++j) {
                     if (knownSize) {
                         out.set(idx++, t.get(j));
@@ -557,6 +558,14 @@ public class POForEach extends PhysicalOperator {
                         out.append(t.get(j));
                     }
                 }
+                // if size >= flattenNumFields[i], then fill the rest with null
+                for(int j = size; j < flattenNumFields[i]; ++j) {
+                    if (knownSize) {
+                        out.set(idx++, null);
+                    } else {
+                        out.append(null);
+                    }
+                }
             } else if (in instanceof Map.Entry) {
                 Map.Entry entry = (Map.Entry)in;
                 if (knownSize) {
@@ -726,7 +735,12 @@ public class POForEach extends PhysicalOperator {
         clone.addOriginalLocation(alias, getOriginalLocations());
         clone.endOfAllInputProcessing = endOfAllInputProcessing;
         clone.mapSideOnly = mapSideOnly;
-        clone.flattenNumFields = flattenNumFields;
+        if( flattenNumFields != null )  {
+            clone.flattenNumFields = new int[flattenNumFields.length];
+            for(int i=0; i < flattenNumFields.length; i++) {
+                clone.flattenNumFields[i] = flattenNumFields[i];
+            }
+        }
         return clone;
     }
 
diff --git a/test/org/apache/pig/test/TestFlatten.java b/test/org/apache/pig/test/TestFlatten.java
index a1aeca13f..d33447ae0 100644
--- a/test/org/apache/pig/test/TestFlatten.java
+++ b/test/org/apache/pig/test/TestFlatten.java
@@ -386,4 +386,43 @@ public class TestFlatten {
 
         Util.checkQueryOutputs(actualResults.iterator(), expectedResults);
     }
+
+    @Test
+    public void testFlattenWithInconsistentNumberOfFields() throws Exception {
+        Storage.Data data = Storage.resetData(pig);
+        data.set("input",
+            Storage.tuple(
+                1,
+                Storage.tuple("a","b","c")
+            ),
+            Storage.tuple(
+                2,
+                Storage.tuple("a","b","c")
+            ),
+            Storage.tuple(
+                3,
+                Storage.tuple("a","b")
+            ),
+            Storage.tuple(
+                4,
+                Storage.tuple("a","b","c","d")
+            ),
+        );
+        pig.setBatchOn();
+        pig.registerQuery("A = load 'input' using mock.Storage() as (a0:int, a1:tuple());");
+        pig.registerQuery("B = foreach A GENERATE a0, " + 
+                              "FLATTEN(a1) as b1:chararray, b2:chararray, b3:chararray, a0 as a4");
+        pig.registerQuery("store B into 'output' using mock.Storage();");
+        List<ExecJob> execJobs = pig.executeBatch();
+        for( ExecJob execJob : execJobs ) {
+          assertTrue(execJob.getStatus() == ExecJob.JOB_STATUS.COMPLETED );
+        }
+        List<Tuple> actualResults = data.get("output");
+        List<Tuple> expectedResults = Util.getTuplesFromConstantTupleStrings(
+                new String[] {
+                "(1, 'a', 'b', 'c', 1)", "(2, 'a', 'b', 'c', 2)", 
+                "(3, 'a', 'b', null, 3)", "(4, 'a', 'b', 'c', 4)" });
+
+        Util.checkQueryOutputs(actualResults.iterator(), expectedResults);
+    }
 }
