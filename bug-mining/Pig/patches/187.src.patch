diff --git a/CHANGES.txt b/CHANGES.txt
index 8b21eb71e..4dedfa4d8 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -70,6 +70,8 @@ PIG-800: Fix distinct and order in local mode to not go into an infinite loop
 
 PIG-806: to remove author tags in the pig source code (sms).
 
+PIG-799: Unit tests on windows are failing after multiquery commit (daijy)
+
 Release 0.2.0
 
 INCOMPATIBLE CHANGES
diff --git a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
index ef9318ee1..bd60c6c15 100644
--- a/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
+++ b/src/org/apache/pig/impl/logicalLayer/parser/QueryParser.jjt
@@ -175,18 +175,14 @@ public class QueryParser {
 	
 
     String massageFilename(String filename, PigContext pigContext, boolean isLoad) throws IOException, ParseException {
-        boolean isMultiQuery = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("opt.multiquery","true"));
-
+        if (filename.startsWith(FileLocalizer.LOCAL_PREFIX)&&isLoad) {
+            filename = FileLocalizer.hadoopify(filename, pigContext);
+        } 
+    	boolean isMultiQuery = "true".equalsIgnoreCase(pigContext.getProperties().getProperty("opt.multiquery","true"));
         if (!isMultiQuery) {
             if(!isLoad) {
                 return filename;
             }
-
-            if (pigContext.getExecType() != ExecType.LOCAL) {
-                if (filename.startsWith(FileLocalizer.LOCAL_PREFIX)) {
-                    filename = FileLocalizer.hadoopify(filename, pigContext);
-                } 
-            }
             return filename;
         }
 
diff --git a/test/org/apache/pig/test/TestCounters.java b/test/org/apache/pig/test/TestCounters.java
index 4d66b4d89..9cb26333d 100644
--- a/test/org/apache/pig/test/TestCounters.java
+++ b/test/org/apache/pig/test/TestCounters.java
@@ -540,7 +540,7 @@ public class TestCounters extends TestCase {
         File out = File.createTempFile("output", ".txt");
         out.delete();
         PigServer pigServer = new PigServer("local");
-        pigServer.registerQuery("a = load '" + file + "';");
+        pigServer.registerQuery("a = load '" + Util.encodeEscape(file.toString()) + "';");
         pigServer.registerQuery("b = order a by $0;");
         pigServer.registerQuery("c = group b by $0;");
         pigServer.registerQuery("d = foreach c generate group, SUM(b.$1);");
diff --git a/test/org/apache/pig/test/TestLoad.java b/test/org/apache/pig/test/TestLoad.java
index 169de0cb1..2600bb18e 100644
--- a/test/org/apache/pig/test/TestLoad.java
+++ b/test/org/apache/pig/test/TestLoad.java
@@ -70,6 +70,8 @@ public class TestLoad extends junit.framework.TestCase {
     public void setUp() throws Exception {
         curDir = System.getProperty("user.dir");
         inpDir = curDir + File.separatorChar + "test/org/apache/pig/test/data/InputFiles/";
+        if ((System.getProperty("os.name").toUpperCase().startsWith("WINDOWS")))
+            inpDir="/"+FileLocalizer.parseCygPath(inpDir, FileLocalizer.STYLE_WINDOWS);
         inpFSpec = new FileSpec("file:" + inpDir + "passwd", new FuncSpec(PigStorage.class.getName(), new String[]{":"}));
 
         FileLocalizer.deleteTempFiles();
@@ -117,7 +119,13 @@ public class TestLoad extends junit.framework.TestCase {
 
     @Test
     public void testLoadLocalAbs() throws Exception {
-        checkLoadPath("file:"+curDir + File.separatorChar+"test/org/apache/pig/test/data/passwd", "", true);
+    	String filename = curDir + File.separatorChar+"test/org/apache/pig/test/data/passwd";
+        if ((System.getProperty("os.name").toUpperCase().startsWith("WINDOWS")))
+        {
+            filename="/"+FileLocalizer.parseCygPath(filename, FileLocalizer.STYLE_WINDOWS);
+            filename=Util.encodeEscape(filename);
+        }
+        checkLoadPath("file:"+filename, "", true);
     }
 
     @Test
diff --git a/test/org/apache/pig/test/TestTypeChecking.java b/test/org/apache/pig/test/TestTypeChecking.java
index 425fb55bc..d0dc2c81b 100644
--- a/test/org/apache/pig/test/TestTypeChecking.java
+++ b/test/org/apache/pig/test/TestTypeChecking.java
@@ -252,7 +252,7 @@ public class TestTypeChecking extends TestCase {
 
     public void testSUM2() throws Throwable {
         TypeCheckingTestUtil.printCurrentMethodName() ;
-        planTester.buildPlan("a = group (load 'file:\" + tmpFile + \"') by ($0,$1);") ;
+        planTester.buildPlan("a = group (load '\" + tmpFile + \"') by ($0,$1);") ;
         LogicalPlan plan1 = planTester.buildPlan("b = foreach a generate flatten(group), SUM($1.$2);") ;
         planTester.typeCheckPlan(plan1);
     }
