diff --git a/CHANGES.txt b/CHANGES.txt
index bfe1211f1..1ac6cbab7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -106,6 +106,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-2540: [piggybank] AvroStorage can't read schema on amazon s3 in elastic mapreduce (rjurney via jcoveney)
+
 PIG-2618: e2e local fails to build
 
 PIG-2608: Typo in PigStorage documentation for source tagging (prkommireddi via daijy)
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorage.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorage.java
index ae77f0dab..171141a6c 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorage.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorage.java
@@ -27,6 +27,7 @@ import java.util.Map.Entry;
 import java.util.Properties;
 import java.util.Set;
 import java.util.HashSet;
+import java.net.URI;
 import org.apache.avro.Schema;
 import org.apache.avro.Schema.Field;
 import org.apache.avro.file.DataFileStream;
@@ -131,7 +132,7 @@ public class AvroStorage extends FileInputLoadFunc implements StoreFuncInterface
     @Override
     public void setLocation(String location, Job job) throws IOException {
         HashSet<Path> paths = new HashSet<Path>();
-    	if(AvroStorageUtils.getAllSubDirs(new Path(location), job, paths) && inputAvroSchema == null) {
+        if(AvroStorageUtils.getAllSubDirs(URI.create(location), job, paths) && inputAvroSchema == null) {
             FileInputFormat.setInputPaths(job, paths.toArray(new Path[0]));
             inputAvroSchema = getAvroSchema(location, job);
         }
@@ -139,7 +140,7 @@ public class AvroStorage extends FileInputLoadFunc implements StoreFuncInterface
 
     protected Schema getAvroSchema(String location, Job job) throws IOException {
         Configuration conf = job.getConfiguration();
-        FileSystem fs = FileSystem.get(conf);
+        FileSystem fs = FileSystem.get(URI.create(location), conf);
         Path path = new Path(location);
         return getAvroSchema(path, fs);
     }
diff --git a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
index 0eaa164f4..c7de726d5 100644
--- a/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
+++ b/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorageUtils.java
@@ -26,6 +26,7 @@ import java.util.HashSet;
 import java.util.LinkedList;
 import java.util.List;
 import java.util.Set;
+import java.net.URI;
 import org.apache.avro.Schema;
 import org.apache.avro.Schema.Field;
 import org.apache.hadoop.conf.Configuration;
@@ -100,7 +101,7 @@ public class AvroStorageUtils {
       Configuration conf = job.getConfiguration();
       FileSystem fs = FileSystem.get(conf);
       HashSet<Path> paths = new  HashSet<Path>();
-      if (getAllSubDirs(new Path(pathString), job, paths))
+      if (getAllSubDirs(URI.create(pathString), job, paths))
       {
         paths.addAll(Arrays.asList(FileInputFormat.getInputPaths(job)));
         FileInputFormat.setInputPaths(job, paths.toArray(new Path[0]));
@@ -115,20 +116,22 @@ public class AvroStorageUtils {
      * 
      * @throws IOException
      */
-     static boolean getAllSubDirs(Path path, Job job, Set<Path> paths) throws IOException {
-  		FileSystem fs = FileSystem.get(job.getConfiguration());
+    static boolean getAllSubDirs(URI location, Job job, Set<Path> paths) throws IOException {
+        FileSystem fs = FileSystem.get(location, job.getConfiguration());
+        Path path = new Path(location.getPath());
   		if (PATH_FILTER.accept(path)) {
   			try {
   				FileStatus file = fs.getFileStatus(path);
   				if (file.isDir()) {
   					for (FileStatus sub : fs.listStatus(path)) {
-  						getAllSubDirs(sub.getPath(), job, paths);
+                        getAllSubDirs(sub.getPath().toUri(), job, paths);
   					}
   				} else {
   					AvroStorageLog.details("Add input file:" + file);
   					paths.add(file.getPath());
   				}
   			} catch (FileNotFoundException e) {
+                AvroStorageLog.details("getAllSubDirs: RETURN FALSE; Input path does not exist: " + path);
   				AvroStorageLog.details("Input path does not exist: " + path);
   				return false;
   			}
diff --git a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
index 344460534..b4a1551f1 100644
--- a/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
+++ b/contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
@@ -61,7 +61,7 @@ public class TestAvroStorage {
       };
 
     private static String getInputFile(String file) {
-        return "file:///" + System.getProperty("user.dir") + "/" + basedir + file;
+        return "file://" + System.getProperty("user.dir") + "/" + basedir + file;
     }
 
     final private String testArrayFile = getInputFile("test_array.avro");
