diff --git a/CHANGES.txt b/CHANGES.txt
index 46768c000..68ef6c9e4 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -150,6 +150,8 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-1272: Column pruner causes wrong results (daijy)
+
 PIG-1275: empty bag in PigStorage read as null (daijy)
 
 PIG-1252: Diamond splitter does not generate correct results when using
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/PruneColumns.java b/src/org/apache/pig/impl/logicalLayer/optimizer/PruneColumns.java
index 4304231cf..ec3bfe533 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/PruneColumns.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/PruneColumns.java
@@ -220,12 +220,25 @@ public class PruneColumns extends LogicalTransformer {
             {
                 List<RequiredFields> requiredInputFieldsList = new ArrayList<RequiredFields>();
                 RequiredFields requiredFields = new RequiredFields(false);
-                for (RequiredFields rf : requiredOutputInfo.requiredFieldsList)
+                for (int i=0;i<mPlan.getSuccessors(rlo).size();i++)
                 {
+                    RequiredFields rf = null;
+                    try {
+                        rf = requiredOutputInfo.requiredFieldsList.get(i);
+                    } catch (Exception e) {
+                    }
                     if (rf!=null)
                     {
                         rf.reIndex(0);
                         requiredFields.merge(rf);
+                    } else {
+                        // need all fields
+                        List<Pair<Integer, Integer>> l = new ArrayList<Pair<Integer, Integer>>();
+                        for (int j=0;j<rlo.getSchema().size();j++)
+                            l.add(new Pair<Integer, Integer>(0, j));
+                        rf = new RequiredFields(l);
+                        requiredFields.merge(rf);
+                        break;
                     }
                 }
                 requiredInputFieldsList.add(requiredFields);
diff --git a/test/org/apache/pig/test/TestMultiQuery.java b/test/org/apache/pig/test/TestMultiQuery.java
index 8e2bed938..0cc6fb5f9 100644
--- a/test/org/apache/pig/test/TestMultiQuery.java
+++ b/test/org/apache/pig/test/TestMultiQuery.java
@@ -322,9 +322,9 @@ public class TestMultiQuery {
 
             List<Tuple> expectedResults = Util.getTuplesFromConstantTupleStrings(
                     new String[] { 
-                            "(1L,1L,'apple',1L,{(1L)})",
-                            "(2L,2L,'orange',2L,{(2L)})",
-                            "(3L,3L,'persimmon',3L,{(3L)})"
+                            "(1L,'apple',3,1L,'apple',1L,{(1L)})",
+                            "(2L,'orange',4,2L,'orange',2L,{(2L)})",
+                            "(3L,'persimmon',5,3L,'persimmon',3L,{(3L)})"
                     });
             
             int counter = 0;
diff --git a/test/org/apache/pig/test/TestPruneColumn.java b/test/org/apache/pig/test/TestPruneColumn.java
index 47bbe38af..84c657b64 100644
--- a/test/org/apache/pig/test/TestPruneColumn.java
+++ b/test/org/apache/pig/test/TestPruneColumn.java
@@ -1844,5 +1844,25 @@ public class TestPruneColumn extends TestCase {
         assertTrue(checkLogFileMessage(new String[]{"No column pruned for A",
             "No map keys pruned for A", "[0,1,2]"}));
     }
+    
+    // See PIG-1272
+    @Test
+    public void testSplit4() throws Exception {
+        pigServer.registerQuery("A = load '"+ Util.generateURI(tmpFile1.toString(), pigServer.getPigContext()) + "' AS (a0, a1, a2);");
+        pigServer.registerQuery("B = foreach A generate a0;");
+        pigServer.registerQuery("C = join A by a0, B by a0;");
+        Iterator<Tuple> iter = pigServer.openIterator("C");
+
+        assertTrue(iter.hasNext());
+        Tuple t = iter.next();
+        assertTrue(t.toString().equals("(1,2,3,1)"));
+        
+        assertTrue(iter.hasNext());
+        t = iter.next();
+        assertTrue(t.toString().equals("(2,5,2,2)"));
+
+        assertTrue(checkLogFileMessage(new String[]{"No column pruned for A",
+                "No map keys pruned for A"}));
+    }
 
 }
