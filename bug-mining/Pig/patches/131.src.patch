diff --git a/CHANGES.txt b/CHANGES.txt
index cb97e9f2e..e1bc5a58d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -307,3 +307,6 @@ Trunk (unreleased changes)
     PIG-497: problems with UTF8 handling in BinStorage (pradeepk via olgan)
 
     PIG-505: working with map elements (sms via olgan)
+
+    PIG-517: load functiin with parameters does not work with cast (pradeepk
+    via olgan)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
index 6126492e8..ffec4776b 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/LogToPhyTranslationVisitor.java
@@ -1150,11 +1150,9 @@ public class LogToPhyTranslationVisitor extends LOVisitor {
         ExpressionOperator from = (ExpressionOperator) LogToPhyMap.get(op
                 .getExpression());
         physOp.setResultType(op.getType());
-        LoadFunc lf = op.getLoadFunc();
-        String lfString = null;
-        if(null != lf) {
-            lfString = lf.getClass().getName();
-            ((POCast) physOp).setLoadFSpec(lfString);
+        FuncSpec lfSpec = op.getLoadFuncSpec();
+        if(null != lfSpec) {
+            ((POCast) physOp).setLoadFSpec(lfSpec);
         }
         try {
             currentPlan.connect(from, physOp);
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
index d49f5b8e0..dba083363 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/POCast.java
@@ -23,6 +23,7 @@ import java.util.Map;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.pig.FuncSpec;
 import org.apache.pig.LoadFunc;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
@@ -44,7 +45,7 @@ import org.apache.pig.impl.plan.VisitorException;
  * Need the full operator implementation.
  */
 public class POCast extends ExpressionOperator {
-    private String loadFSpec = null;
+    private FuncSpec loadFSpec = null;
 	transient private LoadFunc load;
 	private Log log = LogFactory.getLog(getClass());
     private boolean castNotNeeded = false;
@@ -68,8 +69,8 @@ public class POCast extends ExpressionOperator {
         }
     }
     
-    public void setLoadFSpec(String fSpec) {
-    	this.loadFSpec = fSpec;
+    public void setLoadFSpec(FuncSpec lf) {
+    	this.loadFSpec = lf;
         instantiateFunc();
     }
 
diff --git a/src/org/apache/pig/impl/logicalLayer/LOCast.java b/src/org/apache/pig/impl/logicalLayer/LOCast.java
index fa3c578b6..7cb2197fa 100644
--- a/src/org/apache/pig/impl/logicalLayer/LOCast.java
+++ b/src/org/apache/pig/impl/logicalLayer/LOCast.java
@@ -18,6 +18,7 @@
 
 package org.apache.pig.impl.logicalLayer;
 
+import org.apache.pig.FuncSpec;
 import org.apache.pig.LoadFunc;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.PlanVisitor;
@@ -31,7 +32,7 @@ public class LOCast extends ExpressionOperator {
 
     private static final long serialVersionUID = 2L;
     private ExpressionOperator mExpr;
-    private LoadFunc mLoadFunc = null;
+    private FuncSpec mLoadFuncSpec = null;
 
     /**
      * 
@@ -84,12 +85,12 @@ public class LOCast extends ExpressionOperator {
         return false;
     }
 
-    public LoadFunc getLoadFunc() {
-        return mLoadFunc;
+    public FuncSpec getLoadFuncSpec() {
+        return mLoadFuncSpec;
     }
 
-    public void setLoadFunc(LoadFunc loadFunc) {
-        mLoadFunc = loadFunc;
+    public void setLoadFuncSpec(FuncSpec loadFuncSpec) {
+        mLoadFuncSpec = loadFuncSpec;
     }
 
 }
diff --git a/src/org/apache/pig/impl/logicalLayer/optimizer/TypeCastInserter.java b/src/org/apache/pig/impl/logicalLayer/optimizer/TypeCastInserter.java
index b5624770e..130c26c26 100644
--- a/src/org/apache/pig/impl/logicalLayer/optimizer/TypeCastInserter.java
+++ b/src/org/apache/pig/impl/logicalLayer/optimizer/TypeCastInserter.java
@@ -37,6 +37,7 @@ import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.plan.DepthFirstWalker;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.optimizer.OptimizerException;
+import org.apache.pig.FuncSpec;
 import org.apache.pig.LoadFunc;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.streaming.StreamingCommand;
@@ -160,17 +161,17 @@ public class TypeCastInserter extends LogicalTransformer {
                             p.connect(proj, cast);
                             
                             cast.setFieldSchema(fs.clone());
-                            LoadFunc loadFunc = null;
+                            FuncSpec loadFuncSpec = null;
                             if(lo instanceof LOLoad) {
-                                loadFunc = ((LOLoad)lo).getLoadFunc();
+                                loadFuncSpec = ((LOLoad)lo).getInputFile().getFuncSpec();
                             } else if (lo instanceof LOStream) {
                                 StreamingCommand command = ((LOStream)lo).getStreamingCommand();
                                 HandleSpec streamOutputSpec = command.getOutputSpec(); 
-                                loadFunc = (LoadFunc)PigContext.instantiateFuncFromSpec(streamOutputSpec.getSpec());
+                                loadFuncSpec = new FuncSpec(streamOutputSpec.getSpec());
                             } else {
                                 throw new OptimizerException("TypeCastInserter invoked with an invalid operator class name:" + lo.getClass().getSimpleName());
                             }
-                            cast.setLoadFunc(loadFunc);
+                            cast.setLoadFuncSpec(loadFuncSpec);
                             typeChanges.put(fs.canonicalName, fs.type);
                             if(determinedSchema == null) {
                                 // Reset the loads field schema to byte array so that it
diff --git a/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java b/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
index 52c8931ab..5f23d5ec8 100644
--- a/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
+++ b/src/org/apache/pig/impl/logicalLayer/validators/TypeCheckingVisitor.java
@@ -1615,8 +1615,8 @@ public class TypeCheckingVisitor extends LOVisitor {
         
         if(inputType == DataType.BYTEARRAY) {
             try {
-                LoadFunc loadFunc = getLoadFunc(cast.getExpression());
-                cast.setLoadFunc(loadFunc);
+                FuncSpec loadFuncSpec = getLoadFuncSpec(cast.getExpression());
+                cast.setLoadFuncSpec(loadFuncSpec);
             } catch (FrontendException fee) {
                 String msg = "Cannot resolve load function to use for casting from " + 
                             DataType.findTypeName(inputType) + " to " +
@@ -2547,7 +2547,7 @@ public class TypeCheckingVisitor extends LOVisitor {
         return new OperatorKey(scope, newId) ;
     }
 
-    private LoadFunc getLoadFunc(ExpressionOperator exOp) throws FrontendException {
+    private FuncSpec getLoadFuncSpec(ExpressionOperator exOp) throws FrontendException {
         Schema.FieldSchema fs = ((ExpressionOperator)exOp).getFieldSchema();
         if(null == fs) {
             return null;
@@ -2555,34 +2555,34 @@ public class TypeCheckingVisitor extends LOVisitor {
 
         Map<String, LogicalOperator> canonicalMap = fs.getCanonicalMap();
         MultiMap<LogicalOperator, String> reverseCanonicalMap = fs.getReverseCanonicalMap();
-        MultiMap<String, LoadFunc> loadFuncMap = new MultiMap<String, LoadFunc>();
+        MultiMap<String, FuncSpec> loadFuncSpecMap = new MultiMap<String, FuncSpec>();
         
         if(canonicalMap.keySet().size() > 0) {
             for(String parentCanonicalName: canonicalMap.keySet()) {
-                LoadFunc lf = getLoadFunc(exOp, parentCanonicalName);
-                if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                FuncSpec lfSpec = getLoadFuncSpec(exOp, parentCanonicalName);
+                if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
             }
         } else {
             for(LogicalOperator op: reverseCanonicalMap.keySet()) {
                 for(String parentCanonicalName: reverseCanonicalMap.get(op)) {
-                    LoadFunc lf = getLoadFunc(op, parentCanonicalName);
-                    if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                    FuncSpec lfSpec = getLoadFuncSpec(op, parentCanonicalName);
+                    if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                 }
             }
         }
-        if(loadFuncMap.keySet().size() == 0) {
+        if(loadFuncSpecMap.keySet().size() == 0) {
             return null;
         }
-        if(loadFuncMap.keySet().size() == 1) {
-            String lfString = loadFuncMap.keySet().iterator().next();
-            return (LoadFunc)(loadFuncMap.get(lfString).iterator().next());
+        if(loadFuncSpecMap.keySet().size() == 1) {
+            String lfString = loadFuncSpecMap.keySet().iterator().next();
+            return loadFuncSpecMap.get(lfString).iterator().next();
         }
 
-        throw new FrontendException("Found more than one load function to use: " + loadFuncMap.keySet());
+        throw new FrontendException("Found more than one load function to use: " + loadFuncSpecMap.keySet());
     }
 
-    private LoadFunc getLoadFunc(LogicalOperator op, String parentCanonicalName) throws FrontendException {
-        MultiMap<String, LoadFunc> loadFuncMap = new MultiMap<String, LoadFunc>();
+    private FuncSpec getLoadFuncSpec(LogicalOperator op, String parentCanonicalName) throws FrontendException {
+        MultiMap<String, FuncSpec> loadFuncSpecMap = new MultiMap<String, FuncSpec>();
         if(op instanceof ExpressionOperator) {
             if(op instanceof LOUserFunc) {
                 return null;
@@ -2594,25 +2594,25 @@ public class TypeCheckingVisitor extends LOVisitor {
             
             if(canonicalMap.keySet().size() > 0) {
                 for(String canonicalName: canonicalMap.keySet()) {
-                    LoadFunc lf = getLoadFunc(fs, canonicalName);
-                    if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                    FuncSpec lfSpec = getLoadFuncSpec(fs, canonicalName);
+                    if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                 }
             } else {
                 for(LogicalOperator lop: reverseCanonicalMap.keySet()) {
                     for(String canonicalName: reverseCanonicalMap.get(lop)) {
-                        LoadFunc lf = getLoadFunc(fs, canonicalName);
-                        if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                        FuncSpec lfSpec = getLoadFuncSpec(fs, canonicalName);
+                        if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                     }
                 }
             }
         } else {
             if(op instanceof LOLoad) {
-                return ((LOLoad)op).getLoadFunc();
+                return ((LOLoad)op).getInputFile().getFuncSpec();
             } else if (op instanceof LOStream) {
                 StreamingCommand command = ((LOStream)op).getStreamingCommand();
                 HandleSpec streamOutputSpec = command.getOutputSpec(); 
-                LoadFunc streamLoader = (LoadFunc)PigContext.instantiateFuncFromSpec(streamOutputSpec.getSpec());
-                return streamLoader;
+                FuncSpec streamLoaderSpec = new FuncSpec(streamOutputSpec.getSpec());
+                return streamLoaderSpec;
             } else if ((op instanceof LOFilter)
                     || (op instanceof LODistinct)
                     || (op instanceof LOSort)
@@ -2620,7 +2620,7 @@ public class TypeCheckingVisitor extends LOVisitor {
                     || (op instanceof LOSplitOutput)
                     || (op instanceof LOLimit)) {
                 LogicalPlan lp = op.getPlan();
-                return getLoadFunc(lp.getPredecessors(op).get(0), parentCanonicalName);        
+                return getLoadFuncSpec(lp.getPredecessors(op).get(0), parentCanonicalName);        
             }
             
             Schema s = op.getSchema();
@@ -2629,71 +2629,71 @@ public class TypeCheckingVisitor extends LOVisitor {
                     if(null != parentCanonicalName && (parentCanonicalName.equals(fs.canonicalName))) {
                         if(fs.getCanonicalMap().keySet().size() > 0) {
                             for(String canonicalName: fs.getCanonicalMap().keySet()) {
-                                LoadFunc lf = getLoadFunc(fs, canonicalName);
-                                if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                                FuncSpec lfSpec = getLoadFuncSpec(fs, canonicalName);
+                                if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                             }
                         } else {
-                            LoadFunc lf = getLoadFunc(fs, null);
-                            if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                            FuncSpec lfSpec = getLoadFuncSpec(fs, null);
+                            if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                         }
                     } else if (null == parentCanonicalName) {
-                        LoadFunc lf = getLoadFunc(fs, null);
-                        if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                        FuncSpec lfSpec = getLoadFuncSpec(fs, null);
+                        if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                     }
                 }
             } else {
                 LogicalPlan lp = op.getPlan();
                 for(LogicalOperator pred: lp.getPredecessors(op)) {
-                    LoadFunc lf = getLoadFunc(pred, parentCanonicalName);
-                    if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                    FuncSpec lfSpec = getLoadFuncSpec(pred, parentCanonicalName);
+                    if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                 }
             }
         }
-        if(loadFuncMap.keySet().size() == 0) {
+        if(loadFuncSpecMap.keySet().size() == 0) {
             return null;
         }
-        if(loadFuncMap.keySet().size() == 1) {
-            String lfString = loadFuncMap.keySet().iterator().next();
-            return (LoadFunc)(loadFuncMap.get(lfString).iterator().next());
+        if(loadFuncSpecMap.keySet().size() == 1) {
+            String lfString = loadFuncSpecMap.keySet().iterator().next();
+            return loadFuncSpecMap.get(lfString).iterator().next();
         }
     
-        throw new FrontendException("Found more than one load function to use: " + loadFuncMap.keySet());
+        throw new FrontendException("Found more than one load function to use: " + loadFuncSpecMap.keySet());
     }
 
-    private LoadFunc getLoadFunc(Schema.FieldSchema fs, String parentCanonicalName) throws FrontendException {
+    private FuncSpec getLoadFuncSpec(Schema.FieldSchema fs, String parentCanonicalName) throws FrontendException {
         if(null == fs) {
             return null;
         }
         Map<String, LogicalOperator> canonicalMap = fs.getCanonicalMap();
         MultiMap<LogicalOperator, String> reverseCanonicalMap = fs.getReverseCanonicalMap();
-        MultiMap<String, LoadFunc> loadFuncMap = new MultiMap<String, LoadFunc>();
+        MultiMap<String, FuncSpec> loadFuncSpecMap = new MultiMap<String, FuncSpec>();
 
         if(canonicalMap.keySet().size() > 0) {
             for(String canonicalName: canonicalMap.keySet()) {
                 if((null == parentCanonicalName) || (parentCanonicalName.equals(canonicalName))) {
-                    LoadFunc lf = getLoadFunc(canonicalMap.get(canonicalName), parentCanonicalName);
-                    if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                    FuncSpec lfSpec = getLoadFuncSpec(canonicalMap.get(canonicalName), parentCanonicalName);
+                    if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                 }
             }
         } else {
             for(LogicalOperator op: reverseCanonicalMap.keySet()) {
                 for(String canonicalName: reverseCanonicalMap.get(op)) {
                     if((null == parentCanonicalName) || (parentCanonicalName.equals(canonicalName))) {
-                        LoadFunc lf = getLoadFunc(op, parentCanonicalName);
-                        if(null != lf) loadFuncMap.put(lf.getClass().getName(), lf);
+                        FuncSpec lfSpec = getLoadFuncSpec(op, parentCanonicalName);
+                        if(null != lfSpec) loadFuncSpecMap.put(lfSpec.getClassName(), lfSpec);
                     }
                 }
             }
         }
-        if(loadFuncMap.keySet().size() == 0) {
+        if(loadFuncSpecMap.keySet().size() == 0) {
             return null;
         }
-        if(loadFuncMap.keySet().size() == 1) {
-            String lfString = loadFuncMap.keySet().iterator().next();
-            return (LoadFunc)(loadFuncMap.get(lfString).iterator().next());
+        if(loadFuncSpecMap.keySet().size() == 1) {
+            String lfString = loadFuncSpecMap.keySet().iterator().next();
+            return loadFuncSpecMap.get(lfString).iterator().next();
         }
 
-        throw new FrontendException("Found more than one load function to use: " + loadFuncMap.keySet());
+        throw new FrontendException("Found more than one load function to use: " + loadFuncSpecMap.keySet());
     }
 
 
diff --git a/test/org/apache/pig/test/PigStorageNoDefCtor.java b/test/org/apache/pig/test/PigStorageNoDefCtor.java
new file mode 100644
index 000000000..6aa85dbe4
--- /dev/null
+++ b/test/org/apache/pig/test/PigStorageNoDefCtor.java
@@ -0,0 +1,23 @@
+/**
+ * 
+ */
+package org.apache.pig.test;
+
+import org.apache.pig.builtin.PigStorage;
+
+/**
+ * Same as PigStorage with no default constructor - used
+ * in testing POCast with a loader function which has no
+ * default constructor
+ */
+public class PigStorageNoDefCtor extends PigStorage {
+
+    /**
+     * @param delimiter
+     */
+    public PigStorageNoDefCtor(String delimiter) {
+        super(delimiter);
+        // TODO Auto-generated constructor stub
+    }
+
+}
diff --git a/test/org/apache/pig/test/TestEvalPipeline.java b/test/org/apache/pig/test/TestEvalPipeline.java
index 4f477916b..edec7c439 100644
--- a/test/org/apache/pig/test/TestEvalPipeline.java
+++ b/test/org/apache/pig/test/TestEvalPipeline.java
@@ -817,4 +817,20 @@ public class TestEvalPipeline extends TestCase {
         }
     }
 
+    @Test
+    public void testLoadCtorArgs() throws IOException, ExecException {
+        
+        // Create input file
+        File input = Util.createInputFile("tmp", "", 
+                new String[] {"hello:world"});
+        pigServer.registerQuery("a = load 'file:" + Util.encodeEscape(input.toString()) + 
+                "' using org.apache.pig.test.PigStorageNoDefCtor(':');");
+        pigServer.registerQuery("b = foreach a generate (chararray)$0, (chararray)$1;");
+        Iterator<Tuple> it = pigServer.openIterator("b");
+        Tuple t = it.next();
+        assertEquals("hello", t.get(0));
+        assertEquals("world", t.get(1));
+        
+    }
+
 }
diff --git a/test/org/apache/pig/test/TestPOCast.java b/test/org/apache/pig/test/TestPOCast.java
index 9a2ff2f73..9b83d2a80 100644
--- a/test/org/apache/pig/test/TestPOCast.java
+++ b/test/org/apache/pig/test/TestPOCast.java
@@ -25,6 +25,7 @@ import java.util.Map;
 import java.util.Random;
 
 import org.apache.pig.ExecType;
+import org.apache.pig.FuncSpec;
 import org.apache.pig.LoadFunc;
 import org.apache.pig.backend.datastorage.DataStorage;
 import org.apache.pig.backend.executionengine.ExecException;
@@ -68,7 +69,7 @@ public class TestPOCast extends TestCase {
 		
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -173,7 +174,7 @@ public class TestPOCast extends TestCase {
 		
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -284,7 +285,7 @@ public class TestPOCast extends TestCase {
 		
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -406,7 +407,7 @@ public class TestPOCast extends TestCase {
 		
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -509,7 +510,7 @@ public class TestPOCast extends TestCase {
 	public void testStringToOther() throws PlanException, ExecException {
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -720,7 +721,7 @@ public class TestPOCast extends TestCase {
 	public void testByteArrayToOther() throws PlanException, ExecException {
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
 		LoadFunc load = new TestLoader();
-		op.setLoadFSpec(load.getClass().getName());
+		op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -837,7 +838,7 @@ public class TestPOCast extends TestCase {
 	
 	private PhysicalPlan constructPlan(POCast op) throws PlanException {
 	    LoadFunc load = new TestLoader();
-        op.setLoadFSpec(load.getClass().getName());
+        op.setLoadFSpec(new FuncSpec(load.getClass().getName()));
         POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
         PhysicalPlan plan = new PhysicalPlan();
         plan.add(prj);
@@ -987,7 +988,7 @@ public class TestPOCast extends TestCase {
 	@Test
 	public void testTupleToOther() throws PlanException, ExecException {
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
-		op.setLoadFSpec(PigStorage.class.getName());
+		op.setLoadFSpec(new FuncSpec(PigStorage.class.getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -1096,7 +1097,7 @@ public class TestPOCast extends TestCase {
 			Result res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
 
-		    op.setLoadFSpec(BinStorage.class.getName());
+		    op.setLoadFSpec(new FuncSpec(BinStorage.class.getName()));
 			plan.attachInput(tNew);
 			res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
@@ -1106,7 +1107,7 @@ public class TestPOCast extends TestCase {
 	@Test
 	public void testBagToOther() throws PlanException, ExecException {
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
-		op.setLoadFSpec(PigStorage.class.getName());
+		op.setLoadFSpec(new FuncSpec(PigStorage.class.getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -1197,7 +1198,7 @@ public class TestPOCast extends TestCase {
 			Result res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
 
-		    op.setLoadFSpec(BinStorage.class.getName());
+		    op.setLoadFSpec(new FuncSpec(BinStorage.class.getName()));
 			plan.attachInput(t);
 			res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
@@ -1207,7 +1208,7 @@ public class TestPOCast extends TestCase {
 	@Test
 	public void testMapToOther() throws PlanException, ExecException {
 		POCast op = new POCast(new OperatorKey("", r.nextLong()), -1);
-		op.setLoadFSpec(PigStorage.class.getName());
+		op.setLoadFSpec(new FuncSpec(PigStorage.class.getName()));
 		POProject prj = new POProject(new OperatorKey("", r.nextLong()), -1, 0);
 		PhysicalPlan plan = new PhysicalPlan();
 		plan.add(prj);
@@ -1293,7 +1294,7 @@ public class TestPOCast extends TestCase {
 			Result res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
 
-		    op.setLoadFSpec(BinStorage.class.getName());
+		    op.setLoadFSpec(new FuncSpec(BinStorage.class.getName()));
 			plan.attachInput(t);
 			res = op.getNext(i);
 			assertEquals(POStatus.STATUS_ERR, res.returnStatus);
diff --git a/test/org/apache/pig/test/TestTypeCheckingValidator.java b/test/org/apache/pig/test/TestTypeCheckingValidator.java
index 404518c96..a1ec53ddf 100644
--- a/test/org/apache/pig/test/TestTypeCheckingValidator.java
+++ b/test/org/apache/pig/test/TestTypeCheckingValidator.java
@@ -53,8 +53,9 @@ public class TestTypeCheckingValidator extends TestCase {
                 simpleEchoStreamingCommand = "perl -ne 'print \"$_\"'";
             File fileA = new File("a");
             File fileB = new File("b");
-            // Create file if it does not exist
             try {
+                fileA.delete();
+                fileB.delete();
                 if(!fileA.createNewFile() || !fileB.createNewFile())
                     fail("Unable to create input files");
             } catch (IOException e) {
@@ -2832,7 +2833,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc() == null);
+        assertTrue(cast.getLoadFuncSpec() == null);
 
     }
 
@@ -2863,7 +2864,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -2894,7 +2895,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -2927,7 +2928,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -2960,7 +2961,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -2992,7 +2993,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -3024,7 +3025,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -3057,7 +3058,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -3090,7 +3091,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -3124,13 +3125,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3165,13 +3166,13 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOMapLookup map = (LOMapLookup)foreachPlan.getSuccessors(exOp).get(0);
         LOCast cast = (LOCast)foreachPlan.getSuccessors(map).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3210,13 +3211,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3283,20 +3284,20 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(1);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3335,13 +3336,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3410,13 +3411,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3456,13 +3457,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3501,13 +3502,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -3545,13 +3546,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -3646,13 +3647,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3687,7 +3688,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc() == null);
+        assertTrue(cast.getLoadFuncSpec() == null);
 
     }
 
@@ -3754,7 +3755,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
     }
 
     @Test
@@ -3817,7 +3818,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3881,7 +3882,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -3941,7 +3942,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)filterPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -3972,7 +3973,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)filterPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4003,7 +4004,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4034,7 +4035,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4069,13 +4070,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4110,13 +4111,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4147,7 +4148,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)bPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
         LOSplitOutput splitOutputC = (LOSplitOutput)plan.getLeaves().get(0);
         LogicalPlan cPlan = splitOutputC.getConditionPlan();
@@ -4158,7 +4159,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         cast = (LOCast)cPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
     }
 
     @Test
@@ -4188,7 +4189,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)bPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
         LOSplitOutput splitOutputC = (LOSplitOutput)plan.getLeaves().get(0);
         LogicalPlan cPlan = splitOutputC.getConditionPlan();
@@ -4199,7 +4200,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         cast = (LOCast)cPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4230,7 +4231,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4261,7 +4262,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4296,13 +4297,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4337,13 +4338,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4374,7 +4375,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4405,7 +4406,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4440,13 +4441,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4481,13 +4482,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4518,7 +4519,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4549,7 +4550,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -4584,13 +4585,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4625,13 +4626,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4666,13 +4667,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4707,13 +4708,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4746,13 +4747,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(1);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -4789,7 +4790,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
     }
 
     @Test
@@ -4852,7 +4853,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -4914,13 +4915,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(1);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -4957,7 +4958,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
     }
 
     @Test
@@ -4996,7 +4997,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -5029,7 +5030,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -5069,7 +5070,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
     }
 
     @Test
@@ -5099,7 +5100,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -5130,7 +5131,7 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -5165,13 +5166,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -5206,13 +5207,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -5248,13 +5249,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -5290,13 +5291,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("PigStorage"));
 
     }
 
@@ -5328,7 +5329,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -5360,7 +5361,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
         
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(1);
 
@@ -5401,13 +5402,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -5441,13 +5442,13 @@ public class TestTypeCheckingValidator extends TestCase {
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
 
         LOCast cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
         foreachPlan = foreach.getForEachPlans().get(2);
         exOp = foreachPlan.getRoots().get(0);
         if(! (exOp instanceof LOProject)) exOp = foreachPlan.getRoots().get(1);
         cast = (LOCast)foreachPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
@@ -5480,7 +5481,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOMapLookup map = (LOMapLookup)foreachPlan.getSuccessors(exOp).get(0);
         LOCast cast = (LOCast)foreachPlan.getSuccessors(map).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -5513,7 +5514,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         LOMapLookup map = (LOMapLookup)foreachPlan.getSuccessors(exOp).get(0);
         LOCast cast = (LOCast)foreachPlan.getSuccessors(map).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.BinStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("BinStorage"));
 
     }
 
@@ -5552,7 +5553,7 @@ public class TestTypeCheckingValidator extends TestCase {
 
         
         LOCast cast = (LOCast)filterPlan.getSuccessors(exOp).get(0);
-        assertTrue(cast.getLoadFunc().toString().startsWith("org.apache.pig.builtin.PigStorage"));
+        assertTrue(cast.getLoadFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
 
     }
 
