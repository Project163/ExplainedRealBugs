diff --git a/CHANGES.txt b/CHANGES.txt
index 4a5d705bf..06186f03c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -26,6 +26,8 @@ PIG-1680: HBaseStorage should work with HBase 0.90 (gstathis, billgraham, dvryab
 
 IMPROVEMENTS
 
+PIG1918: Line number should be give for logical plan failures (xuefu)
+
 PIG-1961: Pig prints "null" as file name in case of grammar error (xuefu)
 
 PIG-1956: Pig parser shouldn't log error code 0 (xuefu)
diff --git a/src/org/apache/pig/impl/logicalLayer/FrontendException.java b/src/org/apache/pig/impl/logicalLayer/FrontendException.java
index e4459d8d0..ad244df46 100644
--- a/src/org/apache/pig/impl/logicalLayer/FrontendException.java
+++ b/src/org/apache/pig/impl/logicalLayer/FrontendException.java
@@ -17,12 +17,14 @@
  */
 package org.apache.pig.impl.logicalLayer;
 
+
 import org.apache.pig.PigException;
+import org.apache.pig.newplan.Operator;
 
 public class FrontendException extends PigException {
 
-	// Change this if you modify the class.
-	static final long serialVersionUID = 1L;
+    // Change this if you modify the class.
+    static final long serialVersionUID = 1L;
 
     /**
      * Create a new FrontendException with null as the error message.
@@ -128,7 +130,7 @@ public class FrontendException extends PigException {
         super(message, errCode, errSrc, retry);
     }    
 
-	/**
+    /**
      * Create a new FrontendException with the specified message, error code, error source, retriable or not, detalied message for the developer and cause.
      *
      * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
@@ -137,10 +139,10 @@ public class FrontendException extends PigException {
      * @param retry - If the exception is retriable or not
      * @param detailedMsg - The detailed message shown to the developer 
      */
-	public FrontendException(String message, int errCode, byte errSrc,
-			boolean retry, String detailedMsg) {
-		super(message, errCode, errSrc, retry, detailedMsg);
-	}
+    public FrontendException(String message, int errCode, byte errSrc,
+            boolean retry, String detailedMsg) {
+        super(message, errCode, errSrc, retry, detailedMsg);
+    }
     
     /**
      * Create a new FrontendException with the specified message, error code, error source, retriable or not, detalied message for the developer and cause.
@@ -157,4 +159,80 @@ public class FrontendException extends PigException {
         super(message, errCode, errSrc, retry, detailedMsg, cause);
     }
 
+    /**
+     * Create a new FrontendException with the specified message and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     */
+    public FrontendException(Operator op, String message) {
+        this( op.getLocation() + message );
+    }
+
+    /**
+     * Create a new FrontendException with the specified message and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     * @param errCode - The error code shown to the user 
+     */
+    public FrontendException(Operator op, String message, int errCode) {
+        this( op.getLocation() + message, errCode );
+    }
+
+    /**
+     * Create a new FrontendException with the specified message and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     * @param errCode - The error code shown to the user 
+     * @param errSrc - The error source 
+     */
+    public FrontendException(Operator op, String message, int errCode,
+            byte errSrc) {
+        this( op.getLocation() + message, errCode );
+    }
+
+    /**
+     * Create a new FrontendException with the specified message and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     * @param errCode - The error code shown to the user 
+     * @param errSrc - The error source
+     * @param cause - The cause (which is saved for later retrieval by the <link>Throwable.getCause()</link> method) indicating the source of this exception. A null value is permitted, and indicates that the cause is nonexistent or unknown. 
+     */
+    public FrontendException(Operator op, String message, int errCode,
+            byte errSrc, Throwable cause) {
+        this( op.getLocation() + message, errCode, errSrc, cause );
+    }
+
+    /**
+     * Create a new FrontendException with the specified message and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     * @param errCode - The error code shown to the user 
+     * @param cause - The cause (which is saved for later retrieval by the <link>Throwable.getCause()</link> method) indicating the source of this exception. A null value is permitted, and indicates that the cause is nonexistent or unknown. 
+     */
+    public FrontendException(Operator op, String message, int errCode, Throwable cause) {
+        this( op.getLocation() + message, errCode, cause );
+    }
+
+    /**
+     * Create a new FrontendException with the specified message, error code, error source, retriable or not, detalied message for the developer and cause.
+     *
+     * @param op - logical operator where the exception occurs
+     * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
+     * @param errCode - The error code shown to the user 
+     * @param errSrc - The error source 
+     * @param retry - If the exception is retriable or not
+     * @param detailedMsg - The detailed message shown to the developer 
+     * @param cause - The cause (which is saved for later retrieval by the <link>Throwable.getCause()</link> method) indicating the source of this exception. A null value is permitted, and indicates that the cause is nonexistent or unknown.
+     */
+    public FrontendException(Operator op, String message, int errCode, byte errSrc,
+            boolean retry, String detailedMsg, Throwable cause) {
+        super(op.getLocation() + message, errCode, errSrc, retry, detailedMsg, cause);
+    }
+
 }
diff --git a/src/org/apache/pig/impl/plan/VisitorException.java b/src/org/apache/pig/impl/plan/VisitorException.java
index d9ee16106..1b6d867ee 100644
--- a/src/org/apache/pig/impl/plan/VisitorException.java
+++ b/src/org/apache/pig/impl/plan/VisitorException.java
@@ -46,7 +46,7 @@ public class VisitorException extends FrontendException {
      * @param message - The error message (which is saved for later retrieval by the <link>Throwable.getMessage()</link> method) shown to the user 
      */
     public VisitorException(org.apache.pig.newplan.Operator op, String message) {
-        super(op.getLocation() + message);
+        super(op, message);
     }
 
     /**
@@ -86,7 +86,7 @@ public class VisitorException extends FrontendException {
      * @param errCode - The error code shown to the user 
      */
     public VisitorException(org.apache.pig.newplan.Operator op, String message, int errCode) {
-        super(op.getLocation() + message, errCode);
+        super(op, message, errCode);
     }
 
     /**
@@ -120,7 +120,7 @@ public class VisitorException extends FrontendException {
      * @param errSrc - The error source 
      */
     public VisitorException(org.apache.pig.newplan.Operator op, String message, int errCode, byte errSrc) {
-        super(op.getLocation() + message, errCode, errSrc);
+        super(op, message, errCode, errSrc);
     }
 
     /**
@@ -147,7 +147,7 @@ public class VisitorException extends FrontendException {
      */
     public VisitorException(org.apache.pig.newplan.Operator op, String message, int errCode, byte errSrc,
             Throwable cause) {
-        super(op.getLocation() + message, errCode, errSrc, cause);
+        super(op, message, errCode, errSrc, cause);
     }
 
     /**
diff --git a/src/org/apache/pig/newplan/logical/relational/LOCogroup.java b/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
index bd6f281e8..f48c7bfea 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOCogroup.java
@@ -117,7 +117,7 @@ public class LOCogroup extends LogicalRelationalOperator {
         List<Operator> inputs = null;
         inputs = plan.getPredecessors(this);
         if (inputs == null) {
-            throw new FrontendException("Cannot get predecessor for " + this, 2233);
+            throw new FrontendException(this, "Cannot get predecessor for " + this, 2233);
         }
         
         List<LogicalFieldSchema> fieldSchemaList = new ArrayList<LogicalFieldSchema>();
@@ -183,7 +183,7 @@ public class LOCogroup extends LogicalRelationalOperator {
         }
         
         if (groupKeySchema==null) {
-            throw new FrontendException("Cannot get group key schema for " + this, 2234);
+            throw new FrontendException(this, "Cannot get group key schema for " + this, 2234);
         }
         groupKeyUidOnlySchema = groupKeySchema.mergeUid(groupKeyUidOnlySchema);
 
diff --git a/src/org/apache/pig/newplan/logical/relational/LOGenerate.java b/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
index 10d585dcc..383ba1545 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOGenerate.java
@@ -153,7 +153,7 @@ public class LOGenerate extends LogicalRelationalOperator {
                     // Merge uid with the exp field schema
                     mergedSchema = LogicalSchema.merge(mUserDefinedSchemaCopy, expSchema, LogicalSchema.MergeMode.LoadForEach);
                     if (mergedSchema==null) {
-                        throw new FrontendException("Cannot merge (" + expSchema.toString(false) + 
+                        throw new FrontendException(this, "Cannot merge (" + expSchema.toString(false) + 
                                 ") with user defined schema (" + mUserDefinedSchemaCopy.toString(false) + ")", 1117);
                     }
                     mergedSchema.mergeUid(expSchema);
diff --git a/src/org/apache/pig/newplan/logical/relational/LOLoad.java b/src/org/apache/pig/newplan/logical/relational/LOLoad.java
index 924ac6428..9b8ff21e7 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOLoad.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOLoad.java
@@ -79,7 +79,7 @@ public class LOLoad extends LogicalRelationalOperator {
             
             return loadFunc;
         }catch (ClassCastException cce) {
-            throw new FrontendException(fs.getFuncSpec() + " should implement the LoadFunc interface.", 2236);    		
+            throw new FrontendException(this, fs.getFuncSpec() + " should implement the LoadFunc interface.", 2236);    		
         }
     }
     
@@ -151,7 +151,7 @@ public class LOLoad extends LogicalRelationalOperator {
                 Schema oldSchema = Schema.getPigSchema(resourceSchema);
                 return Util.translateSchema(oldSchema);
             } catch (IOException e) {
-                throw new FrontendException("Cannot get schema from loadFunc " + loadFunc.getClass().getName(), 2245, e);
+                throw new FrontendException( this, "Cannot get schema from loadFunc " + loadFunc.getClass().getName(), 2245, e);
             }
         }
         return null;
@@ -199,7 +199,7 @@ public class LOLoad extends LogicalRelationalOperator {
 			} catch (IOException ioe) {
 				int errCode = 1018;
 				String msg = "Problem serializing script schema";
-				FrontendException fee = new FrontendException(msg, errCode,
+				FrontendException fee = new FrontendException(this, msg, errCode,
 						PigException.INPUT, false, null, ioe);
 				throw new RuntimeException(fee);
 			}
diff --git a/src/org/apache/pig/newplan/logical/relational/LOSort.java b/src/org/apache/pig/newplan/logical/relational/LOSort.java
index 9849a7a9b..392c412e8 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOSort.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOSort.java
@@ -133,7 +133,7 @@ public class LOSort extends LogicalRelationalOperator{
                 opsList.add(opsIterator.next());
             }
             if(opsList.size() != 1 || !(opsList.get(0) instanceof ProjectExpression)) {
-                throw new FrontendException("Unsupported operator in inner plan: " + opsList.get(0), 2237);
+                throw new FrontendException(this, "Unsupported operator in inner plan: " + opsList.get(0), 2237);
             }
             ProjectExpression project = (ProjectExpression) opsList.get(0);
             
diff --git a/src/org/apache/pig/newplan/logical/relational/LOUnion.java b/src/org/apache/pig/newplan/logical/relational/LOUnion.java
index b9961b41a..4be8f0039 100644
--- a/src/org/apache/pig/newplan/logical/relational/LOUnion.java
+++ b/src/org/apache/pig/newplan/logical/relational/LOUnion.java
@@ -67,7 +67,7 @@ public class LOUnion extends LogicalRelationalOperator {
                         + " is null." 
                         + " UNION ONSCHEMA cannot be used with relations that"
                         + " have null schema.";
-                    throw new FrontendException(msg, 1116, PigException.INPUT);
+                    throw new FrontendException(this, msg, 1116, PigException.INPUT);
 
                 } else {
                     return null;
@@ -137,7 +137,7 @@ public class LOUnion extends LogicalRelationalOperator {
                 if(fs.alias == null){
                     String msg = "Schema of relation " + lop.getAlias()
                         + " has a null fieldschema for column(s). Schema :" + sch.toString(false);
-                    throw new FrontendException( msg, 1116, PigException.INPUT );
+                    throw new FrontendException( this, msg, 1116, PigException.INPUT );
                 }
             }
             schemas.add( sch );
@@ -150,7 +150,7 @@ public class LOUnion extends LogicalRelationalOperator {
         } catch(FrontendException e)                 {
             String msg = "Error merging schemas for union operator : "
                 + e.getMessage();
-            throw new FrontendException(msg, 1116, PigException.INPUT, e);
+            throw new FrontendException(this, msg, 1116, PigException.INPUT, e);
         }
         
         return mergedSchema;
diff --git a/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java b/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
index 6d4c9ab2d..061f497b1 100644
--- a/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
+++ b/src/org/apache/pig/newplan/logical/relational/LogToPhyTranslationVisitor.java
@@ -558,7 +558,7 @@ public class LogToPhyTranslationVisitor extends LogicalRelationalNodesVisitor {
                             }
                             
                         } catch (ExecException e) {
-                            throw new FrontendException("Cannot get column from "+leaf, 2230, e);
+                            throw new FrontendException(foreach, "Cannot get column from "+leaf, 2230, e);
                         }
 
                     }else{                    
@@ -921,7 +921,7 @@ public class LogToPhyTranslationVisitor extends LogicalRelationalNodesVisitor {
                         LogicalSchema s = ((LogicalRelationalOperator)op).getSchema();
                         // if the schema cannot be determined
                         if (s == null) {
-                            throw new FrontendException("Cannot determine skewed join schema", 2247);
+                            throw new FrontendException(loj, "Cannot determine skewed join schema", 2247);
                         }
                         skj.addSchema(Util.translateSchema(s));
                     } catch (FrontendException e) {
diff --git a/test/org/apache/pig/parser/TestErrorHandling.java b/test/org/apache/pig/parser/TestErrorHandling.java
index 297ec12b6..a25370efc 100644
--- a/test/org/apache/pig/parser/TestErrorHandling.java
+++ b/test/org/apache/pig/parser/TestErrorHandling.java
@@ -173,6 +173,23 @@ public class TestErrorHandling {
         Assert.fail( "Testcase should fail" );
     }
 
+    @Test
+    public void tesNegative10() throws IOException {
+        String query = "A = load 'x' as (u :int, v: chararray);\n" +
+                       "B = load 'y';\n" +
+                       "C = union onschema A, B;";
+        try {
+            pig.registerQuery( query );
+        } catch(FrontendException ex) {
+            System.out.println( ex.getMessage() );
+            Assert.assertTrue( ex.getMessage().contains( "line 3, column 4" ) );
+            Assert.assertTrue( ex.getMessage().contains( 
+            		"UNION ONSCHEMA cannot be used with relations that have null schema" ) );
+            return;
+        }
+        Assert.fail( "Testcase should fail" );
+    }
+
     @Test // PIG-1961
     public void tesNegative11() throws IOException {
         String query = "A = load ^ 'x' as (name, age, gpa);\n";
