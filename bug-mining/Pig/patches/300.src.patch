diff --git a/CHANGES.txt b/CHANGES.txt
index 97fc57c32..1dbfcbffb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -41,6 +41,9 @@ OPTIMIZATIONS
 
 BUG FIXES
 
+PIG-1107: PigLineRecordReader bails out on an empty line for compressed data
+(ankit.modi via olgan)
+
 PIG-598: Parameter substitution ($PARAMETER) should not be performed in
 comments (thejas via olgan)
 
diff --git a/src/org/apache/pig/impl/io/PigLineRecordReader.java b/src/org/apache/pig/impl/io/PigLineRecordReader.java
index be88a4e57..f0adb3aa3 100644
--- a/src/org/apache/pig/impl/io/PigLineRecordReader.java
+++ b/src/org/apache/pig/impl/io/PigLineRecordReader.java
@@ -133,7 +133,8 @@ public class PigLineRecordReader {
                 
                 if (b == '\n' ) {
                     byte[] array = mBuf.toByteArray();
-                    if (array[array.length-1]=='\r' && os==OS_WINDOWS) {
+                    if (array.length != 0 && array[array.length-1]=='\r' 
+                        && os==OS_WINDOWS) {
                         // Here we dont copy the last '\r' in the Text Value
                         value.append(array, 0, array.length - 1 );
                     } else {
diff --git a/test/org/apache/pig/test/TestPigLineRecordReader.java b/test/org/apache/pig/test/TestPigLineRecordReader.java
index 424427c8f..061f5c7a9 100644
--- a/test/org/apache/pig/test/TestPigLineRecordReader.java
+++ b/test/org/apache/pig/test/TestPigLineRecordReader.java
@@ -614,4 +614,97 @@ public class TestPigLineRecordReader extends TestCase {
             fail(e.getMessage());
         }
     }
+    
+    /**
+     * This tests check if PigLineRecordReader can read a file which has an empty line
+     */
+    @Test
+    public void testEmptyLineSimpleFile() {
+        try {
+            File testFile = File.createTempFile("testPigLineRecordReader", ".txt");
+            String text = "This is a text";
+            
+            PrintStream ps = new PrintStream( testFile );
+            for( int i = 0; i < LOOP_COUNT; i++ ) {
+                ps.println( text );
+                // Add an empty line
+                ps.println("");
+            }
+            ps.close();
+            
+            LocalSeekableInputStream is = new LocalSeekableInputStream( testFile );
+            BufferedPositionedInputStream bpis = new BufferedPositionedInputStream( is );
+            PigLineRecordReader reader = new PigLineRecordReader( bpis, 0, Integer.MAX_VALUE );
+            
+            Text value = new Text();
+            int counter = 0;
+            while( reader.next(value) ) {
+                if( counter % 2 == 0 ) {
+                    assertTrue( "Invalid Text", value.toString().compareTo(text) == 0 );
+                } else {
+                    assertTrue( "Invalid Text", value.toString().compareTo("") == 0 );                    
+                }
+                counter++;
+            }
+            assertEquals("Invalid number of lines", counter, LOOP_COUNT*2 );
+            testFile.deleteOnExit();
+            
+        } catch (IOException e) {
+            e.printStackTrace();
+            fail( e.getMessage() );
+        } catch (SecurityException e) {
+            e.printStackTrace();
+            fail( e.getMessage() );
+        } catch (IllegalArgumentException e) {            
+            e.printStackTrace();
+            fail(e.getMessage());
+        }
+    }
+    
+    /**
+     * This tests check if PigLineRecordReader can read a file which has an empty line
+     */
+    @Test
+    public void testEmptyLineBZFile() {
+        try {
+            File testFile = File.createTempFile("testPigLineRecordReader", ".txt.bz2");
+            String text = "This is a text";
+
+            PrintStream ps = new PrintStream( new CBZip2OutputStream( new FileOutputStream( testFile )) );
+            for( int i = 0; i < LOOP_COUNT; i++ ) {
+                ps.println( text );
+                // Add an empty line
+                ps.println("");
+            }
+            ps.close();
+
+            LocalSeekableInputStream is = new LocalSeekableInputStream( testFile );
+            CBZip2InputStream bzis = new CBZip2InputStream( is );
+            BufferedPositionedInputStream bpis = new BufferedPositionedInputStream( bzis );
+            PigLineRecordReader reader = new PigLineRecordReader( bpis, 0, Integer.MAX_VALUE );
+
+            Text value = new Text();
+            int counter = 0;
+            while( reader.next(value) ) {
+                if( counter % 2 == 0 ) {
+                    assertTrue( "Invalid Text", value.toString().compareTo(text) == 0 );
+                } else {
+                    assertTrue( "Invalid Text", value.toString().compareTo("") == 0 );                    
+                }
+                counter++;
+            }
+            assertEquals("Invalid number of lines", counter, LOOP_COUNT*2 );
+            testFile.deleteOnExit();
+
+        } catch (IOException e) {
+            e.printStackTrace();
+            fail( e.getMessage() );
+        } catch (SecurityException e) {
+            e.printStackTrace();
+            fail( e.getMessage() );
+        } catch (IllegalArgumentException e) {            
+            e.printStackTrace();
+            fail(e.getMessage());
+        }
+    }
 }
