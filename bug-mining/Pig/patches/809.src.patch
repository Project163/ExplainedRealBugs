diff --git a/CHANGES.txt b/CHANGES.txt
index f95d7dbdb..331d5190c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -111,6 +111,8 @@ PIG-2011: Speed up TestTypedMap.java (dvryaboy)
 
 BUG FIXES
 
+PIG-2055: inconsistent behavior in parser generated during build (thejas)
+
 PIG-2185: NullPointerException while Accessing Empty Bag in FOREACH { FILTER } (daijy)
 
 PIG-2227: Wrong jars copied into lib directory in e2e tests when invoked from top level (gates)
diff --git a/build.xml b/build.xml
index c8026696d..29eb21a5f 100644
--- a/build.xml
+++ b/build.xml
@@ -564,7 +564,7 @@
             <zipfileset src="${ivy.lib.dir}/hadoop-core-${hadoop-core.version}.jar" />
             <zipfileset src="${lib.dir}/${automaton.jarfile}" />
             <zipfileset src="${ivy.lib.dir}/antlr-runtime-${antlr.version}.jar" />
-            <zipfileset src="${ivy.lib.dir}/stringtemplate-${antlr.version}.jar" />
+            <zipfileset src="${ivy.lib.dir}/ST4-${stringtemplate.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/junit-${junit.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/jsch-${jsch.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/jline-${jline.version}.jar" />
@@ -649,7 +649,7 @@
             </manifest>
             <zipfileset src="${lib.dir}/${automaton.jarfile}" />
             <zipfileset src="${ivy.lib.dir}/antlr-runtime-${antlr.version}.jar" />
-            <zipfileset src="${ivy.lib.dir}/stringtemplate-${antlr.version}.jar" />
+            <zipfileset src="${ivy.lib.dir}/ST4-${stringtemplate.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/junit-${junit.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/jsch-${jsch.version}.jar" />
             <zipfileset src="${ivy.lib.dir}/jline-${jline.version}.jar" />
diff --git a/ivy.xml b/ivy.xml
index 804a32bf6..8657808ed 100644
--- a/ivy.xml
+++ b/ivy.xml
@@ -98,6 +98,7 @@
     <dependency org="rhino" name="js" rev="${rhino.version}" conf="compile->master"/>
   	<dependency org="org.antlr" name="antlr" rev="${antlr.version}" conf="compile->master"/>
   	<dependency org="org.antlr" name="antlr-runtime" rev="${antlr.version}" conf="compile->default"/>
+	<dependency org="org.antlr" name="ST4" rev="${stringtemplate.version}" conf="compile->default"/>
     <dependency org="org.apache.zookeeper" name="zookeeper" rev="${zookeeper.version}" conf="compile->master"/>
     <dependency org="org.jboss.netty" name="netty" rev="3.2.2.Final" conf="compile->master"/>
 
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index 1a295f90e..dc12a3f59 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -15,7 +15,6 @@
 
 #These are the versions of our dependencies (in alphabetical order)
 apacheant.version=1.7.1
-antlr.version=2.7.6
 pig.version=0.9.0
 
 avro.version=1.5.1
@@ -43,7 +42,8 @@ json-simple.version=1.1
 junit.version=4.5
 jython.version=2.5.0
 rhino.version=1.7R2
-antlr.version=3.2
+antlr.version=3.4
+stringtemplate.version=4.0.4
 log4j.version=1.2.14
 netty.version=3.2.2
 rats-lib.version=0.5.1
diff --git a/ivy/pig.pom b/ivy/pig.pom
index 6019bc53e..8eee38fb1 100644
--- a/ivy/pig.pom
+++ b/ivy/pig.pom
@@ -121,12 +121,12 @@
     <dependency>
       <groupId>org.antlr</groupId>
       <artifactId>antlr-runtime</artifactId>
-      <version>3.2</version>
+      <version>3.4</version>
     </dependency>
     <dependency>
       <groupId>org.antlr</groupId>
-      <artifactId>stringtemplate</artifactId>
-      <version>3.2</version>
+      <artifactId>ST4</artifactId>
+      <version>4.0.4</version>
     </dependency>
    <dependency>
       <groupId>org.apache.hadoop</groupId>
diff --git a/src/org/apache/pig/parser/AstValidator.g b/src/org/apache/pig/parser/AstValidator.g
index 4b9474507..081013eaa 100644
--- a/src/org/apache/pig/parser/AstValidator.g
+++ b/src/org/apache/pig/parser/AstValidator.g
@@ -186,11 +186,11 @@ filename : QUOTEDSTRING
 as_clause: ^( AS field_def_list )
 ;
 
-field_def[Set<String> fieldNames] throws Exception
+field_def[Set<String> fieldNames] throws DuplicatedSchemaAliasException
  : ^( FIELD_DEF IDENTIFIER { validateSchemaAliasName( fieldNames, $IDENTIFIER, $IDENTIFIER.text ); } type? )
 ;
 
-field_def_list
+field_def_list throws DuplicatedSchemaAliasException
 scope{
     Set<String> fieldNames;
 }
diff --git a/src/org/apache/pig/parser/LogicalPlanBuilder.java b/src/org/apache/pig/parser/LogicalPlanBuilder.java
index d035fa7f1..3228c4e60 100644
--- a/src/org/apache/pig/parser/LogicalPlanBuilder.java
+++ b/src/org/apache/pig/parser/LogicalPlanBuilder.java
@@ -48,7 +48,6 @@ import org.apache.pig.impl.io.FileSpec;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.plan.NodeIdGenerator;
 import org.apache.pig.impl.plan.OperatorKey;
-import org.apache.pig.impl.plan.PlanValidationException;
 import org.apache.pig.impl.streaming.StreamingCommand;
 import org.apache.pig.impl.streaming.StreamingCommand.Handle;
 import org.apache.pig.impl.streaming.StreamingCommand.HandleSpec;
@@ -870,7 +869,7 @@ public class LogicalPlanBuilder {
      * @param endExpr the last expression to be projected, null 
      *        if everything to the end is to be projected
      * @return project expression
-     * @throws PlanValidationException 
+     * @throws ParserValidationException 
      */
     LogicalExpression buildRangeProjectExpr(SourceLocation loc, LogicalExpressionPlan plan, LogicalRelationalOperator relOp,
             int input, LogicalExpression startExpr, LogicalExpression endExpr)
diff --git a/src/org/apache/pig/parser/LogicalPlanGenerator.g b/src/org/apache/pig/parser/LogicalPlanGenerator.g
index 37e71ca24..24ba1cf77 100644
--- a/src/org/apache/pig/parser/LogicalPlanGenerator.g
+++ b/src/org/apache/pig/parser/LogicalPlanGenerator.g
@@ -47,6 +47,7 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.streaming.StreamingCommand;
 import org.apache.pig.impl.streaming.StreamingCommand.HandleSpec;
 import org.apache.pig.impl.util.MultiMap;
+import org.apache.pig.impl.plan.PlanValidationException;
 import org.apache.pig.newplan.Operator;
 import org.apache.pig.newplan.logical.expression.AddExpression;
 import org.apache.pig.newplan.logical.expression.AndExpression;
@@ -1373,7 +1374,7 @@ scope GScope;
    }
 ;
 
-split_otherwise throws PlanValidationException, PlanGenerationFailureException
+split_otherwise throws PlanGenerationFailureException
 scope GScope;
 @init {
     $GScope::currentOp = builder.createSplitOutputOp();
diff --git a/src/org/apache/pig/parser/PigRecognitionException.java b/src/org/apache/pig/parser/PigRecognitionException.java
index c6614e655..a4490b948 100644
--- a/src/org/apache/pig/parser/PigRecognitionException.java
+++ b/src/org/apache/pig/parser/PigRecognitionException.java
@@ -34,7 +34,7 @@ public abstract class PigRecognitionException extends RecognitionException {
     private SourceLocation location;
     
     public PigRecognitionException(IntStream input, SourceLocation loc) {
-        super( input );
+        super( );
         this.line = loc.line();
         this.charPositionInLine = loc.offset();
         this.location = loc;
