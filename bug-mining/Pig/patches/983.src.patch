diff --git a/CHANGES.txt b/CHANGES.txt
index 3a40fcaaa..3c32befcf 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -24,6 +24,8 @@ INCOMPATIBLE CHANGES
 
 IMPROVEMENTS
 
+PIG-2746: Pig doesn't detect all forms of compression extensions properly (qwertymaniac via daijy)
+
 PIG-2770: Allow easy inclusion of custom build targets (julien)
 
 PIG-2697: pretty print schema via pig.pretty.print.schema (rangadi via jcoveney)
diff --git a/src/org/apache/pig/builtin/PigStorage.java b/src/org/apache/pig/builtin/PigStorage.java
index 21e835f00..79df9d665 100644
--- a/src/org/apache/pig/builtin/PigStorage.java
+++ b/src/org/apache/pig/builtin/PigStorage.java
@@ -33,9 +33,8 @@ import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.io.Text;
-import org.apache.hadoop.io.compress.BZip2Codec;
 import org.apache.hadoop.io.compress.CompressionCodec;
-import org.apache.hadoop.io.compress.GzipCodec;
+import org.apache.hadoop.io.compress.CompressionCodecFactory;
 import org.apache.hadoop.mapreduce.InputFormat;
 import org.apache.hadoop.mapreduce.Job;
 import org.apache.hadoop.mapreduce.OutputFormat;
@@ -404,15 +403,13 @@ LoadPushDown, LoadMetadata, StoreMetadata {
     }
 
     private void setCompression(Path path, Job job) {
-     	String location=path.getName();
-        if (location.endsWith(".bz2") || location.endsWith(".bz")) {
-            FileOutputFormat.setCompressOutput(job, true);
-            FileOutputFormat.setOutputCompressorClass(job,  BZip2Codec.class);
-        }  else if (location.endsWith(".gz")) {
-            FileOutputFormat.setCompressOutput(job, true);
-            FileOutputFormat.setOutputCompressorClass(job, GzipCodec.class);
+        CompressionCodecFactory factory = new CompressionCodecFactory(job.getConfiguration());
+        CompressionCodec codec = factory.getCodec(path);
+        if (codec == null) {
+            FileOutputFormat.setCompressOutput(job, false);
         } else {
-            FileOutputFormat.setCompressOutput( job, false);
+            FileOutputFormat.setCompressOutput(job, true);
+            FileOutputFormat.setOutputCompressorClass(job, codec.getClass());
         }
     }
 
diff --git a/test/org/apache/pig/test/TestPigStorage.java b/test/org/apache/pig/test/TestPigStorage.java
index 4ec2f57a0..e02637c60 100644
--- a/test/org/apache/pig/test/TestPigStorage.java
+++ b/test/org/apache/pig/test/TestPigStorage.java
@@ -529,5 +529,28 @@ public class TestPigStorage  {
             String inputFileName = (String)tuple.get(0);
             assertEquals("tagsource value must be part-m-00000", inputFileName, storeFileName);
         }
-    }    
+    }
+
+    @Test
+    public void testPigStorageCompression() throws Exception {
+        final String storeFileName = "part-m-00000.bz2";
+        pigContext.connect();
+
+        String query = "a = LOAD '" + datadir + "' using PigStorage('\\t') " +
+        "as (f1:chararray, f2:int);";
+        pig.registerQuery(query);
+        // Storing in 'aout.bz2' directory will store contents in part-m-00000.bz2
+        // (With BZ2 compression applied automatically)
+        pig.store("a", datadir + "aout.bz2", "PigStorage('\\t', '-schema')");
+
+        // Verify input source tag is present when using -tagsource
+        pig.registerQuery("b = LOAD '" + datadir + "aout.bz2' using PigStorage('\\t', '-tagsource');");
+        pig.registerQuery("c = foreach b generate INPUT_FILE_NAME;");
+        Iterator<Tuple> iter = pig.openIterator("c");
+        while(iter.hasNext()) {
+            Tuple tuple = iter.next();
+            String inputFileName = (String)tuple.get(0);
+            assertEquals("tagsource value must be part-m-00000.bz2", inputFileName, storeFileName);
+        }
+    }
 }
