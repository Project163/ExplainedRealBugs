diff --git a/src/org/apache/pig/PigServer.java b/src/org/apache/pig/PigServer.java
index 3d50a3e77..4f7f433ff 100644
--- a/src/org/apache/pig/PigServer.java
+++ b/src/org/apache/pig/PigServer.java
@@ -104,7 +104,7 @@ import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStats.JobGraph;
 import org.apache.pig.tools.pigstats.ScriptState;
-import org.apache.pig.tools.pigstats.SimpleFetchPigStats;
+import org.apache.pig.tools.pigstats.EmptyPigStats;
 import org.apache.pig.validator.BlackAndWhitelistFilter;
 import org.apache.pig.validator.BlackAndWhitelistValidator;
 import org.apache.pig.validator.PigCommandFilter;
@@ -233,17 +233,17 @@ public class PigServer {
         if (connect) {
             pigContext.connect();
         }
-        
+
         this.filter = new BlackAndWhitelistFilter(this);
 
         addJarsFromProperties();
         markPredeployedJarsFromProperties();
 
-        if (PigStats.get() == null) {
-            PigStats.start(pigContext.getExecutionEngine().instantiatePigStats());
-        }
+        PigStats.start(pigContext.getExecutionEngine().instantiatePigStats());
 
         if (ScriptState.get() == null) {
+            // If Pig was started via command line, ScriptState should have been
+            // already initialized in Main. If so, we should not overwrite it.
             ScriptState.start(pigContext.getExecutionEngine().instantiateScriptState());
         }
     }
@@ -277,7 +277,7 @@ public class PigServer {
     private void markPredeployedJarsFromProperties() throws ExecException {
         // mark jars as predeployed from properties
         String jar_str = pigContext.getProperties().getProperty("pig.predeployed.jars");
-		
+
         if(jar_str != null){
             // Use File.pathSeparator (":" on Linux, ";" on Windows)
             // to correctly handle path aggregates as they are represented
@@ -426,7 +426,7 @@ public class PigServer {
      */
     protected List<ExecJob> getJobs(PigStats stats) {
         LinkedList<ExecJob> jobs = new LinkedList<ExecJob>();
-        if (stats instanceof SimpleFetchPigStats) {
+        if (stats instanceof EmptyPigStats) {
             HJob job = new HJob(HJob.JOB_STATUS.COMPLETED, pigContext, stats.result(null)
                     .getPOStore(), null);
             jobs.add(job);
@@ -1061,7 +1061,6 @@ public class PigServer {
      * @param suffix Suffix of file names 
      * @throws IOException if the requested alias cannot be found.
      */
-    @SuppressWarnings("unchecked")
     public void explain(String alias,
                         String format,
                         boolean verbose,
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/fetch/FetchLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/fetch/FetchLauncher.java
index d81f03b81..8ce31133d 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/fetch/FetchLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/fetch/FetchLauncher.java
@@ -41,7 +41,7 @@ import org.apache.pig.impl.plan.PlanException;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.pig.impl.util.UDFContext;
 import org.apache.pig.tools.pigstats.PigStats;
-import org.apache.pig.tools.pigstats.SimpleFetchPigStats;
+import org.apache.pig.tools.pigstats.EmptyPigStats;
 import org.joda.time.DateTimeZone;
 
 /**
@@ -78,7 +78,7 @@ public class FetchLauncher {
                 new DependencyOrderWalker<PhysicalOperator, PhysicalPlan>(pp));
         udfFinisher.visit();
 
-        return PigStats.start(new SimpleFetchPigStats(pigContext, poStore));
+        return PigStats.start(new EmptyPigStats(pigContext, poStore));
     }
 
     /**
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
index b483323a6..ef5a5a755 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MapReduceLauncher.java
@@ -168,6 +168,7 @@ public class MapReduceLauncher extends Launcher{
         MRScriptState.get().addWorkflowAdjacenciesToConf(mrp, conf);
 
         // start collecting statistics
+        PigStats.start(pc.getExecutionEngine().instantiatePigStats());
         MRPigStatsUtil.startCollection(pc, statsJobClient, jcc, mrp);
 
         // Find all the intermediate data stores. The plan will be destroyed during compile/execution
diff --git a/src/org/apache/pig/parser/QueryParserDriver.java b/src/org/apache/pig/parser/QueryParserDriver.java
index ec5b2b9a7..7a8842171 100644
--- a/src/org/apache/pig/parser/QueryParserDriver.java
+++ b/src/org/apache/pig/parser/QueryParserDriver.java
@@ -491,7 +491,7 @@ public class QueryParserDriver {
 
         // sometimes the script has no filename, like when a string is passed to PigServer for
         // example. See PIG-2866.
-        if (fname != null) {
+        if (!fname.isEmpty()) {
             FetchFileRet localFileRet = getMacroFile(fname);
             fname = localFileRet.file.getAbsolutePath();
         }
@@ -594,7 +594,7 @@ public class QueryParserDriver {
             ScriptState ss = ScriptState.get();
             if (ss != null) file = ss.getFileName();
         }
-        if (file != null && !file.equals(importFile)) {
+        if (!file.isEmpty() && !file.equals(importFile)) {
             sb.append("at ").append(file).append(", ");
         }
         sb.append("line ").append(t.getLine()).append("> ").append(header);
diff --git a/src/org/apache/pig/parser/SourceLocation.java b/src/org/apache/pig/parser/SourceLocation.java
index b69546f8a..f8ebdaf23 100644
--- a/src/org/apache/pig/parser/SourceLocation.java
+++ b/src/org/apache/pig/parser/SourceLocation.java
@@ -83,7 +83,7 @@ public class SourceLocation {
             sb.append("\n");
         }
         sb.append( "<" );
-        if( file != null )
+        if( file != null && !file.isEmpty() )
             sb.append( "file " + file + ", " );
         sb.append( "line " + line +", column " + offset + "> " );
         
diff --git a/src/org/apache/pig/tools/pigstats/SimpleFetchPigStats.java b/src/org/apache/pig/tools/pigstats/EmptyPigStats.java
similarity index 87%
rename from src/org/apache/pig/tools/pigstats/SimpleFetchPigStats.java
rename to src/org/apache/pig/tools/pigstats/EmptyPigStats.java
index 61dbe3cf3..815197814 100644
--- a/src/org/apache/pig/tools/pigstats/SimpleFetchPigStats.java
+++ b/src/org/apache/pig/tools/pigstats/EmptyPigStats.java
@@ -29,25 +29,33 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.impl.PigContext;
 
 /**
- * SimpleFetchPigStats encapsulates dummy statistics of a fetch task, since during a fetch
- * no MR jobs are executed
+ * EmptyPigStats encapsulates dummy statistics of a fetch task, since during a
+ * fetch no MR jobs are executed
  *
  */
-public class SimpleFetchPigStats extends PigStats {
+public class EmptyPigStats extends PigStats {
 
     private final List<OutputStats> outputStatsList;
     private final List<InputStats> inputStatsList;
     private final JobGraph emptyJobPlan = new JobGraph();
 
-    public SimpleFetchPigStats(PigContext pigContext, POStore poStore) {
+    public EmptyPigStats() {
+        // initialize empty stats
+        OutputStats os = new OutputStats(null, -1, -1, true);
+        this.outputStatsList = Collections.unmodifiableList(Arrays.asList(os));
 
+        InputStats is = new InputStats(null, -1, -1, true);
+        this.inputStatsList = Collections.unmodifiableList(Arrays.asList(is));
+    }
+
+    public EmptyPigStats(PigContext pigContext, POStore poStore) {
         super.pigContext = pigContext;
         super.startTime = super.endTime = System.currentTimeMillis();
         super.userId = System.getProperty("user.name");
 
         Configuration conf = ConfigurationUtil.toConfiguration(pigContext.getProperties());
 
-        //initalize empty stats
+        // initialize empty stats
         OutputStats os = new OutputStats(null, -1, -1, true);
         os.setConf(conf);
         os.setPOStore(poStore);
@@ -56,7 +64,6 @@ public class SimpleFetchPigStats extends PigStats {
         InputStats is = new InputStats(null, -1, -1, true);
         is.setConf(conf);
         this.inputStatsList = Collections.unmodifiableList(Arrays.asList(is));
-
     }
 
     @Override
diff --git a/src/org/apache/pig/tools/pigstats/InputStats.java b/src/org/apache/pig/tools/pigstats/InputStats.java
index 38c8372b8..9764c5acb 100644
--- a/src/org/apache/pig/tools/pigstats/InputStats.java
+++ b/src/org/apache/pig/tools/pigstats/InputStats.java
@@ -36,22 +36,22 @@ public final class InputStats {
     private long records;
 
     private boolean success;
-    
+
     public static enum INPUT_TYPE { regular, sampler, indexer, side };
- 
+
     private INPUT_TYPE type = INPUT_TYPE.regular;
-    
+
     private Configuration conf;
 
     public InputStats(String location, long bytes, long records, boolean success) {
         this.location = location;
         this.bytes = bytes;
-        this.records = records;        
+        this.records = records;
         this.success = success;
         try {
             this.name = new Path(location).getName();
         } catch (Exception e) {
-            // location is a mal formatted URL 
+            // location is a mal formatted URL
             this.name = location;
         }
     }
@@ -79,14 +79,14 @@ public final class InputStats {
     public Configuration getConf() {
         return conf;
     }
-    
+
     public INPUT_TYPE getInputType() {
         return type;
     }
-    
+
     public String getDisplayString(boolean local) {
         StringBuilder sb = new StringBuilder();
-        if (success) {            
+        if (success) {
             sb.append("Successfully ");
             if (type == INPUT_TYPE.sampler) {
                 sb.append("sampled ");
@@ -95,7 +95,7 @@ public final class InputStats {
             } else {
                 sb.append("read ");
             }
-            
+
             if (!local && records >= 0) {
                 sb.append(records).append(" records ");
             } else {
@@ -115,19 +115,19 @@ public final class InputStats {
         }
         return sb.toString();
     }
-    
+
     public void setConf(Configuration conf) {
         this.conf = conf;
     }
-    
+
     public void markSampleInput() {
         type = INPUT_TYPE.sampler;
     }
-    
+
     public void markIndexerInput() {
         type = INPUT_TYPE.indexer;
     }
-    
+
     public void markSideFileInput() {
         type = INPUT_TYPE.side;
     }
diff --git a/src/org/apache/pig/tools/pigstats/JobStats.java b/src/org/apache/pig/tools/pigstats/JobStats.java
index 4484348a1..357c8240b 100644
--- a/src/org/apache/pig/tools/pigstats/JobStats.java
+++ b/src/org/apache/pig/tools/pigstats/JobStats.java
@@ -24,8 +24,6 @@ import java.util.Collections;
 import java.util.List;
 import java.util.Map;
 
-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.mapred.Counters;
 import org.apache.pig.classification.InterfaceAudience;
@@ -47,7 +45,6 @@ public abstract class JobStats extends Operator {
     public static final String ALIAS_LOCATION = "JobStatistics:alias_location";
     public static final String FEATURE = "JobStatistics:feature";
 
-    private static final Log LOG = LogFactory.getLog(JobStats.class);
     public static final String SUCCESS_HEADER = null;
     public static final String FAILURE_HEADER = null;
 
@@ -61,6 +58,9 @@ public abstract class JobStats extends Operator {
 
     protected Configuration conf;
 
+    protected long hdfsBytesRead = 0;
+    protected long hdfsBytesWritten = 0;
+
     private String errorMsg;
 
     private Exception exception = null;
@@ -112,6 +112,14 @@ public abstract class JobStats extends Operator {
         return (String)getAnnotation(FEATURE);
     }
 
+    public long getHdfsBytesRead() {
+        return hdfsBytesRead;
+    }
+
+    public long getHdfsBytesWritten() {
+        return hdfsBytesWritten;
+    }
+
     /**
      * Returns the total bytes written to user specified HDFS
      * locations of this job.
@@ -241,7 +249,7 @@ public abstract class JobStats extends Operator {
      * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getAvgREduceTime} instead.
      */
     @Deprecated
-    abstract public long getAvgREduceTime();
+    abstract public long getAvgReduceTime();
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
@@ -259,17 +267,17 @@ public abstract class JobStats extends Operator {
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
-     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getReduceOutputRecords} instead.
+     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getReduceInputRecords} instead.
      */
     @Deprecated
-    abstract public long getReduceOutputRecords();
+    abstract public long getReduceInputRecords();
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
-     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getReduceInputRecords} instead.
+     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getReduceOutputRecords} instead.
      */
     @Deprecated
-    abstract public long getReduceInputRecords();
+    abstract public long getReduceOutputRecords();
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
@@ -294,23 +302,23 @@ public abstract class JobStats extends Operator {
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
-     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getHdfsBytesWritten} instead.
+     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getHadoopCounters} instead.
      */
     @Deprecated
-    abstract public long getHdfsBytesWritten();
+    abstract public Counters getHadoopCounters();
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
-     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getHadoopCounters} instead.
+     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getMultiStoreCounters} instead.
      */
     @Deprecated
-    abstract public Counters getHadoopCounters();
+    abstract public Map<String, Long> getMultiStoreCounters();
 
     /**
      * @deprecated If you are using mapreduce, please cast JobStats to org.apache.pig.tools.pigstats.mapreduce.MRJobStats,
-     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getMultiStoreCounters} instead.
+     * then use {@link org.apache.pig.tools.pigstats.mapreduce.MRJobStats#getMultiInputCounters} instead.
      */
     @Deprecated
-    abstract public Map<String, Long> getMultiStoreCounters();
+    abstract public Map<String, Long> getMultiInputCounters();
 
 }
diff --git a/src/org/apache/pig/tools/pigstats/OutputStats.java b/src/org/apache/pig/tools/pigstats/OutputStats.java
index 6a3e3ebb8..dd8ff6cc7 100644
--- a/src/org/apache/pig/tools/pigstats/OutputStats.java
+++ b/src/org/apache/pig/tools/pigstats/OutputStats.java
@@ -35,7 +35,6 @@ import org.apache.pig.classification.InterfaceStability;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.ReadToEndLoader;
-import org.apache.pig.newplan.Operator;
 
 /**
  * This class encapsulates the runtime statistics of an user specified output.
diff --git a/src/org/apache/pig/tools/pigstats/PigStats.java b/src/org/apache/pig/tools/pigstats/PigStats.java
index 303272863..5c9b88c41 100644
--- a/src/org/apache/pig/tools/pigstats/PigStats.java
+++ b/src/org/apache/pig/tools/pigstats/PigStats.java
@@ -268,6 +268,10 @@ public abstract class PigStats {
         return ScriptState.get().getId();
     }
 
+    public String getFileName() {
+        return ScriptState.get().getFileName();
+    }
+
     public String getFeatures() {
         return ScriptState.get().getScriptFeatures();
     }
diff --git a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
index e690b8dd1..7e0464530 100644
--- a/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
+++ b/src/org/apache/pig/tools/pigstats/PigStatsUtil.java
@@ -32,89 +32,60 @@ import org.apache.pig.tools.pigstats.mapreduce.SimplePigStats;
  */
 public class PigStatsUtil {
 
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_STORE_RECORD_COUNTER} instead.
-     */
-    @Deprecated
-    public static final String MULTI_STORE_RECORD_COUNTER
-            = "Output records in ";
-
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_STORE_COUNTER_GROUP} instead.
-     */
-    @Deprecated
-    public static final String MULTI_STORE_COUNTER_GROUP
-            = "MultiStoreCounters";
-
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#TASK_COUNTER_GROUP} instead.
-     */
-    @Deprecated
-    public static final String TASK_COUNTER_GROUP
-            = "org.apache.hadoop.mapred.Task$Counter";
-
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#FS_COUNTER_GROUP} instead.
-     */
-    @Deprecated
-    public static final String FS_COUNTER_GROUP
-            = HadoopShims.getFsCounterGroupName();
-
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MAP_INPUT_RECORDS} instead.
-     */
-    @Deprecated
     public static final String MAP_INPUT_RECORDS
             = "MAP_INPUT_RECORDS";
-
-    /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MAP_OUTPUT_RECORDS} instead.
-     */
-    @Deprecated
     public static final String MAP_OUTPUT_RECORDS
             = "MAP_OUTPUT_RECORDS";
+    public static final String REDUCE_INPUT_RECORDS
+            = "REDUCE_INPUT_RECORDS";
+    public static final String REDUCE_OUTPUT_RECORDS
+            = "REDUCE_OUTPUT_RECORDS";
+    public static final String HDFS_BYTES_WRITTEN
+            = "HDFS_BYTES_WRITTEN";
+    public static final String HDFS_BYTES_READ
+            = "HDFS_BYTES_READ";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#REDUCE_INPUT_RECORDS} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_INPUT_RECORD_COUNTER} instead.
      */
     @Deprecated
-    public static final String REDUCE_INPUT_RECORDS
-            = "REDUCE_INPUT_RECORDS";
+    public static final String MULTI_INPUTS_RECORD_COUNTER
+            = "Input records from ";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#REDUCE_OUTPUT_RECORDS} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_INPUT_COUNTER_GROUP} instead.
      */
     @Deprecated
-    public static final String REDUCE_OUTPUT_RECORDS
-            = "REDUCE_OUTPUT_RECORDS";
+    public static final String MULTI_INPUTS_COUNTER_GROUP
+            = "MultiInputCounters";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#HDFS_BYTES_WRITTEN} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_STORE_RECORD_COUNTER} instead.
      */
     @Deprecated
-    public static final String HDFS_BYTES_WRITTEN
-            = "HDFS_BYTES_WRITTEN";
+    public static final String MULTI_STORE_RECORD_COUNTER
+            = "Output records in ";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#HDFS_BYTES_READ} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_STORE_COUNTER_GROUP} instead.
      */
     @Deprecated
-    public static final String HDFS_BYTES_READ
-            = "HDFS_BYTES_READ";
+    public static final String MULTI_STORE_COUNTER_GROUP
+            = "MultiStoreCounters";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_INPUTS_RECORD_COUNTER} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#TASK_COUNTER_GROUP} instead.
      */
     @Deprecated
-    public static final String MULTI_INPUTS_RECORD_COUNTER
-            = "Input records from ";
+    public static final String TASK_COUNTER_GROUP
+            = "org.apache.hadoop.mapred.Task$Counter";
 
     /**
-     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#MULTI_INPUTS_COUNTER_GROUP} instead.
+     * @deprecated use {@link org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil#FS_COUNTER_GROUP} instead.
      */
     @Deprecated
-    public static final String MULTI_INPUTS_COUNTER_GROUP
-            = "MultiInputCounters";
+    public static final String FS_COUNTER_GROUP
+            = HadoopShims.getFsCounterGroupName();
 
     /**
      * Returns an empty PigStats object Use of this method is not advised as it
@@ -136,30 +107,35 @@ public class PigStatsUtil {
      */
     public static PigStats getPigStats(int code) {
         PigStats ps = PigStats.get();
+        if (ps == null) {
+            ps = PigStats.start(new EmptyPigStats());
+        }
         ps.setReturnCode(code);
         return ps;
     }
 
-
     public static void setErrorMessage(String msg) {
         PigStats ps = PigStats.get();
-        if (ps != null) {
-            ps.setErrorMessage(msg);
+        if (ps == null) {
+            ps = PigStats.start(new EmptyPigStats());
         }
+        ps.setErrorMessage(msg);
     }
 
     public static void setErrorCode(int code) {
         PigStats ps = PigStats.get();
-        if (ps != null) {
-            ps.setErrorCode(code);
+        if (ps == null) {
+            ps = PigStats.start(new EmptyPigStats());
         }
+        ps.setErrorCode(code);
     }
 
     public static void setErrorThrowable(Throwable t) {
         PigStats ps = PigStats.get();
-        if (ps != null) {
-            ps.setErrorThrowable(t);
+        if (ps == null) {
+            ps = PigStats.start(new EmptyPigStats());
         }
+        ps.setErrorThrowable(t);
     }
 
     private static Pattern pattern = Pattern.compile("tmp(-)?[\\d]{1,10}$");
@@ -173,6 +149,4 @@ public class PigStatsUtil {
         PigStats.start(new EmbeddedPigStats(statsMap));
     }
 
-
 }
-
diff --git a/src/org/apache/pig/tools/pigstats/ScriptState.java b/src/org/apache/pig/tools/pigstats/ScriptState.java
index d58310d59..0ceb9d2db 100644
--- a/src/org/apache/pig/tools/pigstats/ScriptState.java
+++ b/src/org/apache/pig/tools/pigstats/ScriptState.java
@@ -252,7 +252,7 @@ public abstract class ScriptState {
     }
 
     public String getFileName() {
-        return fileName;
+        return (fileName == null) ? "" : fileName;
     }
 
     public void setFileName(String fileName) {
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
index 115ae1d62..3cc7a3707 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRJobStats.java
@@ -88,7 +88,6 @@ public final class MRJobStats extends JobStats {
 
     private Boolean disableCounter = false;
 
-    @SuppressWarnings("deprecation")
     private JobID jobId;
 
     private long maxMapTime = 0;
@@ -107,8 +106,6 @@ public final class MRJobStats extends JobStats {
     private long mapOutputRecords = 0;
     private long reduceInputRecords = 0;
     private long reduceOutputRecords = 0;
-    private long hdfsBytesWritten = 0;
-    private long hdfsBytesRead = 0;
     private long spillCount = 0;
     private long activeSpillCountObj = 0;
     private long activeSpillCountRecs = 0;
@@ -119,10 +116,8 @@ public final class MRJobStats extends JobStats {
     private HashMap<String, Long> multiInputCounters
             = new HashMap<String, Long>();
 
-    @SuppressWarnings("deprecation")
     private Counters counters = null;
 
-
     public String getJobId() {
         return (jobId == null) ? null : jobId.toString();
     }
@@ -141,32 +136,32 @@ public final class MRJobStats extends JobStats {
 
     public long getMinReduceTime() { return minReduceTime; }
 
-    public long getAvgREduceTime() { return avgReduceTime; }
+    public long getAvgReduceTime() { return avgReduceTime; }
 
     public long getMapInputRecords() { return mapInputRecords; }
 
     public long getMapOutputRecords() { return mapOutputRecords; }
 
-    public long getReduceOutputRecords() { return reduceOutputRecords; }
-
     public long getReduceInputRecords() { return reduceInputRecords; }
 
+    public long getReduceOutputRecords() { return reduceOutputRecords; }
+
     public long getSMMSpillCount() { return spillCount; }
 
     public long getProactiveSpillCountObjects() { return activeSpillCountObj; }
 
     public long getProactiveSpillCountRecs() { return activeSpillCountRecs; }
 
-    public long getHdfsBytesWritten() { return hdfsBytesWritten; }
-
-    @SuppressWarnings("deprecation")
     public Counters getHadoopCounters() { return counters; }
 
-
     public Map<String, Long> getMultiStoreCounters() {
         return Collections.unmodifiableMap(multiStoreCounters);
     }
 
+    public Map<String, Long> getMultiInputCounters() {
+        return Collections.unmodifiableMap(multiInputCounters);
+    }
+
     public String getAlias() {
         return (String)getAnnotation(ALIAS);
     }
@@ -187,7 +182,6 @@ public final class MRJobStats extends JobStats {
         }
     }
 
-    @SuppressWarnings("deprecation")
     void setId(JobID jobId) {
         this.jobId = jobId;
     }
@@ -265,7 +259,6 @@ public final class MRJobStats extends JobStats {
         return sb.toString();
     }
 
-    @SuppressWarnings("deprecation")
     void addCounters(RunningJob rjob) {
         if (rjob != null) {
             try {
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
index ed791fd0f..74084ef95 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRPigStatsUtil.java
@@ -90,7 +90,6 @@ public class MRPigStatsUtil extends PigStatsUtil {
      * @param counterName the counter name
      * @return the count of the given counter name
      */
-    @SuppressWarnings("deprecation")
     public static long getMultiStoreCount(Job job, JobClient jobClient,
             String counterName) {
         long value = -1;
@@ -166,7 +165,7 @@ public class MRPigStatsUtil extends PigStatsUtil {
      */
     public static void startCollection(PigContext pc, JobClient client,
             JobControlCompiler jcc, MROperPlan plan) {
-        SimplePigStats ps = (SimplePigStats)PigStats.start(new SimplePigStats());
+        SimplePigStats ps = (SimplePigStats)PigStats.get();
         ps.initialize(pc, client, jcc, plan);
 
         MRScriptState.get().emitInitialPlanNotification(plan);
diff --git a/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java b/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
index 4669c4bcc..f43263506 100644
--- a/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
+++ b/src/org/apache/pig/tools/pigstats/mapreduce/MRScriptState.java
@@ -211,7 +211,7 @@ public class MRScriptState extends ScriptState {
         setJobParents(mro, conf);
 
         conf.set("mapreduce.workflow.id", "pig_" + id);
-        conf.set("mapreduce.workflow.name", (getFileName() != null) ? getFileName() : "default");
+        conf.set("mapreduce.workflow.name", getFileName().isEmpty() ? "default" : getFileName());
         conf.set("mapreduce.workflow.node.name", mro.getOperatorKey().toString());
     }
 
diff --git a/test/org/apache/pig/test/TestPigRunner.java b/test/org/apache/pig/test/TestPigRunner.java
index 6964c387c..ae81b0eb3 100644
--- a/test/org/apache/pig/test/TestPigRunner.java
+++ b/test/org/apache/pig/test/TestPigRunner.java
@@ -51,7 +51,7 @@ import org.apache.pig.tools.pigstats.OutputStats;
 import org.apache.pig.tools.pigstats.PigProgressNotificationListener;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStatsUtil;
-import org.apache.pig.tools.pigstats.SimpleFetchPigStats;
+import org.apache.pig.tools.pigstats.EmptyPigStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRJobStats;
 import org.apache.pig.tools.pigstats.mapreduce.MRPigStatsUtil;
 import org.junit.AfterClass;
@@ -192,7 +192,7 @@ public class TestPigRunner {
             String[] args = { "-Dstop.on.failure=true", "-Dopt.multiquery=false", "-Daggregate.warning=false", PIG_FILE };
             PigStats stats = PigRunner.run(args, new TestNotificationListener());
 
-            assertTrue(stats instanceof SimpleFetchPigStats);
+            assertTrue(stats instanceof EmptyPigStats);
             assertTrue(stats.isSuccessful());
             assertEquals(0, stats.getNumberJobs());
             assertEquals(stats.getJobGraph().size(), 0);
