diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index 8b9044416..43a000c36 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -1026,19 +1026,15 @@ public class TestEvalPipelineLocal {
     
     @Test
     public void testExplainInDotGraph() throws Exception{
-        pigServer.registerQuery("a = load 'student' using " + PigStorage.class.getName() + "(':') as (name, age, gpa);");
-        pigServer.registerQuery("b = load 'voter' using " + PigStorage.class.getName() + "(',') as (name, age, registration, contributions);");
-        pigServer.registerQuery("c = filter a by age < 50;");
-        pigServer.registerQuery("d = filter b by age < 50;");
-        pigServer.registerQuery("e = cogroup c by (name, age), d by (name, age);");
-        pigServer.registerQuery("f = foreach e generate flatten(c), flatten(d);");
-        pigServer.registerQuery("g = group f by registration;");
-        pigServer.registerQuery("h = foreach g generate (chararray)group, SUM(f.d::contributions);");
-        pigServer.registerQuery("i = order h by $1;");
+        pigServer.registerQuery("a = load 'voter' using " + PigStorage.class.getName() + "(',') as (name, age, registration, contributions);");
+        pigServer.registerQuery("b = filter a by age < 50;");
+        pigServer.registerQuery("c = group b by registration;");
+        pigServer.registerQuery("d = foreach c generate (chararray)group, SUM(b.contributions);");
+        pigServer.registerQuery("e = order d by $1;");
         
         File tmpFile = File.createTempFile("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
-        pigServer.explain("i", "dot", true, true, ps, System.out, System.out);
+        pigServer.explain("e", "dot", true, true, ps, System.out, System.out);
         ps.close();
         
         FileInputStream fis1 = new FileInputStream("test/org/apache/pig/test/data/DotFiles/explain1.dot");
diff --git a/test/org/apache/pig/test/data/DotFiles/explain1.dot b/test/org/apache/pig/test/data/DotFiles/explain1.dot
index 3187c0192..44d539376 100644
--- a/test/org/apache/pig/test/data/DotFiles/explain1.dot
+++ b/test/org/apache/pig/test/data/DotFiles/explain1.dot
@@ -4,208 +4,111 @@
 digraph plan {
 compound=true;
 node [shape=rect];
-s20945327_in [label="", style=invis, height=0, width=0];
-s20945327_out [label="", style=invis, height=0, width=0];
-subgraph cluster_20945327 {
+s26567569_in [label="", style=invis, height=0, width=0];
+s26567569_out [label="", style=invis, height=0, width=0];
+subgraph cluster_26567569 {
 label="LOSort"labelloc=b;
-8569405 [label="Project0:1"];
-s20945327_in -> 8569405 [style=invis];
+12318634 [label="Project0:1"];
+s26567569_in -> 12318634 [style=invis];
 };
-8569405 -> s20945327_out [style=invis];
-s22487327_in [label="", style=invis, height=0, width=0];
-s22487327_out [label="", style=invis, height=0, width=0];
-subgraph cluster_22487327 {
+12318634 -> s26567569_out [style=invis];
+s7897563_in [label="", style=invis, height=0, width=0];
+s7897563_out [label="", style=invis, height=0, width=0];
+subgraph cluster_7897563 {
 label="LOForEach"labelloc=b;
-24869286 [label="LOInnerLoad"];
-24086580 [label="LOInnerLoad"];
-s8819824_in [label="", style=invis, height=0, width=0];
-s8819824_out [label="", style=invis, height=0, width=0];
-subgraph cluster_8819824 {
+10714218 [label="LOInnerLoad"];
+20783574 [label="LOInnerLoad"];
+s30276889_in [label="", style=invis, height=0, width=0];
+s30276889_out [label="", style=invis, height=0, width=0];
+subgraph cluster_30276889 {
 label="LOGenerate"labelloc=b;
-25512760 [label="Project0:(*)"];
-885172 [label="Cast"];
-25512760 -> 885172
-s8819824_in -> 25512760 [style=invis];
-12482151 [label="Project1:(*)"];
-5210968 [label="Dereference"];
-3687978 [label="UserFunc"];
-12482151 -> 5210968
-5210968 -> 3687978
-s8819824_in -> 12482151 [style=invis];
-};
-885172 -> s8819824_out [style=invis];
-3687978 -> s8819824_out [style=invis];
-24869286 -> s8819824_in [lhead=cluster_8819824]
-24086580 -> s8819824_in [lhead=cluster_8819824]
-s22487327_in -> 24869286 [style=invis];
-s22487327_in -> 24086580 [style=invis];
-};
-s8819824_out -> s22487327_out [style=invis];
-s18259890_out [label="", style=invis, height=0, width=0];
-subgraph cluster_18259890 {
+12984448 [label="Project0:(*)"];
+25150543 [label="Cast"];
+12984448 -> 25150543
+s30276889_in -> 12984448 [style=invis];
+20002533 [label="Project1:(*)"];
+732260 [label="Dereference"];
+26179329 [label="UserFunc"];
+20002533 -> 732260
+732260 -> 26179329
+s30276889_in -> 20002533 [style=invis];
+};
+25150543 -> s30276889_out [style=invis];
+26179329 -> s30276889_out [style=invis];
+10714218 -> s30276889_in [lhead=cluster_30276889]
+20783574 -> s30276889_in [lhead=cluster_30276889]
+s7897563_in -> 10714218 [style=invis];
+s7897563_in -> 20783574 [style=invis];
+};
+s30276889_out -> s7897563_out [style=invis];
+s18554240_out [label="", style=invis, height=0, width=0];
+subgraph cluster_18554240 {
 label="LOCogroup"labelloc=b;
-subgraph cluster_18259890_4750048 {
+subgraph cluster_18554240_26867942 {
 label="";
-s18259890_4750048_in [label="", style=invis, height=0, width=0];
-5148380 [label="Project0:5"];
-s18259890_4750048_in -> 5148380 [style=invis];
-};
-};
-5148380 -> s18259890_out [style=invis];
-s4750048_in [label="", style=invis, height=0, width=0];
-s4750048_out [label="", style=invis, height=0, width=0];
-subgraph cluster_4750048 {
-label="LOForEach"labelloc=b;
-2915013 [label="LOInnerLoad"];
-3160672 [label="LOInnerLoad"];
-s23258883_in [label="", style=invis, height=0, width=0];
-s23258883_out [label="", style=invis, height=0, width=0];
-subgraph cluster_23258883 {
-label="LOGenerate"labelloc=b;
-8069610 [label="Project0:(*)"];
-s23258883_in -> 8069610 [style=invis];
-32482448 [label="Project1:(*)"];
-s23258883_in -> 32482448 [style=invis];
+s18554240_26867942_in [label="", style=invis, height=0, width=0];
+19783652 [label="Project0:2"];
+s18554240_26867942_in -> 19783652 [style=invis];
 };
-8069610 -> s23258883_out [style=invis];
-32482448 -> s23258883_out [style=invis];
-2915013 -> s23258883_in [lhead=cluster_23258883]
-3160672 -> s23258883_in [lhead=cluster_23258883]
-s4750048_in -> 2915013 [style=invis];
-s4750048_in -> 3160672 [style=invis];
-};
-s23258883_out -> s4750048_out [style=invis];
-s8814509_out [label="", style=invis, height=0, width=0];
-subgraph cluster_8814509 {
-label="LOCogroup"labelloc=b;
-subgraph cluster_8814509_1726320 {
-label="";
-s8814509_1726320_in [label="", style=invis, height=0, width=0];
-2645268 [label="Project0:0"];
-s8814509_1726320_in -> 2645268 [style=invis];
-32960257 [label="Project0:1"];
-s8814509_1726320_in -> 32960257 [style=invis];
-};
-subgraph cluster_8814509_4359463 {
-label="";
-s8814509_4359463_in [label="", style=invis, height=0, width=0];
-12928596 [label="Project1:0"];
-s8814509_4359463_in -> 12928596 [style=invis];
-25979266 [label="Project1:1"];
-s8814509_4359463_in -> 25979266 [style=invis];
 };
-};
-2645268 -> s8814509_out [style=invis];
-32960257 -> s8814509_out [style=invis];
-12928596 -> s8814509_out [style=invis];
-25979266 -> s8814509_out [style=invis];
-s22811631_in [label="", style=invis, height=0, width=0];
-s22811631_out [label="", style=invis, height=0, width=0];
-subgraph cluster_22811631 {
-label="LOFilter"labelloc=b;
-17796836 [label="Project0:1"];
-28488784 [label="Constant"];
-7224872 [label="LessThan"];
-20319379 [label="Cast"];
-20319379 -> 7224872
-28488784 -> 7224872
-17796836 -> 20319379
-s22811631_in -> 17796836 [style=invis];
-s22811631_in -> 28488784 [style=invis];
-};
-7224872 -> s22811631_out [style=invis];
-s4968819_in [label="", style=invis, height=0, width=0];
-s4968819_out [label="", style=invis, height=0, width=0];
-subgraph cluster_4968819 {
+19783652 -> s18554240_out [style=invis];
+s5875509_in [label="", style=invis, height=0, width=0];
+s5875509_out [label="", style=invis, height=0, width=0];
+subgraph cluster_5875509 {
 label="LOFilter"labelloc=b;
-24814248 [label="Project0:1"];
-1491648 [label="Constant"];
-5039143 [label="LessThan"];
-24356426 [label="Cast"];
-24356426 -> 5039143
-1491648 -> 5039143
-24814248 -> 24356426
-s4968819_in -> 24814248 [style=invis];
-s4968819_in -> 1491648 [style=invis];
-};
-5039143 -> s4968819_out [style=invis];
-2153655 [label="LOLoad", style="filled", fillcolor="gray"];
-27519670 [label="LOLoad", style="filled", fillcolor="gray"];
-16412781 [label="LOStore", style="filled", fillcolor="gray"];
-s1726320_in [label="", style=invis, height=0, width=0];
-s1726320_out [label="", style=invis, height=0, width=0];
-subgraph cluster_1726320 {
-label="LOForEach"labelloc=b;
-s23235469_in [label="", style=invis, height=0, width=0];
-s23235469_out [label="", style=invis, height=0, width=0];
-subgraph cluster_23235469 {
-label="LOGenerate"labelloc=b;
-8172621 [label="Project0:(*)"];
-s23235469_in -> 8172621 [style=invis];
-18957862 [label="Project1:(*)"];
-s23235469_in -> 18957862 [style=invis];
-25468335 [label="Project2:(*)"];
-s23235469_in -> 25468335 [style=invis];
-};
-8172621 -> s23235469_out [style=invis];
-18957862 -> s23235469_out [style=invis];
-25468335 -> s23235469_out [style=invis];
-12062492 [label="LOInnerLoad"];
-31985466 [label="LOInnerLoad"];
-4179068 [label="LOInnerLoad"];
-12062492 -> s23235469_in [lhead=cluster_23235469]
-31985466 -> s23235469_in [lhead=cluster_23235469]
-4179068 -> s23235469_in [lhead=cluster_23235469]
-s1726320_in -> 12062492 [style=invis];
-s1726320_in -> 31985466 [style=invis];
-s1726320_in -> 4179068 [style=invis];
-};
-s23235469_out -> s1726320_out [style=invis];
-s4359463_in [label="", style=invis, height=0, width=0];
-s4359463_out [label="", style=invis, height=0, width=0];
-subgraph cluster_4359463 {
+27967613 [label="Project0:1"];
+253899 [label="Constant"];
+21192393 [label="LessThan"];
+7713774 [label="Cast"];
+7713774 -> 21192393
+253899 -> 21192393
+27967613 -> 7713774
+s5875509_in -> 27967613 [style=invis];
+s5875509_in -> 253899 [style=invis];
+};
+21192393 -> s5875509_out [style=invis];
+32545329 [label="LOLoad", style="filled", fillcolor="gray"];
+17330894 [label="LOStore", style="filled", fillcolor="gray"];
+s26867942_in [label="", style=invis, height=0, width=0];
+s26867942_out [label="", style=invis, height=0, width=0];
+subgraph cluster_26867942 {
 label="LOForEach"labelloc=b;
-s20182749_in [label="", style=invis, height=0, width=0];
-s20182749_out [label="", style=invis, height=0, width=0];
-subgraph cluster_20182749 {
+s27525999_in [label="", style=invis, height=0, width=0];
+s27525999_out [label="", style=invis, height=0, width=0];
+subgraph cluster_27525999 {
 label="LOGenerate"labelloc=b;
-3745812 [label="Project0:(*)"];
-s20182749_in -> 3745812 [style=invis];
-7762850 [label="Project1:(*)"];
-s20182749_in -> 7762850 [style=invis];
-10589182 [label="Project2:(*)"];
-s20182749_in -> 10589182 [style=invis];
-33238777 [label="Project3:(*)"];
-s20182749_in -> 33238777 [style=invis];
-};
-3745812 -> s20182749_out [style=invis];
-7762850 -> s20182749_out [style=invis];
-10589182 -> s20182749_out [style=invis];
-33238777 -> s20182749_out [style=invis];
-9719229 [label="LOInnerLoad"];
-8115306 [label="LOInnerLoad"];
-28745811 [label="LOInnerLoad"];
-14141119 [label="LOInnerLoad"];
-9719229 -> s20182749_in [lhead=cluster_20182749]
-8115306 -> s20182749_in [lhead=cluster_20182749]
-28745811 -> s20182749_in [lhead=cluster_20182749]
-14141119 -> s20182749_in [lhead=cluster_20182749]
-s4359463_in -> 9719229 [style=invis];
-s4359463_in -> 8115306 [style=invis];
-s4359463_in -> 28745811 [style=invis];
-s4359463_in -> 14141119 [style=invis];
-};
-s20182749_out -> s4359463_out [style=invis];
-s20945327_out -> 16412781
-s22487327_out -> s20945327_in [lhead=cluster_20945327]
-s18259890_out -> s22487327_in [lhead=cluster_22487327]
-s4750048_out -> s18259890_4750048_in [lhead=cluster_18259890_4750048]
-s8814509_out -> s4750048_in [lhead=cluster_4750048]
-s22811631_out -> s1726320_in [lhead=cluster_1726320]
-s4968819_out -> s4359463_in [lhead=cluster_4359463]
-2153655 -> s22811631_in [lhead=cluster_22811631]
-27519670 -> s4968819_in [lhead=cluster_4968819]
-s1726320_out -> s8814509_1726320_in [lhead=cluster_8814509_1726320]
-s4359463_out -> s8814509_4359463_in [lhead=cluster_8814509_4359463]
+11705501 [label="Project0:(*)"];
+s27525999_in -> 11705501 [style=invis];
+4729773 [label="Project1:(*)"];
+s27525999_in -> 4729773 [style=invis];
+2861196 [label="Project2:(*)"];
+s27525999_in -> 2861196 [style=invis];
+4629854 [label="Project3:(*)"];
+s27525999_in -> 4629854 [style=invis];
+};
+11705501 -> s27525999_out [style=invis];
+4729773 -> s27525999_out [style=invis];
+2861196 -> s27525999_out [style=invis];
+4629854 -> s27525999_out [style=invis];
+14518777 [label="LOInnerLoad"];
+9263789 [label="LOInnerLoad"];
+3945981 [label="LOInnerLoad"];
+16555307 [label="LOInnerLoad"];
+14518777 -> s27525999_in [lhead=cluster_27525999]
+9263789 -> s27525999_in [lhead=cluster_27525999]
+3945981 -> s27525999_in [lhead=cluster_27525999]
+16555307 -> s27525999_in [lhead=cluster_27525999]
+s26867942_in -> 14518777 [style=invis];
+s26867942_in -> 9263789 [style=invis];
+s26867942_in -> 3945981 [style=invis];
+s26867942_in -> 16555307 [style=invis];
+};
+s27525999_out -> s26867942_out [style=invis];
+s26567569_out -> 17330894
+s7897563_out -> s26567569_in [lhead=cluster_26567569]
+s18554240_out -> s7897563_in [lhead=cluster_7897563]
+s5875509_out -> s26867942_in [lhead=cluster_26867942]
+32545329 -> s5875509_in [lhead=cluster_5875509]
+s26867942_out -> s18554240_26867942_in [lhead=cluster_18554240_26867942]
 }
 
