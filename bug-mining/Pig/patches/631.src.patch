diff --git a/CHANGES.txt b/CHANGES.txt
index 1b73f5786..4e4178111 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -299,6 +299,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1820: New logical plan: FilterLogicExpressionSimplifier fail to deal with UDF (daijy)
+
 PIG-1854: Pig returns exit code 0 for the failed Pig script (rding)
 
 PIG-1812: Problem with DID_NOT_FIND_LOAD_ONLY_MAP_PLAN (daijy)
diff --git a/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java b/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
index 4102adab8..cba174f1f 100644
--- a/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
+++ b/src/org/apache/pig/newplan/logical/rules/LogicalExpressionSimplifier.java
@@ -557,6 +557,8 @@ public class LogicalExpressionSimplifier extends Rule {
                     return Unknown;
             }
 
+            if (!(le1 instanceof BinaryExpression)||!(le2 instanceof BinaryExpression))
+                return Unknown;
             BinaryExpression b1 = !proxy1 ? (BinaryExpression) e1
                             : (BinaryExpression) ((LogicalExpressionProxy) e1).src, b2 = !proxy2 ? (BinaryExpression) e2
                             : (BinaryExpression) ((LogicalExpressionProxy) e2).src;
diff --git a/test/org/apache/pig/test/TestFilterSimplification.java b/test/org/apache/pig/test/TestFilterSimplification.java
index 85a378da1..8cb5fba07 100644
--- a/test/org/apache/pig/test/TestFilterSimplification.java
+++ b/test/org/apache/pig/test/TestFilterSimplification.java
@@ -804,6 +804,26 @@ public class TestFilterSimplification extends TestCase {
         assertTrue(expected.isEqual(newLogicalPlan));
     }
     
+    @Test
+    // PIG-1820
+    public void test8() throws Exception {
+        LogicalPlanTester lpt = new LogicalPlanTester(pc);
+        lpt.buildPlan("b = filter (load 'd.txt' as (a0, a1)) by (a0 is not null or a1 is not null) and IsEmpty(a0);"); 
+
+        org.apache.pig.impl.logicalLayer.LogicalPlan plan = lpt.buildPlan("store b into 'empty';");
+        LogicalPlan newLogicalPlan = migratePlan(plan);
+
+        PlanOptimizer optimizer = new MyPlanOptimizer(newLogicalPlan, 10);
+        optimizer.optimize();
+
+        lpt = new LogicalPlanTester(pc);
+        lpt.buildPlan("b = filter (load 'd.txt' as (a0, a1)) by (a0 is not null or a1 is not null) and IsEmpty(a0);"); 
+        plan = lpt.buildPlan("store b into 'empty';");
+        LogicalPlan expected = migratePlan(plan);
+
+        assertTrue(expected.isEqual(newLogicalPlan));
+    }
+    
     public class MyPlanOptimizer extends LogicalPlanOptimizer {
 
         protected MyPlanOptimizer(OperatorPlan p, int iterations) {
