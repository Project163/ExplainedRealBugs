diff --git a/CHANGES.txt b/CHANGES.txt
index 4e1bb7237..87857ce7d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -86,6 +86,8 @@ PIG-1696: Performance: Use System.arraycopy() instead of manually copying the by
 
 BUG FIXES
 
+PIG-730: problem combining schema from a union of several LOAD expressions, with a nested bag inside the schema (daijy)
+
 PIG-767: Schema reported from DESCRIBE and actual schema of inner bags are different (daijy)
 
 PIG-1801: Need better error message for Jython errors (rding)
diff --git a/src/org/apache/pig/impl/logicalLayer/schema/Schema.java b/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
index d6af5c8e2..4d386ddd5 100644
--- a/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
+++ b/src/org/apache/pig/impl/logicalLayer/schema/Schema.java
@@ -1595,7 +1595,15 @@ public class Schema implements Serializable, Cloneable {
 
         }
 
-        return new Schema(outputList) ;
+        Schema result = new Schema(outputList);
+        if (schema.isTwoLevelAccessRequired()!=other.isTwoLevelAccessRequired()) {
+            int errCode = 2124;
+            String errMsg = "Cannot merge schema " + schema + " and " + other + ". One with twoLeverAccess flag, the other doesn't.";
+            throw new SchemaMergeException(errMsg, errCode, PigException.BUG);
+        }
+        if (schema.isTwoLevelAccessRequired())
+            result.setTwoLevelAccessRequired(true);
+        return result;
     }
 
     /***
diff --git a/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java b/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
index 8590f13ac..70f111d73 100644
--- a/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
+++ b/src/org/apache/pig/newplan/logical/expression/DereferenceExpression.java
@@ -142,7 +142,7 @@ public class DereferenceExpression extends ColumnExpression {
                     // Get the tuple inner schema
                     LogicalSchema origSchema = predFS.schema.getField(0).schema;;
                     // Slice the tuple inner schema
-                    if (origSchema!=null) {
+                    if (origSchema!=null && origSchema.size()!=0) {
                         for (int column:columns) {
                             innerSchema.addField(origSchema.getField(column));
                         }
diff --git a/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java b/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
index 223727619..8738e55aa 100644
--- a/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
+++ b/src/org/apache/pig/newplan/logical/relational/LogicalSchema.java
@@ -336,7 +336,10 @@ public class LogicalSchema {
             }
             LogicalFieldSchema mergedFS = new LogicalFieldSchema(mergedAlias, mergedSubSchema, mergedType);
             mergedSchema.addField(mergedFS);
-            if (s1.isTwoLevelAccessRequired() && s2.isTwoLevelAccessRequired()) {
+            if (s1.isTwoLevelAccessRequired() != s2.isTwoLevelAccessRequired()) {
+                return null;
+            }
+            if (s1.isTwoLevelAccessRequired()) {
                 mergedSchema.setTwoLevelAccessRequired(true);
             }
         }
diff --git a/test/org/apache/pig/test/TestSchema.java b/test/org/apache/pig/test/TestSchema.java
index 2ce435660..ce918a9c3 100644
--- a/test/org/apache/pig/test/TestSchema.java
+++ b/test/org/apache/pig/test/TestSchema.java
@@ -48,9 +48,12 @@ import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
+import org.apache.pig.impl.logicalLayer.parser.ParseException;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.logicalLayer.schema.SchemaMergeException;
 import org.apache.pig.impl.logicalLayer.schema.Schema.FieldSchema;
+import org.apache.pig.impl.util.Utils;
+import org.apache.pig.newplan.logical.relational.LogicalSchema;
 import org.junit.Test;
 
 public class TestSchema extends TestCase {
@@ -657,4 +660,57 @@ public class TestSchema extends TestCase {
         }
         cluster.shutDown();
     }
+    
+    @Test
+    // See PIG-730
+    public void testMergeSchemaWithTwoLevelAccess1() throws Exception {
+        // Generate two schemas
+        Schema s1 = Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
+        Schema s2 = Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
+        s1.getField(0).schema.setTwoLevelAccessRequired(true);
+        s2.getField(0).schema.setTwoLevelAccessRequired(true);
+        Schema s3 = Schema.mergeSchema(s1, s2, true);
+        assertEquals(s3.getField(0).schema.isTwoLevelAccessRequired(), true);
+    }
+    
+    @Test
+    // See PIG-730
+    public void testMergeSchemaWithTwoLevelAccess() throws Exception {
+        // Generate two schemas
+        Schema s1 = Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
+        Schema s2 = Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
+        s1.getField(0).schema.setTwoLevelAccessRequired(true);
+        s1.getField(0).schema.setTwoLevelAccessRequired(false);
+        Schema s3 = Schema.mergeSchema(s1, s2, true);
+        assertEquals(s3, null);
+    }
+    
+    @Test
+    // See PIG-730
+    public void testMergeSchemaWithTwoLevelAccess3() throws Exception {
+        // Generate two schemas
+        Schema s1 = Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
+        Schema s2 = Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
+        LogicalSchema ls1 = org.apache.pig.newplan.logical.Util.translateSchema(s1);
+        LogicalSchema ls2 = org.apache.pig.newplan.logical.Util.translateSchema(s2);
+        ls1.getField(0).schema.setTwoLevelAccessRequired(true);
+        ls2.getField(0).schema.setTwoLevelAccessRequired(true);
+        LogicalSchema ls3 = LogicalSchema.merge(ls1, ls2);
+        assertEquals(ls3.getField(0).schema.isTwoLevelAccessRequired(), true);
+    }
+    
+    @Test
+    // See PIG-730
+    public void testMergeSchemaWithTwoLevelAccess4() throws Exception {
+        // Generate two schemas
+        Schema s1 = Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
+        Schema s2 = Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
+        LogicalSchema ls1 = org.apache.pig.newplan.logical.Util.translateSchema(s1);
+        LogicalSchema ls2 = org.apache.pig.newplan.logical.Util.translateSchema(s2);
+        ls1.getField(0).schema.setTwoLevelAccessRequired(true);
+        ls2.getField(0).schema.setTwoLevelAccessRequired(false);
+        LogicalSchema ls3 = LogicalSchema.merge(ls1, ls2);
+        assertEquals(ls3.getField(0).type, DataType.BAG);
+        assertEquals(ls3.getField(0).schema, null);
+    }
 }
