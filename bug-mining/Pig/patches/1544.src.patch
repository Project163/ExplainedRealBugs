diff --git a/CHANGES.txt b/CHANGES.txt
index 9291e05fe..aca5ff5ce 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -64,6 +64,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4127: Build failure due to TEZ-1132 and TEZ-1416 (lbendig)
+
 PIG-4125: TEZ-1347 broke the build
 
 PIG-4123: Increase memory for TezMiniCluster (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/ObjectCache.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/ObjectCache.java
index cd9bf73fd..d8ceff84f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/ObjectCache.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/ObjectCache.java
@@ -20,7 +20,7 @@ package org.apache.pig.backend.hadoop.executionengine.tez;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.classification.InterfaceAudience;
-import org.apache.tez.runtime.common.objectregistry.ObjectRegistry;
+import org.apache.tez.runtime.api.ObjectRegistry;
 import org.apache.tez.runtime.common.objectregistry.ObjectRegistryImpl;
 
 @InterfaceAudience.Private
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/POLocalRearrangeTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/POLocalRearrangeTez.java
index ea06cb915..bcc6edd99 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/POLocalRearrangeTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/POLocalRearrangeTez.java
@@ -38,8 +38,8 @@ import org.apache.tez.runtime.api.LogicalOutput;
 import org.apache.tez.runtime.library.api.KeyValueWriter;
 
 /**
- * POLocalRearrangeTez is used to write to a Tez OnFileSortedOutput
- * (shuffle) or OnFileUnorderedKVOutput (broadcast)
+ * POLocalRearrangeTez is used to write to a Tez OrderedPartitionedKVOutput
+ * (shuffle) or UnorderedKVOutput (broadcast)
  */
 public class POLocalRearrangeTez extends POLocalRearrange implements TezOutput {
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/POShuffleTezLoad.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/POShuffleTezLoad.java
index 6e8cb0bb2..fcd2a9129 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/POShuffleTezLoad.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/POShuffleTezLoad.java
@@ -90,9 +90,9 @@ public class POShuffleTezLoad extends POPackage implements TezInput {
             }
 
             // We need to adjust numInputs because it's possible for both
-            // ShuffledMergedInputs and non-ShuffledMergedInputs to be attached
+            // OrderedGroupedKVInput and non-OrderedGroupedKVInput to be attached
             // to the same vertex. If so, we're only interested in
-            // ShuffledMergedInputs. So we ignore the others.
+            // OrderedGroupedKVInputs. So we ignore the others.
             this.numInputs = this.inputs.size();
 
             readOnce = new boolean[numInputs];
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
index 265ddd507..7aa57267a 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/PartitionerDefinedVertexManager.java
@@ -76,7 +76,7 @@ public class PartitionerDefinedVertexManager extends VertexManagerPlugin {
             return;
         }
         isParallelismSet = true;
-        // Need to distinguish from VertexManagerEventPayloadProto emitted by OnFileSortedOutput
+        // Need to distinguish from VertexManagerEventPayloadProto emitted by OrderedPartitionedKVOutput
         if (vmEvent.getUserPayload().length==4) {
             dynamicParallelism = Ints.fromByteArray(vmEvent.getUserPayload());
         } else {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
index 6bb40ecc6..a7d8c564c 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezCompiler.java
@@ -107,9 +107,9 @@ import org.apache.pig.impl.util.Pair;
 import org.apache.pig.impl.util.Utils;
 import org.apache.pig.newplan.logical.relational.LOJoin;
 import org.apache.tez.dag.api.EdgeProperty.DataMovementType;
-import org.apache.tez.runtime.library.input.ShuffledMergedInput;
-import org.apache.tez.runtime.library.input.ShuffledUnorderedKVInput;
-import org.apache.tez.runtime.library.output.OnFileUnorderedKVOutput;
+import org.apache.tez.runtime.library.input.OrderedGroupedKVInput;
+import org.apache.tez.runtime.library.input.UnorderedKVInput;
+import org.apache.tez.runtime.library.output.UnorderedKVOutput;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
@@ -730,8 +730,8 @@ public class TezCompiler extends PhyPlanVisitor {
 
                     // Configure broadcast edges for replicated tables
                     edge.dataMovementType = DataMovementType.BROADCAST;
-                    edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-                    edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+                    edge.outputClassName = UnorderedKVOutput.class.getName();
+                    edge.inputClassName = UnorderedKVInput.class.getName();
                 } else {
                     int errCode = 2022;
                     String msg = "The current operator is closed. This is unexpected while compiling.";
@@ -816,10 +816,10 @@ public class TezCompiler extends PhyPlanVisitor {
             if (this.plan.getPredecessors(op).get(0) instanceof POSort) {
                 output.setTaskIndexWithRecordIndexAsKey(true);
                 // POValueOutputTez will write key (task index, record index) in
-                // sorted order. So using OnFileUnorderedKVOutput instead of OnFileSortedOutput.
-                // But input needs to be merged in sorter order and requires ShuffledMergedInput
-                edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-                edge.inputClassName = ShuffledMergedInput.class.getName();
+                // sorted order. So using UnorderedKVOutput instead of OrderedPartitionedKVOutput.
+                // But input needs to be merged in sorter order and requires OrderedGroupedKVInput
+                edge.outputClassName = UnorderedKVOutput.class.getName();
+                edge.inputClassName = OrderedGroupedKVInput.class.getName();
                 edge.setIntermediateOutputKeyClass(TezCompilerUtil.TUPLE_CLASS);
                 edge.setIntermediateOutputKeyComparatorClass(PigTupleWritableComparator.class.getName());
             }
@@ -1623,8 +1623,8 @@ public class TezCompiler extends PhyPlanVisitor {
             // TODO: Convert to unsorted shuffle after TEZ-661
             // Use 1-1 edge
             edge.dataMovementType = DataMovementType.ONE_TO_ONE;
-            edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-            edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+            edge.outputClassName = UnorderedKVOutput.class.getName();
+            edge.inputClassName = UnorderedKVInput.class.getName();
             // If prevOp.requestedParallelism changes based on no. of input splits
             // it will reflect for joinJobs[0] so that 1-1 edge will work.
             joinJobs[0].setRequestedParallelismByReference(prevOp);
@@ -2206,8 +2206,8 @@ public class TezCompiler extends PhyPlanVisitor {
 
             // Use 1-1 edge
             edge.dataMovementType = DataMovementType.ONE_TO_ONE;
-            edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-            edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+            edge.outputClassName = UnorderedKVOutput.class.getName();
+            edge.inputClassName = UnorderedKVInput.class.getName();
             // If prevOper.requestedParallelism changes based on no. of input splits
             // it will reflect for sortOpers[0] so that 1-1 edge will work.
             sortOpers[0].setRequestedParallelismByReference(prevOper);
@@ -2218,8 +2218,8 @@ public class TezCompiler extends PhyPlanVisitor {
 
             /*
             // TODO: Convert to unsorted shuffle after TEZ-661
-            // edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-            // edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+            // edge.outputClassName = UnorderedKVOutput.class.getName();
+            // edge.inputClassName = UnorderedKVInput.class.getName();
             edge.partitionerClass = RoundRobinPartitioner.class;
             sortOpers[0].setRequestedParallelism(quantJobParallelismPair.second);
             sortOpers[1].setRequestedParallelism(quantJobParallelismPair.second);
@@ -2264,16 +2264,16 @@ public class TezCompiler extends PhyPlanVisitor {
 
                 edge = TezCompilerUtil.connect(tezPlan, sortOpers[1], limitOper);
                 // LIMIT in this case should be ordered. So we output unordered with key as task index
-                // and on the input we use ShuffledMergedInput to do ordered merge to retain sorted order.
+                // and on the input we use OrderedGroupedKVInput to do ordered merge to retain sorted order.
                 output.addOutputKey(limitOper.getOperatorKey().toString());
                 output.setTaskIndexWithRecordIndexAsKey(true);
                 edge = curTezOp.inEdges.get(sortOpers[1].getOperatorKey());
                 TezCompilerUtil.configureValueOnlyTupleOutput(edge, DataMovementType.SCATTER_GATHER);
                 // POValueOutputTez will write key (task index, record index) in
-                // sorted order. So using OnFileUnorderedKVOutput instead of OnFileSortedOutput.
-                // But input needs to be merged in sorter order and requires ShuffledMergedInput
-                edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-                edge.inputClassName = ShuffledMergedInput.class.getName();
+                // sorted order. So using UnorderedKVOutput instead of OrderedPartitionedKVOutput.
+                // But input needs to be merged in sorter order and requires OrderedGroupedKVInput
+                edge.outputClassName = UnorderedKVOutput.class.getName();
+                edge.inputClassName = OrderedGroupedKVInput.class.getName();
                 edge.setIntermediateOutputKeyClass(TezCompilerUtil.TUPLE_CLASS);
                 edge.setIntermediateOutputKeyComparatorClass(PigTupleWritableComparator.class.getName());
 
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
index 2832bed81..5b23a99a6 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezDagBuilder.java
@@ -133,8 +133,8 @@ import org.apache.tez.mapreduce.partition.MRPartitioner;
 import org.apache.tez.mapreduce.protos.MRRuntimeProtos;
 import org.apache.tez.runtime.library.api.TezRuntimeConfiguration;
 import org.apache.tez.runtime.library.input.ConcatenatedMergedKeyValueInput;
-import org.apache.tez.runtime.library.input.ShuffledMergedInput;
-import org.apache.tez.runtime.library.input.SortedGroupedMergedInput;
+import org.apache.tez.runtime.library.input.OrderedGroupedKVInput;
+import org.apache.tez.runtime.library.input.OrderedGroupedMergedKVInput;
 
 /**
  * A visitor to construct DAG out of Tez plan.
@@ -240,11 +240,11 @@ public class TezDagBuilder extends TezOpPlanVisitor {
 
         String groupInputClass = ConcatenatedMergedKeyValueInput.class.getName();
 
-        // In case of SCATTER_GATHER and ShuffledUnorderedKVInput it will still be
+        // In case of SCATTER_GATHER and UnorderedKVInput it will still be
         // ConcatenatedMergedKeyValueInput
         if(edgeProperty.getDataMovementType().equals(DataMovementType.SCATTER_GATHER)
-                && edgeProperty.getEdgeDestination().getClassName().equals(ShuffledMergedInput.class.getName())) {
-            groupInputClass = SortedGroupedMergedInput.class.getName();
+                && edgeProperty.getEdgeDestination().getClassName().equals(OrderedGroupedKVInput.class.getName())) {
+            groupInputClass = OrderedGroupedMergedKVInput.class.getName();
         }
 
         return new GroupInputEdge(from, to, edgeProperty,
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezEdgeDescriptor.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezEdgeDescriptor.java
index 32427c66c..8c1e370e9 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/TezEdgeDescriptor.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/TezEdgeDescriptor.java
@@ -22,8 +22,8 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.Physica
 import org.apache.tez.dag.api.EdgeProperty.DataMovementType;
 import org.apache.tez.dag.api.EdgeProperty.DataSourceType;
 import org.apache.tez.dag.api.EdgeProperty.SchedulingType;
-import org.apache.tez.runtime.library.input.ShuffledMergedInput;
-import org.apache.tez.runtime.library.output.OnFileSortedOutput;
+import org.apache.tez.runtime.library.input.OrderedGroupedKVInput;
+import org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput;
 
 /**
  * Descriptor for Tez edge. It holds combine plan as well as edge properties.
@@ -55,8 +55,8 @@ public class TezEdgeDescriptor {
         combinePlan = new PhysicalPlan();
 
         // The default is shuffle edge.
-        inputClassName = ShuffledMergedInput.class.getName();
-        outputClassName = OnFileSortedOutput.class.getName();
+        inputClassName = OrderedGroupedKVInput.class.getName();
+        outputClassName = OrderedPartitionedKVOutput.class.getName();
         partitionerClass = null;
         schedulingType = SchedulingType.SEQUENTIAL;
         dataSourceType = DataSourceType.PERSISTED;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/UnionOptimizer.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/UnionOptimizer.java
index e2c54ba0b..6ec3d31f3 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/UnionOptimizer.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/optimizers/UnionOptimizer.java
@@ -40,8 +40,8 @@ import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.ReverseDependencyOrderWalker;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.tez.dag.api.EdgeProperty.DataMovementType;
-import org.apache.tez.runtime.library.input.ShuffledUnorderedKVInput;
-import org.apache.tez.runtime.library.output.OnFileUnorderedPartitionedKVOutput;
+import org.apache.tez.runtime.library.input.UnorderedKVInput;
+import org.apache.tez.runtime.library.output.UnorderedPartitionedKVOutput;
 
 /**
  * Optimizes union by removing the intermediate union vertex and making the
@@ -206,8 +206,8 @@ public class UnionOptimizer extends TezOpPlanVisitor {
                 if (edge.dataMovementType == DataMovementType.ONE_TO_ONE) {
                     edge.dataMovementType = DataMovementType.SCATTER_GATHER;
                     edge.partitionerClass = RoundRobinPartitioner.class;
-                    edge.outputClassName = OnFileUnorderedPartitionedKVOutput.class.getName();
-                    edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+                    edge.outputClassName = UnorderedPartitionedKVOutput.class.getName();
+                    edge.inputClassName = UnorderedKVInput.class.getName();
                 }
                 TezOperator vertexGroupOp = outputVertexGroupOps[unionOutputKeys.indexOf(entry.getKey().toString())];
                 for (OperatorKey predKey : vertexGroupOp.getVertexGroupMembers()) {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
index 08c2d779a..32116d2af 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/util/TezCompilerUtil.java
@@ -26,9 +26,9 @@ import org.apache.pig.impl.plan.NodeIdGenerator;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.impl.plan.PlanException;
 import org.apache.tez.dag.api.EdgeProperty.DataMovementType;
-import org.apache.tez.runtime.library.input.ShuffledUnorderedKVInput;
-import org.apache.tez.runtime.library.output.OnFileUnorderedKVOutput;
-import org.apache.tez.runtime.library.output.OnFileUnorderedPartitionedKVOutput;
+import org.apache.tez.runtime.library.input.UnorderedKVInput;
+import org.apache.tez.runtime.library.output.UnorderedKVOutput;
+import org.apache.tez.runtime.library.output.UnorderedPartitionedKVOutput;
 
 import com.google.common.collect.Lists;
 
@@ -159,11 +159,11 @@ public class TezCompilerUtil {
     static public void configureValueOnlyTupleOutput(TezEdgeDescriptor edge, DataMovementType dataMovementType) {
         edge.dataMovementType = dataMovementType;
         if (dataMovementType == DataMovementType.BROADCAST || dataMovementType == DataMovementType.ONE_TO_ONE) {
-            edge.outputClassName = OnFileUnorderedKVOutput.class.getName();
-            edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+            edge.outputClassName = UnorderedKVOutput.class.getName();
+            edge.inputClassName = UnorderedKVInput.class.getName();
         } else if (dataMovementType == DataMovementType.SCATTER_GATHER) {
-            edge.outputClassName = OnFileUnorderedPartitionedKVOutput.class.getName();
-            edge.inputClassName = ShuffledUnorderedKVInput.class.getName();
+            edge.outputClassName = UnorderedPartitionedKVOutput.class.getName();
+            edge.inputClassName = UnorderedKVInput.class.getName();
             edge.partitionerClass = RoundRobinPartitioner.class;
         }
         edge.setIntermediateOutputKeyClass(POValueOutputTez.EmptyWritable.class.getName());
