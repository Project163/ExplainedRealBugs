diff --git a/CHANGES.txt b/CHANGES.txt
index 8e07f08e0..0b5c1f023 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -34,6 +34,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4014: Fix Rank e2e test failures on tez (daijy)
+
 PIG-4013: Order by multiple column fail on Tez (daijy)
 
 PIG-3983: TestGrunt.testKeepGoigFailed fail on tez mode (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCounter.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCounter.java
index 8f3468bab..b343d1802 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCounter.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/relationalOperators/POCounter.java
@@ -51,7 +51,7 @@ import org.apache.pig.pen.util.ExampleTuple;
 public class POCounter extends PhysicalOperator {
 
     private static final long serialVersionUID = 1L;
-    private static final Long ONE = 1L;
+    public static final Long ONE = 1L;
 
     private List<PhysicalPlan> counterPlans;
     private List<Boolean> mAscCols;
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java b/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
index bc23a1ac7..d31f9019e 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/tez/operators/POCounterTez.java
@@ -33,6 +33,7 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.backend.hadoop.executionengine.tez.POValueOutputTez;
 import org.apache.pig.backend.hadoop.executionengine.tez.TezOutput;
 import org.apache.pig.backend.hadoop.executionengine.tez.TezTaskConfigurable;
+import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.plan.VisitorException;
 import org.apache.tez.runtime.api.LogicalOutput;
 import org.apache.tez.runtime.api.TezProcessorContext;
@@ -123,6 +124,9 @@ public class POCounterTez extends POCounter implements TezOutput, TezTaskConfigu
 
                 tuplesWriter.write(POValueOutputTez.EMPTY_KEY,
                         addCounterValue(inp).result);
+                if (isRowNumber()) {
+                    incrementReduceCounter(POCounter.ONE);
+                }
             }
 
             statsWriter.write(new IntWritable(this.getTaskId()), new LongWritable(totalTaskRecords));
@@ -133,18 +137,6 @@ public class POCounterTez extends POCounter implements TezOutput, TezTaskConfigu
         return RESULT_EOP;
     }
 
-    @Override
-    protected Long incrementLocalCounter() {
-        totalTaskRecords++;
-        return super.incrementLocalCounter();
-    }
-
-    @Override
-    protected void addToLocalCounter(Long sizeBag) {
-        super.addToLocalCounter(sizeBag);
-        totalTaskRecords += sizeBag;
-    }
-
     @Override
     protected void incrementReduceCounter(Long increment) {
         totalTaskRecords += increment;
