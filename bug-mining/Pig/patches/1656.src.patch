diff --git a/CHANGES.txt b/CHANGES.txt
index 3b074a0b5..1d3f64838 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -44,6 +44,8 @@ PIG-4333: Split BigData tests into multiple groups (rohini)
  
 BUG FIXES
 
+PIG-4340: PigStorage fails parsing empty map (daijy)
+
 PIG-4366: Port local mode tests to Tez - part5 (daijy)
 
 PIG-4381: PIG grunt shell DEFINE commands fails when it spans multiple lines (daijy)
diff --git a/src/org/apache/pig/builtin/Utf8StorageConverter.java b/src/org/apache/pig/builtin/Utf8StorageConverter.java
index 814c746d7..9b0b50b0d 100644
--- a/src/org/apache/pig/builtin/Utf8StorageConverter.java
+++ b/src/org/apache/pig/builtin/Utf8StorageConverter.java
@@ -196,6 +196,7 @@ public class Utf8StorageConverter implements LoadStoreCaster {
 
     private Map<String, Object> consumeMap(PushbackInputStream in, ResourceFieldSchema fieldSchema) throws IOException {
         int buf;
+        boolean emptyMap = true;
 
         while ((buf=in.read())!='[') {
             if (buf==-1) {
@@ -207,9 +208,14 @@ public class Utf8StorageConverter implements LoadStoreCaster {
         while (true) {
             // Read key (assume key can not contains special character such as #, (, [, {, }, ], )
             while ((buf=in.read())!='#') {
+                // end of map
+                if (emptyMap && buf==']') {
+                    return m;
+                }
                 if (buf==-1) {
                     throw new IOException("Unexpect end of map");
                 }
+                emptyMap = false;
                 mOut.write(buf);
             }
             String key = bytesToCharArray(mOut.toByteArray());
diff --git a/test/org/apache/pig/test/TestConversions.java b/test/org/apache/pig/test/TestConversions.java
index dd668d391..b9772f70a 100644
--- a/test/org/apache/pig/test/TestConversions.java
+++ b/test/org/apache/pig/test/TestConversions.java
@@ -386,6 +386,10 @@ public class TestConversions {
         m = ps.getLoadCaster().bytesToMap(s.getBytes(), rfs);
         assertNull(m);
 
+        s = "[]";
+        m = ps.getLoadCaster().bytesToMap(s.getBytes(), rfs);
+        assertTrue(m.isEmpty());
+
         s = "(a,b)";
         schema = Utils.getSchemaFromString("t:tuple()");
         rfs = new ResourceSchema(schema).getFields()[0];
