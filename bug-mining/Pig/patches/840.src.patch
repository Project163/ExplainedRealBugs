diff --git a/CHANGES.txt b/CHANGES.txt
index d97dab9d1..05469d7ae 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -156,6 +156,8 @@ PIG-2228: support partial aggregation in map task (thejas)
 
 BUG FIXES
 
+PIG-2275: NullPointerException from ILLUSTRATE (daijy)
+
 PIG-2119: DuplicateForEachColumnRewrite makes assumptions about the position of LOGGenerate in the plan (daijy)
 
 PIG-2290: TOBAG wraps tuple parameters in another tuple (ryan.hoegg via thejas)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/UnaryComparisonOperator.java b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/UnaryComparisonOperator.java
index 664587434..ab2bdb093 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/UnaryComparisonOperator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/physicalLayer/expressionOperators/UnaryComparisonOperator.java
@@ -55,7 +55,7 @@ public abstract class UnaryComparisonOperator extends UnaryExpressionOperator
     @Override
     public Tuple illustratorMarkup(Object in, Object out, int eqClassIndex) {
         if(illustrator != null) {
-
+            illustrator.setSubExpResult(eqClassIndex == 0);
         }
         return null;
     }
diff --git a/src/org/apache/pig/pen/AugmentBaseDataVisitor.java b/src/org/apache/pig/pen/AugmentBaseDataVisitor.java
index 4640f6301..84e58cf63 100644
--- a/src/org/apache/pig/pen/AugmentBaseDataVisitor.java
+++ b/src/org/apache/pig/pen/AugmentBaseDataVisitor.java
@@ -61,6 +61,7 @@ import org.apache.pig.newplan.logical.expression.LessThanExpression;
 import org.apache.pig.newplan.logical.expression.LessThanEqualExpression;
 import org.apache.pig.newplan.logical.relational.LOLoad;
 import org.apache.pig.newplan.logical.relational.LogicalPlan;
+import org.apache.pig.newplan.logical.expression.IsNullExpression;
 import org.apache.pig.newplan.logical.expression.ModExpression;
 import org.apache.pig.newplan.logical.expression.LogicalExpression;
 import org.apache.pig.newplan.logical.expression.MultiplyExpression;
@@ -69,6 +70,7 @@ import org.apache.pig.newplan.logical.expression.NotEqualExpression;
 import org.apache.pig.newplan.logical.expression.OrExpression;
 import org.apache.pig.newplan.logical.expression.ProjectExpression;
 import org.apache.pig.newplan.logical.expression.RegexExpression;
+import org.apache.pig.newplan.logical.expression.UserFuncExpression;
 import org.apache.pig.newplan.logical.relational.LOSort;
 import org.apache.pig.newplan.logical.relational.LOSplit;
 import org.apache.pig.newplan.logical.relational.LOStore;
@@ -510,10 +512,10 @@ public class AugmentBaseDataVisitor extends LogicalRelationalNodesVisitor {
         } catch (Exception e) {
             log
                     .error("Error visiting Load during Augmentation phase of Example Generator! "
-                            + e.getMessage());
+                            + e.getMessage(), e);
             throw new FrontendException(
                     "Error visiting Load during Augmentation phase of Example Generator! "
-                            + e.getMessage());
+                            + e.getMessage(), e);
         }
     }
 
@@ -946,6 +948,12 @@ public class AugmentBaseDataVisitor extends LogicalRelationalNodesVisitor {
                     invert);
         else if (pred instanceof NotExpression)
             GenerateMatchingTupleHelper(t, (NotExpression) pred, invert);
+        else if (pred instanceof IsNullExpression)
+            GenerateMatchingTupleHelper(t, (IsNullExpression) pred, invert);
+        else if (pred instanceof UserFuncExpression)
+            // Don't know how to generate input tuple for UDF, return null
+            // to suppress the generation 
+            t = null;
         else
             throw new FrontendException("Unknown operator in filter predicate");
     }
@@ -1151,6 +1159,15 @@ public class AugmentBaseDataVisitor extends LogicalRelationalNodesVisitor {
         GenerateMatchingTupleHelper(t, input, !invert);
 
     }
+    
+    void GenerateMatchingTupleHelper(Tuple t, IsNullExpression op, boolean invert)
+            throws FrontendException, ExecException {
+        byte type = op.getExpression().getType();
+        if (!invert)
+            t.set(0, null);
+        else
+            t.set(0, generateData(type, "0"));
+    }
 
     Object GetUnequalValue(Object v) {
         byte type = DataType.findType(v);
diff --git a/test/org/apache/pig/test/TestExampleGenerator.java b/test/org/apache/pig/test/TestExampleGenerator.java
index 9a56344f2..d10bbca41 100644
--- a/test/org/apache/pig/test/TestExampleGenerator.java
+++ b/test/org/apache/pig/test/TestExampleGenerator.java
@@ -361,4 +361,33 @@ public class TestExampleGenerator {
 
         assertTrue(derivedData != null);
     }
+    
+    //see PIG-2275
+    @Test
+    public void testFilterWithIsNull() throws ExecException, IOException {
+        PigServer pigServer = new PigServer(pigContext);
+
+        pigServer.registerQuery("A = load " + A
+                + " using PigStorage() as (x : int, y : int);");
+        pigServer.registerQuery("B = filter A by x is not null;");
+
+        Map<Operator, DataBag> derivedData = pigServer.getExamples("B");
+
+        assertTrue(derivedData != null);
+    }
+    
+    @Test
+    public void testFilterWithUDF() throws ExecException, IOException {
+        PigServer pigServer = new PigServer(pigContext);
+
+        pigServer.registerQuery("A = load " + A
+                + " using PigStorage() as (x : int, y : int);");
+        pigServer.registerQuery("B = group A by x;");
+        pigServer.registerQuery("C = filter B by NOT IsEmpty(A.y);");
+
+        Map<Operator, DataBag> derivedData = pigServer.getExamples("C");
+
+        assertTrue(derivedData != null);
+    }
+
 }
