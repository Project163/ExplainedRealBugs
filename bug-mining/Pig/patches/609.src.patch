diff --git a/CHANGES.txt b/CHANGES.txt
index 409cca04e..36767c059 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -257,6 +257,8 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1787: Error in logical plan generated (daijy)
+
 PIG-1791: System property mapred.output.compress, but pig-cluster-hadoop-site.xml doesn't (daijy)
 
 PIG-1771: New logical plan: Merge schema fail if LoadFunc.getSchema return different schema with "Load...AS" (daijy)
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
index 72ff51dd8..1bd8c797f 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/MRCompiler.java
@@ -2994,7 +2994,11 @@ public class MRCompiler extends PhyPlanVisitor {
                         .getSuccessors(op);
                 if (succs==null) break;
                 op = succs.get(0);
-                if (op instanceof POForEach) break;
+                if (op instanceof POLimit) {
+                    // find operator after POLimit
+                    op = sortMROp.reducePlan.getSuccessors(op).get(0);
+                    break;
+                }
             }
             
             while (true) {
diff --git a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
index be6672d00..b62156c8b 100644
--- a/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
+++ b/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/plans/POPackageAnnotator.java
@@ -105,7 +105,7 @@ public class POPackageAnnotator extends MROpPlanVisitor {
             List<MapReduceOper> preds = this.mPlan.getPredecessors(mr);
             for (Iterator<MapReduceOper> it = preds.iterator(); it.hasNext();) {
                 MapReduceOper mrOper = it.next();
-                if (mrOper.isLimitOnly())
+                if (mrOper.isLimitOnly() && !mPlan.getPredecessors(mrOper).get(0).isGlobalSort())
                     mrOper = this.mPlan.getPredecessors(mrOper).get(0);
                 lrFound += patchPackage(mrOper.reducePlan, pkg);
                 if(lrFound == pkg.getNumInps()) {
diff --git a/test/org/apache/pig/test/TestEvalPipeline2.java b/test/org/apache/pig/test/TestEvalPipeline2.java
index 5b473e7bd..d36e1c547 100644
--- a/test/org/apache/pig/test/TestEvalPipeline2.java
+++ b/test/org/apache/pig/test/TestEvalPipeline2.java
@@ -1130,4 +1130,30 @@ public class TestEvalPipeline2 extends TestCase {
         assertTrue(results.contains(t.toString()));
         assertFalse(iter.hasNext());
     }
+    
+    // See PIG-1787
+    @Test
+    public void testOrderByLimitJoin() throws Exception{
+        String[] input1 = {
+                "1\t1",
+                "1\t2"
+        };
+        
+        Util.createInputFile(cluster, "table_testOrderByLimitJoin", input1);
+
+        pigServer.registerQuery("a = load 'table_testOrderByLimitJoin' as (a0, a1);");
+        pigServer.registerQuery("b = group a by a0;");
+        pigServer.registerQuery("c = foreach b generate group as c0, COUNT(a) as c1;");
+        pigServer.registerQuery("d = order c by c1 parallel 2;");
+        pigServer.registerQuery("e = limit d 10;");
+        pigServer.registerQuery("f = join e by c0, a by a0;");
+        
+        Iterator<Tuple> iter = pigServer.openIterator("f");
+        
+        Tuple t = iter.next();
+        assertTrue(t.toString().equals("(1,2,1,1)"));
+        t = iter.next();
+        assertTrue(t.toString().equals("(1,2,1,2)"));
+        assertFalse(iter.hasNext());
+    }
 }
