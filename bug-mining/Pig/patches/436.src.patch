diff --git a/CHANGES.txt b/CHANGES.txt
index 9b5f45b0d..b69affeaa 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -54,6 +54,9 @@ PIG-1309: Map-side Cogroup (ashutoshc)
 
 BUG FIXES
 
+PIG-1391: pig unit tests leave behind files in temp directory because 
+MiniCluster files don't get deleted (tejas)
+
 PIG-1211: Pig script runs half way after which it reports syntax error
 (pradeepkth)
 
diff --git a/build.xml b/build.xml
index 03c5dc0b1..1b58a7b8f 100644
--- a/build.xml
+++ b/build.xml
@@ -541,9 +541,13 @@
       <sequential>
         <delete dir="${test.log.dir}"/>
         <mkdir dir="${test.log.dir}"/>
+        <tempfile property="junit.tmp.dir" prefix="pig_junit_tmp" destDir="${java.io.tmpdir}" />
+        <mkdir dir="${junit.tmp.dir}/"/>
         <junit showoutput="${test.output}" printsummary="yes" haltonfailure="no" fork="yes" maxmemory="256m" dir="${basedir}" timeout="${test.timeout}" errorProperty="tests.failed" failureProperty="tests.failed">
             <sysproperty key="ssh.gateway" value="${ssh.gateway}" />
             <sysproperty key="hod.server" value="${hod.server}" />
+            <sysproperty key="java.io.tmpdir" value="${junit.tmp.dir}" />
+
             <!-- <sysproperty key="hod.command" value="${hod.command}"/>
             			<sysproperty key="hod.param" value="${hod.param}"/> -->
             <sysproperty key="hadoop.log.dir" value="${test.log.dir}"/>
@@ -591,6 +595,7 @@
                 <fileset dir="test" includes="**/${testcase}.java"/>
             </batchtest>
         </junit>
+        <delete dir="${junit.tmp.dir}/"/>
         <fail if="tests.failed">Tests failed!</fail>
       </sequential>
     </macrodef>
diff --git a/test/org/apache/pig/test/MiniCluster.java b/test/org/apache/pig/test/MiniCluster.java
index 545cc05aa..ee0cd4929 100644
--- a/test/org/apache/pig/test/MiniCluster.java
+++ b/test/org/apache/pig/test/MiniCluster.java
@@ -42,6 +42,7 @@ public class MiniCluster {
     private JobConf m_conf = null;
     
     private final static MiniCluster INSTANCE = new MiniCluster();
+    private static boolean isSetup = true;
     
     private MiniCluster() {
         setupMiniDfsAndMrClusters();
@@ -85,32 +86,57 @@ public class MiniCluster {
      * mapreduce cluster. 
      */
     public static MiniCluster buildCluster() {
+        if(! isSetup){
+            INSTANCE.setupMiniDfsAndMrClusters();
+            isSetup = true;
+        }
         return INSTANCE;
     }
+
+    public void shutDown(){
+        INSTANCE.shutdownMiniDfsAndMrClusters();
+    }
     
     protected void finalize() {
         shutdownMiniDfsAndMrClusters();
     }
     
     private void shutdownMiniDfsAndMrClusters() {
+        isSetup = false;
         try {
             if (m_fileSys != null) { m_fileSys.close(); }
         } catch (IOException e) {
             e.printStackTrace();
         }
         if (m_dfs != null) { m_dfs.shutdown(); }
-        if (m_mr != null) { m_mr.shutdown(); }        
-	}
+        if (m_mr != null) { m_mr.shutdown(); }     
+        m_fileSys = null;
+        m_dfs = null;
+        m_mr = null;
+    }
 
     public Properties getProperties() {
+        errorIfNotSetup();
         return ConfigurationUtil.toProperties(m_conf);
     }
 
     public void setProperty(String name, String value) {
+        errorIfNotSetup();
         m_conf.set(name, value);
     }
     
     public FileSystem getFileSystem() {
+        errorIfNotSetup();
         return m_fileSys;
     }
+    
+    /**
+     * Throw RunTimeException if isSetup is false
+     */
+    private void errorIfNotSetup(){
+        if(isSetup)
+            return;
+        String msg = "function called on MiniCluster that has been shutdown";
+        throw new RuntimeException(msg);
+    }
 }
diff --git a/test/org/apache/pig/test/PigExecTestCase.java b/test/org/apache/pig/test/PigExecTestCase.java
index 7a80f7c37..3be35e5fc 100644
--- a/test/org/apache/pig/test/PigExecTestCase.java
+++ b/test/org/apache/pig/test/PigExecTestCase.java
@@ -26,20 +26,24 @@ import org.apache.commons.logging.LogFactory;
 import org.apache.pig.PigServer;
 import org.apache.pig.ExecType;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4; 
 
+@RunWith(JUnit4.class)   
 public abstract class PigExecTestCase extends TestCase {
 
     protected final Log log = LogFactory.getLog(getClass());
     
     protected ExecType execType = LOCAL;
     
-    protected MiniCluster cluster;
+    static MiniCluster cluster;
     protected PigServer pigServer;
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         
         String execTypeString = System.getProperty("test.exectype");
         if(execTypeString!=null && execTypeString.length()>0){
@@ -55,7 +59,13 @@ public abstract class PigExecTestCase extends TestCase {
 
     @After
     @Override
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         pigServer.shutdown();
     }
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        if(cluster != null)
+            cluster.shutDown();
+    }
 }
diff --git a/test/org/apache/pig/test/TestAccumulator.java b/test/org/apache/pig/test/TestAccumulator.java
index e7f7a94c9..65e207485 100644
--- a/test/org/apache/pig/test/TestAccumulator.java
+++ b/test/org/apache/pig/test/TestAccumulator.java
@@ -27,8 +27,13 @@ import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.data.Tuple;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestAccumulator extends TestCase{
     private static final String INPUT_FILE = "AccumulatorInput.txt";
     private static final String INPUT_FILE2 = "AccumulatorInput2.txt";
@@ -36,8 +41,8 @@ public class TestAccumulator extends TestCase{
     private static final String INPUT_FILE4 = "AccumulatorInput4.txt";
  
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
-    
+    private static MiniCluster cluster = MiniCluster.buildCluster();
+
     public TestAccumulator() throws ExecException, IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         // pigServer = new PigServer(ExecType.LOCAL);
@@ -54,6 +59,11 @@ public class TestAccumulator extends TestCase{
         pigServer.getPigContext().getProperties().remove("opt.accumulator");
         createFiles();
     }
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
 
     private void createFiles() throws IOException {
         PrintWriter w = new PrintWriter(new FileWriter(INPUT_FILE));
@@ -120,6 +130,7 @@ public class TestAccumulator extends TestCase{
         Util.deleteFile(cluster, INPUT_FILE4);
     }
     
+    @Test
     public void testAccumBasic() throws IOException{
         // test group by
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
@@ -178,6 +189,7 @@ public class TestAccumulator extends TestCase{
         }            
     }      
     
+    @Test
     public void testAccumWithNegative() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -198,6 +210,7 @@ public class TestAccumulator extends TestCase{
         }            
     }
     
+    @Test
     public void testAccumWithAdd() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -239,6 +252,7 @@ public class TestAccumulator extends TestCase{
         }
     }      
     
+    @Test
     public void testAccumWithMinus() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -260,6 +274,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }              
     
+    @Test
     public void testAccumWithMod() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -281,6 +296,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }             
     
+    @Test
     public void testAccumWithDivide() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -302,6 +318,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }        
     
+    @Test
     public void testAccumWithAnd() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -324,6 +341,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }          
     
+    @Test
     public void testAccumWithOr() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -346,6 +364,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }  
     
+    @Test
     public void testAccumWithRegexp() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -367,7 +386,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }              
     
-
+    @Test
     public void testAccumWithIsNull() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit);");
         pigServer.registerQuery("B = group A by id;");
@@ -387,6 +406,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }              
     
+    @Test
     public void testAccumWithDistinct() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, f);");
         pigServer.registerQuery("B = group A by id;");
@@ -406,6 +426,7 @@ public class TestAccumulator extends TestCase{
         }                                   
     }             
     
+    @Test
     public void testAccumWithSort() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, f);");
         pigServer.registerQuery("B = foreach A generate id, f, id as t;");
@@ -458,6 +479,7 @@ public class TestAccumulator extends TestCase{
       }
     }
     
+    @Test
     public void testAccumWithBuildin() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
         pigServer.registerQuery("C = group A by id;");
@@ -486,6 +508,7 @@ public class TestAccumulator extends TestCase{
         }    
     }
     
+    @Test
     public void testAccumWithMultiBuildin() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE + "' as (id:int, c:chararray);");
         pigServer.registerQuery("C = group A by 1;");
@@ -501,6 +524,7 @@ public class TestAccumulator extends TestCase{
     }
 
     // Pig 1105
+    @Test
     public void testAccumCountStar() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
         pigServer.registerQuery("C = group A by id;");
@@ -513,7 +537,7 @@ public class TestAccumulator extends TestCase{
         }      
     }
     
-    
+    @Test    
     public void testAccumulatorOff() throws IOException{
         pigServer.getPigContext().getProperties().setProperty("opt.accumulator", "false");
         
@@ -533,8 +557,9 @@ public class TestAccumulator extends TestCase{
             // we should get exception
         }
         
-    }              
+    }    
     
+    @Test    
     public void testAccumWithMap() throws IOException{
         pigServer.registerQuery("A = load '" + INPUT_FILE4 + "' as (id, url);");
         pigServer.registerQuery("B = group A by (id, url);");
diff --git a/test/org/apache/pig/test/TestAlgebraicEval.java b/test/org/apache/pig/test/TestAlgebraicEval.java
index 321882f03..0bbd83df0 100644
--- a/test/org/apache/pig/test/TestAlgebraicEval.java
+++ b/test/org/apache/pig/test/TestAlgebraicEval.java
@@ -30,9 +30,13 @@ import org.apache.pig.PigServer;
 import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestAlgebraicEval extends TestCase {
     
     private int LOOP_COUNT = 1024;
@@ -41,13 +45,18 @@ public class TestAlgebraicEval extends TestCase {
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     Boolean[] nullFlags = new Boolean[]{ false, true};
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     @Test
     public void testGroupCountWithMultipleFields() throws Throwable {
         File tmpFile = File.createTempFile("test", "txt");
diff --git a/test/org/apache/pig/test/TestAlgebraicEvalLocal.java b/test/org/apache/pig/test/TestAlgebraicEvalLocal.java
index 736636936..96cd359ea 100644
--- a/test/org/apache/pig/test/TestAlgebraicEvalLocal.java
+++ b/test/org/apache/pig/test/TestAlgebraicEvalLocal.java
@@ -47,7 +47,6 @@ public class TestAlgebraicEvalLocal extends TestCase {
     
     Boolean[] nullFlags = new Boolean[]{ false, true};
 
-    //MiniCluster cluster = MiniCluster.buildCluster();
     @Test
     public void testGroupCountWithMultipleFields() throws Throwable {
         File tmpFile = File.createTempFile("test", "txt");
diff --git a/test/org/apache/pig/test/TestBZip.java b/test/org/apache/pig/test/TestBZip.java
index 2fb737d69..5d3236af2 100644
--- a/test/org/apache/pig/test/TestBZip.java
+++ b/test/org/apache/pig/test/TestBZip.java
@@ -44,10 +44,18 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.PigContext;
 import org.apache.tools.bzip2r.CBZip2InputStream;
 import org.apache.tools.bzip2r.CBZip2OutputStream;
+import org.junit.AfterClass;
 import org.junit.Test;
-
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+@RunWith(JUnit4.class)
 public class TestBZip {
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     
    /**
     * Tests the end-to-end writing and reading of a BZip file.
diff --git a/test/org/apache/pig/test/TestBatchAliases.java b/test/org/apache/pig/test/TestBatchAliases.java
index d5f785583..91772fda6 100644
--- a/test/org/apache/pig/test/TestBatchAliases.java
+++ b/test/org/apache/pig/test/TestBatchAliases.java
@@ -28,9 +28,12 @@ import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
-
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+@RunWith(JUnit4.class)
 public class TestBatchAliases extends TestCase {
 
     private static final MiniCluster cluster = MiniCluster.buildCluster();
@@ -52,6 +55,11 @@ public class TestBatchAliases extends TestCase {
         Util.deleteFile(cluster, "passwd");
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testBatchAliases() throws IOException {
 
diff --git a/test/org/apache/pig/test/TestBestFitCast.java b/test/org/apache/pig/test/TestBestFitCast.java
index 4c3a54264..80a7f3162 100644
--- a/test/org/apache/pig/test/TestBestFitCast.java
+++ b/test/org/apache/pig/test/TestBestFitCast.java
@@ -17,6 +17,8 @@
  */
 package org.apache.pig.test;
 
+import static org.junit.Assert.*;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Arrays;
@@ -38,12 +40,13 @@ import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.util.LogUtils;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
 
-public class TestBestFitCast extends TestCase {
+public class TestBestFitCast {
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     String inputFile, inputFile2;
     int LOOP_SIZE = 20;
     
@@ -76,6 +79,11 @@ public class TestBestFitCast extends TestCase {
         Util.deleteFile(cluster, inputFile2);
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     public static class UDF1 extends EvalFunc<Tuple>{
         /**
          * java level API
@@ -237,7 +245,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
             assertEquals((Long)((Tuple)t.get(1)).get(1), new Long(cnt + 1));
             ++cnt;
@@ -258,7 +266,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
             assertEquals((Long)((Tuple)t.get(1)).get(1), new Long(cnt + 1));
             ++cnt;
@@ -279,7 +287,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
             assertEquals((Double)((Tuple)t.get(1)).get(1), new Double(cnt + 1));
             ++cnt;
@@ -362,7 +370,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
             assertEquals((Long)((Tuple)t.get(1)).get(1), new Long(cnt + 1));
             assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
@@ -385,7 +393,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
             assertEquals((Double)((Tuple)t.get(1)).get(1), new Double(cnt + 1));
             assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
@@ -408,7 +416,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
             assertEquals((Long)((Tuple)t.get(1)).get(1), new Long(cnt + 1));
             assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
@@ -431,7 +439,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
             assertEquals((Double)((Tuple)t.get(1)).get(1), new Double(cnt + 1));
             assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
@@ -478,7 +486,7 @@ public class TestBestFitCast extends TestCase {
         while(iter.hasNext()){
             Tuple t = iter.next();
             assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
-            assertEquals((Float)((Tuple)t.get(1)).get(0), 0.0f);
+            assertEquals((Float)((Tuple)t.get(1)).get(0), (Float)0.0f);
             assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
             assertEquals((Long)((Tuple)t.get(1)).get(1), new Long(cnt + 1));
             assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
diff --git a/test/org/apache/pig/test/TestBuiltin.java b/test/org/apache/pig/test/TestBuiltin.java
index 5b4d8b63f..2248e3b09 100644
--- a/test/org/apache/pig/test/TestBuiltin.java
+++ b/test/org/apache/pig/test/TestBuiltin.java
@@ -17,13 +17,13 @@
  */
 package org.apache.pig.test;
 
+import static org.junit.Assert.*;
+
 import java.util.Arrays;
 import java.util.HashMap;
 import java.util.Iterator;
 import java.util.Map;
 
-import junit.framework.TestCase;
-
 import org.apache.pig.Algebraic;
 import org.apache.pig.EvalFunc;
 import org.apache.pig.ExecType;
@@ -56,13 +56,15 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.ReadToEndLoader;
+import org.junit.AfterClass;
+import org.junit.Before;
 import org.junit.Test;
 
-public class TestBuiltin extends TestCase {
+public class TestBuiltin {
     
     private String initString = "mapreduce";
     //private String initString = "local";
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     PigServer pigServer;
 
@@ -119,8 +121,8 @@ public class TestBuiltin extends TestCase {
             };
     
     String[] inputTypeAsString = {"ByteArray", "Integer", "Long", "Float", "Double", "String" };
-    
-    @Override
+
+    @Before
     public void setUp() throws Exception {
        
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -267,6 +269,11 @@ public class TestBuiltin extends TestCase {
         }
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     /**
      * Test the case where the combiner is not called - so initial is called
      * and then final is called
diff --git a/test/org/apache/pig/test/TestCharArrayToNumeric.java b/test/org/apache/pig/test/TestCharArrayToNumeric.java
index 98c5ecad7..bd0880db3 100644
--- a/test/org/apache/pig/test/TestCharArrayToNumeric.java
+++ b/test/org/apache/pig/test/TestCharArrayToNumeric.java
@@ -42,8 +42,13 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.plan.NodeIdGenerator;
 import org.apache.pig.impl.plan.OperatorKey;
+import org.junit.AfterClass;
+import org.junit.Before;
+import org.junit.Test;
 
-public class TestCharArrayToNumeric extends TestCase {
+import static org.junit.Assert.*;
+
+public class TestCharArrayToNumeric {
 
 	private Double dummyDouble = null;
 
@@ -69,22 +74,26 @@ public class TestCharArrayToNumeric extends TestCase {
 
 	private Integer MinInteger = Integer.MIN_VALUE;
 	
-	MiniCluster cluster = MiniCluster.buildCluster();
+	static MiniCluster cluster = MiniCluster.buildCluster();
 	PigServer pig;
 	
-	/* (non-Javadoc)
-	 * @see junit.framework.TestCase#setUp()
-	 */
-	@Override
-	protected void setUp() throws Exception {
+
+	@Before
+	public void setUp() throws Exception {
 	    pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 	}
+	
+	@AfterClass
+	public static void oneTimeTearDown() throws Exception {
+	    cluster.shutDown();
+	}
 
 	public static OperatorKey newOperatorKey() {
 		long newId = NodeIdGenerator.getGenerator().getNextNodeId("scope");
 		return new OperatorKey("scope", newId);
 	}
 
+        @Test
 	public void testCast() throws ExecException {
 
 		POCast cast = new POCast(newOperatorKey(), -1);
@@ -161,7 +170,7 @@ public class TestCharArrayToNumeric extends TestCase {
 		}
 	}
 
-
+        @Test
 	public void testCharArray2FloatAndDoubleScript() throws IOException {
 
 		// create a input file with format (key,value)
@@ -200,7 +209,7 @@ public class TestCharArrayToNumeric extends TestCase {
 					if (type == DataType.DOUBLE) {
 						Double expected = map.get(key);
 						if (value != null) {
-							assertEquals(expected, Double.parseDouble(value));
+							assertEquals(expected, (Double)Double.parseDouble(value));
 						} else {
 							assertEquals(expected, null);
 						}
@@ -212,7 +221,7 @@ public class TestCharArrayToNumeric extends TestCase {
 							expected = map.get(key).floatValue();
 						}
 						if (value != null) {
-							assertEquals(expected, Float.parseFloat(value));
+							assertEquals(expected, (Float)Float.parseFloat(value));
 						} else {
 							assertEquals(expected, null);
 						}
@@ -227,6 +236,7 @@ public class TestCharArrayToNumeric extends TestCase {
 		}
 	}
 
+        @Test
 	public void testCharArrayToIntAndLongScript() throws IOException {
 
 		// create a input file with format (key,value)
diff --git a/test/org/apache/pig/test/TestCollectedGroup.java b/test/org/apache/pig/test/TestCollectedGroup.java
index d4ac1b2b6..d2df51e6b 100644
--- a/test/org/apache/pig/test/TestCollectedGroup.java
+++ b/test/org/apache/pig/test/TestCollectedGroup.java
@@ -42,13 +42,18 @@ import org.apache.pig.impl.logicalLayer.LOCogroup;
 import org.apache.pig.impl.logicalLayer.LogicalPlan;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestCollectedGroup extends TestCase {
     private static final String INPUT_FILE = "MapSideGroupInput.txt";
     
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
 
     public TestCollectedGroup() throws ExecException, IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -81,6 +86,7 @@ public class TestCollectedGroup extends TestCase {
         Util.deleteFile(cluster, INPUT_FILE);
     }
     
+    @Test
     public void testNonCollectableLoader() throws Exception{
         LogicalPlanTester lpt = new LogicalPlanTester();
         lpt.buildPlan("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
@@ -95,6 +101,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
 
+    @Test
     public void testCollectedGrpSpecifiedInSingleQuotes1(){
         
         LogicalPlanTester lpt = new LogicalPlanTester();
@@ -103,6 +110,7 @@ public class TestCollectedGroup extends TestCase {
         assertEquals(LOCogroup.GROUPTYPE.COLLECTED, ((LOCogroup)lp.getLeaves().get(0)).getGroupType());
     }
     
+    @Test
     public void testCollectedGrpSpecifiedInSingleQuotes2(){
         
         LogicalPlanTester lpt = new LogicalPlanTester();
@@ -111,14 +119,21 @@ public class TestCollectedGroup extends TestCase {
         assertEquals(LOCogroup.GROUPTYPE.REGULAR, ((LOCogroup)lp.getLeaves().get(0)).getGroupType());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    @Test
     public void testPOMapsideGroupNoNullPlans() throws IOException {
         POCollectedGroup pmg = new POCollectedGroup(new OperatorKey());
         List<PhysicalPlan> plans = pmg.getPlans();
 
         Assert.assertTrue(plans != null);
         Assert.assertTrue(plans.size() == 0);
-    }      
-     
+    }     
+    
+    @Test  
     public void testMapsideGroupParserNoSupportForMultipleInputs() throws IOException {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -134,6 +149,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
     
+    @Test
     public void testMapsideGroupParserNoSupportForGroupAll() throws IOException {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -148,6 +164,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
      
+    @Test
     public void testMapsideGroupParserNoSupportForByExpression() throws IOException {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -162,6 +179,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
 
+    @Test
     public void testMapsideGroupByOneColumn() throws IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -196,6 +214,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
  
+    @Test
     public void testMapsideGroupByMultipleColumns() throws IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -231,6 +250,7 @@ public class TestCollectedGroup extends TestCase {
         }
     }
   
+    @Test
     public void testMapsideGroupByStar() throws IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
diff --git a/test/org/apache/pig/test/TestCombiner.java b/test/org/apache/pig/test/TestCombiner.java
index 257ba74d0..07269ded3 100644
--- a/test/org/apache/pig/test/TestCombiner.java
+++ b/test/org/apache/pig/test/TestCombiner.java
@@ -28,7 +28,10 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.Properties;
 
+import org.junit.AfterClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.Assert;
 import junit.framework.TestCase;
@@ -44,10 +47,17 @@ import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.logicalLayer.LogicalPlan;
 import org.apache.pig.test.utils.LogicalPlanTester;
 
+@RunWith(JUnit4.class)
 public class TestCombiner extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    
     @Test
     public void testSuccessiveUserFuncs1() throws Exception{
         
diff --git a/test/org/apache/pig/test/TestCommit.java b/test/org/apache/pig/test/TestCommit.java
index c00847e28..50ff363bf 100644
--- a/test/org/apache/pig/test/TestCommit.java
+++ b/test/org/apache/pig/test/TestCommit.java
@@ -33,8 +33,11 @@ import java.util.Map;
 import java.util.Random;
 import java.util.StringTokenizer;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.pig.ComparisonFunc;
 import org.apache.pig.EvalFunc;
@@ -56,9 +59,10 @@ import org.apache.pig.test.utils.Identity;
 
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestCommit extends TestCase {
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     TupleFactory mTf = TupleFactory.getInstance();
@@ -69,6 +73,11 @@ public class TestCommit extends TestCase {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testCheckin1() throws Exception{
         Tuple expected1 = mTf.newTuple(2);             
diff --git a/test/org/apache/pig/test/TestCompressedFiles.java b/test/org/apache/pig/test/TestCompressedFiles.java
index 8d1e7305f..d54ffaa0e 100644
--- a/test/org/apache/pig/test/TestCompressedFiles.java
+++ b/test/org/apache/pig/test/TestCompressedFiles.java
@@ -24,8 +24,11 @@ import java.util.Iterator;
 import java.util.Random;
 import java.util.zip.GZIPOutputStream;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pig.ExecType;
@@ -39,16 +42,17 @@ import org.apache.pig.test.utils.TestHelper;
 import junit.framework.Assert;
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestCompressedFiles extends TestCase {
     
     private final Log log = LogFactory.getLog(getClass());
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     File datFile;
     File gzFile;
     @Override
     @Before
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         datFile = File.createTempFile("compTest", ".dat");
         gzFile = File.createTempFile("compTest", ".gz");
         FileOutputStream dat = new FileOutputStream(datFile);
@@ -72,11 +76,16 @@ public class TestCompressedFiles extends TestCase {
 
     @Override
     @After
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         datFile.delete();
         gzFile.delete();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testCompressed1() throws Throwable {
         PigServer pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
diff --git a/test/org/apache/pig/test/TestCounters.java b/test/org/apache/pig/test/TestCounters.java
index 432a8a522..955385311 100644
--- a/test/org/apache/pig/test/TestCounters.java
+++ b/test/org/apache/pig/test/TestCounters.java
@@ -37,16 +37,25 @@ import org.apache.pig.backend.executionengine.ExecJob;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.apache.pig.tools.pigstats.PigStatsUtil;
+import org.junit.AfterClass;
 import org.junit.Test;
-
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+@RunWith(JUnit4.class)
 public class TestCounters extends TestCase {
     String file = "input.txt";
 
-    MiniCluster cluster = MiniCluster.buildCluster();
-
+    static MiniCluster cluster = MiniCluster.buildCluster();
+    
     final int MAX = 100*1000;
     Random r = new Random();
 
+
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testMapOnly() throws IOException, ExecException {
         int count = 0;
diff --git a/test/org/apache/pig/test/TestDataBagAccess.java b/test/org/apache/pig/test/TestDataBagAccess.java
index 456b39750..c8af4e49b 100644
--- a/test/org/apache/pig/test/TestDataBagAccess.java
+++ b/test/org/apache/pig/test/TestDataBagAccess.java
@@ -37,17 +37,21 @@ import org.apache.pig.data.NonSpillableDataBag;
 import org.apache.pig.data.SingleTupleBag;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.util.MultiMap;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
 /**
  *
  */
+@RunWith(JUnit4.class)
 public class TestDataBagAccess extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     @Before
@@ -56,6 +60,11 @@ public class TestDataBagAccess extends TestCase {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testSingleTupleBagAcess() throws Exception {
         Tuple inputTuple = new DefaultTuple();
diff --git a/test/org/apache/pig/test/TestEvalPipeline.java b/test/org/apache/pig/test/TestEvalPipeline.java
index db677ea08..f7cfb1be7 100644
--- a/test/org/apache/pig/test/TestEvalPipeline.java
+++ b/test/org/apache/pig/test/TestEvalPipeline.java
@@ -56,12 +56,16 @@ import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.util.Pair;
 import org.apache.pig.test.utils.GenRandomData;
 import org.apache.pig.test.utils.Identity;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestEvalPipeline extends TestCase {
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
     private PigContext pigContext;
 
@@ -77,6 +81,11 @@ public class TestEvalPipeline extends TestCase {
         pigContext = pigServer.getPigContext();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     static public class MyBagFunction extends EvalFunc<DataBag>{
         @Override
         public DataBag exec(Tuple input) throws IOException {
@@ -129,7 +138,7 @@ public class TestEvalPipeline extends TestCase {
     
     @Test
     public void testDriverMethod() throws Exception{
-        File f = File.createTempFile("tmp", "");
+        File f = Util.createTempFileDelOnExit("tmp", "");
         PrintWriter pw = new PrintWriter(f);
         pw.println("a");
         pw.println("a");
@@ -165,7 +174,7 @@ public class TestEvalPipeline extends TestCase {
         t.append(weights);
         b.add(t);
         
-        File tmpFile = File.createTempFile("tmp", "");
+        File tmpFile = Util.createTempFileDelOnExit("tmp", "");
         tmpFile.deleteOnExit();
         String fileName = tmpFile.getAbsolutePath();
         PigFile f = new PigFile(fileName);
@@ -364,7 +373,7 @@ public class TestEvalPipeline extends TestCase {
 
     private void testSortDistinct(boolean eliminateDuplicates, boolean useUDF) throws Exception{
         int LOOP_SIZE = 1024*16;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_SIZE; i++) {
@@ -401,9 +410,10 @@ public class TestEvalPipeline extends TestCase {
         }        
     }
     
+    @Test
     public void testNestedPlan() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -440,9 +450,10 @@ public class TestEvalPipeline extends TestCase {
         assertEquals(LOOP_COUNT, numIdentity);
     }
 
+    @Test
     public void testNestedPlanWithExpressionAssignment() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -484,9 +495,10 @@ public class TestEvalPipeline extends TestCase {
         assertEquals(LOOP_COUNT, numIdentity);
     }
 
+    @Test
     public void testLimit() throws Exception{
         int LOOP_COUNT = 20;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             ps.println(i);
@@ -731,9 +743,10 @@ public class TestEvalPipeline extends TestCase {
         
     }
 
+    @Test
     public void testMapUDF() throws Exception{
         int LOOP_COUNT = 2;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -770,9 +783,10 @@ public class TestEvalPipeline extends TestCase {
         assertEquals(LOOP_COUNT * LOOP_COUNT, numIdentity);
     }
 
+    @Test
     public void testMapUDFFail() throws Exception{
         int LOOP_COUNT = 2;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -818,7 +832,7 @@ public class TestEvalPipeline extends TestCase {
     @Test
     public void testNestedPlanForCloning() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -860,7 +874,7 @@ public class TestEvalPipeline extends TestCase {
     @Test
     public void testArithmeticCloning() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -907,7 +921,7 @@ public class TestEvalPipeline extends TestCase {
     @Test
     public void testExpressionReUse() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -948,7 +962,7 @@ public class TestEvalPipeline extends TestCase {
     @Test
     public void testIdentity() throws Exception{
         int LOOP_COUNT = 2;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
diff --git a/test/org/apache/pig/test/TestEvalPipeline2.java b/test/org/apache/pig/test/TestEvalPipeline2.java
index e33c683f4..36636b824 100644
--- a/test/org/apache/pig/test/TestEvalPipeline2.java
+++ b/test/org/apache/pig/test/TestEvalPipeline2.java
@@ -37,12 +37,16 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.test.utils.Identity;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestEvalPipeline2 extends TestCase {
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     TupleFactory mTf = TupleFactory.getInstance();
@@ -56,6 +60,11 @@ public class TestEvalPipeline2 extends TestCase {
 //        pigServer = new PigServer(ExecType.LOCAL);
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testUdfInputOrder() throws IOException {
         String[] input = {
@@ -89,7 +98,7 @@ public class TestEvalPipeline2 extends TestCase {
     @Test
     public void testUDFwithStarInput() throws Exception {
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             for(int j=0;j<LOOP_COUNT;j+=2){
@@ -317,14 +326,14 @@ public class TestEvalPipeline2 extends TestCase {
             numRows++;
         }
         assertEquals(3, numRows);
-        
+        Util.deleteFile(cluster, "testPigStorageWithCtrlCharsInput.txt");
     }
 
     @Test
     // Test case added for PIG-850
     public void testLimitedSortWithDump() throws Exception{
         int LOOP_COUNT = 40;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random(1);
         int rand;
@@ -353,7 +362,7 @@ public class TestEvalPipeline2 extends TestCase {
     @Test
     public void testLimitAfterSort() throws Exception{
         int LOOP_COUNT = 40;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random(1);
         int rand;
@@ -386,7 +395,7 @@ public class TestEvalPipeline2 extends TestCase {
     @Test
     public void testLimitAfterSortDesc() throws Exception{
         int LOOP_COUNT = 40;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random(1);
         int rand;
@@ -419,7 +428,7 @@ public class TestEvalPipeline2 extends TestCase {
     @Test
     // See PIG-894
     public void testEmptySort() throws Exception{
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         pigServer.registerQuery("A = LOAD '"
                 + Util.generateURI(tmpFile.toString(), pigServer
                         .getPigContext()) + "';");
@@ -432,13 +441,13 @@ public class TestEvalPipeline2 extends TestCase {
     // See PIG-761
     @Test
     public void testLimitPOPackageAnnotator() throws Exception{
-        File tmpFile1 = File.createTempFile("test1", "txt");
+        File tmpFile1 = Util.createTempFileDelOnExit("test1", "txt");
         PrintStream ps1 = new PrintStream(new FileOutputStream(tmpFile1));
         ps1.println("1\t2\t3");
         ps1.println("2\t5\t2");
         ps1.close();
         
-        File tmpFile2 = File.createTempFile("test2", "txt");
+        File tmpFile2 = Util.createTempFileDelOnExit("test2", "txt");
         PrintStream ps2 = new PrintStream(new FileOutputStream(tmpFile2));
         ps2.println("1\t1");
         ps2.println("2\t2");
diff --git a/test/org/apache/pig/test/TestEvalPipelineLocal.java b/test/org/apache/pig/test/TestEvalPipelineLocal.java
index 46fee9921..5272e24e6 100644
--- a/test/org/apache/pig/test/TestEvalPipelineLocal.java
+++ b/test/org/apache/pig/test/TestEvalPipelineLocal.java
@@ -59,7 +59,6 @@ import org.junit.Test;
 
 public class TestEvalPipelineLocal extends TestCase {
     
-    //MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     TupleFactory mTf = TupleFactory.getInstance();
@@ -93,6 +92,7 @@ public class TestEvalPipelineLocal extends TestCase {
             pw.println(data[i]);
         }
         pw.close();
+        f.deleteOnExit();
         return f;
     }
     
@@ -385,7 +385,7 @@ public class TestEvalPipelineLocal extends TestCase {
 
     private void testSortDistinct(boolean eliminateDuplicates, boolean useUDF) throws Exception{
         int LOOP_SIZE = 1024*16;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_SIZE; i++) {
@@ -431,7 +431,7 @@ public class TestEvalPipelineLocal extends TestCase {
     
     public void testNestedPlan() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_COUNT; i++) {
@@ -474,7 +474,7 @@ public class TestEvalPipelineLocal extends TestCase {
 
     public void testNestedPlanWithExpressionAssignment() throws Exception{
         int LOOP_COUNT = 10;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_COUNT; i++) {
@@ -522,7 +522,7 @@ public class TestEvalPipelineLocal extends TestCase {
 
     public void testLimit() throws Exception{
         int LOOP_COUNT = 20;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_COUNT; i++) {
@@ -773,7 +773,7 @@ public class TestEvalPipelineLocal extends TestCase {
 
     public void testMapUDF() throws Exception{
         int LOOP_COUNT = 2;
-        File tmpFile = File.createTempFile("test", "txt");
+        File tmpFile = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         Random r = new Random();
         for(int i = 0; i < LOOP_COUNT; i++) {
diff --git a/test/org/apache/pig/test/TestExampleGenerator.java b/test/org/apache/pig/test/TestExampleGenerator.java
index 1c78b2aff..2dee27b56 100644
--- a/test/org/apache/pig/test/TestExampleGenerator.java
+++ b/test/org/apache/pig/test/TestExampleGenerator.java
@@ -33,12 +33,16 @@ import org.apache.pig.data.DataBag;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.logicalLayer.LogicalOperator;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestExampleGenerator extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     PigContext pigContext = new PigContext(ExecType.MAPREDUCE, cluster
             .getProperties());
 
@@ -69,7 +73,15 @@ public class TestExampleGenerator extends TestCase {
         B = "'" + FileLocalizer.hadoopify(fileB.toString(), pigContext) + "'";
         System.out.println("A : " + A + "\n" + "B : " + B);
         System.out.println("Test data created.");
+        fileA.deleteOnExit();
+        fileB.deleteOnExit();
+          
+    }
 
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
     }
 
     private void writeData(File dataFile) throws Exception {
diff --git a/test/org/apache/pig/test/TestFRJoin.java b/test/org/apache/pig/test/TestFRJoin.java
index a49d69898..e65f9b8ac 100644
--- a/test/org/apache/pig/test/TestFRJoin.java
+++ b/test/org/apache/pig/test/TestFRJoin.java
@@ -54,14 +54,18 @@ import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.plan.OperatorKey;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestFRJoin extends TestCase{
     private static final String INPUT_FILE = "testFrJoinInput.txt";
     private static final String INPUT_FILE2 = "testFrJoinInput2.txt";
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     private File tmpFile;
     
     public TestFRJoin() throws ExecException, IOException{
@@ -92,6 +96,11 @@ public class TestFRJoin extends TestCase{
         Util.createInputFile(cluster, INPUT_FILE2, input2);
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @After
     public void tearDown() throws Exception {
         Util.deleteFile(cluster, INPUT_FILE);
@@ -160,6 +169,7 @@ public class TestFRJoin extends TestCase{
         
     }
     
+    @Test
     public void testSortFRJoin() throws IOException{
       pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
       pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
@@ -186,6 +196,7 @@ public class TestFRJoin extends TestCase{
       Assert.assertEquals(true, TestHelper.compareBags(dbfrj, dbshj));        
     }
     
+    @Test
     public void testDistinctFRJoin() throws IOException{
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
diff --git a/test/org/apache/pig/test/TestFilterOpNumeric.java b/test/org/apache/pig/test/TestFilterOpNumeric.java
index 12ea1b4ed..6326bb88e 100644
--- a/test/org/apache/pig/test/TestFilterOpNumeric.java
+++ b/test/org/apache/pig/test/TestFilterOpNumeric.java
@@ -22,8 +22,11 @@ import java.io.FileOutputStream;
 import java.io.PrintStream;
 import java.util.Iterator;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -33,22 +36,26 @@ import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.data.Tuple;
 
 import junit.framework.TestCase;
-
+@RunWith(JUnit4.class)
 public class TestFilterOpNumeric extends TestCase {
 
     private final Log log = LogFactory.getLog(getClass());
 
     private static int LOOP_COUNT = 1024;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pig;
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
 
-
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testNumericEq() throws Throwable {
         File tmpFile = File.createTempFile("test", "txt");
diff --git a/test/org/apache/pig/test/TestFilterOpString.java b/test/org/apache/pig/test/TestFilterOpString.java
index b72e9a79a..b65965fd4 100644
--- a/test/org/apache/pig/test/TestFilterOpString.java
+++ b/test/org/apache/pig/test/TestFilterOpString.java
@@ -22,8 +22,11 @@ import java.io.FileOutputStream;
 import java.io.PrintStream;
 import java.util.Iterator;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -35,23 +38,27 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
 
 import junit.framework.TestCase;
-
+@RunWith(JUnit4.class)
 public class TestFilterOpString extends TestCase {
 
     private final Log log = LogFactory.getLog(getClass());
     private static int LOOP_COUNT = 1024;    
-    MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig;
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         FileLocalizer.deleteTempFiles();
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
 
-
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testStringEq() throws Throwable {
         File tmpFile = File.createTempFile("test", "txt");
diff --git a/test/org/apache/pig/test/TestFilterUDF.java b/test/org/apache/pig/test/TestFilterUDF.java
index 7d8e2d86e..1020c13c8 100644
--- a/test/org/apache/pig/test/TestFilterUDF.java
+++ b/test/org/apache/pig/test/TestFilterUDF.java
@@ -18,6 +18,8 @@
 package org.apache.pig.test;
 
 
+import static org.junit.Assert.*;
+
 import java.io.File;
 import java.io.FileOutputStream;
 import java.io.IOException;
@@ -36,12 +38,15 @@ import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.test.utils.FILTERFROMFILE;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
-public class TestFilterUDF extends TestCase {
+public class TestFilterUDF {
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     private File tmpFile;
     
     TupleFactory tf = TupleFactory.getInstance();
@@ -73,6 +78,11 @@ public class TestFilterUDF extends TestCase {
         tmpFile.delete();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private File createFile(String[] data) throws Exception{
         File f = File.createTempFile("tmp", "");
         PrintWriter pw = new PrintWriter(f);
diff --git a/test/org/apache/pig/test/TestFinish.java b/test/org/apache/pig/test/TestFinish.java
index 78e4e17b5..f169e5955 100644
--- a/test/org/apache/pig/test/TestFinish.java
+++ b/test/org/apache/pig/test/TestFinish.java
@@ -38,9 +38,12 @@ import org.apache.pig.data.BagFactory;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.io.FileLocalizer;
+import org.junit.AfterClass;
+import org.junit.Before;
 import org.junit.Test;
+import static org.junit.Assert.*;
 
-public class TestFinish extends TestCase {
+public class TestFinish {
 
     private PigServer pigServer;
 
@@ -48,7 +51,7 @@ public class TestFinish extends TestCase {
     BagFactory mBf = BagFactory.getInstance();
     File f1;
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     static public class MyEvalFunction extends EvalFunc<Tuple>{
         
@@ -78,14 +81,19 @@ public class TestFinish extends TestCase {
         }
     }
     
-    @Override
-    protected void setUp() throws Exception {
+    @Before
+    public void setUp() throws Exception {
         // re initialize FileLocalizer so that each test runs correctly without
         // any side effect of other tests - this is needed here since some
         // tests are in mapred and some in local mode
         FileLocalizer.setInitialized(false);
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private String setUp(ExecType execType) throws Exception{
         String inputFileName;
         if(execType == ExecType.LOCAL) {
diff --git a/test/org/apache/pig/test/TestForEachNestedPlan.java b/test/org/apache/pig/test/TestForEachNestedPlan.java
index 02822ad60..2044b93d7 100644
--- a/test/org/apache/pig/test/TestForEachNestedPlan.java
+++ b/test/org/apache/pig/test/TestForEachNestedPlan.java
@@ -18,28 +18,30 @@
 
 package org.apache.pig.test;
 
-import org.apache.pig.ExecType;
-import org.apache.pig.PigServer;
-import org.apache.pig.ExecType;
-import org.apache.pig.test.utils.TestHelper;
-import org.apache.pig.data.Tuple;
-import org.apache.pig.impl.logicalLayer.parser.ParseException;
-import org.junit.Test;
-import junit.framework.TestCase;
-import junit.framework.Assert;
+import static org.junit.Assert.*;
 
-import java.util.Iterator;
-import java.util.List;
-import java.util.Random;
 import java.io.File;
 import java.io.FileWriter;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.text.DecimalFormat;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Random;
+
+import junit.framework.Assert;
+
+import org.apache.pig.ExecType;
+import org.apache.pig.PigServer;
+import org.apache.pig.data.Tuple;
+import org.apache.pig.impl.logicalLayer.parser.ParseException;
+import org.apache.pig.test.utils.TestHelper;
+import org.junit.AfterClass;
+import org.junit.Test;
 
-public class TestForEachNestedPlan extends TestCase {
+public class TestForEachNestedPlan {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig ;
 
@@ -49,6 +51,11 @@ public class TestForEachNestedPlan extends TestCase {
 
     Boolean[] nullFlags = new Boolean[]{ false, true };
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testInnerOrderBy() throws Exception {
         for (int i = 0; i < nullFlags.length; i++) {
diff --git a/test/org/apache/pig/test/TestForEachNestedPlanLocal.java b/test/org/apache/pig/test/TestForEachNestedPlanLocal.java
index 5f97d404b..ef363f5ab 100644
--- a/test/org/apache/pig/test/TestForEachNestedPlanLocal.java
+++ b/test/org/apache/pig/test/TestForEachNestedPlanLocal.java
@@ -33,7 +33,6 @@ import java.text.DecimalFormat;
 public class TestForEachNestedPlanLocal extends TestCase {
 
     private String initString = "local";
-    //MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig ;
 
diff --git a/test/org/apache/pig/test/TestGrunt.java b/test/org/apache/pig/test/TestGrunt.java
index 00ad03704..ce352bb7e 100644
--- a/test/org/apache/pig/test/TestGrunt.java
+++ b/test/org/apache/pig/test/TestGrunt.java
@@ -17,7 +17,12 @@
  */
 package org.apache.pig.test;
 
+import org.junit.AfterClass;
+import org.junit.BeforeClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+
 import junit.framework.TestCase;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -44,18 +49,23 @@ import java.io.StringReader;
 import java.io.StringWriter;
 import java.util.ArrayList;
 
+@RunWith(JUnit4.class)
 public class TestGrunt extends TestCase {
-    MiniCluster cluster = MiniCluster.buildCluster();
-    private String basedir;
+    static MiniCluster cluster = MiniCluster.buildCluster();
+    private String basedir = "test/org/apache/pig/test/data";
 
     private final Log log = LogFactory.getLog(getClass());
 
-    public TestGrunt(String name) {
-        super(name);
+    @BeforeClass
+    public static void oneTimeSetup() throws Exception {
         cluster.setProperty("opt.multiquery","true");
-        basedir = "test/org/apache/pig/test/data";
     }
-    
+
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+        
 /*    
     @Test 
     public void testCopyFromLocal() throws Throwable {
@@ -802,6 +812,7 @@ public class TestGrunt extends TestCase {
         assertTrue(caught);
     }
     
+    @Test
     public void testFsCommand(){
         
         try {
@@ -837,6 +848,7 @@ public class TestGrunt extends TestCase {
         }
     }
    
+    @Test
     public void testSetPriority() throws Throwable {
         PigServer server = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         PigContext context = server.getPigContext();
@@ -852,6 +864,7 @@ public class TestGrunt extends TestCase {
         assertEquals("high", context.getProperties().getProperty(PigContext.JOB_PRIORITY));
     }
     
+    @Test
     public void testSetWithQuotes() throws Throwable {
         PigServer server = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         PigContext context = server.getPigContext();
@@ -867,6 +880,7 @@ public class TestGrunt extends TestCase {
         assertEquals("high", context.getProperties().getProperty(PigContext.JOB_PRIORITY));
     }
     
+    @Test    
     public void testRegisterWithQuotes() throws Throwable {
         PigServer server = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         PigContext context = server.getPigContext();
@@ -882,6 +896,7 @@ public class TestGrunt extends TestCase {
         assertTrue(context.extraJars.contains(ClassLoader.getSystemResource("pig-withouthadoop.jar")));
     }
     
+    @Test    
     public void testRegisterWithoutQuotes() throws Throwable {
         PigServer server = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         PigContext context = server.getPigContext();
@@ -897,6 +912,7 @@ public class TestGrunt extends TestCase {
         assertTrue(context.extraJars.contains(ClassLoader.getSystemResource("pig-withouthadoop.jar")));
     }
     
+    @Test    
     public void testScriptMissingLastNewLine() throws Throwable {   
         PigServer server = new PigServer(ExecType.LOCAL);
         PigContext context = server.getPigContext();
diff --git a/test/org/apache/pig/test/TestHBaseStorage.java b/test/org/apache/pig/test/TestHBaseStorage.java
index a2530edf4..d1e538d0c 100644
--- a/test/org/apache/pig/test/TestHBaseStorage.java
+++ b/test/org/apache/pig/test/TestHBaseStorage.java
@@ -46,16 +46,21 @@ import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;
 import org.apache.pig.data.DataByteArray;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
+import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 /** {@link org.apache.pig.backend.hadoop.hbase.HBaseStorage} Test Case **/
+@RunWith(JUnit4.class)
 public class TestHBaseStorage extends TestCase {
 
     private static final Log LOG =
         LogFactory.getLog(TestHBaseStorage.class);
     
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     private HBaseConfiguration conf;
     private MiniHBaseCluster hbaseCluster;
     private MiniZooKeeperCluster zooKeeperCluster;
@@ -76,7 +81,7 @@ public class TestHBaseStorage extends TestCase {
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         super.setUp();
         
         conf = new HBaseConfiguration(ConfigurationUtil.
@@ -107,6 +112,11 @@ public class TestHBaseStorage extends TestCase {
         pig = new PigServer(ExecType.MAPREDUCE, ConfigurationUtil.toProperties(conf));
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     /**
      * Actually start the MiniHBase instance.
      */
@@ -129,7 +139,8 @@ public class TestHBaseStorage extends TestCase {
     }
 
     @Override
-    protected void tearDown() throws Exception {
+    @After
+    public void tearDown() throws Exception {
         // clear the table
         deleteTable();
         super.tearDown();
diff --git a/test/org/apache/pig/test/TestImplicitSplit.java b/test/org/apache/pig/test/TestImplicitSplit.java
index af5630836..c62a726ed 100644
--- a/test/org/apache/pig/test/TestImplicitSplit.java
+++ b/test/org/apache/pig/test/TestImplicitSplit.java
@@ -20,6 +20,7 @@ package org.apache.pig.test;
 
 import static org.apache.pig.test.utils.TypeCheckingTestUtil.printMessageCollector;
 import static org.apache.pig.test.utils.TypeCheckingTestUtil.printTypeGraph;
+import static org.junit.Assert.*;
 
 import java.io.File;
 import java.io.FileOutputStream;
@@ -39,12 +40,13 @@ import org.apache.pig.impl.logicalLayer.validators.TypeCheckingValidator;
 import org.apache.pig.impl.plan.CompilationMessageCollector;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
 
-public class TestImplicitSplit extends TestCase{
+public class TestImplicitSplit {
     private PigServer pigServer;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     @Before
     public void setUp() throws Exception {
@@ -55,6 +57,11 @@ public class TestImplicitSplit extends TestCase{
     public void tearDown() throws Exception {
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testImplicitSplit() throws Exception{
         int LOOP_SIZE = 20;
diff --git a/test/org/apache/pig/test/TestInfixArithmetic.java b/test/org/apache/pig/test/TestInfixArithmetic.java
index 82e0118b9..cdf6948ac 100644
--- a/test/org/apache/pig/test/TestInfixArithmetic.java
+++ b/test/org/apache/pig/test/TestInfixArithmetic.java
@@ -23,8 +23,11 @@ import java.io.PrintStream;
 import java.util.Iterator;
 import java.util.Random;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -38,21 +41,27 @@ import org.apache.pig.data.Tuple;
 
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestInfixArithmetic extends TestCase {
 
     private final Log log = LogFactory.getLog(getClass());
 
     private static int LOOP_COUNT = 1024;    
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig;
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     Boolean[] nullFlags = new Boolean[] { false, true };
 
     @Test
diff --git a/test/org/apache/pig/test/TestInputOutputFileValidator.java b/test/org/apache/pig/test/TestInputOutputFileValidator.java
index 6d768221b..4782845d4 100644
--- a/test/org/apache/pig/test/TestInputOutputFileValidator.java
+++ b/test/org/apache/pig/test/TestInputOutputFileValidator.java
@@ -43,15 +43,23 @@ import org.apache.pig.impl.logicalLayer.validators.* ;
 import org.apache.pig.impl.plan.CompilationMessageCollector;
 import org.apache.pig.impl.plan.CompilationMessageCollector.MessageType; 
 import org.apache.pig.impl.util.LogUtils;
+import org.junit.AfterClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.Assert;
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestInputOutputFileValidator extends TestCase {
     
     
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     
     @Test
     public void testLocalModeInputPositive() throws Throwable {
diff --git a/test/org/apache/pig/test/TestJobSubmission.java b/test/org/apache/pig/test/TestJobSubmission.java
index da3843fd4..67af41beb 100644
--- a/test/org/apache/pig/test/TestJobSubmission.java
+++ b/test/org/apache/pig/test/TestJobSubmission.java
@@ -79,9 +79,13 @@ import org.apache.pig.test.utils.GenRandomData;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestJobSubmission extends junit.framework.TestCase{
     
     
@@ -96,9 +100,10 @@ public class TestJobSubmission extends junit.framework.TestCase{
     String curDir;
     String inpDir;
     String golDir;
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     static {
-        MiniCluster cluster = MiniCluster.buildCluster();
+
         pc = new PigContext(ExecType.MAPREDUCE, cluster.getProperties());
         try {
             pc.connect();
@@ -124,6 +129,11 @@ public class TestJobSubmission extends junit.framework.TestCase{
     public void tearDown() throws Exception {
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
 /*    private void generateInput(int numTuples) throws ExecException{
         
         DataBag inpDb = GenRandomData.genRandSmallTupDataBag(r, numTuples, 1000);
diff --git a/test/org/apache/pig/test/TestJoin.java b/test/org/apache/pig/test/TestJoin.java
index ab0dd3bda..706df8ffc 100644
--- a/test/org/apache/pig/test/TestJoin.java
+++ b/test/org/apache/pig/test/TestJoin.java
@@ -39,17 +39,22 @@ import org.apache.pig.impl.logicalLayer.parser.ParseException;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.test.utils.LogicalPlanTester;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
 /**
  * Test cases to test join statement
  */
+
+@RunWith(JUnit4.class)
 public class TestJoin extends TestCase {
     
-    MiniCluster cluster;
+    static MiniCluster cluster;
     private PigServer pigServer;
 
     TupleFactory mTf = TupleFactory.getInstance();
@@ -62,6 +67,10 @@ public class TestJoin extends TestCase {
         FileLocalizer.setR(new Random());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     
     private void setUp(ExecType execType) throws ExecException {
         // cause a reinitialization of FileLocalizer's
diff --git a/test/org/apache/pig/test/TestKeyTypeDiscoveryVisitor.java b/test/org/apache/pig/test/TestKeyTypeDiscoveryVisitor.java
index 2702bceb1..2bbeca183 100644
--- a/test/org/apache/pig/test/TestKeyTypeDiscoveryVisitor.java
+++ b/test/org/apache/pig/test/TestKeyTypeDiscoveryVisitor.java
@@ -27,8 +27,11 @@ import org.apache.pig.data.BagFactory;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.io.FileLocalizer;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
@@ -37,9 +40,10 @@ import junit.framework.TestCase;
  * is correctly determines for use when the key is null. In 
  * particular it tests KeyTypeDiscoveryVisitor
  */
+@RunWith(JUnit4.class)
 public class TestKeyTypeDiscoveryVisitor extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     TupleFactory mTf = TupleFactory.getInstance();
@@ -49,6 +53,11 @@ public class TestKeyTypeDiscoveryVisitor extends TestCase {
     public void setUp() throws Exception{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
+   
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     
     @Test
     public void testNullJoin() throws Exception {
diff --git a/test/org/apache/pig/test/TestLargeFile.java b/test/org/apache/pig/test/TestLargeFile.java
index 962329f89..6c0c5ec6a 100644
--- a/test/org/apache/pig/test/TestLargeFile.java
+++ b/test/org/apache/pig/test/TestLargeFile.java
@@ -27,8 +27,12 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
 
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+
 import junit.framework.TestCase;
 
 import java.io.File;
@@ -44,6 +48,7 @@ import org.apache.hadoop.conf.Configuration;
 //Order and Distinct functions are also tested.
 //This test would take a long time because of the large test files.
 
+@RunWith(JUnit4.class)
 public class TestLargeFile extends TestCase {
     
     File datFile;
@@ -53,7 +58,7 @@ public class TestLargeFile extends TestCase {
     private long total = defaultBlockSize >> 1;
     private int max_rand = 500;
 //    private double sum = 0.0, sumIn = 0.0;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     Integer [] COUNT = new Integer[max_rand];
 
@@ -63,7 +68,7 @@ public class TestLargeFile extends TestCase {
     
     @Override
     @Before
-    protected void setUp() throws Exception{
+    public void setUp() throws Exception{
 
         System.out.println("Generating test data...");
         System.out.println("Default block size = " + defaultBlockSize);
@@ -105,12 +110,16 @@ public class TestLargeFile extends TestCase {
     
     @Override
     @After
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
 
         
     }
 
-
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testLargeFile () throws Exception {
         System.out.println("Running testLargeFile...");
diff --git a/test/org/apache/pig/test/TestLimitAdjuster.java b/test/org/apache/pig/test/TestLimitAdjuster.java
index 42ac974ca..41ee54ece 100644
--- a/test/org/apache/pig/test/TestLimitAdjuster.java
+++ b/test/org/apache/pig/test/TestLimitAdjuster.java
@@ -28,6 +28,7 @@ import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.data.Tuple;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
 
@@ -46,6 +47,11 @@ public class TestLimitAdjuster {
     public void tearDown() throws Exception {
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void simpleTest() throws Exception {
         String INPUT_FILE = "input";
diff --git a/test/org/apache/pig/test/TestLoad.java b/test/org/apache/pig/test/TestLoad.java
index ae1659121..8f7628199 100644
--- a/test/org/apache/pig/test/TestLoad.java
+++ b/test/org/apache/pig/test/TestLoad.java
@@ -60,9 +60,13 @@ import org.apache.pig.test.utils.GenPhyOp;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestLoad extends junit.framework.TestCase {
 
     PigContext pc;
@@ -119,6 +123,11 @@ public class TestLoad extends junit.framework.TestCase {
         assertEquals(true, size==inpDB.size());
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testLoadRemoteRel() throws Exception {
         for (PigServer pig : servers) {
diff --git a/test/org/apache/pig/test/TestLocal.java b/test/org/apache/pig/test/TestLocal.java
index d0cad4a7c..5680196b3 100644
--- a/test/org/apache/pig/test/TestLocal.java
+++ b/test/org/apache/pig/test/TestLocal.java
@@ -50,7 +50,6 @@ public class TestLocal extends TestCase {
 
     private Log log = LogFactory.getLog(getClass());
     
-    //MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig;
     
@@ -224,7 +223,7 @@ public class TestLocal extends TestCase {
         try {
             pig.deleteFile("frog");
         } catch(Exception e) {}
-
+        tmpFile.delete();
 
     }
 
@@ -277,7 +276,7 @@ public class TestLocal extends TestCase {
         try {
             pig.deleteFile("frog");
         } catch(Exception e) {}
-
+        tmpFile.delete();
 
     }
 
@@ -314,6 +313,7 @@ public class TestLocal extends TestCase {
         }
 
         assertEquals( MyStorage.COUNT, count );
+        tmpFile.delete();
     }
     
     @Test
@@ -352,6 +352,7 @@ public class TestLocal extends TestCase {
         }
 
         assertEquals( MyStorage.COUNT, count );
+        tmpFile.delete();
     }
     
 
diff --git a/test/org/apache/pig/test/TestLocal2.java b/test/org/apache/pig/test/TestLocal2.java
index b9a4ec1bf..4b44ce0ba 100644
--- a/test/org/apache/pig/test/TestLocal2.java
+++ b/test/org/apache/pig/test/TestLocal2.java
@@ -39,7 +39,6 @@ import java.util.Iterator;
 public class TestLocal2 extends TestCase {
 
     private String initString = "local";
-    //MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig ;
 
@@ -133,6 +132,7 @@ public class TestLocal2 extends TestCase {
         Iterator<Tuple> iter = pig.openIterator("C");
         // Before PIG-800 was fixed this went into an infinite loop, so just
         // managing to open the iterator is sufficient.
+        fp1.delete();
         
     }
     
@@ -155,6 +155,7 @@ public class TestLocal2 extends TestCase {
         Iterator<Tuple> iter = pig.openIterator("C");
         // Before PIG-800 was fixed this went into an infinite loop, so just
         // managing to open the iterator is sufficient.
+        fp1.delete();
         
     }
     
@@ -200,6 +201,7 @@ public class TestLocal2 extends TestCase {
         assertTrue(t.get(3).equals(new Integer(2)));
         
         assertTrue(!iter.hasNext());
+        fp1.delete();
     }
     
     
@@ -272,7 +274,9 @@ public class TestLocal2 extends TestCase {
             }
 
         }
-        return TestHelper.createTempFile(data) ;
+        File tmpFile = TestHelper.createTempFile(data) ;
+        tmpFile.deleteOnExit();
+        return tmpFile;
     }
 
 }
diff --git a/test/org/apache/pig/test/TestLocalPOSplit.java b/test/org/apache/pig/test/TestLocalPOSplit.java
index d74312d17..69c25568f 100644
--- a/test/org/apache/pig/test/TestLocalPOSplit.java
+++ b/test/org/apache/pig/test/TestLocalPOSplit.java
@@ -134,6 +134,7 @@ public class TestLocalPOSplit extends TestCase {
                 assertEquals(t.get(0), firstValue);
             }
         }
+        datFile.delete();
     }
 
     @Test
@@ -141,20 +142,20 @@ public class TestLocalPOSplit extends TestCase {
         init();
 
         pigContext.connect();
-        File datFile = File.createTempFile("tempN1", ".dat");
-        String path1 = Util.encodeEscape(datFile.getAbsolutePath());
+        File datFile1 = File.createTempFile("tempN1", ".dat");
+        String path1 = Util.encodeEscape(datFile1.getAbsolutePath());
 
-        FileOutputStream dat = new FileOutputStream(datFile);
+        FileOutputStream dat = new FileOutputStream(datFile1);
         String s1 = "1\n2\n3\n42\n4\n5\n";
         dat.write(s1.getBytes());
         dat.close();
 
         String s2 = "1\n2\n43\n3\n4\n5\n";
 
-        datFile = File.createTempFile("tempN2", ".dat");
-        String path2 = Util.encodeEscape(datFile.getAbsolutePath());
+        File datFile2 = File.createTempFile("tempN2", ".dat");
+        String path2 = Util.encodeEscape(datFile2.getAbsolutePath());
                 
-        dat = new FileOutputStream(datFile);
+        dat = new FileOutputStream(datFile2);
         dat.write(s2.getBytes());
         dat.close();
 
@@ -204,6 +205,8 @@ public class TestLocalPOSplit extends TestCase {
         for (Integer j: seen.values()) {
             assertEquals(j, new Integer(2));
         }
+        datFile1.delete();
+        datFile2.delete();
     }
 
     public PhysicalPlan buildPhysicalPlan(LogicalPlan lp)
diff --git a/test/org/apache/pig/test/TestLocalRearrange.java b/test/org/apache/pig/test/TestLocalRearrange.java
index f33e07055..b4714635c 100644
--- a/test/org/apache/pig/test/TestLocalRearrange.java
+++ b/test/org/apache/pig/test/TestLocalRearrange.java
@@ -17,6 +17,8 @@
  */
 package org.apache.pig.test;
 
+import static org.junit.Assert.*;
+
 import java.io.File;
 import java.io.FileWriter;
 import java.io.IOException;
@@ -31,24 +33,23 @@ import junit.framework.Assert;
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecException;
-import org.apache.pig.backend.executionengine.ExecJob;
-import org.apache.pig.data.DataBag;
-import org.apache.pig.data.DataType;
-import org.apache.pig.data.DefaultTuple;
-import org.apache.pig.data.Tuple;
-import org.apache.pig.data.TupleFactory;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.POStatus;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLocalRearrange;
-import org.apache.pig.impl.io.NullableTuple;
+import org.apache.pig.data.DataBag;
+import org.apache.pig.data.DataType;
+import org.apache.pig.data.DefaultTuple;
+import org.apache.pig.data.Tuple;
+import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.plan.PlanException;
 import org.apache.pig.test.utils.GenPhyOp;
 import org.apache.pig.test.utils.GenRandomData;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
 
@@ -57,12 +58,13 @@ import org.junit.Test;
  * group db by $0 
  *
  */
-public class TestLocalRearrange extends junit.framework.TestCase {
+public class TestLocalRearrange  {
     
     POLocalRearrange lr;
     Tuple t;
     DataBag db;
-    
+    private static final MiniCluster cluster = MiniCluster.buildCluster();
+
     
     @Before
     public void setUp() throws Exception {
@@ -70,6 +72,11 @@ public class TestLocalRearrange extends junit.framework.TestCase {
         db = GenRandomData.genRandSmallTupDataBag(r, 10, 100);
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private void setUp1() throws PlanException, ExecException{
         lr = GenPhyOp.topLocalRearrangeOPWithPlanPlain(0,0,db.iterator().next());
         POProject proj = GenPhyOp.exprProject();
@@ -190,7 +197,6 @@ public class TestLocalRearrange extends junit.framework.TestCase {
         
         String INPUT_FILE = "data.txt";
         
-        final MiniCluster cluster = MiniCluster.buildCluster();
         
         try {
             PrintWriter w = new PrintWriter(new FileWriter(INPUT_FILE));
diff --git a/test/org/apache/pig/test/TestMapReduce.java b/test/org/apache/pig/test/TestMapReduce.java
index e8eda471d..7c6af1fc0 100644
--- a/test/org/apache/pig/test/TestMapReduce.java
+++ b/test/org/apache/pig/test/TestMapReduce.java
@@ -17,6 +17,9 @@
  */
 package org.apache.pig.test;
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
+
 import java.io.BufferedReader;
 import java.io.File;
 import java.io.FileOutputStream;
@@ -29,8 +32,6 @@ import java.util.Iterator;
 import java.util.Properties;
 import java.util.Map.Entry;
 
-import junit.framework.TestCase;
-
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pig.EvalFunc;
@@ -49,28 +50,33 @@ import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.test.utils.TestHelper;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
-
-public class TestMapReduce extends TestCase {
+public class TestMapReduce {
 
     private Log log = LogFactory.getLog(getClass());
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig;
     
     @Before
-    @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
 
     @Test
     public void testBigGroupAll() throws Throwable {
 
         int LOOP_COUNT = 4*1024;
-        File tmpFile = File.createTempFile( this.getName(), ".txt");
+        File tmpFile = File.createTempFile( this.getClass().getName(), ".txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < LOOP_COUNT; i++) {
             ps.println(i);
@@ -85,7 +91,7 @@ public class TestMapReduce extends TestCase {
     public void testBigGroupAllWithNull() throws Throwable {
 
         int LOOP_COUNT = 4*1024;
-        File tmpFile = File.createTempFile( this.getName(), ".txt");
+        File tmpFile = File.createTempFile(this.getClass().getName(), ".txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         long nonNullCnt = 0;
         for(int i = 0; i < LOOP_COUNT; i++) {
@@ -138,7 +144,6 @@ public class TestMapReduce extends TestCase {
         }
     }
     
-    @Test
     public Double bigGroupAll( File tmpFile ) throws Throwable {
 
         String query = "foreach (group (load '"
@@ -265,7 +270,7 @@ public class TestMapReduce extends TestCase {
         try {
             pig.deleteFile("frog");
         } catch(Exception e) {}
-
+        tmpFile.delete();
 
     }
 
@@ -318,7 +323,7 @@ public class TestMapReduce extends TestCase {
         try {
             pig.deleteFile("frog");
         } catch(Exception e) {}
-
+        tmpFile.delete();
 
     }
 
@@ -355,6 +360,7 @@ public class TestMapReduce extends TestCase {
         }
 
         assertEquals( MyStorage.COUNT, count );
+        tmpFile.delete();
     }
     
     @Test
@@ -393,6 +399,7 @@ public class TestMapReduce extends TestCase {
         }
 
         assertEquals( MyStorage.COUNT, count );
+        tmpFile.delete();
     }
     
 
@@ -445,7 +452,6 @@ public class TestMapReduce extends TestCase {
     }
 
 
-    @Test
     public void definedFunctions(String[][] data) throws Throwable {
 
         File tmpFile=TestHelper.createTempFile(data) ;
diff --git a/test/org/apache/pig/test/TestMapReduce2.java b/test/org/apache/pig/test/TestMapReduce2.java
index f993f0060..30574db01 100644
--- a/test/org/apache/pig/test/TestMapReduce2.java
+++ b/test/org/apache/pig/test/TestMapReduce2.java
@@ -25,16 +25,19 @@ import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.test.utils.TestHelper;
+import org.junit.AfterClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import java.io.File;
 import java.io.IOException;
 import java.text.DecimalFormat;
 import java.util.Iterator;
-
+@RunWith(JUnit4.class)
 public class TestMapReduce2 extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     private PigServer pig ;
 
@@ -42,6 +45,10 @@ public class TestMapReduce2 extends TestCase {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties()) ;
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
 
     @Test
     public void testUnion1() throws Exception {
@@ -170,7 +177,9 @@ public class TestMapReduce2 extends TestCase {
             }
 
         }
-        return TestHelper.createTempFile(data) ;
+        File tmpFile = TestHelper.createTempFile(data) ;
+        tmpFile.deleteOnExit();
+        return tmpFile;
     }
 
 
diff --git a/test/org/apache/pig/test/TestMapSideCogroup.java b/test/org/apache/pig/test/TestMapSideCogroup.java
index 41fc59c79..24116cd72 100644
--- a/test/org/apache/pig/test/TestMapSideCogroup.java
+++ b/test/org/apache/pig/test/TestMapSideCogroup.java
@@ -18,11 +18,14 @@
 package org.apache.pig.test;
 
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
+
 import java.io.IOException;
 import java.util.Iterator;
 
-import junit.framework.TestCase;
-
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.FSDataInputStream;
 import org.apache.hadoop.fs.FileSystem;
@@ -48,9 +51,10 @@ import org.apache.pig.impl.logicalLayer.LOCogroup;
 import org.apache.pig.impl.logicalLayer.LogicalPlan;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
-
-public class TestMapSideCogroup extends TestCase{
+import org.junit.Test;
+public class TestMapSideCogroup {
 
     private static final String INPUT_FILE1 = "testCogrpInput1.txt";
     private static final String INPUT_FILE2 = "testCogrpInput2.txt";
@@ -60,7 +64,7 @@ public class TestMapSideCogroup extends TestCase{
     private static final String EMPTY_FILE = "empty.txt";
     private static final String DATA_WITH_NULL_KEYS = "null.txt";
 
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
 
     @Before
     public void setUp() throws Exception {
@@ -132,6 +136,12 @@ public class TestMapSideCogroup extends TestCase{
         Util.deleteFile(cluster, DATA_WITH_NULL_KEYS);
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    @Test
     public void testCompilation(){
         try{
             LogicalPlanTester lpt = new LogicalPlanTester();
@@ -168,6 +178,7 @@ public class TestMapSideCogroup extends TestCase{
 
     }
 
+    @Test
     public void testFailure1() throws Exception{
         LogicalPlanTester lpt = new LogicalPlanTester();
         lpt.buildPlan("A = LOAD 'data1' using "+ DummyCollectableLoader.class.getName() +"() as (id, name, grade);");
@@ -189,6 +200,7 @@ public class TestMapSideCogroup extends TestCase{
         assertTrue(exceptionCaught);
     }
     
+    @Test
     public void testFailure2() throws Exception{
         LogicalPlanTester lpt = new LogicalPlanTester();
         lpt.buildPlan("A = LOAD 'data1' using "+ DummyCollectableLoader.class.getName() +"() as (id, name, grade);");
@@ -208,6 +220,7 @@ public class TestMapSideCogroup extends TestCase{
         assertTrue(exceptionCaught);
     }
     
+    @Test
     public void testSimple() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -237,6 +250,7 @@ public class TestMapSideCogroup extends TestCase{
         assertFalse(itr.hasNext());
     }
 
+    @Test
     public void test3Way() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -270,6 +284,7 @@ public class TestMapSideCogroup extends TestCase{
 
     }
 
+    @Test
     public void testMultiSplits() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -308,6 +323,7 @@ public class TestMapSideCogroup extends TestCase{
         assertFalse(itr.hasNext());
     }
 
+    @Test
     public void testCogrpOnMultiKeys() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -343,6 +359,7 @@ public class TestMapSideCogroup extends TestCase{
         assertFalse(itr.hasNext());
     }
     
+    @Test
     public void testEmptyDeltaFile() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -373,7 +390,7 @@ public class TestMapSideCogroup extends TestCase{
         assertFalse(itr.hasNext());
     }
 
- 
+    @Test
     public void testDataWithNullKeys() throws Exception{
 
         PigServer pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
diff --git a/test/org/apache/pig/test/TestMergeJoin.java b/test/org/apache/pig/test/TestMergeJoin.java
index baaf2867a..cff94d943 100644
--- a/test/org/apache/pig/test/TestMergeJoin.java
+++ b/test/org/apache/pig/test/TestMergeJoin.java
@@ -46,6 +46,7 @@ import org.apache.pig.impl.util.LogUtils;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
 
@@ -54,7 +55,7 @@ public class TestMergeJoin {
     private static final String INPUT_FILE = "testMergeJoinInput.txt";
     private static final String INPUT_FILE2 = "testMergeJoinInput2.txt";
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
 
     public TestMergeJoin() throws ExecException{
 
@@ -82,6 +83,10 @@ public class TestMergeJoin {
         Util.createInputFile(cluster, INPUT_FILE2, new String[]{"2"});
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     /**
      * @throws java.lang.Exception
      */
diff --git a/test/org/apache/pig/test/TestMergeJoinOuter.java b/test/org/apache/pig/test/TestMergeJoinOuter.java
index 265a087c3..bc9d46353 100644
--- a/test/org/apache/pig/test/TestMergeJoinOuter.java
+++ b/test/org/apache/pig/test/TestMergeJoinOuter.java
@@ -18,12 +18,15 @@
 
 package org.apache.pig.test;
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
+
 import java.io.IOException;
 import java.util.Iterator;
 import java.util.Properties;
 
-import junit.framework.TestCase;
-
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecException;
@@ -42,15 +45,16 @@ import org.apache.pig.test.TestMapSideCogroup.DummyCollectableLoader;
 import org.apache.pig.test.TestMapSideCogroup.DummyIndexableLoader;
 import org.apache.pig.test.utils.LogicalPlanTester;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
 
-
-public class TestMergeJoinOuter extends TestCase{
+public class TestMergeJoinOuter {
 
     private static final String INPUT_FILE1 = "testMergeJoinInput.txt";
     private static final String INPUT_FILE2 = "testMergeJoinInput2.txt";
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     
     public TestMergeJoinOuter() throws ExecException{
         
@@ -60,10 +64,8 @@ public class TestMergeJoinOuter extends TestCase{
         pigServer = new PigServer(ExecType.MAPREDUCE, props);
     }
     
-    @Override
     @Before
-    protected void setUp() throws Exception {
-        super.setUp();
+    public void setUp() throws Exception {
         int LOOP_SIZE = 3;
         String[] input = new String[LOOP_SIZE*LOOP_SIZE];
         int k = 0;
@@ -77,14 +79,18 @@ public class TestMergeJoinOuter extends TestCase{
         Util.createInputFile(cluster, INPUT_FILE2, new String[]{"2\t2","2\t3","3\t1","4\t1","4\t3"});
     }
     
-    @Override
     @After
-    protected void tearDown() throws Exception {
-        super.tearDown();
+    public void tearDown() throws Exception {
         Util.deleteFile(cluster, INPUT_FILE1);
         Util.deleteFile(cluster, INPUT_FILE2);
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    @Test
     public void testCompilation(){
         try{
             LogicalPlanTester lpt = new LogicalPlanTester();
@@ -122,6 +128,7 @@ public class TestMergeJoinOuter extends TestCase{
 
     }
 
+    @Test
     public void testFailure() throws Exception{
         LogicalPlanTester lpt = new LogicalPlanTester();
         lpt.buildPlan("A = LOAD 'data1' using "+ DummyCollectableLoader.class.getName() +"() as (id, name, grade);");
@@ -142,6 +149,7 @@ public class TestMergeJoinOuter extends TestCase{
         assertTrue(exceptionCaught);
     }
     
+    @Test
     public void testLeftOuter() throws IOException {
         
         pigServer.registerQuery("A = LOAD '"+INPUT_FILE1+"' using "+ DummyCollectableLoader.class.getName() +"() as (c1:chararray, c2:chararray);");
@@ -170,6 +178,7 @@ public class TestMergeJoinOuter extends TestCase{
 
     }
     
+    @Test
     public void testRightOuter() throws IOException{
         
         pigServer.registerQuery("A = LOAD '"+INPUT_FILE1+"' using "+ DummyCollectableLoader.class.getName() +"() as (c1:chararray, c2:chararray);");
@@ -196,6 +205,7 @@ public class TestMergeJoinOuter extends TestCase{
 
     }
     
+    @Test
     public void testFullOuter() throws IOException{
         
         pigServer.registerQuery("A = LOAD '"+INPUT_FILE1+"' using "+ DummyCollectableLoader.class.getName() +"() as (c1:chararray, c2:chararray);");
diff --git a/test/org/apache/pig/test/TestMultiQuery.java b/test/org/apache/pig/test/TestMultiQuery.java
index 0cc6fb5f9..2a462d019 100644
--- a/test/org/apache/pig/test/TestMultiQuery.java
+++ b/test/org/apache/pig/test/TestMultiQuery.java
@@ -75,7 +75,9 @@ import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.BeforeClass;
 import org.junit.Test;
-
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+@RunWith(JUnit4.class)
 public class TestMultiQuery {
 
     private static final MiniCluster cluster = MiniCluster.buildCluster();
@@ -94,6 +96,7 @@ public class TestMultiQuery {
     public static void tearDownAfterClass() throws IOException {
         Util.deleteFile(cluster, "passwd");
         Util.deleteFile(cluster, "passwd2");
+        cluster.shutDown();
     }
     
     @Before
@@ -411,6 +414,11 @@ public class TestMultiQuery {
         }
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testMultiQueryJiraPig1108() {
         try {
diff --git a/test/org/apache/pig/test/TestNullConstant.java b/test/org/apache/pig/test/TestNullConstant.java
index 54c2eb3d3..af41c4942 100644
--- a/test/org/apache/pig/test/TestNullConstant.java
+++ b/test/org/apache/pig/test/TestNullConstant.java
@@ -31,16 +31,17 @@ import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.data.DataBag;
 import org.apache.pig.data.Tuple;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 
-/**
- *
- */
+@RunWith(JUnit4.class)
 public class TestNullConstant extends TestCase {
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     @Before
@@ -49,6 +50,11 @@ public class TestNullConstant extends TestCase {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testArithExpressions() throws IOException, ExecException {
         String inputFileName = "testArithExpressions-input.txt";
diff --git a/test/org/apache/pig/test/TestOrderBy.java b/test/org/apache/pig/test/TestOrderBy.java
index 1e7f3ea71..86f9f340e 100644
--- a/test/org/apache/pig/test/TestOrderBy.java
+++ b/test/org/apache/pig/test/TestOrderBy.java
@@ -25,17 +25,23 @@ import java.util.Iterator;
 
 import junit.framework.TestCase;
 
+import org.junit.After;
+import org.junit.AfterClass;
+import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
 
+@RunWith(JUnit4.class)
 public class TestOrderBy extends TestCase {
     private static final int DATALEN = 1024;
     private String[][] DATA = new String[2][DATALEN];
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
     private PigServer pig;
     private File tmpFile;
@@ -49,7 +55,8 @@ public class TestOrderBy extends TestCase {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
-    protected void setUp() throws Exception {
+    @Before
+    public void setUp() throws Exception {
         tmpFile = File.createTempFile("test", "txt");
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 0; i < DATALEN; i++) {
@@ -58,10 +65,16 @@ public class TestOrderBy extends TestCase {
         ps.close();
     }
     
-    protected void tearDown() throws Exception {
+    @After
+    public void tearDown() throws Exception {
         tmpFile.delete();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private void verify(String query, boolean descending) throws Exception {
         pig.registerQuery(query);
         Iterator<Tuple> it = pig.openIterator("myid");
diff --git a/test/org/apache/pig/test/TestPONegative.java b/test/org/apache/pig/test/TestPONegative.java
index abb89ca1c..f480d04d5 100644
--- a/test/org/apache/pig/test/TestPONegative.java
+++ b/test/org/apache/pig/test/TestPONegative.java
@@ -34,16 +34,28 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.Physica
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.PONegative;
 import org.apache.pig.impl.plan.PlanException;
-import junit.framework.TestCase;
+import org.junit.AfterClass;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+import junit.framework.TestCase;
+@RunWith(JUnit4.class)
 public class TestPONegative extends TestCase {
     
     DataBag bag = BagFactory.getInstance().newDefaultBag();
     Random r = new Random();
     TupleFactory tf = TupleFactory.getInstance();
-    MiniCluster miniCluster = MiniCluster.buildCluster();
+    static MiniCluster miniCluster = MiniCluster.buildCluster();
     final int MAX = 10;
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        miniCluster.shutDown();
+    }
+    
+    
+    @Test
     public void testPONegInt () throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -69,6 +81,7 @@ public class TestPONegative extends TestCase {
         }
     }
     
+    @Test    
     public void testPONegIntAndNull () throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -106,6 +119,7 @@ public class TestPONegative extends TestCase {
           }
     }
     
+    @Test    
     public void testPONegLong () throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -131,6 +145,7 @@ public class TestPONegative extends TestCase {
         }
     }
     
+    @Test    
     public void testPONegLongAndNull () throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -168,6 +183,7 @@ public class TestPONegative extends TestCase {
         }
     }
     
+    @Test
     public void testPONegDouble() throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -193,6 +209,7 @@ public class TestPONegative extends TestCase {
         }
     }
   
+    @Test
     public void testPONegDoubleAndNull() throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -229,6 +246,7 @@ public class TestPONegative extends TestCase {
         }
     }
 
+    @Test
     public void testPONegFloat() throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -254,6 +272,7 @@ public class TestPONegative extends TestCase {
         }
     }
     
+    @Test
     public void testPONegFloatAndNull() throws PlanException, ExecException {
         for(int i = 0; i < MAX; i++) {
             Tuple t = tf.newTuple();
@@ -290,6 +309,7 @@ public class TestPONegative extends TestCase {
         }
     }
     
+    @Test
     public void testPONegType() throws Exception {
         PigServer pig = new PigServer(ExecType.MAPREDUCE, miniCluster.getProperties());
         File f = Util.createInputFile("tmp", "", new String[] {"a", "b", "c"});
diff --git a/test/org/apache/pig/test/TestParser.java b/test/org/apache/pig/test/TestParser.java
index 92538720d..82e5c7433 100644
--- a/test/org/apache/pig/test/TestParser.java
+++ b/test/org/apache/pig/test/TestParser.java
@@ -31,20 +31,25 @@ import org.apache.pig.PigServer;
 import org.apache.pig.ExecType;
 import org.apache.pig.backend.executionengine.ExecException;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestParser extends TestCase {
 
 protected final Log log = LogFactory.getLog(getClass());
     
     protected ExecType execType = MAPREDUCE;
     
-    private MiniCluster cluster;
+    private static MiniCluster cluster;
     protected PigServer pigServer;
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         
         String execTypeString = System.getProperty("test.exectype");
         if(execTypeString!=null && execTypeString.length()>0){
@@ -59,11 +64,17 @@ protected final Log log = LogFactory.getLog(getClass());
     }
 
     @After
-    @Override
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         pigServer.shutdown();
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        if(cluster != null)
+            cluster.shutDown();
+    }
+    
+    @Test
     public void testLoadingNonexistentFile() throws ExecException, IOException {
         try {
             // FIXME : this should be tested in all modes
diff --git a/test/org/apache/pig/test/TestPi.java b/test/org/apache/pig/test/TestPi.java
index 976a327ee..88366c85d 100644
--- a/test/org/apache/pig/test/TestPi.java
+++ b/test/org/apache/pig/test/TestPi.java
@@ -29,8 +29,12 @@ import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.backend.executionengine.ExecException;
 
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+
 import junit.framework.TestCase;
 
 import java.io.File;
@@ -45,6 +49,7 @@ import org.apache.hadoop.conf.Configuration;
 /*
  * Testcase aimed at testing pig with large file sizes and filter and group functions
 */
+@RunWith(JUnit4.class)
 public class TestPi extends TestCase {
     
     private final Log log = LogFactory.getLog(getClass());
@@ -54,7 +59,7 @@ public class TestPi extends TestCase {
     
     private long total = ((defaultBlockSize >> 20) / 10) << 20;
     private int inCircle = 0;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
 
     private long totalLength = 0, totalLengthTest = 0;
 
@@ -65,7 +70,7 @@ public class TestPi extends TestCase {
     
     @Override
     @Before
-    protected void setUp() throws Exception{
+    public void setUp() throws Exception{
 
         log.info("Generating test data...");
         log.info("Default block size = " + defaultBlockSize);
@@ -116,10 +121,15 @@ public class TestPi extends TestCase {
     
     @Override
     @After
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testPi () throws Exception {
         
diff --git a/test/org/apache/pig/test/TestPigContext.java b/test/org/apache/pig/test/TestPigContext.java
index 2de79759d..8a57f7b59 100644
--- a/test/org/apache/pig/test/TestPigContext.java
+++ b/test/org/apache/pig/test/TestPigContext.java
@@ -40,9 +40,14 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.BeforeClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestPigContext extends TestCase {
 
     private static final String TMP_DIR_PROP = "/tmp/hadoop-hadoop";
@@ -51,11 +56,16 @@ public class TestPigContext extends TestCase {
 
     private File input;
     private PigContext pigContext;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = null;
+    
+    @BeforeClass 
+    public static void oneTimeSetup(){
+        cluster = MiniCluster.buildCluster();
+    }
     
     @Before
     @Override
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pigContext = new PigContext(ExecType.LOCAL, getProperties());
         input = File.createTempFile("PigContextTest-", ".txt");
     }
@@ -199,10 +209,16 @@ public class TestPigContext extends TestCase {
 
     @After
     @Override
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         input.delete();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    
     private static Properties getProperties() {
         Properties props = new Properties();
         props.put("mapred.job.tracker", JOB_TRACKER);
@@ -226,7 +242,9 @@ public class TestPigContext extends TestCase {
         for (final String command : commands) {
             pigServer.registerQuery(command);
         }
-        pigServer.store("counts", input.getAbsolutePath() + ".out");
+        String outFile = input.getAbsolutePath() + ".out";
+        pigServer.store("counts", outFile);
+        Util.deleteFile(cluster, outFile);
     }
 
     private void check_asserts(PigServer pigServer) {
diff --git a/test/org/apache/pig/test/TestPigServer.java b/test/org/apache/pig/test/TestPigServer.java
index 72786c93d..dd699694f 100644
--- a/test/org/apache/pig/test/TestPigServer.java
+++ b/test/org/apache/pig/test/TestPigServer.java
@@ -40,15 +40,19 @@ import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.After;
 import org.junit.Test;
-import junit.framework.TestCase;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestPigServer extends TestCase {
     private PigServer pig = null;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private File stdOutRedirectedFile;
 
     @Before
@@ -72,6 +76,10 @@ public class TestPigServer extends TestCase {
         stdOutRedirectedFile.delete();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
     
     private final static String FILE_SEPARATOR = System.getProperty("file.separator");
     
diff --git a/test/org/apache/pig/test/TestPigSplit.java b/test/org/apache/pig/test/TestPigSplit.java
index 6cf9a0419..af70e9dee 100644
--- a/test/org/apache/pig/test/TestPigSplit.java
+++ b/test/org/apache/pig/test/TestPigSplit.java
@@ -54,7 +54,7 @@ public class TestPigSplit extends PigExecTestCase {
      * @see org.apache.pig.test.PigExecTestCase#tearDown()
      */
     @Override
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         if(execType == ExecType.MAPREDUCE) {
             Util.deleteFile(cluster, inputFileName);
         } else if (execType == ExecType.LOCAL) {
@@ -64,7 +64,6 @@ public class TestPigSplit extends PigExecTestCase {
         }
     }
     
-	@Test
 	public void notestLongEvalSpec() throws Exception{
 		inputFileName = "notestLongEvalSpec-input.txt";
 		createInput(new String[] {"0\ta"});
diff --git a/test/org/apache/pig/test/TestPigStorage.java b/test/org/apache/pig/test/TestPigStorage.java
index 356b082d8..d528bbce7 100644
--- a/test/org/apache/pig/test/TestPigStorage.java
+++ b/test/org/apache/pig/test/TestPigStorage.java
@@ -39,9 +39,12 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
-
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
+@RunWith(JUnit4.class)
 public class TestPigStorage  {
         
     protected final Log log = LogFactory.getLog(getClass());
@@ -56,6 +59,10 @@ public class TestPigStorage  {
         FileLocalizer.setInitialized(false);
     }
     
+    @AfterClass
+    public static void shutdown() {
+        cluster.shutDown();
+    }
     @Test
     public void testBlockBoundary() throws ExecException {
         
diff --git a/test/org/apache/pig/test/TestPoissonSampleLoader.java b/test/org/apache/pig/test/TestPoissonSampleLoader.java
index 58b1e8373..6dfc8ba28 100644
--- a/test/org/apache/pig/test/TestPoissonSampleLoader.java
+++ b/test/org/apache/pig/test/TestPoissonSampleLoader.java
@@ -18,31 +18,31 @@
 package org.apache.pig.test;
 
 
-import java.io.*;
-import java.util.ArrayList;
+import java.io.File;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.io.PrintWriter;
 import java.util.Iterator;
 
 import junit.framework.TestCase;
 
 import org.apache.pig.ExecType;
-import org.apache.pig.FuncSpec;
 import org.apache.pig.PigServer;
 import org.apache.pig.backend.executionengine.ExecException;
-import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.data.Tuple;
-import org.apache.pig.impl.builtin.PoissonSampleLoader;
-import org.apache.pig.impl.util.Pair;
-import org.apache.pig.impl.io.FileSpec;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
-
+@RunWith(JUnit4.class)
 public class TestPoissonSampleLoader extends TestCase{
     private static final String INPUT_FILE1 = "SkewedJoinInput1.txt";
 
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
 
     public TestPoissonSampleLoader() throws ExecException, IOException{
         pigServer = new PigServer(ExecType.LOCAL, cluster.getProperties());
@@ -58,6 +58,11 @@ public class TestPoissonSampleLoader extends TestCase{
     public void setUp() throws Exception {
         createFiles();
     }
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
 
     private void createFiles() throws IOException {
         PrintWriter w = new PrintWriter(new FileWriter(INPUT_FILE1));
diff --git a/test/org/apache/pig/test/TestProject.java b/test/org/apache/pig/test/TestProject.java
index df39b18e9..065bf60e9 100644
--- a/test/org/apache/pig/test/TestProject.java
+++ b/test/org/apache/pig/test/TestProject.java
@@ -38,8 +38,11 @@ import org.apache.pig.test.utils.GenPhyOp;
 import org.apache.pig.test.utils.GenRandomData;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 public class TestProject extends  junit.framework.TestCase {
     Random r;
@@ -64,7 +67,7 @@ public class TestProject extends  junit.framework.TestCase {
     @After
     public void tearDown() throws Exception {
     }
-
+   
     @Test
     public void testGetNext() throws ExecException, IOException {
     	t=tRandom;
diff --git a/test/org/apache/pig/test/TestPruneColumn.java b/test/org/apache/pig/test/TestPruneColumn.java
index 84c657b64..2d87659bd 100644
--- a/test/org/apache/pig/test/TestPruneColumn.java
+++ b/test/org/apache/pig/test/TestPruneColumn.java
@@ -39,13 +39,13 @@ import org.apache.pig.builtin.PigStorage;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.logicalLayer.optimizer.PruneColumns;
+import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
 
 import junit.framework.TestCase;
 
 public class TestPruneColumn extends TestCase {
-    //MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
     File tmpFile1;
     File tmpFile2;
@@ -170,6 +170,22 @@ public class TestPruneColumn extends TestCase {
 
     }
     
+    @After
+    @Override
+    public void tearDown() throws Exception{
+        tmpFile1.delete();
+        tmpFile2.delete();
+        tmpFile3.delete();
+        tmpFile4.delete();
+        tmpFile5.delete();
+        tmpFile6.delete();
+        tmpFile7.delete();
+        tmpFile8.delete();
+        tmpFile9.delete();
+        tmpFile10.delete();
+        logFile.delete();
+    }
+    
     public boolean checkLogFileMessage(String[] messages)
     {
         BufferedReader reader = null;
@@ -1331,8 +1347,6 @@ public class TestPruneColumn extends TestCase {
         
         assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2", 
             "No map keys pruned for A"}));
-        
-        intermediateFile.delete();
     }
     
     @Test
@@ -1368,7 +1382,6 @@ public class TestPruneColumn extends TestCase {
         assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1", 
             "No map keys pruned for A"}));
         
-        intermediateFile.delete();
     }
 
     
diff --git a/test/org/apache/pig/test/TestPruneColumnNewLogicalPlan.java b/test/org/apache/pig/test/TestPruneColumnNewLogicalPlan.java
index d4b5a1d16..f094af30b 100644
--- a/test/org/apache/pig/test/TestPruneColumnNewLogicalPlan.java
+++ b/test/org/apache/pig/test/TestPruneColumnNewLogicalPlan.java
@@ -41,13 +41,13 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.experimental.plan.optimizer.Rule;
 import org.apache.pig.impl.logicalLayer.FrontendException;
 import org.apache.pig.impl.logicalLayer.optimizer.PruneColumns;
+import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
 
 import junit.framework.TestCase;
 
 public class TestPruneColumnNewLogicalPlan extends TestCase {
-    //MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
     File tmpFile1;
     File tmpFile2;
@@ -174,6 +174,24 @@ public class TestPruneColumnNewLogicalPlan extends TestCase {
 
     }
     
+    
+    @After
+    @Override
+    public void tearDown() throws Exception{
+        tmpFile1.delete();
+        tmpFile2.delete();
+        tmpFile3.delete();
+        tmpFile4.delete();
+        tmpFile5.delete();
+        tmpFile6.delete();
+        tmpFile7.delete();
+        tmpFile8.delete();
+        tmpFile9.delete();
+        tmpFile10.delete();
+        logFile.delete();
+    }
+    
+    
     public boolean checkLogFileMessage(String[] messages)
     {
         BufferedReader reader = null;
diff --git a/test/org/apache/pig/test/TestRelationToExprProject.java b/test/org/apache/pig/test/TestRelationToExprProject.java
index 65a9c3e59..2d18e9fa9 100644
--- a/test/org/apache/pig/test/TestRelationToExprProject.java
+++ b/test/org/apache/pig/test/TestRelationToExprProject.java
@@ -33,8 +33,11 @@ import org.apache.pig.data.TupleFactory;
 import org.apache.pig.impl.logicalLayer.parser.ParseException;
 import org.apache.pig.impl.util.LogUtils;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
@@ -55,9 +58,10 @@ import junit.framework.TestCase;
  * a = load 'baginp.txt' as (b:bag{t:tuple()}); b = foreach a generate $0; dump b;
  * will go through a regular project (without the following flag)
  */
+@RunWith(JUnit4.class)
 public class TestRelationToExprProject extends TestCase {
 
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
     private static final String TEST_FILTER_COUNT3_INPUT="test/org/apache/pig/test/data/TestRelationToExprProjectInput.txt"; 
     
@@ -65,7 +69,7 @@ public class TestRelationToExprProject extends TestCase {
      * @see junit.framework.TestCase#setUp()
      */
     @Before
-    protected void setUp() throws Exception {
+    public void setUp() throws Exception {
         pigServer = new PigServer(MAPREDUCE, cluster.getProperties());
     }
     
@@ -73,10 +77,15 @@ public class TestRelationToExprProject extends TestCase {
      * @see junit.framework.TestCase#tearDown()
      */
     @After
-    protected void tearDown() throws Exception {
+    public void tearDown() throws Exception {
         pigServer.shutdown();
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     // based on the script provided in the jira issue:PIG-514
     // tests that when a filter inside a foreach filters away all tuples
     // for a group, an empty bag is still provided to udfs whose
diff --git a/test/org/apache/pig/test/TestSample.java b/test/org/apache/pig/test/TestSample.java
index baea6d659..c32857ebf 100644
--- a/test/org/apache/pig/test/TestSample.java
+++ b/test/org/apache/pig/test/TestSample.java
@@ -17,38 +17,33 @@
  */
 package org.apache.pig.test;
 
+import static org.junit.Assert.assertTrue;
+
 import java.io.File;
-import java.io.FileOutputStream;
-import java.io.PrintStream;
-import java.text.DecimalFormat;
 import java.util.Iterator;
 
-import junit.framework.TestCase;
-
-import org.junit.Test;
-
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
-import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
-
-public class TestSample
-extends TestCase
-{
+import org.junit.After;
+import org.junit.AfterClass;
+import org.junit.Before;
+import org.junit.Test;
+public class TestSample {
     private PigServer pig;
     private File tmpFile;
     private String tmpfilepath;
 
     private int DATALEN = 1024;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     
-    @Override
-    protected void setUp()
+    @Before
+    public void setUp()
     throws Exception
     {
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
-        tmpFile = File.createTempFile( this.getName(), ".txt");
+        tmpFile = File.createTempFile( this.getClass().getName(), ".txt");
         String input[] = new String[DATALEN];
         for(int i = 0; i < DATALEN; i++) {
             input[i] = Integer.toString(i);
@@ -58,11 +53,17 @@ extends TestCase
         Util.createInputFile(cluster, tmpfilepath, input);
     }
 
-    protected void tearDown()
+    @After
+    public void tearDown()
     throws Exception
     {
         Util.deleteFile(cluster, tmpfilepath);
     }
+    
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
 
     private void verify(String query, int expected_min, int expected_max)
     throws Exception
diff --git a/test/org/apache/pig/test/TestSampleOptimizer.java b/test/org/apache/pig/test/TestSampleOptimizer.java
index 8e590a042..50da01605 100644
--- a/test/org/apache/pig/test/TestSampleOptimizer.java
+++ b/test/org/apache/pig/test/TestSampleOptimizer.java
@@ -39,8 +39,12 @@ import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.logicalLayer.LogicalPlan;
 import org.apache.pig.test.utils.LogicalPlanTester;
+import org.junit.AfterClass;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestSampleOptimizer {
 
     static PigContext pc;
@@ -53,6 +57,11 @@ public class TestSampleOptimizer {
         }
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        MiniCluster.buildCluster().shutDown();
+    }
+    
     @Test
     public void testOptimizerFired() throws Exception{
 
diff --git a/test/org/apache/pig/test/TestSchema.java b/test/org/apache/pig/test/TestSchema.java
index 1c2487599..5363694bf 100644
--- a/test/org/apache/pig/test/TestSchema.java
+++ b/test/org/apache/pig/test/TestSchema.java
@@ -655,5 +655,6 @@ public class TestSchema extends TestCase {
             Tuple t = it.next();
             assertEquals("{a: {f1: chararray,f2: int}}", t.get(0));
         }
+        cluster.shutDown();
     }
 }
diff --git a/test/org/apache/pig/test/TestSecondarySort.java b/test/org/apache/pig/test/TestSecondarySort.java
index 36cc89397..07a0892de 100644
--- a/test/org/apache/pig/test/TestSecondarySort.java
+++ b/test/org/apache/pig/test/TestSecondarySort.java
@@ -38,10 +38,15 @@ import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.logicalLayer.LogicalPlan;
 import org.apache.pig.test.utils.LogicalPlanTester;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestSecondarySort extends TestCase {
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     static PigContext pc;
@@ -54,6 +59,11 @@ public class TestSecondarySort extends TestCase {
         }
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Before
     @Override
     public void setUp() throws Exception{
@@ -61,6 +71,7 @@ public class TestSecondarySort extends TestCase {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
 
+    @Test
     public void testDistinctOptimization1() throws Exception{
         // Limit in the foreach plan
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -81,6 +92,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization2() throws Exception{
         // Distinct on one entire input 
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -100,6 +112,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization3() throws Exception{
         // Distinct on the prefix of main sort key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -119,6 +132,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization4() throws Exception{
         // Distinct on secondary key again, should remove
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -138,6 +152,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==2);
     }
     
+    @Test
     public void testDistinctOptimization5() throws Exception{
         // Filter in foreach plan
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -157,6 +172,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization6() throws Exception{
         // group by * with no schema, and distinct key is not part of main key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -176,6 +192,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
 
+    @Test
     public void testDistinctOptimization7() throws Exception{
         // group by * with no schema, distinct key is more specific than the main key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -195,6 +212,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization8() throws Exception{
         // local arrange plan is an expression
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -214,6 +232,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testDistinctOptimization9() throws Exception{
         // local arrange plan is nested project
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -233,6 +252,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==1);
     }
     
+    @Test
     public void testSortOptimization1() throws Exception{
         // Sort on something other than the main key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -252,6 +272,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization2() throws Exception{
         // Sort on the prefix of the main key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -271,6 +292,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization3() throws Exception{
         // Sort on the main key prefix / non main key prefix mixed
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -290,6 +312,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization4() throws Exception{
         // Sort on the main key again
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -309,6 +332,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization5() throws Exception{
         // Sort on the two keys, we can only take off 1
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -328,6 +352,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization6() throws Exception{
         // Sort desc
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -347,6 +372,7 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testSortOptimization7() throws Exception{
         // Sort asc on 1st key, desc on 2nd key
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -367,6 +393,7 @@ public class TestSecondarySort extends TestCase {
     }
     
     // See PIG-1193
+    @Test
     public void testSortOptimization8() throws Exception{
         // Sort desc, used in UDF twice
         LogicalPlanTester planTester = new LogicalPlanTester() ;
@@ -386,8 +413,9 @@ public class TestSecondarySort extends TestCase {
         assertTrue(so.getDistinctChanged()==0);
     }
     
+    @Test
     public void testNestedDistinctEndToEnd1() throws Exception{
-        File tmpFile1 = File.createTempFile("test", "txt");
+        File tmpFile1 = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps1 = new PrintStream(new FileOutputStream(tmpFile1));
         ps1.println("1\t2\t3");
         ps1.println("1\t3\t4");
@@ -397,7 +425,7 @@ public class TestSecondarySort extends TestCase {
         ps1.println("2\t3\t4");
         ps1.close();
         
-        File tmpFile2 = File.createTempFile("test", "txt");
+        File tmpFile2 = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps2 = new PrintStream(new FileOutputStream(tmpFile2));
         ps2.println("1\t4\t4");
         ps2.println("2\t3\t1");
@@ -420,9 +448,10 @@ public class TestSecondarySort extends TestCase {
         Util.deleteFile(cluster, tmpFile1.getCanonicalPath());
         Util.deleteFile(cluster, tmpFile2.getCanonicalPath());
     }
-    
+   
+    @Test
     public void testNestedDistinctEndToEnd2() throws Exception{
-        File tmpFile1 = File.createTempFile("test", "txt");
+        File tmpFile1 = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps1 = new PrintStream(new FileOutputStream(tmpFile1));
         ps1.println("1\t2\t3");
         ps1.println("1\t3\t4");
@@ -445,8 +474,9 @@ public class TestSecondarySort extends TestCase {
         Util.deleteFile(cluster, tmpFile1.getCanonicalPath());
     }
     
+    @Test
     public void testNestedSortEndToEnd1() throws Exception{
-        File tmpFile1 = File.createTempFile("test", "txt");
+        File tmpFile1 = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps1 = new PrintStream(new FileOutputStream(tmpFile1));
         ps1.println("1\t2\t3");
         ps1.println("1\t3\t4");
@@ -469,8 +499,9 @@ public class TestSecondarySort extends TestCase {
         Util.deleteFile(cluster, tmpFile1.getCanonicalPath());
     }
     
+    @Test
     public void testNestedSortEndToEnd2() throws Exception{
-        File tmpFile1 = File.createTempFile("test", "txt");
+        File tmpFile1 = Util.createTempFileDelOnExit("test", "txt");
         PrintStream ps1 = new PrintStream(new FileOutputStream(tmpFile1));
         ps1.println("1\t2\t3");
         ps1.println("1\t3\t4");
@@ -493,6 +524,7 @@ public class TestSecondarySort extends TestCase {
         Util.deleteFile(cluster, tmpFile1.getCanonicalPath());
     }
     
+    @Test
     public void testNestedSortMultiQueryEndToEnd1() throws Exception{
         pigServer.setBatchOn();
         Util.copyFromLocalToCluster(cluster, 
diff --git a/test/org/apache/pig/test/TestSkewedJoin.java b/test/org/apache/pig/test/TestSkewedJoin.java
index c29042e28..39a3d9ede 100644
--- a/test/org/apache/pig/test/TestSkewedJoin.java
+++ b/test/org/apache/pig/test/TestSkewedJoin.java
@@ -34,8 +34,13 @@ import org.apache.pig.data.DataBag;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestSkewedJoin extends TestCase{
     private static final String INPUT_FILE1 = "SkewedJoinInput1.txt";
     private static final String INPUT_FILE2 = "SkewedJoinInput2.txt";
@@ -46,7 +51,7 @@ public class TestSkewedJoin extends TestCase{
     private static final String INPUT_FILE7 = "SkewedJoinInput7.txt";
     
     private PigServer pigServer;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     
     public TestSkewedJoin() throws ExecException, IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
@@ -60,6 +65,11 @@ public class TestSkewedJoin extends TestCase{
         createFiles();
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private void createFiles() throws IOException {
     	PrintWriter w = new PrintWriter(new FileWriter(INPUT_FILE1));
     	    	
@@ -163,6 +173,7 @@ public class TestSkewedJoin extends TestCase{
         Util.deleteFile(cluster, INPUT_FILE7);
     }
     
+    @Test
     public void testSkewedJoinWithGroup() throws IOException{
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
@@ -188,8 +199,9 @@ public class TestSkewedJoin extends TestCase{
         }
         Assert.assertTrue(dbfrj.size()>0 && dbshj.size()>0);
         Assert.assertEquals(true, TestHelper.compareBags(dbfrj, dbshj));
-    }      
+    }    
     
+    @Test
     public void testSkewedJoinWithNoProperties() throws IOException{
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
 
@@ -221,7 +233,8 @@ public class TestSkewedJoin extends TestCase{
              fail(e.getMessage());
         }
     }
-
+    
+    @Test
     public void testSkewedJoinReducers() throws IOException{
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
@@ -241,6 +254,7 @@ public class TestSkewedJoin extends TestCase{
         
     }
     
+    @Test
     public void testSkewedJoin3Way() throws IOException{
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
@@ -262,6 +276,7 @@ public class TestSkewedJoin extends TestCase{
         fail("Should throw exception, do not support 3 way join");
     }       
 
+    @Test
     public void testSkewedJoinMapKey() throws IOException{
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE4 + "' as (m:[]);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE4 + "' as (n:[]);");
@@ -285,6 +300,7 @@ public class TestSkewedJoin extends TestCase{
 	}
 
 
+    @Test 
     public void testSkewedJoinKeyPartition() throws IOException {
     	try{
     	     Util.deleteFile(cluster, "skewedjoin");
@@ -328,6 +344,7 @@ public class TestSkewedJoin extends TestCase{
          assertTrue(fc > 3);
     }
     
+    @Test 
     public void testSkewedJoinNullKeys() throws IOException {
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE5 + "' as (id,name);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' as (id,name);");
@@ -349,6 +366,7 @@ public class TestSkewedJoin extends TestCase{
         return;
     }
     
+    @Test 
     public void testSkewedJoinOuter() throws IOException {
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE5 + "' as (id,name);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' as (id,name);");
@@ -387,6 +405,7 @@ public class TestSkewedJoin extends TestCase{
     }
     
     // pig 1048
+    @Test 
     public void testSkewedJoinOneValue() throws IOException {
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE3 + "' as (id,name);");
         pigServer.registerQuery("B = LOAD '" + INPUT_FILE3 + "' as (id,name);");
@@ -418,6 +437,7 @@ public class TestSkewedJoin extends TestCase{
        
     }
 
+    @Test 
     public void testSkewedJoinManyReducers() throws IOException {
         pigServer.getPigContext().getProperties().setProperty("pig.skewedjoin.reduce.maxtuple", "2");
         pigServer.registerQuery("A = LOAD '" + INPUT_FILE6 + "' as (id,name);");
@@ -445,6 +465,7 @@ public class TestSkewedJoin extends TestCase{
        
     }
     
+    @Test
     public void testSkewedJoinEmptyInput() throws IOException {
         String LEFT_INPUT_FILE = "left.dat";
         String RIGHT_INPUT_FILE = "right.dat";
@@ -482,6 +503,7 @@ public class TestSkewedJoin extends TestCase{
         Util.deleteFile(cluster, RIGHT_INPUT_FILE);            
     }
     
+    @Test
     public void testRecursiveFileListing() throws IOException {
         String LOCAL_INPUT_FILE = "test.dat";
         String INPUT_FILE = "foo/bar/test.dat";
diff --git a/test/org/apache/pig/test/TestSplitStore.java b/test/org/apache/pig/test/TestSplitStore.java
index c51bd6e6a..fa20060e6 100644
--- a/test/org/apache/pig/test/TestSplitStore.java
+++ b/test/org/apache/pig/test/TestSplitStore.java
@@ -29,22 +29,27 @@ import org.apache.pig.backend.executionengine.ExecException;
 import org.apache.pig.impl.PigContext;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestSplitStore extends TestCase{
     private PigServer pig;
     private PigContext pigContext;
     private File tmpFile;
-    private MiniCluster cluster = MiniCluster.buildCluster();
+    private static MiniCluster cluster = MiniCluster.buildCluster();
     
     public TestSplitStore() throws ExecException, IOException{
         pig = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
         pigContext = pig.getPigContext();
         int LOOP_SIZE = 20;
         tmpFile = File.createTempFile("test", "txt");
+        tmpFile.deleteOnExit();
         PrintStream ps = new PrintStream(new FileOutputStream(tmpFile));
         for(int i = 1; i <= LOOP_SIZE; i++) {
             ps.println(i);
@@ -60,6 +65,11 @@ public class TestSplitStore extends TestCase{
     public void tearDown() throws Exception {
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void test1() throws Exception{
         pig.registerQuery("A = LOAD '" 
diff --git a/test/org/apache/pig/test/TestStore.java b/test/org/apache/pig/test/TestStore.java
index 67ebac783..d7361cc1b 100644
--- a/test/org/apache/pig/test/TestStore.java
+++ b/test/org/apache/pig/test/TestStore.java
@@ -71,9 +71,13 @@ import org.apache.pig.test.utils.LogicalPlanTester;
 import org.apache.pig.test.utils.TestHelper;
 import org.apache.pig.tools.pigstats.PigStats;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestStore extends junit.framework.TestCase {
     POStore st;
     DataBag inpDB;
@@ -114,6 +118,11 @@ public class TestStore extends junit.framework.TestCase {
         Util.copyFromClusterToLocal(cluster, outputFileName + "/part-m-00000", outputFileName);
     }
 
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private PigStats store() throws Exception {
         PhysicalPlan pp = new PhysicalPlan();
         pp.add(proj);
diff --git a/test/org/apache/pig/test/TestStoreOld.java b/test/org/apache/pig/test/TestStoreOld.java
index 70ab3bfe3..45c0033ef 100644
--- a/test/org/apache/pig/test/TestStoreOld.java
+++ b/test/org/apache/pig/test/TestStoreOld.java
@@ -26,18 +26,30 @@ import org.apache.pig.PigServer;
 import org.apache.pig.data.DataType;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
+import org.junit.AfterClass;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
+@RunWith(JUnit4.class)
 public class TestStoreOld extends TestCase {
 
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private int LOOP_COUNT = 1024;
     
     String fileName;
     String tmpFile1, tmpFile2;
     PigServer pig;
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
+    @Test
     public void testSingleStore() throws Exception{
         pig.registerQuery("A = load " + fileName + ";");
         
@@ -55,6 +67,7 @@ public class TestStoreOld extends TestCase {
         }
     }
     
+    @Test
     public void testMultipleStore() throws Exception{
         pig.registerQuery("A = load " + fileName + ";");
         
@@ -76,6 +89,7 @@ public class TestStoreOld extends TestCase {
         
     }
     
+    @Test
     public void testStoreWithMultipleMRJobs() throws Exception{
         pig.registerQuery("A = load " + fileName + ";");        
         pig.registerQuery("B = foreach (group A by $0) generate $0, SUM($1.$0);");
@@ -98,7 +112,8 @@ public class TestStoreOld extends TestCase {
 
     
     @Override
-    protected void setUp() throws Exception {
+    @Before
+    public void setUp() throws Exception {
         super.setUp();
         File f = File.createTempFile("tmp", "");
         PrintWriter pw = new PrintWriter(f);
diff --git a/test/org/apache/pig/test/TestStreaming.java b/test/org/apache/pig/test/TestStreaming.java
index 5b9b3128a..53e6e65f6 100644
--- a/test/org/apache/pig/test/TestStreaming.java
+++ b/test/org/apache/pig/test/TestStreaming.java
@@ -35,6 +35,7 @@ import org.apache.pig.builtin.PigStreaming;
 import org.apache.pig.PigToStream;
 import org.apache.pig.impl.util.TupleFormat;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Assert;
 import org.junit.Before;
 import org.junit.Test;
@@ -55,6 +56,11 @@ public class TestStreaming {
         pigServer = null;
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private TupleFactory tf = DefaultTupleFactory.getInstance();
 
 	private static final String simpleEchoStreamingCommand;
diff --git a/test/org/apache/pig/test/TestUDFContext.java b/test/org/apache/pig/test/TestUDFContext.java
index bd01cea2a..d44e82a64 100644
--- a/test/org/apache/pig/test/TestUDFContext.java
+++ b/test/org/apache/pig/test/TestUDFContext.java
@@ -32,21 +32,30 @@ import org.apache.pig.impl.io.BufferedPositionedInputStream;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.impl.logicalLayer.schema.Schema;
 import org.apache.pig.impl.util.UDFContext;
+import org.junit.AfterClass;
+import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import junit.framework.TestCase;
 
-
+@RunWith(JUnit4.class)
 public class TestUDFContext extends TestCase {
     
     static MiniCluster cluster = null;
     
     @Override 
-    protected void setUp() throws Exception {
+    @Before
+    public void setUp() throws Exception {
         cluster = MiniCluster.buildCluster();
     }
 
-
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testUDFContext() throws Exception {
         Util.createInputFile(cluster, "a.txt", new String[] { "dumb" });
diff --git a/test/org/apache/pig/test/TestUDFReturnMap.java b/test/org/apache/pig/test/TestUDFReturnMap.java
index 6ee9332a7..de8c55e07 100644
--- a/test/org/apache/pig/test/TestUDFReturnMap.java
+++ b/test/org/apache/pig/test/TestUDFReturnMap.java
@@ -31,8 +31,14 @@ import org.apache.pig.PigServer;
 import org.apache.pig.data.Tuple;
 import org.apache.pig.impl.io.FileLocalizer;
 import org.apache.pig.test.utils.MyUDFReturnMap;
+import org.junit.After;
+import org.junit.AfterClass;
+import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
+@RunWith(JUnit4.class)
 public class TestUDFReturnMap extends TestCase {
 
 	static String[] ScriptStatement = {
@@ -44,7 +50,8 @@ public class TestUDFReturnMap extends TestCase {
 	static MiniCluster cluster = MiniCluster.buildCluster();
 
 	@Override
-	protected void setUp() throws Exception {
+	@Before
+	public void setUp() throws Exception {
 		TempScriptFile = File.createTempFile("temp_jira_851", ".pig");
 		FileWriter writer = new FileWriter(TempScriptFile);
 		for (String line : ScriptStatement) {
@@ -53,6 +60,11 @@ public class TestUDFReturnMap extends TestCase {
 		writer.close();
 	}
 
+	@AfterClass
+	public static void oneTimeTearDown() throws Exception {
+	    cluster.shutDown();
+	}
+	
 	@Test
 	public void testUDFReturnMap_LocalMode() {
 		try {
@@ -100,7 +112,8 @@ public class TestUDFReturnMap extends TestCase {
 	}
 
 	@Override
-	protected void tearDown() throws Exception {
+	@After
+	public void tearDown() throws Exception {
 		TempScriptFile.delete();
 	}
 }
diff --git a/test/org/apache/pig/test/TestUTF8.java b/test/org/apache/pig/test/TestUTF8.java
index 4f5709e99..1abe1d8f4 100644
--- a/test/org/apache/pig/test/TestUTF8.java
+++ b/test/org/apache/pig/test/TestUTF8.java
@@ -26,8 +26,11 @@ import java.io.PrintWriter;
 import java.io.StringWriter;
 import java.util.Iterator;
 
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 import org.apache.pig.ExecType;
 import org.apache.pig.PigServer;
@@ -37,10 +40,10 @@ import org.apache.pig.tools.grunt.Grunt;
 import org.apache.pig.tools.parameters.ParameterSubstitutionPreprocessor;
 
 import junit.framework.TestCase;
-
+@RunWith(JUnit4.class)
 public class TestUTF8 extends TestCase {
     
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     private PigServer pigServer;
 
     @Before
@@ -49,6 +52,11 @@ public class TestUTF8 extends TestCase {
         pigServer = new PigServer(ExecType.MAPREDUCE, cluster.getProperties());
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     @Test
     public void testPigStorage() throws Exception{
         
diff --git a/test/org/apache/pig/test/TestUnion.java b/test/org/apache/pig/test/TestUnion.java
index 916ca4950..b71279ac8 100644
--- a/test/org/apache/pig/test/TestUnion.java
+++ b/test/org/apache/pig/test/TestUnion.java
@@ -47,8 +47,11 @@ import org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOpe
 import org.apache.pig.test.utils.GenPhyOp;
 import org.apache.pig.test.utils.TestHelper;
 import org.junit.After;
+import org.junit.AfterClass;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.JUnit4;
 
 /**
  *  Start Plan - --4430968173902769765
@@ -76,10 +79,12 @@ import org.junit.Test;
  *  conversion from DataByteArray to native types for computation
  *  and back to DataByteArray for comparison with input.
  */
+
+@RunWith(JUnit4.class)
 public class TestUnion extends junit.framework.TestCase {
     POUnion sp;
     DataBag expBag;
-    MiniCluster cluster = MiniCluster.buildCluster();
+    static MiniCluster cluster = MiniCluster.buildCluster();
     PigContext pc = new PigContext();
     @Before
     public void setUp() throws Exception {
@@ -152,6 +157,11 @@ public class TestUnion extends junit.framework.TestCase {
     public void tearDown() throws Exception {
     }
     
+    @AfterClass
+    public static void oneTimeTearDown() throws Exception {
+        cluster.shutDown();
+    }
+    
     private Tuple castToDBA(Tuple in) throws ExecException{
         Tuple res = new DefaultTuple();
         for (int i=0;i<in.size();i++) {
diff --git a/test/org/apache/pig/test/Util.java b/test/org/apache/pig/test/Util.java
index cd25a6501..17315d973 100644
--- a/test/org/apache/pig/test/Util.java
+++ b/test/org/apache/pig/test/Util.java
@@ -294,6 +294,22 @@ public class Util {
         return fs.create(new Path(fileName));
     }
     
+    /**
+     * Helper to create an empty temp file on local file system
+     *  which will be deleted on exit
+     * @param prefix
+     * @param suffix
+     * @return File denoting a newly-created empty file 
+     * @throws IOException
+     */
+    static public File createTempFileDelOnExit(String prefix, String suffix)
+        throws IOException {
+        File tmpFile = File.createTempFile(prefix, suffix);
+        tmpFile.deleteOnExit();
+        return tmpFile;
+    }
+
+    
     /**
      * Helper to remove a dfs file from the minicluster DFS
      * 
diff --git a/test/org/apache/pig/test/utils/GenPhyOp.java b/test/org/apache/pig/test/utils/GenPhyOp.java
index 00fab1963..ae23bedc6 100644
--- a/test/org/apache/pig/test/utils/GenPhyOp.java
+++ b/test/org/apache/pig/test/utils/GenPhyOp.java
@@ -60,7 +60,6 @@ public class GenPhyOp{
     };
     
     public static PigContext pc;
-//    public static MiniCluster cluster = MiniCluster.buildCluster();
     
     public static ConstantExpression exprConst() {
         ConstantExpression ret = new ConstantExpression(new OperatorKey("", r
