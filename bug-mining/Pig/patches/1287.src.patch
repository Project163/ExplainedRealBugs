diff --git a/CHANGES.txt b/CHANGES.txt
index 6863d9d9e..5897047b1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -40,6 +40,8 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-3377: New AvroStorage throws NPE when storing untyped map/array/bag (jadler via cheolsoo)
+
 PIG-3542: Javadoc of REGEX_EXTRACT_ALL (nyigitba via daijy)
 
 PIG-3518: Need to ship jruby.jar in the release (daijy)
diff --git a/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java b/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
index 6b31a4c41..fb89e9c76 100644
--- a/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
+++ b/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java
@@ -427,6 +427,9 @@ public class AvroStorageSchemaConversionUtilities {
           schema.getFields()[0].getSchema(), name, null,
           definedRecordNames,
           doubleColonsToDoubleUnderscores);
+      if (innerBagSchema == null) {
+        throw new IOException("AvroStorage can't save bags with untyped values; please specify a value type or a schema.");
+      }
       return createNullableUnion(Schema.createArray(innerBagSchema));
     case DataType.BIGCHARARRAY:
       return createNullableUnion(Type.STRING);
@@ -457,10 +460,15 @@ public class AvroStorageSchemaConversionUtilities {
     case DataType.LONG:
       return createNullableUnion(Type.LONG);
     case DataType.MAP:
+      if (schema == null) {
+        throw new IOException("AvroStorage can't save maps with untyped values; please specify a value type or a schema.");
+      }
       byte innerType = schema.getFields()[0].getType();
       String desc = schema.getFields()[0].getDescription();
-      if (desc.equals("autogenerated from Pig Field Schema")) {
-        desc = null;
+      if (desc != null) {
+        if (desc.equals("autogenerated from Pig Field Schema")) {
+          desc = null;
+        }
       }
       Schema innerSchema;
       if (DataType.isComplex(innerType)) {
@@ -480,6 +488,9 @@ public class AvroStorageSchemaConversionUtilities {
     case DataType.NULL:
       return Schema.create(Type.NULL);
     case DataType.TUPLE:
+      if (schema == null) {
+        throw new IOException("AvroStorage can't save tuples with untyped values; please specify a value type or a schema.");
+      }
       Schema returnSchema = createNullableUnion(
           resourceSchemaToAvroSchema(schema, name, null,
               definedRecordNames, doubleColonsToDoubleUnderscores));
