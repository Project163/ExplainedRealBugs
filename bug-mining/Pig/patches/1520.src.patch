diff --git a/CHANGES.txt b/CHANGES.txt
index ece6d8b69..d275fb177 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -50,6 +50,9 @@ OPTIMIZATIONS
  
 BUG FIXES
 
+PIG-4071: Fix TestStore.testSetStoreSchema, TestParamSubPreproc.testGruntWithParamSub,
+ TestJobSubmission.testReducerNumEstimation (daijy)
+
 PIG-4074: mapreduce.client.submit.file.replication is not honored in cached files (cheolsoo)
 
 PIG-4052: TestJobControlSleep, TestInvokerSpeed are unreliable (daijy)
diff --git a/src/org/apache/pig/Main.java b/src/org/apache/pig/Main.java
index 5e9186098..b084f7d9d 100644
--- a/src/org/apache/pig/Main.java
+++ b/src/org/apache/pig/Main.java
@@ -30,6 +30,7 @@ import java.io.InputStreamReader;
 import java.io.OutputStreamWriter;
 import java.io.Reader;
 import java.io.StringReader;
+import java.io.Writer;
 import java.text.ParseException;
 import java.util.AbstractList;
 import java.util.ArrayList;
@@ -531,13 +532,13 @@ public class Main {
                 // Interactive
                 mode = ExecMode.SHELL;
               //Reader is created by first loading "pig.load.default.statements" or .pigbootup file if available
-                ConsoleReader reader = new ConsoleReader(Utils.getCompositeStream(System.in, properties), new OutputStreamWriter(System.out));
+                ConsoleReader reader = new ConsoleReaderWithParamSub(Utils.getCompositeStream(System.in, properties), new OutputStreamWriter(System.out), pigContext);
                 reader.setDefaultPrompt("grunt> ");
                 final String HISTORYFILE = ".pig_history";
                 String historyFile = System.getProperty("user.home") + File.separator  + HISTORYFILE;
                 reader.setHistory(new History(new File(historyFile)));
                 ConsoleReaderInputStream inputStream = new ConsoleReaderInputStream(reader);
-                grunt = new Grunt(new BufferedReaderWithParamSub(new InputStreamReader(inputStream), pigContext), pigContext);
+                grunt = new Grunt(new BufferedReader(new InputStreamReader(inputStream)), pigContext);
                 grunt.setConsoleReader(reader);
                 gruntCalled = true;
                 grunt.run();
@@ -1042,10 +1043,10 @@ public class Main {
                         : ReturnCode.SUCCESS;
     }
 
-    static class BufferedReaderWithParamSub extends BufferedReader {
+    static class ConsoleReaderWithParamSub extends ConsoleReader {
         PigContext pc;
-        BufferedReaderWithParamSub(Reader in, PigContext pigContext) {
-            super(in);
+        ConsoleReaderWithParamSub(InputStream in, Writer out, PigContext pigContext) throws IOException {
+            super(in, out);
             pc = pigContext;
         }
 
diff --git a/test/org/apache/pig/test/TestJobSubmission.java b/test/org/apache/pig/test/TestJobSubmission.java
index 1254aeff0..c57025e55 100644
--- a/test/org/apache/pig/test/TestJobSubmission.java
+++ b/test/org/apache/pig/test/TestJobSubmission.java
@@ -30,6 +30,7 @@ import junit.framework.Assert;
 
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.hbase.HBaseConfiguration;
 import org.apache.hadoop.hbase.HBaseTestingUtility;
 import org.apache.hadoop.hbase.HConstants;
 import org.apache.hadoop.hbase.MiniHBaseCluster;
@@ -218,11 +219,8 @@ public class TestJobSubmission {
 
     @Test
     public void testReducerNumEstimation() throws Exception{
-        // skip this test for 23 until HBASE-4850
-        if (Util.isHadoop23() || Util.isHadoop2_0())
-            return;
         // use the estimation
-        Configuration conf = cluster.getConfiguration();
+        Configuration conf = HBaseConfiguration.create(new Configuration());
         HBaseTestingUtility util = new HBaseTestingUtility(conf);
         int clientPort = util.startMiniZKCluster().getClientPort();
         util.startMiniHBaseCluster(1, 1);
diff --git a/test/org/apache/pig/test/TestStore.java b/test/org/apache/pig/test/TestStore.java
index c91190aaa..3aba60bbb 100644
--- a/test/org/apache/pig/test/TestStore.java
+++ b/test/org/apache/pig/test/TestStore.java
@@ -439,6 +439,8 @@ public class TestStore {
             if(execType == cluster.getExecType()) {
                 ps = new PigServer(cluster.getExecType(),
                         cluster.getProperties());
+                filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED, Boolean.TRUE);
+                filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED, Boolean.TRUE);
             } else {
                 Properties props = new Properties();
                 props.setProperty(MapRedUtil.FILE_SYSTEM_NAME, "file:///");
